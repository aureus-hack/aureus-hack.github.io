(function(){"use strict";var a,b,c,d;angular.module("galleon",["ui.bootstrap","ui.bootstrap.tabs","pascalprecht.translate","ngSanitize","ngRoute","angular-gestures","LocalStorageModule","angular-md5","angular.filter"]),angular.module("galleon").factory("galleon",["$window",function(a){var b;return null!=(b=a.galleon)?b:{}}]),c=function(a){return function(b){return b.decorator("$templateRequest",["$delegate",function(b){var c;return c=b,function(b,d){var e;return e=b.replace(new RegExp("@@p","g"),a),c.apply(null,[e,d])}}])}},b=c("pb"),b.$inject=["$provide"],angular.module("galleon-pb",[]).config(b),a=c("gc"),a.$inject=["$provide"],angular.module("galleon-gc",[]).config(a),d=c("ss"),d.$inject=["$provide"],angular.module("galleon-ss",[]).config(d)}).call(this),function(){var a;Function.prototype._sfgetter=function(a,b){return Object.defineProperty(this.prototype,a,{get:b,configurable:!0})},Function.prototype._sfsetter=function(a,b){return Object.defineProperty(this.prototype,a,{set:b,configurable:!0})},a=function(){function a(){}return a.initialize=function(a,b,c){var d,e,f,g,h;if(null!=a&&null!=b&&null!=c&&Array.isArray(c)){for(e=0,g=c.length;e<g;e++)d=c[e],this._initAutoMapKeySetter(d,a,b);for(f=0,h=c.length;f<h;f++)d=c[f],this._initAutoMapKeyGetter(d,a,b,!1)}},a.initializeImmutable=function(a,b){var c,d,e;if(null!=a&&null!=b&&Array.isArray(b))for(d=0,e=b.length;d<e;d++)c=b[d],this._initAutoMapKeyImmutableGetter(a,c)},a._initAutoMapKeySetter=function(b,c,d){var e;if(null!=d)return e=function(c){if(null===c||null==this.values[b]||a.typesMatch(this.values[b],c))return this.values[b]=c},Object.defineProperty(c.constructor.prototype,b,{set:e,configurable:!0})},a._initAutoMapKeyGetter=function(a,b,c,d){var e,f;if(null!=c)return e=function(){return this.values[a]},d&&(f=function(b){throw Error(""+a+" Immutable")},Object.defineProperty(b.constructor.prototype,a,{set:f,configurable:!0})),Object.defineProperty(b.constructor.prototype,a,{get:e,configurable:!0})},a._initAutoMapKeyImmutableGetter=function(a,b){var c,d;return d=function(a){throw Error(""+b+" Immutable")},c=function(){var a;return null!=(a=this.values)?a[b]:void 0},Object.defineProperty(a.constructor.prototype,b,{set:d,configurable:!0}),Object.defineProperty(a.constructor.prototype,b,{get:c,configurable:!0})},a.typesMatch=function(a,b){return!(!Array.isArray(a)||!Array.isArray(b))||!Array.isArray(a)&&!Array.isArray(b)&&typeof a==typeof b},a.isType=function(a,b,c){return"array"===b.toLowerCase()?Array.isArray(a):typeof a===b&&null!==a&&a===a},a}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").value("modelInitializer",a)}.call(this);var translations=window.translations||{};translations.en={looseleaf:"standard pages",layflat:"layflat pages","6x6_bk_hard":"6x6 Hard photo cover","5x7_bk_soft":"5x7 Soft photo cover","7x9_bk_soft":"7x9 Soft photo cover","8x8_bk_cloth":"8x8 Cloth hardcover","8x8_bk_hard":"8x8 Hard photo cover","8x8_bk_hard_dustjacket":"Hard photo cover with dust jacket","8x8_bk_leather":"8x8 Leather hardcover","8x8_bk_linen":"8x8 Linen hardcover","8x8_bk_premiumleather":"8x8 Genuine leather hardcover","8x8_bk_silk":"8x8 Crushed silk hardcover","8x8_bk_soft":"8x8 Soft photo cover","8x11_bk_cloth":"8x11 Cloth hardcover","8x11_bk_hard":"8x11 Hard photo cover","8x11_bk_hard_dustjacket":"Hard photo cover with dust jacket","8x11_bk_leather":"8x11 Leather hardcover","8x11_bk_linen":"8x11 Linen hardcover","8x11_bk_premiumleather":"8x11 Genuine leather hardcover","8x11_bk_silk":"8x11 Crushed silk hardcover","8x11_bk_soft":"8x11 Soft photo cover","10x10_bk_cloth":"10x10 Cloth hardcover","10x10_bk_hard":"10x10 Hard photo cover","10x10_bk_hard_dustjacket":"Hard photo cover with dust jacket","10x10_bk_leather":"10x10 Leather hardcover","10x10_bk_linen":"10x10 Linen hardcover","10x10_bk_premiumleather":"10x10 Genuine leather hardcover","10x10_bk_silk":"10x10 Crushed silk hardcover","10x10_bk_soft":"10x10 Soft photo cover","11x14_bk_cloth":"11x14 Cloth hardcover","11x14_bk_hard":"11x14 Hard photo cover","11x14_bk_hard_dustjacket":"Hard photo cover with dust jacket","11x14_bk_leather":"11x14 Leather hardcover","11x14_bk_linen":"11x14 Linen hardcover","11x14_bk_premiumleather":"11x14 Genuine leather hardcover","11x14_bk_silk":"11x14 Crushed silk hardcover","12x12_bk_cloth":"12x12 Cloth hardcover","12x12_bk_hard":"12x12 Hard photo cover","12x12_bk_hard_dustjacket":"Hard photo cover with dust jacket","12x12_bk_leather":"12x12 Leather hardcover","12x12_bk_linen":"12x12 Linen hardcover","12x12_bk_premiumleather":"12x12 Genuine leather hardcover","12x12_bk_silk":"12x12 Crushed silk hard cover","7X7CLRPOCKET":"7x7 Clear memorabilia pocket",PB_5X7_BASE:"20-page 5x7 book",PB_5X7_01:"Soft photo cover",PB_5X7_SC_PG:"{{value}} Additional pages",PB_7X9_BASE:"20-page 7x9 book",PB_7X9_01:"Soft photo cover",PB_7X9_SC_PG:"{{value}} Additional pages",PB_8X8_BASE:"20-page 8x8 book",PB_8X8_01:"Soft photo cover",PB_8X8_02:"Hard photo cover",PB_8X8_04:"Leather hardcover",PB_8X8_05:"Cloth hardcover",PB_8X8_06:"Crocodile hardcover",PB_8X8_08:"Genuine leather hardcover",PB_8X8_09:"Linen hardcover",PB_8X8_10:"Crushed silk hardcover",PB_8X8_PADDED_FINISH:"Padded cover finish",PB_8X8_MATTE_FINISH:"Matte cover finish",PB_8X8_LF:"Layflat pages",PB_8X8_HINGED:"Standard layflat",PB_8X8_SC_PG:"{{value}} Additional pages",PB_8X8_HC_PG:"{{value}} Additional pages",PB_8X8_PREM_PG:"{{value}} Additional pages",PB_8x8_STD_DJ:"Dust jacket",PB_8x8_LF_DJ:"Dust jacket",PB_10X10_BASE:"20-page 10x10 book",PB_10X10_01:"Soft photo cover",PB_10X10_02:"Hard photo cover",PB_10X10_04:"Leather hardcover",PB_10X10_05:"Cloth hardcover",PB_10X10_06:"Crocodile hardcover",PB_10X10_08:"Genuine leather hardcover",PB_10X10_09:"Linen hardcover",PB_10X10_10:"Crushed silk hardcover",PB_10X10_PADDED_FINISH:"Padded cover finish",PB_10X10_MATTE_FINISH:"Matte cover finish",PB_10X10_LF:"Layflat pages",PB_10X10_HINGED:"Standard layflat",PB_10X10_SC_PG:"{{value}} Additional pages",PB_10X10_HC_PG:"{{value}} Additional pages",PB_10X10_PREM_PG:"{{value}} Additional pages",PB_10x10_LF_DJ:"Dust jacket",PB_10x10_STD_DJ:"Dust jacket",PB_8X11_BASE:"20-page 8x11 book",PB_8X11_01:"Soft photo cover",PB_8X11_02:"Hard photo cover",PB_8X11_04:"Leather hardcover",PB_8X11_05:"Cloth hardcover",PB_8X11_06:"Crocodile hardcover",PB_8X11_08:"Genuine leather hardcover",PB_8X11_09:"Linen hardcover",PB_8X11_10:"Crushed silk hardcover",PB_8X11_PADDED_FINISH:"Padded cover finish",PB_8X11_MATTE_FINISH:"Matte cover finish",PB_8X11_LF:"Layflat pages",PB_8X11_HINGED:"Standard layflat",PB_8X11_SC_PG:"{{value}} Additional pages",PB_8X11_HC_PG:"{{value}} Additional pages",PB_8X11_PREM_PG:"{{value}} Additional pages",PB_8x11_LF_DJ:"Dust jacket",PB_8x11_STD_DJ:"Dust jacket",PB_12X12_BASE:"20-page 12x12 book",PB_12X12_02:"Hard photo cover",PB_12X12_04:"Leather hardcover",PB_12X12_05:"Cloth hardcover",PB_12X12_06:"Crocodile hardcover",PB_12X12_08:"Genuine leather hardcover",PB_12X12_09:"Linen hardcover",PB_12X12_10:"Crushed silk hardcover",PB_12X12_PADDED_FINISH:"Padded cover finish",PB_12X12_MATTE_FINISH:"Matte cover finish",PB_12X12_LF:"Layflat pages",PB_12X12_HINGED:"Standard layflat",PB_12X12_HC_PG:"{{value}} Additional pages",PB_12X12_PREM_PG:"{{value}} Additional pages",PB_12x12_LF_DJ:"Dust jacket",PB_12x12_STD_DJ:"Dust jacket",PB_11X14_BASE:"20-page 11x14 book",PB_11X14_02:"Hard photo cover",PB_11X14_04:"Leather hardcover",PB_11X14_05:"Cloth hardcover",PB_11X14_06:"Crocodile hardcover",PB_11X14_08:"Genuine leather hardcover",PB_11X14_09:"Linen hardcover",PB_11X14_10:"Crushed silk hardcover",PB_11X14_PADDED_FINISH:"Padded cover finish",PB_11X14_MATTE_FINISH:"Matte cover finish",PB_11X14_LF:"Layflat pages",PB_11X14_HC_PG:"{{value}} Additional pages",PB_11X14_PREM_PG:"{{value}} Additional pages",PB_11x14_LF_DJ:"Dust jacket",PB_11x14_STD_DJ:"Dust jacket",PB_5X7_STD:"Standard pages",PB_7X9_STD:"Standard pages",PB_8X8_STD:"Standard pages",PB_10X10_STD:"Standard pages",PB_8X11_STD:"Standard pages",PB_12X12_STD:"Standard pages",PB_11X14_STD:"Standard pages",PB_5X7_GLOSSY_FINISH_STD:"Glossy page finish",PB_7X9_GLOSSY_FINISH_STD:"Glossy page finish",PB_8X8_GLOSSY_FINISH_STD:"Glossy page finish",PB_10X10_GLOSSY_FINISH_STD:"Glossy page finish",PB_8X11_GLOSSY_FINISH_STD:"Glossy page finish",PB_12X12_GLOSSY_FINISH_STD:"Glossy page finish",PB_11X14_GLOSSY_FINISH_STD:"Glossy page finish","please.wait":"Please wait...",PB_5X7:"PB_5X7",PB_7X9:"PB_7X9",PB_8X11:"PB_8X11",PB_8X8:"PB_8X8",PB_10X10:"PB_10X10",PB_11X14:"PB_11X14",PB_12X12:"PB_12X12",undefined:"undefined",WALLCAL_8X11:"8x11 photo wall calendar",WALLCAL_12X12:"12x12 photo wall calendar",CAL_8X11:"CAL_8X11",CAL_12X12:"CAL_12X12","Calendar.descriptionId.8x11":"8x11 Wall Calendar","Calendar.descriptionId.12x12":"12x12 Wall Calendar","SilverApp.title":"Shutterfly | Photo Books","SilverApp.edit":"Edit","SilverApp.delete":"Delete","SilverApp.book":"Book","SilverApp.arrange":"Arrange","SilverApp.events":"Events","SilverApp.style":"Style","SilverApp.storyboard":"Storyboard","SilverApp.share":"Share","SilverApp.help":"Help...","SilverApp.save":"Save","SilverApp.saveAs":"Save as","SilverApp.undo":"Undo","SilverApp.redo":"Redo","SilverApp.done":"Done","SilverApp.order":"Order","SilverApp.project":"Project","SilverApp.removePage":"Remove page","SilverApp.duplicatePage":"Duplicate page","SilverApp.flipPage":"Flip page","SilverApp.getDesignElements":"Get design elements...","SilverApp.getDesignElementsToolbar":"Get design elements","SilverApp.changeStyle":"Change style","SilverApp.changeStyleMenuItem":"Change style...","SilverApp.textSettings":"Text settings","SilverApp.textSettingsMenuItem":"Text settings...","SilverApp.changeSize":"Change size","SilverApp.changeSizeMenuItem":"Change size...","SilverApp.changeStartDateMenuItem":"Change start date...","SilverApp.changeStartDate":"Change start date","SilverApp.dontChange":"Don't change","SilverApp.editEvents":"Edit events...","SilverApp.autofill":"Autofill","SilverApp.clearAllPhotosFromPages":"Remove placed photos from pages...","SilverApp.clearUnusedPhotosFromPages":"Remove unused photos...","SilverApp.pages":"Page","SilverApp.photos":"Photos","SilverApp.align":"Align","SilverApp.match":"Match","SilverApp.space":"Space","SilverApp.layer":"Layer","SilverApp.flipLayout":"Flip layout","SilverApp.movePage":"Move page","SilverApp.importPage":"Import page","SilverApp.importPage.button":"Import Page","SilverApp.importPage.description":"Import a page from another book you've made to use in this project.","SilverApp.importPage.selectBook":"Start by selecting a book ({{value}} books found):","SilverApp.importPage.noProject":"You have no photo books to import from. You can import pages from previously saved photo book projects.","SilverApp.importPage.selectPageFrom":'Select a page from "{{value}}"',"SilverApp.importPage.insertPageFrom":'Insert page from "{{value}}"',"SilverApp.importPage.chooseDifferentBook":"Choose a different book","SilverApp.importPage.chooseDifferentPage":"Choose a different page","SilverApp.importPage.option.after":"After page {{value}}","SilverApp.importPage.option.before":"Before page {{value}}","SilverApp.importPage.option.beginning":"After title page","SilverApp.importPage.option.end":"To the end of the project","SilverApp.importPage.spreadNote":"Note: An additional blank page will be placed in your book to preserve spreads.","SilverApp.advanceEdit":"Advanced editing","SilverApp.advanceEditCollage":"Customize collage","SilverApp.advanceEdit.subtext":"Move objects freely to create custom layouts","SilverApp.addPagesMenuItem":"Add pages...","SilverApp.addPhotosMenuItem":"Add photos...","SilverApp.movePageMenuItem":"Move page...","SilverApp.importPageMenuItem":"Import page...","SilverApp.spread":"Spread","SilverApp.spreadIdeaPage":"Spread idea page","SilverApp.makeSpread":"Make spread","SilverApp.breakSpread":"Split spread","SilverApp.alignLeftMenuItem":"Align left edges","SilverApp.alignCenterMenuItem":"Align centers","SilverApp.alignRightMenuItem":"Align right edges","SilverApp.alignTopMenuItem":"Align top edges","SilverApp.alignMiddleMenuItem":"Align middles","SilverApp.alignBottomMenuItem":"Align bottom edges","SilverApp.matchWidestMenuItem":"Match widest width","SilverApp.matchNarrowestMenuItem":"Match narrowest width","SilverApp.matchTallestMenuItem":"Match tallest height","SilverApp.matchShortestMenuItem":"Match shortest height","SilverApp.matchWidthAndHeightMenuItem":"Match width and height","SilverApp.spaceHorizontalMenuItem":"Even out horizontal spacing","SilverApp.spaceVerticalMenuItem":"Even out vertical spacing","SilverApp.layerBringToFrontMenuItem":"Bring to front","SilverApp.layerSendToBackMenuItem":"Send to back","SilverApp.layerBringForwardMenuItem":"Bring forward","SilverApp.layerSendBackwardMenuItem":"Send backward","SilverApp.addText":"Add text box","SilverApp.addPhoto":"Add photo area","SilverApp.addPhotos":"Add photos","SilverApp.addPhotosTooltip":"Add photos","SilverApp.addPage":"Add page","SilverApp.copyright":"© 1999-{{value}} Shutterfly, Inc. All rights reserved.","SilverApp.editText":"Edit text","SilverApp.editText.removeNonPrintable":"Invalid characters removed.","SilverApp.editText.overflow":"Text does not fit.","SilverApp.editText.edgeWarning":"Text is too close to edge and may not print well.","SilverApp.editText.maxAmountOfText":"Cannot enter more text.","SilverApp.editText.textSuffix":" text","SilverApp.editText.textStyle":"Text style:","SilverApp.editText.alignLeft":"Left","SilverApp.editText.alignCenter":"Center","SilverApp.editText.alignRight":"Right","SilverApp.editText.alignTop":"Top","SilverApp.editText.alignMiddle":"Middle","SilverApp.editText.alignBottom":"Bottom","SilverApp.editText.normalLineSpacing":"Normal line spacing","SilverApp.editText.wideLineSpacing":"Wide line spacing","SilverApp.editText.widerLineSpacing":"Wider line spacing","SilverApp.editText.widestLineSpacing":"Widest line spacing","SilverApp.editText.styleFonts":"Style fonts","SilverApp.editText.allFonts":"All fonts","SilverApp.editText.userSelectedFonts":"User selected fonts","SilverApp.editText.styleColors":"Style colors","SilverApp.editText.allColors":"All colors","SilverApp.editText.userSelectedColors":"User selected colors","SilverApp.editText.paraStyle.xxlarge":"Extra extra large","SilverApp.editText.paraStyle.xlarge":"Extra large","SilverApp.editText.paraStyle.large":"Large","SilverApp.editText.paraStyle.large_alt":"Large","SilverApp.editText.paraStyle.medium":"Medium","SilverApp.editText.paraStyle.medium_alt":"Medium","SilverApp.editText.paraStyle.small":"Small","SilverApp.editText.paraStyle.small_alt":"Small","SilverApp.editText.paraStyle.xsmall":"Extra small","SilverApp.editText.paraStyle.spine":"Spine","SilverApp.editText.paraStyle.spine_wide":"Spine","SilverApp.editText.paraStyle.page_num_R":"Page number","SilverApp.editText.paraStyle.page_num_L":"Page number","SilverApp.textSettings.note":"Note: These settings affect your entire project and may be changed at any time. Changes to a set style will be applied to all text boxes using that style. Text may no longer fit or wrap differently.","SilverApp.textSettings.resetButton":"Reset","SilverApp.textSettings.applyPageButton":"Apply to page","SilverApp.applyOtherPageButton":"Apply to other pages","SilverApp.applyOtherPageButtonMenuItem":"Apply to other pages...","SilverApp.applyOtherPageModal1":"Apply these elements from page","SilverApp.applyOtherPageModal2":"to all pages:","SilverApp.applyOtherPageLayout":"Layout","SilverApp.applyOtherPageBackground":"Background","SilverApp.applyOtherPageFrame":"Frame","SilverApp.applyOtherPageModalButton":"Apply","SilverApp.doNotApplyOtherPageModalButton":"Don't Apply","SilverApp.textSettings.applyProjectButton":"Apply to project","SilverApp.lastSaved":"All changes saved at {{value}}","SilverApp.lastSavedShort":"{{value}}","SilverApp.numPages":"{{value}} pages","SilverApp.frontCover":"Front cover","SilverApp.backCover":"Back cover","SilverApp.CannotAddPhotoarea":"Cannot add photo","SilverApp.CannotAddPhotoareaMoreDescription":"An additional photo area cannot be added to the page. Please drag your photo into one of the empty spaces.","SilverApp.Ok":"OK","SilverApp.NoMorePhotosCanBeAdded":"You have reached this page's photo limit","SilverApp.NoMorePhotosCanBeAddedMoreDescription":"You can only add {{value}} photo(s) to this page. Please remove a photo if you would like to add a new one.<br/><br/> Note: This page might have an Idea page as its layout. Idea pages do not adapt to other layouts and are limited to the number of photo areas on the page.","SilverApp.changeSizeTitle":"Change size","SilverApp.changeStartDateTitle":"Change start date","SilverApp.changeStartDateTitle2":"Change start date?","SilverApp.changeStartDateContent":"The starting month for this calendar is in the past, select a new start date.","SilverApp.softCover":"Soft cover","SilverApp.softOrHardCover":"Soft or hard cover","SilverApp.hardCoverOnly":"Hard cover","SilverApp.savings":"Save {{value}}%","SilverApp.english":"Switch to English","SilverApp.spanish":"Switch to Spanish","SilverApp.welcome":"Welcome, {{value}}","SilverApp.SaveAs.dialog.title":"Save project","SilverApp.required":"Required","SilverApp.exitFullScreen":"Exit full screen","SilverApp.fullScreen":"Full screen","SilverApp.SaveAs.dialog.question":"What would you like to name your project?","SilverApp.SaveAs.dialog.tip":"You can find this project under My Projects on the My Shutterfly page.","SilverApp.moveThisPage":"Move this page","SilverApp.beforePage":"before page","SilverApp.afterPage":"after page","SilverApp.addPages.spreadCheck":"Adding an odd number of pages to this location will also place an additional blank page to preserve spreads.","SilverApp.save.error.fixNeeded":"We need to fix a few things before you save.","SilverApp.login.dialog.invalid.loginRequiredFix":"We need to fix a few things before you sign in.","SilverApp.sign.up.invalid.signup":"We need to fix a few things before you sign up.","SilverApp.sign.in":"Sign in","SilverApp.sign.in.title":"Sign in to continue","SilverApp.sign.in.to.save.your.work.content":"Once signed in, we will begin uploading your photos and save your work.","SilverApp.sign.in.to.save.your.work":"Sign in to save your work","SilverApp.sign.up.title":"Sign up for Shutterfly","SilverApp.sign.up":"Sign up","SilverApp.login.dialog.email":"Email","SilverApp.sign.up.first.name":"First name","SilverApp.sign.up.last.name":"Last name","SilverApp.sign.up.password.length":"Must be at least 4 characters","SilverApp.email.invalid":"Invalid email","SilverApp.email.already.used":"The email address may already be in use.","SilverApp.email.already.login":"User is already logged in.","SilverApp.sign.up.password.description":"(4-10 characters, no spaces)","SilverApp.email.remember":"Remember my email address","SilverApp.sign.up.accept.terms.prefix":"By clicking Sign up, you agree to Shutterfly's ","SilverApp.sign.up.accept.terms.conjunction":"and ","SilverApp.sign.up.terms.and.conditions":"Terms of use","SilverApp.sign.up.privacy.policy":"Privacy policy.","SilverApp.sign.up.password.mustMatch":"Please enter matching passwords.","SilverApp.do.not.have.account":"Don't have an account yet? ","SilverApp.login.dialog.password":"Password","SilverApp.login.dialog.confirmPassword":"Confirm password","SilverApp.login.dialog.invalid.login":"Sorry, the information you have given does not match our records. Please try again.","SilverApp.login.dialog.invalid.password":"Enter your password.","SilverApp.login.dialog.invalid.email":"Enter a valid email address.","SilverApp.login.dialog.forgot":"Forgot password?","SilverApp.addPages":"Add pages","SilverApp.add":"Add","SilverApp.select":"Select","SilverApp.canAddUpToXPages":"page(s) - You can add up to {{value}} pages.","SilverApp.afterTitlePage":"after the title page","SilverApp.afterPageX":"after page {{value}}","SilverApp.beforePageX":"before page {{value}}","SilverApp.toTheEndOfTheBook":"to the end of the project","SilverApp.addEvenPagesReminder":"Note: Remember to add an even number of pages in order to keep your current spreads together.","SilverApp.autofill.unplacedPhotos.title":"Some photos were not added to your project","SilverApp.autofill.unplacedPhotos.p1":"Your project has reached the maximum number of pages. {{value0}} photos were added to your project, and the remaining {{value1}} photos have been added to the photos tab, so you can add them yourself.","SilverApp.autofill.unplacedPhotos.p3":"Note: You can add up to 25 photos on each page.","SilverApp.booktab.categories.standard":"Standard covers","SilverApp.booktab.categories.upgraded":"Upgraded covers","SilverApp.booktab.categories.premium":"Premium covers","SilverApp.booktab.options":"Cover options","SilverApp.booktab.pageOptions.layflat":"Deluxe layflat pages","SilverApp.booktab.pageOptions.hingedLayflat":"Standard layflat pages","SilverApp.booktab.pageOptions.glossy":"Glossy pages","SilverApp.booktab.pageOptions.standard":"Standard pages","SilverApp.booktab.stockCloth.black":"Black cloth","SilverApp.booktab.stockCloth.black.glossy.text":"Select a cloth or leather hardcover to add a chic, fashionable touch to your photo cover. Glossy pages add a luxe sheen that strikingly enhances color and adds a protective finish to your book pages.","SilverApp.booktab.stockCloth.black.standard.text":"Select a cloth or leather hardcover to add a chic, fashionable touch to your photo cover.","SilverApp.booktab.stockCloth.camel":"Camel cloth","SilverApp.booktab.stockCloth.camel.glossy.text":"Select a cloth or leather hardcover to add a chic, fashionable touch to your photo cover. Glossy pages add a luxe sheen that strikingly enhances color and adds a protective finish to your book pages.","SilverApp.booktab.stockCloth.camel.standard.text":"Select a cloth or leather hardcover to add a chic, fashionable touch to your photo cover.","SilverApp.booktab.stockLeather.black":"Black leather","SilverApp.booktab.stockLeather.black.glossy.text":"Select a cloth or leather hardcover to add a chic, fashionable touch to your photo cover. Glossy pages add a luxe sheen that strikingly enhances color and adds a protective finish to your book pages.","SilverApp.booktab.stockLeather.black.standard.text":"Select a cloth or leather hardcover to add a chic, fashionable touch to your photo cover.","SilverApp.booktab.stockLeather.chocolate":"Chocolate leather","SilverApp.booktab.stockLeather.chocolate.glossy.text":"Select a cloth or leather hardcover to add a chic, fashionable touch to your photo cover. Glossy pages add a luxe sheen that strikingly enhances color and adds a protective finish to your book pages.","SilverApp.booktab.stockLeather.chocolate.standard.text":"Select a cloth or leather hardcover to add a chic, fashionable touch to your photo cover.","SilverApp.booktab.stockLinen.white":"Antique white linen","SilverApp.booktab.stockLinen.white.glossy.text":"Select a cloth or leather hardcover to add a chic, fashionable touch to your photo cover. Glossy pages add a luxe sheen that strikingly enhances color and adds a protective finish to your book pages.","SilverApp.booktab.stockLinen.white.standard.text":"Select a cloth or leather hardcover to add a chic, fashionable touch to your photo cover.","SilverApp.booktab.premiumLeather.black":"Genuine leather","SilverApp.booktab.premiumLeather.black.layflat.text":"Select our premium padded leather hardcover, featuring stitched edges and a gorgeous finish, for life’s most special occasions. Layflat pages create an unparalleled photo display with double-thick, satin-finish pages that lay flat and seamless for a stunning presentation.","SilverApp.booktab.premiumSilk.ivory":"Ivory crushed silk","SilverApp.booktab.premiumSilk.ivory.layflat.text":"Select our finest quality crushed silk hardcover for a beautiful finishing touch to your premium photo book.  Designed especially for your wedding album. Layflat pages create an unparalleled photo display with double-thick, satin-finish pages that lay flat and seamless for a stunning presentation.","SilverApp.booktab.hardMatte":"Hard matte photo cover","SilverApp.booktab.hardMatte.hinged.layflat.text":"Select a hard matte cover for a sophisticated, smudge-resistant finish. Standard layflat pages show off your photos across each spread of your book with a hinged binding on standard matte-finish paper.","SilverApp.booktab.hardMatte.layflat.text":"Select a hard matte cover for a sophisticated, smudge-resistant finish. Deluxe layflat pages create an unparalleled photo display with double-thick, satin-finish paper that lays flat for a seamless presentation.","SilverApp.booktab.hardMatte.glossy.text":"Select a hard matte cover for a sophisticated, smudge-resistant finish. Glossy pages add a luxe sheen that strikingly enhances color and adds a protective finish to your book pages.","SilverApp.booktab.hardMatte.standard.text":"Select a hard matte photo cover for a sophisticated, smudge-resistant finish.","SilverApp.booktab.hardMatteJacket":"Hard matte photo cover with dust jacket","SilverApp.booktab.hardMatteJacket.hinged.layflat.text":"Select a laminated, tear-resistant dust jacket, designed to match your cover finish, to beautifully protect your book. Standard layflat pages show off your photos across each spread of your book with a hinged binding on standard matte-finish paper.","SilverApp.booktab.hardMatteJacket.layflat.text":"Select a laminated, tear-resistant dust jacket, designed to match your cover finish, to beautifully protect your book. Deluxe layflat pages create an unparalleled photo display with double-thick, satin-finish paper that lays flat for a seamless presentation.","SilverApp.booktab.hardMatteJacket.glossy.text":"Select a laminated, tear-resistant dust jacket, designed to match your cover finish, to beautifully protect your book. Glossy pages add a luxe sheen that strikingly enhances color and adds a protective finish to your book pages.","SilverApp.booktab.hardMatteJacket.standard.text":"Select a laminated, tear-resistant dust jacket, designed to match your cover finish, to beautifully protect your book.","SilverApp.booktab.hardPadded":"Padded photo cover","SilverApp.booktab.hardPadded.layflat.text":"Select a padded cover as a decorative addition, perfect for coffee table display. Layflat pages create an unparalleled photo display with double-thick, satin-finish pages that lay flat and seamless for a stunning presentation.","SilverApp.booktab.hardPadded.glossy.text":"Select a padded cover as a decorative addition, perfect for coffee table display. Glossy pages add a luxe sheen that strikingly enhances color and adds a protective finish to your book pages.","SilverApp.booktab.hardPadded.standard.text":"Select a padded cover as a decorative addition, perfect for coffee table display.","SilverApp.booktab.hard":"Hard photo cover","SilverApp.booktab.hard.layflat.text":"Select a hard cover to help ensure your photo book lives on as an enduring keepsake. Deluxe layflat pages create an unparalleled photo display with double-thick, satin-finish paper that lays flat for a seamless presentation.","SilverApp.booktab.hard.hinged.layflat.text":"Select a hard cover to help ensure your photo book lives on as an enduring keepsake. Standard layflat pages show off your photos across each spread of your book with a hinged binding on standard matte-finish paper.","SilverApp.booktab.hard.glossy.text":"Select a hard cover to help ensure your photo book lives on as an enduring keepsake. Glossy pages add a luxe sheen that strikingly enhances color and adds a protective finish to your book pages.","SilverApp.booktab.hard.standard.text":"Select a hard cover to help ensure your photo book lives on as an enduring keepsake.","SilverApp.booktab.hardJacket":"Hard photo cover with dust jacket","SilverApp.booktab.hardJacket.hinged.layflat.text":"Select a laminated, tear-resistant dust jacket, designed to match your cover finish, to beautifully protect your book. Standard layflat pages show off your photos across each spread of your book with a hinged binding on standard matte-finish paper.","SilverApp.booktab.hardJacket.layflat.text":"Select a laminated, tear-resistant dust jacket, designed to match your cover finish, to beautifully protect your book. Deluxe layflat pages create an unparalleled photo display with double-thick, satin-finish paper that lays flat for a seamless presentation.","SilverApp.booktab.hardJacket.glossy.text":"Select a laminated, tear-resistant dust jacket, designed to match your cover finish, to beautifully protect your book. Glossy pages add a luxe sheen that strikingly enhances color and adds a protective finish to your book pages.","SilverApp.booktab.hardJacket.standard.text":"Select a laminated, tear-resistant dust jacket, designed to match your cover finish, to beautifully protect your book.","SilverApp.booktab.soft":"Soft photo cover","SilverApp.booktab.soft.glossy.text":"","SilverApp.booktab.soft.standard.text":"","SilverApp.booktab.entrytext":"Hover over radio buttons below to see book finishing examples","SilverApp.booktab.keepsakePocket.title":"Memorabilia pocket","SilverApp.booktab.keepsakePocket":"Keep all your memories in one place by adding a clear pocket perfect for storing and showcasing souvenirs and other keepsakes. Easily attaches to the front or back cover of your book.","SilverApp.storyboardtab.entrytext":"Drag photos into the Storyboard to place on pages. Layouts will be chosen automatically to fit the number of photos on a page.","SilverApp.arrangetab.entrytext":"Drag and drop pages to arrange your book","SilverApp.pagesView.entrytext":"Tap a page to edit","SilverApp.error":"Please try again","SilverApp.removepage.dialog.RemovePage":"Remove page","SilverApp.removepage.dialog.warning":"Are you sure you want to remove page {{value}}?","SilverApp.removepage.dialog.details":"The minimum number of pages for this project is {{value}}. Unable to delete the page.","SilverApp.removepages.dialog.RemovePage":"Remove pages","SilverApp.removepages.dialog.warning":"Are you sure you want to remove pages {{pageToRemoveFrom}}-{{pageToRemoveTo}}?","SilverApp.removepages.dialog.details":"The minimum number of pages for this project is {{value}}. New pages will be added to the end.","SilverApp.yes":"Yes","SilverApp.no":"No","SilverApp.continue":"Change size","SilverApp.continueDialog":"Continue","SilverApp.note":"Note:","SilverApp.changeSizeWarningDialog.coverChangeTitle":"Your project will change","SilverApp.changeSizeWarningDialog.aspectChangeTitle":"Your project will change","SilverApp.changeSizeWarningDialog.coverChangeReviewNote":"To see all options go to the Book tab in the header.","SilverApp.changeSizeWarningDialog.aspectChangeReviewNote":"To revert to the previous cover and size, select Undo.","SilverApp.changeSizeWarningDialog.priceChangeReviewNote":"Project pricing will change.","SilverApp.changeSizeWarningDialog.coverChangeMessage":"If you change from {{sizeBefore}} to {{sizeAfter}}, the project cover will change:","SilverApp.changeSizeWarningDialog.aspectChangeMessage":"If you make this change, your {{sizeBefore}} project will become an {{sizeAfter}} project.","SilverApp.changeSizeWarningDialog.coverAndAspectChangeMessage":"Please review your new project carefully:","SilverApp.changeSizeWarningDialog.textNotFitMessage":"Text may no longer fit or wrap differently.","SilverApp.changeSizeWarningDialog.photoCropMessage":"Photos may be cropped or have a lower resolution.","SilverApp.changeSizeWarningDialog.layoutChangedMessage":"Layouts may change.","SilverApp.changeSizeWarningDialog.coverTypeMessage":"From {{coverBefore}} to {{coverAfter}}.","SilverApp.changeStyleWarningDialog.title":"Your project's style will be changed","SilverApp.changeStyleWarningDialog.message1":"All pages will be changed from: '{{previousStyleName}}' to '{{newStyleName}}'.","SilverApp.changeStyleWarningDialog.message2":"Backgrounds, stickers, fonts and frames will be changed. Your photos and text will remain unchanged.",
"SilverApp.changeStyleWarningDialog.message3":"You will see this icon if there are any problems with your project.","SilverApp.changeStyleWarningDialog.message4":"Note: To revert to the previous style, select Undo.","SilverApp.changeStyleWarningDialog.simple":"To revert to the previous style, select Undo.","SilverApp.changeStyleWarningDialog.simpleTitle":"Your project's style has been changed","SilverApp.editImage.reset":"Reset","SilverApp.editImage.remove":"Remove photo","SilverApp.editImage.redEye":"Red eye","SilverApp.editImage.redEyeFix":"Fix","SilverApp.editImage.redEyeInstructions":"Drag the magnifier over the red eye and click to fix.","SilverApp.editImage.redEyeDisabled":"Sign in to enable","SilverApp.editImage.rotate":"Rotate","SilverApp.editImage.disableFilters":"Turn off effects and photo correction","SilverApp.editImage.filter.None":"No effect","SilverApp.editImage.filter.Auto":"Auto","SilverApp.editImage.filter.Sunshine":"Sunshine","SilverApp.editImage.filter.BlackWhite":"B&W","SilverApp.editImage.filter.Sepia":"Sepia","SilverApp.editImage.filter.Vibrant":"Vibrant","SilverApp.editImage.filter.Vintage":"Vintage","SilverApp.editImage.filter.Fade":"Fade","SilverApp.editImage.warnings.lowResolution":"Photo has low resolution and may not print well","SilverApp.contact":"\nEmail: customerservice@cs.shutterfly.com\nPhone: 1-888-225-7159\nMonday - Friday: 6am - 5pm Pacific time\nSaturday - Sunday: 8:30am - 5pm Pacific time\n\n","SilverApp.pleaseProvide":"Please provide this information to customer service.\n\n","SilverApp.sorry":"We are sorry for the trouble. It looks like something went wrong. Please try again.","SilverApp.sorryAgain":"If you still have problems, contact Shutterfly customer service:\n","SilverApp.showDetails":"Show info","SilverApp.hideDetails":"Hide info","SilverApp.selectStyle":"Select a style","SilverApp.changeCoverWarningDialog.title":"Your project size will change with new cover","SilverApp.changeCoverWarningDialog.priceChange":"Your project pricing will change with the new size.","SilverApp.changeCoverWarningDialog.changeSize":"Change cover and size","SilverApp.changeCoverWarningDialog.dontChangeSize":"Don't change","SilverApp.changeCoverWarningDialog.coverChangeMessage":"Changing from a {{coverBefore}} to {{coverAfter}} will change the currently selected size:","SilverApp.changeCoverWarningDialog.sizeChangeMessage":"From a {{sizeBefore}} project to a {{sizeAfter}} project.","SilverApp.changeCoverWarningDialog.pleaseReviewMessage":"Please review your project carefully and check for:","SilverApp.postChangeCoverWarningDialog.newBookIsReady":"Your new project is ready","SilverApp.postChangeCoverWarningDialog.weMadeACopy":"We made a copy of your project.","SilverApp.upgradeProjectWarningDialog.title":"Cover not available","SilverApp.upgradeProjectWarningDialog.briefBody":"The cover you selected is no longer available and has been changed.","SilverApp.upgradeProjectWarningDialog.body":"The cover and/or size you selected is no longer available and has been changed. Use the Book tab to update your project and continue editing.","SilverApp.postChangeCoverWarningDialog.warningInfo":"You will see this icon if there are any problems with your project.","SilverApp.unsavedChanges":"If you continue, you will lose unsaved changes to your project.","SilverApp.noProjects":"There are no projects in your account.","SilverApp.textTooltipEmpty":"Click to edit.\nText will not print if blank.","SilverApp.textTooltipEvent":"Click to edit event","SilverApp.textTooltip":"Click to edit text","SilverApp.textTooltipCustomizeEmpty":"Double-click to edit.\nText will not print if blank.","SilverApp.textTooltipCustomize":"Double-click to edit text","SilverApp.textTooltipEventCustomize":"Double-click to edit event","SilverApp.imageTooltip":"Drag photo to move.\nClick to edit.","SilverApp.imageTooltipCustomize":"Drag photo to move.\nDouble-click to edit.","SilverApp.imageTooltipCustomizeLocked":"Double-click to edit.","SilverApp.imageDragTooltip":"Drag photo to move","SilverApp.imageTooltipNotUploading":"Unable to edit until upload completes.","SilverApp.imageTooltipNotUploadingCover":"Unable to change cover photo until uploads complete.","SilverApp.imageTooltipUploading":"Photo is uploading, unable to edit.","SilverApp.imageTooltipEmpty":"Drag your photo here.\nThe gray space will not print if left blank.","SilverApp.imageTooltipEmptyLocked":"Drag your photo here.","SilverApp.dateEventPromptTooltip":"\nClick the date to edit event.","SilverApp.eventPromptTooltip":"\nClick to edit event.","SilverApp.eventAddPromptTooltip":"\nClick to add/edit events.","SilverApp.imageEventTooltip":"Click to edit photo or events. \n Drag photo to move.","SilverApp.openOnDesktopWarningDialog.simpleTitle":"Your project must be opened on a desktop","SilverApp.openOnDesktopWarningDialog.message1":"This project was last saved on a desktop, and it must be opened on a desktop","SilverApp.removeImageTooltipEmpty":"Remove photo area","SilverApp.removeImageTooltip":"Remove photo","SilverApp.removePageTooltip":"Remove page","SilverApp.removeStickerTooltip":"Delete sticker","SilverApp.pageTabPageTooltip":"Drag to move","SilverApp.arrangeInnerPageTooltip":"Drag to move.\nDouble click to zoom in.","SilverApp.arrangeCoverPageTooltip":"Double click to zoom in","SilverApp.arrangeCoverPageLayoutsTooltip":"Click to change layout","SilverApp.arrangeInsertPageTooltip":"Click to add a page","SilverApp.arrangePageTooltip":"Double click to zoom in","SilverApp.pageTooltip":"Double click to zoom out","SilverApp.pageWarningTooltip":"Review page warnings","SilverApp.dragPhotoToPage":"Drag photos from photos tab to add to page","SilverApp.from":"from ","SilverApp.ideaPage":"Idea page","SilverApp.ideaPageLabelTooltip":"Idea pages cannot be modified.\nChoose a new layout.","SilverApp.upsell.calculatingPrice":"Calculating price...","SilverApp.upsell.option.dustjacket.title":"Add a dust jacket?","SilverApp.upsell.option.dustjacket.descr":"Select a laminated, tear-resistant dust jacket, designed to match your cover finish, that beautifully protects your project.","SilverApp.upsell.option.hardcover.title":"Upgrade to a hard cover?","SilverApp.upsell.option.hardcover.descr":"Select a hard cover to ensure your photo book lives on as an enduring keepsake.","SilverApp.upsell.option.mattefinish.title":"Upgrade to a matte cover?","SilverApp.upsell.option.mattefinish.descr":"Select a matte hard cover for a sophisticated, smudge-resistant finish.","SilverApp.upsell.option.glossypaper.title":"Upgrade to glossy pages?","SilverApp.upsell.option.glossypaper.descr":"Select glossy pages for a luxe sheen that strikingly enhances color and adds a protective finish to your book pages.","SilverApp.upsell.option.layflat.title":"Upgrade to deluxe layflat?","SilverApp.upsell.option.layflat.descr":"Deluxe layflat pages create an unparalleled photo display with double-thick, satin-finish paper that lays flat for a seamless presentation.","SilverApp.upsell.option.hinged.title":"Upgrade to standard layflat?","SilverApp.upsell.option.hinged.descr":"Standard layflat pages show off your photos across each spread of your book with a hinged binding on standard matte-finish paper.","SilverApp.upsell.option.keepsakepocket.title":"Add a memorabilia pocket?","SilverApp.upsell.option.keepsakepocket.descr":"Keep all your memories in one place by adding a clear pocket perfect for storing and showcasing souvenirs and other keepsakes. Easily attaches to the front or back cover of your book.","SilverApp.storytellingCapTitle":"Congratulations, you now have unlimited use of a la carte Storytelling™ style items","SilverApp.storytellingCapMessage1":"You've used enough Storytelling™ style items for our $5.99 flat rate for unlimited use of premium idea pages, backgrounds, and embellishments in this project.","SilverApp.storytellingCapMessage2":"Just look for items with the Storytelling™ icon:","SilverApp.allowUndoAutofillModalTitle":"Would you like help placing your photos?","SilverApp.allowUndoAutofillModalTitleDescription":"We have arranged your photos by date taken. How would you like to start?","SilverApp.allowUndoAutofillModal.startWithPhotosPlaced":"Start with photos placed","SilverApp.allowUndoAutofillModal.placePhotosMyself":"Place photos myself","SilverApp.missingImages.title":"Please review your project","SilverApp.missingImages.message":"There were problems uploading some images and they were removed from your project.<br />Please review the following pages: ","Book.Palette.pages":"Pages","Calendar.Palette.pages":"Months","Palette.photo":"Photos","Palette.addPhotos":"Add photos","Palette.backgrounds":"Backgrounds","Palette.layouts":"Layouts","Palette.ideaPages":"Idea pages","Palette.events":"Events","Palette.events.instructions":"Click on a day in the calendar to add events.","Palette.embellishments":"Embellishments","Palette.hideUsed":"Hide used","Palette.clusterStoryboard":"Group by","Palette.clusterPhotosBy":"Group photos by:","Palette.clusterPhotosByHour":"Hour","Palette.clusterPhotosByDay":"Day","Palette.clusterPhotosByWeek":"Week","Palette.clusterPhotosByMonth":"Month","Palette.clusterPhotosByYear":"Year","Palette.clusterNote1":"Note: Photos are sorted independently within each group","Palette.clusterNote2":"Turn off grouping to sort all photos together","Palette.highlights":"Highlights","Palette.groupDuplicates":"Stack duplicates","Palette.frontCover":"Front cover","Palette.backCover":"Back cover","Palette.addPages":"Add pages","Palette.getMoreLayouts":"Get more layouts","Palette.getMoreBackgrounds":"Get more backgrounds","Palette.getMoreEmbellishments":"Get more embellishments","Palette.getMoreIdeaPages":"Get more idea pages","Palette.uploadInProgress":"Uploading ({{value}})","Palette.whereDoYouWantYourPicture":"Where would you like to add your photos?","Palette.photoStrip":"Photos tab","Palette.placeInStrip":"You can drag them on to each page.","Palette.newPage":"New page","Palette.createNewPagesWithTheseImages":"New pages will be added to the end of the project.","Palette.Ok":"OK","Palette.Cancel":"Cancel","Palette.NoItemForCover":"Items cannot be applied to this cover","Palette.uploadInProgressModalTitle":"We are uploading your photos to Shutterfly","Palette.uploadInProgressModalBody":"You can dismiss this dialog and continue to work on your project, but we cannot save the project until the process is complete. If you have selected local photos, please do not disconnect any cameras or external drives.","Palette.uploadInProgressCancel":"Cancel uploads","Palette.uploadErrorTitle":"{{value}} photos could not be uploaded.","Palette.uploadErrorModalBody":"Please check your internet connection and try again.<br /><br />If you still have problems, make sure you have not moved, renamed or removed the photos on your computer.<br /><br />Close this box to return to your project and remove the marked photos.","Palette.uploadErrorModalBodyPhone":"Please check your internet connection and<br /> try again.<br /><br />Close this box to return to your project and<br /> remove the marked photos.","Palette.uploadErrorModalBodySuffix":"Photos that were placed in the project will be removed.","Palette.uploadErrorModalBodySuffixPhone":"Photos that were<br /> placed in the project will be removed.","Palette.removePlacedImages":"Remove placed photos","Palette.uploadErrorModalDescription":"Sample thumbnail","Palette.retryUpload":"Try again","Palette.close":"Close","Palette.uploading":"Uploading","Palette.of":"of","Palette.layouts.1":"1","Palette.layouts.2":"2","Palette.layouts.3":"3","Palette.layouts.4":"4","Palette.layouts.5":"5+","Palette.layouts.text":"Text","Palette.layouts.spreads":"Spreads","Palette.modeTwo":"Two palette workspace","Palette.modeOne":"One palette workspace","Palette.mode.subtext":"Layouts on left and photos on bottom","Palette.modes.advance.edit":"","Palette.modes.advance.edit.subtext":"","Palette.line":"Line","Palette.extended.title":"Get design elements","Palette.extended.button":"Get more","Palette.extended.addbutton":"Add to project","Palette.extended.footer":"Part of Storytelling styles a la carte","Palette.extended.footer.learnmore":"learn more","Palette.extended.numitems":"Showing {{value}} item(s)","Palette.extended.pages":"Pages","Palette.extended.type":"Type","Palette.extended.interior":"Interior pages","Palette.extended.spread":"Spread","Palette.extended.cover":"Cover","Palette.extended.layouts":"Layouts","Palette.extended.backgrounds":"Backgrounds","Palette.extended.embellishments":"Embellishments","Palette.extended.stickers":"Stickers","Palette.extended.ribbons":"Ribbons","Palette.extended.frames":"Frames","Palette.extended.ideapages":"Idea pages","Palette.extended.layouts.lowercase":"layouts","Palette.extended.backgrounds.lowercase":"backgrounds","Palette.extended.ideapages.lowercase":"idea pages","Palette.extended.manage.events":"Manage events","Palette.stickers.lowercase":"stickers","Palette.ribbons.lowercase":"ribbons","Palette.frames.lowercase":"frames","Palette.extended.searchText":"Search {{value}}","Palette.extended.search.numitems":"Found {{value}} item(s)","Palette.extended.popupItemPrice":"{{value}} for unlimited use in this project","Palette.extended.noCharge":"No additional charge for use of this item","Palette.extended.favorites.title":"Favorites ({{value}})","Palette.extended.favorites.message":"Advanced filtering not available while browsing favorites","Palette.imageDelete.title":"Error Deleting Image","Palette.imageDelete.description":"This image is used in your project and cannot be deleted.","Palette.photoStack.dragMessage":"Drag photos onto a page","SilverApp.move.button":"Move","SilverApp.add.button":"Add","SilverApp.goto.button":"Goto","SilverApp.applySettings.button":"Apply settings","SilverApp.addPageTooltip":"Click to add a page","SilverApp.noThanks":"No thanks","SilverApp.skip":"Skip","SilverApp.sort.by":"Sort by","SilverApp.sort.by.added.ascending":"Order added to project","SilverApp.sort.by.added.descending":"Order added to project (reverse)","SilverApp.date.taken.ascending":"Date taken (oldest to newest)","SilverApp.date.taken.descending":"Date taken (newest to oldest)","SilverApp.sort.by.title.ascending":"Title (A-Z)","SilverApp.sort.by.title.descending":"Title (Z-A)","Palette.numPhotos":"{{value}} photos","SilverApp.getStarted":"Get started","SilverApp.storyBoardTitle":"Save time with Storyboard","SilverApp.storyBoardText":"Drag the photos on the left to pages on the right to organize your project. We will find a layout that fits each group of photos. Return to the Edit tab to continue to customize text, layouts or backgrounds.","SilverApp.prompt.storyboardTitle":"Create your calendar faster with Storyboard","SilverApp.prompt.storyboardText":"Drag your photos to each page of your project and we'll instantly add and arrange them for you - it's that easy.","SilverApp.doNotShowAgain":"Do not show again","SilverApp.Page":"Page {{value}}","SilverApp.Share.dialog.title":"Share","SilverApp.Share.dialog.submit":"Send","SilverApp.Share.dialog.desc":"Now, share your masterpiece with others.","SilverApp.Share.dialog.tab.email":"Email","SilverApp.Share.dialog.tab.facebook":"Facebook","SilverApp.Share.dialog.tab.pinterest":"Pinterest","SilverApp.Share.dialog.tab.weblink":"Web link","SilverApp.Share.dialog.tab.other":"More options","SilverApp.Share.dialog.emails":"Email addresses","SilverApp.Share.dialog.subject":"Shared project:","SilverApp.Share.dialog.message":"Hey! Check out this project I made.","SilverApp.Share.dialog.emailmessage":"Take a look at my Shutterfly project.","SilverApp.Share.dialog.charlimitlabel":"Characters remaining: ","SilverApp.Share.dialog.fbmessage":"Take a look at my Shutterfly project.","SilverApp.Share.dialog.pinterestmessage":"Take a look at my Shutterfly project.","SilverApp.Share.subject":"Shared project from Shutterfly","SilverApp.Share.message":"Take a look at my Shutterfly project.","SilverApp.Share.dialog.submit.email":"Send","SilverApp.Share.dialog.submit.facebook":"Post","SilverApp.Share.dialog.submit.pinterest":"Pin","SilverApp.Share.dialog.submit.weblink":"Copy link","SilverApp.Share.dialog.submit.other":"OK","SilverApp.Share.dialog.emailsent":"Email sent","SilverApp.Share.dialog.fbposted":"Continue your share process in the Facebook window.","SilverApp.Share.dialog.pinterestposted":"Continue your share process in the Pinterest window.","SilverApp.Share.dialog.error":"Error!","SilverApp.Share.dialog.close":"Close","SilverApp.Share.dialog.requiredEmail":"Email address is required","SilverApp.Share.dialog.invalidEmail":"Invalid email address","SilverApp.Share.dialog.link":"Select Copy link to copy URL","SilverApp.Share.dialog.linknocopy":"Project share URL","SilverApp.Share.dialog.disabled":"You have exceeded the maximum number of share attempts. Please try again in one hour.","SilverApp.Share.dialog.other.sites":"Add to my share site (or create a new one)","SilverApp.Share.dialog.other.embed":"Options to get embed code and post to other web sites","SilverApp.tour":"Intro tour...","SilverApp.tour.introTitle":"Welcome","SilverApp.tour.startTour":"Start tour","SilverApp.tour.exportPDFTourContent":"Use 'Export to PDF...' to save your book as a PDF file and share with others when collaborating on book creation.","SilverApp.tour.importPageTourContent":"Use 'Import page...' to use pages from other books you have created.","SilverApp.tour.onePaletteWorkspaceContent":"Use 'One Palette Workspace...' to eliminate the bottom palette, moving photos to the left palette and making month selection always available.","SilverApp.tour.introTourContent":"We've updated our photo book creation path to give you an even better experience.<br><br>Let's take a quick tour.","SilverApp.tour.toolbarTourContent":"Use the toolbar to add photos and pages or undo unwanted changes.","SilverApp.tour.editTabTourContent":"Use the Edit tab for photos and the Arrange tab to move pages and organize your book your way. In the Book tab, choose premium cover and paper types for your book.","SilverApp.tour.bookTabTourContent":"Choose premium cover and paper types for your book","SilverApp.tour.storyboardTabTourContent":"Use the Storyboard tab to organize photos and create your project faster.","SilverApp.tour.paletteTabTourContent":"Choose photo layouts and backgrounds that suit your style. Try new spread layouts.","SilverApp.tour.orderButtonTourContent":"Order one or more copies of your book and add a gift box and other accessories","SilverApp.tour.addPhotosButtonTourContent":"Add photos from multiple sources and autofill your book","SilverApp.tour.saveButtonTourContent":"Name and save your book and future changes will automatically be saved every 10 minutes.","SilverApp.tour.highlightsTourContent":"Highlights excludes similar photos and low quality images.","SilverApp.gc.tour.introTourContent":"Exciting news! We listened to your feedback and have launched an upgraded calendar creation experience. With new styles, features and embellishments, you can personalize every detail and create your calendar just the way you want.<br><br>Let's take a quick tour.","SilverApp.gc.tour.editTabTourContent":"With our new Edit tab, you can pick from different designs and layouts and also add photos and text anywhere on your calendar.<br><br>The Events tab lets you personalize special dates with photos, text and stickers.","SilverApp.gc.tour.storyboardTabTourContent":"Create your calendar faster with the Storyboard tab! Simply drag and drop photos to each page of your calendar and we’ll instantly arrange them for you – it’s that easy.","SilverApp.gc.tour.paletteTabTourContent":"Choose layouts and backgrounds to get creative and make a calendar that suits your style.","SilverApp.gc.tour.toolbarTourContent":"This toolbar lets you add photos and pages, and our undo/redo buttons make it easy to get the look you want without starting over.","SilverApp.gc.tour.highlightsTourContent":"Highlights helps you find your best photos by filtering out similar photos and low quality images.","SilverApp.gc.tour.embellishmentsTourContent":"Add fun and unique personal touches with our new embellishments! Choose from hundreds of stickers, patterns, frames and more.","Palette.stickers":"Stickers","Palette.ribbons":"Ribbons","Palette.frames":"Frames","SilverApp.pab.popover.title":"Photo as background","SilverApp.pab.popover.message.active":"Drag and drop a photo onto the gray area of the page to use it as the background for this page.","SilverApp.customize.popover.title":"Advanced editing","SilverApp.customize.popover.title.collage":"Customize collage","SilverApp.customize.popover.message.active":"You are in advanced editing - you can move and resize stickers, frames, text, and photos freely. Click 'Exit advanced editing' to exit.","SilverApp.selectPhotosPrompt":"Select photos and we will instantly arrange them into a beautiful book.","SilverApp.selectPhotosPromptCalendars":"Select photos from various sources to add them to pages in your calendar.","SilverApp.selectPhotos":"Select photos","SilverApp.arrangeTitle":"Arrange pages and photos","SilverApp.tooltip.arrangeTab":"Arrange pages and photos","SilverApp.tooltip.bookTab":"Change your cover and paper type","SilverApp.tooltip.styleTab":"Change your style","SilverApp.tooltip.editTab":"Edit your project","SilverApp.tooltip.layoutsTab":"Choose layouts for pages","SilverApp.tooltip.embellishmentsTab":"Choose stickers, ribbons or frames","SilverApp.tooltip.ideaPagesTab":"Choose idea pages","SilverApp.tooltip.eventsTab":"Events","SilverApp.tooltip.backgroundsTab":"Change the backgrounds for pages","SilverApp.tooltip.pagesTab":"See all the pages in your project","SilverApp.tooltip.monthsTab":"See all the months in your project","SilverApp.tooltip.zoom":"Zoom","SilverApp.tooltip.whatsNew":"See what's new","SilverApp.tooltip.photosTab":"See all the photos in your project","SilverApp.tooltip.Tab":"Change your style","SilverApp.tooltip.storyboardTab":"Easily organize your project","SilverApp.arrangeText":"Arrange now lets you move, delete and add photos to pages in addition to re-arranging your pages.","SilverApp.preview":"Preview","SilverApp.editTitle":"Edit cover text","SilverApp.storytellingItemCount":"{{value}} Storytelling item(s)","SilverApp.storytellingPass":"Storytelling items","SilverApp.storytellingStyle":"Storytelling style","SilverApp.options":"Options","SilverApp.returnToEditFromPreview":"Exit preview","SilverApp.editTitleMenuCover":"Edit cover text...","SilverApp.editTitleMenuSpine":"Edit spine text...","Palette.styles":"Styles","SilverApp.frontCoverPhone":"Front","SilverApp.backCoverPhone":"Back","SilverApp.exitAdvancedEdit":"Exit advanced editing","SilverApp.exitAdvancedEditCollage":"Exit customize collage","SilverApp.selectACover":"Select a cover","SilverApp.bookType":"Book Type","SilverApp.styleModernWhite":"Modern White","SilverApp.styleBlackAndWhiteBackdrop":"Black And White Backdrop","SilverApp.styleBrightAndBold":"Bright And Bold","SilverApp.styleHelloLove":"Hello Love","SilverApp.styleThroughTheSeasons":"Through the Seasons","SilverApp.switchToCustomPath":"Switch to Custom Path","SilverApp.switchToSimplePath":"Switch to Simple Path","SilverApp.hotkey.customize.windows":"Ctrl+D","SilverApp.hotkey.customize.mac":"⌘D","SilverApp.hotkey.save.windows":"Ctrl+S","SilverApp.hotkey.save.mac":"⌘S","SilverApp.hotkey.addphotos.windows.menu":"Ctrl+U","SilverApp.hotkey.addphotos.mac.menu":"⌘U","SilverApp.hotkey.addtext.windows.menu":"Ctrl+B","SilverApp.hotkey.addtext.mac.menu":"⌘B","SilverApp.hotkey.addphoto.windows.menu":"Ctrl+E","SilverApp.hotkey.addphoto.mac.menu":"⌘E","SilverApp.hotkey.addphotos.windows":"Add photos (Ctrl+U)","SilverApp.hotkey.addphotos.mac":"Add photos (⌘U)","SilverApp.hotkey.addtext.windows":"Add text box (Ctrl+B)","SilverApp.hotkey.addtext.mac":"Add text (⌘B)","SilverApp.hotkey.addphoto.windows":"Add photo area (Ctrl+E)","SilverApp.hotkey.addphoto.mac":"Add photo area (⌘E)","SilverApp.hotkey.undo.windows":"Undo (Ctrl+Z)","SilverApp.hotkey.undo.mac":"Undo (⌘Z)","SilverApp.hotkey.redo.windows":"Redo (Ctrl+Y)","SilverApp.hotkey.redo.mac":"Redo (⇧⌘Z)","SilverApp.hotkey.selectall.windows":"Ctrl+A","SilverApp.hotkey.selectall.mac":"⌘A","SilverApp.createPhotoSpread":"Create photo spread","SilverApp.shutterflyHomePage":"Go to the\n Shutterfly home page","SilverApp.startOver":"Start over","SilverApp.feedback":"Send us your feedback","SilverApp.selectCoverPhotoMenu":"Select cover photo...","SilverApp.selectCoverPhoto":"Select cover photo","SilverApp.exitToMyShutterfly":"Exit to My Shutterfly","SilverApp.mmb.introTitle":"Welcome to your custom designed photo book","SilverApp.mmb.introText":"What’s next?<br>&bull; Review your photo book.<br>&bull; Make any edits you like directly in the book.<br>&bull; Order your book at any time.","SilverApp.mmb.introText.mobile":"What’s next?<br>&bull; Review your photo book.<br>&bull; Make any edits you like directly <span class='red-text'>by opening the book on your desktop.</span><br>&bull; Order your book at any time.","SilverApp.mmb.reviewBook":"Review book","Calendars.product.name":"Calendar","Calendars.eventstab.entrytext":"Create your own events then select them to add to your current project","Calendars.eventstab.myEvents":"My events","Calendars.eventstab.publicHolidays":"Public holidays","Calendars.eventstab.maxEvents":"Maximum 2 active events per day","Calendars.eventstab.addNewEvent":"+ Create new event","Calendars.eventstab.resetPublicEvents":"Reset to default selection","Calendars.eventstab.addToProject":"Show","Calendars.eventstab.edit":"Edit/Remove","Calendars.eventstab.selectAll":"Select all","Calendars.eventstab.photo":"Photo","Calendars.eventstab.eventName":"Event name","Calendars.eventstab.relationship":"Relationship","Calendars.eventstab.occasion":"Occasion","Calendars.eventstab.occurrence":"Occurrence","Calendars.eventstab.noEventsListed":"No events listed","Calendars.eventstab.saved":"Events added to this list will be saved.","Calendars.eventstab.notLoggedIn":"Sign in to view and edit your events.","Calendars.eventstab.login":"Sign in","Calendars.eventstab.deleteEvent":"Delete event","Calendars.eventstab.deleteModalLine1":"If you continue, this event will be permanently removed from My Calendar lists.","Calendars.eventstab.deleteModalLine2":"Are you sure that you want to delete this event?","Calendars.eventstab.selectionModalContent":"Only 3 events can be enabled for the same day. Uncheck an event to enable an additional one.","Calendars.eventstab.selectionModalHeader":"Cannot enable event","Calendars.eventstab.selectionInlineWarning":"This day already has 3 active events. This event will be inactive when saved.","Calendars.eventstab.eventsIntroTitle":"Add events to your calendar","Calendars.eventstab.eventsIntroText":"Review your list and select the events you would like to add to your calendar.","Calendars.eventstab.eventsIntroTextWithSignin":"Sign in to access your saved events or to add your own.","Calendars.eventstab.filterBy":"Filter: ","Calendars.EventFilter.showAll":"Show all","Calendars.EventFilter.myEvents":"My events","Calendars.EventFilter.publicEvents":"Public events","Calendars.eventsdialog.eventTextBackground":"Translucent Text Background","occasion default":"Occasion","occasion anniversary":"Anniversary","occasion birthday":"Birthday","occasion celebration":"Party/Celebration","occasion graduation":"Graduation","occasion holiday":"Public holiday","occasion wedding":"Wedding","occasion bar_mitzvah":"Bar/Bat Mitzvah","occasion vacation":"Vacation","occasion other":"Other event","occurrence default":"Occurrence","occurrence false":"One time event","occurrence true":"Every year","relationship default":"Relationship","relationship my_own":"My own","relationship significant_other":"Significant other","relationship child":"Child","relationship mother":"Mother","relationship father":"Father","relationship sibling":"Sibling","relationship grandparent":"Grandparent","relationship aunt_uncle":"Aunt/Uncle","relationship friend":"Friend","relationship teacher":"Teacher","relationship other":"Other","Calendar.cover.label":"COVER","Calendar.cover.1":"JAN","Calendar.cover.2":"FEB","Calendar.cover.3":"MAR","Calendar.cover.4":"APR","Calendar.cover.5":"MAY","Calendar.cover.6":"JUN","Calendar.cover.7":"JUL","Calendar.cover.8":"AUG","Calendar.cover.9":"SEP","Calendar.cover.10":"OCT","Calendar.cover.11":"NOV","Calendar.cover.12":"DEC","Calendar.cover.jan":"JAN","Calendar.cover.feb":"FEB","Calendar.cover.mar":"MAR","Calendar.cover.apr":"APR","Calendar.cover.may":"MAY","Calendar.cover.jun":"JUN","Calendar.cover.jul":"JUL","Calendar.cover.aug":"AUG","Calendar.cover.sep":"SEP","Calendar.cover.oct":"OCT","Calendar.cover.nov":"NOV","Calendar.cover.dec":"DEC","Calendar.cover.january":"January","Calendar.cover.february":"February","Calendar.cover.march":"March","Calendar.cover.april":"April","Calendar.cover.june":"June","Calendar.cover.july":"July","Calendar.cover.august":"August","Calendar.cover.september":"September","Calendar.cover.october":"October","Calendar.cover.november":"November","Calendar.cover.december":"December","Calendar.navigation.top":"TOP","Calendar.navigation.bottom":"BOTTOM","Calendar.palette.layoutsDisabled":"No additional layouts available for current page selection","Calendar.palette.ideaPagesDisabled":"No additional idea pages available for current page selection","SilverApp.objectMenu":"Object","SilverApp.editMenu":"Edit","SilverApp.editMenuSelectAll":"Select all","SilverApp.editMenuCut":"Cut","SilverApp.editMenuCopy":"Copy","SilverApp.editMenuPaste":"Paste","SilverApp.removeUnusedPhotos.title":"Remove unused photos","SilverApp.removeUnusedPhotos.text":"Are you sure you want to remove all unused photos from this project?","SilverApp.removeUnusedPhotos.note":"Note: Removing unused photos will not delete the photos, it only removes them from this project to free up space for other photos.","SilverApp.removeUnusedPhotos.cancel":"Don't remove","SilverApp.removeUnusedPhotos.confirm":"Remove","SilverApp.removeStickers.menuItem":"Remove stickers...","SilverApp.removeStickers.title":"Remove stickers","SilverApp.removeStickers.text":"Select which stickers you would like to remove","SilverApp.removeStickers.fromPage.formatedPageNumber":"page {{value}}","SilverApp.removeStickers.fromPage":"Remove stickers from {{value}} only","SilverApp.removeStickers.fromBook":"Remove all stickers from book","SilverApp.removeStickers.button.cancel":"Don't remove","SilverApp.removeStickers.button.confirm":"Remove","Palette.itemsNotAddedToProject":"Want to add {{value}} to your project?","Palette.addItemsToProject":"Click here","Palette.ideaPagesNotAddedToProject":"Want to add idea pages to your project?","Palette.addIdeaPagesToProject":"Click here","Slideshow.ipad.mercury.downloadApp":"Make a photo book on your iPad with Shutterfly Photo Story. DOWNLOAD THE APP >","Slideshow.iphone.voyager.downloadApp":"Capture your own adventure with the TripPix app. It's a quick and easy way to create permanent keepsakes of your most epic moments. DOWNLOAD THE APP >","Slideshow.iphone.apollo.downloadApp":"Create your own album with the BabyPix app. It's a quick and easy way to create permanent keepsakes of your most epic moments. DOWNLOAD THE APP >","Slideshow.iphone.ranger.downloadApp":"Create your own album with the SocialPix app. It's a quick and easy way to create permanent keepsakes of your most epic moments. DOWNLOAD THE APP >","SilverApp.tabletTitle":"Making your photo book is as easy as 1, 2, 3","SilverApp.tabletText":"1. Select all your photos for your book, choosing at least 20 photos.<br>2. We'll arrange all your photos into beautiful spread layouts.<br>3. Tap, hold and drag to rearrange photos or entire pages.<br>","SilverApp.tabletLink1":"Try our  ","SilverApp.tabletLink2":"Photo Story for iPad app ","SilverApp.tabletLink3":"for even more customization options. Choose from more styles, add doodles, audio and more.",
"SilverApp.tablet.addPhoto":"Add photos","SilverApp.tablet.addPhotos":"Add photos","SilverApp.tablet.swapLayout":"Swap layout","SilverApp.tablet.swapPhotos":"Shuffle photos","SilverApp.tablet.squareBooks":"Square sizes","SilverApp.tablet.rectangularBooks":"Rectangular sizes","SilverApp.tablet.changeSizeNote":"Note: Changing between square and rectangular sizes will change the layouts of some pages.","SilverApp.rotationMessage":"Please rotate your device to make your project","SilverApp.tablet.summary.intro.ready":"Your book is ready. Swipe to open.","SilverApp.tablet.summary.action.shuffleHeader":"You can also:","SilverApp.tablet.summary.action.shuffle":"Shuffle cover photos","SilverApp.tablet.summary.instr.edit":"Tap on photo to edit it","SilverApp.tablet.summary.instr.move":"Tap and hold to move it","SilverApp.tablet.showText":"Show text","SilverApp.tablet.hideText":"Hide text","SilverApp.tablet.addMorePages":"Add more pages","SilverApp.tablet.notEnoughPhotos":"Not enough photos selected","SilverApp.tablet.youNeedPhotos1":"You need between","SilverApp.tablet.youNeedPhotosAnd":"and ","SilverApp.tablet.youNeedPhotos2":"photos to make your book.<br>Click OK to add photos.","SilverApp.tablet.swap":"Swap","SilverApp.cannotEditPhotoTitle":"Uploading photo","SilverApp.cannotChooseCoverPhotoTitle":"Uploading photos","SilverApp.exportToPDFContent":"Export will be saved to file: '{{value}}'","SilverApp.exporting":"Exporting page: ","SilverApp.exportToPDF":"Export to PDF","SilverApp.saveJPG":"Save page as JPG","SilverApp.cannotSaveJPG":"This operation is only available to migrated Shutterfly users. Contact customer service for more information.","SilverApp.saveJPGFilenameContent":"Page will be save to your account in this folder:\n\n'My Albums/{{value}}'","SilverApp.export":"Export","SilverApp.exportPreview":"PREVIEW","SilverApp.exportPage":"Page","SilverApp.exportInstructions":"What would you like to export?","SilverApp.exportCurrentPage":"Current page","SilverApp.exportEntireBook":"Entire book","SilverApp.unrecoverable.title":"Unrecoverable errors found","SilverApp.unrecoverable.message":"Some errors have been found since last saving that can't be fixed. Recent work may have been lost. Please reopen your project and continue.","SilverApp.unrecoverable.reopen":"Reopen project","SilverApp.smartStoryboard.blankPage":"Inside cover","SilverApp.smartStoryboard.makeSpread.tooltip":"Make spread","SilverApp.smartStoryboard.splitSpread.tooltip":"Split spread","HelpOverlay.1":"View your photos","HelpOverlay.2":"Go to Shutterfly home page","HelpOverlay.3":"Save your book","HelpOverlay.4":"Order your book","HelpOverlay.5":"Use this tab to change your cover and page type","HelpOverlay.6":"Use this control to zoom into a page","SilverApp.clickToEditEvent":"To edit an event, click on the date in the calendar.","SilverApp.returnToEdit":"Return to edit","SilverApp.pagesView.navbar.title":"Edit","SilverApp.whatsNew":"What's New","SilverApp.arrange.navbar.title":"Arrange","SilverApp.arrange.navbar.next":"Next >","SilverApp.photoEffectsNotInPDF":"Note: Photo filters are not reflected in PDF file.","SilverApp.photoEffectsNotInJPG":"Note: Photo filters are not reflected in JPG file.","SilverApp.noTextPreview":"No preview available","SilverApp.back":"< Back","Palette.numberPhotos":"Number of photos:","SilverApp.session.timeout.title":"Session ended","SilverApp.sessionTimeout1":"Your product creation/editing session has ended and your work has been saved.<br><br>","SilverApp.sessionTimeout2":"The last saved version of your project can be accessed from","SilverApp.sessionTimeout3":" in the 'My Shutterfly' page.<br>","SilverApp.session.timeout.goToStore":"Go to My Shutterfly","SilverApp.gotoMyPhotos":"Goto 'My Photos'","SilverApp.editor":"Collage editor","SilverApp.events.textStyle":"Text style","SilverApp.events.edit.photo":"Edit photo","SilverApp.browser.unsupported":"Your browser is either unsupported or out of date.","SilverApp.browser.continue":"Continue browsing with your current browser","SilverApp.browser.unsupported.content":"Your browser is either unsupported or out of date and may not be compatible with our website. Please upgrade your browser to increase your safety and improve your browsing experience. Choose one of the browsers above.","SilverApp.saving":"Saving...","SilverApp.dateText":"Date Text","SilverApp.dateTextStyle":"Date Text Style","SilverApp.eventText":"Event Text","SilverApp.eventTextStyle":"Event Text Style","SilverApp.reviewTitle":"Preview your project","SilverApp.reviewBody":"We want your project to look great! Please preview before ordering.","SilverApp.createYourStory":"Create your story!","SilverApp.createYourStoryBooks":"Welcome to your new photo book. Let us help you create a story and share moments using the memories that you have captured.","SilverApp.letsAddSomePhotos":"Let's add some photos!","SilverApp.createYourStoryCal":"Welcome to your new calendar. Let us help you create a story and share moments using the memories that you have captured.","SilverApp.nextButton":"Next","SilverApp.autofillBook":"Yes, please save me time and place them in my book in chronological order.","SilverApp.autofillBook2":"We recommend doing this. You can still edit and rearrange your photos after they are placed.","SilverApp.dontAutofillBook":"No thanks, I would like to place them myself.","SilverApp.dontAutofillBook2":"Your photos will be placed in the photo tray for you to place yourself.","SilverApp.eventEditPhotoGuidance":"Note: To add or change a photo, close this dialog and drag a photo to a date.","SilverApp.dropForBackground":"Drop a photo to use as the background for this page","SilverApp.usePhotoAsBackground":"Use photo as background","SilverApp.MissDayTargetWarning":"To add photos to a date, drag and drop your photo <i>directly</i> over the desired day. The date will be highlighted while dragging, showing where your photo will appear."};var translations=window.translations||{};translations.es={looseleaf:"páginas estándar",layflat:"páginas de puesta en obra","6x6_bk_hard":"6x6 Foto de la portada duro","5x7_bk_soft":"5x7 Foto de la cubierta suave","7x9_bk_soft":"7x9 Foto de la cubierta suave","8x8_bk_cloth":"8x8 tapa dura de tela","8x8_bk_hard":"8x8 Foto de la portada duro","8x8_bk_hard_dustjacket":"Foto de la portada duro con sobrecubierta","8x8_bk_leather":"8x8 Leather cover","8x8_bk_linen":"8x8 Linen cover","8x8_bk_premiumleather":"8x8 Layflat book, Genuine leather hardcover","8x8_bk_silk":"8x8 Layflat book, Silk cover","8x8_bk_soft":"8x8 Foto de la cubierta suave","8x11_bk_cloth":"8x11 Cloth cover","8x11_bk_hard":"8x11 Foto de la portada duro","8x11_bk_hard_dustjacket":"Foto de la portada duro con sobrecubierta","8x11_bk_leather":"8x11 Leather cover","8x11_bk_linen":"8x11 Linen cover","8x11_bk_premiumleather":"8x11 Layflat book, Genuine leather hardcover","8x11_bk_silk":"8x11 Layflat book, Silk cover","8x11_bk_soft":"8x11 Foto de la cubierta suaver","10x10_bk_cloth":"10x10 Cloth cover","10x10_bk_hard":"10x10 Foto de la portada duro","10x10_bk_hard_dustjacket":"Foto de la portada duro con sobrecubierta","10x10_bk_leather":"10x10 Leather cover","10x10_bk_linen":"10x10 Linen cover","10x10_bk_premiumleather":"10x10 Layflat book, Genuine leather hardcover","10x10_bk_silk":"10x10 Layflat book, Silk cover","10x10_bk_soft":"10x10 Foto de la cubierta suave","11x14_bk_cloth":"11x14 Cloth cover","11x14_bk_hard":"11x14 Foto de la portada duro","11x14_bk_hard_dustjacket":"Foto de la portada duro con sobrecubierta","11x14_bk_leather":"11x14 Leather cover","11x14_bk_linen":"11x14 Linen cover","11x14_bk_premiumleather":"11x14 Layflat libro, de tapa dura de cuero genuino","11x14_bk_silk":"11x14 Layflat book, Silk cover","12x12_bk_cloth":"12x12 Cloth cover","12x12_bk_hard":"12x12 Foto de la portada duro","12x12_bk_hard_dustjacket":"Foto de la portada duro con sobrecubierta","12x12_bk_leather":"12x12 Leather cover","12x12_bk_linen":"12x12 Linen cover","12x12_bk_premiumleather":"12x12 Layflat libro, de tapa dura de cuero genuino","12x12_bk_silk":"12x12 Layflat book, Silk cover","7X7CLRPOCKET":"7x7 Bolsillo Borrar recuerdos",PB_5X7_BASE:"20-página 5x7 libro",PB_5X7_01:"Foto de la cubierta suave",PB_5X7_SC_PG:"{{value}} Páginas adicionales",PB_7X9_BASE:"20-página 7x9 libro",PB_7X9_01:"Foto de la cubierta suave",PB_7X9_SC_PG:"{{value}} Páginas adicionales",PB_8X8_BASE:"20-página 8x8 libro",PB_8X8_01:"Foto de la cubierta suave",PB_8X8_02:"Foto de la portada duro",PB_8X8_04:"Tapa dura de cuero",PB_8X8_05:"Tapa dura de tela",PB_8X8_06:"Tapa dura de cocodrilo",PB_8X8_08:"Tapa dura de cuero genuino",PB_8X8_09:"Tapa dura de lino",PB_8X8_10:"Tapa dura seda machacada",PB_8X8_PADDED_FINISH:"Acabado acolchado",PB_8X8_MATTE_FINISH:"Acabado mate",PB_8X8_LF:"Coloque las páginas planas",PB_8X8_SC_PG:"{{value}} Páginas adicionales",PB_8X8_HC_PG:"{{value}} Páginas adicionales",PB_8X8_PREM_PG:"{{value}} Páginas adicionales",PB_8x8_STD_DJ:"Sobrecubierta",PB_8x8_LF_DJ:"Sobrecubierta",PB_10X10_BASE:"20-página 10x10 libro",PB_10X10_01:"Foto de la cubierta suave",PB_10X10_02:"Foto de la portada duro",PB_10X10_04:"Tapa dura de cuero",PB_10X10_05:"Tapa dura de tela",PB_10X10_06:"Tapa dura de cocodrilo",PB_10X10_08:"Tapa dura de cuero genuino",PB_10X10_09:"Tapa dura de lino",PB_10X10_10:"Tapa dura seda machacada",PB_10X10_PADDED_FINISH:"Acabado acolchado",PB_10X10_MATTE_FINISH:"Acabado mate",PB_10X10_LF:"Coloque las páginas planas",PB_10X10_SC_PG:"{{value}} Páginas adicionales",PB_10X10_HC_PG:"{{value}} Páginas adicionales",PB_10X10_PREM_PG:"{{value}} Páginas adicionales",PB_10x10_LF_DJ:"Sobrecubierta",PB_10x10_STD_DJ:"Sobrecubierta",PB_8X11_BASE:"20-página 8x11 libro",PB_8X11_01:"Foto de la cubierta suave",PB_8X11_02:"Foto de la portada duro",PB_8X11_04:"Tapa dura de cuero",PB_8X11_05:"Tapa dura de tela",PB_8X11_06:"Tapa dura de cocodrilo",PB_8X11_08:"Tapa dura de cuero genuino",PB_8X11_09:"Tapa dura de lino",PB_8X11_10:"Tapa dura seda machacada",PB_8X11_PADDED_FINISH:"Acabado acolchado",PB_8X11_MATTE_FINISH:"Acabado mate",PB_8X11_LF:"Coloque las páginas planas",PB_8X11_SC_PG:"{{value}} Páginas adicionales",PB_8X11_HC_PG:"{{value}} Páginas adicionales",PB_8X11_PREM_PG:"{{value}} Páginas adicionales",PB_8x11_LF_DJ:"Sobrecubierta",PB_8x11_STD_DJ:"Sobrecubierta",PB_12X12_BASE:"20-página 12x12 libro",PB_12X12_02:"Foto de la portada duro",PB_12X12_04:"Tapa dura de cuero",PB_12X12_05:"Tapa dura de tela",PB_12X12_06:"Tapa dura de cocodrilo",PB_12X12_08:"Tapa dura de cuero genuino",PB_12X12_09:"Tapa dura de lino",PB_12X12_10:"Tapa dura seda machacada",PB_12X12_PADDED_FINISH:"Acabado acolchado",PB_12X12_MATTE_FINISH:"Acabado mate",PB_12X12_LF:"Coloque las páginas planas",PB_12X12_HC_PG:"{{value}} Páginas adicionales",PB_12X12_PREM_PG:"{{value}} Páginas adicionales",PB_12x12_LF_DJ:"Sobrecubierta",PB_12x12_STD_DJ:"Sobrecubierta",PB_11X14_BASE:"20-página 11x14 libro",PB_11X14_02:"Foto de la portada duro",PB_11X14_04:"Tapa dura de cuero",PB_11X14_05:"Tapa dura de tela",PB_11X14_06:"Tapa dura de cocodrilo",PB_11X14_08:"Tapa dura de cuero genuino",PB_11X14_09:"Tapa dura de lino",PB_11X14_10:"Tapa dura seda machacada",PB_11X14_PADDED_FINISH:"Acabado acolchado",PB_11X14_MATTE_FINISH:"Acabado mate",PB_11X14_LF:"Coloque las páginas planas",PB_11X14_HC_PG:"{{value}} Páginas adicionales",PB_11X14_PREM_PG:"{{value}} Páginas adicionales",PB_11x14_LF_DJ:"Sobrecubierta",PB_11x14_STD_DJ:"Sobrecubierta",PB_5X7_STD:"Las páginas estándar",PB_7X9_STD:"Las páginas estándar",PB_8X8_STD:"Las páginas estándar",PB_10X10_STD:"Las páginas estándar",PB_8X11_STD:"Las páginas estándar",PB_12X12_STD:"Las páginas estándar",PB_11X14_STD:"Las páginas estándar",PB_5X7_GLOSSY_FINISH_STD:"Páginas brillantes",PB_7X9_GLOSSY_FINISH_STD:"Páginas brillantes",PB_8X8_GLOSSY_FINISH_STD:"Páginas brillantes",PB_10X10_GLOSSY_FINISH_STD:"Páginas brillantes",PB_8X11_GLOSSY_FINISH_STD:"Páginas brillantes",PB_12X12_GLOSSY_FINISH_STD:"Páginas brillantes",PB_11X14_GLOSSY_FINISH_STD:"Páginas brillantes","please.wait":"Espere por favor...",PB_5X7:"PB_5X7",PB_7X9:"PB_7X9",PB_8X11:"PB_8X11",PB_8X8:"PB_8X8",PB_10X10:"PB_10X10",PB_11X14:"PB_11X14",PB_12X12:"PB_12X12",undefined:"indefinido",WALLCAL_8X11:"8x11 photo wall calendar",WALLCAL_12X12:"12x12 photo wall calendar",CAL_8X11:"CAL_8X11",CAL_12X12:"CAL_12X12","Calendar.descriptionId.8x11":"8x11 Wall Calendar","Calendar.descriptionId.12x12":"12x12 Wall Calendar","SilverApp.title":"Shutterfly | Photo Books","SilverApp.edit":"Editar","SilverApp.delete":"Delete","SilverApp.book":"Libro","SilverApp.arrange":"Arrange","SilverApp.events":"Eventos","SilverApp.style":"Estilo","SilverApp.storyboard":"Storyboard","SilverApp.share":"Cuota","SilverApp.help":"Ayuda...","SilverApp.save":"Guardar","SilverApp.saveAs":"Guardar Como...","SilverApp.undo":"Deshacer","SilverApp.redo":"Rehacer","SilverApp.done":"Hecho","SilverApp.order":"Orden","SilverApp.project":"Proyecto","SilverApp.removePage":"Retire la página","SilverApp.duplicatePage":"Duplicar página","SilverApp.flipPage":"Tirón de la página","SilverApp.getDesignElements":"Obtener elementos de diseño...","SilverApp.getDesignElementsToolbar":"Obtener elementos de diseño","SilverApp.changeStyle":"Cambiar estilo","SilverApp.changeStyleMenuItem":"Cambiar estilo...","SilverApp.textSettings":"Configuraciones de texto","SilverApp.textSettingsMenuItem":"Configuraciones de texto...","SilverApp.changeSize":"Cambiar tamaño","SilverApp.changeSizeMenuItem":"Cambiar tamaño...","SilverApp.editEvents":"Editar eventos...","SilverApp.autofill":"Autofill Fotos","SilverApp.clearAllPhotosFromPages":"Retirar fotos colocadas","SilverApp.clearUnusedPhotosFromPages":"Sacar fotos no utilizados","SilverApp.pages":"Páginas","SilverApp.photos":"Fotos","SilverApp.align":"Alinear","SilverApp.match":"Igualar","SilverApp.space":"Espaciar","SilverApp.layer":"Capa","SilverApp.flipLayout":"Disposición del tirón","SilverApp.movePage":"Mover página","SilverApp.importPage":"Import page","SilverApp.importPage.button":"Import Page","SilverApp.importPage.description":"Import a page from another book you've made to use in this project.","SilverApp.importPage.selectBook":"Start by selecting a book ({{value}} books found):","SilverApp.importPage.noProject":"You have no photo books to import from. You can import pages from previously saved photo book projects.","SilverApp.importPage.selectPageFrom":'Select a page from "{{value}}"',"SilverApp.importPage.insertPageFrom":'Insert page from "{{value}}"',"SilverApp.importPage.chooseDifferentBook":"Choose a different book","SilverApp.importPage.chooseDifferentPage":"Choose a different page","SilverApp.importPage.option.after":"After page {{value}}","SilverApp.importPage.option.before":"Before page {{value}}","SilverApp.importPage.option.beginning":"After title page","SilverApp.importPage.option.end":"To the end of the project","SilverApp.importPage.spreadNote":"Note: An additional blank page will be placed in your book to preserve spreads.","SilverApp.advanceEdit":"Avance de edición","SilverApp.advanceEdit.subtext":"Mover objetos con libertad para crear diseños personalizados","SilverApp.addPagesMenuItem":"Añadir páginas...","SilverApp.addPhotosMenuItem":"Añadir fotos...","SilverApp.movePageMenuItem":"Mover página...","SilverApp.importPageMenuItem":"Import page...","SilverApp.spread":"Spread","SilverApp.spreadIdeaPage":"Spread idea page","SilverApp.makeSpread":"Hacer Spread","SilverApp.breakSpread":"Split spread","SilverApp.alignLeftMenuItem":"Alinear bordes izquierdos","SilverApp.alignCenterMenuItem":"Alinear Centros","SilverApp.alignRightMenuItem":"Alinear bordes derechos","SilverApp.alignTopMenuItem":"Alinear bordes superiores","SilverApp.alignMiddleMenuItem":"Alinear horizontalmente","SilverApp.alignBottomMenuItem":"Alinear bordes inferiores","SilverApp.matchWidestMenuItem":"Haga coincidir el ancho más grande","SilverApp.matchNarrowestMenuItem":"Coinciden anchura más estrecha","SilverApp.matchTallestMenuItem":"Haga coincidir la altura más alta","SilverApp.matchShortestMenuItem":"Haga coincidir la altura más corta","SilverApp.matchWidthAndHeightMenuItem":"Anchura y la altura del partido","SilverApp.spaceHorizontalMenuItem":"Espaciado horizontal Incluso fuera","SilverApp.spaceVerticalMenuItem":"Espaciado vertical Incluso fuera","SilverApp.layerBringToFrontMenuItem":"Traer al frente","SilverApp.layerSendToBackMenuItem":"Enviar al fondo","SilverApp.layerBringForwardMenuItem":"Adelantar","SilverApp.layerSendBackwardMenuItem":"Enviar hacia atrás","SilverApp.addText":"Añadir cuadro de texto","SilverApp.addPhotos":"Añadir fotos","SilverApp.addPage":"Añadir página","SilverApp.addPhotosTooltip":"Añadir fotos","SilverApp.copyright":"© 1999 - {{value}} Shutterfly todos los derechos reservados.","SilverApp.editText":"Editar Texto","SilverApp.editText.removeNonPrintable":"Se han eliminado los caracteres no imprimibles.","SilverApp.editText.overflow":"El texto no se ajusta.","SilverApp.editText.edgeWarning":"El texto es demasiado cerca de la orilla y no se imprima bien.","SilverApp.editText.maxAmountOfText":"No se puede ingresar más texto.","SilverApp.editText.textSuffix":" texto","SilverApp.editText.textStyle":"Estilo de texto:","SilverApp.editText.alignLeft":"Izquierda","SilverApp.editText.alignCenter":"Centro","SilverApp.editText.alignRight":"Right","SilverApp.editText.alignTop":"Top","SilverApp.editText.alignMiddle":"Middle","SilverApp.editText.alignBottom":"Bottom","SilverApp.editText.normalLineSpacing":"Normal line spacing","SilverApp.editText.wideLineSpacing":"Wide line spacing","SilverApp.editText.widerLineSpacing":"Wider line spacing","SilverApp.editText.widestLineSpacing":"Widest line spacing","SilverApp.editText.styleFonts":"Style Fonts","SilverApp.editText.allFonts":"All Fonts","SilverApp.editText.userSelectedFonts":"User Selected Fonts","SilverApp.editText.styleColors":"Style Colors","SilverApp.editText.allColors":"All Colors","SilverApp.editText.userSelectedColors":"User Selected Colors","SilverApp.editText.paraStyle.xxlarge":"Extra extra large","SilverApp.editText.paraStyle.xlarge":"Extra large","SilverApp.editText.paraStyle.large":"Large","SilverApp.editText.paraStyle.large_alt":"Large","SilverApp.editText.paraStyle.medium":"Medium","SilverApp.editText.paraStyle.medium_alt":"Medium","SilverApp.editText.paraStyle.small":"Small","SilverApp.editText.paraStyle.small_alt":"Small","SilverApp.editText.paraStyle.xsmall":"Extra small","SilverApp.editText.paraStyle.spine":"Spine","SilverApp.editText.paraStyle.spine_wide":"Spine","SilverApp.editText.paraStyle.page_num_R":"Page number","SilverApp.editText.paraStyle.page_num_L":"Page number","SilverApp.textSettings.note":"Nota: Estos ajustes afectan a todo su proyecto y pueden ser modificados en cualquier momento. Los cambios en un conjunto estilo se aplicarán a todos los cuadros de texto que utilizan ese estilo. El texto puede ya no encajan o envuelva diferente.","SilverApp.textSettings.resetButton":"Reset","SilverApp.textSettings.applyPageButton":"Apply to Page","SilverApp.applyOtherPageButton":"Aplicar a otras páginas","SilverApp.applyOtherPageButtonMenuItem":"Aplicar a otras páginas...","SilverApp.applyOtherPageModal1":"Aplicar estos elementos de la página","SilverApp.applyOtherPageModal2":"a todas las páginas :","SilverApp.applyOtherPageLayout":"Diseño","SilverApp.applyOtherPageBackground":"Fondo","SilverApp.applyOtherPageFrame":"marco","SilverApp.textSettings.applyProjectButton":"aplicar para proyectar","SilverApp.lastSaved":"Guardado por última vez {{value}}","SilverApp.lastSavedShort":"{{value}}","SilverApp.numPages":"{{value}} páginas","SilverApp.frontCover":"Cubierta frontal","SilverApp.backCover":"Contraportada","SilverApp.CannotAddPhotoarea":"No se puede agregar área de la foto","SilverApp.CannotAddPhotoareaMoreDescription":"Un área adicional de la foto no se puede añadir a la página. Coloque su foto en una de las zonas de las fotos existentes.","SilverApp.Ok":"Bueno","SilverApp.NoMorePhotosCanBeAdded":"No más fotos se pueden agregar","SilverApp.NoMorePhotosCanBeAddedMoreDescription":"Sólo {{value}} fotos se pueden agregar a la página. Antes de poder agregar una foto, usted tendrá que quitar una de las fotos colocadas previamente.","SilverApp.changeSizeTitle":"Cambie libro tamaño","SilverApp.softCover":"Tapa blanda","SilverApp.softOrHardCover":"Tapa dura o blanda","SilverApp.hardCoverOnly":"Sólo la cubierta dura","SilverApp.savings":"Ahorre un {{value}}%","SilverApp.english":"Inglés","SilverApp.spanish":"Español","SilverApp.welcome":"Bienvenido, {{value}}","SilverApp.SaveAs.dialog.title":"Guardar proyecto","SilverApp.required":"Necesario","SilverApp.exitFullScreen":"Salir de pantalla completa","SilverApp.fullScreen":"Pantalla completa","SilverApp.SaveAs.dialog.question":"¿Qué le gustaría que el nombre de su proyecto?","SilverApp.SaveAs.dialog.tip":"Usted puede encontrar este proyecto en Mis Proyectos en la página My Shutterfly.","SilverApp.moveThisPage":"Mueva esta página","SilverApp.beforePage":"Antes de la página","SilverApp.afterPage":"Después de la página","SilverApp.addPages.spreadCheck":"Adding an odd number of pages to this location will also place an additional blank page to preserve spreads.","SilverApp.save.error.fixNeeded":"Tenemos que arreglar algunas cosas antes de guardar.","SilverApp.login.dialog.invalid.loginRequiredFix":"Tenemos que arreglar algunas cosas antes de que inicie sesión.","SilverApp.sign.up.invalid.signup":"Tenemos que arreglar algunas cosas antes de firmar.","SilverApp.sign.in":"Registrarse","SilverApp.sign.in.title":"Iniciar sesión en Shutterfly","SilverApp.sign.up.title":"Regístrate en Shutterfly","SilverApp.sign.up":"Contratar","SilverApp.login.dialog.email":"Email","SilverApp.sign.up.first.name":"Nombre","SilverApp.sign.up.last.name":"Apellido","SilverApp.sign.up.password.length":"Debe tener al menos 4 caracteres","SilverApp.email.invalid":"Inválido Email","SilverApp.email.already.used":"La dirección de correo electrónico ya puede estar en uso.","SilverApp.sign.up.password.description":"(4 - 10 caracteres)","SilverApp.email.remember":"Recordar mi dirección de correo electrónico","SilverApp.sign.up.accept.terms.prefix":"Sí, acepto los ","SilverApp.sign.up.accept.terms.conjunction":"and ","SilverApp.sign.up.terms.and.conditions":"términos y condiciones","SilverApp.sign.up.privacy.policy":"Política de privacidad.","SilverApp.sign.up.password.mustMatch":"Please enter matching passwords.","SilverApp.do.not.have.account":"¿No tienes una cuenta todavía? ","SilverApp.login.dialog.password":"Contraseña","SilverApp.login.dialog.confirmPassword":"Confirm password","SilverApp.login.dialog.invalid.login":"Lo sentimos, la información que has dado no coincide con nuestros registros. Por favor, inténtelo de nuevo.","SilverApp.login.dialog.invalid.password":"Introduzca su contraseña.","SilverApp.login.dialog.invalid.email":"Introduzca una dirección de correo electrónico válida","SilverApp.login.dialog.forgot":"¿Has olvidado tu contraseña?","SilverApp.addPages":"Agregar página(s)","SilverApp.add":"Añadir","SilverApp.select":"Select","SilverApp.canAddUpToXPages":"página(s) - puedes añadir hasta {{value}} páginas.","SilverApp.afterTitlePage":"después de la página de título","SilverApp.afterPageX":"después de la página {{value}}","SilverApp.beforePageX":"antes de la página {{value}}","SilverApp.toTheEndOfTheBook":"al final del libro","SilverApp.addEvenPagesReminder":"Nota: Recuerde que debe añadir un número par de páginas con el fin de mantener actualizada la propaga juntos.","SilverApp.autofill.unplacedPhotos.title":"No todas las fotos colocadas en el libro","SilverApp.autofill.unplacedPhotos.p1":"Su libro ha llegado al número máximo de páginas. {{value0}} fotos han sido añadidas a su libro, y los restantes {{value1}} fotos se han añadido a la pestaña fotos, así que usted puede añadir su propia cuenta.","SilverApp.autofill.unplacedPhotos.p3":"Nota: puede realizar hasta 25 fotos en una página.","SilverApp.booktab.categories.standard":"cubiertas estándar","SilverApp.booktab.categories.upgraded":"cubiertas mejoradas","SilverApp.booktab.categories.premium":"cubiertas premium","SilverApp.booktab.options":"Cover options","SilverApp.booktab.pageOptions.layflat":"páginas Layflat","SilverApp.booktab.pageOptions.glossy":"páginas Glossy","SilverApp.booktab.pageOptions.standard":"páginas Standard","SilverApp.booktab.stockCloth.black":"Black cloth","SilverApp.booktab.stockCloth.black.glossy.text":"BLACK CLOTH COVER, GLOSSY PAGES","SilverApp.booktab.stockCloth.black.standard.text":"BLACK CLOTH COVER, STANDARD PAGES","SilverApp.booktab.stockCloth.camel":"Camel cloth","SilverApp.booktab.stockCloth.camel.glossy.text":"CAMEL CLOTH COVER, GLOSSY PAGES","SilverApp.booktab.stockCloth.camel.standard.text":"CAMEL CLOTH COVER, STANDARD PAGES","SilverApp.booktab.stockLeather.black":"Black leather","SilverApp.booktab.stockLeather.black.glossy.text":"BLACK LEATHER COVER, GLOSSY PAGES","SilverApp.booktab.stockLeather.black.standard.text":"BLACK LEATHER COVER, STANDARD PAGES","SilverApp.booktab.stockLeather.chocolate":"Chocolate leather","SilverApp.booktab.stockLeather.chocolate.glossy.text":"CHOCOLATE LEATHER COVER, GLOSSY PAGES","SilverApp.booktab.stockLeather.chocolate.standard.text":"CHOCOLATE LEATHER COVER, STANDARD PAGES","SilverApp.booktab.stockLinen.white":"Antique white linen","SilverApp.booktab.stockLinen.white.glossy.text":"ANTIQUE WHITE LINEN COVER, GLOSSY PAGES","SilverApp.booktab.stockLinen.white.standard.text":"ANTIQUE WHITE LINEN COVER, STANDARD PAGES","SilverApp.booktab.premiumLeather.black":"Genuine leather","SilverApp.booktab.premiumLeather.black.layflat.text":"PREMIUM BLACK LEATHER COVER, LAYFLAT PAGES","SilverApp.booktab.premiumSilk.ivory":"Ivory crushed silk","SilverApp.booktab.premiumSilk.ivory.layflat.text":"PREMIUM CRUSHED SILK COVER, LAYFLAT PAGES","SilverApp.booktab.hardMatte":"Hard matte photo cover","SilverApp.booktab.hardMatte.layflat.text":"HARD MATTE COVER, LAYFLAT PAGES","SilverApp.booktab.hardMatte.glossy.text":"HARD MATTE COVER, GLOSSY PAGES","SilverApp.booktab.hardMatte.standard.text":"Select a hard matte photo cover for a sophisticated, smudge-resistant finish.","SilverApp.booktab.hardMatteJacket":"Hard matte photo cover with dust jacket","SilverApp.booktab.hardMatteJacket.layflat.text":"HARD MATTE COVER, DUST JACKET, LAYFLAT PAGES","SilverApp.booktab.hardMatteJacket.glossy.text":"HARD MATTE COVER, DUST JACKET, GLOSSY PAGES","SilverApp.booktab.hardMatteJacket.standard.text":"A laminated, tear-resistant dust jacket, designed to match your cover finish, to beautifully protect your book.","SilverApp.booktab.hardPadded":"Padded photo cover","SilverApp.booktab.hardPadded.layflat.text":"PADDED COVER, LAYFLAT PAGES","SilverApp.booktab.hardPadded.glossy.text":"PADDED COVER, GLOSSY PAGES","SilverApp.booktab.hardPadded.standard.text":"A padded photo cover is a decorative addition, perfect for coffee table display.","SilverApp.booktab.hard":"Hard photo cover","SilverApp.booktab.hard.layflat.text":"HARD COVER, LAYFLAT PAGES","SilverApp.booktab.hard.glossy.text":"HARD COVER, GLOSSY PAGES","SilverApp.booktab.hard.standard.text":"A hard photo cover helps ensure your photo book lives on as an enduring keepsake.","SilverApp.booktab.hardJacket":"Hard photo cover with dust jacket","SilverApp.booktab.hardJacket.layflat.text":"HARD COVER, DUST JACKET, LAYFLAT PAGES","SilverApp.booktab.hardJacket.glossy.text":"HARD COVER, DUST JACKET, GLOSSY PAGES","SilverApp.booktab.hardJacket.standard.text":"A laminated, tear-resistant dust jacket, designed to match your cover finish, to beautifully protect your book.","SilverApp.booktab.soft":"Soft photo cover","SilverApp.booktab.soft.glossy.text":"","SilverApp.booktab.soft.standard.text":"","SilverApp.booktab.entrytext":"Pase el cursor sobre las opciones para ver ejemplos","SilverApp.booktab.keepsakePocket.title":"Memorabilia pocket","SilverApp.booktab.keepsakePocket":"Tienda de souvenirs en un bolsillo libre de ácido que pueden adherirse a la parte interior de la parte posterior de su libro","SilverApp.storyboardtab.entrytext":"Arrastre fotos en el Storyboard para colocar en las páginas. Presentaciones serán elegidos automáticamente para ajustarse al número de fotos en una página.","SilverApp.arrangetab.entrytext":"Drag and drop pages to rearrange your book","SilverApp.error":"Por favor, inténtelo de nuevo","SilverApp.removepage.dialog.RemovePage":"Retire página","SilverApp.removepage.dialog.warning":"¿Está seguro que desea eliminar la página {{value}}","SilverApp.removepage.dialog.details":"El número mínimo de páginas de este libro de fotos es {{value}}. Una nueva página se añadirá al final.","SilverApp.removepages.dialog.RemovePage":"Retire páginas","SilverApp.removepages.dialog.warning":"¿Seguro que quieres eliminar páginas {{pageToRemoveFrom}}-{{pageToRemoveTo}}?","SilverApp.removepages.dialog.details":"The minimum number of pages for this photo book is {{value}}. New pages will be added to the end.","SilverApp.yes":"Sí","SilverApp.no":"Not","SilverApp.continue":"Continuar","SilverApp.continueDialog":"Continuar","SilverApp.note":"Nota:","SilverApp.changeSizeWarningDialog.coverChangeTitle":"Cubierta cambiará con el nuevo tamaño de libro","SilverApp.changeSizeWarningDialog.aspectChangeTitle":"Los cambios del libro ocurrirán con la nueva talla del libro","SilverApp.changeSizeWarningDialog.coverChangeReviewNote":"Para revisar todas las opciones de cobertura vaya a la ficha del libro en la cabecera.","SilverApp.changeSizeWarningDialog.aspectChangeReviewNote":"Después del cambio de tamaño, para volver al tamaño anterior, seleccione el botón Deshacer.","SilverApp.changeSizeWarningDialog.priceChangeReviewNote":"Book pricing will change.","SilverApp.changeSizeWarningDialog.coverChangeMessage":"El cambio de un libro {{sizeBefore}} foto a un libro de fotos {{sizeAfter}} cambiará la cubierta seleccionada","SilverApp.changeSizeWarningDialog.aspectChangeMessage":"El cambio de un libro {{sizeBefore}} foto a un libro de fotos {{sizeAfter}} causará algunos cambios en su libro, por favor revíselo cuidadosamente y compruebe si:","SilverApp.changeSizeWarningDialog.coverAndAspectChangeMessage":"El nuevo tamaño del libro puede causar algunos cambios en su libro, por favor revíselo cuidadosamente y compruebe si:","SilverApp.changeSizeWarningDialog.textNotFitMessage":"El texto que ya puede no caber o se puede envolver diferentemente.","SilverApp.changeSizeWarningDialog.photoCropMessage":"Las fotos que se pueden recortar o falta de resolución.","SilverApp.changeSizeWarningDialog.layoutChangedMessage":"Diseños que pueden haber cambiado.","SilverApp.changeSizeWarningDialog.coverTypeMessage":"Del {{coverBefore}} al {{coverAfter}}","SilverApp.changeStyleWarningDialog.title":"El estilo de su libro se ha cambiado","SilverApp.changeStyleWarningDialog.message1":"Todas las páginas del libro se han cambiado de:  '{{previousStyleName}}' para '{{newStyleName}}'.","SilverApp.changeStyleWarningDialog.message2":"Esto ha cambiado sus antecedentes, las etiquetas engomadas, fuentes y marcos.","SilverApp.changeStyleWarningDialog.message3":"Verá este icono si hay algún problema con su libro de fotos","SilverApp.changeStyleWarningDialog.message4":"Nota: Para volver al estilo anterior, seleccione el botón Deshacer.","SilverApp.changeStyleWarningDialog.simple":"Para volver al estilo anterior, seleccione Deshacer.","SilverApp.changeStyleWarningDialog.simpleTitle":"El estilo de su libro se ha cambiado","SilverApp.editImage.reset":"Reset","SilverApp.editImage.remove":"Remove photo","SilverApp.editImage.redEye":"Red eye","SilverApp.editImage.redEyeFix":"Fix","SilverApp.editImage.redEyeInstructions":"Arrastre la lupa sobre el ojo rojo y haga clic para fijar.","SilverApp.editImage.rotate":"Rotate","SilverApp.editImage.disableFilters":"Apague efectos y corrección de la foto","SilverApp.editImage.filter.None":"Sin efecto","SilverApp.editImage.filter.Auto":"Auto","SilverApp.editImage.filter.Sunshine":"Sunshine",
"SilverApp.editImage.filter.BlackWhite":"B&W","SilverApp.editImage.filter.Sepia":"Sepia","SilverApp.editImage.filter.Vibrant":"Vibrant","SilverApp.editImage.filter.Vintage":"Vintage","SilverApp.editImage.warnings.lowResolution":"Foto tiene baja resolución","SilverApp.editImage.redEyeDisabled":"Inicia sesión para activar","SilverApp.contact":"\nEmail: customerservice@cs.shutterfly.com\nTeléfono: 1-888-225-7159\nLunes - Viernes: 0600 - 1700 Hora del Pacífico\nSábado - Domingo: 0830 - 1700 Hora del Pacífico\n\n","SilverApp.pleaseProvide":"Por favor proporcione esta información:\n\n","SilverApp.sorry":"Lo sentimos, hay un problema. Por favor, inténtalo de nuevo.","SilverApp.sorryAgain":"Lo sentimos usted está teniendo problemas. Para ponerse en contacto con el servicio al cliente de Shutterfly:\n","SilverApp.showDetails":"Mostrar detalles","SilverApp.hideDetails":"Ocultar Detalles","SilverApp.selectStyle":"Seleccione un estilo","SilverApp.changeCoverWarningDialog.title":"Tamaño del libro va a cambiar con la nueva portada","SilverApp.changeCoverWarningDialog.priceChange":"Su precio de los libros va a cambiar con el nuevo tamaño.","SilverApp.changeCoverWarningDialog.changeSize":"Cambio en la Cobertura y Tamaño","SilverApp.changeCoverWarningDialog.dontChangeSize":"No cambie","SilverApp.changeCoverWarningDialog.coverChangeMessage":"El cambio de un {{coverBefore}} a {{coverAfter}} cambiará el tamaño seleccionado actualmente.","SilverApp.changeCoverWarningDialog.sizeChangeMessage":"De un libro {{sizeBefore}} foto a un libro {{sizeAfter}} fotos","SilverApp.changeCoverWarningDialog.pleaseReviewMessage":"Por favor revisa tu libro con cuidado y compruebe que no:","SilverApp.postChangeCoverWarningDialog.newBookIsReady":"Su nuevo libro está listo","SilverApp.postChangeCoverWarningDialog.weMadeACopy":"Hemos hecho una copia de su libro.","SilverApp.upgradeProjectWarningDialog.title":"Cubra no disponible","SilverApp.upgradeProjectWarningDialog.briefBody":"The cover you selected is no longer available and has been changed.","SilverApp.upgradeProjectWarningDialog.body":"The cover and/or size you selected is no longer available and has been changed. Use the Book tab to update your project and continue editing.","SilverApp.postChangeCoverWarningDialog.warningInfo":"Usted verá este icono si hay algún problema con su libro de fotos.","SilverApp.unsavedChanges":"Si continúa, se perderán los cambios no guardados a su proyecto de libro de fotos.","SilverApp.noProjects":"No hay proyectos en su cuenta.","SilverApp.textTooltipEmpty":"Haga clic para editar. El texto no se imprimirá si está en blanco.","SilverApp.textTooltipEvent":"Click to edit event","SilverApp.textTooltip":"Haga clic para editar.","SilverApp.textTooltipCustomizeEmpty":"Double-click to edit.\nText will not print if blank.","SilverApp.textTooltipCustomize":"Double-click to edit text","SilverApp.textTooltipEventCustomize":"Double-click to edit event","SilverApp.imageTooltip":"Arrastre para mover. Haga clic para editar.","SilverApp.imageTooltipCustomize":"Drag photo to move.\nDouble-click to edit.","SilverApp.imageTooltipCustomizeLocked":"Double-click to edit.","SilverApp.imageDragTooltip":"Drag photo to move.","SilverApp.imageTooltipNotUploading":"Guarda tu libro para editar esta foto.","SilverApp.imageTooltipUploading":"Foto está cargando, no puede editar.","SilverApp.imageTooltipEmpty":"Caiga foto aquí. Espacio Photo no imprimirá si está en blanco.","SilverApp.imageTooltipEmptyLocked":"Drag your photo here.","SilverApp.dateEventPromptTooltip":"\nClick the date to edit event.","SilverApp.eventPromptTooltip":"\nClick to edit event.","SilverApp.eventAddPromptTooltip":"\nClick to add/edit events.","SilverApp.imageEventTooltip":"Click to edit photo or events. \n Drag photo to move.","SilverApp.removeImageTooltipEmpty":"Retire el espacio de fotos y elegir nuevo diseño.","SilverApp.removeImageTooltip":"Retire foto.","SilverApp.removePageTooltip":"Retire la página.","SilverApp.removeStickerTooltip":"Eliminar etiqueta","SilverApp.pageTabPageTooltip":"Arrastre para mover","SilverApp.arrangeInnerPageTooltip":"Arrastre para mover. Doble click para ampliar la imagen.","SilverApp.arrangeCoverPageTooltip":"Doble click para hacer un zoom","SilverApp.arrangeCoverPageLayoutsTooltip":"Click to change layout","SilverApp.arrangeInsertPageTooltip":"Click to add a page","SilverApp.arrangePageTooltip":"Double click to zoom in","SilverApp.pageTooltip":"Double click to zoom out","SilverApp.pageWarningTooltip":"Review page warnings","SilverApp.dragPhotoToPage":"Drag photos from photos tab to add to page.","SilverApp.from":"From ","SilverApp.ideaPage":"Página Idea","SilverApp.ideaPageLabelTooltip":"Páginas idea no se pueden modificar.\nElija un nuevo diseño.","SilverApp.openOnDesktopWarningDialog.simpleTitle":"Su proyecto debe ser abierto en un escritorio","SilverApp.openOnDesktopWarningDialog.message1":"Este proyecto se ha guardado en un escritorio, y debe ser reabierto en un escritorio","SilverApp.upsell.calculatingPrice":"Calculating price...","SilverApp.upsell.option.dustjacket.title":"Add a Dust Jacket?","SilverApp.upsell.option.dustjacket.descr":"Select a laminated, tear-resistant dust jacket, designed to match your cover finish, that beautifully protects your book.","SilverApp.upsell.option.hardcover.title":"Upgrade to a Hard Cover?","SilverApp.upsell.option.hardcover.descr":"Select a hard cover to ensure your photo book lives on as an enduring keepsake.","SilverApp.upsell.option.mattefinish.title":"Upgrade to a Matte Cover?","SilverApp.upsell.option.mattefinish.descr":"Select a matte hard cover for a sophisticated, smudge-resistant finish.","SilverApp.upsell.option.glossypaper.title":"Upgrade to Glossy Pages?","SilverApp.upsell.option.glossypaper.descr":"Select glossy pages for a luxe sheen that strkingly enhances color and adds a protective finish to your book pages.","SilverApp.upsell.option.layflat.title":"Upgrade to Layflat Pages?","SilverApp.upsell.option.layflat.descr":"Create an unparalleled photo display with double-thick, satin-finish pages that lay flat and seamless for a stunning presentation.","SilverApp.upsell.option.keepsakepocket.title":"Add a Memorabilia Pocket?","SilverApp.upsell.option.keepsakepocket.descr":"Keep all your memories in one place by adding a clear pocket perfect for storing and showcasing souvenirs and other keepsakes. Easily attaches to the front or back cover of your book.","SilverApp.storytellingCapTitle":"Felicitaciones, ahora tienen un uso ilimitado de artículos a la carta cosas de Storytelling™","SilverApp.storytellingCapMessage1":"Usted ha utilizado los elementos suficientes estilo Storytelling™ para nuestra $5.99 tarifa plana para uso ilimitado de páginas premium Idea , fondos y adornos en este libro.","SilverApp.storytellingCapMessage2":"Sólo tienes que buscar los artículos con el icono Storytelling™","SilverApp.allowUndoAutofillModalTitle":"Take a look!","SilverApp.allowUndoAutofillModalTitleDescription":"We've arranged your photos by date taken.  How would you like to start?","SilverApp.allowUndoAutofillModal.startWithPhotosPlaced":"Start with photos placed","SilverApp.allowUndoAutofillModal.placePhotosMyself":"Place photos myself","Book.Palette.pages":"Páginas","Calendar.Palette.pages":"Months","Palette.photo":"Fotos","Palette.addPhotos":"Añadir fotos","Palette.backgrounds":"Fondos","Palette.layouts":"Presentaciones","Palette.ideaPages":"Páginas de idea","Palette.embellishments":"Embellishments","Palette.hideUsed":"Ocultar utilizado","Palette.clusterStoryboard":"Agrupar","Palette.clusterPhotosBy":"Cluster photos by:","Palette.clusterPhotosByHour":"Hour","Palette.clusterPhotosByDay":"Day","Palette.clusterPhotosByWeek":"Week","Palette.clusterPhotosByMonth":"Month","Palette.clusterPhotosByYear":"Year","Palette.clusterNote1":"Note: photos are sorted independently within each cluster","Palette.clusterNote2":"Turn off clusters to sort all photos together","Palette.highlights":"Reflejos","Palette.groupDuplicates":"Group Duplicates","Palette.frontCover":"Cubierta frontal","Palette.backCover":"Contraportada","Palette.addPages":"Agregar páginas","Palette.addLayouts":"Obtenga más diseños","Palette.uploadInProgress":"Subida ({{value}})","Palette.whereDoYouWantYourPicture":"¿Dónde quieres que tus fotos?","Palette.photoStrip":"Tira de fotos.","Palette.placeInStrip":"Coloque en la pestaña de fotos","Palette.newPage":"Nuevas página.","Palette.createNewPagesWithTheseImages":"Crear nuevas páginas con estas fotos","Palette.Ok":"Bueno","Palette.Cancel":"Cancelar","Palette.NoItemForCover":"Los productos que no se pueden aplicar a esta cubierta","Palette.uploadInProgressModalTitle":"Subir en curso","Palette.uploadInProgressModalBody":"Estamos subiendo tus fotos ahora. Mantenga actualizado su navegador abierto durante la carga.","Palette.uploadErrorTitle":"{{value}} foto(s) de su equipo no se pudo cargar.","Palette.uploadErrorModalBody":'Por favor, compruebe su conexión a internet connectionand seleccionar "Inténtalo de nuevo" para añadir las fotos a su libro<br /><br />Si esto no soluciona el problema, asegúrese de que usted no se ha mudado, cambiado de nombre o eliminado archivos de imagen.<br /><br />Seleccione "Cerrar" si desea volver a su libro y quitar las fotos marcadas.',"Palette.uploadErrorModalBodyPhone":'Por favor, compruebe su conexión a internet<br /> connectionand seleccionar "Inténtalo de<br /> nuevo" para añadir las fotos a su libro<br /><br />Si esto no soluciona el problema, asegúrese<br /> de que usted no se ha mudado, cambiado de<br /> nombre o eliminado archivos de imagen.<br /><br />Seleccione "Cerrar" si desea volver a su libro<br /> y quitar las fotos marcadas.',"Palette.uploadErrorModalBodySuffix":"Fotos que fueron colocados en el libro serán removidos.","Palette.uploadErrorModalBodySuffixPhone":"Fotos que fueron<br /> colocados en el libro serán removidos.","Palette.removePlacedImages":"Quite las imágenes colocadas","Palette.uploadErrorModalDescription":"Muestra miniaturas","Palette.retryUpload":"Inténtelo de nuevo","Palette.close":"Cerca","Palette.uploading":"Cargar","Palette.of":"de","Palette.layouts.1":"1","Palette.layouts.2":"2","Palette.layouts.3":"3","Palette.layouts.4":"4","Palette.layouts.5":"5+","Palette.layouts.text":"Texto","Palette.layouts.spreads":"Spreads","Palette.modeTwo":"Dos espacio de trabajo de paleta","Palette.modeOne":"One palette workspace","Palette.mode.subtext":"Disposiciones sobre la izquierda y las fotos en la parte inferior","Palette.modes.advance.edit":"","Palette.modes.advance.edit.subtext":"","Palette.line":"Line","Palette.extended.title":"Seleccione los elementos de diseño","Palette.extended.button":"Obtener más","Palette.extended.addbutton":"Agregar al Proyecto","Palette.extended.footer":"Parte de estilos Cuentacuentos a la carta","Palette.extended.footer.learnmore":"Más información","Palette.extended.numitems":"Mostrando {{value}} cosa(s)","Palette.extended.pages":"Pages","Palette.extended.type":"Type","Palette.extended.interior":"Interior Pages","Palette.extended.spread":"Spread","Palette.extended.cover":"Cover","Palette.extended.layouts":"Layouts","Palette.extended.backgrounds":"Fondos","Palette.extended.embellishments":"Embellecimientos","Palette.extended.stickers":"Stickers","Palette.extended.ribbons":"Ribbons","Palette.extended.frames":"Frames","Palette.extended.ideapages":"Idea Pages","Palette.extended.layouts.lowercase":"layouts","Palette.extended.backgrounds.lowercase":"backgrounds","Palette.extended.ideapages.lowercase":"idea pages","Palette.stickers.lowercase":"stickers","Palette.frames.lowercase":"frames","Palette.extended.searchText":"Búsqueda {{value}}","Palette.extended.search.numitems":"Encontrado {{value}} cosa(s)","Palette.extended.popupItemPrice":"{{value}} para uso ilimitado en este libro","Palette.extended.noCharge":"No hay cargo adicional por el uso de este elemento","Palette.extended.favorites.title":"Favoritas ({{value}})","Palette.extended.favorites.message":"El filtrado avanzado no está disponible mientras favoritos navegando","Palette.imageDelete.title":"Error Deleting Image","Palette.imageDelete.description":"This image is used in your book and can't be deleted.","Palette.photoStack.dragMessage":"Drag photos onto a page","SilverApp.move.button":"Mover","SilverApp.add.button":"Añadir","SilverApp.goto.button":"Goto","SilverApp.applySettings.button":"Apply settings","SilverApp.addPageTooltip":"Haga clic para añadir una página","SilverApp.noThanks":"No, gracias","SilverApp.skip":"Salta","SilverApp.sort.by":"Ordenar por","SilverApp.sort.by.added.ascending":"Order added to project","SilverApp.sort.by.added.descending":"Order added to project (reverse)","SilverApp.date.taken.ascending":"Date taken (oldest to newest)","SilverApp.date.taken.descending":"Date taken (newest to oldest)","SilverApp.sort.by.title.ascending":"Title (A-Z)","SilverApp.sort.by.title.descending":"Title (Z-A)","Palette.numPhotos":"{{value}} fotos","SilverApp.getStarted":"Empieza","SilverApp.storyBoardTitle":"Crea tu álbum digital más rápido con Storyboard","SilverApp.storyBoardText":"Arrastre las fotografías a cada página de su libro de fotos e instantáneamente añadir y organizar para usted - es así de fácil.","SilverApp.prompt.storyboardTitle":"Create your calendar faster with Storyboard","SilverApp.prompt.storyboardText":"Drag your photos to each page of your project and we'll instantly add and arrange them for you - it's that easy.","SilverApp.doNotShowAgain":"No mostrar de nuevo","SilverApp.Page":"Page {{value}}","SilverApp.Share.dialog.title":"Cuota","SilverApp.Share.dialog.submit":"Enviar","SilverApp.Share.dialog.desc":"Ahora, comparte tu obra maestra con otros.","SilverApp.Share.dialog.tab.email":"Email","SilverApp.Share.dialog.tab.facebook":"Facebook","SilverApp.Share.dialog.tab.weblink":"Enlaces Web","SilverApp.Share.dialog.tab.other":"Más opciones","SilverApp.Share.dialog.emails":"Direcciones de correo electrónico","SilverApp.Share.dialog.subject":"Libro de fotos compartidas de","SilverApp.Share.dialog.message":"Hey! Echa un vistazo a este libro hice.","SilverApp.Share.dialog.emailmessage":"Echa un vistazo a mi Shutterfly producto.","SilverApp.Share.dialog.charlimitlabel":"Caracteres restantes: ","SilverApp.Share.dialog.fbmessage":"Echa un vistazo a mi Shutterfly Photo Book.","SilverApp.Share.subject":"Libro de fotos compartidas de Shutterfly","SilverApp.Share.message":"Echa un vistazo a mi Shutterfly Photo Book.","SilverApp.Share.dialog.submit.email":"Enviar","SilverApp.Share.dialog.submit.facebook":"Puesto","SilverApp.Share.dialog.submit.weblink":"Copiar enlace","SilverApp.Share.dialog.submit.other":"OK","SilverApp.Share.dialog.emailsent":"El correo electrónico enviado","SilverApp.Share.dialog.fbposted":"Continuar el proceso de participación en la ventana de Facebook.","SilverApp.Share.dialog.error":"Error!","SilverApp.Share.dialog.close":"Cerca","SilverApp.Share.dialog.requiredEmail":"Se requiere dirección de correo electrónico","SilverApp.Share.dialog.invalidEmail":"Inválido Email","SilverApp.Share.dialog.link":"Seleccione Copiar enlace para copiar el URL","SilverApp.Share.dialog.linknocopy":"Cuota de Proyecto URL","SilverApp.Share.dialog.disabled":"Has alcanzado el número máximo de álbumes o proyectos compartidos (5), puede enviar por hora.","SilverApp.Share.dialog.other.sites":"Añadir a mi sitio compartido (o crear uno nuevo)","SilverApp.Share.dialog.other.embed":"Opciones para obtener código de inserción y crear a otros sitios web","SilverApp.tour":"Gira Intro...","SilverApp.tour.introTitle":"Bienvenido","SilverApp.tour.startTour":"Comience gira","SilverApp.tour.introTourContent":"Hemos actualizado nuestra ruta de creación de álbum de fotos para darle una experiencia aún mejor. Echemos un rápido recorrido.","SilverApp.tour.toolbarTourContent":"Utilice la barra de herramientas para añadir fotos y páginas o deshacer cambios no deseados.","SilverApp.tour.editTabTourContent":"Utilice la pestaña Editar fotos y en la pestaña Organizar para mover páginas y organizar tu libro a tu manera. En la ficha del libro, elegir los tipos de primas de cobertura y de papel para su libro.","SilverApp.tour.bookTabTourContent":"Elija los tipos de primas de cobertura y de papel para su libro","SilverApp.tour.storyboardTabTourContent":"Use the Storyboard tab to organize photos and create your project faster.","SilverApp.tour.paletteTabTourContent":"Elija diseños de fotos y fondos que se adapten a su estilo","SilverApp.tour.orderButtonTourContent":"Ordene su libro con una caja de regalo y otros accesorios","SilverApp.tour.addPhotosButtonTourContent":"Añadir fotos de múltiples fuentes y de autocompletar por tu libro","SilverApp.tour.saveButtonTourContent":"Nombrar y guardar su libro y los cambios futuros se guardarán automáticamente cada 5 minutos.","SilverApp.tour.highlightsTourContent":"Destacados excluye fotos similares y las imágenes de baja calidad.","SilverApp.gc.tour.introTourContent":"We've updated our calendar creation path to give you an even better experience. let's take a quick tour.","SilverApp.gc.tour.editTabTourContent":"Use the Edit tab to apply new designs and the Events tab to personalize dates in your calendar.","SilverApp.gc.tour.storyboardTabTourContent":"Use the Storyboard tab to organize photos and create your project faster.","SilverApp.gc.tour.paletteTabTourContent":"Choose photo layouts and backgrounds that suit your style.","SilverApp.gc.tour.toolbarTourContent":"Use the toolbar to add photos and pages or undo unwanted changes.","SilverApp.gc.tour.highlightsTourContent":"Highlights helps you find your best photos by filtering out similar photos and low quality images.","SilverApp.gc.tour.embellishmentsTourContent":"Add fun and unique personal touches with our new embellishments! Choose from hundreds of stickers, patterns, frames and more.","Palette.stickers":"Pegatinas","Palette.frames":"Marcos","SilverApp.customize.popover.title":"Edición avanzada","SilverApp.customize.popover.message.active":"Usted está en el modo de edición avanzada - se puede mover y cambiar el tamaño de las etiquetas engomadas, texto y fotos con libertad. Haga clic en 'Modo avanzado Salir' para salir del modo. Para activar el modo de edición avanzada y fuera, utilice el menú Proyecto.","SilverApp.selectPhotosPrompt":"Seleccione las fotos y nos arreglaremos de inmediato en un libro de fotos hermosas.","SilverApp.selectPhotosPromptCalendars":"Select photos from various sources to add them to pages in your calendar.","SilverApp.selectPhotos":"Selecciona las fotos","SilverApp.arrangeTitle":"Arrange pages","SilverApp.arrangeText":"Organizar ahora permite mover, borrar y añadir fotos a las páginas, además de re-organización de sus páginas","SilverApp.preview":"Preview","SilverApp.editTitle":"Edit Title","SilverApp.storytellingItemCount":"{{value}} Storytelling item(s)","SilverApp.storytellingPass":"Storytelling items","SilverApp.storytellingStyle":"Storytelling style","SilverApp.options":"Options","SilverApp.returnToEdit":"Return to edit","SilverApp.returnToEditFromPreview":"Salir de previsualización","SilverApp.editTitleMenu":"Edit cover text...","SilverApp.editTitleMenuSpine":"Edit spine text...","Palette.styles":"Styles","SilverApp.frontCoverPhone":"Front","SilverApp.backCoverPhone":"Back","SilverApp.exitAdvancedEdit":"Página personalizar salir","SilverApp.selectACover":"Select a Cover","SilverApp.bookType":"tipo de libro","SilverApp.styleModernWhite":"Modern White","SilverApp.styleBlackAndWhiteBackdrop":"Black And White Backdrop","SilverApp.styleBrightAndBold":"Bright And Bold","SilverApp.styleHelloLove":"Hello Love","SilverApp.styleThroughTheSeasons":"Through the Seasons","SilverApp.switchToCustomPath":"Switch to Custom Path","SilverApp.switchToSimplePath":"Switch to Simple Path","SilverApp.hotkey.customize.windows":"Ctrl+D","SilverApp.hotkey.customize.mac":"⌘D","SilverApp.hotkey.save.windows":"Ctrl+S","SilverApp.hotkey.save.mac":"⌘S","SilverApp.hotkey.addphotos.windows.menu":"Ctrl+U","SilverApp.hotkey.addphotos.mac.menu":"⌘U","SilverApp.hotkey.addtext.windows.menu":"Ctrl+B","SilverApp.hotkey.addtext.mac.menu":"⌘B","SilverApp.hotkey.addphotos.windows":"Add photos (Ctrl+U)","SilverApp.hotkey.addphotos.mac":"Add photos (⌘U)","SilverApp.hotkey.addtext.windows":"Add text (Ctrl+B)","SilverApp.hotkey.addtext.mac":"Add text (⌘B)","SilverApp.hotkey.undo.windows":"Undo (Ctrl+Z)","SilverApp.hotkey.undo.mac":"Undo (⌘Z)","SilverApp.hotkey.redo.windows":"Redo (Ctrl+Y)","SilverApp.hotkey.redo.mac":"Redo (⇧⌘Z)","SilverApp.hotkey.selectall.windows":"Ctrl+A","SilverApp.hotkey.selectall.mac":"⌘A","SilverApp.createPhotoSpread":"Crear difusión de fotos","SilverApp.shutterflyHomePage":"Go to the\n Shutterfly home page","SilverApp.startOver":"Empezar de nuevo","SilverApp.feedback":"Envíenos sus comentarios","SilverApp.selectCoverPhotoMenu":"Select cover photo...","SilverApp.selectCoverPhoto":"Select cover photo","SilverApp.exitToMyShutterfly":"Exit to My Shutterfly","SilverApp.mmb.introTitle":"Welcome to your custom designed photo book","SilverApp.mmb.introText":"What’s next?<br>&bull; Review your photo book<br>&bull; Make any edits you like directly in the book<br>&bull; Order your book at any time","SilverApp.mmb.introText.mobile":"What’s next?<br>&bull; Review your photo book.<br>&bull; Make any edits you like directly <span class='red-text'>by opening the book on your desktop.</span><br>&bull; Order your book at any time.","SilverApp.mmb.reviewBook":"Review Book","Calendars.product.name":"Calendar","Calendars.eventstab.entrytext":"Create your own events then select them to add to your current project","Calendars.eventstab.myEvents":"My events","Calendars.eventstab.publicHolidays":"Public holidays","Calendars.eventstab.maxEvents":"Maximum 2 active events per day","Calendars.eventstab.addNewEvent":"Create new event","Calendars.eventstab.resetPublicEvents":"Reset to default selection","Calendars.eventstab.addToProject":"Add to project","Calendars.eventstab.selectAll":"Select all","Calendars.eventstab.photo":"Photo","Calendars.eventstab.eventName":"Event name","Calendars.eventstab.relationship":"Relationship","Calendars.eventstab.occasion":"Occasion","Calendars.eventstab.occurrence":"Occurrence","Calendars.eventstab.noEventsListed":"No events listed","Calendars.eventstab.saved":"Events added to this list will be saved.","Calendars.eventstab.notLoggedIn":"Sign in to view and edit your events.","Calendars.eventstab.login":"Sign in","Calendars.eventstab.deleteEvent":"Delete event","Calendars.eventstab.deleteModalLine1":"If you continue, this event will be permanently removed from My Calendar lists.","Calendars.eventstab.deleteModalLine2":"Are you sure that you want to delete this event?","Calendars.eventstab.selectionModalContent":"Only 3 events can be enabled for the same day. Uncheck an event to enable an additional one.","Calendars.eventstab.selectionModalHeader":"Cannot enable event","Calendars.eventstab.selectionInlineWarning":"This day already has 3 active events. This event will be inactive when saved.","Calendars.eventstab.eventsIntroTitle":"Add events to your calendar","Calendars.eventstab.eventsIntroText":"Review your list and select the events you would like to add to your calendar.","Calendars.eventstab.eventsIntroTextWithSignin":"Sign in to access your saved events or to add your own.","Calendars.eventstab.filterBy":"filtrado por","Calendars.EventFilter.showAll":"Mostrar Todo","Calendars.EventFilter.myEvents":"Mis eventos","Calendars.EventFilter.publicEvents":"Eventos Públicos","occasion default":"Occasion","occasion anniversary":"Anniversary","occasion birthday":"Birthday","occasion celebration":"Party/Celebration","occasion graduation":"Graduation","occasion holiday":"Public holiday","occasion wedding":"Wedding","occasion bar_mitzvah":"Bar/Bat Mitzvah","occasion vacation":"Vacation","occasion other":"Other event","occurrence default":"Occurrence","occurrence false":"One time event","occurrence true":"Every year","relationship default":"Relationship","relationship my_own":"My own","relationship significant_other":"Significant other","relationship child":"Child","relationship mother":"Mother","relationship father":"Father","relationship sibling":"Sibling","relationship grandparent":"Grandparent","relationship aunt_uncle":"Aunt/Uncle","relationship friend":"Friend","relationship teacher":"Teacher","relationship other":"Other","Calendar.cover.label":"Cover","Calendar.cover.1":"Jan","Calendar.cover.2":"Feb","Calendar.cover.3":"Mar","Calendar.cover.4":"Apr","Calendar.cover.5":"May","Calendar.cover.6":"Jun","Calendar.cover.7":"Jul","Calendar.cover.8":"Aug","Calendar.cover.9":"Sep","Calendar.cover.10":"Oct","Calendar.cover.11":"Nov","Calendar.cover.12":"Dec","Calendar.cover.jan":"JAN","Calendar.cover.feb":"FEB","Calendar.cover.mar":"MAR","Calendar.cover.apr":"APR","Calendar.cover.may":"MAY","Calendar.cover.jun":"JUN","Calendar.cover.jul":"JUL","Calendar.cover.aug":"AUG","Calendar.cover.sep":"SEP","Calendar.cover.oct":"OCT","Calendar.cover.nov":"NOV","Calendar.cover.dec":"DEC","Calendar.cover.january":"January","Calendar.cover.february":"February","Calendar.cover.march":"March","Calendar.cover.april":"April","Calendar.cover.june":"June","Calendar.cover.july":"July","Calendar.cover.august":"August","Calendar.cover.september":"September","Calendar.cover.october":"October","Calendar.cover.november":"November","Calendar.cover.december":"December","Calendar.navigation.top":"Top","Calendar.navigation.bottom":"Bottom","Calendar.palette.layoutsDisabled":"No additional layouts available for current page selection","Calendar.palette.ideaPagesDisabled":"No additional idea pages available for current page selection","SilverApp.objectMenu":"Object","SilverApp.editMenu":"Edit","SilverApp.editMenuSelectAll":"Select all","SilverApp.editMenuCut":"Cut","SilverApp.editMenuCopy":"Copy","SilverApp.editMenuPaste":"Paste","SilverApp.removeUnusedPhotos.title":"Remove unused photos","SilverApp.removeUnusedPhotos.text":"Are you sure you want to remove all unused photos from this project?","SilverApp.removeUnusedPhotos.note":"Note: Removing unused photos will not delete the photos, it only removes them from this project to free up space for other photos.","SilverApp.removeUnusedPhotos.cancel":"Don't remove","SilverApp.removeUnusedPhotos.confirm":"Remove","SilverApp.removeStickers.menuItem":"Remove stickers...","SilverApp.removeStickers.title":"Remove stickers","SilverApp.removeStickers.text":"Select which stickers you would like to remove.","SilverApp.removeStickers.fromPage.formatedPageNumber":"page {{value}}","SilverApp.removeStickers.fromPage":"Remove stickers from {{value}} only","SilverApp.removeStickers.fromBook":"Remove all stickers from book","SilverApp.removeStickers.button.cancel":"Don't remove","SilverApp.removeStickers.button.confirm":"Remove","Palette.itemsNotAddedToProject":"Want to add {{value}} to your project?","Palette.addItemsToProject":"Click here","Palette.ideaPagesNotAddedToProject":"Want to add idea pages to your project?","Palette.addIdeaPagesToProject":"Click here","Slideshow.ipad.mercury.downloadApp":"Hacer un álbum de fotos en su iPad con Shutterfly Photo Story. DESCARGA LA APLICACIÓN >","Slideshow.iphone.voyager.downloadApp":"Captura tu propia aventura con la aplicación TripPix. Es una manera rápida y fácil de crear recuerdos permanentes de sus momentos más épicos. DESCARGA LA APLICACIÓN >","Slideshow.iphone.apollo.downloadApp":"Crea tu propio álbum con la aplicación BabyPix. Es una manera rápida y fácil de crear recuerdos permanentes de sus momentos más épicos. DESCARGA LA APLICACIÓN >","Slideshow.iphone.ranger.downloadApp":"Crea tu propio álbum con la aplicación SocialPix. Es una manera rápida y fácil de crear recuerdos permanentes de sus momentos más épicos. DESCARGA LA APLICACIÓN >","SilverApp.tablet.showText":"Show Text","SilverApp.tablet.hideText":"Hide Text","SilverApp.tablet.youNeedPhotos1":"Usted necesita entre","SilverApp.tablet.youNeedPhotosAnd":"y ","SilverApp.tablet.youNeedPhotos2":"fotos, para hacer su book.<br>Click Aceptar para agregar fotos.","SilverApp.smartStoryboard.blankPage":"Página en blanco","SilverApp.smartStoryboard.makeSpread.tooltip":"Hacer spread","SilverApp.smartStoryboard.splitSpread.tooltip":"división spread","SilverApp.editEvent":"Edit event","SilverApp.clickToEditEvent":"To change the event text, click 'Edit event'","SilverApp.pagesView.navbar.title":"Edit","SilverApp.session.timeout.title":"Session ended","SilverApp.session.timeout.1":"Your product creation/editing session has ended.","SilverApp.session.timeout.2":"You may have started a project in another tab or window.","SilverApp.session.timeout.3":"Your session may have been timed out.","SilverApp.session.timeout.4":"Please remember to save projects you are working on.  The last saved version of your project can be accessed from ","SilverApp.session.timeout.5":" in the My Shutterfly page.","SilverApp.session.timeout.goToStore":"Go to store"};var translations=window.translations||{};translations.fr={"Palette.addIdeaPagesToProject":"Click here","SilverApp.tablet.showText":"Show Text","SilverApp.tablet.hideText":"Hide Text","SilverApp.tablet.youNeedPhotos1":"Vous avez besoin entre ","SilverApp.tablet.youNeedPhotosAnd":"et ","SilverApp.tablet.youNeedPhotos2":"photos pour faire votre livre.<br>cliquez sur OK pour ajouter des photos","SilverApp.session.timeout.title":"Session ended","SilverApp.session.timeout.1":"Your product creation/editing session has ended.","SilverApp.session.timeout.2":"You may have started a project in another tab or window.","SilverApp.session.timeout.3":"Your session may have been timed out.","SilverApp.session.timeout.4":"Please remember to save projects you are working on.  The last saved version of your project can be accessed from ","SilverApp.session.timeout.5":" in the My Shutterfly page.","SilverApp.session.timeout.goToStore":"Go to store"};var translations=window.translations||{};translations.uppen={sources:"Select a source",photo:"photo",all:"All photos",selected:"Selected photos",done:"Done",cancel:"Cancel",back:"Back",retry:"Try again",pending:"Loading...",emptyFolder:"This folder is empty.",emptyAlbum:"This album is empty.",emptySelection:"Nothing selected",authRequired:"You must be signed in to access these pictures.",detailTitle:"${0} of ${1}",sortBy:"Sort by",sortChoices:{titleAtoZ:"Title (A-Z)",titleZtoA:"Title (Z-A)"},select:{label:"Select:",all:"All",none:"None"},importing:{title:"Importing photos",text:"Your ${0} ${1} being imported...",itemName:"photo",verb:{singular:"is",plural:"are"},pause:"Pause",resume:"Resume",cancel:"Cancel",error:{title:"Problems importing photos",text:"Sorry, we were unable to import ${0}&nbsp;of&nbsp;${1} photos.",retry:"Retry",skip:"Skip these photos"}},retrying:{text:"Retrying ${0}...",itemName:"photo",verb:{singular:"is",plural:"are"},error:{text:"Sorry, we were unable to import ${0} of ${1} photos."}},xfer:{title:"Adding photos",text:"Copying photos ${0} of ${1} to Shutterfly",error:{title:"Error Adding Photos",sorry:"We're sorry",text:"We were only able to copy ${0} of your ${1} selected photos.  You can either retry adding all your photos, or go to your project with the ${0} available photos.",textNoPics:"We were unable to transfer your selected photos. Please go back to your project and try again.",textNoRetry:"We were only able to copy ${0} of your ${1} selected photos.",goToProject:"Go to project",retry:"Try again"},stalled:{heading:"Copying photos is taking longer than expected.",itemName:"photo",text:"You can continue trying to transfer all of them, or, go to your project with the ${0} already added.",retry:"Keep waiting",giveUp:"Go to project"}},error:{sorry:"We're sorry",text:"We were unable to get ${0}."},cannotAdd:{title:"Can't add more photos.",text:{mobile:"To make more room, go to the desktop version of our website and remove some photos from your project.",
desktop:"To make more room, remove some previously selected photos from your project."}},tooMany:{title:"Select fewer photos",itemName:"more photo",text:"Only ${0} can be added to your project."},cannotSelect:{title:"Can't select photo",itemName:"photo",text:"You've reached the limit for this project or page, please deselect another photo first."},cannotSelectAll:{title:"Can't select all photos",itemName:"photo",text:"You must either de-select some photos first, or, select fewer additional photos."},noSink:{text:"Sorry; you currently can't select photos from ${0}.",title:"Can't select this photo"},upload:{myAlbums:"My Albums",mobileUploads:"Mobile Uploads",albumName:"Y-m-d"},typeError:{title:"Unsupported file type",text:"We were unable to select the following files because they are not supported by Shutterfly.${0}"},sizeError:{title:"Files too large",text:"We were unable to select the following files because they are too large; Shutterfly only allows files up to 10MB.${0}"},cancelConfirm:{title:"Cancel import",text:"Are you sure you want to cancel? None of your selected photos will be added to your project.",ok:"Cancel Import",cancel:"Don't Cancel"},navigateWarning:{text:"Photo imports are still in progress.  If you reload or leave this page, then some photos will not be imported."},title:"Get Photos",signin:{signin:"Sign in",signup:"Sign up",header:"<strong>Sign in</strong> to Shutterfly to get photos from all sources.",signinTitle:"Sign in to Shutterfly",signinButton:"Sign in",signinSwitch:"Don't have an account yet?",signinForgotPW:"Forgot password?",signinError:"Unable to sign in to Shutterfly. Please try again.",signupTitle:"Sign up for Shutterfly",signupButton:"Sign up",signupSwitch:"",signupEmailMe:"Send me special offers and info.",signupError:"Unable to sign in to Shutterfly. Please try again."}};var translations=window.translations||{};translations.uppes={sources:"Seleccione una fuente",photo:"foto",all:"Todas las fotos",selected:"Fotos seleccionadas",done:"Hecho",cancel:"Cancelar",back:"Respaldar",retry:"Inténtelo de nuevo",pending:"Sobreprima...",emptyFolder:"Esta carpeta está vacía.",emptyAlbum:"Este álbum está vacío.",emptySelection:"Nada seleccionado",authRequired:"Debes iniciar sesión para acceder a estas fotos.",detailTitle:"${0} of ${1}",sortBy:"Ordenar por",sortChoices:{titleAtoZ:"Título(A-Z)",titleZtoA:"Título(Z-A)"},select:{label:"Seleccionar:",all:"Todo",none:"Ninguno"},importing:{title:"Importación de fotografías",text:"Su $ {0} $ {1} se importen...",itemName:"foto",verb:{singular:"es",plural:"es"},pause:"Rotura",resume:"Currículum",cancel:"Cancelar",error:{title:"Problemas importar fotos",text:"Lo sentimos, no hemos podido importar ${0}&nbsp;de &nbsp;${1} fotos.",retry:"Reintente",skip:"Ir estas fotos"}},retrying:{text:"Reintentando${0}...",itemName:"foto",verb:{singular:"es",plural:"es"},error:{text:"Lo sentimos, no hemos podido importar $ {0} de $ {1} fotos."}},xfer:{title:"Añadiendo fotos",text:"Copia de fotos $ {0} de $ {1} a Shutterfly",error:{title:"Error agregar fotos",sorry:"Lo sentimos",text:"Sólo pudimos copiar $ {0} de sus $ {1} fotos seleccionadas. Usted puede intentar agregar todas tus fotos, o ir a su proyecto con la $ {0} fotos disponibles.",textNoPics:"No fue posible transferir las fotos seleccionadas. Por favor, vuelva a su proyecto y vuelva a intentarlo.",textNoRetry:"Sólo pudimos copiar $ {0} de sus $ {1} fotos seleccionadas. ",goToProject:"Ir al proyecto",retry:"Inténtelo de nuevo"},stalled:{heading:"Copia de fotografías está tardando más de lo esperado.",itemName:"foto",text:"Usted puede seguir tratando de transferir la totalidad de ellos, o, vaya a su proyecto con los $ {0} ya se ha agregado.",retry:"Mantenga espera",giveUp:"Ir al proyecto"}},error:{sorry:"Lo sentimos",text:"No se pudo obtener $ {0} ."},cannotAdd:{title:"No se pueden añadir más fotos. ",text:{mobile:"Para hacer más espacio, vaya a la versión de escritorio de nuestro sitio web y eliminar algunas fotos de su proyecto.",desktop:"Para hacer más espacio, eliminar algunas fotos seleccionadas previamente de su proyecto."}},tooMany:{title:"Selecciona menos fotos",itemName:"más fotos",text:"Sólo $ {0} se puede agregar a su proyecto ."},cannotSelect:{title:"No se puede seleccionar la foto",itemName:"foto",text:"Has alcanzado el límite para este proyecto, por favor desmarque otra foto primero."},cannotSelectAll:{title:"No se pueden seleccionar todas las fotos",itemName:"foto",text:"Debe ya sea de-seleccionar algunas fotos primero, o, seleccionar fotografías adicionales menos."},noSink:{text:"Lamentablemente. ¿Actualmente no es posible seleccionar fotos desde $ {0}. ",title:"No se puede seleccionar esta foto"},upload:{myAlbums:"Mis álbumes",mobileUploads:"Contenido de móvil",albumName:"Y-m-d"},typeError:{title:"Tipo de archivo no compatible",text:"No fue posible seleccionar los siguientes archivos porque no son compatibles con Shutterfly.${0}"},sizeError:{title:"Archivos demasiado grandes",text:"No fue posible seleccionar los siguientes archivos, ya que son demasiado grandes; Shutterfly sólo permite archivos de hasta 10 MB.${0}"},cancelConfirm:{title:"Cancel Import",text:"¿Está seguro que desea cancelar? Ninguna de las fotos seleccionadas se agrega al proyecto.",ok:"Cancelar Import",cancel:"No cancelan"},navigateWarning:{text:"Las importaciones de la foto son todavía en curso. Si vuelve a cargar o salir de esta página, a continuación, no se importarán unas fotos ."},title:"Obtener fotos",signin:{signin:"Registrarse",signup:"Contratar",header:"Iniciar sesión en Shutterfly para obtener fotos de todas las fuentes.",signinTitle:"Iniciar sesión en Shutterfly",signinButton:"Registrarse",signinSwitch:"¿No tienes una cuenta todavía? ",signinForgotPW:"Contraseña olvidada?",signinError:"No es posible iniciar sesión en Shutterfly. Por favor, inténtalo de nuevo",signupTitle:"Regístrate en Shutterfly",signupButton:"Contratar",signupSwitch:"",signupEmailMe:"Enviar ofertas especiales e información.",signupError:"No es posible iniciar sesión en Shutterfly. Por favor, inténtalo de nuevo."}};var translations=window.translations||{};translations.uppfr={sources:"S�lectionnez une source",photo:"photo",all:"All photos",selected:"Selected photos",done:"Done",cancel:"Cancel",back:"Back",retry:"Try again",pending:"Loading...",emptyFolder:"This folder is empty.",emptyAlbum:"This album is empty.",emptySelection:"Nothing selected",authRequired:"You must be signed in to access these photos.",detailTitle:"${0} of ${1}",sortBy:"Sort by",sortChoices:{titleAtoZ:"Title (A-Z)",titleZtoA:"Title (Z-A)"},select:{label:"Select:",all:"All",none:"None"},importing:{title:"Importing photos",text:"Your ${0} ${1} being imported...",itemName:"photo",verb:{singular:"is",plural:"are"},pause:"Pause",resume:"Resume",cancel:"Cancel",error:{title:"Problems importing photos",text:"Sorry, we were unable to import ${0}&nbsp;of&nbsp;${1} photos.",retry:"Retry",skip:"Skip these photos"}},retrying:{text:"Retrying ${0}...",itemName:"photo",verb:{singular:"is",plural:"are"},error:{text:"Sorry, we were unable to import ${0} of ${1} photos."}},xfer:{title:"Adding photos",text:"Copying photos ${0} of ${1} to Shutterfly",error:{title:"Error Adding Photos",sorry:"We're sorry",text:"We were only able to copy ${0} of your ${1} selected photos.  You can either retry adding all your photos, or go to your project with the ${0} available photos.",textNoPics:"We were unable to transfer your selected photos. Please go back to your project and try again.",textNoRetry:"We were only able to copy ${0} of your ${1} selected photos.",goToProject:"Go to project",retry:"Try again"},stalled:{heading:"Copying photos is taking longer than expected.",itemName:"photo",text:"You can continue trying to transfer all of them, or, go to your project with the ${0} already added.",retry:"Keep waiting",giveUp:"Go to project"}},error:{sorry:"We're sorry",text:"We were unable to get ${0}."},cannotAdd:{title:"Can't add more photos.",text:{mobile:"To make more room, go to the desktop version of our website and remove some photos from your project.",desktop:"To make more room, remove some previously selected photos from your project."}},tooMany:{title:"Select fewer photos",itemName:"more photo",text:"Only ${0} can be added to your project."},cannotSelect:{title:"Can't select photo",itemName:"photo",text:"You've reached the limit for this project, please deselect another photo first."},cannotSelectAll:{title:"Can't select all photos",itemName:"photo",text:"You must either de-select some photos first, or, select fewer additional photos."},noSink:{text:"Sorry; you currently can't select photos from ${0}.",title:"Can't select this photo"},upload:{myAlbums:"My Albums",mobileUploads:"Mobile Uploads",albumName:"Y-m-d"},typeError:{title:"Unsupported file type",text:"We were unable to select the following files because they are not supported by Shutterfly.${0}"},sizeError:{title:"Files too large",text:"We were unable to select the following files because they are too large; Shutterfly only allows files up to 10MB.${0}"},cancelConfirm:{title:"Cancel import",text:"Are you sure you want to cancel? None of your selected photos will be added to your project.",ok:"Cancel Import",cancel:"Don't Cancel"},navigateWarning:{text:"Photo imports are still in progress.  If you reload or leave this page, then some photos will not be imported."},title:"Get Photos",signin:{signin:"Sign in",signup:"Sign up",header:"Select up to 40 photos. <strong>Sign in</strong> to Shutterfly to get photos from all sources.",signinTitle:"Sign in to Shutterfly",signinButton:"Sign in",signinSwitch:"Don't have an account yet?",signinForgotPW:"Forgot password?",signinError:"Unable to sign in to Shutterfly. Please try again.",signupTitle:"Sign up for Shutterfly",signupButton:"Sign up",signupSwitch:"",signupEmailMe:"Send me special offers and info.",signupError:"Unable to sign in to Shutterfly. Please try again."}};var translations=window.translations||{};translations.cachedConfig={"config-beta":{projectLoadService:"https://ws.beta.shutterfly.com/services/mobile/photobook-project",uploadService:"https://uniup.beta.shutterfly.com/services/shutterfly-upload",sharedProjectLoadService:"https://im1.beta.shutterfly.com/services/mobile/photobook-project/shared/photobooks",sharedProjectLoadAltService:"https://im1.beta.shutterfly.com/services/mobile/photobook-project/shared/collection/photobooks",projectSaveService:"https://api.beta.shutterfly.com/project/mobile/photobook",projectEventService:"https://api.beta.shutterfly.com/project/project-event",extendedPaletteAttributeService:"https://ws.beta.shutterfly.com/attribute/gphotobook/extpalette/values?displayobjecttype=",extendedPaletteContentService:"https://ws.beta.shutterfly.com/attribute/gphotobook/extpalette?type=",extendedPaletteSearchService:"https://ws.beta.shutterfly.com/attribute/gphotobook/searchby?keywords=",extendedPaletteAssetRefService:"https://ws.beta.shutterfly.com/attributes?method=findObjectsAttributes&addAssetRefs=true",extendedPaletteFavoriteService:"https://ws.beta.shutterfly.com/favorites/",extendedPaletteFavoriteContentService:"https://ws.beta.shutterfly.com/attribute/gphotobook/extpalette/favorites",arfRenderPageService:"/imaging/idp/body/sdxml/jpg/jpegResolution=[JPEG_RESOLUTION];jpegQuality=[JPEG_QUALITY];testing=[IS_TESTING];target=PRINT;exportType=jpg;addBleedFrame=true;noBleed=true;",arfTool:"http://arf.beta.shutterfly.com",itemPricingService:"https://ws.beta.shutterfly.com/store/itempricingsummary",fontService:"https://ws.beta.shutterfly.com/content/fonts/css?fontId=",web2PrintHost:"text.beta.shutterfly.com",photoccinoHost:"rank.gamma.thislife.com",photoccinoAPIKey:"917418fa13822ffc168f016937407f2e",secureApiServer:"https://api.beta.shutterfly.com",secureApiKey:"dAGb8WEdM5sMGCRUcsatIoFCHaqsndhJ",secureApiAuthorization:"ZEFHYjhXRWRNNXNNR0NSVWNzYXRJb0ZDSGFxc25kaEo6TzBrNUgxR044ZjJNQkxSaQ==",reflyProjectService:"https://projects.beta.shutterfly.com",apigeeUrl:"https://api2.beta.shutterfly.com",apiKey:"djOlaaty605xAgYG2jOc9MwuwWtJ8NgG",cdnServer:"https://cdn-beta.staticsfly.com",secureAppServer:"https://www.beta.shutterfly.com",bookInitService:"/initbook/query.sfly",appServer:"https://www.beta.shutterfly.com",magicshopGetBookService:"https://beta-magic.photoccino.com/GetBook?",magicShopTemplateService:"https://beta-magic.photoccino.com/GetTemplate?",forgotPassword:"/secure/password_forgot.jsp",myShutterfly:"/home/myshutterfly.sfly",termsAndConditionsUrl:"http://shutterfly-inc.com/terms.html",privacyPolicyUrl:"http://shutterfly-inc.com/privacy.html",styleServiceBase:"https://c1-beta.staticsfly.com",styleServiceHost:"c1-beta.staticsfly.com",docsmith:{url:"https://booknode.beta.shutterfly.com",version:"0"},mediaPreferenceService:"https://media.beta.shutterfly.com/services",userMediaService:"/user-media",imageMediaService:"https://ws.beta.shutterfly.com/services/user-media",procSimpleService:"https://im.beta.shutterfly.com/procsimple",procServService:"https://im.beta.shutterfly.com/procserv",help:"https://shutterfly-2.custhelp.com/app/answers/detail/a_id/1654",chat:"https://shutterfly-2.custhelp.com/app/chat/chat_launch_books",feedback:"",afsService:"https://im1.beta.shutterfly.com",styleAssets:"https://c1-beta.staticsfly.com/asset/fetch",userInfoService:"/userXML/query.sfly?command=getSessionUserInfo&version=v2",userInfoServiceOld:"/userXML/query.sfly?command=getSessionUserInfo",convertImagesService:"https://www.beta.shutterfly.com/convertImages/associateImagesWithUser.sfly",shareService:"https://ws.beta.shutterfly.com/alacarteshare",shareUrl:"https://share.beta.shutterfly.com/action/welcome",facebookShareUrl:"http://www.facebook.com/sharer/sharer.php?u=",pinterestShareUrl:"http://pinterest.com/pin/create/button/?url=",sitesShareUrl:"https://www.beta.shutterfly.com/share/siteshare/start.sfly",embedShareUrl:"https://www.beta.shutterfly.com/share/shareout/start.sfly",myprojectsUrl:"https://www.beta.shutterfly.com/myProjects/start.sfly",storeUrl:"https://www.beta.shutterfly.com/store",clientId:"3b733e76281f3d5e4e2001039aca9312",env:"beta",enableNGDebugInfo:"true",superSimple:!1,defaults:{coverSpecId:"10x10_bk_hard",coverFinish:"",coverBinding:"looseleaf",minimumImageDPI:100,docsmithConcurrentContentRequests:2,maxDelayedPatchCount:"3",constraints:{TextAreaCountConstraint:{rule:"variable",pageSpecific:{inner:"variable"}},GroupSizeConstraint:{min:0,max:4},GroupCountConstraint:{min:20,max:111},LayoutAttributesMatchConstraint:{front:{usedForAutofill:[!0]},back:{usedForAutofill:[!0]},spine:{usedForAutofill:[!0]},title:{usedForAutofill:[!0]},inner:{usedForAutofill:[!0]}},LinearDensityConstraint:{densityPoints:[[20,1],[30,1.5],[40,2],[50,2],[60,2],[70,2],[80,2],[90,2],[100,2],[125,2.1],[150,2.1],[175,2.1],[200,2.1],[225,2.3],[250,2.3],[300,2.7],[400,3.6],[500,4.5],[600,5.4],[700,6.3],[800,7.2],[900,8.1],[1e3,9]]},SpreadConstraint:{min:0,max:0}},logLevel:"INFO",logErrorsAsCritical:"true",logUrl:"/application/silver.gif",maxAllowedImages:1e3,maxAllowedImagesForIE10:500,uploadThreads:2,maxErrorLogs:100,maxPages:111,minPages:20,undoLimitLength:20,autoSaveTimer:6e5,sessionIdleTimeout:18e5,initialAutoSaveTimer:12e4,uppImageUpdatedExceededTimer:3e4,zoomFactor:1,autofillMinImages:3,autofillMaxImages:300,allowAnonymousUploads:!0,paletteMode:"dual",language:"en",hideUsed:!0,highlights:!1,hideStoryboardIntro:!1,hideCustomizeIntro:!1,hideArrangeIntro:!1,ranIntroTour:!1,loadUppOnStart:!0,startupMode:"prompt",allowAnonymousUpload:!1,hoverDelay:1e3,productMode:"book",tourOnStart:"true",forceTourOnStart:"false",startupTab:"edit",uppLocalImageSizeLimit:{width:500,height:500},innerMarginPx:8,initialAutofill:!0,useUniversalStylesOnly:!1,passiveMode:!1,photoccinoGetRankBatchSize:20,patchSaveInterval:6e5},superSimpleDefaults:{desktop:{constraints:{GroupCountConstraint:{min:20,max:111},SpreadConstraint:{min:100,max:100},LinearDensityConstraint:{densityPoints:[[20,1],[30,1.5],[40,2],[50,2],[60,2],[70,2],[80,2],[90,2],[100,2],[125,2.1],[150,2.1],[175,2.1],[200,2.1]]}},photoSelection:{max:200,min:20}},phone:{constraints:{layoutCategory:"universal",GroupCountConstraint:{min:20,max:40},LinearDensityConstraint:{densityPoints:[[20,1],[30,1],[40,1]]}},photoSelection:{max:40,min:20}},tablet:{constraints:{GroupCountConstraint:{min:20,max:111},SpreadConstraint:{min:100,max:100},LayoutAttributesMatchConstraint:{},LinearDensityConstraint:{densityPoints:[[20,1],[30,1.5],[40,2],[50,2],[60,2],[70,2],[80,2],[90,2],[100,2],[125,2.1],[150,2.1],[175,2.1],[200,2.1]]},ImageCountConstraint:{match:"exact_match",fallback:"fallback_any_layout"},TextAreaCountConstraint:{rule:"variable",pageSpecific:{back:"none"}}},photoSelection:{maxPerSpread:6,max:200,min:20},coverLayouts:{front:"10x10hard_universal_02_00L00P08S_a_frontcover"}}},features:{promptOnExit:"true",switchLanguage:"false",afsMode:"client",startWithFrontCover:"true",allowAutoSave:"true",allowHotKeys:"true",switchPalettes:"false",arrange:"true",customize:"true",advancedText:"true",upsell:"true",upsell_hardCover:"true",upsell_matteFinish:"true",upsell_dustJacket:"true",upsell_layflat:"true",upsell_hingedLayflat:"true",upsell_glossyPaper:"true",upsell_keepsakePocket:"true",hardCover:"true",stockCovers:"true",premiumCovers:"true",matteFinish:"true",dustJacket:"true",keepsakePocket:"true",storyboard:"true",smartStoryboard:"true",tour:"true",softRender:"true",embellishments:"true",realPictureAsBackground:"true",spreads:"true",debug_frequentProjectValidation:"true",advancedArrange:"true",styleDialog:"true",extendedPalette:"true",slideshow:"@@feature_slideshow",playButton:"false",clearAutofillPrompt:"true",richSubtypes:"true",photoccinoSuggestedCrop:"true",preview:"true",highlightsFeature:"false",textSettings:"true",applyToOtherPages:"true",disableAutofill:"false",zoom:"true",editSubMenu1:"true",removeAddPage:"",removeRemovePage:"",hidePages:!1,removeAllEmbellishments:"true",autoSwitchLanguage:"true",importPage:"true",baconV2:"true",exportToPDF:"true",calendarSinglePalette:"false",groupDuplicates:"true",saveErrorGuard:"true",clusterStoryboard:"true",helpOverlay:"false",advancedEventsTab:"true",whatsNewTour:"false",previewText:"true",virtualAssets:"false",fade:"true",saveJPG:"true",photoArea:"true",pinterest:"false",legacySave:"false",incrementalSave:"true",sessionHeartbeat:"false",saveOnConversion:"true",magicShopProduct:"true",eventImageFix:"true",eventsPalette:"true",vividPicsEnabled:"true",newNav:"true"},documentDomain:"www.beta.shutterfly.com",productTitle:"",appStoreLinks:{ipad:{mercury:"http://hastrk2.com/serve?action=click&publisher_id=27376&site_id=27984&offer_id=255056&advertiser_sub_publisher=SFLY_PBIPAD_PBSLIDESHOW&advertiser_sub_campaign=SFLY_PBIPAD_PBSLIDESHOW"},iphone:{voyager:"https://itunes.apple.com/app/id983085413",apollo:"",ranger:""}},pb:{product:"pb",styleCatalog:"//www.beta.shutterfly.com/custom-path/stylecatalog.sfly?styleSelector",removeAddPage:"no",removeRemovePage:"no",productTitle:"Shutterfly | Photo Books",pricingService:"https://ws.beta.shutterfly.com/photobookprice",globalContentService:"https://im1.beta.shutterfly.com/content/photobook/globalcontent/s2",feedback:"https://www.surveymonkey.com/s/XX7KTXT",horizSurfacesInView:2,defaults:{styleId:"1103",styleVersion:"244"},features:{calendarSinglePalette:!1,hingedLayflat:"true",styleTab:!1}},ss:{productTitle:"Shutterfly | Collage Editor",pricingService:"https://ws.beta.shutterfly.com/photobookprice",globalContentService:"https://im1.beta.shutterfly.com/content/photobook/globalcontent/s2",feedback:"https://www.surveymonkey.com/s/XX7KTXT",defaults:{logUrl:"/application/silver.gif",initialAutofill:"false",styleId:"5082",styleVersion:"1",sizeId:"8x11",coverSpecId:"8x11_bk_hard",productMode:"editor"},features:{superSimple:!1,disableAutofill:!0,tour:!1,spreads:!1,upsell:!1,removeAllEmbellishments:!1,applyToOtherPages:!1,disableMobile:!0,disableTablet:!0,disableDevConsoleItems:!0,shouldBeginInCustomizeMode:!1,calendarSinglePalette:!1,styleTab:!1,textSettings:!1,exportToPDF:!1,whatsNewTour:!1,canvas:!1,newNav:!1}},gc:{product:"gc",styleCatalog:"//www.beta.shutterfly.com/calendar-styles/embed/",removeAddPage:"yes",removeRemovePage:"yes",hidePages:!0,help:"https://shutterfly-2.custhelp.com/app/answers/detail/a_id/1779",eventsService:"https://api.beta.shutterfly.com/calendarevents",productTitle:"Shutterfly | Calendars",pricingService:"https://ws.beta.shutterfly.com/calendarprice",globalContentService:"https://im1.beta.shutterfly.com/content/calendar/globalcontent",feedback:"https://www.surveymonkey.com/r/35W882C",calendarSinglePalette:!1,horizSurfacesInView:1,defaults:{logUrl:"/application/groundhog.gif",initialAutofill:"false",styleId:"5190",styleVersion:"1",sizeId:"12x12",gridRects:{"12x12":{"//":"baked-in: left, top: -7.2 bleed",left:53.8,top:186.8},"8x11":{"//":"baked-in: left: -9 bleed, top: -7.2 bleed",left:40.12,top:127.44}}},features:{calendarV2:"true",clearAutofillPrompt:!1,promptForStoryboard:!0,disableMobile:!0,disableTablet:!0,superSimple:!1,disableAutofill:!0,initialAutofill:!1,tour:!0,spreads:!1,upsell:!1,styleDialog:!1,removeAllEmbellishments:!1,applyToOtherPages:!1,exportToPDF:!1,disableDevConsoleItems:!0,switchPalettesEnabledForCalendars:!1,smartStoryboard:!1,saveJPG:!1,changeStartDate:"true",migrateEvents:"true"}}},"config-prod":{projectLoadService:"https://im1.shutterfly.com/services/mobile/photobook-project",uploadService:"https://uniup.shutterfly.com/services/shutterfly-upload",sharedProjectLoadService:"https://im1.shutterfly.com/services/mobile/photobook-project/shared/photobooks",sharedProjectLoadAltService:"https://im1.shutterfly.com/services/mobile/photobook-project/shared/collection/photobooks",projectSaveService:"https://api.shutterfly.com/project/mobile/photobook",projectEventService:"https://api.shutterfly.com/project/project-event",extendedPaletteAttributeService:"https://ws.shutterfly.com/attribute/gphotobook/extpalette/values?displayobjecttype=",extendedPaletteContentService:"https://ws.shutterfly.com/attribute/gphotobook/extpalette?type=",extendedPaletteSearchService:"https://ws.shutterfly.com/attribute/gphotobook/searchby?keywords=",extendedPaletteAssetRefService:"https://ws.shutterfly.com/attributes?method=findObjectsAttributes&addAssetRefs=true",extendedPaletteFavoriteService:"https://ws.shutterfly.com/favorites/",extendedPaletteFavoriteContentService:"https://ws.shutterfly.com/attribute/gphotobook/extpalette/favorites",arfRenderPageService:"/imaging/idp/body/sdxml/jpg/jpegResolution=[JPEG_RESOLUTION];jpegQuality=[JPEG_QUALITY];testing=[IS_TESTING];target=PRINT;exportType=jpg;addBleedFrame=true;noBleed=true;",arfTool:"http://arf.internal.shutterfly.com",itemPricingService:"https://ws.shutterfly.com/store/itempricingsummary",fontService:"https://ws.shutterfly.com/content/fonts/css?fontId=",web2PrintHost:"text.shutterfly.com",photoccinoHost:"rank.thislife.com",photoccinoAPIKey:"917418fa13822ffc168f016937407f2e",secureApiServer:"https://api.shutterfly.com",secureApiKey:"dAGb8WEdM5sMGCRUcsatIoFCHaqsndhJ",secureApiAuthorization:"ZEFHYjhXRWRNNXNNR0NSVWNzYXRJb0ZDSGFxc25kaEo6TzBrNUgxR044ZjJNQkxSaQ==",reflyProjectService:"https://projects.internal.shutterfly.com",apigeeUrl:"https://api2.shutterfly.com",apiKey:"fVFk0J9J0zAGnGTDQNqHDSLxHYtna4t3",cdnServer:"https://cdn.staticsfly.com",secureAppServer:"https://www.shutterfly.com",bookInitService:"/initbook/query.sfly",appServer:"https://www.shutterfly.com",magicshopGetBookService:"https://magic.photoccino.com/GetBook?",magicShopTemplateService:"https://magic.photoccino.com/GetTemplate?",forgotPassword:"/secure/password_forgot.jsp",myShutterfly:"/home/myshutterfly.sfly",termsAndConditionsUrl:"http://shutterfly-inc.com/terms.html",privacyPolicyUrl:"http://shutterfly-inc.com/privacy.html",styleServiceBase:"https://c1.staticsfly.com",styleServiceHost:"c1.staticsfly.com",docsmith:{url:"https://booknode.shutterfly.com",version:"0.8.0-2888"},mediaPreferenceService:"https://media.shutterfly.com/services",userMediaService:"/user-media",imageMediaService:"https://ws.shutterfly.com/services/user-media",procSimpleService:"https://im1.shutterfly.com/procsimple",procServService:"https://im1.shutterfly.com/procserv",help:"https://shutterfly-2.custhelp.com/app/answers/detail/a_id/1654",chat:"https://shutterfly-2.custhelp.com/app/chat/chat_launch_books",feedback:"",afsService:"https://im1.shutterfly.com",styleAssets:"https://c1.staticsfly.com/asset/fetch",userInfoService:"/userXML/query.sfly?command=getSessionUserInfo&version=v2",userInfoServiceOld:"/userXML/query.sfly?command=getSessionUserInfo",convertImagesService:"https://www.shutterfly.com/convertImages/associateImagesWithUser.sfly",shareService:"https://ws.shutterfly.com/alacarteshare",shareUrl:"https://share.shutterfly.com/action/welcome",facebookShareUrl:"http://www.facebook.com/sharer/sharer.php?u=",pinterestShareUrl:"http://pinterest.com/pin/create/button/?url=",sitesShareUrl:"https://www.shutterfly.com/share/siteshare/start.sfly",embedShareUrl:"https://www.shutterfly.com/share/shareout/start.sfly",myprojectsUrl:"https://www.shutterfly.com/myProjects/start.sfly",storeUrl:"https://www.shutterfly.com/store",clientId:"0800bd6fc6e4fc5a59e90cd4574244fa",env:"prod",enableNGDebugInfo:"false",superSimple:!1,defaults:{coverSpecId:"10x10_bk_hard",coverFinish:"",coverBinding:"looseleaf",minimumImageDPI:100,docsmithConcurrentContentRequests:2,maxDelayedPatchCount:"3",constraints:{TextAreaCountConstraint:{rule:"variable",pageSpecific:{inner:"variable"}},GroupSizeConstraint:{min:0,max:4},GroupCountConstraint:{min:20,max:111},LayoutAttributesMatchConstraint:{front:{usedForAutofill:[!0]},back:{usedForAutofill:[!0]},spine:{usedForAutofill:[!0]},title:{usedForAutofill:[!0]},inner:{usedForAutofill:[!0]}},LinearDensityConstraint:{densityPoints:[[20,1],[30,1.5],[40,2],[50,2],[60,2],[70,2],[80,2],[90,2],[100,2],[125,2.1],[150,2.1],[175,2.1],[200,2.1],[225,2.3],[250,2.3],[300,2.7],[400,3.6],[500,4.5],[600,5.4],[700,6.3],[800,7.2],[900,8.1],[1e3,9]]},SpreadConstraint:{min:0,max:0}},logLevel:"INFO",logErrorsAsCritical:"false",logUrl:"/application/silver.gif",maxAllowedImages:1e3,maxAllowedImagesForIE10:500,uploadThreads:2,maxErrorLogs:100,maxPages:111,minPages:20,undoLimitLength:20,autoSaveTimer:6e5,sessionIdleTimeout:18e5,initialAutoSaveTimer:12e4,uppImageUpdatedExceededTimer:3e4,zoomFactor:1,autofillMinImages:3,autofillMaxImages:300,allowAnonymousUploads:!0,paletteMode:"dual",language:"en",hideUsed:!0,highlights:!1,hideStoryboardIntro:!1,hideCustomizeIntro:!1,hideArrangeIntro:!1,ranIntroTour:!1,loadUppOnStart:!0,startupMode:"prompt",allowAnonymousUpload:!1,hoverDelay:1e3,productMode:"book",tourOnStart:"true",forceTourOnStart:"false",startupTab:"edit",uppLocalImageSizeLimit:{width:500,height:500},innerMarginPx:8,initialAutofill:!0,useUniversalStylesOnly:!1,passiveMode:!1,photoccinoGetRankBatchSize:20,patchSaveInterval:6e5},superSimpleDefaults:{desktop:{constraints:{GroupCountConstraint:{min:20,max:111},SpreadConstraint:{min:100,max:100},LinearDensityConstraint:{densityPoints:[[20,1],[30,1.5],[40,2],[50,2],[60,2],[70,2],[80,2],[90,2],[100,2],[125,2.1],[150,2.1],[175,2.1],[200,2.1]]}},photoSelection:{max:200,min:20}},phone:{constraints:{layoutCategory:"universal",GroupCountConstraint:{min:20,max:40},LinearDensityConstraint:{densityPoints:[[20,1],[30,1],[40,1]]}},photoSelection:{max:40,min:20}},tablet:{constraints:{GroupCountConstraint:{min:20,max:111},SpreadConstraint:{min:100,max:100},LayoutAttributesMatchConstraint:{},LinearDensityConstraint:{densityPoints:[[20,1],[30,1.5],[40,2],[50,2],[60,2],[70,2],[80,2],[90,2],[100,2],[125,2.1],[150,2.1],[175,2.1],[200,2.1]]},ImageCountConstraint:{match:"exact_match",fallback:"fallback_any_layout"},TextAreaCountConstraint:{rule:"variable",pageSpecific:{back:"none"}}},photoSelection:{maxPerSpread:6,max:200,min:20},coverLayouts:{front:"10x10hard_universal_02_00L00P08S_a_frontcover"}}},features:{promptOnExit:"true",switchLanguage:"false",afsMode:"client",startWithFrontCover:"true",allowAutoSave:"true",allowHotKeys:"true",switchPalettes:"false",arrange:"true",customize:"true",advancedText:"true",upsell:"true",upsell_hardCover:"true",upsell_matteFinish:"true",upsell_dustJacket:"true",upsell_layflat:"true",upsell_hingedLayflat:"true",upsell_glossyPaper:"true",upsell_keepsakePocket:"true",hardCover:"true",stockCovers:"true",premiumCovers:"true",matteFinish:"true",dustJacket:"true",keepsakePocket:"true",storyboard:"true",smartStoryboard:"true",tour:"true",softRender:"true",embellishments:"true",realPictureAsBackground:"false",spreads:"true",debug_frequentProjectValidation:"true",advancedArrange:"true",styleDialog:"true",extendedPalette:"true",slideshow:"@@feature_slideshow",playButton:"false",clearAutofillPrompt:"true",richSubtypes:"true",photoccinoSuggestedCrop:"true",preview:"true",highlightsFeature:"false",textSettings:"true",applyToOtherPages:"true",disableAutofill:"false",zoom:"true",editSubMenu1:"false",removeAddPage:"",removeRemovePage:"",hidePages:!1,removeAllEmbellishments:"true",autoSwitchLanguage:"false",importPage:"true",baconV2:"true",exportToPDF:"true",calendarSinglePalette:"false",groupDuplicates:"false",saveErrorGuard:"false",clusterStoryboard:"true",helpOverlay:"false",advancedEventsTab:"true",whatsNewTour:"false",previewText:"true",virtualAssets:"false",fade:"true",saveJPG:"false",photoArea:"true",pinterest:"false",legacySave:"false",incrementalSave:"true",sessionHeartbeat:"false",saveOnConversion:"true",magicShopProduct:"true",eventImageFix:"true",eventsPalette:"true",vividPicsEnabled:"true",newNav:"false"},documentDomain:"www.shutterfly.com",productTitle:"",appStoreLinks:{ipad:{mercury:"http://hastrk2.com/serve?action=click&publisher_id=27376&site_id=27984&offer_id=255056&advertiser_sub_publisher=SFLY_PBIPAD_PBSLIDESHOW&advertiser_sub_campaign=SFLY_PBIPAD_PBSLIDESHOW"},iphone:{voyager:"https://itunes.apple.com/app/id983085413",apollo:"",ranger:""}},pb:{product:"pb",styleCatalog:"//www.shutterfly.com/custom-path/stylecatalog.sfly?styleSelector",removeAddPage:"no",removeRemovePage:"no",productTitle:"Shutterfly | Photo Books",pricingService:"https://ws.shutterfly.com/photobookprice",globalContentService:"https://im1.shutterfly.com/content/photobook/globalcontent/s2",feedback:"https://www.surveymonkey.com/s/XX7KTXT",horizSurfacesInView:2,defaults:{styleId:"1103",styleVersion:"244"},features:{calendarSinglePalette:!1,hingedLayflat:"true",styleTab:!1}},ss:{productTitle:"Shutterfly | Collage Editor",pricingService:"https://ws.shutterfly.com/photobookprice",globalContentService:"https://im1.shutterfly.com/content/photobook/globalcontent/s2",feedback:"https://www.surveymonkey.com/s/XX7KTXT",defaults:{logUrl:"/application/silver.gif",initialAutofill:"false",styleId:"5082",styleVersion:"1",sizeId:"8x11",coverSpecId:"8x11_bk_hard",productMode:"editor"},features:{superSimple:!1,disableAutofill:!0,tour:!1,spreads:!1,upsell:!1,removeAllEmbellishments:!1,applyToOtherPages:!1,disableMobile:!0,disableTablet:!0,disableDevConsoleItems:!0,shouldBeginInCustomizeMode:!1,calendarSinglePalette:!1,styleTab:!1,textSettings:!1,exportToPDF:!1,whatsNewTour:!1,canvas:!1,newNav:!1}},gc:{product:"gc",styleCatalog:"//www.shutterfly.com/calendar-styles/embed/",removeAddPage:"yes",removeRemovePage:"yes",hidePages:!0,help:"https://shutterfly-2.custhelp.com/app/answers/detail/a_id/1779",eventsService:"https://api.shutterfly.com/calendarevents",productTitle:"Shutterfly | Calendars",pricingService:"https://ws.shutterfly.com/calendarprice",globalContentService:"https://im1.shutterfly.com/content/calendar/globalcontent",feedback:"https://www.surveymonkey.com/r/35W882C",calendarSinglePalette:!1,horizSurfacesInView:1,defaults:{logUrl:"/application/groundhog.gif",initialAutofill:"false",styleId:"5190",styleVersion:"1",sizeId:"12x12",gridRects:{"12x12":{"//":"baked-in: left, top: -7.2 bleed",left:53.8,top:186.8},"8x11":{"//":"baked-in: left: -9 bleed, top: -7.2 bleed",left:40.12,top:127.44}}},features:{calendarV2:"true",
clearAutofillPrompt:!1,promptForStoryboard:!0,disableMobile:!0,disableTablet:!0,superSimple:!1,disableAutofill:!0,initialAutofill:!1,tour:!0,spreads:!1,upsell:!1,styleDialog:!1,removeAllEmbellishments:!1,applyToOtherPages:!1,exportToPDF:!1,disableDevConsoleItems:!0,switchPalettesEnabledForCalendars:!1,smartStoryboard:!1,saveJPG:!1,changeStartDate:"true",migrateEvents:"true"}}},"config-stage":{projectLoadService:"https://ws.stage.shutterfly.com/services/mobile/photobook-project",uploadService:"https://uniup.stage.shutterfly.com/services/shutterfly-upload",sharedProjectLoadService:"https://im1.stage.shutterfly.com/services/mobile/photobook-project/shared/photobooks",sharedProjectLoadAltService:"https://im1.stage.shutterfly.com/services/mobile/photobook-project/shared/collection/photobooks",projectSaveService:"https://api.stage.shutterfly.com/project/mobile/photobook",projectEventService:"https://api.stage.shutterfly.com/project/project-event",extendedPaletteAttributeService:"https://ws.stage.shutterfly.com/attribute/gphotobook/extpalette/values?displayobjecttype=",extendedPaletteContentService:"https://ws.stage.shutterfly.com/attribute/gphotobook/extpalette?type=",extendedPaletteSearchService:"https://ws.stage.shutterfly.com/attribute/gphotobook/searchby?keywords=",extendedPaletteAssetRefService:"https://ws.stage.shutterfly.com/attributes?method=findObjectsAttributes&addAssetRefs=true",extendedPaletteFavoriteService:"https://ws.stage.shutterfly.com/favorites/",extendedPaletteFavoriteContentService:"https://ws.stage.shutterfly.com/attribute/gphotobook/extpalette/favorites",arfRenderPageService:"/imaging/idp/body/sdxml/jpg/jpegResolution=[JPEG_RESOLUTION];jpegQuality=[JPEG_QUALITY];testing=[IS_TESTING];target=PRINT;exportType=jpg;addBleedFrame=true;noBleed=true;",arfTool:"http://arf.stage.shutterfly.com",itemPricingService:"https://ws.stage.shutterfly.com/store/itempricingsummary",fontService:"https://ws.stage.shutterfly.com/content/fonts/css?fontId=",web2PrintHost:"text.stage.shutterfly.com",photoccinoHost:"rank.stage.thislife.com",photoccinoAPIKey:"917418fa13822ffc168f016937407f2e",secureApiServer:"https://api.stage.shutterfly.com",secureApiKey:"dAGb8WEdM5sMGCRUcsatIoFCHaqsndhJ",secureApiAuthorization:"ZEFHYjhXRWRNNXNNR0NSVWNzYXRJb0ZDSGFxc25kaEo6TzBrNUgxR044ZjJNQkxSaQ==",reflyProjectService:"https://projects.stage.shutterfly.com",apigeeUrl:"https://api2.stage.shutterfly.com",apiKey:"djOlaaty605xAgYG2jOc9MwuwWtJ8NgG",cdnServer:"https://cdn-stage.staticsfly.com",secureAppServer:"https://www.stage.shutterfly.com",bookInitService:"/initbook/query.sfly",appServer:"https://www.stage.shutterfly.com",magicshopGetBookService:"https://stage-magic.photoccino.com/GetBook?",magicShopTemplateService:"https://stage-magic.photoccino.com/GetTemplate?",forgotPassword:"/secure/password_forgot.jsp",myShutterfly:"/home/myshutterfly.sfly",termsAndConditionsUrl:"http://shutterfly-inc.com/terms.html",privacyPolicyUrl:"http://shutterfly-inc.com/privacy.html",styleServiceBase:"https://c1-stage.staticsfly.com",styleServiceHost:"c1-stage.staticsfly.com",docsmith:{url:"https://booknode.stage.shutterfly.com",version:"0.8.0-2888"},mediaPreferenceService:"https://media.stage.shutterfly.com/services",userMediaService:"/user-media",imageMediaService:"https://ws.stage.shutterfly.com/services/user-media",procSimpleService:"https://im1.stage.shutterfly.com/procsimple",procServService:"https://im1.stage.shutterfly.com/procserv",help:"https://shutterfly-2.custhelp.com/app/answers/detail/a_id/1654",chat:"https://shutterfly-2.custhelp.com/app/chat/chat_launch_books",feedback:"",afsService:"https://im1.stage.shutterfly.com",styleAssets:"https://c1-stage.staticsfly.com/asset/fetch",userInfoService:"/userXML/query.sfly?command=getSessionUserInfo&version=v2",userInfoServiceOld:"/userXML/query.sfly?command=getSessionUserInfo",convertImagesService:"https://www.stage.shutterfly.com/convertImages/associateImagesWithUser.sfly",shareService:"https://ws.stage.shutterfly.com/alacarteshare",shareUrl:"https://share.stage.shutterfly.com/action/welcome",facebookShareUrl:"http://www.facebook.com/sharer/sharer.php?u=",pinterestShareUrl:"http://pinterest.com/pin/create/button/?url=",sitesShareUrl:"https://www.stage.shutterfly.com/share/siteshare/start.sfly",embedShareUrl:"https://www.stage.shutterfly.com/share/shareout/start.sfly",myprojectsUrl:"https://www.stage.shutterfly.com/myProjects/start.sfly",storeUrl:"https://www.stage.shutterfly.com/store",clientId:"0800bd6fc6e4fc5a59e90cd4574244fa",env:"stage",enableNGDebugInfo:"false",superSimple:!1,defaults:{coverSpecId:"10x10_bk_hard",coverFinish:"",coverBinding:"looseleaf",minimumImageDPI:100,docsmithConcurrentContentRequests:2,maxDelayedPatchCount:"3",constraints:{TextAreaCountConstraint:{rule:"variable",pageSpecific:{inner:"variable"}},GroupSizeConstraint:{min:0,max:4},GroupCountConstraint:{min:20,max:111},LayoutAttributesMatchConstraint:{front:{usedForAutofill:[!0]},back:{usedForAutofill:[!0]},spine:{usedForAutofill:[!0]},title:{usedForAutofill:[!0]},inner:{usedForAutofill:[!0]}},LinearDensityConstraint:{densityPoints:[[20,1],[30,1.5],[40,2],[50,2],[60,2],[70,2],[80,2],[90,2],[100,2],[125,2.1],[150,2.1],[175,2.1],[200,2.1],[225,2.3],[250,2.3],[300,2.7],[400,3.6],[500,4.5],[600,5.4],[700,6.3],[800,7.2],[900,8.1],[1e3,9]]},SpreadConstraint:{min:0,max:0}},logLevel:"WARN",logErrorsAsCritical:"false",logUrl:"/application/silver.gif",maxAllowedImages:1e3,maxAllowedImagesForIE10:500,uploadThreads:2,maxErrorLogs:100,maxPages:111,minPages:20,undoLimitLength:20,autoSaveTimer:6e5,sessionIdleTimeout:18e5,initialAutoSaveTimer:12e4,uppImageUpdatedExceededTimer:3e4,zoomFactor:1,autofillMinImages:3,autofillMaxImages:300,allowAnonymousUploads:!0,paletteMode:"dual",language:"en",hideUsed:!0,highlights:!1,hideStoryboardIntro:!1,hideCustomizeIntro:!1,hideArrangeIntro:!1,ranIntroTour:!1,loadUppOnStart:!0,startupMode:"prompt",allowAnonymousUpload:!1,hoverDelay:1e3,productMode:"book",tourOnStart:"true",forceTourOnStart:"false",startupTab:"edit",uppLocalImageSizeLimit:{width:500,height:500},innerMarginPx:8,initialAutofill:!0,useUniversalStylesOnly:!1,passiveMode:!1,photoccinoGetRankBatchSize:20,patchSaveInterval:6e5},superSimpleDefaults:{desktop:{constraints:{GroupCountConstraint:{min:20,max:111},SpreadConstraint:{min:100,max:100},LinearDensityConstraint:{densityPoints:[[20,1],[30,1.5],[40,2],[50,2],[60,2],[70,2],[80,2],[90,2],[100,2],[125,2.1],[150,2.1],[175,2.1],[200,2.1]]}},photoSelection:{max:200,min:20}},phone:{constraints:{layoutCategory:"universal",GroupCountConstraint:{min:20,max:40},LinearDensityConstraint:{densityPoints:[[20,1],[30,1],[40,1]]}},photoSelection:{max:40,min:20}},tablet:{constraints:{GroupCountConstraint:{min:20,max:111},SpreadConstraint:{min:100,max:100},LayoutAttributesMatchConstraint:{},LinearDensityConstraint:{densityPoints:[[20,1],[30,1.5],[40,2],[50,2],[60,2],[70,2],[80,2],[90,2],[100,2],[125,2.1],[150,2.1],[175,2.1],[200,2.1]]},ImageCountConstraint:{match:"exact_match",fallback:"fallback_any_layout"},TextAreaCountConstraint:{rule:"variable",pageSpecific:{back:"none"}}},photoSelection:{maxPerSpread:6,max:200,min:20},coverLayouts:{front:"10x10hard_universal_02_00L00P08S_a_frontcover"}}},features:{promptOnExit:"true",switchLanguage:"false",afsMode:"client",startWithFrontCover:"true",allowAutoSave:"true",allowHotKeys:"true",switchPalettes:"false",arrange:"true",customize:"true",advancedText:"true",upsell:"true",upsell_hardCover:"true",upsell_matteFinish:"true",upsell_dustJacket:"true",upsell_layflat:"true",upsell_hingedLayflat:"true",upsell_glossyPaper:"true",upsell_keepsakePocket:"true",hardCover:"true",stockCovers:"true",premiumCovers:"true",matteFinish:"true",dustJacket:"true",keepsakePocket:"true",storyboard:"true",smartStoryboard:"true",tour:"true",softRender:"true",embellishments:"true",realPictureAsBackground:"false",spreads:"true",debug_frequentProjectValidation:"true",advancedArrange:"true",styleDialog:"true",extendedPalette:"true",slideshow:"@@feature_slideshow",playButton:"false",clearAutofillPrompt:"true",richSubtypes:"true",photoccinoSuggestedCrop:"true",preview:"true",highlightsFeature:"false",textSettings:"true",applyToOtherPages:"true",disableAutofill:"false",zoom:"true",editSubMenu1:"false",removeAddPage:"",removeRemovePage:"",hidePages:!1,removeAllEmbellishments:"true",autoSwitchLanguage:"false",importPage:"true",baconV2:"true",exportToPDF:"true",calendarSinglePalette:"false",groupDuplicates:"false",saveErrorGuard:"false",clusterStoryboard:"true",helpOverlay:"false",advancedEventsTab:"true",whatsNewTour:"false",previewText:"true",virtualAssets:"false",fade:"true",saveJPG:"true",photoArea:"true",pinterest:"false",legacySave:"false",incrementalSave:"true",sessionHeartbeat:"false",saveOnConversion:"true",magicShopProduct:"true",eventImageFix:"true",eventsPalette:"true",vividPicsEnabled:"true",newNav:"false"},documentDomain:"www.stage.shutterfly.com",productTitle:"",appStoreLinks:{ipad:{mercury:"http://hastrk2.com/serve?action=click&publisher_id=27376&site_id=27984&offer_id=255056&advertiser_sub_publisher=SFLY_PBIPAD_PBSLIDESHOW&advertiser_sub_campaign=SFLY_PBIPAD_PBSLIDESHOW"},iphone:{voyager:"https://itunes.apple.com/app/id983085413",apollo:"",ranger:""}},pb:{product:"pb",styleCatalog:"//www.stage.shutterfly.com/custom-path/stylecatalog.sfly?styleSelector",removeAddPage:"no",removeRemovePage:"no",productTitle:"Shutterfly | Photo Books",pricingService:"https://ws.stage.shutterfly.com/photobookprice",globalContentService:"https://im1.stage.shutterfly.com/content/photobook/globalcontent/s2",feedback:"https://www.surveymonkey.com/s/XX7KTXT",horizSurfacesInView:2,defaults:{styleId:"1103",styleVersion:"244"},features:{calendarSinglePalette:!1,hingedLayflat:"true",styleTab:!1}},ss:{productTitle:"Shutterfly | Collage Editor",pricingService:"https://ws.stage.shutterfly.com/photobookprice",globalContentService:"https://im1.stage.shutterfly.com/content/photobook/globalcontent/s2",feedback:"https://www.surveymonkey.com/s/XX7KTXT",defaults:{logUrl:"/application/silver.gif",initialAutofill:"false",styleId:"5082",styleVersion:"1",sizeId:"8x11",coverSpecId:"8x11_bk_hard",productMode:"editor"},features:{superSimple:!1,disableAutofill:!0,tour:!1,spreads:!1,upsell:!1,removeAllEmbellishments:!1,applyToOtherPages:!1,disableMobile:!0,disableTablet:!0,disableDevConsoleItems:!0,shouldBeginInCustomizeMode:!1,calendarSinglePalette:!1,styleTab:!1,textSettings:!1,exportToPDF:!1,whatsNewTour:!1,canvas:!1,newNav:!1}},gc:{product:"gc",styleCatalog:"//www.stage.shutterfly.com/calendar-styles/embed/",removeAddPage:"yes",removeRemovePage:"yes",hidePages:!0,help:"https://shutterfly-2.custhelp.com/app/answers/detail/a_id/1779",eventsService:"https://api.stage.shutterfly.com/calendarevents",productTitle:"Shutterfly | Calendars",pricingService:"https://ws.stage.shutterfly.com/calendarprice",globalContentService:"https://im1.stage.shutterfly.com/content/calendar/globalcontent",feedback:"https://www.surveymonkey.com/r/35W882C",calendarSinglePalette:!1,horizSurfacesInView:1,defaults:{logUrl:"/application/groundhog.gif",initialAutofill:"false",styleId:"5190",styleVersion:"1",sizeId:"12x12",gridRects:{"12x12":{"//":"baked-in: left, top: -7.2 bleed",left:53.8,top:186.8},"8x11":{"//":"baked-in: left: -9 bleed, top: -7.2 bleed",left:40.12,top:127.44}}},features:{calendarV2:"true",clearAutofillPrompt:!1,promptForStoryboard:!0,disableMobile:!0,disableTablet:!0,superSimple:!1,disableAutofill:!0,initialAutofill:!1,tour:!0,spreads:!1,upsell:!1,styleDialog:!1,removeAllEmbellishments:!1,applyToOtherPages:!1,exportToPDF:!1,disableDevConsoleItems:!0,switchPalettesEnabledForCalendars:!1,smartStoryboard:!1,saveJPG:!1,changeStartDate:"true",migrateEvents:"true"}}}},angular.module("overrideUITemplates",[]).run(["$templateCache",function(a){"use strict";a.put("template/tabs/tab.html",'<li ng-class="{active: active, disabled: disabled}"><a ng-click="select()" tab-heading-transclude="">{{heading}}</a></li>')}]),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.modelInitializer=a,this.routeParams=b,this.$window=d,this.init(c),this.TRANSPARENT_IMAGE="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",this.hardCoverOptions=[{thumbImg:this.appServer+"/img_/photobooks/jsslideshow/2.0/modern white.png",styleName:"SilverApp.styleModernWhite",bookDesc:"8x8_bk_hard",phoneCoverLayouts:{layoutCandidates:{landscape:"8x8hard_modern-white_01_00L00P01S_mdot-cover-full-bleed_ideafrontcover",portrait:"8x8hard_modern-white_01_00L00P01S_mdot-cover-full-bleed_ideafrontcover",square:"8x8hard_modern-white_01_00L00P01S_mdot-cover-full-bleed_ideafrontcover",styleId:"5122"}}},{thumbImg:this.appServer+"/img_/photobooks/jsslideshow/2.0/black and white backdrop.png",styleName:"SilverApp.styleBlackAndWhiteBackdrop",bookDesc:"8x8_bk_hard",phoneCoverLayouts:{layoutCandidates:{landscape:"8x8hard_black-white-backdrop_01_01L00P00S_mdot-cover-c_ideafrontcover",portrait:"8x8hard_black-white-backdrop_01_00L01P00S_mdot-cover-b_ideafrontcover",square:"8x8hard_black-white-backdrop_01_00L00P01S_mdot-cover-a_ideafrontcover",styleId:"4007"}}},{thumbImg:this.appServer+"/img_/photobooks/jsslideshow/2.0/bright and bold.png",styleName:"SilverApp.styleBrightAndBold",bookDesc:"8x8_bk_hard",phoneCoverLayouts:{layoutCandidates:{landscape:"8x8hard_bright-and-bold_01_01L00P00S_mdot-cover-c_ideafrontcover",portrait:"8x8hard_bright-and-bold_01_00L01P00S_mdot-cover-b_ideafrontcover",square:"8x8hard_bright-and-bold_01_00L00P01S_mdot-cover-a_ideafrontcover",styleId:"5011"}}},{thumbImg:this.appServer+"/img_/photobooks/jsslideshow/2.0/hello love.png",styleName:"SilverApp.styleHelloLove",bookDesc:"8x8_bk_hard",phoneCoverLayouts:{layoutCandidates:{landscape:"8x8hard_hello-love_01_01L00P00S_landscape-mdot_ideafrontcover",portrait:"8x8hard_hello-love_01_00L01P00S_portrait-mdot_ideafrontcover",square:"8x8hard_hello-love_01_00L01P00S_square-mdot_ideafrontcover",styleId:"5047"}}},{thumbImg:this.appServer+"/img_/photobooks/jsslideshow/2.0/through the seasons.png",styleName:"SilverApp.styleThroughTheSeasons",bookDesc:"8x8_bk_hard",phoneCoverLayouts:{layoutCandidates:{landscape:"8x8hard_through-the-seasons_01_01L00P00S_landscape-mdot_ideafrontcover",portrait:"8x8hard_through-the-seasons_01_00L01P00S_portrait-mdot_ideafrontcover",square:"8x8hard_through-the-seasons_01_00L00P01S_square-mdot_ideafrontcover",styleId:"5055"}}}],this.softCoverOptions=[{thumbImg:this.appServer+"/img_/photobooks/jsslideshow/2.0/modern white.png",styleName:"SilverApp.styleModernWhite",bookDesc:"8x8_bk_soft",phoneCoverLayouts:{layoutCandidates:{landscape:"8x8soft_modern-white_01_00L00P01S_mdot-cover-full-bleed_ideafrontcover",portrait:"8x8soft_modern-white_01_00L00P01S_mdot-cover-full-bleed_ideafrontcover",square:"8x8soft_modern-white_01_00L00P01S_mdot-cover-full-bleed_ideafrontcover",styleId:"5122"}}},{thumbImg:this.appServer+"/img_/photobooks/jsslideshow/2.0/black and white backdrop.png",styleName:"SilverApp.styleBlackAndWhiteBackdrop",bookDesc:"8x8_bk_soft",phoneCoverLayouts:{layoutCandidates:{landscape:"8x8soft_black-white-backdrop_01_01L00P00S_mdot-cover-c_ideafrontcover",portrait:"8x8soft_black-white-backdrop_01_00L01P00S_mdot-cover-b_ideafrontcover",square:"8x8soft_black-white-backdrop_01_00L00P01S_mdot-cover-a_ideafrontcover",styleId:"4007"}}},{thumbImg:this.appServer+"/img_/photobooks/jsslideshow/2.0/hello love.png",styleName:"SilverApp.styleHelloLove",bookDesc:"8x8_bk_soft",phoneCoverLayouts:{layoutCandidates:{landscape:"8x8soft_hello-love_01_01L00P00S_landscape-mdot_ideafrontcover",portrait:"8x8soft_hello-love_01_00L01P00S_portrait-mdot_ideafrontcover",square:"8x8soft_hello-love_01_00L01P00S_square-mdot_ideafrontcover",styleId:"5047"}}},{thumbImg:this.appServer+"/img_/photobooks/jsslideshow/2.0/through the seasons.png",styleName:"SilverApp.styleThroughTheSeasons",bookDesc:"8x8_bk_soft",phoneCoverLayouts:{layoutCandidates:{landscape:"8x8soft_through-the-seasons_01_01L00P00S_landscape-mdot_ideafrontcover",portrait:"8x8soft_through-the-seasons_01_00L01P00S_portrait-mdot_ideafrontcover",square:"8x8soft_through-the-seasons_01_00L00P01S_square-mdot_ideafrontcover",styleId:"5055"}}},{thumbImg:this.appServer+"/img_/photobooks/jsslideshow/2.0/bright and bold.png",styleName:"SilverApp.styleBrightAndBold",bookDesc:"8x8_bk_soft",phoneCoverLayouts:{layoutCandidates:{landscape:"8x8soft_bright-and-bold_01_01L00P00S_mdot-cover-c_ideafrontcover",portrait:"8x8soft_bright-and-bold_01_00L01P00S_mdot-cover-b_ideafrontcover",square:"8x8soft_bright-and-bold_01_00L00P01S_mdot-cover-a_ideafrontcover",styleId:"5011"}}}]}var b,c;return c=["productTitle","afsService","clientId","defaults","phoneCoverLayouts","docsmith","env","convertImagesService","globalContentService","help","chat","feedback","pricingService","itemPricingService","procSimpleService","projectLoadService","uploadService","projectSaveService","extendedPaletteAttributeService","extendedPaletteContentService","extendedPaletteSearchService","extendedPaletteAssetRefService","extendedPaletteFavoriteService","extendedPaletteFavoriteContentService","magicshopGetBookService","magicShopTemplateService","styleCatalog","procServService","product","afsService","styleServiceBase","styleServiceHost","styleAssets","termsAndConditionsUrl","privacyPolicyUrl","secureApiServer","reflyProjectService","apigeeUrl","apiKey","cdnServer","imageMediaService","appServer","web2PrintHost","photoccinoHost","photoccinoAPIKey","documentDomain","projectEventService","arfRenderPageService","arfTool","shareService","shareUrl","facebookShareUrl","pinterestShareUrl","sitesShareUrl","embedShareUrl","myprojectsUrl","storeUrl","orderRedirectHandler","eventsService","removeAddPage","hidePages","removeRemovePage","horizSurfacesInView","appStoreLinks"],b={dev:"3c8f868865585d7d",beta:"1acfec3b2813c775","local-beta":"1acfec3b2813c775",pi:"c5fde4bda0a72015",stage:"a1f2cc9e0cf5a219",foxtrot:"13d3fe22cc039a0a",prod:"61ce91b4952b57b5"},a.prototype.init=function(a,b){var d,e,f;this.values=a,null==b&&(b={}),this._cachedFeatures={},f=this.values.features;for(d in f)e=f[d],"true"===e?this._cachedFeatures[d]=!0:"false"===e?this._cachedFeatures[d]=!1:this._cachedFeatures[d]=e;return this.modelInitializer.initialize(this,this.values,c)},a.prototype.stringFeatureFlag=function(a){var b,c,d,e;if(null!=a)for(e=[this.routeParams,this.userPrefs,this.features,this.values.defaults],c=0,d=e.length;c<d;c++)if(b=e[c],null!=b&&null!=b[a])return b[a]},a.prototype.booleanFeatureFlag=function(a){return""+this.stringFeatureFlag(a)=="true"},a.prototype.integerFeatureFlag=function(a){return parseInt(""+this.stringFeatureFlag(a),10)},a.prototype.defaultTrueBooleanFeatureFlag=function(a){var b,c,d,e;if(null!=a){for(e=[this.routeParams,this.userPrefs,this.features],c=0,d=e.length;c<d;c++)if(b=e[c],null!=b&&null!=b[a])return""+b[a]!="false";return!0}},a.prototype.booleanSetter=function(a,b){if("boolean"==typeof b)return this.features[a]=b,this.values.features[a]=""+b},a.prototype.genericSetter=function(a,b){return this.values.features[a]=this.features[a]=b},a.prototype.setUserPrefs=function(a){return this.userPrefs=a},a.prototype.protocolRelativeUrl=function(a){return"dev"===this.env?a:null!=a?a.replace(/http:/g,"https:"):void 0},a._sfgetter("features",function(){return this._cachedFeatures}),a._sfgetter("sizeId",function(){var a;return null!=(a=this.routeParams.sizeId)?a:this.values.defaults.sizeId}),a._sfgetter("startingMonth",function(){return null!=this.routeParams.startingMonth?parseInt(this.routeParams.startingMonth,10):1}),a._sfgetter("startingYear",function(){return null!=this.routeParams.startingYear?parseInt(this.routeParams.startingYear,10):(new Date).getFullYear()}),a._sfgetter("styleId",function(){return"true"===this.values.superSimple?this.values.defaults.styleId:null!=this.routeParams.styleId?this.routeParams.styleId:this.values.defaults.styleId}),a._sfgetter("styleVersion",function(){return null==this.routeParams.styleVersion?this.values.defaults.styleVersion:this.routeParams.styleVersion}),a._sfgetter("coverSpecId",function(){return this._validCoverSpecIdConvention(this.routeParams.coverSpecId)?this.routeParams.coverSpecId:this.values.defaults.coverSpecId}),a.prototype._validCoverSpecIdConvention=function(a){return null!=a&&0===a.search(/1?\d?[x|X]1?\d?_bk_\w*/g)},a._sfgetter("newNav",function(){return this.booleanFeatureFlag("newNav")}),a._sfgetter("stockCoverSpecId",function(){return this.routeParams.stockCoverSpecId}),a._sfgetter("pageFinish",function(){return this.routeParams.pageFinish}),a._sfgetter("coverFinish",function(){return null==this.routeParams.coverFinish?this.values.defaults.coverFinish:this.routeParams.coverFinish}),a._sfgetter("secureAppServer",function(){var a;return a=this.$window.document.location.href.match(/[a-z]?app\d+\S+shutterfly\.com/),(null!=a?a.length:void 0)>0?"https://"+a[0]:this.values.secureAppServer}),a._sfgetter("bookInitService",function(){return this.secureAppServer+this.values.bookInitService}),a._sfgetter("forgotPassword",function(){return this.secureAppServer+this.values.forgotPassword}),a._sfgetter("myShutterfly",function(){return this.secureAppServer+this.values.myShutterfly}),a._sfgetter("userMediaService",function(){return"Internet Explorer"===bowser.name?this.secureAppServer+"/services"+this.values.userMediaService:this.secureApiServer+this.values.userMediaService}),a._sfgetter("userInfoService",function(){return this.secureAppServer+this.values.userInfoService}),a._sfgetter("userInfoServiceOld",function(){return this.secureAppServer+this.values.userInfoServiceOld}),a._sfsetter("paletteMode",function(a){return this.values.defaults.paletteMode=a}),a._sfgetter("paletteMode",function(){return null!=this.routeParams.paletteMode?this.routeParams.paletteMode:this.values.defaults.paletteMode}),a._sfgetter("language",function(){var a;return null!=this.routeParams.language?this.routeParams.language:null!=(null!=(a=this.userPrefs)?a.language:void 0)?this.userPrefs.language:this.values.defaults.language}),a._sfsetter("language",function(a){return this.values.defaults.language=a}),a._sfgetter("autoSaveTimer",function(){return null!=this.routeParams.autoSaveTimer?this.routeParams.autoSaveTimer:this.values.defaults.autoSaveTimer}),a._sfgetter("sessionIdleTimeout",function(){return null!=this.routeParams.sessionIdleTimeout?this.routeParams.sessionIdleTimeout:this.values.defaults.sessionIdleTimeout}),a._sfgetter("zoomFactor",function(){return null!=this.routeParams.zoomFactor?this.routeParams.zoomFactor:this.values.defaults.zoomFactor}),a._sfgetter("eventsPalette",function(){return this.booleanFeatureFlag("eventsPalette")}),a._sfgetter("hideUsed",function(){return this.booleanFeatureFlag("hideUsed")}),a._sfgetter("hingedLayflat",function(){return this.booleanFeatureFlag("hingedLayflat")}),a._sfgetter("clusterStoryboard",function(){return this.booleanFeatureFlag("clusterStoryboard")}),a._sfgetter("helpOverlay",function(){return this.booleanFeatureFlag("helpOverlay")}),a._sfgetter("highlights",function(){return this.booleanFeatureFlag("highlights")}),a._sfgetter("hideStoryboardIntro",function(){return this.booleanFeatureFlag("hideStoryboardIntro")}),a._sfgetter("hideArrangeIntro",function(){return this.booleanFeatureFlag("hideArrangIntro")}),a._sfgetter("passiveMode",function(){return this.booleanFeatureFlag("passiveMode")}),a._sfgetter("editSubMenu1",function(){return this.booleanFeatureFlag("editSubMenu1")}),a._sfgetter("zoom",function(){return this.booleanFeatureFlag("zoom")}),a._sfgetter("fade",function(){return this.booleanFeatureFlag("fade")}),a._sfgetter("saveJPG",function(){return this.booleanFeatureFlag("saveJPG")}),a._sfgetter("pinterest",function(){return this.booleanFeatureFlag("pinterest")}),a._sfgetter("preview",function(){return this.booleanFeatureFlag("preview")}),a._sfgetter("hideCustomizeIntro",function(){return this.booleanFeatureFlag("hideCustomizeIntro")}),a._sfgetter("ranIntroTour",function(){return this.booleanFeatureFlag("ranIntroTour")}),a._sfgetter("playButton",function(){return this.booleanFeatureFlag("playButton")}),a._sfsetter("playButton",function(a){return this.booleanSetter("playButton",a)}),a._sfgetter("photoccinoSuggestedCrop",function(){return this.booleanFeatureFlag("photoccinoSuggestedCrop")}),a._sfgetter("vividPicsEnabled",function(){return this.booleanFeatureFlag("vividPicsEnabled")}),a._sfgetter("realPictureAsBackground",function(){return this.booleanFeatureFlag("realPictureAsBackground")}),a._sfgetter("forceSignIn",function(){return null==this.routeParams.forceSignIn||"true"===this.routeParams.forceSignIn}),a._sfgetter("previewText",function(){return this.booleanFeatureFlag("previewText")}),a._sfgetter("photoccinoGetRankBatchSize",function(){return null!=this.routeParams.photoccinoGetRankBatchSize?this.routeParams.photoccinoGetRankBatchSize:this.values.defaults.photoccinoGetRankBatchSize}),a._sfgetter("dsVersion",function(){return null!=this.routeParams.dsVersion?this.routeParams.dsVersion:this.values.docsmith.version}),a._sfgetter("initialAutofill",function(){return this.defaultTrueBooleanFeatureFlag("initialAutofill")}),a._sfgetter("startupTab",function(){switch(this.routeParams.startupTab){case"storyboard":case"arrange":case"style":return this.routeParams.startupTab;case null:return this.values.defaults.startupTab;default:return"edit"}}),a._sfgetter("afsMode",function(){var a,b;return a=("server"===(b=this.routeParams.afsMode)||"client"===b||"off"===b)&&this.routeParams.afsMode||this.values.features.afsMode,"off"===a?"off":null!=this.$window.bowser&&(this.$window.bowser.msie||this.$window.bowser.msedge||this.$window.bowser.safari&&"6.0"===this.$window.bowser.version)?"server":a}),a._sfgetter("customizeFilters",function(){return null!=this.$window.bowser&&!(this.$window.bowser.msie||this.$window.bowser.msedge)||"10.0"!==this.$window.bowser.version}),a._sfsetter("superSimple",function(a){return this.booleanSetter("superSimple",a)}),a._sfgetter("superSimple",function(){return this.booleanFeatureFlag("superSimple")}),a._sfsetter("slideshow",function(a){return this.booleanSetter("slideshow",a)}),a._sfgetter("slideshow",function(){return this.booleanFeatureFlag("slideshow")}),a._sfgetter("arrange",function(){return this.booleanFeatureFlag("arrange")}),a._sfsetter("arrange",function(a){return this.booleanSetter("arrange",a)}),a._sfgetter("promptOnExit",function(){return this.defaultTrueBooleanFeatureFlag("promptOnExit")}),a._sfgetter("calendarSinglePalette",function(){return this.booleanFeatureFlag("calendarSinglePalette")}),a._sfsetter("calendarSinglePalette",function(a){return this.booleanSetter("calendarSinglePalette",a)}),a._sfgetter("canOrderFromSlideshow",function(){return this.defaultTrueBooleanFeatureFlag("canOrderFromSlideshow")}),a._sfgetter("hideHeaderForSlideshow",function(){return null!=this.routeParams.hideHeaderForSlideshow&&"true"===this.routeParams.hideHeaderForSlideshow}),a._sfgetter("noTextOnCover",function(){return null!=this.routeParams.noTextOnCover&&"true"===this.routeParams.noTextOnCover}),a._sfgetter("forceIncrSave",function(){return null!=this.routeParams.forceIncrSave&&"true"===this.routeParams.forceIncrSave}),a._sfgetter("fakeTokenFailure",function(){return null!=this.routeParams.fakeTokenFailure&&"true"===this.routeParams.fakeTokenFailure}),a._sfgetter("startWithFrontCover",function(){return this.booleanFeatureFlag("startWithFrontCover")}),a._sfsetter("startWithFrontCover",function(a){return this.booleanSetter("startWithFrontCover",a)}),a._sfgetter("allowAutoSave",function(){return this.booleanFeatureFlag("allowAutoSave")}),a._sfsetter("allowAutoSave",function(a){return this.booleanSetter("allowAutoSave",a)}),a._sfgetter("allowHotKeys",function(){return this.booleanFeatureFlag("allowHotKeys")}),a._sfsetter("allowHotKeys",function(a){return this.booleanSetter("allowHotKeys",a)}),a._sfgetter("loadUppOnStart",function(){return this.defaultTrueBooleanFeatureFlag("loadUppOnStart")}),a._sfgetter("startupMode",function(){return null==this.routeParams.startupMode?this.values.defaults.startupMode:this.routeParams.startupMode}),a._sfsetter("customize",function(a){return this.booleanSetter("customize",a)}),a._sfgetter("customize",function(){return this.booleanFeatureFlag("customize")}),a._sfgetter("switchLanguage",function(){return this.booleanFeatureFlag("switchLanguage")}),a._sfsetter("storyboard",function(a){return this.booleanSetter("storyboard",a)}),a._sfgetter("storyboard",function(){return this.booleanFeatureFlag("storyboard")}),a._sfsetter("smartStoryboard",function(a){return this.booleanSetter("smartStoryboard",a)}),a._sfgetter("smartStoryboard",function(){return this.booleanFeatureFlag("smartStoryboard")}),a._sfgetter("exportToPDF",function(){return this.booleanFeatureFlag("exportToPDF")}),a._sfgetter("uploadThreads",function(){return null==this.routeParams.uploadThreads?this.values.defaults.uploadThreads:this.routeParams.uploadThreads}),a._sfgetter("maxErrorLogs",function(){return null==this.routeParams.maxErrorLogs?this.values.defaults.maxErrorLogs:parseInt(this.routeParams.maxErrorLogs)}),a._sfgetter("allowAnonymousUpload",function(){return null==this.routeParams.allowAnonymousUpload?this.values.defaults.allowAnonymousUpload:"false"!==this.routeParams.allowAnonymousUpload}),a._sfsetter("styleDialog",function(a){return this.booleanSetter("styleDialog",a)}),a._sfgetter("styleDialog",function(){return this.booleanFeatureFlag("styleDialog")}),a._sfgetter("tourOnStart",function(){return this.booleanFeatureFlag("tourOnStart")}),a._sfgetter("forceTourOnStart",function(){return this.booleanFeatureFlag("forceTourOnStart")}),a._sfgetter("whatsNewTour",function(){return this.booleanFeatureFlag("whatsNewTour")}),a._sfgetter("advancedArrange",function(){return this.booleanFeatureFlag("advancedArrange")}),a._sfsetter("advancedArrange",function(a){return this.booleanSetter("advancedArrange",a)}),a._sfgetter("clearAutofillPrompt",function(){return this.booleanFeatureFlag("clearAutofillPrompt")}),a._sfsetter("clearAutofillPrompt",function(a){return this.booleanSetter("clearAutofillPrompt",a)}),a._sfsetter("spreads",function(a){return this.booleanSetter("spreads",a)}),a._sfgetter("spreads",function(){return this.booleanFeatureFlag("spreads")}),a._sfgetter("legacySave",function(){return"false"!==this.values.features.legacySave}),a._sfgetter("sessionHeartbeat",function(){return this.booleanFeatureFlag("sessionHeartbeat")}),a._sfgetter("richSubtypes",function(){return this.booleanFeatureFlag("richSubtypes")}),a._sfgetter("constraints",function(){var a;return a=angular.copy(this.values.defaults.constraints),this.spreads?(null!=this.routeParams.spreadConstraintMin&&(a.SpreadConstraint.min=parseInt(this.routeParams.spreadConstraintMin)),null!=this.routeParams.spreadConstraintMax&&(a.SpreadConstraint.max=parseInt(this.routeParams.spreadConstraintMax))):(a.SpreadConstraint.min=0,a.SpreadConstraint.max=0),a}),a._sfgetter("sharedProjectLoadService",function(){return"shareSite"===this.routeParams.shareType?this.values.sharedProjectLoadAltService:this.values.sharedProjectLoadService}),a._sfgetter("startWithSummary",function(){return"true"===this.routeParams.startWithSummary}),a._sfgetter("appType",function(){return this.routeParams.appType}),a._sfgetter("isBaconV2",function(){return this.booleanFeatureFlag("baconV2")}),a._sfgetter("virtualAssets",function(){return this.booleanFeatureFlag("virtualAssets")}),a._sfgetter("calendarV2",function(){return this.booleanFeatureFlag("calendarV2")}),a._sfsetter("incrementalSave",function(a){return this.values.features.incrementalSave=a}),a._sfsetter("legacySave",function(a){return this.values.features.legacySave=a}),a._sfgetter("incrementalSave",function(){return this.values.features.legacySave!==!0&&"true"!==this.values.features.legacySave&&"false"!==this.values.features.incrementalSave}),a._sfgetter("maxDelayedPatchCount",function(){return this.integerFeatureFlag("maxDelayedPatchCount")}),
a._sfgetter("saveOnConversion",function(){return this.defaultTrueBooleanFeatureFlag("saveOnConversion")}),a._sfgetter("patchSaveInterval",function(){return this.integerFeatureFlag("patchSaveInterval")}),a._sfgetter("magicShopProduct",function(){return this.booleanFeatureFlag("magicShopProduct")}),a._sfgetter("changeStartDate",function(){return this.booleanFeatureFlag("changeStartDate")}),a._sfgetter("migrateEvents",function(){return this.booleanFeatureFlag("migrateEvents")}),a.prototype.runningTests=function(){return null!=this.$window.__karma__||null!=this.$window.jasmine||"true"===this.routeParams.runningTests},a.prototype.fruitSnack=function(){return b[this.env]},a.prototype.getCoverOptions=function(a,b){return null==b&&(b=!1),b?this.hardCoverOptions.concat(this.softCoverOptions):a?this.softCoverOptions:this.hardCoverOptions},a}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("CONFIG",["modelInitializer","$routeParams","_CONFIG_JSON","$window",a])}.call(this),function(){"use strict";var a;a=function(){return{restrict:"E",compile:function(a,b){var c,d;return d=null!=a.attr("sf-type")?"btn-"+a.attr("sf-type"):"btn-secondary",c="<button type='button' class='btn "+d+"'>\n  "+a.text()+"\n</button>",a.replaceWith(c)}}},angular.module("galleon").directive("sfButton",a)}.call(this),function(){"use strict";var a,b,c;c=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},b=function(a,b,d){var e;return e=a,c(e)?(e=parseInt(e,10),null!==d&&parseInt(d)<e&&(e=parseInt(d,10))):""!==e&&(e=b||""),e},a=function(){return{restrict:"E",require:"^?ngModel",scope:{minVal:"@",maxVal:"@"},link:function(a,d,e,f){var g;if("sf-number"===e.type)return g=a.maxVal&&c(a.maxVal)?a.maxVal:null,a.$watch("maxVal",function(a){return g=a&&c(a)?a:null,d.triggerHandler("input")}),d.unbind("input"),d.bind("input",function(){var c;return c=b(this.value,a.cachedVal||"",g),this.value=c,f.$setViewValue(c),a.$evalAsync(function(){return a.cachedVal=c})}),f.$parsers.unshift(function(c){return b(c,a.cachedVal||"",g)})}}},angular.module("galleon").directive("input",a)}.call(this),function(){"use strict";var a;a=function(a,b,c){var d,e;return e=function(a,c,d,e){var f,g,h,i;switch(f=b.height(),i=b.width(),h=angular.element(document.body).scrollTop(),g=angular.element(document.body).scrollLeft(),c){case"right":return a.left+d-g>i;case"bottom":return a.top+e-h>f;case"left":return a.left<0;default:return a.top<0}},d=function(c,d,f,g,h,i,j){var k,l,m,n,o;switch(k={top:0,left:0},l=a.offset(c),n=a.offset(d),m=parseInt(j||n.height,10),o=parseInt(i||n.width,10),f){case"right":k={top:l.top+l.height/2-m/2+g,left:l.left+l.width+h},e(k,f,o,m)&&(k.left=l.left-o-h);break;case"bottom":k={top:l.top+l.height+g,left:l.left+l.width/2-o/2+h},e(k,f,o,m)&&(k.top=l.top-m-g);break;case"left":k={top:l.top+l.height/2-m/2+g,left:l.left-o-h},e(k,f,o,m)&&(k.left=l.left+l.width+h);break;default:k={top:l.top-m-g,left:l.left+l.width/2-o/2+h},e(k,f,o,m)&&(k.top=l.top+l.height+g)}return k.top<0&&(k.top=10),k.top+m-g>b.height()&&(k.top=b.height()-m-30),k},{restrict:"E",transclude:!0,template:"<div ng-transclude style='display:inline-block;'></div>",scope:{target:"@",placement:"@",vSpacing:"@",hSpacing:"@",width:"@",height:"@",zIndex:"@",class:"@",delay:"@",redraw:"="},link:function(a,b,e){return angular.element(document.body).append(b),a.$watchCollection("[target,redraw]",function(e){var f,g,h,i;if(h=angular.element(a.target||null),i=angular.element(b.find("div")[0]),i.addClass(a.class),h)try{return g=d(h,i,a.placement||"top",parseInt(a.vSpacing,10),parseInt(a.hSpacing,10),a.width,a.height),i.css({position:"absolute",top:g.top,left:g.left,"z-index":a.zIndex}),a.delay&&parseInt(a.delay,10)>0&&(i.css({display:"none"}),c(function(){return i.css({display:"block"})},a.delay,!1)),a.apply()}catch(a){f=a}})}}},a.$inject=["$position","$document","$timeout"],angular.module("galleon").directive("positionable",a)}.call(this),function(){"use strict";var a;a=function(a,b){return{restrict:"E",template:"",scope:{onDimensionsChanged:"&"},link:function(c,d,e){var f,g,h,i;if(null!=(null!=e?e.source:void 0))return f=a.document.getElementById(e.source),i=0,g=0,h=function(){return i=f.offsetWidth,g=f.offsetHeight,null!=c?c.onDimensionsChanged({width:i,height:g}):void 0},h(),angular.element(a).bind("resize",function(){return h()}),b.subscribe(b.events.SURFACE_LAYOUT_UPDATED,h,c),c.$watch(function(){return[i,g]},function(a){return null!=c?c.onDimensionsChanged({width:a[0],height:a[1]}):void 0},!0),a.setInterval(function(){var a,b;if(b=i,a=g,i=f.offsetWidth,g=f.offsetHeight,b!==i||a!==g)return null!=c?c.onDimensionsChanged({width:i,height:g}):void 0},1e3/15)}}},a.$inject=["$window","eventBus"],angular.module("galleon").directive("sfDimensionWatcher",a)}.call(this),function(){"use strict";var a;a=function(a){return{link:function(b,c,d){return a(function(){return c.focus()},200,!1),d.$observe("sfRefocus",function(a){if(a)return c.focus()})}}},a.$inject=["$timeout"],angular.module("galleon").directive("sfFocus",a)}.call(this),function(){"use strict";var a,b;b="#quickViewWindow_underlay.dijitDialogUnderlay{\n  opacity: 0;\n}\n\n#totallyNonConflictingWrapper .pageTitleContainer {\n  display: none;\n  height: 0;\n}\n\n#totallyNonConflictingWrapper .thumbSortBar {\n  display: none;\n  height: 0;\n}\n\n#totallyNonConflictingWrapper #leftContent {\n  display: none;\n  height: 0;\n}\n\n#totallyNonConflictingWrapper #navBarShowItems {\n  display: none;\n  height: 0;\n}\n\n#totallyNonConflictingWrapper #docWide {\n  position: relative;\n  left: 0;\n  right: 0;\n  padding-top: 0px;\n  width: auto;\n}\n\n#totallyNonConflictingWrapper #rightContent {\n  float: left;\n  position: absolute;\n  left: 0px;\n  right: 0;\n  width: auto;\n}\n\n#totallyNonConflictingWrapper .thumbSortBar {\n  width: auto;\n}\n\n#totallyNonConflictingWrapper div.style-entry {\n  height: 184px;\n  margin-bottom: 0;\n  margin-right: 10px;\n}\n\n#totallyNonConflictingWrapper div.style-entry.thumb-right-spacing {\n  margin-right: 10px;\n}\n\n#totallyNonConflictingWrapper div.style-container.thumb-highlight .thumb-title {\n  color: #f05323;\n}\n#totallyNonConflictingWrapper div.style-entry.premium-style:hover {\n  margin-bottom: 0;\n}",a=function(a){return{link:function(c,d){return a.link(c,d,b)}}},a.$inject=["frameLoadedInjector"],angular.module("galleon").directive("frameloaded",a)}.call(this),function(){"use strict";var a,b;b="#quickViewWindow_underlay.dijitDialogUnderlay{\n  opacity: 0;\n}\n\n#totallyNonConflictingWrapper .pageTitleContainer {\n  display: none;\n  height: 0;\n}\n\n#totallyNonConflictingWrapper .thumbSortBar {\n  display: none;\n  height: 0;\n}\n\n#totallyNonConflictingWrapper #leftContent {\n  display: none;\n  height: 0;\n}\n\n#totallyNonConflictingWrapper #listContainer {\n  white-space: nowrap;\n  padding-top: 12px;\n}\n\n#totallyNonConflictingWrapper #navBarShowItems {\n  display: none;\n  height: 0;\n}\n\n#totallyNonConflictingWrapper #docWide {\n  position: relative;\n  left: 0;\n  right: 0;\n  padding-top: 0px;\n  width: auto;\n  margin-top: -5px;\n}\n\n#totallyNonConflictingWrapper #rightContent {\n  float: left;\n  position: absolute;\n  left: 0px;\n  right: 0;\n  width: auto;\n}\n\n#totallyNonConflictingWrapper .thumbSortBar {\n  width: auto;\n}\n\n#totallyNonConflictingWrapper div.style-entry {\n  height: 90px;\n  margin-bottom: 0;\n  margin-right: 20px;\n  display: inline-block;\n  float: none;\n  width: 160px;\n}\n\n#totallyNonConflictingWrapper div.style-entry.premium-style:hover div.style-pricing {\n  display: none;\n}\n\n#totallyNonConflictingWrapper .thumb-title {\n  display: none;\n}\n\n#totallyNonConflictingWrapper .book-shadow {\n  height: 80px;\n  width: 170px;\n}\n\n#totallyNonConflictingWrapper .verticalSplit {\n  height: 80px;\n  width: 80px;\n}\n\n#totallyNonConflictingWrapper .thumb-images {\n  height: 80px;\n}\n\n#totallyNonConflictingWrapper img.left-thumb {\n  height: 80px;\n  width: 80px;\n}\n\n#totallyNonConflictingWrapper img.right-thumb {\n  height: 80px;\n  width: 80px;\n}\n\n#totallyNonConflictingWrapper div.style-entry.thumb-right-spacing {\n  margin-right: 10px;\n}\n\n#totallyNonConflictingWrapper div.style-container.thumb-highlight .thumb-title {\n  color: #f05323;\n}\n#totallyNonConflictingWrapper div.style-entry.premium-style:hover {\n  margin-bottom: 0;\n}",a=function(a){return{link:function(c,d){return a.link(c,d,b)}}},a.$inject=["frameLoadedInjector"],angular.module("galleon").directive("frameloadedsimple",a)}.call(this),function(){"use strict";var a,b;b="#quickViewWindow_underlay.dijitDialogUnderlay{\n  opacity: 0;\n}\n\n#totallyNonConflictingWrapper .pageTitleContainer {\n  display: none;\n  height: 0;\n}\n\n#totallyNonConflictingWrapper #docWide {\n  position: relative;\n  left: 0;\n  right: 0;\n  padding-top: 0px;\n  width: auto;\n}\n\n#totallyNonConflictingWrapper #quickViewWindow {\n  box-shadow: none;\n}\n\n#totallyNonConflictingWrapper #rightContent {\n  float: left;\n  position: absolute;\n  left: 180px;\n  right: 0;\n  width: 810px;\n  margin-left: 0px;\n}\n\n#totallyNonConflictingWrapper .thumbSortBar {\n  width: auto;\n}\n\n#totallyNonConflictingWrapper div.style-entry {\n  height: 184px;\n  margin-bottom: 0;\n  margin-right: 10px;\n}\n\n#totallyNonConflictingWrapper div.style-entry.thumb-right-spacing {\n  margin-right: 10px;\n}\n\n#totallyNonConflictingWrapper div.style-container.thumb-highlight .thumb-title {\n  color: #f05323;\n}\n#totallyNonConflictingWrapper div.style-entry.premium-style:hover {\n  margin-bottom: 0;\n}",a=function(a){return{link:function(c,d){return a.link(c,d,b)}}},a.$inject=["frameLoadedInjector"],angular.module("galleon").directive("frameloadedall",a)}.call(this),function(){"use strict";var a;a=function(){return{require:"ngModel",link:function(a,b,c,d){var e,f;return e=parseInt(c.ngMinlength||"1",10),f=angular.element(c.mustMatch),b.add(f).on("keyup",function(){return a.$apply(function(){return f.val().length>=e&&b.val().length>=e?d.$setValidity("mustMatch",b.val()===f.val()):d.$setValidity("mustMatch",!0)})})}}},a.$inject=[],angular.module("galleon").directive("mustMatch",a)}.call(this),function(){"use strict";var a;a=function(){return{link:function(a,b,c){$(b).draggable({handle:".modal-header",cursor:"move",containment:"document",cancel:"div.exclude-from-drag"})}}},a.$inject=[],angular.module("galleon").directive("movemodal",a)}.call(this),function(){"use strict";var a;a=function(){return{link:function(a,b,c){$(b).resizable({handles:"se",minHeight:350,minWidth:350,maxHeight:1e3,maxWidth:1280})}}},a.$inject=[],angular.module("galleon").directive("resizemodal",a)}.call(this),function(){"use strict";var a;a=function(){var a,b,c;return b=",",a=/^[-0-9a-z.+_]+@[-0-9a-z.+_]+\.[a-z]{2,}$/i,c=function(c,d,e,f){var g;if(null==f&&(f=!1),g=f?c.$isEmpty(e)||e.split(b).every(function(b){return a.test(b.trim())}):c.$isEmpty(e)||a.test(e.trim()),c.$setValidity(d,g),g)return e},{restrict:"A",require:"?ngModel",link:function(a,b,d,e){var f,g;return f=d.multiEmailMode,g=function(a){return c(e,"sfMultipleEmails",a,f)},e.$formatters.push(g),e.$parsers.push(g)}}},a.$inject=[],angular.module("galleon").directive("sfEmailValidator",a)}.call(this),function(){"use strict";var a,b,c,d=function(a,b){return function(){return a.apply(b,arguments)}};a=30,b=function(){function b(a,b){this.appState=a,this.$document=b,this._handleDragMove=d(this._handleDragMove,this),this._handleDragEnter=d(this._handleDragEnter,this),this._handleDragEnd=d(this._handleDragEnd,this),this.dragEnterTime=void 0}return b.prototype.link=function(a,b,c){var d,e;return this.scope=a,this.element=b,this.attrs=c,this.scope.directive=this,this.nativeElement=this.element[0],e=this.element.css("overflowY"),this.doesScrollVert=e.indexOf("auto")!==-1||e.indexOf("scroll")!==-1,d=this.element.css("overflowX"),this.doesScrollHorz=d.indexOf("auto")!==-1||d.indexOf("scroll")!==-1,this.nativeElement.addEventListener("dragenter",this._handleDragEnter),this.nativeElement.addEventListener("dragover",this._handleDragMove),this.$document[0].body.addEventListener("dragend",this._handleDragEnd),this.scope.$on("$destroy",function(a){return function(){return a.nativeElement.removeEventListener("dragenter",a._handleDragEnter),a.nativeElement.removeEventListener("dragover",a._handleDragMove),a.$document[0].body.removeEventListener("dragend",a._handleDragEnd)}}(this))},b.prototype._handleDragEnd=function(a){return this.dragEnterTime=void 0},b.prototype._handleDragEnter=function(a){return null==this.dragEnterTime&&(this.dragEnterTime=(new Date).getTime()),this.boundingRect=this.nativeElement.getBoundingClientRect()},b.prototype._handleDragMove=function(a){if(null!=this.boundingRect&&(new Date).getTime()-500>this.dragEnterTime)return this.doesScrollHorz&&this._checkScroll(a,"left","right"),this.doesScrollVert?this._checkScroll(a,"top","bottom"):void 0},b.prototype._checkScroll=function(a,b,c){return this._shouldScrollBackward(a,b)?(this.appState.hideTooltips(),void this["_scroll"+b](a)):this._shouldScrollForward(a,c)?(this.appState.hideTooltips(),this["_scroll"+c](a)):void 0},b.prototype._shouldScrollBackward=function(b,c){var d;return d="left"===c?b.clientX:b.clientY,d>this.boundingRect[c]&&d<=this.boundingRect[c]+a},b.prototype._shouldScrollForward=function(b,c){var d;return d="right"===c?b.clientX:b.clientY,d<this.boundingRect[c]&&d>=this.boundingRect[c]-a},b.prototype._scrollleft=function(a){if(this.nativeElement.scrollLeft>0)return this.nativeElement.scrollLeft-=this._scrollIncrementAmount(this.boundingRect.left-a.clientX)},b.prototype._scrollright=function(a){if(this.nativeElement.clientWidth<this.nativeElement.scrollWidth-this.nativeElement.scrollLeft)return this.nativeElement.scrollLeft+=this._scrollIncrementAmount(this.boundingRect.right-a.clientX)},b.prototype._scrolltop=function(a){if(this.nativeElement.scrollTop>0)return this.nativeElement.scrollTop-=this._scrollIncrementAmount(this.boundingRect.top-a.clientY)},b.prototype._scrollbottom=function(a){if(this.nativeElement.clientHeight<this.nativeElement.scrollHeight-this.nativeElement.scrollTop)return this.nativeElement.scrollTop+=this._scrollIncrementAmount(this.boundingRect.bottom-a.clientY)},b.prototype._scrollIncrementAmount=function(b){return 2*Math.round(a/Math.abs(b))},b}(),c=function(a,c){return{link:function(d,e,f){return new b(a,c).link(d,e,f)}}},c.$inject=["appState","$document"],angular.module("galleon").directive("sfDragScroll",c)}.call(this),function(){"use strict";var a,b,c,d,e=function(a,b){return function(){return a.apply(b,arguments)}};b="vertical",a="horizontal",c=function(){function c(b,c){this.$timeout=b,this.$parse=c,this.adjustScrolling=e(this.adjustScrolling,this),this.isActive=!0,this.scrollTo=0,this.scrollDirection=a,this.targetElementsClassifier=""}return c.prototype.adjustScrolling=function(){var c,d;switch(this.scrollToElementsClassifier=this.scope.scrollToElement,d=$(this.scrollToElementsClassifier).position(),this.scrollDirection){case b:return c=d?d.top+$(this.targetElementsClassifier).scrollTop()+this.scrollTo:this.scrollTo,$(this.targetElementsClassifier).animate({scrollTop:c});case a:return c=d?d.left+$(this.targetElementsClassifier).scrollLeft()+this.scrollTo:this.scrollTo,$(this.targetElementsClassifier).animate({scrollLeft:c})}},c.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.scope.directive=this,this.scrollTo=parseInt(this.$parse(this.attrs.scrollTo)(),10),this.scrollDirection=this.$parse(this.attrs.scrollDirection)(),this.targetElementsClassifier=this.$parse(this.attrs.targetElementsClassifier)(),setTimeout(function(a){return function(){return a.adjustScrolling()}}(this),500),this.scope.$watch("scrollWhen",function(a){return function(){if(a.isActive)return a.$timeout(a.adjustScrolling,0,!1)}}(this)),this.scope.$watch("enableWhen",function(a){return function(b){return a.isActive=!!b}}(this))},c}(),d=function(a,b){return{scope:{enableWhen:"=",scrollWhen:"=",scrollToElement:"="},link:function(d,e,f){return new c(a,b).link(d,e,f)}}},d.$inject=["$timeout","$parse"],angular.module("galleon").directive("sfForceScroll",d)}.call(this),function(){var a;a=function(){return{restrict:"E",replace:!0,scope:{},templateUrl:"Common/views/rotation-blocker.html"}},angular.module("galleon").directive("sfRotationBlocker",a)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b){var d;this.$timeout=a,this.tooltipModel=b,this._updateTooltipValues=c(this._updateTooltipValues,this),d={text:"tooltip",placement:"bottom",top:0,left:0,show:!1},this.tooltipModel.init(d),this.tooltipModel.registerValueChangeEvent(this._updateTooltipValues),this.tooltipShowing=!1,this.timeoutPromise=void 0}return a.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.scope.directive=this,this.tooltipEl=this.element.children(),this.element.on("mouseover",function(a){return function(){return a.tooltipModel.hideTooltip()}}(this))},a.prototype._updateTooltipValues=function(){return this.tooltipShowing!==!0||this.tooltipModel.show?(this.tooltipEl.css({position:"absolute",top:this.tooltipModel.top,left:this.tooltipModel.left}),this.scope.tooltip=this.tooltipModel.text,this.scope.placement=this.tooltipModel.placement,this.tooltipModel.show?(null!=this.timeoutPromise&&this.$timeout.cancel(this.timeoutPromise),this.timeoutPromise=this.$timeout(function(a){return function(){return a.tooltipShowing=!0,a.tooltipEl.trigger("manualShow")}}(this),0)):void 0):(null!=this.timeoutPromise&&this.$timeout.cancel(this.timeoutPromise),void(this.timeoutPromise=this.$timeout(function(a){return function(){return a.tooltipShowing=!1,a.tooltipEl.trigger("manualHide"),a._updateTooltipValues()}}(this),0)))},a}(),b=function(b,c){return{restrict:"E",template:'<div id="customTooltip" tooltip="{{tooltip}}" tooltip-trigger="manualShow" tooltip-placement="{{placement}}" tooltip-popup-delay="0"> </div>',transclude:!0,link:function(d,e,f){var g;return g=new a(b,c).link(d,e,f)}}},b.$inject=["$timeout","tooltipModel"],angular.module("galleon").directive("sfTooltip",b)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a){this.touchService=a,this.enableTouchSupport=c(this.enableTouchSupport,this)}return a.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.scope.directive=this,this.element[0].addEventListener("touchstart",this.enableTouchSupport)},a.prototype.enableTouchSupport=function(){return this.element[0].removeEventListener("touchstart",this.enableTouchSupport),this.touchService.hasTouch=!0,this.element.addClass("has-touch")},a}(),b=function(b){return{restrict:"A",link:function(c,d,e){return new a(b).link(c,d,e)}}},b.$inject=["touchService"],angular.module("galleon").directive("sfTouchDetect",b)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b){this.$window=a,this.$timeout=b,this._init=c(this._init,this)}return a.prototype._DOTS="...",a.prototype.link=function(a,b,c){if(this._scope=a,this._attrs=c,this._scope.directive=this,this._el=b[0],this._text=this._scope.text,this._maxLines=parseInt(this._scope.maxLines),this._linePixelHeight=parseInt(this._attrs.linePixelHeight),this._validateAttributes())return this.$timeout(this._init,!1)},a.prototype._validateAttributes=function(){if((null==this._maxLines||isNaN(this._maxLines))&&(this._maxLines=1),null==this._linePixelHeight||isNaN(this._linePixelHeight))throw new Error("Undefined 'line-pixel-height' in TruncateText directive");return!0},a.prototype._init=function(){return this._el.style.lineHeight=""+this._linePixelHeight+"px",this._removeTooltip(),this._appendText()},a.prototype._appendText=function(){var a,b,c,d;for(d=this._text,b=0,c=d.length;b<c;b++)if(a=d[b],this._el.textContent+=a,this._getTotalLines()>this._maxLines){this._trimEnd(),this._addTooltip();break}},a.prototype._trimEnd=function(){var a,b,c;for(b=new String(this._el.textContent),c=b.length-1;c>=0&&(a=b[c],b=b.substring(0,b.length-1),this._el.textContent=b+this._DOTS,!(this._getTotalLines()<=this._maxLines));c+=-1);},a.prototype._addTooltip=function(){return this._el.setAttribute("title",this._text)},a.prototype._removeTooltip=function(){return this._el.setAttribute("title","")},a.prototype._getTotalLines=function(){return Math.ceil(this._getHeight()/this._getLineHeight())},a.prototype._getHeight=function(){return parseInt(this.$window.getComputedStyle(this._el,null).getPropertyValue("height"))},a.prototype._getLineHeight=function(){return this._linePixelHeight},a}(),b=function(b,c){return{restrict:"A",scope:{text:"=",maxLines:"="},link:function(d,e,f){return new a(b,c).link(d,e,f)}}},b.$inject=["$window","$timeout"],angular.module("galleon").directive("sfTruncate",b)}.call(this),function(){"use strict";var a;a=function(a){return{restrict:"A",scope:{sfLongPress:"&",sfTap:"&"},link:function(b,c,d){var e,f,g,h,i,j;return j=!1,e=!1,f=c[0],g=function(){if(e!==!0)return"function"==typeof b.sfTap?b.sfTap():void 0},i=function(c){return j=!0,e=!1,a(function(){if(j===!0)return b.$apply(function(){if(null!=b.sfLongPress)return e=!0,b.sfLongPress()})},parseInt(d.duration)||500)},h=function(a){return j=!1,g()},f.addEventListener("touchstart",i),f.addEventListener("touchend",h),f.addEventListener("mouseup",g),b.$on("$destroy",function(){return f.removeEventListener("touchstart",i),f.removeEventListener("touchend",h),f.removeEventListener("mouseup",g)})}}},a.$inject=["$timeout"],angular.module("galleon").directive("sfLongPress",a)}.call(this),function(){"use strict";var a;a=function(){return{require:"ngInclude",restrict:"A",link:function(a,b,c){b.replaceWith(b.children())}}},angular.module("galleon").directive("includeReplace",a)}.call(this),function(){var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b){this.$window=a,this.eventBus=b,this.receiveMessage=c(this.receiveMessage,this)}var b;return b=["returnCode","uid","email","oauthToken","oflyToken","oauthV2AccessToken"],a.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.scope.directive=this,this.$window.addEventListener("message",this.receiveMessage,!1),this.scope.$on("$destroy",function(a){return function(){return a.$window.removeEventListener("message",a.receiveMessage)}}(this))},a.prototype.isValidOrigin=function(a){return/shutterfly/.test(a)},a.prototype.receiveMessage=function(a){if(this.isValidOrigin(a.origin))switch(this._isNonVisualSigninResponse(a.data)&&this.eventBus.publish(this.eventBus.events.NONVISUAL_USER_SIGNIN,JSON.parse(a.data)),a.data){case"GALLEON_ORDER":return this.eventBus.publish(this.eventBus.events.PROJECT_ORDER,{enableUpsell:!1})}},a.prototype._isNonVisualSigninResponse=function(a){var c,d,e;for(d=0,e=b.length;d<e;d++)if(c=b[d],"string"==typeof a&&a.indexOf(c)===-1)return!1;return!0},a}(),b=function(b,c){return this.$window=b,this.eventBus=c,{restrict:"A",link:function(b,c,d){return new a(this.$window,this.eventBus).link(b,c,d)}}},b.$inject=["$window","eventBus"],angular.module("galleon").directive("sfMessageEvents",b)}.call(this),function(){"use strict";var a;a=function(a){return function(b,c,d){var e,f,g,h,i;if(angular.isArray(b))for(g={},f=h=0,i=b.length;h<i;f=++h)e=b[f],g["value"+f]=e;else g={value:b};return a(c,g,d)}},a.$inject=["$translate"],angular.module("galleon").filter("postfixTranslate",a)}.call(this),function(){"use strict";var a;a=function(){return function(a){return"string"!=typeof a?null:(a=a.toLowerCase(),a.substring(0,1).toUpperCase()+a.substring(1))}},angular.module("galleon").filter("capitalize",a)}.call(this),function(){"use strict";var a,b,c;c={0:"Calendar.cover.label",1:"Calendar.cover.jan",2:"Calendar.cover.feb",3:"Calendar.cover.mar",4:"Calendar.cover.apr",5:"Calendar.cover.may",6:"Calendar.cover.jun",7:"Calendar.cover.jul",8:"Calendar.cover.aug",9:"Calendar.cover.sep",10:"Calendar.cover.oct",11:"Calendar.cover.nov",12:"Calendar.cover.dec"},b=function(){return function(a){var b;return b=/\d{4}/.exec(a),(null!=b?b.length:void 0)>0&&"0"!==a.substring(5)?b[0]:void 0}},angular.module("galleon-gc").filter("calendarizeYear",b),a=function(){return function(a){var b;return b=/\d{4}-([0-9]+)/.exec(a),(null!=b?b.length:void 0)>1?c[b[1]]:void 0}},angular.module("galleon-gc").filter("calendarizeMonth",a)}.call(this),function(){"use strict";var a;a=function(){return function(a,b,c){var d,e;return null==c&&(c=!0),c?(e=a.filter(function(a){return a[b]}),d=a.filter(function(a){return!a[b]}),e.concat(d)):a}},angular.module("galleon").filter("moveEmptyFieldToEnd",a)}.call(this),function(){"use strict";var a,b;a=function(){function a(a,b,c){var d,e,f,g,h,i,j;for(null==c&&(c=!1),f={},i=b.url,g=0,h=i.length;g<h;g++)e=i[g],f[e.repType]=e.value;switch(this.mobileUrl=f.mobile,this.thumbUrl=f.thumb,this.previewUrl=f.preview,this.swfUrl=f.swf,this.assetId=b.assetId,this.version=b.version,this.assetType=a,this.isExtPalItem=c,a){case"background":d=b.backgroundAttributes,this.previewWidth=(null!=d?d.PreviewWidth:void 0)||(null!=d?d.previewWidth:void 0),this.previewHeight=(null!=d?d.PreviewHeight:void 0)||(null!=d?d.previewHeight:void 0),this.isFlippable=!1,this.selectionType=null;break;case"embellishment":case"patternband":d=b.embellishmentAttributes,this.previewWidth=d.PreviewWidth||d.previewWidth,this.previewHeight=d.PreviewHeight||d.previewHeight,this.width=d.Width||d.width,this.height=d.Height||d.height,this.isFlippable=null!=(j=d.IsFlippable)?j:d.flippable,this.selectionType=d.SelectionType||d.selectionType}}return a.prototype.isSpread=function(){return"background"===this.assetType&&parseFloat(this.previewWidth)/parseFloat(this.previewHeight)>1.5},a.prototype.createEmbellishmentModelAsset=function(a,b){var c,d,e;return null==b&&(b={xPercent:.5,yPercent:.5}),d=a.layout.width*b.xPercent-this.width/2,e=a.layout.height*b.yPercent-this.height/2,c={assetType:"graphic",container:{xOffset:d,yOffset:e,width:this.width,height:this.height,rotation:0,verticalScale:"100",rotationLimit:"",type:"rectangle",id:this.assetId,nextId:null,borderStroke:"0",borderColor:"",borderColorRGB:null,objectStyle:"frame_none",frameOwnedByUser:null,displayAsObject:null,visible:"true",locked:"false",previousId:null,overflow:null,paraStyle:null},layer:"live",ownedByUser:"false",scriptLabel:""+("hollow"===this.selectionType?"isHollow=true|":"")+("version=1|contentType=Embellishment|id="+this.assetId),type:"Embellishment",imageRectangle:{xOffset:d,yOffset:e,width:this.width,height:this.height,rotation:"0",verticalScale:"100",rotationLimit:""},assetReference:{assetId:this.assetId,version:this.version,sourceUrl:this.swfUrl,assetType:"Embellishment",isFlippable:""+this.isFlippable,selectionType:this.selectionType},assetSource:null,imageAssignment:null}},a}(),b=function(){function b(){}return b.prototype.newInstance=function(b,c,d){return null==d&&(d=!1),new a(b,c,d)},b}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("contentGraphicAssetFactory",[b])}.call(this),function(){"use strict";var a,b;a=function(){function a(){}var b;return b="layout",a.prototype.init=function(c){var d,e,f,g,h,i;for(e={},h=c.url,f=0,g=h.length;f<g;f++)d=h[f],e[d.repType]=d.value;return this.mobileUrl=e.mobile,this.thumbUrl=e.thumb,this.previewUrl=e.preview,this.swfUrl=e.swf,this.jsonUrl=e.json,this.assetId=c.assetId,this.version=c.version,this.assetType=b,this.layoutJson=c.layout_JSON,this.layoutAttributes=a._normalizeAttributeNames(c.layoutAttributes),null!=this.layoutAttributes&&(this.pageType=null!=(i=this.layoutAttributes.pageType)?i.toLowerCase():void 0,this.previewWidth=this.layoutAttributes.previewWidth,this.previewHeight=this.layoutAttributes.previewHeight),this},a.prototype.isSpread=function(){return"spread"===this.pageType||this.isIdeaSpread()},a.prototype.isIdeaSpread=function(){return"ideaspread"===this.pageType},a.prototype.isIdeaLayout=function(){var a;return"ideapage"===(null!=(a=this.layoutAttributes)?a.layoutType:void 0)},a._normalizeAttributeNames=function(a){var b,c,d;if(null!=a){for(b in a)d=a[b],c=this._toCamelCase(b),delete a[b],a[c]=d;return a}},a._toCamelCase=function(a){return a.slice(0,1).toLowerCase()+a.slice(1)},a}(),b=function(){function b(){}return b.prototype.newInstance=function(b){return(new a).init(b)},b}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("contentLayoutFactory",[b])}.call(this),function(){var a;a=function(){function a(a){this.ModelInitializer=a,this.values={}}return a.prototype.init=function(a){return this.values=a,this.ModelInitializer.initialize(this,this.values,[]),this},a.prototype.registerValueChangeEvent=function(a){this.callback=a},a.prototype._onValueChanged=function(){return"function"==typeof this.callback?this.callback():void 0},a._sfsetter("text",function(a){return this.values.text!==a&&(this.values.show=!1),this.values.text=a,this._onValueChanged()}),a._sfgetter("text",function(){return this.values.text}),a._sfsetter("top",function(a){return this.values.top=a,this._onValueChanged()}),a._sfgetter("top",function(){return this.values.top}),a._sfsetter("left",function(a){return this.values.left=a,this._onValueChanged()}),a._sfgetter("left",function(){return this.values.left}),a._sfsetter("placement",function(a){return this.values.placement=a,this._onValueChanged()}),a._sfgetter("placement",function(){return this.values.placement}),a._sfgetter("show",function(){return this.values.show}),a.prototype.showTooltip=function(){return this.values.show=!0,this._onValueChanged()},a.prototype.hideTooltip=function(){return this.values.show=!1,this._onValueChanged()},a.prototype.updateValues=function(a){return null!=a.text&&(this.values.text=a.text),null!=a.top&&(this.values.top=a.top),null!=a.left&&(this.values.left=a.left),this._onValueChanged()},a}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("tooltipModel",["modelInitializer",a])}.call(this),function(){"use strict";var a;a=function(a){return a.autofill},a.$inject=["$window"],angular.module("galleon").service("autofill",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.eventBus=a,this.$timeout=b,this.productSpecificFrameLoadedInjector=c,this.contentService=d}return a.prototype.link=function(a,b,c){var d;return b.css("display","none"),a.$on("$destroy",function(){return b.off()}),d=this.$timeout(function(a){return function(){return a._injectIntoIFrame(b,c)}}(this),3e3),b.on("load",function(a){return function(){return a.$timeout.cancel(d),a._injectIntoIFrame(b,c)}}(this))},a.prototype._injectIntoIFrame=function(a,b){var c,d,e,f;try{e=$('<style type="text/css" rel="stylesheet">'+b+"</style>"),d=a[0],d.contentDocument.head.appendChild(e[0]),this.productSpecificFrameLoadedInjector.connectCallback(d,null!=(f=this.contentService.currentStyle)?f.styleId:void 0),a.css("display","block")}catch(a){c=a,console.log("error happened",c)}return this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_HIDE)},a}(),a.$inject="eventBus $timeout productSpecificFrameLoadedInjector contentService".split(" "),angular.module("galleon").service("frameLoadedInjector",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i){var j;this.autofill=a,this.config=c,this.$q=d,this.eventBus=e,this.$http=f,this.imageCollection=h,this.pageModelStrategy=i,this._fetchLayoutJson=b(this._fetchLayoutJson,this),this.applyLayout=b(this.applyLayout,this),this._showFailedToFindLayoutError=b(this._showFailedToFindLayoutError,this),this.logger=g.newInstance("AdaptiveLayoutService"),this.LAYOUT_TYPE_IDEA="ideapage",j={concurrency:{contentRequests:this.config.defaults.docsmithConcurrentContentRequests},endpoints:{styleService:this.config.styleServiceBase,web2PrintHost:this.config.web2PrintHost
}},this.adaptiveLib=new a.AdaptiveLayout(j)}return a.prototype.addGridCellEventBackground=function(a,b,c,d){var e;return e=this.adaptiveLib.addGridCellEventBackground(a,b,c,d),null!=e.warning&&this.logger.warn("addGridCellEventBackground: "+e.warning.toString()),e},a.prototype.removeGridCellEventBackground=function(a,b,c,d){var e;return e=this.adaptiveLib.removeGridCellEventBackground(a,c,d),null!=e.warning&&this.logger.warn("removeGridCellEventBackground: "+e.warning.toString()),e},a.prototype.joinLayouts=function(a,b){var c;if(null!=a&&null!=b)return c=this.$q.defer(),this.adaptiveLib.joinLayouts(a,b).then(function(a){return function(b){var d,e;return null==(null!=b&&null!=(e=b.content)?e.type:void 0)?(d="Malformed layout from autofill.AdaptiveLayout",a.logger.error(d),void c.reject(d)):c.resolve(b)}}(this)),c.promise},a.prototype.splitSpread=function(a,b,c,d){if(null!=a&&null!=b&&null!=c)return null!=d.leftLayout||null!=d.rightLayout?this._splitSpreadWithLayout(a,b,c,d):d.isCustomizing?this._splitSpreadToCustom(a):this._splitSpreadToLayouts(a,b,c)},a.prototype._splitSpreadWithLayout=function(a,b,c,d){var e,f,g;return f=this.$q.defer(),e=d.leftLayout||d.rightLayout,g={id:e.assetId,version:e.version,layoutType:e.pageType},this._fetchLayoutJson(e).then(function(e){return function(h){var i,j;return g.layoutJson=h,i={},d.leftLayout?i.leftLayout=g:i.rightLayout=g,j=e.adaptiveLib.splitSpreadWithLayout(a,b,c,i).then(function(a,b){return null==(null!=a?a.leftLayout:void 0)&&null==(null!=a?a.rightLayout:void 0)?void f.reject("Malformed layout from autofill.AdaptiveLayout"):f.resolve(a)})}}(this)),f.promise},a.prototype._splitSpreadToCustom=function(a){var b;return b=this.$q.defer(),this.adaptiveLib.splitSpreadToCustom(a).then(function(a,c){return b.resolve(a)}),b.promise},a.prototype._splitSpreadToLayouts=function(a,b,c){var d;return d=this.$q.defer(),this.adaptiveLib.splitSpreadToLayouts(a,b,c).then(function(a,b){return d.resolve(a)}),d.promise},a.prototype.getAdaptiveLayoutRetainingImages=function(a,b,c){return this._getAdaptiveLayout(a,b,null,c,!0)},a.prototype.getAdaptiveLayoutLeavingSingleEmptyWell=function(a,b,c){return this.getAdaptiveLayout(a,b,null,c,!0,!0)},a.prototype.getAdaptiveLayout=function(a,b,c,d,e,f,g){var h;return null==c&&(c=null),h=null!=c?[c]:null,this._getAdaptiveLayout(a,b,h,d,!1,e,f,g)},a.prototype.getAdaptiveLayoutForBatchImages=function(a,b,c,d,e,f,g){return this._getAdaptiveLayout(a,b,c,d,!1,e,f,g)},a.prototype._ensureRankingAttr=function(a){var b,c,d,e,f;for(f=[],d=0,e=a.length;d<e;d++)b=a[d],b?(c=this.imageCollection.getImageByImageId(b.id),null!=(null!=c?c.ranking:void 0)?f.push(b.ranking=c.ranking):f.push(void 0)):f.push(void 0);return f},a.prototype._getAdaptiveLayout=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n;if(null==d&&(d={}),null==e&&(e=!1),null==f&&(f=!1),null==g&&(g=!1),null==h&&(h=!1),a.isIdeaPage)throw new Error("Tried to run getAdaptiveLayout on an idea page");if(i=this.$q.defer(),k=this.autofill.Layout.getImages(a.layout.values),this._ensureRankingAttr(k),null==c)g?e||this._keepOnlyOneEmptyImageInList(k):e||this._removeEmptyImageFromList(k);else for(m=0,n=c.length;m<n;m++)j=c[m],null!=j.Xheight?h?this._removeImageFromList(k,j):k.push(this._translateImage(j)):h?this._removeImageFromList(k,j):k.push(j);if(null==d.styleJson)throw new Error("Invocation of adaptLayout without options.styleJson");return null==d.useDefaultTextStyle&&(d.useDefaultTextStyle=!1),l=this.adaptiveLib.adaptLayout(k,{content:a.layout.values,pageType:a.getAdaptivePageType()},b,this._createConstraintSet(a,d),[],d,null!=d?d.projectType:void 0),l.then(function(a){return function(b,c){return null!=c||null==b.layouts[0]?(f||a._showFailedToFindLayoutError(k),i.reject("Problem adapting")):i.resolve(b.layouts[0])}}(this)),i.promise},a.prototype._keepOnlyOneEmptyImageInList=function(a){var b,c,d,e,f,g,h,i,j,k;for(e=[],b=!1,f=g=0,i=a.length;g<i;f=++g)c=a[f],null===c&&(b?e.push(f):b=!0);for(k=[],h=0,j=e.length;h<j;h++)c=e[h],d=a.indexOf(null),k.push(a.splice(d,1));return k},a.prototype._removeEmptyImageFromList=function(a){var b,c,d,e,f;for(d=!1,c=e=0,f=a.length;e<f;c=++e)if(b=a[c],null===b){d=!0,a.splice(c,1);break}if(d===!1)throw new Error("No empty image well found for adaptive remove image")},a.prototype._removeImageFromList=function(a,b){var c,d,e,f,g;if(b){for(g=[],d=e=0,f=a.length;e<f;d=++e){if(c=a[d],c&&c.id===b.id){a.splice(d,1);break}g.push(void 0)}return g}},a.prototype._translateImage=function(a){var b;return b={id:a.imageId,data:a.data,width:a.Xwidth+"",height:a.Xheight+"",description:a.description,filename:a.filename,ranking:a.ranking,rotation:a.rotation+"",fadeValue:a.fadeValue,effect:a.effect,title:a.title,redeye:a.redeye,captureTime:a.captureTime,uploadTime:a.uploadTime,projectImageId:a.productImageID+"",crop:{llx:a.cropllx,lly:a.croplly,urx:a.cropurx,ury:a.cropury}}},a.prototype._createConstraintSet=function(a,b){var c,d,e,f;return d=this.adaptiveLib.createConstraintSet(),c="equal_or_greater_match",(null!=b?b.exactConstraintMatch:void 0)===!0&&(e=(null!=a&&"function"==typeof a.getTextAreas&&null!=(f=a.getTextAreas())?f.length:void 0)>0?"match":"none",d.addConstraint(new this.autofill.TextAreaCountConstraint(e)),c="exact_match"),null!=(null!=b?b.styleSpecificLayoutCategory:void 0)&&d.addConstraint(new this.autofill.LayoutCategoryConstraint({category:b.styleSpecificLayoutCategory})),d.addConstraint(new this.autofill.ImageCountConstraint(c,"fallback_any_layout")),d},a.prototype._showFailedToFindLayoutError=function(a){var b;return b=a.indexOf(null)!==-1,b?this.eventBus.publish(this.eventBus.events.CANNOT_ADD_PHOTO_AREA,{}):this.eventBus.publish(this.eventBus.events.NOMORE_PHOTOS_CANBE_ADDED,{maxAllowedPhotos:a.length-1})},a.prototype.applyLayout=function(a,b,c,d){var e,f,g;if(b=Array.isArray(b)?b:[b],null!=b[0])return g=b.map(function(a){return a.values}),e=this.$q.defer(),f={id:a.assetId,version:a.version,type:b[0].getAdaptivePageType()},this._fetchLayoutJson(a).then(function(b){return function(h){var i;return a.layoutJson=h,i=b.adaptiveLib.applyLayout(h,g,c,f,{},d),i.then(function(c,d){var g;return null!=d||null==c.content?(g="Cannot apply layout "+f.id+" version: "+f.version,b.eventBus.publish(b.eventBus.events.CANNOT_APPLY_LAYOUT,{message:g}),e.reject("Problem applying layout")):(a.isIdeaLayout()&&(c.attributes.layoutType=b.LAYOUT_TYPE_IDEA),e.resolve(c))})}}(this)),e.promise},a.prototype._fetchLayoutJson=function(a){var b,c;return b=this.$q.defer(),a.layoutJson?b.resolve(a.layoutJson):(c=this.config.protocolRelativeUrl(a.jsonUrl),this.$http({method:"GET",url:c}).success(function(a,c,d,e){return b.resolve(a)}).error(function(c){return function(d,e,f,g){return c.logger.error("Could not fetch layout ",{assetId:a.assetId,version:a.version}),b.reject("Could not fetch layout "+e)}}(this))),b.promise},a.prototype.createProductSpec=function(a,b){return new this.autofill.AdaptiveProductSpec(a.styleId,a.styleContentVersion,a.sizeId,a.getLayoutFormFactorForPage(b))},a.prototype.flipLayout=function(a){var b;return b=this.$q.defer(),this.adaptiveLib.flipLayout(a).then(function(a,c){return null!=c?b.reject(c):b.resolve(a)}),b.promise},a.prototype.shuffleLayoutImages=function(a,b){var c,d,e;return e=function(){var a,d,e;for(e=[],a=0,d=b.length;a<d;a++)c=b[a],e.push(this._translateImage(c));return e}.call(this),d=this.adaptiveLib.shuffleLayoutImages(a.values,e),null!=d.warning&&this.logger.warn("Shuffle warning: "+d.warning.toString()),d},a.prototype.applyToOtherPages=function(a,b,c,d){var e;return e=this.$q.defer(),this.adaptiveLib.applyToOtherPages(a,b,c,d).then(function(a,b){return null!=b?e.reject(b):e.resolve(a),e.promise})},a.prototype.getRecalculatedGridPages=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n;return f=this.$q.defer(),n=this._gatherStartDateChangeData(a,b),i=n.monthsRequiringUpdate,h=n.indexOfNewStart,g=this._generateGridPageGroupSpecs(i,a),e=new this.autofill.ConstraintSet,m=this.autofill.Style.fromJSON(c)[0],k={fetchFullLayouts:!0,omitEmptyAssets:!1,preserveTextStyle:!0,style:m},j=this.adaptiveLib.contentClient,this.adaptiveLib.contentClient=d,l=function(a){return function(){return a.adaptiveLib.contentClient=j}}(this),this.adaptiveLib.getLayouts(g,this.createProductSpec(b.product),e,k,b.type).then(function(a,b){var c;return l(),null!=b?void f.reject(b):(c=a.layouts.map(function(a){return a.content}),f.resolve({layouts:c,monthsRequiringUpdate:i,indexOfNewStart:h}))}),f.promise},a.prototype._gatherStartDateChangeData=function(a,b){var c,d,e,f,g,h,i,j,k;for(f=[],d=0,k=b.product.pages,c=i=0,j=k.length;i<j;c=++i)g=k[c],null!=(h=this.pageModelStrategy.parseSurfaceKeyForPage(g))&&(e=b.product.isGridPage(g.surfaceNumber),a.month!==h.month||e||(d=c),e&&(h.year!==a.year||h.month<a.month)&&f.push({pageDate:h,page:g}));return{monthsRequiringUpdate:f,indexOfNewStart:d}},a.prototype._generateGridPageGroupSpecs=function(a,b){var c,d,e,f,g;for(e=[],f=0,g=a.length;f<g;f++)d=a[f],c=this._createGridPageGroupSpec(d),c.originalYear=c.year,c.year=c.month<b.month?b.year+1:b.year,e.push(c);return e},a.prototype._createGridPageGroupSpec=function(a){var b,c,d,e,f,g,h;return d=a.page.surfaceNumber-1,h=this._getImagesFromPage(a.page.values),e=h.images,c=h.cropMap,b=h.containerMap,g=this._getPopulatedTextAreasFromPage(a.page),f=new this.autofill.AdaptiveGroupSpec(d,e,new this.autofill.PageSpec("calendar-gridpage"),g),f.config={calendars:{gridRects:this.config.defaults.gridRects}},f.existingPageCrop=c,f.containerMap=b,f.month=a.pageDate.month,f.year=a.pageDate.year,f},a.prototype._getImagesFromPage=function(a){var b,c,d,e,f,g,h;if(f=[],c={},b={},null==a)return{images:f,cropMap:c,containerMap:b};for(e=this.autofill.utils.Project.extractImagesFromPage(a),g=0,h=e.length;g<h;g++)d=e[g],f.push(d.image),b[d.containerId]=d.image,c[d.image.id]=d.pageCrop;return{images:f,cropMap:c,containerMap:b}},a.prototype._getPopulatedTextAreasFromPage=function(a){var b;return null==(null!=(b=a.layout)?b.values:void 0)?[]:this.autofill.utils.Project.getPopulatedTextAreasFromLayout(a.layout.values)},a.prototype.inflateGridCell=function(a,b,c,d,e,f){return this.adaptiveLib.inflateGridCell(a,b,c,d,e,f)},a.prototype.getSuperbookTemplate=function(a,b){var c;return c=this.$q.defer(),this.adaptiveLib.getSuperbookTemplate(a,{backgrounds:!0}).then(function(a){return function(a){return c.resolve(a)}}(this)),c.promise},a.prototype.deflateGridCell=function(a,b,c){return this.adaptiveLib.deflateGridCell(a,b,c)},a}(),a.$inject=["autofill","CONFIG","$q","eventBus","$http","loggerFactory","imageCollection","pageModelStrategy"],angular.module("galleon").service("adaptiveLayoutService",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e){var f;this.config=a,this.$translate=c,this.disablePrompt=!1,f=this.$translate("SilverApp.unsavedChanges"),!this.config.runningTests()&&this.config.promptOnExit&&(e.onbeforeunload=function(a){return function(){if(a.disablePrompt===!1)return d.bookIsDirty||!b.currentProject.hasBeenSaved?f:void 0}}(this))}return a}(),a.$inject=["CONFIG","projectService","$translate","commandService","$window"],angular.module("galleon").service("browserExitService",a)}.call(this),function(){"use strict";var a;a=function(){function a(a){this.$window=a}return a.prototype.getBrowser=function(){return{name:bowser.name,supported:!0,version:bowser.version}},a.prototype.getBrowserName=function(){return bowser.name},a.prototype.getBrowserVersion=function(){return bowser.version},a}(),a.$inject=["$window"],angular.module("galleon").service("browserDetectionService",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.$window=a,this.config=b,this.bowser=bowser}return a.prototype.NEXUS_7_WIDTH=640,a.prototype.isDeviceATablet=function(){return this.bowser.tablet&&!this.bowser.msie||this.isAndroidTablet()||this.isDeviceAnIpad()},a.prototype.isDeviceAnIpad=function(){return"iPad"===this.bowser.name},a.prototype.isDeviceAPhone=function(){return this.bowser.mobile&&!this.isAndroidTablet()},a.prototype.isDeviceMobile=function(){return this.isDeviceAPhone()||this.isDeviceATablet()},a.prototype.isDeviceIos=function(){return this.bowser.ios},a.prototype.isDeviceOSAndroidNative=function(){return this.bowser.android&&!this.bowser.chrome},a.prototype.getDeviceType=function(){return this.isDeviceATablet()?"Tablet":this.isDeviceAPhone()?"Phone":"Desktop"},a.prototype.isAndroidTablet=function(){return this.bowser.android&&this.$window.innerWidth>this.NEXUS_7_WIDTH},a.prototype.getSuperSimpleDefaults=function(){return this.isDeviceAPhone()?this.config.values.superSimpleDefaults.phone:this.isDeviceATablet()?this.config.values.superSimpleDefaults.tablet:this.config.values.superSimpleDefaults.desktop},a}(),a.$inject=["$window","CONFIG"],angular.module("galleon").service("deviceDetectionService",a)}.call(this),function(){var a;a=function(){function a(a){this.$window=a}return a.prototype.pixelRatio=function(){return null!=this.$window.devicePixelRatio?this.$window.devicePixelRatio:1},a}(),a.$inject=["$window"],angular.module("galleon").service("deviceData",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k){var l,m,n,o,p,q;for(this.$q=c,this.$http=d,this.config=e,this.$timeout=g,this.$modal=h,this.$interval=i,this.projectService=j,this.eventBus=k,this.isUploadingImages=b(this.isUploadingImages,this),this.wakeUpAndCheckTheFlags=b(this.wakeUpAndCheckTheFlags,this),this.setCurrentFlag=b(this.setCurrentFlag,this),this.document=a.document,this.currentActivityFlag=0,this.activityFlags=[],m=n=0;n<=9;m=++n)this.activityFlags.push(!0);for(q=["keydown","DOMMouseScroll","mousewheel","mousedown","touchstart","touchmove","scroll"],o=0,p=q.length;o<p;o++)l=q[o],null!=this.document.addEventListener?this.document.addEventListener(l,this.setCurrentFlag,!0):this.document.attachEvent(l,this.setCurrentFlag);this._timer=a.setInterval(this.wakeUpAndCheckTheFlags,this.config.sessionIdleTimeout/this.activityFlags.length)}return a.prototype.setCurrentFlag=function(a){this.activityFlags[this.currentActivityFlag]=!0},a.prototype.wakeUpAndCheckTheFlags=function(){var a,b,c,d;if(this.currentActivityFlag=(this.currentActivityFlag+1)%this.activityFlags.length,this.isUploadingImages())return void this.setCurrentFlag();for(d=this.activityFlags,b=0,c=d.length;b<c;b++)if(a=d[b])return void(this.activityFlags[this.currentActivityFlag]=!1);return this.eventBus.publish(this.eventBus.events.SESSION_TIMEOUT),null!=this.autoSaveTimer&&this.$interval.cancel(this.autoSaveTimer),"undefined"!=typeof $window&&null!==$window&&$window.clearInterval(this._timer),this._timer=null,this.modalInstance=this.$modal.open({templateUrl:"Common/views/session-ended-modal.html",windowClass:"please-wait-window",backdrop:"static",controller:"IdleTimeoutCtrl",keyboard:!1})},a.prototype.isUploadingImages=function(){var a,b,c;return(null!=(a=this.projectService)&&null!=(b=a.currentProject)&&null!=(c=b.imageCollection)?c.currentUploadInProgress:void 0)>0},a}(),a.$inject=["$window","$q","$http","CONFIG","loggerFactory","$timeout","$modal","$interval","projectService","eventBus"],angular.module("galleon").service("idleTimeoutService",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.config=a,this.$http=b,this.cachedItems={}}return a.prototype._getUrl=function(a){return a=a.map(encodeURIComponent),""+this.config.itemPricingService+"?skus="+a.join(",")},a.prototype.cacheSkus=function(a){var b,c,d,e,f;for(b={},e=0,f=a.length;e<f;e++)c=a[e],null==this.cachedItems[c]&&(b[c]=!0);if(b=Object.keys(b),0!==b.length)return d=this._getUrl(b),this.$http.get(d).success(function(a){return function(b){var c,d,e,f,g;for(f=b.pricingItem,g=[],d=0,e=f.length;d<e;d++)c=f[d],g.push(a.cachedItems[c.sku]=c);return g}}(this))},a.prototype.getSkuPrice=function(a){return this.cachedItems[a]},a.prototype.clearCache=function(){return this.cachedItems={}},a}(),a.$inject=["CONFIG","$http"],angular.module("galleon").service("itemPricingService",a)}.call(this),function(){var a;a=function(){function a(){}return a.prototype.productValid=function(a){var b;return null!=(null!=a&&null!=(b=a.cover)?b.coverSpecID:void 0)},a.prototype.addProductSpecificProperties=function(a,b){return b.coverId=a.cover.coverSpecID,b.pageCount=parseInt(a.pages.length,10)},a.prototype.addAccessoriesToPricingRequest=function(a,b,c){var d,e;if((null!=a&&null!=(d=a.cover)?d.binding:void 0)===c.BindingType.LAYFLAT&&(b.bindingId=c.BindingType.LAYFLAT),(null!=a&&null!=(e=a.cover)?e.binding:void 0)===c.BindingType.HINGED_LAYFLAT&&(b.bindingId=c.BindingType.HINGED_LAYFLAT),a.hasMatteFinish()&&(b.coverFinishId=c.Finish.MATTE),a.hasPaddedFinish()&&(b.coverFinishId=c.Finish.PADDED),a.hasKeepsakePocket()?b.hasKeepsakePocket=!0:b.hasKeepsakePocket=!1,a.hasDustJacket()&&(b.dustJacketId=a.photobookDustJacket.id),a.hasGlossyPages())return b.pageFinishId=c.PageFinish.GLOSSY},a.prototype.isPageLayoutStorytellingCandidate=function(a){return a.ideaLayout||a.isSpread()},a.prototype.getPageLayoutName=function(a){return a.isSpread()?a.getSpreadLayoutName():a.layoutName},a.prototype.skuTest=function(){return/PB_[\w]+_BASE/},a.prototype.skuReplace=function(){return/PB_(\w+)_BASE/i},a}(),angular.module("galleon-pb").service("pricingRequestStrategy",a)}.call(this),function(){var a;a=function(){function a(){}return a.prototype.productValid=function(){return!0},a.prototype.addProductSpecificProperties=function(a,b){},a.prototype.addAccessoriesToPricingRequest=function(a,b){},a.prototype.isPageLayoutStorytellingCandidate=function(a){return a.ideaLayout},a.prototype.getPageLayoutName=function(a){return a.layoutName},a.prototype.skuTest=function(){return/WALLCAL_[\w]/},a.prototype.skuReplace=function(){return/WALLCAL_(\w+)/i},a}(),angular.module("galleon-gc").service("pricingRequestStrategy",a)}.call(this),function(){var a;a=function(){function a(){}return a.prototype.productValid=function(a){var b;return null!=(null!=a&&null!=(b=a.cover)?b.coverSpecID:void 0)},a.prototype.addProductSpecificProperties=function(a,b){return b.coverId=a.cover.coverSpecID,b.pageCount=parseInt(a.pages.length,10)},a.prototype.addAccessoriesToPricingRequest=function(a,b,c){var d,e;if((null!=a&&null!=(d=a.cover)?d.binding:void 0)===c.BindingType.LAYFLAT&&(b.bindingId=c.BindingType.LAYFLAT),(null!=a&&null!=(e=a.cover)?e.binding:void 0)===c.BindingType.HINGED_LAYFLAT&&(b.bindingId=c.BindingType.HINGED_LAYFLAT),a.hasMatteFinish()&&(b.coverFinishId=c.Finish.MATTE),a.hasPaddedFinish()&&(b.coverFinishId=c.Finish.PADDED),a.hasKeepsakePocket()?b.hasKeepsakePocket=!0:b.hasKeepsakePocket=!1,a.hasDustJacket()&&(b.dustJacketId=a.photobookDustJacket.id),a.hasGlossyPages())return b.pageFinishId=c.PageFinish.GLOSSY},a.prototype.isPageLayoutStorytellingCandidate=function(a){return a.ideaLayout||a.isSpread()},a.prototype.getPageLayoutName=function(a){return a.isSpread()?a.getSpreadLayoutName():a.layoutName},a.prototype.skuTest=function(){return/PB_[\w]+_BASE/},a.prototype.skuReplace=function(){return/PB_(\w+)_BASE/i},a}(),angular.module("galleon-ss").service("pricingRequestStrategy",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k){this.$http=a,this.$q=c,this.config=d,this.simpleCache=f,this.enums=i,this.storytellingAssetRegistry=j,this.pricingRequestStrategy=k,this._setCoverPricing=b(this._setCoverPricing,this),this.bookSizeOptions=h.constructor.SIZE_OPTIONS,this._initializeCoverPricing(),this.shouldChargeForPremiumItems=!0,this.logger=g.newInstance("PricingService")}return a.BOOK_PRICE_KEY="bookPrice",a.BOOK_PRICE_TTL=60,a.COVER_PRICE_KEY="coverPrice",a.COVER_PRICE_TTL=43200,a.prototype._initializeCoverPricing=function(){var a,b,c,d;for(null==this.coverPricesBySize&&(this.coverPricesBySize={}),d=this.bookSizeOptions,b=0,c=d.length;b<c;b++)a=d[b],this.coverPricesBySize[a]=this._createCoverPrice(a,!1,0,0)},a.prototype.getDefaultPricing=function(){var a;return a={totalOrigPrice:"...",totalSalePrice:"...",component:[],contentPrices:[]}},a.prototype.getProjectPrice=function(a){var b,c;return c=this.buildPricingRequest(a,!0),b=this.getPrice(c),b.then(function(a){return function(b){return a._parsePricedStorytellingAssets(b)}}(this)),b},a.prototype.getProjectPriceForDifferentCoverId=function(a,b){var c;return c=this.buildPricingRequest(a,!0),c.coverId=b,this.getPrice(c)},a.prototype._parsePricedStorytellingAssets=function(a){var b,c,d,e,f,g,h,i,j;if(c=null!=(i=a.contentPrice)?i.contentCategory:void 0,null==c||0===c.length)return null;for(this.storytellingAssetRegistry.reset(),e=0,g=c.length;e<g;e++)if(b=c[e],this._isStorytellingCategory(b))for(j=b.contentItem,f=0,h=j.length;f<h;f++)d=j[f],this.storytellingAssetRegistry.addAsset(d.objectId)},a.prototype._isStorytellingCategory=function(a){return/Storytelling Idea/.test(a.description)||/Storytelling Background/.test(a.description)||/Storytelling Embellishment/.test(a.description)},a.prototype.getIncrementalProjectPrice=function(a){var b;return b=this.buildPricingRequest(a,!1),this.getPrice(b)},a.prototype.getPrice=function(b){var c,d,e;return d=this.$q.defer(),e=JSON.stringify(b),null===e?void this.setPriceResult(null):(c=this.logger.asyncMetric("photobookPrice"),this.$http.post(this.config.pricingService,e).success(function(a){return c.success(),d.resolve({priceableComponents:b,pricing:a})}).error(function(b){return function(d,e){return c.failure({status:e,response:d}),b.simpleCache.clear(a.BOOK_PRICE_KEY)}}(this)),d.promise)},a.prototype.buildPricingRequest=function(a,b){var c,d,e,f;return null==b&&(b=!1),e=a.product,this.pricingRequestStrategy.productValid(e)!==!0?(this.logger.error("Unable to request price for invalid product",{projectType:null!=a?a.type:void 0}),null):(f=this._buildBasePricingRequest(e),this.pricingRequestStrategy.addProductSpecificProperties(e,f),this.pricingRequestStrategy.addAccessoriesToPricingRequest(e,f,this.enums),c=function(){var a,b,c,f;for(c=e.priceableSurfaces,f=[],a=0,b=c.length;a<b;a++)d=c[a],f.push(this._objectIdsForPage(d));return f}.call(this).reduce(function(a,b){return a.concat(b)}),this._addAssetsToPricingRequest(f,c,b),f)},a.prototype._addAssetsToPricingRequest=function(a,b,c){var d;return d={},null!=b?b.forEach(function(b){return function(e){if(c||b.storytellingAssetRegistry.hasAsset(e))return d[e]!==!0?(d[e]=!0,a.content.contentItem.push({objectId:e})):void 0}}(this)):void 0},a.prototype._objectIdsForPage=function(a){var b,c,d,e,f,g;for(c=[],this.pricingRequestStrategy.isPageLayoutStorytellingCandidate(a)&&c.push(this.pricingRequestStrategy.getPageLayoutName(a)),f=a.layout.assets,d=0,e=f.length;d<e;d++)b=f[d],"graphic"===b.asset.assetType&&null!=(null!=(g=b.values)?g.assetReference:void 0)&&c.push(b.values.assetReference.assetId);return c},a.prototype._buildBasePricingRequest=function(a){return{sizeId:a.sizeId,content:{contentItem:[{objectId:a.styleId,objectType:"style"}]}}},a.prototype.requestCoverPricing=function(a){var b,c,d,e,f;e=[];for(f in a)b=a[f],c=this._requestCoverPrice(f,b),e.push(c.promise);return d=this.$q.all(e),d.then(function(a){return function(b){return a._setCoverPricing(b)}}(this),function(c){return function(d){c.coverPricesBySize={};for(f in a)b=a[f],c.simpleCache.clear(c._composeCoverPriceKey(f)),c.coverPricesBySize[f]=c._createCoverPrice(f,!1,0,0);return d}}(this)),d},a.prototype._requestCoverPrice=function(b,c){var d,e,f,g,h;return e=this.$q.defer(),f=this._composeCoverPriceKey(b),h=this._buildCoverPriceRequest(b,c),this.simpleCache.check(f,h)?(e.resolve(this.coverPricesBySize[b]),e):(this.simpleCache.save(f,h,a.COVER_PRICE_TTL),g=this.logger,d=this.logger.asyncMetric("coverPrice"),this.$http.post(this.config.pricingService,this._buildCoverPriceRequest(b,c)).success(function(a){return d.success(),e.resolve(a)}).error(function(a,f){var h;return d.failure({status:f,response:a}),h="Failed price request of cover sizeId:"+b+", coverType:"+c+"; status:"+f,g.warn(h),e.reject(h)}),e)},a.prototype._composeCoverPriceKey=function(b){return a.COVER_PRICE_KEY+"_"+b},a.prototype._buildCoverPriceRequest=function(a,b){return null!=b?{sizeId:a,coverType:b,pageCount:1}:{sizeId:a}},a.prototype._setCoverPricing=function(a){var b,c,d,e;for(d=0,e=a.length;d<e;d++)c=a[d],b=this._parseCoverPrice(c),null!=b&&(this.coverPricesBySize[b.sizeId]=b);return b},a.prototype._parseCoverPrice=function(a){var b,c,d,e,f,g;if(null==(null!=a?a.component:void 0))return null;for(d=this.pricingRequestStrategy.skuTest(),c=this.pricingRequestStrategy.skuReplace(),g=a.component,e=0,f=g.length;e<f;e++)if(b=g[e],d.test(b.sku))return this._createCoverPrice(b.sku.replace(c,"$1").toLowerCase(),b.isOnSale,a.totalOrigPrice,a.totalSalePrice);return null},a.prototype._createCoverPrice=function(a,b,c,d){var e;return e={},e.sizeId=a,e.isOnSale=b,e.origPrice=c,e.salePrice=d,e},a}(),a.$inject=["$http","$q","CONFIG","$rootScope","simpleCache","loggerFactory","book","enums","storytellingAssetRegistry","pricingRequestStrategy"],angular.module("galleon").service("pricingService",a)}.call(this),function(){"use strict";var a;a=function(){function a(){}var b,c;return c="2",b=32768,a.prototype.generateRedEyeData=function(a,b,d){var e,f,g,h,i;if(null==d&&(d=""),!this._validParams(a,b))return d;for(f=this._getRectCount(d),e=c,e+=this._toHexOfLength(f+a.length,2),e=null!=d?e+d.substr(3):e,h=0,i=a.length;h<i;h++)g=a[h],e+=this._generateRectangle(g,b);return e},a.prototype._getRectCount=function(a){return null!=a&&a.length>=3?parseInt(a.substr(1,2),16):0},a.prototype._generateRectangle=function(a,c){var d;return d=this._toHexOfLength(Math.round(a.x/c.width*b),4),d+=this._toHexOfLength(Math.round((c.height-a.y)/c.height*b),4),d+=this._toHexOfLength(Math.round(a.width/c.width*b),3),d+this._toHexOfLength(Math.round(a.height/c.height*b),3)},a.prototype._validParams=function(a,b){return null!=b&&null!=b.width&&null!=b.height&&null!=a&&a.length>0},a.prototype._toHexOfLength=function(a,b){var c,d,e;if(d=a.toString(16),c=d.length,c<b)for(e=c;c<=b?e<b:e>b;c<=b?e++:e--)d="0"+d;return c>b&&(d=d.substring(c-b)),d},a}(),angular.module("galleon").service("redEyeHelper",a)}.call(this),function(){"use strict";var a,b;b=function(){function b(){this.cacheMap={}}return b.prototype.get=function(a){return null==this.cacheMap[a]||this._isExpired(a)?(this.clear(a),null):this.cacheMap[a].value},b.prototype._isExpired=function(a){return b.timeSeconds()-this.cacheMap[a].entryTime>this.cacheMap[a].ttlSecs},b.prototype.check=function(a,b){var c;return c=this.get(a),null!=c&&JSON.stringify(c)===JSON.stringify(b)},b.prototype.save=function(b,c,d){if(null==b)throw new Error("key null/undefined");if(null==d||"number"!=typeof d)throw new Error("ttlSecs null/undefined or not a number");return this.cacheMap[b]=new a(c,d),c},b.prototype.clear=function(a){var b;return null==this.cacheMap[a]?null:(b=this.cacheMap[a],delete this.cacheMap[a],b)},b.timeSeconds=function(){return(new Date).getTime()/1e3},b}(),a=function(){function a(a,c){this.value=a,this.ttlSecs=c,this.entryTime=b.timeSeconds()}return a}(),b.$inject=[],angular.module("galleon").service("simpleCache",b)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j){this.$window=a,this.$q=c,this.$http=d,this.config=e,this.eventBus=f,this.anonymousImageService=h,this.$timeout=i,this.projectService=j,this._heartbeat=b(this._heartbeat,this),this.x2js=new this.$window.X2JS,this.jquery=this.$window.$,this.logger=g.newInstance("UserService"),this.rememberUserName="on",this.eventBus.subscribe(this.eventBus.events.NONVISUAL_USER_SIGNIN,function(a){return function(b,c){return a._handleNonVisualSignIn(c)}}(this)),this.eventBus.subscribe(this.eventBus.events.UPP_USER_SIGNIN,function(a){return function(){return a.logger.metric("userUPPLogin"),a._userInfo=null,a.userInfo()}}(this))}var c,d,e,f,g;return e="project media user share openfly",d=1740,c=86400,f=15e5,a.prototype.userInfo=function(){var a;return this.promise?this.promise:null!=this._userInfo?(a=this.$q.defer(),this._userInfo.isLoggedIn&&Date.now()/1e3-this._userInfo.authTime>=this._userInfo.expiresIn&&(this._userInfo.isLoggedIn=!1,this._userInfo.oAuthToken=!1),this._userInfo.id&&this._userInfo.isLoggedIn?this._convertAnonymousToSflyImages(this._userInfo.id).then(function(b){return function(){return a.resolve(b._userInfo)}}(this)):a.resolve(this._userInfo),a.promise):(a=this.$q.defer(),this._loadUserInfo(a,0),this.promise=a.promise)},a.prototype._loadUserInfo=function(a,b){var c;return c=this.config.fakeTokenFailure?this.config.userInfoServiceOld:this.config.userInfoService,this.$http({method:"GET",withCredentials:!0,url:c}).success(function(b){return function(c,d,e,f){var g;return g=b._parseUserInfo(c),b.promise=null,b._userInfo=g,g.isLoggedIn&&b._startHeartbeat(),g.isLoggedIn&&(null!=g.apigeeToken&&""!==g.apigeeToken?b.logger.info("Successfully fetched oauthV2AccessToken"):(b.logger.info("Could not fetch oauthV2AccessToken"),b.projectService.goLegacy(!0))),a.resolve(b._userInfo)}}(this)).error(function(b){return function(c,d,e,f){return b.promise=null,b.logger.warn("Could not load user info: "+d),a.resolve(new g(void 0,void 0,!1))}}(this))},a.prototype._startHeartbeat=function(){if(this.config.sessionHeartbeat&&null==this.heartbeatInterval)return this.heartbeatInterval=this.$window.setInterval(this._heartbeat,f),this.eventBus.subscribe(this.eventBus.events.SESSION_TIMEOUT,function(a){return function(){return a.$window.clearInterval(a.heartbeatInterval)}}(this))},a.prototype._heartbeat=function(){return this.$http({method:"GET",withCredentials:!0,url:this.config.userInfoService}).success(function(){}).error(function(a){return function(){return a.logger.warn("could not keep session alive")}}(this))},a.prototype.isUserMigrated=function(){var a,b,c,d;return null!=(a=null!=(b=this._userInfo)?b.migrated:void 0)?a:null!=(c=this.$window.Shr)&&null!=(d=c.U)?d.migrated:void 0},a.prototype.isUserSignedIn=function(){var a,b;return a=this.$q.defer(),b=this.userInfo(),b.then(function(b){return a.resolve(b.isLoggedIn)}),b.catch(function(b){return a.resolve(!1)}),a.promise},a.prototype._handleNonVisualSignIn=function(a){var b;return null==this._userInfo&&(this._userInfo=new g),1!==(null!=a?a.returnCode:void 0)?void this._handleNonVisualSignupError(a):(this._userInfo.id=a.uid,this._userInfo.firstName=a.firstName,this._userInfo.email=a.email,this._userInfo.expiresIn=c,this._userInfo.authTime=Date.now()/1e3,this._userInfo.openflyToken=a.oflyToken,this._userInfo.apigeeToken=a.oauthV2AccessToken,this._userInfo.migrated=a.migrated,null!=a.uid?this._userInfo.oAuthToken=a.oauthToken:this._userInfo.appToken=a.oauthToken,this._userInfo.isLoggedIn=null!=a.uid,void(this._userInfo.isLoggedIn===!0&&((""===this._userInfo.apigeeToken||null==this._userInfo.apigeeToken||this.config.fakeTokenFailure)&&(this.logger.info("Missing oauthV2AccessToken in nonVisualSignIn"),this.projectService.goLegacy(!0)),null!=(b=this.loginMetric)&&b.success(),this.loginMetric=void 0,this._startHeartbeat(),this.eventBus.publish(this.eventBus.events.LOGIN_SUCCEEDED,this._userInfo))))},a.prototype._handleNonVisualSignupError=function(a){var b,c,d,e;switch(d=a.returnCode){case-1:c="Email exists";break;case-3:c="Already logged in"}return b="Problem getting access token: "+a,null==c&&(this.logger.critical(b),c="Unknown"),null!=(e=this.loginMetric)&&e.failure({response:b}),this.loginMetric=void 0,this.eventBus.publish(this.eventBus.events.NONVISUAL_USER_SIGNUP_ERROR,{returnCode:d,reason:c})},a.prototype.reportLoginStarted=function(){return this.loginMetric=this.logger.asyncMetric("userLogin")},a.prototype.reportSignupStarted=function(){return this.loginMetric=this.logger.asyncMetric("userSignup")},a.prototype.removeOpenflyToken=function(){return this._userInfo.openflyToken=null},a.prototype.getOpenflyToken=function(a){return null==a&&(a=this.$q.defer()),
this.eventBus.publish(this.eventBus.events.LOGIN_PROMPT),a.reject("User must be signed in to get openfly token"),a.promise},a.prototype._parseUserInfo=function(a){var b,d,e,f,h;return d=this.x2js.xml_str2json(a),f=null!=(h=d.userSessionData)?h.user:void 0,e=new g,e.isLoggedIn=!1,null!=f&&(b=f.authToken.split("|"),e.id=b[0],5===b.length&&(e.id=b[1]),e.openflyUserId=f._id,e.openflyToken=f.authToken,e.oAuthToken=f.oauthToken,e.apigeeToken=f.oauthV2AccessToken,e.expiresIn||(e.expiresIn=c,e.authTime=Date.now()/1e3),e.firstName=f.firstName,e.isLoggedIn=!0,e.email=f.email),this.eventBus.publish(this.eventBus.events.USER_INFO_AVAILABLE,e),e},a.prototype._convertAnonymousToSflyImages=function(a){var b,c;return b=this.$q.defer(),this.config.allowAnonymousUpload||b.resolve(),this.anonymousImageService.hasAnonymousImages()?(c=this.anonymousImageService.getSflyImageUrls(a),c.then(function(a){return b.resolve()},function(a){return function(c){return a.logger.error(c),b.resolve()}}(this))):b.resolve(),b.promise},a.prototype.fetchImageMetadataForImageIds=function(a){var b,c;return c=function(){var c,d,e;for(e=[],c=0,d=a.length;c<d;c++)b=a[c],e.push(this._imageMetadataRequest(b).then(function(a){return{encodedMspPath:a.view_efx.encodedMspPath,viewId:a.id}}));return e}.call(this),this.$q.all(c)},a.prototype._imageMetadataRequest=function(a){var b,c,d,e;return b=this.$q.defer(),c=this._userInfo.oAuthToken,d=this._userInfo.id,e=""+this.config.imageMediaService+"/"+d+"/images/"+a+"?accessToken="+c+"&pageSize=1",this.$http({method:"GET",url:e}).success(function(a,c,d,e){return b.resolve(a)}).error(function(c){return function(d,e,f,g){return c.logger.error("Could not fetch image metadata ",{imageId:a}),b.reject("Could not fetch image metadata for imageId "+a)}}(this)),b.promise},g=function(){function a(a,b,c,d,e,f){this.id=a,this.firstName=b,this.isLoggedIn=c,this.oAuthToken=d,this.openflyToken=e,this.openflyUserId=f}return a}(),a}(),a.$inject=["$window","$q","$http","CONFIG","eventBus","loggerFactory","anonymousImageService","$timeout","projectService"],angular.module("galleon").service("userService",a)}.call(this),function(){angular.module("galleon-pb").value("styleInfoStrategy",function(a,b){var c,d;return{id:a.styleId,version:a.styleContentVersion,size:null!=(c=null!=(d=a.bookSizeID)?d:a.sizeId)?c:a.sizeID,component:"gphotobook"}})}.call(this),function(){angular.module("galleon-gc").value("styleInfoStrategy",function(a,b){return{id:a.styleId,version:a.styleContentVersion,size:a.sizeId||a.sizeID,component:"calendar"}})}.call(this),function(){angular.module("galleon-ss").value("styleInfoStrategy",function(a,b){var c,d;return{id:a.styleId,version:a.styleContentVersion,size:null!=(c=null!=(d=a.bookSizeID)?d:a.sizeId)?c:a.sizeID,component:"gphotobook"}})}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k){this.$q=a,this.$http=c,this.config=d,this.eventBus=e,this.adaptiveLayoutService=f,this.$document=h,this.globalContentService=i,this.autofill=j,this.styleInfoStrategy=k,this.setStyleAfterInitialProjectLoad=b(this.setStyleAfterInitialProjectLoad,this),this.logger=g.newInstance("ContentService"),this.styleColors=null,this.styleFonts=null,this.globalColors=null,this.colorByHex={}}return a.prototype.setStyleAfterInitialProjectLoad=function(a){var b;return b=this.fetchStyle(a.product),null!=b&&b.then(function(a){return function(b){return a.changeCurrentStyle(b)}}(this),function(a){return function(b){return a.logger.error("Error fetching style: "+b.message)}}(this)),b},a.prototype.getLayoutByAttributes=function(a,b,c){var d,e,f,g,h,i,j,k;if(null==c&&(c=["page","ideapage","title"]),null!=this.currentStyle)for(d=this.currentStyle.assetLists.assetList.filter(function(a){return"layout"===a.assetType&&c.indexOf(a.surfaceType)>-1}),g=0,i=d.length;g<i;g++){if(e=d[g],null==e.assetRef)return;for(k=e.assetRef,h=0,j=k.length;h<j;h++)if(f=k[h],f.assetId===a&&this._formFactorsMatch(b,f.layoutAttributes))return f}},a.prototype._formFactorsMatch=function(a,b){return b.formFactor===a||b.FormFactor===a},a.prototype.createTextArea=function(a,b,c){var d;return d=this.adaptiveLayoutService.adaptiveLib.createTextArea(a,b,c.width,c.height,this.currentStyle,c)},a.prototype.createEmptyImageArea=function(a,b,c){return this.adaptiveLayoutService.adaptiveLib.createImageArea(a,b,c.width,c.height,{xOffset:c.xOffset,yOffset:c.yOffset})},a.prototype.createImageArea=function(a,b,c){var d,e;return e=this._createAssignedImage(c.image),d=this.adaptiveLayoutService.adaptiveLib.createImageArea(a,b,c.width,c.height,{xOffset:c.xOffset-c.width/2,yOffset:c.yOffset-c.height/2,image:e})},a.prototype._createAssignedImage=function(a){var b,c,d;return b={id:a.imageId,data:a.data,width:a.Xwidth+"",height:a.Xheight+"",description:a.description,rotation:a.rotation+"",effect:a.effect,redeye:a.redeye,fadeColor:a.fadeColor,fadeValue:a.fadeValue,projectImageId:a.productImageID+"",llx:a.cropllx,lly:a.croplly,urx:a.cropurx,ury:a.cropury},b.fadeColor=null!=(c=a.fadeColor)?c:"#FFFFFF",b.fadeValue=null!=(d=a.fadeValue)?d:"1",b},a.prototype.fetchStyle=function(a,b,c){var d;return null==b&&(b=null),null==c&&(c=0),null!=(null!=a?a.sizeId:void 0)||null!=(null!=a?a.sizeID:void 0)||null!=a&&a.bookSizeID?(null==b&&(b=this.$q.defer()),d=this.styleInfoStrategy(a,this.autofill),this.adaptiveLayoutService.adaptiveLib.getVerboseStyle(d).then(function(d){return function(e,f){return c++,null!=f?c<2?d.fetchStyle(a,b,c):b.reject(f):b.resolve(e)}}(this)),b.promise):null},a.prototype.changeCurrentStyle=function(a){var b,c;return this.loadSpriteCSSFromStyle(a),this.styleColors=null,this.styleFonts=null,this.currentStyle=a,this.currentStyleCategory=null!=(b=this.currentStyle)&&null!=(c=b.displayName)?c.toLowerCase().split(" ").join("-"):void 0,this.eventBus.publish(this.eventBus.events.STYLE_LOADED,a)},a.prototype.removeSpriteCSS=function(){var a,b,c,d,e;for(b=this.$document[0].getElementsByClassName("spriteStyles"),e=[],c=0,d=b.length;c<d;c++)a=b[c],e.push(angular.element(this.$document[0].querySelector(".spriteStyles")).remove());return e},a.prototype.loadSpriteCSSFromStyle=function(a){var b,c,d,e,f,g;if(this.removeSpriteCSS(),null!=(e=a.styleSprite)?e.assetRef:void 0){for(f=a.styleSprite.assetRef,g=[],c=0,d=f.length;c<d;c++)b=f[c],g.push(this.loadSpriteCSSAssetRef(b));return g}},a.prototype.appendStylesheetLink=function(a){var b,c;return b=this.$document[0].getElementsByTagName("head")[0],c=this.$document[0].createElement("link"),c.setAttribute("class","spriteStyles"),c.setAttribute("rel","stylesheet"),c.setAttribute("type","text/css"),c.setAttribute("href",a),angular.element(b).append(c)},a.prototype.loadSpriteCSSAssetRef=function(a){var b;switch(b=this.config.protocolRelativeUrl(a.url.value),a.url.repType){case"css":return this.appendStylesheetLink(b);case null:case void 0:return this.loadStyleSpriteJson(b)}},a.prototype.loadStyleSpriteJson=function(a){var b;return b=this.$http({method:"GET",url:a}),b.success(function(a){return function(b,c,d,e){var f,g,h,i,j;for(i=b.assetRef,j=[],g=0,h=i.length;g<h;g++)f=i[g],j.push(a.loadSpriteCSSAssetRef(f));return j}}(this))},a.prototype.currentFontFamilies=function(){var a,b,c;return null!=this.styleFonts?this.styleFonts:null==(null!=(b=this.currentStyle)&&null!=(c=b.styleFonts)?c.styleFont:void 0)?[]:(this.styleFonts=function(){var b,c,d,e;for(d=this.currentStyle.styleFonts.styleFont,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(this.globalContentService.getFontFamilyForFamilyId(a.fontFamilyId));return e}.call(this),this.styleFonts)},a.prototype.colorForHex=function(a){return this.allColors(),this.colorByHex[a]},a.prototype.colorForId=function(a){return this._createColor(this.globalContentService.getColorForColorId(a))},a.prototype.allColors=function(){var a;return null!=this.globalColors?this.globalColors:(this.globalColors=function(){var b,c,d,e;for(d=this.globalContentService.getColors(),e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(this._createColor(a));return e}.call(this),this.globalColors)},a.prototype._createColor=function(a){var b;return b=this._colorWithHex(a),this.colorByHex[b.color]=b,b},a.prototype.currentStyleColors=function(){var a,b,c;return null!=this.styleColors?this.styleColors:null==(null!=(b=this.currentStyle)&&null!=(c=b.styleColors)?c.styleColor:void 0)?[]:(this.styleColors=function(){var b,c,d,e;for(d=this.currentStyle.styleColors.styleColor,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(this._colorWithHex(a));return e}.call(this),this.styleColors)},a.prototype._colorWithHex=function(a){var b;return b=this.globalContentService.getColorForColorId(a.colorId),{color:"#"+(null!=b?b.rgb:void 0),id:null!=b?b.colorId:void 0,name:null!=b?b.displayName:void 0}},a}(),a.$inject=["$q","$http","CONFIG","eventBus","adaptiveLayoutService","loggerFactory","$document","globalContentService","autofill","styleInfoStrategy"],angular.module("galleon").service("contentService",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e){this.$q=a,this.$http=b,this.config=c,this.adaptiveLayoutService=d,this.logger=e.newInstance("GlobalContentService"),this.fontFamiliesByFamilyId={},this.fontFamiliesByFontId={},this.fontFamilies=[],this.frameByFrameId={}}return a.prototype.requestGlobalContent=function(){var a,b;return a=this.$q.defer(),null!=this.content?a.resolve(this.content):(b=this.logger.asyncMetric("fetchGlobalContent"),this.$http({method:"GET",url:this.config.globalContentService}).success(function(c){return function(d,e,f,g){return b.success(),c.setContent(d),a.resolve(c.content)}}(this)).error(function(c,d,e,f){return b.failure({status:d,response:c}),a.reject(new Error("Could not load global content"))})),a.promise},a.prototype.setContent=function(a){return this.content=a,this.adaptiveLayoutService.adaptiveLib.setGlobalContent(a),this._mapFontFamilies(a),this._mapFrames(a)},a.prototype.getFontFamilyForFamilyId=function(a){return this.fontFamiliesByFamilyId[a]},a.prototype.getFontFamilyForFontId=function(a){return this.fontFamiliesByFontId[a]},a.prototype.getFontFamilies=function(){return this.fontFamilies},a.prototype.getFontForFontId=function(a){var b,c,d,e,f;if(b=this.getFontFamilyForFontId(a),null!=b)for(f=b.font,d=0,e=f.length;d<e;d++)if(c=f[d],c.fontId===a)return c;return null},a.prototype.getFontSizes=function(){var a,b;return null!=(a=this.content)&&null!=(b=a.fontSizes)?b.fontSize:void 0},a.prototype.getColorForColorId=function(a){return this.adaptiveLayoutService.adaptiveLib.globalContent.colorByColorId[a]},a.prototype.getColors=function(){var a,b,c,d;c=[],d=this._globalContentService().colorByColorId;for(b in d)a=d[b],c.push(a);return c},a.prototype.getLogoPageForSize=function(a){var b,c,d,e;for(e=this.content.logoPages.logoPage,c=0,d=e.length;c<d;c++)if(b=e[c],b.sizeId===a)return b;return null},a.prototype._mapFontFamilies=function(a){var b,c,d,e,f,g,h,i;if(null==(null!=a&&null!=(g=a.fontFamilies)?g.fontFamily:void 0))return[];for(this.fontFamiliesByFamilyId={},this.fontFamiliesByFontId={},this.fontFamilies=[],h=a.fontFamilies.fontFamily,i=[],e=0,f=h.length;e<f;e++)b=h[e],"H"===b.state||b.font.every(function(a){return"H"===a.state})||"font_compendium"===b.fontFamilyId||(d=this._createProjectFontFamilyForFamily(b),this.fontFamilies.push(d),this.fontFamiliesByFamilyId[b.fontFamilyId]=d,null!=b.font?i.push(function(){var a,e,f,g;for(f=b.font,g=[],a=0,e=f.length;a<e;a++)c=f[a],g.push(this.fontFamiliesByFontId[c.fontId]=d);return g}.call(this)):i.push(void 0));return i},a.prototype._createProjectFontFamilyForFamily=function(a){var b,c,d,e,f,g,h,i,j,k;if(!((null!=a&&null!=(i=a.font)?i.length:void 0)>0))return{};for(c=angular.copy(a),j=c.font[0].url,e=0,g=j.length;e<g;e++)d=j[e],"thumb"===d.repType&&(c.previewURL=d.value);for(c.previewURL=c.previewURL.replace(/http[s]?:/g,""),c.fonts=[],k=c.font,f=0,h=k.length;f<h;f++)b=k[f],c.fonts.push(this._createProjectFont(b));return c},a.prototype._createProjectFont=function(a){return{styleName:a.displayName,fontId:a.fontId,fontFamily:a.fontFamily,fontName:a.fontName,fontStyle:a.style,fontWeight:a.weight}},a.prototype._mapFrames=function(a){var b,c,d,e,f,g;if(null==(null!=a&&null!=(e=a.frames)?e.frame:void 0))return[];for(this.frameByFrameId={},f=a.frames.frame,g=[],c=0,d=f.length;c<d;c++)b=f[c],g.push(this.frameByFrameId[b.frameId]=b);return g},a.prototype.getUrlsForFrame=function(a){var b,c,d,e,f;for(e=a.url,f=[],c=0,d=e.length;c<d;c++)switch(b=e[c],b.repType){case"preview":f.push(a.previewUrl=this.config.protocolRelativeUrl(b.value));break;case"thumb":f.push(a.thumbUrl=this.config.protocolRelativeUrl(b.value));break;default:f.push(void 0)}return f},a.prototype.getFrameForFrameId=function(a){var b,c,d,e,f;if(d=this.frameByFrameId[a],c=this.getColorForColorId(d.colorId),null!=d&&null!=d.url&&this.getUrlsForFrame(d),null!=d)return b={assetType:"frame",assetId:d.frameId,displayName:d.displayName,colorId:d.colorId,colorName:null!=(e=null!=c?c.displayName:void 0)?e:"",color:null!=(f=null!=c?c.rgb:void 0)?f:"",thickness:d.thickness,previewWidth:300,previewHeight:235,previewUrl:d.previewUrl,thumbUrl:d.thumbUrl}},a.prototype._globalContentService=function(){return this.adaptiveLayoutService.adaptiveLib.globalContent},a}(),a.$inject=["$q","$http","CONFIG","adaptiveLayoutService","loggerFactory"],"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("globalContentService",a)}.call(this),function(){"use strict";var a,b,c;b=" is not defined in event constants @ events.js.",c=function(){function c(b,c,d){var e,f;this.$window=b,this.config=c,this.alwaysPublishSync=!1,this.events=a,angular.extend(this.events,d),this.avoidAutoClean={},this.autoCleanEntries={},this.tokensMap={all:[]},this.probingMap={},this.reversedEvents=[],b.PubSub.immediateExceptions="INFO"===this.config.defaults.logLevel;for(e in a)f=a[e],this.reversedEvents[f]=e;this.unsubscribeAll()}return c.prototype._removeToken=function(a,b){var c;if(null==b&&(b=!0),c=this.probingMap[a])return b?this.tokensMap[c.category].splice(c.index,1):delete this.tokensMap[c.category],delete this.probingMap[a]},c.prototype.prohibitAutoClean=function(a){return this.avoidAutoClean[a]=!0},c.prototype.ensureAutoClean=function(a){if(null!=(null!=a?a.$id:void 0)&&!this.avoidAutoClean[a.$id]&&!this.autoCleanEntries[a.$id])return a&&a.$$listeners?(this.autoCleanEntries[a.$id]=!0,a.$on("$destroy",function(b){return function(){return b.unsubscribeFrom(a)}}(this))):void 0},c.prototype.setAlwaysPublishSync=function(a){return this.alwaysPublishSync=!!a},c.prototype.hasEvent=function(a){return this.reversedEvents[a]&&this.events[this.reversedEvents[a]]===a},c.prototype.publish=function(a,c){if(this.alwaysPublishSync)return this.publishSync(a,c);if(this.hasEvent(a))return this.$window.PubSub.publish(a,c);throw a+b},c.prototype.publishSync=function(a,c){if(this.hasEvent(a))return this.$window.PubSub.publishSync(a,c);throw a+b},c.prototype.subscribe=function(a,c,d){var e,f;if(null==d&&(d="all"),this.hasEvent(a))return e=null!=d.$id?d.$id:d,this.ensureAutoClean(d),f=this.$window.PubSub.subscribe(a,c),angular.isArray(this.tokensMap[e])||(this.tokensMap[e]=[]),this.tokensMap[e].push(f),this.probingMap[f]={category:e,index:this.tokensMap[e].length-1},f;throw a+b},c.prototype.unsubscribe=function(a){return this._removeToken(a),this.$window.PubSub.unsubscribe(a)},c.prototype.unsubscribeAll=function(){var a,b,c,d,e,f;f=this.tokensMap;for(a in f)if(c=f[a],this.tokensMap.hasOwnProperty(a))for(d=0,e=c.length;d<e;d++)b=c[d],this._removeToken(b,!1),this.$window.PubSub.unsubscribe(b);return this.tokensMap={all:[]}},c.prototype.unsubscribeFrom=function(a){var b,c,d,e,f;if(b=null!=a.$id?a.$id:a,angular.isArray(this.tokensMap[b])){for(f=this.tokensMap[b],d=0,e=f.length;d<e;d++)c=f[d],this._removeToken(c,!1),this.$window.PubSub.unsubscribe(c);return this.tokensMap[b]=[]}},c}(),c.$inject=["$window","CONFIG","productSpecificEvents"],angular.module("galleon").service("eventBus",c),a={AUTOFILL_UNPLACED_IMAGES:"autofill.images.unplaced",BOOK_TAB_SELECT_CURRENT_COVER:"bookTab.selectCurrentCover",CANNOT_ADD_PHOTO_AREA:"surface.errors.cannot_add_photo_area",CANNOT_APPLY_LAYOUT:"surface.errors.cannot_apply_layout",COMMAND_EXECUTED:"command.executed",COMMAND_UNDO:"command.undo",COMMAND_REDO:"command.redo",ENSURE_SECONDARY_PALETTE_REDRAW:"ensure.secondary.palette.redraw",EXT_PALETTE_ITEMS_UPDATED:"ext_palette_items_updated",GET_PROJECT_SUMMARIES:"get.project.summaries",INITIATE_UPSELL:"upsell.initiate",LOGIN_PROMPT:"login.prompt",LOGIN_PROMPT_WITH_DETAIL:"login.prompt.with.detail",LOGIN_PROMPT_WITH_DETAIL_CLOSED:"login.prompt.with.detail.closed",LOGIN_PROMPT_FORCE:"login.prompt.force",LOGIN_PROMPT_CLOSED:"login.prompt_closed",LOGIN_SUCCEEDED:"login.succeeded",MODAL_TEXT_SETTINGS_UPDATED:"modal.text_settings.updated",MODAL_UPLOAD_ERROR_HIDE:"modal.upload_error.hide",MODAL_UPLOAD_ERROR_SHOW:"modal.upload_error.show",MODAL_UPLOAD_PROGRESS_HIDE:"modal.upload_progress.hide",MODAL_UPLOAD_PROGRESS_SHOW:"modal.upload_progress.show",MODAL_UPLOAD_PROGRESS_DISMISS:"modal.upload_progress.dismiss",MODAL_EXPORT_PDF_DISMISS:"modal.export_pdf.dismiss",MODAL_SAVE_JPG_DISMISS:"modal.save_jpg.dismiss",NOMORE_PHOTOS_CANBE_ADDED:"surface.errors.nomore_photos_canbe_added",PALETTE_IMAGE_RATED:"palette.image.rated",PALETTE_IMAGES_ADDED:"palette.images.added",PALETTE_IMAGES_REMOVED:"palette.images.removed",PALETTE_IMAGES_UPLOAD_ERROR:"palette.images.upload_error",PALETTE_IMAGES_UPLOAD_CANCEL:"palette.images.upload_cancel",PALETTE_IMAGES_UPLOADED:"palette.images.uploaded",PALETTE_THUMBNAILS_ADDED:"palette.thumbnails.added",PALETTE_THUMBNAILS_REMOVED:"palette.thumbnails.added",PALETTE_THUMBNAILS_REFRESH:"palette.thumbnails.refresh",PLEASE_WAIT_HIDE:"please.wait.hide",PLEASE_WAIT_SHOW:"please.wait.show",PLEASE_WAIT_PROGRESS:"please.wait.progress",PROJECT_AUTO_SAVE:"project.auto.save",PROJECT_CONTINUE_EXPORT:"project.continue.export",PROJECT_CONTINUE_SAVE_JPG:"project.continue.save_jpg",PROJECT_CONTINUE_ORDER:"project.continue.order",PROJECT_CONTINUE_REDIRECT:"project.continue.redirect",PROJECT_CONTINUE_SHARE:"project.continue.share",PROJECT_CONVERSION_COMPLETE:"project.conversion.complete",PROJECT_UNDO_CONVERSION_COMPLETE:"project.undo.conversion.complete",PROJECT_CONVERSION_ERROR:"project.conversion.error",PROJECT_CREATED:"project.created",PROJECT_EXPORT:"project.export",PROJECT_SAVE_JPG:"project.save_jpg",PROJECT_LOADED:"project.loaded",PROJECT_OBSERVED_FOR_PATCH:"project.observed.for.patch",PROJECT_MODIFIED:"project.modified",PROJECT_ORDER:"project.order",PROJECT_SAVE:"project.save.now",PROJECT_SAVE_FULL:"project.save.full",PROJECT_SAVE_AS:"project.save.as",PROJECT_SAVE_COMPLETED:"project.save.completed",PROJECT_SHARE:"project.share",PROJECT_SUMMARIES:"project.summaries",PROJECT_LOAD:"project.load",PROJECT_PRICE_CHANGE:"project.price.change",RECLUSTER_REQUIRED:"recluster.required",SELECT_ARRANGE_TAB:"selectArrangeTab",SELECT_EDIT_TAB:"selectEditTab",SELECT_STORYBOARD_TAB:"selectStoryboardTab",SELECT_STYLE_TAB:"selectStyleTab",SELECT_BOOK_TAB:"selectBookTab",SHOW_COVER_CHANGE_WARNING_DIALOG:"coverChangeWarningDialog.show",SHOW_CRITICAL_ERROR_DIALOG:"show.critical.error.dialog",SHOW_OPEN_ON_DESKTOP_WARNING_DIALOG:"openOnDesktopWarningDialog.show",SHOW_SIZE_CHANGE_WARNING_DIALOG:"sizeChangeWarningDialog.show",SHOW_POST_SIZE_CHANGE_WARNING_DIALOG:"postSizeChangeWarningDialog.show",SHOW_STYLE_CHANGE_WARNING_DIALOG:"styleChangeWarningDialog.show",START_UPLOADS:"startUploads",CANCEL_UPLOADS:"cancelUploads",STYLE_LOADED:"style.loaded",SURFACE_ANIMATION_DONE:"surface.animation.done",SURFACE_BACKGROUND_UPDATED:"surface.background.updated",SURFACE_EMBELLISHMENT_ADDED:"surface.embellishment.added",SURFACE_EMBELLISHMENT_REMOVED:"surface.embellishment.removed",SURFACE_IMAGE_ADDED:"surface.image.added",SURFACE_IMAGE_REMOVED:"surface.image.removed",SURFACE_IMAGE_UPDATED:"surface.image.updated",SURFACE_IMAGE_SELECTED:"surface.image.selected",SURFACE_TEXT_UPDATED:"surface.text.updated",SURFACE_INVALIDATED:"surface.invalidated",SURFACE_LAYOUT_UPDATED:"surface.layout.updated",SURFACE_SELECTED:"surface.selected",SURFACE_ADDED:"surface.added",SURFACE_REMOVED:"surface.removed",SURFACES_ADDED:"surfaces.added",SURFACES_REMOVED:"surfaces.removed",MODAL_OPENED:"modal.opened",UPP_IMAGE_FINISH:"upp.image.finish",UPP_IMAGE_PLACEMENT_SELECTED:"upp.image.placement.selected",UPP_IMAGE_START:"upp.image.start",UPP_IMAGE_PROCESSING_COMPLETE:"upp.image.processing.complete",UPP_IMAGE_UPDATE:"upp.image.update",UPP_UNKNOWN:"upp.unknown",UPP_UPLOAD_COMPLETED:"upp.upload.completed",UPP_USER_SIGNIN:"upp.user.signin",USER_SIGNIN:"user.signin",NONVISUAL_USER_SIGNIN:"nonvisual.user.signin",NONVISUAL_USER_SIGNUP_ERROR:"nonvisual.user.signup.error",USER_INFO_AVAILABLE:"user.available",CUSTOMIZE_MODE_ENTERED:"customize.mode.entered",CUSTOMIZE_SELECTION_CREATED:"customize.group.created",CUSTOMIZE_SELECTION_DESTROYED:"customize.group.destroyed",CUSTOMIZE_ALIGN_LEFT:"customize.align.left",CUSTOMIZE_ALIGN_TOP:"customize.align.top",CUSTOMIZE_ALIGN_RIGHT:"customize.align.right",CUSTOMIZE_ALIGN_BOTTOM:"customize.align.bottom",CUSTOMIZE_ALIGN_CENTER:"customize.align.center",CUSTOMIZE_ALIGN_MIDDLE:"customize.align.middle",CUSTOMIZE_LAYER:"customize.layer",CUSTOMIZE_SPACE:"customize.space",CUSTOMIZE_MATCH:"customize.match",CUSTOMIZE_MODE_CLICKED_OUT_OF_BOUNDS:"customize.mode.click.outofbounds",CUSTOMIZE_SELECT_ALL:"customize.select.all",TRANSIENT_LAYOUT_STARTED:"transient.layout.started",CUSTOMIZE_DELETE_TOGGLED:"customize.delete.toggled",CUSTOMIZE_IMAGE_DBLCLICK:"customize.image.dblclick",CUSTOMIZE_TEXT_DBLCLICK:"customize.text.dblclick",CROSSED_WIDELAYFLAT_PAGE_LIMIT:"crossed.widelayflat.page.limit",PALETTE_SELECTION_REQUIRED:"palette.selection.required",APP_READY:"app.ready",CONTINUE_TO_UPP:"continue.upp",CONTINUE_TO_IMPORT_PAGE:"continue.import.page",STOP_AUTOPLAY:"stop.autoplay",START_INTRO_TOUR:"start.intro.tour",START_NEW_FEATURES:"start.new.features",IMAGE_GETRANK_START:"image.getrank.start",IMAGE_GETRANK_DONE:"image.getrank.done",ACTIVATE_EVENT_FOR_ASSET:"calendar.activate.event.for.asset",CALENDAR_EVENT_IMAGE_DRAGGED:"calendar.event.image.dragged",CALENDAR_EVENT_ADDED:"calendar.event.added",CALENDAR_EVENT_UPDATED:"calendar.event.updated",CALENDAR_REMOVE_ACTIVE_EVENT:"calendar.event.active.remove",HANDLE_UPP_CANCEL:"handle.upp.cancel",SHOW_BACON_CHOOSE_COVER:"show.bacon.choose.cover",PROJECT_SAVING_IN_PROGRESS:"project.saving.in.progress",PROJECT_SAVING_COMPLETE:"project.saving.complete",MAGIC_SHOP_CONTINUE:"magic.shop.continue",UPDATE_SAVE_TIME:"update.save.time",SESSION_TIMEOUT:"session.timeout"},angular.module("galleon").value("eventBusTypes",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e){this.$http=a,this.config=c,this.eventBus=d,this._getVividPics=b(this._getVividPics,this),this.logger=e.newInstance("MediaPreferenceService"),this.vividPics=!0,this.config.vividPicsEnabled&&(this.eventBus.subscribe(this.eventBus.events.USER_INFO_AVAILABLE,this._getVividPics),this.eventBus.subscribe(this.eventBus.events.LOGIN_SUCCEEDED,this._getVividPics))}return a.prototype._getVividPics=function(a,b){var c,d;if(b.isLoggedIn)return d=""+this.config.values.mediaPreferenceService+"/user/"+b.id+"/mediapreference/enablevividpics",c=this.$http({method:"GET",url:d,extendedTimeout:!0,transformResponse:[function(a){return function(b,c,d){var e;if(200<=d&&d<300)try{return JSON.parse(b)}catch(c){return e=c,a.logger.warn("unable to parse vividpics response: "+b)}}}(this)]}),c.success(function(a){return function(b){if(null!=b)return a.vividPics=b}}(this))},a}(),a.$inject=["$http","CONFIG","eventBus","loggerFactory"],angular.module("galleon").service("mediaPreferenceService",a)}.call(this),function(){var a;a=function(){function a(){}return a.prototype.explodeQueryString=function(a){var b,c,d,e,f,g,h;if(null!=a&&a.split("?").length>1){for(f=a.split("?")[1],b=f.split("&"),e={},c=g=0,h=b.length-1;0<=h?g<=h:g>=h;c=0<=h?++g:--g)d=b[c].split("="),2===d.length&&(e[d[0]]=decodeURIComponent(d[1].replace(/\+/g," ")));return e}},a.prototype.convertObjectToUrlParams=function(a){var b,c,d;c="";for(b in a)d=a[b],""!==c&&(c+="&"),c+=b+"="+d;return c},a}(),angular.module("galleon").service("urlUtil",a)}.call(this),function(){var a;a=function(){function a(){}return a.prototype.getISOFormat=function(a){var b,c,d;try{if("number"==typeof a)b=new Date(a);else if("string"==typeof a){if(c=a.split(/[\s-:]+/),6!==(null!=c?c.length:void 0))return a;b=new Date(c[0],c[1]-1,c[2],c[3],c[4],c[5])}return null!=b?b.toISOString():a}catch(b){return d=b,a}},a.prototype.isISODateTime=function(a){return"string"==typeof a&&/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.*Z/.test(a)},a.prototype.convertISODateTimeToLegacyDate=function(a){var b;return this.isISODateTime(a)&&"object"==typeof(b=new Date(a))?""+this._formatLegacyDate(b)+" "+this._formatLegacyTime(b):null},a.prototype.getDaysInMonth=function(a,b){return new Date(a,b,0).getDate()},a.prototype._formatLegacyDate=function(a){return""+this._toDoubleDigit(a.getMonth()+1)+"/"+this._toDoubleDigit(a.getDate())+"/"+a.getFullYear()},a.prototype._formatLegacyTime=function(a){var b,c;return b=a.getHours(),c="AM",b>=12&&(c="PM",b-=12),""+this._toDoubleDigit(b)+":"+this._toDoubleDigit(a.getMinutes())+(":"+this._toDoubleDigit(a.getSeconds())+" "+c)},a.prototype._toDoubleDigit=function(a){var b;return b="",a<10&&(b+="0"),b+a},a}(),angular.module("galleon").service("dateUtil",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.$scope=a,this.$modalInstance=b,this.config=c,this.$window=d,this.$scope.ctrls=this.$scope.ctrls||{},this.$scope.ctrls.IdleTimeoutCtrl=this}return a.prototype.cancel=function(){return this.$modalInstance.dismiss("cancel")},a.prototype.gotoMyProjects=function(){this.$window.open(this.config.myprojectsUrl,"_self")},a.prototype.gotoMyShutterfly=function(){this.$window.open(this.config.myShutterfly,"_self")},a.prototype.gotoStore=function(){this.$window.open(this.config.storeUrl,"_self")},a}(),a.$inject=["$scope","$modalInstance","CONFIG","$window"],angular.module("galleon").controller("IdleTimeoutCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d){this.$scope=a,this.eventBus=c,this.data=d,this._handleWaitProgress=b(this._handleWaitProgress,this),this.$scope.ctrls=this.$scope.ctrls||{},this.$scope.ctrls.PleaseWaitCtrl=this,this.maxProgress=100,this.currentProgress=0,this.data.determinate&&this.eventBus.subscribe(this.eventBus.events.PLEASE_WAIT_PROGRESS,this._handleWaitProgress,this.$scope)}return a.prototype._handleWaitProgress=function(a,b){return this.maxProgress=b.max,this.currentProgress=b.current},a}(),a.$inject=["$scope","eventBus","data","$timeout"],angular.module("galleon").controller("PleaseWaitCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.$modal=a,this.eventBus=b,this.eventBus.subscribe(this.eventBus.events.PLEASE_WAIT_SHOW,function(a){return function(b,c){return a.show(null!=c?c.subtle:void 0,null!=c?c.determinate:void 0)}}(this)),this.eventBus.subscribe(this.eventBus.events.PLEASE_WAIT_HIDE,function(a){return function(){return a.hide()}}(this))}return a.prototype.show=function(a,b){if(null==a&&(a=!1),null==b&&(b=!1),null==this.modalInstance)return a?this.modalInstance=this.$modal.open({template:"<div></div>",windowClass:"please-wait-subtle",backdrop:!1,keyboard:!1}):this.modalInstance=this.$modal.open({templateUrl:"Common/views/please-wait.html",windowClass:"please-wait-window",backdrop:"static",keyboard:!1,controller:"PleaseWaitCtrl",resolve:{data:function(){return{determinate:b}}}})},a.prototype.hide=function(){var a;return null!=(a=this.modalInstance)&&a.close(),this.modalInstance=null},a}(),a.$inject=["$modal","eventBus"],angular.module("galleon").service("pleaseWaitService",a)}.call(this),function(){"use strict";var a;a=function(){function a(){this.assets={}}return a.prototype.addAsset=function(a,b){if(null==this.assets[a])return this.assets[a]=b?b:a},a.prototype.hasAsset=function(a){return null!=this.assets[a]},a.prototype.isEmpty=function(){var a,b,c;c=this.assets;for(a in c)return b=c[a],!1;return!0},a.prototype.enumAssets=function(){var a,b,c,d;b=[],d=this.assets;for(a in d)c=d[a],b.push(a);return b},a.prototype.getAsset=function(a){return this.assets[a]},a.prototype.reset=function(){return this.assets={}},a}(),a.$inject=[],angular.module("galleon").service("storytellingAssetRegistry",a)}.call(this),function(){var a;a=function(){function a(){}return a.prototype.calc=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s;return h=b[0],o=b[1],l=c[0],m=c[1],k=i=j=p=q=0,(null!=h?h.isCover():void 0)&&d&&(q=e.sizeForPageAndSize(d,a).width),f=a.width-q,k=(null!=o?o.isStockCover:void 0)||(null!=h?h.isSpread():void 0)?f:f/2,(null!=h&&null!=(r=h.layout)?r.height:void 0)?(i=e.sizeForPageAndSize(h,{width:k,height:a.height}).height,j=i):(null!=o&&null!=(s=o.layout)?s.height:void 0)&&(i=e.sizeForPageAndSize(o,{width:k,height:a.height}).height,j=i),(null!=h?h.isCover():void 0)&&d&&(g=l,g.isSpread()&&(g=m),n={width:a.width/2,height:a.height},j=e.sizeForPageAndSize(g,n).height,p=e.sizeForPageAndSize(d,{width:k,height:i}).width),{pageWidth:k,pageHeight:i,pageHeightSansSpine:j,spineWidth:p}},a}(),angular.module("galleon-pb").service("pageDimensionCalculator",a)}.call(this),function(){var a;a=function(){function a(){}return a.prototype.calc=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p;return m=b[0],f=b[1],j=g=h=k=l=0,null==f||null==m||null==(null!=(n=f.layout)?n.width:void 0)&&null==(null!=(o=m.layout)?o.width:void 0)?{}:(g=a.height-55,i=(null!=m&&null!=(p=m.layout)?p.width:void 0)?m:f,g=g>a.width?a.width:g,j=e.sizeForPageAndSize(i,{width:a.width,height:g}).width,(null!=i?i.layout.width:void 0)>(null!=i?i.layout.height:void 0)&&(g=j/((null!=i?i.layout.width:void 0)/(null!=i?i.layout.height:void 0))),h=g,{pageWidth:j,pageHeight:g,pageHeightSansSpine:h,spineWidth:k})},a}(),angular.module("galleon-gc").service("pageDimensionCalculator",a)}.call(this),function(){var a;a=function(){function a(){}return a.prototype.calc=function(a,b,c,d,e){var f,g,h,i,j,k,l;return f=b[0],i=g=h=j=k=0,i=a.width,(null!=f&&null!=(l=f.layout)?l.height:void 0)&&(g=e.sizeForPageAndSize(f,{width:i,height:a.height}).height,h=g),{pageWidth:i,pageHeight:g,pageHeightSansSpine:h,spineWidth:j}},a}(),angular.module("galleon-ss").service("pageDimensionCalculator",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.$window=a,this.URLUtil=b}return a.prototype.connectCallback=function(a){var b,c;return null!=(b=a.contentWindow)&&null!=(c=b.dojo)?c.query(".style-container").connect("click",function(){var b,c,d,e,f,g,h,i,j;return b=this.URLUtil.explodeQueryString(a.contentWindow.sflyWindowMgr.windows.quickViewWindow.iframe.src),null!=(c=a.contentWindow)&&null!=(d=c.sflyWindowMgr)&&null!=(e=d.windows)&&null!=(f=e.quickViewWindow)&&f.setUrl(""),null!=(g=a.contentWindow)&&null!=(h=g.sflyWindowMgr)&&null!=(i=h.windows)&&null!=(j=i.quickViewWindow)&&j.hide(),this.$window.updateStyle({styleId:b.id,styleVersion:b.versionId})}):void 0},a}(),a.$inject="$window urlUtil".split(" "),angular.module("galleon-pb").service("productSpecificFrameLoadedInjector",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.$window=a,this.$interval=b}return a.prototype.connectCallback=function(a,b){var c;return null!=(null!=(c=a.contentWindow)?c.CALENDAR_STYLE_STORE_CONFIG:void 0)?void this._runBogusPreReleaseMixedModeCalendarStoreInit(a,b):(this.$interval.cancel(this.storeCheck),this.storeCheck=this.$interval(function(c){return function(){var d;if(d=c._externalStyleStoreActionsAvailable(a),null!=d)return c.$interval.cancel(c.storeCheck),c._setStoreActions(d,b)}}(this),100,100))},a.prototype._runBogusPreReleaseMixedModeCalendarStoreInit=function(a,b){
var c,d,e,f;return null!=b&&null!=(c=a.contentWindow)&&null!=(d=c.CALENDAR_STYLE_STORE_CONFIG)&&(d.selectedStyleId=parseInt(b,10)),null!=(e=a.contentWindow)&&null!=(f=e.CALENDAR_STYLE_STORE_CONFIG)?f.onStyleSelected=function(a){return function(b){return a.$window.updateStyle({styleId:b.styleId,styleVersion:b.styleVersion})}}(this):void 0},a.prototype._setStoreActions=function(a,b){return a.setSelectedStyleId(parseInt(b,10)),a.setSelectedStyleHandler(function(a){return function(b){return a.$window.updateStyle({styleId:b.styleId,styleVersion:b.styleVersion})}}(this))},a.prototype._externalStyleStoreActionsAvailable=function(a){var b,c,d;if(b=null!=(c=a.contentWindow)&&null!=(d=c.CM_CALENDAR_STYLE_STORE)?d.externalActions:void 0,"function"==typeof(null!=b?b.setSelectedStyleHandler:void 0)&&"function"==typeof(null!=b?b.setSelectedStyleId:void 0))return b},a}(),a.$inject="$window $interval".split(" "),angular.module("galleon-gc").service("productSpecificFrameLoadedInjector",a)}.call(this),function(){var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};b=function(){function a(a,b,c){this.$http=a,this.$timeout=b,this.config=c,"Internet Explorer"===bowser.name?this.runIERequest():this.runRequest()}return a.prototype.success=function(a){return this.successCallback=a,this},a.prototype.error=function(a){return this.errorCallback=a,this},a.prototype.runRequest=function(){return this.$http(this.config).success(function(a){return function(b,c,d,e){return"function"==typeof a.successCallback?a.successCallback(b,c,d,e):void 0}}(this)).error(function(a){return function(b,c,d,e){return"function"==typeof a.errorCallback?a.errorCallback(b,c,d,e):void 0}}(this)),this},a.prototype.runIERequest=function(){var a,b,c,d;if(c=new XMLHttpRequest,c.open(this.config.method,this.config.url),this.config.headers){d=this.config.headers;for(a in d)b=d[a],c.setRequestHeader(a,b)}return c.onreadystatechange=function(a){return function(){var b,d;if(4===c.readyState){if(200!==(d=c.status)&&204!==d&&304!==d)return"function"==typeof a.errorCallback?a.errorCallback(c.responseText,c.status,a._getResponseHeaders(c),a.config):void 0;try{b=JSON.parse(c.responseText)}catch(a){b=c.responseText}return"function"==typeof a.successCallback?a.successCallback(b,c.status,a._getResponseHeaders(c),a.config):void 0}}}(this),c.onprogress=function(){},c.ontimeout=function(){},c.onerror=function(){},this.$timeout(function(a){return function(){return c.send(JSON.stringify(a.config.data))}}(this),0),this},a.prototype._getResponseHeaders=function(a){var b,c,d,e,f,g,h,i,j,k;if(d=a.getAllResponseHeaders(),e={},!d)return e;for(c=d.split("\r\n"),f=j=0,k=c.length;j<k;f=j+=1)b=c[f],g=b.indexOf(": "),g>0&&(h=b.substring(0,g),i=b.substring(g+2),e[h]=i);return e},a}(),a=function(){function a(a,b){return this.$http=a,this.$timeout=b,this.init=c(this.init,this),this.init}return a.prototype.init=function(a){return new b(this.$http,this.$timeout,a)},a}(),a.$inject=["$http","$timeout"],angular.module("galleon").service("httpService",a)}.call(this),function(){var a,b,c,d=function(a,b){return function(){return a.apply(b,arguments)}};a=3,b=function(){function b(a,b,c){this.asset=a,this.warningUtil=b,this.$translate=c,this._validateAsset=d(this._validateAsset,this),this._imageAssignment=d(this._imageAssignment,this),this._imageCrop=d(this._imageCrop,this),this._handleWarningClick=d(this._handleWarningClick,this)}return b.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.scope.imageWarningStyle={display:"none",position:"absolute"},this.scope.tooltip="",this.scope.$watch(this._imageCrop,this._validateAsset),this.scope.$watch(this._imageAssignment,this._validateAsset),this.element.addClass("asset-warning"),this.scope.onWarningClick=this._handleWarningClick,this},b.prototype._handleWarningClick=function(){return setTimeout(function(a){return function(){return a.scope.tooltip=""}}(this),2e3)},b.prototype._imageCrop=function(){return null==this.asset?null:""+this.asset.imageAssignmentLlx+","+this.asset.imageAssignmentLly+","+(""+this.asset.imageAssignmentUrx+","+this.asset.imageAssignmentUry)},b.prototype._imageAssignment=function(){var a,b;return null!=(a=this.asset)&&null!=(b=a.imageAssignment)?b.projectImageId:void 0},b.prototype._validateAsset=function(){var b,c,d,e,f;if(b="none",null!=this.asset&&(d=this.warningUtil.findImageErrors(this.asset),d.length>0)){for(b="block",e=0,f=d.length;e<f;e++)c=d[e],this.scope.tooltip=""+this.$translate(c.message)+" ";this.scope.imageWarningStyle.left=Math.max(0,-this.asset.asset.containerXOffset)+a,this.scope.imageWarningStyle.top=Math.max(0,-this.asset.asset.containerYOffset)+a}return this.scope.imageWarningStyle.display=b},b}(),c=function(a,c,d){var e,f,g;return g="mouseenter",e="",d.isDeviceATablet()&&(g="click",e="onWarningClick()"),f={restrict:"E",template:"<div class='icon-warning-2pv-larger'\n  data-test-key='image-asset-warning'\n  ng-style='imageWarningStyle'\n  tooltip='{{tooltip}}'\n  tooltip-append-to-body=\"true\"\n  tooltip-trigger="+g+"\n  ng-click="+e+">\n</div>",scope:{asset:"="},transclude:!1,link:function(d,e,f){var g;return g=new b(d.asset,a,c),g.link(d,e,f)}}},c.$inject=["warningUtil","$translate","deviceDetectionService"],angular.module("galleon").directive("sfImageAssetWarning",c)}.call(this),function(){var a,b,c,d=function(a,b){return function(){return a.apply(b,arguments)}};a=3,b=function(){function b(a,b,c,e){this.asset=a,this.page=b,this.warningUtil=c,this.$translate=e,this._validateAsset=d(this._validateAsset,this),this._hasTextOverflow=d(this._hasTextOverflow,this),this._hasContent=d(this._hasContent,this),this._handleWarningClick=d(this._handleWarningClick,this)}return b.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.scope.textWarningStyle={display:"none",position:"absolute"},this.scope.tooltip="",this.scope.$watch(this._hasTextOverflow,this._validateAsset),this.scope.$watch(this._hasContent,this._validateAsset),this.element.addClass("asset-warning"),this.scope.onWarningClick=this._handleWarningClick,this},b.prototype._handleWarningClick=function(){return setTimeout(function(a){return function(){return a.scope.tooltip=""}}(this),2e3)},b.prototype._hasContent=function(){return this.asset.hasContent()},b.prototype._hasTextOverflow=function(){return this.asset.hasTextOverflow},b.prototype._validateAsset=function(){var b,c,d,e,f;if(b="none",this.scope.tooltip="",null!=this.asset&&(d=this.warningUtil.findTextErrors(this.asset,this.page),d.length>0)){for(b="block",e=0,f=d.length;e<f;e++)c=d[e],this.scope.tooltip+=""+this.$translate(c.message)+"\n";this.scope.textWarningStyle.left=Math.max(0,-this.asset.asset.containerXOffset)+a,this.scope.textWarningStyle.top=Math.max(0,-this.asset.asset.containerYOffset)+a}return this.scope.textWarningStyle.display=b},b}(),c=function(a,c,d){var e,f,g;return g="mouseenter",e="",d.isDeviceATablet()&&(g="click",e="onWarningClick()"),f={restrict:"E",template:"<div class='icon-warning-2pv-larger'\n  data-test-key='text-asset-warning'\n  ng-style='textWarningStyle'\n  tooltip='{{tooltip}}'\n  tooltip-append-to-body=\"true\"\n  tooltip-trigger="+g+"\n  ng-click="+e+">\n</div>",scope:{asset:"=",page:"="},transclude:!1,link:function(d,e,f){var g;return g=new b(d.asset,d.page,a,c),g.link(d,e,f)}}},c.$inject=["warningUtil","$translate","deviceDetectionService"],angular.module("galleon").directive("sfTextAssetWarning",c)}.call(this),function(){var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b){this.warningUtil=a,this.$translate=b,this._validateAsset=c(this._validateAsset,this),this._textInfo=c(this._textInfo,this),this._imageInfo=c(this._imageInfo,this),this._layout=c(this._layout,this)}return a.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.scope.pageWarningStyle={display:"none"},this.scope.tooltip="",this.element.addClass("asset-warning"),this.scope.$watch(this._layout,this._validateAsset),this.scope.$watch(this._imageInfo,this._validateAsset),this.scope.$watch(this._textInfo,this._validateAsset),this},a.prototype._page=function(){return this.scope.page},a.prototype._layout=function(){var a;return null!=(a=this.scope.page)?a.layout:void 0},a.prototype._imageInfo=function(){var a,b,c,d,e;if(null==this._page())return null;for(b="",e=this._page().getImages(),c=0,d=e.length;c<d;c++)a=e[c],b+=this._collectImageInfo(a);return b},a.prototype._collectImageInfo=function(a){return"id|"+a.imageAssignment.projectImageId+"|"+("crop|"+a.imageAssignmentLlx+","+a.imageAssignmentLly+",")+(""+a.imageAssignmentUrx+","+a.imageAssignmentUry)},a.prototype._textInfo=function(){var a,b,c,d,e;if(null==this._page())return null;for(a="",e=this._page().getText(),c=0,d=e.length;c<d;c++)b=e[c],a+=b.hasTextOverflow?"t":"f",a+="pos|"+b.asset.xOffset+","+b.asset.yOffset+(","+b.asset.width+","+b.asset.height+","+b.asset.rotation);return a},a.prototype._validateAsset=function(){var a;return a="none",this.warningUtil.hasPageErrors(this._page())&&(a="block",this.scope.tooltip=this.$translate("SilverApp.pageWarningTooltip")),this.scope.pageWarningStyle.display=a},a}(),b=function(b,c){return{restrict:"E",template:"<div class='icon-warning-page'\n  ng-style='pageWarningStyle'\n  tooltip='{{tooltip}}'\n  tooltip-placement=\"top\"\n  tooltip-append-to-body=\"true\">\n</div>",scope:{page:"="},transclude:!1,link:function(d,e,f){var g;return g=new a(b,c),g.link(d,e,f)}}},b.$inject=["warningUtil","$translate"],angular.module("galleon").directive("sfPageWarning",b)}.call(this),function(){var a,b,c,d=function(a,b){return function(){return a.apply(b,arguments)}};c=[],a=function(){function a(a,b,c,e,f,g,h,i){this.$q=a,this.$http=b,this.$window=c,this.projectService=e,this.touchService=g,this.$rootScope=h,this.deviceDetectionService=i,this._dispatchDragEvent=d(this._dispatchDragEvent,this),this._dispatchTouchEvent=d(this._dispatchTouchEvent,this),this._dispatchMouseEvent=d(this._dispatchMouseEvent,this),this._getElementFromPosition=d(this._getElementFromPosition,this),this._dispatchMouseLeaveEvent=d(this._dispatchMouseLeaveEvent,this),this._dispatchMouseOverEvent=d(this._dispatchMouseOverEvent,this),this._findTargetAndDispatchEvent=d(this._findTargetAndDispatchEvent,this),this._isRepeatedEvent=d(this._isRepeatedEvent,this),this._mouseActionListener=d(this._mouseActionListener,this),this._mouseMoveListener=d(this._mouseMoveListener,this),this._mouseOutListener=d(this._mouseOutListener,this),this.log=f.newInstance("HollowEmbellishment")}return a.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.asset=this._assetObject(),this.asset?(this.scale=this.scope.$eval(this.attrs.scale),this.isHollow=this.scope.$eval(this.attrs.sfHollowEmbellishment),this.isHollow?(this.$body=$(this.$window.document.body),this._nativeElement=this.element[0],this._asset=this.element.closest(".asset-wrapper")[0],this._canvas=this.$window.document.createElement("canvas"),this._canvas.setAttribute("height",this.asset.asset.height),this._canvas.setAttribute("width",this.asset.asset.width),this._ctx=this._canvas.getContext("2d"),this._eventTarget=null,this._hoverTarget=null,this._prevEventMousePos={},this._prevEventType=null,this._addImageToCanvas(),this._nativeElement.addEventListener("mouseout",this._mouseOutListener,!0),this._nativeElement.addEventListener("mouseleave",this._mouseOutListener,!0),this._nativeElement.addEventListener("mousemove",this._mouseMoveListener,!0),this._nativeElement.addEventListener("touchmove",this._mouseActionListener,!0),this._nativeElement.addEventListener("click",this._mouseActionListener,!0),this._nativeElement.addEventListener("touchstart",this._mouseActionListener,!0),this._nativeElement.addEventListener("dblclick",this._mouseActionListener,!0),this._nativeElement.addEventListener("dragstart",this._mouseActionListener,!1),this._nativeElement.addEventListener("dragover",this._mouseActionListener,!0),this._nativeElement.addEventListener("dragenter",this._mouseActionListener,!0),this._nativeElement.addEventListener("dragleave",this._mouseActionListener,!0),this._nativeElement.addEventListener("drop",this._mouseActionListener,!0),this._nativeElement.addEventListener("touchend",this._mouseActionListener,!0),this.element.on("$destroy",function(a){return function(){return a._nativeElement.removeEventListener("mouseout",a._mouseOutListener,!0),a._nativeElement.removeEventListener("mouseleave",a._mouseOutListener,!0),a._nativeElement.removeEventListener("mousemove",a._mouseMoveListener,!0),a._nativeElement.removeEventListener("click",a._mouseActionListener,!0),a._nativeElement.removeEventListener("dblclick",a._mouseActionListener,!0),a._nativeElement.removeEventListener("dragstart",a._mouseActionListener,!1),a._nativeElement.removeEventListener("dragover",a._mouseActionListener,!0),a._nativeElement.removeEventListener("dragenter",a._mouseActionListener,!0),a._nativeElement.removeEventListener("dragleave",a._mouseActionListener,!0),a._nativeElement.removeEventListener("drop",a._mouseActionListener,!0),a._nativeElement.removeEventListener("touchend",a._mouseActionListener,!0),a._nativeElement.removeEventListener("touchmove",a._mouseActionListener,!0),a._nativeElement.removeEventListener("touchstart",a._mouseActionListener,!0)}}(this)),this):this):this},a.prototype._mouseOutListener=function(a){return this._dispatchMouseLeaveEvent(a)},a.prototype._mouseMoveListener=function(a){var b;return b=this._isTransparent(a),this._findTargetAndDispatchEvent(a,b),this._nativeElement.draggable=b},a.prototype._mouseActionListener=function(a){var b,c,d,e;if("dragenter"!==a.type&&"dragover"!==a.type||a.preventDefault(),a.detail&&(c=a.detail.clientX,d=a.detail.clientY,b=a.detail.dataTransfer),"touchstart"!==a.type&&"touchend"!==a.type&&"touchmove"!==a.type||(e=a.changedTouches[0],c=e.clientX,d=e.clientY,b={}),a.clientX=c,a.clientY=d,a.dataTransfer=b||{},a.clientX&&!this._isRepeatedEvent(a))return this._findTargetAndDispatchEvent(a,this._isTransparent(a))},a.prototype._isRepeatedEvent=function(a,b){var c;return c=a.type===this._prevEventType&&this._prevEventMousePos.x===a.clientX&&this._prevEventMousePos.y===a.clientY,this._prevEventType=a.type,this._prevEventMousePos={x:a.clientX,y:a.clientY},c&&a.preventDefault(),c},a.prototype._findTargetAndDispatchEvent=function(a,b){var d,e,f,g,h,i,j;if(h=this._asset,b){if(j=this.projectService.currentProject.product,e=this.scope.$eval(this.attrs.dropOptions),i=j.pageBySurfaceNumber(e.pageNumber),null==i)return;for(;b&&c.length<=50;)this._assetHide($(h).closest(".asset-container")[0]),h=this._getElementFromPosition(a.clientX,a.clientY),d=h.getAttribute("data-assetIndex"),g=i.layout.assets[d],b=(null!=g?g.isHollow:void 0)||h.hasAttribute("ng-switch-when")||h.hasAttribute("ng-switch")}else h=this.element.closest(".page-content").find(".background-drop-target")[0];return f=this._dispatchMouseEvent,"touchstart"!==a.type&&"touchend"!==a.type&&"touchmove"!==a.type||(f=this._dispatchTouchEvent),(a.type.indexOf("drag")>-1||"drop"===a.type)&&(f=this._dispatchDragEvent),"mousemove"===a.type&&(f=this._dispatchMouseOverEvent),this._dispatchMouseLeaveEvent(a),this._eventTarget=h,f(a,a.type,this._eventTarget),this._assetShow()},a.prototype._dispatchMouseOverEvent=function(a){if(null!=this._eventTarget)return this._isTransparent(a)?(this.$body.removeClass("hollow-embellishment-cursor-auto"),this.$body.addClass("hollow-embellishment-cursor-pointer")):(this.$body.removeClass("hollow-embellishment-cursor-pointer"),this.$body.addClass("hollow-embellishment-cursor-auto")),this._eventTarget.hasAttribute("data-attach-asset")||!this._eventTarget.hasAttribute("data-hoverable")?($(this._eventTarget).trigger("mouseenter"),this._addHoverToTarget(this._eventTarget)):(this._clearHoverFromTarget(),"IMG"===this._eventTarget.nodeName&&this._eventTarget.className.indexOf("has-assigned-image")===-1?(this.$body.removeClass("hollow-embellishment-cursor-pointer"),this.$body.addClass("hollow-embellishment-cursor-auto")):"IMG"===this._eventTarget.nodeName&&this._eventTarget.className.indexOf("has-assigned-image")!==-1&&this._dispatchMouseEvent(a,"mouseenter",this._eventTarget),this._dispatchMouseEvent(a,"mouseover",this._eventTarget))},a.prototype._dispatchMouseLeaveEvent=function(a){if(this.$body.removeClass("hollow-embellishment-cursor-pointer"),this.$body.addClass("hollow-embellishment-cursor-auto"),this._eventTarget)return a.type.indexOf("drag")>-1?this._dispatchDragEvent(a,"dragleave",this._eventTarget):(this._clearHoverFromTarget(),this._dispatchMouseEvent(a,"mouseleave",this._eventTarget),$(this._eventTarget).trigger("mouseleave")),this._eventTarget=null},a.prototype._getElementFromPosition=function(a,b){return this.$window.document.elementFromPoint(a,b)},a.prototype._isTransparent=function(a){var b,c;return c=this._getMousePos(a),b=this._ctx.getImageData(c.x,c.y,1,1),0===b.data[3]},a.prototype._dispatchMouseEvent=function(a,b,c){var d,e;if(c){if(this.$window.document.documentMode)e=this.$window.document.createEvent("MouseEvents"),e.initMouseEvent(b,!0,!0,this.$window,1,0,0,a.clientX,a.clientY,!1,!1,!1,!1,0,null);else try{e=new MouseEvent(b,{clientX:a.clientX,clientY:a.clientY})}catch(c){d=c,e=new Event(b,{clientX:a.clientX,clientY:a.clientY})}return e.customAttr={reason:"hollow-dispatch"},c.dispatchEvent(e),this.deviceDetectionService.isDeviceATablet()||this.deviceDetectionService.isDeviceAPhone()?this._dispatchAssetTapEvent(e,c):void 0}},a.prototype._dispatchTouchEvent=function(a,b,c){var d,e,f,g,h,i;if(c)return h=this.$window.document.createTouch(this.$window,c,0,a.changedTouches[0].pageX,a.changedTouches[0].pageY,a.changedTouches[0].screenX,a.changedTouches[0].screenY),i=this.$window.document.createTouchList(h),g=this.$window.document.createTouchList(h),d=this.$window.document.createTouchList(h),this.deviceDetectionService.isDeviceAnIpad()?(e=this.$window.document.createEvent("TouchEvent"),e.initTouchEvent(b,!0,!0,this.$window,null,a.changedTouches[0].screenX,a.changedTouches[0].screenY,a.changedTouches[0].pageX,a.changedTouches[0].pageY,!1,!1,!1,!1,i,g,d,1,0)):(f={changedTouches:d,touches:i,targetTouches:g},e=new TouchEvent(b,f)),"touchmove"===b?this.touchService.pressTimer?this.touchService.touchCancelTimer():this.scope.$apply(function(a){return function(){var b;return b=a.touchService.touchMove(e),a.$rootScope.$broadcast("assetdrag:move",b),a.moving=!0}}(this)):"touchend"===b&&this.moving?this.scope.$apply(function(a){return function(){var b;return a.touchService.touchEndElement(),b=a.touchService.touchEnd(e),a.$rootScope.$broadcast("assetdrag:end",b),a.moving=!1}}(this)):(this.moving=!1,c.dispatchEvent(e))},a.prototype._dispatchAssetTapEvent=function(a,b){var c;if(null!=b)return c={dataTransfer:a.dataTransfer,clientX:a.clientX,clientY:a.clientY},b.dispatchEvent(new CustomEvent("assettap",{detail:c}))},a.prototype._dispatchDragEvent=function(a,b,c){var d,e;if(c)return d={dataTransfer:a.dataTransfer,clientX:a.clientX,clientY:a.clientY},this.$window.document.documentMode?(e=this.$window.document.createEvent("DragEvent"),e.initDragEvent(b,!0,!0,this.$window,1,0,0,a.clientX,a.clientY,!1,!1,!1,!1,0,null,a.dataTransfer)):e=new CustomEvent(b,{detail:d}),"drop"===b&&(a.preventDefault(),a.stopImmediatePropagation()),c.dispatchEvent(e)},a.prototype._addHoverToTarget=function(a){return $(a).addClass("hover"),this._hoverTarget=a},a.prototype._clearHoverFromTarget=function(){if(this._hoverTarget)return $(this._hoverTarget).removeClass("hover"),this._hoverTarget=null},a.prototype._addImageToCanvas=function(){return this._readImage().then(function(a){return function(b){var c;return c=new Image,c.onload=function(){return a.$window.fastdom.write(function(){return a._ctx.drawImage(c,0,0,a.asset.asset.width,a.asset.asset.height),a.$window.URL.revokeObjectURL(b),c.onload=null})},c.src=b}}(this))},a.prototype._readImage=function(){var a,b;return b=this.$q.defer(),a="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",null==this.asset.sourceUrl?(this.log.warn("No sourceUrl on asset assetType, "+this.asset.asset.assetType),b.reject(a),b.promise):(this.$http({method:"GET",url:this.asset.sourceUrl,responseType:"blob"}).success(function(a){return function(c,d,e,f){var g,h;return g=(a.$window.URL||a.$window.webkitURL).createObjectURL,h=g(c),b.resolve(h)}}(this)).error(function(c,d,e,f){return b.reject(a)}),b.promise)},a.prototype._getMousePos=function(a){var b;return b=this._nativeElement.getBoundingClientRect(),{x:(a.clientX-b.left)/this.scale,y:(a.clientY-b.top)/this.scale}},a.prototype._assetHide=function(a){return null==a&&(a=this._asset),a.style.visibility="hidden",c.push(a)},a.prototype._assetShow=function(){var a,b,d;for(b=0,d=c.length;b<d;b++)a=c[b],a.style.visibility="visible";return c=[]},a.prototype._assetObject=function(){var a,b,c,d,e,f;if(null!=(null!=(e=this.attrs)?e.asset:void 0))return this.scope.$eval(this.attrs.asset);if(null!=(null!=(f=this.attrs)?f.dropOptions:void 0))return a=parseInt(this.attrs.assetindex,10),b=this.projectService.currentProject.product,c=this.scope.$eval(this.attrs.dropOptions),d=b.pageBySurfaceNumber(c.pageNumber),d?d.layout.assets[a]:null},a}(),b=function(b,c,d,e,f,g,h,i){return{restrict:"A",link:function(j,k,l){var m;return m=new a(b,c,d,e,f,g,h,i),m.link(j,k,l)}}},b.$inject=["$q","$http","$window","projectService","loggerFactory","touchService","$rootScope","deviceDetectionService"],angular.module("galleon").directive("sfHollowEmbellishment",b)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b,d){this.$document=a,this.appState=b,this.projectService=d,this._handleDeleteClick=c(this._handleDeleteClick,this),this._handleMouseLeave=c(this._handleMouseLeave,this),this._handleMouseOver=c(this._handleMouseOver,this),this.activePageElement=void 0,this.activeAsset=void 0,this.activeSurface=void 0,this.activeDeleteButton=void 0}return a.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.scope.directive=this,this.nativeElement=this.element[0],this.nativeElement.addEventListener("mouseover",this._handleMouseOver,!0),this.nativeElement.addEventListener("mouseleave",this._handleMouseLeave,!0),this.scope.$on("$destroy",function(a){return function(){return a.nativeElement.removeEventListener("mouseover",a._handleMouseOver,!0),a.nativeElement.removeEventListener("mouseleave",a._handleMouseLeave,!0)}}(this))},a.prototype._handleMouseOver=function(a){var b;return this.appState.hideTooltips(),null!=(b=this.activeDeleteButton)&&b.toggleClass("hover",a.target===this.activeDeleteButton[0]),this._handleEvent("_handleOver_",a,a.target)},a.prototype._handleMouseLeave=function(a){if(null==this.activePageElement||!this.activePageElement[0].contains(a.target))return this._destroyHoverState()},a.prototype._handleEvent=function(a,b,c){var d,e;if(null!=(null!=c?c.getAttribute("data-assetType"):void 0))return d=c.getAttribute("data-assetType"),e=""+a+d,"function"==typeof this[e]?this[e](b,c):this._destroyHoverState()},a.prototype._handleOver_graphic=function(a,b){var c,d,e,f,g;return"true"!==b.getAttribute("sf-hollow-embellishment")?void this._destroyHoverState():(d=b.parentNode.parentNode,d.style.visibility="hidden",c=this._globalRect(b.getBoundingClientRect()),f=c.left+c.width/2,g=c.top+c.height/2,e=this.$document[0].elementFromPoint(f,g),d.style.visibility="visible",null==e?void this._destroyHoverState():this._handleEvent("_handleOver_",a,e))},a.prototype._handleOver_image=function(a,b){var c,d,e;if(null!=(null!=b?b.getAttribute("data-imageKey"):void 0))return this._fetchOperationPayload(b),this.activePageElement=this._activePageElement(b),null!=(d=this.activePageElement)&&d.addClass("page-hovered"),c=b.getAttribute("data-imageKey"),null!=(e=this.activeDeleteButton)&&e.removeClass("active"),this.activeDeleteButton=this.element.find("div[data-imageReference="+c+"]"),this.activeDeleteButton.addClass("active"),this.activeDeleteButton.on("click",this._handleDeleteClick)},a.prototype._handleDeleteClick=function(){var a;if(null!=this.activeSurface&&null!=this.activeAsset)return"function"==typeof(a=this.scope).onRemoveImage&&a.onRemoveImage({page:this.activeSurface,asset:this.activeAsset}),this._destroyHoverState()},a.prototype._destroyHoverState=function(){var a,b,c;return this.appState.hideTooltips(),null!=(a=this.activeDeleteButton)&&a.off("click"),null!=(b=this.activeDeleteButton)&&b.removeClass("active"),null!=(c=this.activePageElement)&&c.removeClass("page-hovered"),this.activePageElement=void 0,this.activeAsset=void 0,this.activeSurface=void 0,this.activeDeleteButton=void 0},a.prototype._activePageElement=function(a){var b;for(b=a;null!=(null!=b?b.className:void 0)&&b.className.indexOf("page-content")===-1&&null!=b.parentNode;)b=b.parentNode;return angular.element(b.parentNode)},a.prototype._globalRect=function(a){var b,c,d,e;return b=this.$document[0].body.getBoundingClientRect(),e=a.top-b.top,c=a.left-b.left,d={top:e,left:c,width:a.width,height:a.height,right:c+a.width,bottom:e+a.height}},a.prototype._fetchOperationPayload=function(a){var b,c;return c=this.scope.$eval(a.getAttribute("drop-options")),this.activeSurface=this.projectService.currentProject.product.pageBySurfaceNumber(c.pageNumber),b=parseInt(a.getAttribute("data-assetIndex"),10),this.activeAsset=this.activeSurface.layout.assets[b]},a}(),b=function(b,c,d){return{scope:{onRemoveImage:"&"},link:function(e,f,g){return new a(b,c,d).link(e,f,g)}}},b.$inject=["$document","appState","projectService"],angular.module("galleon").directive("sfEditableAssetHandler",b)}.call(this),function(){var a;a=function(){function a(a,b,c,d){this.ModelInitializer=a,this.pageFactory=b,this.adaptiveLayout=d.adaptiveLib,this.stockCoverTypes=[c.CoverType.STOCK_CLOTH,c.CoverType.STOCK_LEATHER,c.CoverType.STOCK_LINEN,c.CoverType.STOCK_LIZARD,c.CoverType.STOCK_CROCODILE],this.premiumCoverTypes=[c.CoverType.STOCK_PREMIUM,c.CoverType.STOCK_SILK]}var b;return a.COVER_TYPE_USER_CUSTOM="USER_CUSTOM",a.COVER_TYPE_USER_CUSTOM_SOFT="USER_CUSTOM_SOFT",b=["coverSpecID","stockCoverSpecID","sku","binding","compositionTemplateLayoutName","compositionTemplateLayoutVersion","thumbnailCompositionTemplateLayoutName","thumbnailCompositionTemplateLayoutVersion"],a.prototype.init=function(a){return this.values=a,this._cachedBackPage=null,this._cachedFrontPage=null,this._cachedSpinePage=null,this.ModelInitializer.initialize(this,this.values,b),this.cacheCoverData(),this},a._sfgetter("frontPage",function(){return null!=this._cachedFrontPage?this._cachedFrontPage:(this._cachedFrontPage=this.pageFactory.newInstance(this.values.frontPage,!1),this._cachedFrontPage)}),a._sfgetter("spinePage",function(){return null!=this._cachedSpinePage?this._cachedSpinePage:this._cachedSpinePage=this.pageFactory.newInstance(this.values.spinePage,!1)}),a._sfgetter("backPage",function(){return null!=this._cachedBackPage?this._cachedBackPage:this._cachedBackPage=this.pageFactory.newInstance(this.values.backPage,!1)}),a._sfgetter("variant",function(){return this.values.variant}),a._sfsetter("variant",function(a){return this.ModelInitializer.isType(a,"string","cover.variant")?null!=a?this.values.variant=a:void 0:delete this.values.variant}),a.prototype.applyPageValuesObj=function(a,b){var c,d,e;return e=function(){switch(a){case this.pageFactory.Page.FRONT_COVER_PAGE_NUMBER:return["frontPage",this.frontPage];case this.pageFactory.Page.SPINE_PAGE_NUMBER:return["spinePage",this.spinePage];case this.pageFactory.Page.BACK_COVER_PAGE_NUMBER:return["backPage",this.backPage]}}.call(this),d=e[0],c=e[1],this.values[d]=b,c.init(b)},a.prototype.hasFilledPages=function(){return[this.frontPage,this.backPage,this.spinePage].some(function(a){return!a.isAutofillable()})},a.prototype.isSoftCover=function(){return this.coverSpecID.toLowerCase().indexOf("soft")>=0},a.prototype.isHardCover=function(){return this.coverSpecID.toLowerCase().indexOf("hard")>=0},a.prototype.getCoverType=function(){var a,b,c,d;return a=null!=(b=this.adaptiveLayout)&&null!=(c=b.globalContent)&&"function"==typeof c.getCover?c.getCover(this.coverSpecID):void 0,null!=(d=null!=a?a.coverType:void 0)?d:void 0},a.prototype.hasLayflatBinding=function(){return"layflat"===this.binding},a.prototype.hasHingedLayflatBinding=function(){return"hinged"===this.binding},a.prototype.hasLooseleafBinding=function(){return null==this.binding||"looseleaf"===this.binding},a.prototype.isKeepsakePocketApplicable=function(){return!this.isSoftCover()},a.prototype.cacheCoverData=function(){var a;return a=this.getCoverType(),this.isStockCover=this.stockCoverTypes.indexOf(a)>=0||this.premiumCoverTypes.indexOf(a)>=0,this.isPremiumCover=this.premiumCoverTypes.indexOf(a)>=0},a}(),a.$inject=["modelInitializer","pageFactory","enums","adaptiveLayoutService"],"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("cover",a)}.call(this),function(){angular.module("galleon-gc").value("productModelStrategy",{initProduct:function(a,b){var c,d;return"function"==typeof(c=a.get("calendar")).init?c.init(null!=(d=b.product)?d:b.book):void 0},wrapProject:function(a){return{MatisseCalendarProject:a}},unwrapProject:function(a){return a.MatisseCalendarProject},unwrapProduct:function(a){var b;return null!=a&&null!=(b=a.MatisseCalendarProject)?b.product:void 0},getWrapperName:function(){return"MatisseCalendarProject"},getProductGUID:function(a){return null!=a?a.product.productGUID:void 0},enoughSpreadsLoadedForInit:function(a){return a>=2},clean:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;for(p=a.projectEvents.publicEventDates(),h=0,l=p.length;h<l;h++)c=p[h],e={day:c.getDate(),month:c.getMonth()+1,year:c.getFullYear()},a.product.setEventsOnDate(a.projectEvents.eventsMatchingEventDate(e),c);for(s=null!=(q=a.values)&&null!=(r=q.eventCollection)?r.eventItems:void 0,f=i=0,m=s.length;i<m;f=++i)d=s[f],d.hasOwnProperty("name")&&null!=d.name&&""!==d.name||(d.name="");for(t=a.values.product.pages,j=0,n=t.length;j<n;j++)for(g=t[j],u=g.layout.assets,k=0,o=u.length;k<o;k++)b=u[k],"graphic"===b.assetType&&(b.container.visible="true")}})}.call(this),function(){angular.module("galleon-pb").value("productModelStrategy",{initProduct:function(a,b){var c;return"function"==typeof(c=a.get("book")).init?c.init(b.book):void 0},wrapProject:function(a){return{PhotobookProject:a}},unwrapProject:function(a){return a.PhotobookProject},unwrapProduct:function(a){var b;return null!=a&&null!=(b=a.PhotobookProject)?b.book:void 0},getWrapperName:function(){return"PhotobookProject"},getProductGUID:function(a){return null!=a?a.book.bookGUID:void 0},enoughSpreadsLoadedForInit:function(a){return a>=5},getGUID:function(){return this.getS4()+this.getS4()+"-"+this.getS4()+"-"+this.getS4()+"-"+this.getS4()+"-"+this.getS4()+this.getS4()+this.getS4()},getS4:function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},clean:function(a){var b,c,d,e,f,g,h,i,j;for(null!=a.values.projectGUID&&null==a.values.book.bookGUID&&(a.values.book.bookGUID=this.getGUID()),b=function(a){var b,c,d,e;for(e=a.layout.assets,c=0,d=e.length;c<d;c++)b=e[c],"graphic"===b.assetType&&(b.container.visible="true")},i=a.values.book.pages,e=0,g=i.length;e<g;e++)d=i[e],b(d);for(j=["frontPage","spinePage","backPage"],f=0,h=j.length;f<h;f++)c=j[f],d=a.values.book.cover[c],null!=d&&b(d)}})}.call(this),function(){angular.module("galleon-ss").value("productModelStrategy",{initProduct:function(a,b){var c;return"function"==typeof(c=a.get("book")).init?c.init(b.book):void 0},wrapProject:function(a){return{PhotobookProject:a}},unwrapProject:function(a){return a.PhotobookProject},unwrapProduct:function(a){var b;return null!=a&&null!=(b=a.PhotobookProject)?b.book:void 0},getProductGUID:function(a){return null!=a?a.book.bookGUID:void 0},getWrapperName:function(){return"PhotobookProject"},enoughSpreadsLoadedForInit:function(a){return a>=1},clean:function(a){}
})}.call(this),function(){var a;a=function(){function a(){}return a.prototype.init=function(){},a.prototype.classForGutterShadow=function(a,b){return null==b&&(b=!1),{}},a.prototype.gutterShadowVisible=function(a,b){return!1},a.prototype.hasLayflat=function(){return!1},a.prototype.spreadGutterShadowVisible=function(a,b,c){return!1},a.prototype.parseSurfaceKeyForPage=function(a){var b;if(b=/(\d{4})-([0-9]+)/.exec(a.surfaceKey),(null!=b?b.length:void 0)>2)return{year:parseInt(b[1]),month:parseInt(b[2])}},a}(),angular.module("galleon-gc").service("pageModelStrategy",a)}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(){this.spreadGutterShadowVisible=b(this.spreadGutterShadowVisible,this)}return a.prototype.init=function(a){var b;return this._hasLayflatBinding=null!=(null!=(b=a.cover)?b.binding:void 0)&&"layflat"===a.cover.binding},a.prototype.classForGutterShadow=function(a,b){var c;return null==b&&(b=!1),this._hasLayflatBinding||a.isCover()?"noGutterShadow":(c=["gutterShadowLayer"],b?c.push("gutterInCustomizeMode"):c.push("gutterInEditMode"),a.isSpread()?c.push("spreadPageShadow"):a.isFrontFiller()||a.isEven()?c.push("leftPageShadow"):c.push("rightPageShadow"),c)},a.prototype.hasLayflat=function(){return this._hasLayflatBinding},a.prototype.gutterShadowVisible=function(a,b){return null==a||null==b||!b.isSpread()&&a.isBackground()},a.prototype.spreadGutterShadowVisible=function(a,b,c){return!!b.isSpread()&&(a.isBackground()&&!this._hasLayflatBinding&&c)},a.prototype.parseSurfaceKeyForPage=function(a){},a}(),angular.module("galleon-pb").service("pageModelStrategy",a)}.call(this),function(){var a;a=function(){function a(){}return a.prototype.init=function(){},a.prototype.classForGutterShadow=function(a,b){return null==b&&(b=!1),{}},a.prototype.gutterShadowVisible=function(a,b){return!1},a.prototype.hasLayflat=function(){return!1},a.prototype.spreadGutterShadowVisible=function(a,b,c){return!1},a}(),angular.module("galleon-ss").service("pageModelStrategy",a)}.call(this),function(){var a,b=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};a=function(){function a(a,b,c,d,e,f,g){this.ModelInitializer=a,this.providedCover=b,this.pageFactory=c,this.eventBus=d,this.enums=e,this.pageModelStrategy=f,this.config=g}var c;return a.SIZE_5x7="5x7",a.SIZE_7x9="7x9",a.SIZE_8x8="8x8",a.SIZE_8x11="8x11",a.SIZE_10x10="10x10",a.SIZE_11x14="11x14",a.SIZE_12x12="12x12",a.SIZE_OPTIONS=[a.SIZE_5x7,a.SIZE_7x9,a.SIZE_8x8,a.SIZE_8x11,a.SIZE_10x10,a.SIZE_11x14,a.SIZE_12x12],c=["formFactorID","styleContentVersion","occasionContentId","styleId","occasionContentVersion","subtype","bookStartTime","styleContentId","photobookDustJacket"],a.prototype.init=function(a){var d,e;return this.values=a,this._cachedCover=null,this._cachedPages=null,this._cachedSpreads=null,this._removeLogoPage(),this.ModelInitializer.initialize(this,this.values,c),d=["6x6","8x8","10x10","12x12"],this.aspectRatio=(e=this.sizeId,b.call(d,e)>=0?"square":"rectangle"),this.defaultTitle="My Photo Book","editor"===this.config.defaults.productMode&&(this.defaultTitle="My Collage"),this.pageModelStrategy.init(this.values),this._createFillerPages(),this},a.prototype._removeLogoPage=function(){if(null!=this.values.logoPage)return this.values.logoPage=void 0},a._sfgetter("descriptionId",function(){return this.cover.coverSpecID}),a._sfgetter("sku",function(){return this.cover.sku}),a._sfgetter("guid",function(){return this.values.bookGUID}),a._sfsetter("guid",function(a){if(null===a||this.ModelInitializer.isType(a,"string"))return this.values.bookGUID=a}),a._sfgetter("sizeId",function(){return this.values.bookSizeID}),a._sfsetter("sizeId",function(a){if(this.ModelInitializer.isType(a,"string"))return this.values.bookSizeID=a}),a._sfgetter("numTotalImages",function(){return parseInt(this.values.numTotalImages)}),a._sfsetter("numTotalImages",function(a){if(this.ModelInitializer.isType(a,"number"))return this.values.numTotalImages=a.toString()}),a._sfgetter("cover",function(){return null!=this._cachedCover?this._cachedCover:null!=this.values.cover?this._cachedCover=this.providedCover.init(this.values.cover):this._cachedCover=null}),a._sfgetter("finish",function(){return this._hasAccessory("hasMatteFinish")?this.enums.Finish.MATTE:this._hasAccessory("hasPaddedFinish")?this.enums.Finish.PADDED:void 0}),a.prototype._hasAccessory=function(a){var b,c,d,e,f;if(null!=(null!=(e=this.values.accessories)?e.properties:void 0))for(f=this.values.accessories.properties,c=0,d=f.length;c<d;c++)if(b=f[c],b.key===a&&"true"===b.value)return!0;return!1},a._sfsetter("finish",function(a){switch(a){case this.enums.Finish.MATTE:this._addAccessory("hasMatteFinish"),this._removeAccessory("hasPaddedFinish");break;case this.enums.Finish.PADDED:this._addAccessory("hasPaddedFinish"),this._removeAccessory("hasMatteFinish")}}),a.prototype._addAccessory=function(a){if(!this._hasAccessory(a))return this._guaranteeAccessories().push({key:a,value:"true"})},a.prototype._guaranteeAccessories=function(){return null==this.values.accessories&&(this.values.accessories={}),null==this.values.accessories.properties&&(this.values.accessories.properties=[]),this.values.accessories.properties},a.prototype._removeAccessory=function(a){var b,c;null!=(b=null!=(c=this.values.accessories)?c.properties:void 0)&&(this.values.accessories.properties=b.filter(function(b){return b.key!==a}))},a.prototype.hasPaddedFinish=function(){return this._hasAccessory("hasPaddedFinish")},a.prototype.hasMatteFinish=function(){return this._hasAccessory("hasMatteFinish")},a.prototype.hasGlossyPages=function(){return this._hasAccessory("hasGlossyPages")},a.prototype.hasStandardPages=function(){return null!=this.cover&&!(this.cover.hasLayflatBinding()||this.hasGlossyPages())},a.prototype.hasDustJacket=function(){return null!=this.values.photobookDustJacket},a.prototype.hasKeepsakePocket=function(){return this._hasAccessory("hasKeepsakePocket")},a.prototype.isMatteFinishApplicable=function(){return null!=this.cover&&this.cover.isHardCover()&&!this.hasMatteFinish()},a.prototype.isPaddedFinishApplicable=function(){return null!=this.cover&&this.cover.isHardCover()&&!this.hasPaddedFinish()},a.prototype.isDustJacketApplicable=function(){return null!=this.cover&&this.cover.isHardCover()&&!(this.hasPaddedFinish()||this.hasDustJacket())},a.prototype.isKeepsakePocketApplicable=function(){return null!=this.cover&&!(this.cover.isSoftCover()||this.hasKeepsakePocket())},a.prototype.isGlossyPageFinishApplicable=function(){return null!=this.cover&&!this.cover.isSoftCover()&&this.cover.hasLooseleafBinding()&&!this.hasGlossyPages()},a.prototype.pageTypeBySurfaceNumber=function(a){return a===this.pageFactory.Page.FRONT_COVER_PAGE_NUMBER?"cover":a===this.pageFactory.Page.SPINE_PAGE_NUMBER?"spine":a===this.pageFactory.Page.BACK_COVER_PAGE_NUMBER?"cover":a===this.pageFactory.Page.FRONT_FILLER_PAGE_NUMBER?"filler":a===this.pageFactory.Page.BACK_FILLER_PAGE_NUMBER?"filler":a>-1&&a<=this.pages.length?"page":"poop"},a.prototype.pageBySurfaceNumber=function(a){return a===this.pageFactory.Page.FRONT_COVER_PAGE_NUMBER?this.cover.frontPage:a===this.pageFactory.Page.SPINE_PAGE_NUMBER?this.cover.spinePage:a===this.pageFactory.Page.BACK_COVER_PAGE_NUMBER?this.cover.backPage:a===this.pageFactory.Page.FRONT_FILLER_PAGE_NUMBER?this.frontFillerPage:a===this.pageFactory.Page.BACK_FILLER_PAGE_NUMBER?this.backFillerPage:a>-1&&a<=this.pages.length?this.pages[a-1]:null},a.prototype.movePageTo=function(a,b){var c,d,e,f,g,h,i,j;if(!(a<1||b<1||b>this.values.pages.length||a>this.values.pages.length)){for(c=a-1,d=b-1,f=this.values.pages.splice(c,1),this.values.pages.splice(d,0,f[0]),this._cachedPages.splice(c,1),g=this.pageFactory.newInstance(this.values.pages[d],!0),this._cachedPages.splice(d,0,g),j=this.values.pages,e=h=0,i=j.length;h<i;e=++h)g=j[e],g.surfaceNumber=e+1;return this._cachedSpreads=null}},a.prototype.removePage=function(a){var b,c,d,e,f,g,h,i,j;if(null!=(i=this.pageBySurfaceNumber(a))?i.isRemovablePage():void 0){for(b=this.pages.length,d=a-1,this.values.pages.splice(d,1),this._cachedPages.splice(d,1),j=this.values.pages,c=g=0,h=j.length;g<h;c=++g)e=j[c],e.surfaceNumber=c+1;return this._cachedSpreads=null,f=this.pages.length,this.ensureWideSpineThresholdEvent(b,f)}},a.prototype.applyPageValuesObj=function(a,b){var c,d;return d=this.pageBySurfaceNumber(a),(null!=d?d.isCover():void 0)?this.cover.applyPageValuesObj(a,b):(c=a-1,this.values.pages[c]=b,this._cachedPages[c].init(this.values.pages[c]))},a._sfgetter("pages",function(){var a;return null!=this._cachedPages?this._cachedPages:this._cachedPages=function(){var b,c,d,e;for(d=this.values.pages,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(this.pageFactory.newInstance(a,!0));return e}.call(this)}),a._sfgetter("priceableSurfaces",function(){var a;return a=!1,this.allSurfaces.filter(function(b){return b.isSpread()===!1&&a===!1||(a=b.isSpread())})}),a._sfgetter("allSurfaces",function(){return null!=this.cover?[].concat(this.cover.frontPage,this.cover.spinePage,this.cover.backPage,this.pages):this.pages.concat()}),a._sfgetter("allSurfacesForExport",function(){return null==this.cover||this.cover.isStockCover?this.pages.concat():[].concat(this.cover.frontPage,this.pages,this.cover.backPage)}),a._sfgetter("spreads",function(){return null!=this._cachedSpreads?this._cachedSpreads:this._cachedSpreads=this._createSpreads()}),a.prototype._createSpreads=function(){var a,b,c,d,e;if(this.pages){for(d=2,e=[],a=[],c=this.pages.length,this.pages.length%2===0&&(c=this.pages.length-1),b=1;b<c;)a.push(this.pages[b]),a.length===d&&(a.id=""+a[0].uid+"-"+a[1].uid,e.push(a),a=[]),b++;return a.length>0&&e.push(a),e}},a._sfgetter("numUniqueImages",function(){return parseInt(this.values.numUniqueImages)}),a._sfsetter("numUniqueImages",function(a){if(this.ModelInitializer.isType(a,"number"))return this.values.numUniqueImages=a.toString()}),a.prototype.assetPagePairsPassingTest=function(a){var b,c,d,e,f,g,h,i,j,k;for(null==a&&(a=function(a){return!0}),b=[].concat(this.cover.backPage,this.cover.spinePage,this.cover.frontPage,this.pages),e=[],g=0,i=b.length;g<i;g++)for(f=b[g],k=f.layout.assets,d=h=0,j=k.length;h<j;d=++h)c=k[d],a(c)&&e.push({assetIndex:d,pageNumber:f.surfaceNumber});return e},a.prototype.spreadForSurfaceNumber=function(a){var b;if(null!=a){if(b=this.pageFactory.Page,this._isCoverSurfaceNumber(a))return[this.cover.backPage,this.cover.spinePage,this.cover.frontPage];switch(a){case b.TITLE_PAGE_NUMBER:case b.FRONT_FILLER_PAGE_NUMBER:return[this.frontFillerPage,this.pages[0]];case this.lastPage().surfaceNumber:case this.lastEvenPage().surfaceNumber:case b.BACK_FILLER_PAGE_NUMBER:return this._backSpread();default:return this._innerSpreadForSurfaceNumber(a)}}},a.prototype.spreadBeforeSurfaceNumber=function(a){var b,c,d;if(null!=a){if(c=this.pageFactory.Page,this._isCoverSurfaceNumber(a))return this._backSpread();switch(a){case c.TITLE_PAGE_NUMBER:case c.FRONT_FILLER_PAGE_NUMBER:return null!=this.cover?[this.cover.backPage,this.cover.spinePage,this.cover.frontPage]:this._backSpread();case 2:case 3:return[this.frontFillerPage,this.pages[0]];case c.BACK_FILLER_PAGE_NUMBER:return b=this.pageBySurfaceNumber(this.lastEvenPage().surfaceNumber-2),d=this.pageBySurfaceNumber(this.lastEvenPage().surfaceNumber-1),[b,d];default:return a%2===0?[this.pageBySurfaceNumber(a-2),this.pageBySurfaceNumber(a-1)]:[this.pageBySurfaceNumber(a-3),this.pageBySurfaceNumber(a-2)]}}},a.prototype.spreadAfterSurfaceNumber=function(a){var b;if(null!=a){if(b=this.pageFactory.Page,this._isCoverSurfaceNumber(a))return this._frontSpread();switch(a){case b.TITLE_PAGE_NUMBER:case b.FRONT_FILLER_PAGE_NUMBER:return[this.pageBySurfaceNumber(2),this.pageBySurfaceNumber(3)];case this.lastEvenPage().surfaceNumber-1:case this.lastEvenPage().surfaceNumber-2:return this._backSpread();case this.lastPage().surfaceNumber:case this.lastEvenPage().surfaceNumber:case b.BACK_FILLER_PAGE_NUMBER:return null==this.cover?this._frontSpread():this.cover.isStockCover?[this.cover.frontPage,this.cover.frontPage]:[this.cover.backPage,this.cover.spinePage,this.cover.frontPage];default:return a%2===0?[this.pageBySurfaceNumber(a+2),this.pageBySurfaceNumber(a+3)]:[this.pageBySurfaceNumber(a+1),this.pageBySurfaceNumber(a+2)]}}},a.prototype._innerSpreadForSurfaceNumber=function(a){return a%2===0?[this.pageBySurfaceNumber(a),this.pages[a]]:[this.pages[a-2],this.pageBySurfaceNumber(a)]},a.prototype._isCoverSurfaceNumber=function(a){var b;return b=this.pageFactory.Page,a>=b.BACK_COVER_PAGE_NUMBER&&a<b.TITLE_PAGE_NUMBER},a.prototype._frontSpread=function(){return[this.frontFillerPage,this.pages[0]]},a.prototype._backSpread=function(){return this.lastPageIsEven()?[this.lastEvenPage(),this.backFillerPage]:[this.lastEvenPage(),this.lastPage()]},a.prototype.lastPage=function(){return this.pages[this.pages.length-1]},a.prototype.firstPage=function(){return this.pages[0]},a.prototype.lastEvenPage=function(){return this.lastPageIsEven()?this.lastPage():this.pages[this.pages.length-2]},a.prototype.lastOddPage=function(){return this.lastPageIsEven()?this.backFillerPage:this.lastPage()},a.prototype.lastPageIsEven=function(){return this.lastPage().surfaceNumber%2===0},a.prototype.lastPageIsSpread=function(){return this.pages[this.pages.length-2].isSpread()},a.prototype.hasWideSpine=function(){var a,b;return(null!=(a=this.cover.spinePage)&&null!=(b=a.layoutName)?b.indexOf("wide"):void 0)>-1},a.prototype.isBlank=function(){var a,b,c,d;if(!this.cover.frontPage.isEmpty()&&!this.cover.backPage.isEmpty())return!1;for(d=this.pages,b=0,c=d.length;b<c;b++)if(a=d[b],!a.isEmpty())return!1;return!0},a.prototype.canApplyWideSpine=function(){var a,b;return a=58,"layflat"===(null!=(b=this.cover)?b.binding:void 0)&&this.pages.length>=a&&"5x7"!==this.sizeId},a.prototype.spreadNumberAfterPageNumber=function(a){var b,c,d,e;for(a=Math.max(1,a),c=this.pages.slice(a),d=0,e=c.length;d<e;d++)if(b=c[d],b.isSpread())return b.surfaceNumber},a.prototype.getLayoutFormFactorForPage=function(a,b){var c,d,e,f;return null==a&&(a=null),null==b&&(b=!1),c=this.cover.coverSpecID.indexOf("_bk_"),d=null!=(f=this.cover)?f.coverSpecID.substr(0,c):void 0,e=this.canApplyWideSpine()&&b===!1?"wide":this.cover.coverSpecID.substring(c+4,this.cover.coverSpecID.length),d+e},a.prototype.hasFilledPages=function(){return this.pages.some(function(a){return!a.isAutofillable()})||this.cover.hasFilledPages()},a.prototype.addPage=function(a){var b,c,d,e;return b=this.pages.length,e=this.pages.length+1,a.surfaceNumber=""+e,a.layout.displayPageNumber="false",c=this.pageFactory.newInstance(a,!0),this.values.pages.push(a),this.pages.push(c),this._cachedSpreads=null,d=this.pages.length,this.ensureWideSpineThresholdEvent(b,d),c},a.prototype.addPagesAtPosition=function(a,b){var c,d,e,f,g,h,i,j,k;for(c=this.pages.length,g=function(){var b,c,d;for(d=[],b=0,c=a.length;b<c;b++)f=a[b],d.push(this.pageFactory.newInstance(f,!0));return d}.call(this),this.pages.splice.apply(this.pages,[b-1,0].concat(g)),this.values.pages.splice.apply(this.values.pages,[b-1,0].concat(a)),k=this.values.pages,d=i=0,j=k.length;i<j;d=++i)e=k[d],e.surfaceNumber=d+1;h=this.pages.length,this.ensureWideSpineThresholdEvent(c,h),this._cachedSpreads=null},a.prototype.ensureWideSpineThresholdEvent=function(a,b){var c,d;if(d=!1,c=58,a<b&&(d=!0),d&&a<c&&b>=c&&this.eventBus.publish(this.eventBus.events.CROSSED_WIDELAYFLAT_PAGE_LIMIT,{uptrend:d,pageCount:b}),!d&&a>=c&&b<c)return this.eventBus.publish(this.eventBus.events.CROSSED_WIDELAYFLAT_PAGE_LIMIT,{uptrend:d,pageCount:b})},a.prototype._createFillerPages=function(){var a;return a=angular.copy(this.pages[0].values),a.layout.assets=[],this.frontFillerPage=this.pageFactory.newInstance(a,!1),this.frontFillerPage.surfaceNumber=this.frontFillerPage.constructor.FRONT_FILLER_PAGE_NUMBER,this.backFillerPage=this.pageFactory.newInstance(angular.copy(a),!1),this.backFillerPage.surfaceNumber=this.backFillerPage.constructor.BACK_FILLER_PAGE_NUMBER},a.prototype.invalidatePages=function(){return this._cachedPages=null,this._cachedCover=null,this._cachedSpreads=null},a}(),a.$inject=["modelInitializer","cover","pageFactory","eventBus","enums","pageModelStrategy","CONFIG"],"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("book",a)}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}},c=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};a=function(){function a(a,c,d,e,f,g,h,i,j){this.ModelInitializer=a,this.pageFactory=c,this.enums=d,this.calendarGrid=e,this.pageModelStrategy=f,this.config=g,this.eventBus=h,this.commandService=i,this.navService=j,this._populateVirtualAssets=b(this._populateVirtualAssets,this)}var d;return a.SIZE_8x11="8x11",a.SIZE_12x12="12x12",a.SIZE_OPTIONS=[a.SIZE_8x11,a.SIZE_12x12],d=["formFactorID","styleContentVersion","occasionContentId","styleId","occasionContentVersion","subtype","startTime","styleContentId"],a.prototype.init=function(a){var b,e;return this.values=a,this.config.virtualAssets&&this.eventBus.subscribe(this.eventBus.events.STYLE_LOADED,this._populateVirtualAssets),this._cachedPages=null,this.ModelInitializer.initialize(this,this.values,d),b=["12x12"],this.aspectRatio=(e=this.sizeId,c.call(b,e)>=0?"square":"rectangle"),this.defaultTitle="My Calendar",this._createDummyPage(),this},a.prototype._createDummyPage=function(){var a;return a=angular.copy(this.pages[0].values),a.layout.assets=[],this.dummyPage=this.pageFactory.newInstance(a,!1),this.dummyPage.surfaceNumber=this.dummyPage.constructor.FRONT_FILLER_PAGE_NUMBER},a.prototype._populateVirtualAssets=function(){var a,b,c,d;if(null!=this.calendarGrid){for(d=this.pages,b=0,c=d.length;b<c;b++)a=d[b],a.isGrid&&this.calendarGrid.populateVirtualAssets(a);return null!=this.guid?this._removeEmptyGridAssets():void 0}},a._sfgetter("logoPage",function(){return this.pageFactory.newInstance(this.values.logoPage,!1)}),a._sfgetter("descriptionId",function(){return"Calendar.descriptionId."+this.sizeId}),a._sfgetter("sku",function(){return("WALLCAL_"+this.sizeId).toUpperCase()}),a._sfgetter("guid",function(){return this.values.productGUID}),a._sfsetter("guid",function(a){if(null===a||this.ModelInitializer.isType(a,"string"))return this.values.productGUID=a}),a._sfgetter("sizeId",function(){return this.values.sizeID}),a._sfsetter("sizeId",function(a){if(this.ModelInitializer.isType(a,"string"))return this.values.sizeID=a}),a._sfgetter("numTotalImages",function(){return parseInt(this.values.numTotalImages)}),a._sfsetter("numTotalImages",function(a){if(this.ModelInitializer.isType(a,"number"))return this.values.numTotalImages=a.toString()}),a.prototype.isGridPage=function(a){return a%2===1&&1!==a},a.prototype.findSurfaceForDate=function(a){var b,c,d,e;for(e=this.pages,c=0,d=e.length;c<d;c++)if(b=e[c],this.isGridPage(b.surfaceNumber)&&b.surfaceKey===""+a.getFullYear()+"-"+(a.getMonth()+1))return b},a.prototype.hasPaddedFinish=function(){return!1},a.prototype.hasMatteFinish=function(){return!1},a.prototype.hasGlossyPages=function(){return!1},a.prototype.hasStandardPages=function(){return!0},a.prototype.hasDustJacket=function(){return!1},a.prototype.hasKeepsakePocket=function(){return!1},a.prototype.isMatteFinishApplicable=function(){return!1},a.prototype.isPaddedFinishApplicable=function(){return!1},a.prototype.isDustJacketApplicable=function(){return!1},a.prototype.isKeepsakePocketApplicable=function(){return!1},a.prototype.isGlossyPageFinishApplicable=function(){return!1},a.prototype.pageTypeBySurfaceNumber=function(a){return 1===a?"cover":"page"},a.prototype.pageBySurfaceNumber=function(a){return a>=1&&a<=this.pages.length?this.pages[a-1]:null},a.prototype.applyPageValuesObj=function(a,b){var c,d;return d=this.pageBySurfaceNumber(a),(null!=d?d.isCover():void 0)?this.cover.applyPageValuesObj(a,b):(c=a-1,this.values.pages[c]=b,this._cachedPages[c].init(this.values.pages[c]))},a._sfgetter("nonGridPages",function(){return this.pages.filter(function(a){return function(b){return!a.isGridPage(b.surfaceNumber)}}(this))}),a._sfgetter("pages",function(){var a;return null!=this._cachedPages?this._cachedPages:this._cachedPages=function(){var b,c,d,e;for(d=this.values.pages,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(this.pageFactory.newInstance(a,!1));return e}.call(this)}),a._sfgetter("priceableSurfaces",function(){return this.allSurfaces}),a._sfgetter("allSurfaces",function(){return this.pages.concat()}),a._sfgetter("numUniqueImages",function(){return parseInt(this.values.numUniqueImages)}),a._sfsetter("numUniqueImages",function(a){if(this.ModelInitializer.isType(a,"number"))return this.values.numUniqueImages=a.toString()}),a.prototype.assetPagePairsPassingTest=function(a){var b,c,d,e,f,g,h,i,j,k;for(null==a&&(a=function(a){return!0}),b=this.allSurfaces,e=[],g=0,i=b.length;g<i;g++)for(f=b[g],k=f.layout.assets,d=h=0,j=k.length;h<j;d=++h)c=k[d],a(c)&&e.push({assetIndex:d,pageNumber:f.surfaceNumber});return e},a.prototype.spreadForSurfaceNumber=function(a){if(null!=a)return this._isCoverSurfaceNumber(a)?this._coverSpread():this._innerSpreadForSurfaceNumber(a)},a.prototype.spreadBeforeSurfaceNumber=function(a){if(null!=a)return this._isCoverSurfaceNumber(a)?this._backSpread():a<4?this._coverSpread():a%2===0?[this.pageBySurfaceNumber(a-2),this.pageBySurfaceNumber(a-1)]:[this.pageBySurfaceNumber(a-3),this.pageBySurfaceNumber(a-2)]},a.prototype.spreadAfterSurfaceNumber=function(a){if(null!=a){if(this._isCoverSurfaceNumber(a))return this._innerSpreadForSurfaceNumber(2);switch(a){case this.lastPage().surfaceNumber:case this.lastEvenPage().surfaceNumber:return this._coverSpread();default:return a%2===0?[this.pageBySurfaceNumber(a+2),this.pageBySurfaceNumber(a+3)]:[this.pageBySurfaceNumber(a+1),this.pageBySurfaceNumber(a+2)]}}},a.prototype._innerSpreadForSurfaceNumber=function(a){return a%2===0?[this.pageBySurfaceNumber(a),this.pages[a]]:[this.pages[a-2],this.pageBySurfaceNumber(a)]},a.prototype._isCoverSurfaceNumber=function(a){var b;return b=this.pageFactory.Page,1===a||a===b.FRONT_FILLER_PAGE_NUMBER},a.prototype._backSpread=function(){return[this.lastEvenPage(),this.lastPage()]},a.prototype._coverSpread=function(){return[this.pages[0],this.dummyPage]},a.prototype.lastPage=function(){return this.pages[this.pages.length-1]},a.prototype.lastEvenPage=function(){return this.pages[this.pages.length-2]},a.prototype.lastOddPage=function(){return this.lastPage()},a.prototype.lastPageIsEven=function(){return!1},a.prototype.lastPageIsSpread=function(){return!1},a.prototype.hasWideSpine=function(){return!1},a.prototype.isBlank=function(){var a,b,c,d;for(d=this.pages,b=0,c=d.length;b<c;b++)if(a=d[b],!a.isEmpty())return!1;return!0},a.prototype.canApplyWideSpine=function(){return!1},a.prototype.spreadNumberAfterPageNumber=function(){},a.prototype.getLayoutFormFactorForPage=function(){return this.sizeId},a.prototype.hasFilledPages=function(){return this.pages.some(function(a){return!a.isAutofillable()})},a.prototype.invalidatePages=function(){return this._cachedPages=null},a.prototype.getCalendarStartDate=function(){var a;return a=this.pageModelStrategy.parseSurfaceKeyForPage(this.pages[1]),null==a?{month:1,year:(new Date).getFullYear()}:a},a.prototype.getCalendarDate=function(a){var b;return b=this.pageModelStrategy.parseSurfaceKeyForPage(a),null==b?{month:12,year:(new Date).getFullYear()}:b},a.prototype.getCalendarEndDate=function(){var a;return a=this.pageModelStrategy.parseSurfaceKeyForPage(this.lastPage()),null==a?{month:12,year:(new Date).getFullYear()}:a},a.prototype.getImageAssetByUniqueProjectRef=function(a,b){return this.calendarGrid.getImageAssetByUniqueProjectRef(a,b)},a.prototype.setEventsOnDate=function(a,b){var c,d,e,f,g;if(Array.isArray(a)&&b.constructor.prototype===Date.prototype&&(a=a.sort(function(a){return 0===a.visibility.indexOf("custom")?-1:1}),d=this.findSurfaceForDate(b),null!=d))return g=this.calendarGrid.findEventTextAreaForDate(b,d),c=g.gridCellIterator,e=g.matchingAsset,f=a.reduce(function(a,b){return null==b.name?a:""===a?b.name:""+a+"\n"+b.name},""),this._updateGridCellEventText(c,e,f,b,d)},a.prototype._updateGridCellEventText=function(a,b,c,d,e){var f,g,h;if(0===(null!=c?c.length:void 0)&&this.calendarGrid.canDeflateGridCell(a,b)?this.calendarGrid.deflateGridCell(b,a,e):(null!=c?c.length:void 0)>0&&(this.calendarGrid.canInflateGridCell(a)&&this.calendarGrid.inflateGridCell(a,e),null==b&&(f=function(a,b){var c;return c=b[0],a.asset.assetType===a.asset.constructor.TEXT_TYPE&&a.asset.guidanceText==="event-"+c},b=null!=(h=a.findGridCellAsset(f,[d.getDate()]))?h.asset:void 0)),null!=b)return g=JSON.parse(JSON.stringify(b.styles)),g.verticalAlign=b.verticalAlign,b.updateTextWithWrapsAndStyle(c,[],!1,g)},a.prototype.getDateForGridImageArea=function(a,b){var c,d;return a.isGrid&&(c=this.calendarGrid.getDayForGridImageArea(a,b))?(d=this.pageModelStrategy.parseSurfaceKeyForPage(a),new Date(d.year,d.month-1,c)):null},a.prototype._removeEmptyGridAssets=function(){return this.commandService.execute("RemoveEmptyGridAssetsCommand",{activePageNumber:this.navService._selectedPageNumber})},a}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon-gc").service("calendar",["modelInitializer","pageFactory","enums","calendarGrid","pageModelStrategy","CONFIG","eventBus","commandService","navService",a])}.call(this),function(){var a;a=function(){function a(a,b,c,d,e,f){this.calendarGridCellIteratorFactory=a,this.virtualImageAssetFactory=b,this.adaptiveLayoutService=c,this.contentService=d,this.config=e,this.assetFactory=f,this.dayCellImagesCache={},this.adaptiveLib=c.adaptiveLib}return a.prototype.getEditableAssetsByClickedGridCellAsset=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n;if(i=function(a,b){var c;return c=b[0],a.asset.containerId===c},m=this.seekToGridCell(a,i,[b.asset.containerId]),g=m.gridCellIterator,j=m.matchingAsset,null!=j&&(f=null!=g?g.getGridCellAssets():void 0),n=this._assignMatchingEditableAsset(j),d=n.dateAsset,e=n.eventAsset,h=n.imageAsset,null!=f)for(k=0,l=f.length;k<l;k++)c=f[k],"image"===c.asset.assetType&&null==h?j.isEventTextAsset&&j.associatedImage===c.asset.containerId&&(h=c):c.isEventTextAsset&&((null!=h?h.asset.containerId:void 0)!==c.associatedImage&&j.associatedImage!==c.associatedImage||(c.isDateTextAsset?d=c:e=c));return{dateAsset:d,eventAsset:e,imageAsset:h,gridCellAssets:f}},a.prototype._assignMatchingEditableAsset=function(a){var b,c,d;return"image"===(null!=a?a.asset.assetType:void 0)?d=a:(null!=a?a.isEventTextAsset:void 0)&&((null!=a?a.isDateTextAsset:void 0)?b=a:c=a),{dateAsset:b,eventAsset:c,imageAsset:d}},a.prototype.seekToGridCell=function(a,b,c){var d,e,f,g;for(null==c&&(c=[]),e=this.calendarGridCellIteratorFactory.newInstance(a),f=null;null!==e.next();)if(f=null!=(g=e.findGridCellAsset(b,c))?g.asset:void 0){d=""+e.gridCellCount+e.gridId,e.gridCellCount===e.constructor.MAX_GRID_CELL_COUNT&&f.asset.containerId.indexOf(d)===-1&&(e=null);break}return{gridCellIterator:e,matchingAsset:f}},a.prototype.getImageAssetByUniqueProjectRef=function(a,b){var c,d;return c=function(b,c){return a=c[0],b.asset.assetType===b.asset.constructor.IMAGE_TYPE&&b.uniqueProjectRef===a},(null!=(d=this.seekToGridCell(b,c,[a]))?d.matchingAsset:void 0)||null},a.prototype.findEventTextAreaForDate=function(a,b){var c,d,e,f;return e=function(a,b){var c,d;return d=b[0],c=b[1],a.asset.assetType===a.asset.constructor.TEXT_TYPE&&a.asset.guidanceText===""+d+"-"+c},d=this.seekToGridCell(b,e,["date",a.getDate()]).gridCellIterator,d&&(c=null!=(f=d.findGridCellAsset(e,["event",a.getDate()]))?f.asset:void 0),{gridCellIterator:d,matchingAsset:c||null}},a.prototype.findEventTextAreaForImageAreaId=function(a,b){var c,d;return c=function(b,c){return a=c[0],b.asset.assetType===b.asset.constructor.TEXT_TYPE&&b.associatedImage===a&&/event-[0-9]+$/.test(b.asset.guidanceText)},(null!=(d=this.seekToGridCell(b,c,[a]))?d.matchingAsset:void 0)||null},a.prototype.getGridCellCount=function(a){var b,c;if(!/^image-.*/.test(a))throw new Error("Must re-implement this method for additional asset types");if(c=a.match(/([\d]+)([2|1][\d]{3})([0-9,\-]+$)/),4!==c.length)throw new Error("unrecognized starting grid cell index id, "+a);return(b=function(a,b){if(b=parseInt(b),"number"!=typeof b||isNaN(b))throw new Error("invalid "+a+" value, "+b);return b})("getGridCellCount",c[1])},a.prototype.findImageAreaForDate=function(a,b){var c,d,e,f,g,h,i,j;for(d=a.getDate(),e=this.calendarGridCellIteratorFactory.newInstance(b);null!==e.next()&&(null!=(h=e.currentDate())?h.day:void 0)!==d;);return f=function(a,b){return d=b[0],a.asset.assetType===a.asset.constructor.TEXT_TYPE&&a.asset.guidanceText==="date-"+d},g=function(a,b){var c;return c=b[0],a.uniqueProjectRef===c},(c=null!=(i=e.findGridCellAsset(f,[d]))?i.asset:void 0)?null!=(j=e.findGridCellAsset(g,[c.associatedImage]))?j.asset:void 0:null},a.prototype.findVirtualImageAreaForDate=function(a,b){var c,d,e,f,g,h,i;for(d=this.calendarGridCellIteratorFactory.newInstance(b);null!==d.next();){if((null!=(g=d.currentDate())?g.day:void 0)===a.getDate()){f="image-"+d.gridCellCount+a.getFullYear()+a.getMonth();break}if(d.isSplitGridCell()&&(null!=(h=d.currentDate())?h.day:void 0)+7===a.getDate()){f="image-"+d.gridCellCount+a.getFullYear()+a.getMonth()+"-2";break}}return e=function(a,b){return f=b[0],a.asset.uniqueProjectRef===f},c=null!=(i=d.findGridCellAsset(e,[f]))?i.asset:void 0,c?c:null},a.prototype.getDayForGridImageArea=function(a,b){var c,d,e,f;return d=function(a,c){return b=c[0],a.asset.assetType===a.asset.constructor.TEXT_TYPE&&a.associatedImage===b&&/date-[0-9]+$/.test(a.asset.guidanceText)},(c=null!=(f=this.seekToGridCell(a,d,[b]))?f.matchingAsset:void 0)?(e=/date-([0-9]+)$/.exec(c.asset.guidanceText),2!==(null!=e?e.length:void 0)?null:parseInt(e[1])):null},a.prototype.populateVirtualAssets=function(a){var b;for(b=this.calendarGridCellIteratorFactory.newInstance(a);null!==b.next()&&b.currentDate();)this.populateGridCellVirtualAssets(b)},a.prototype.populateGridCellVirtualAssets=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;if(this.contentService.currentStyle)for(b=a.gridAssets[a.gridCellIndex],d=b.asset.xOffset,e=b.asset.yOffset,k=this.contentService.currentStyle,c=null,g=a.isSplitGridCell(),c=g?this.adaptiveLib.getSplitGridCellTemplate(k):this.adaptiveLib.getSingleGridCellTemplate(k),j=this._getGridCellImagePosition(d,e,c),f=m=0,n=j.length;m<n;f=++m)i=j[f],this._setIds(i,a,this._isBottomSplitCell(j,f)),l=this.virtualImageAssetFactory.newInstance(i),h=this._getGridCellTemplateImageOffset(g,c),a.gridAssets.splice(a.gridCellIndex+h,0,l)},a.prototype._isBottomSplitCell=function(a,b){var c;return 2===a.length&&(c=1===b?0:1,a[b].yOffset>a[c].yOffset)},a.prototype._setIds=function(a,b,c){var d,e;return d=b.currentDate(),e="image-"+b.gridCellCount+d.year+(d.month-1),c&&(e+="-2"),a.containerId=e,a.uniqueProjectRef=e},a.prototype.canInflateGridCell=function(a){var b,c,d,e;return b=function(a){return a.asset.assetType===a.asset.constructor.TEXT_TYPE&&/event-[0-9]+$/.test(a.asset.guidanceText)},c=function(a){return a.asset.assetType===a.asset.constructor.IMAGE_TYPE},!!this.config.virtualAssets&&!(null!=(null!=(d=a.findGridCellAsset(b))?d.asset:void 0)&&null!=(null!=(e=a.findGridCellAsset(c))?e.asset:void 0))},a.prototype._hasEventText=function(a){var b,c,d;return c=function(a){return a.asset.assetType===a.asset.constructor.TEXT_TYPE&&/event-[0-9]+$/.test(a.asset.guidanceText)},b=null!=(d=a.findGridCellAsset(c,[]))?d.asset:void 0,(null!=b?b.hasContent():void 0)||!1},a.prototype.findEventImageForImageWellAreaId=function(a,b){var c;return c=function(b,c){return a=c[0],b.asset.assetType===b.asset.constructor.IMAGE_TYPE&&b.associatedImage===a&&/image-[0-9]+$/.test(b.asset.guidanceText)},this.seekToGridCell(b,c,[a]).matchingAsset||null},a.prototype.getGridCellIteratorFromVirtualAsset=function(a,b){var c,d;
for(c=this.getGridCellCount(b.asset.uniqueProjectRef),d=this.calendarGridCellIteratorFactory.newInstance(a);d.next()&&d.gridCellCount!==c;);return d},a.prototype.inflateGridCell=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(this.contentService.currentStyle){for(d=a.getGridCellAssets(),f=d[0].asset.xOffset,g=d[0].asset.yOffset,m=this.contentService.currentStyle,e=null,i=a.isSplitGridCell(),e=i?this.adaptiveLib.getSplitGridCellTemplate(m):this.adaptiveLib.getSingleGridCellTemplate(m),l=[],o=0,p=d.length;o<p;o++)c=d[o],c.assetType!==c.asset.constructor.VIRTUAL_IMAGE_TYPE&&l.push(c.values);if(this.canInflateGridCell(a))return h=this.adaptiveLayoutService.inflateGridCell(l,a.gridCellCount,f,g,e.layout_JSON,m),j=b.layout,k=b.indexOfAsset(d[0]),n=j.indexOfAssetValues(d[0]),this._removeGridCellAssets(d,k,n,j),this._addInflatedAssets(h,k,n,j)}},a.prototype._removeGridCellAssets=function(a,b,c,d){var e,f,g;for(e=f=1,g=a.length-1;1<=g?f<=g:f>=g;e=1<=g?++f:--f)d.assets.splice(b,1),d.values.assets.splice(c,1);d.assets.splice(b,1)},a.prototype._addInflatedAssets=function(a,b,c,d){var e,f,g,h;for(f=g=h=a.length-1;h<=0?g<=0:g>=0;f=h<=0?++g:--g)e=a[f],d.addAssetByIndex(this.assetFactory.newInstance(e),b,c)},a.prototype._getGridCellImagePosition=function(a,b,c){return this.adaptiveLib.getGridCellImagePosition(a,b,c)},a.prototype._getGridCellTemplateImageOffset=function(a,b){var c,d,e,f,g;for(g=b.layout_JSON.assets,d=e=0,f=g.length;e<f;d=++e)if(c=g[d],"image"===c.assetType)return d;return 0},a.prototype.deflateGridCell=function(a,b,c){var d,e;if(e=function(a){return function(d){return a._removeLayoutAsset(d,c.layout,b)}}(this),this.adaptiveLib.deflateGridCell(c.layout.values.assets,c.layout.values.assets.indexOf(b.gridAssets[b.gridCellIndex].values),e),d=function(a){return"virtual-image"===a.asset.assetType},!b.findGridCellAsset(d))return this.populateGridCellVirtualAssets(b)},a.prototype.canDeflateGridCell=function(a,b){var c,d,e,f,g,h,i,j;return null==b&&(b=null),g=function(a){return a.asset.assetType===a.asset.constructor.TEXT_TYPE&&/event-[0-9]+$/.test(a.asset.guidanceText)},h=function(a){return a.asset.assetType===a.asset.constructor.IMAGE_TYPE},!!this.config.virtualAssets&&(e=null!=(i=a.findGridCellAsset(g))?i.asset:void 0,f=null!=(j=a.findGridCellAsset(h))?j.asset:void 0,!(!e||!f)&&(c=b!==e,d=b!==f,!(c&&e.hasContent()||d&&f.hasAssignedImage())))},a.prototype._removeLayoutAsset=function(a,b,c){var d,e,f,g;if(f=function(a,b){var c;return c=b[0],a.asset.containerId===c},d=null!=(g=b.values.assets[a])?g.container.id:void 0,e=c.findGridCellAsset(f,[d]).gridAssetsIndex,d)return b.assets.splice(e,1),b.values.assets.splice(a,1)},a}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon-gc").service("calendarGrid",["calendarGridCellIteratorFactory","virtualImageAssetFactory","adaptiveLayoutService","contentService","CONFIG","assetFactory",a])}.call(this),function(){"use strict";var a,b;a=function(){function a(a,b){var c;this.gridAssets=a.layout.assets,this._positionIterator(-1,0,-1),this.gridYear,this.gridMonth,c=b.parseSurfaceKeyForPage(a),this.gridYear=c.year,this.gridMonth=c.month,this.gridId=this.gridYear.toString()+(this.gridMonth-1).toString(),this.doSplitGridCellNavigation=!1,this.splitGridCellReferences=[],this.leadingNonDatedGridCellCount=new Date(this.gridYear,this.gridMonth-1,1).getDay()}return a.MAX_GRID_CELL_COUNT=35,a.prototype.first=function(){var a;return a=this._seekToFirstGridCell(),a>=0?this.gridAssets[a]:null},a.prototype._seekToFirstGridCell=function(){var a,b,c,d,e,f;for(this.gridStartIndex=this.gridCellIndex=-1,this.gridCellCount=1,c=this._assetSuffixForCellCount(this.gridCellCount),f=this.gridAssets,b=d=0,e=f.length;d<e;b=++d)if(a=f[b],a=a.asset,a.containerId.match(""+c+"$"))return this.gridStartIndex=this.gridCellIndex=b;return-1},a.prototype._positionIterator=function(a,b,c){return null==c&&(c=this.gridStartIndex),this.gridStartIndex=c,this.gridCellIndex=a,this.gridCellCount=b},a.prototype._seekToNextGridCell=function(){var a,b,c,d,e,f,g;for(this.doSplitGridCellNavigation&&this._navigateSplitGridCells,d=this._assetSuffixForCellCount(this.gridCellCount),c=0,b=e=f=this.gridCellIndex,g=this.gridAssets.length-1;f<=g?e<=g:e>=g;b=f<=g?++e:--e){if(a=this.gridAssets[b].asset,a.containerId.match(""+d+"$")&&(this.gridCellIndex=b,c++,d=this._assetSuffixForCellCount(this.gridCellCount+c)),a.containerId.match(""+this._assetSuffixForCellCount(this.gridCellCount)+"$")&&!this.doSplitGridCellNavigation)return this.isSplitGridCell()&&this.splitGridCellReferences.push({gridCellIndex:this.gridCellIndex,gridCellCount:this.gridCellCount}),this.gridCellIndex;if(b===this.gridAssets.length-1&&this.splitGridCellReferences.length>0)return this.doSplitGridCellNavigation=!0,this._navigateSplitGridCells()}return-1},a.prototype._navigateSplitGridCells=function(){var a;return this.splitGridCellReferences.length>0?(a=this.splitGridCellReferences.shift(),this._positionIterator(a.gridCellIndex,a.gridCellCount),a.gridCellIndex):-1},a.prototype._assetSuffixForCellCount=function(a){return""+a+this.gridId},a.prototype.next=function(){return this.gridCellIndex===-1?this.first():(this.gridCellCount++,this._seekToNextGridCell()!==-1?this.gridAssets[this.gridCellIndex]:null)},a.prototype.currentDate=function(){var a;if(!(this.gridCellCount<this.leadingNonDatedGridCellCount+1))return a={year:this.gridYear,month:this.gridMonth,day:this.gridCellCount-this.leadingNonDatedGridCellCount},this.doSplitGridCellNavigation&&(a.day+=7),a},a.prototype.findGridCellAsset=function(a,b){var c,d,e,f,g,h;if(null==b&&(b=[]),this.gridStartIndex===-1&&this.first(),this.gridCellIndex===-1)return null;for(e=this._assetSuffixForCellCount(this.gridCellCount+1),d=f=g=this.gridCellIndex,h=this.gridAssets.length-1;g<=h?f<=h:f>=h;d=g<=h?++f:--f){if(c=this.gridAssets[d],c.asset.containerId.match(""+e+"$"))return null;if(a(c,b))return{asset:c,gridAssetsIndex:d}}return null},a.prototype.getGridCellAssets=function(){var a,b,c,d,e,f,g,h;if(this.gridCellIndex===-1)return[];if(a=[],e=this._assetSuffixForCellCount(this.gridCellCount),d=new RegExp(""+e+"$"),d.test(this.gridAssets[this.gridCellIndex].asset.containerId))for(c=this._assetSuffixForCellCount(this.gridCellCount+1),b=f=g=this.gridCellIndex,h=this.gridAssets.length-1;g<=h?f<=h:f>=h;b=g<=h?++f:--f){if(this.gridAssets[b].asset.containerId.match(""+c+"$"))return a;a.push(this.gridAssets[b])}return a},a.prototype.isSplitGridCell=function(){var b,c,d,e,f,g,h,i,j;return!!this.doSplitGridCellNavigation||(b=this.currentDate(),null!=b&&(e=b.month,d=b.day,2!==e&&(g=function(a){return 1===a||3===a||5===a||7===a||8===a||10===a||12===a?31:4===a||6===a||9===a||11===a?30:void 0},c=a.MAX_GRID_CELL_COUNT-this.leadingNonDatedGridCellCount,f=g(e),!(c>f)&&(h=f-c,j=f-d,i=f-(d+7),j>=0&&j<h||i>=0&&i<h))))},a}(),b=function(){function b(a){this.pageModelStrategy=a}return b.prototype.newInstance=function(b){return new a(b,this.pageModelStrategy)},b}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon-gc").service("calendarGridCellIteratorFactory",["pageModelStrategy",b])}.call(this),function(){"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").constant("enums",{Finish:{MATTE:"matte",PADDED:"padded"},PageFinish:{GLOSSY:"glossy"},CoverType:{STOCK_CLOTH:"STOCK_CLOTH",STOCK_LEATHER:"STOCK_LEATHER",STOCK_LINEN:"STOCK_LINEN",STOCK_PREMIUM:"STOCK_PREMIUM",STOCK_SILK:"STOCK_SILK",USER_CUSTOM:"USER_CUSTOM",USER_CUSTOM_SOFT:"USER_CUSTOM_SOFT",USER_CUSTOM_WIDE:"USER_CUSTOM_WIDE",STOCK_CROCODILE:"STOCK_CROCODILE",STOCK_LIZARD:"STOCK_LIZARD"},CoverColors:{BLACK:"black",CAMEL:"camel",CHOCOLATE:"chocolate",WHITE:"white",IVORY:"ivory"},BindingType:{LAYFLAT:"layflat",HINGED_LAYFLAT:"hinged",LOOSELEAF:"looseleaf"},ProductFeature:{HARD_PHOTO_COVER:"hardCover",CLOTH_COVER:"clothCover",CRUSHED_SILK_COVER:"crushedSilkCover",GENUINE_LEATHER_COVER:"genuineLeatherCover",LEATHER_COVER:"leatherCover",LINEN_COVER:"linenCover",PADDED_COVER:"paddedCover",MATTE_COVER:"matteFinish",DUST_JACKET:"dustJacket",GLOSSY_PAGES:"glossyPaper",STANDARD_PAGES:"standardPaper",HINGED_LAYFLAT:"hinged",LAYFLAT:"layflat",KEEPSAKE_POCKET:"keepsakePocket"},AssetType:{IMAGE_TYPE:"image",GRAPHIC_TYPE:"graphic",TEXT_TYPE:"text"}})}.call(this),function(){var a;a=function(){function a(a,b,c,d,e,f,g){this.ModelInitializer=a,this.$injector=b,this.providedImageCollection=c,this.$filter=d,this.eventBus=e,this.productModelStrategy=f,this.projectEvents=g}var b,c;return a._referenceDate=new Date(Date.UTC(2001,0,1,0,0,0,0)),b=["title","userId","projectID","projectGUID"],c=["layoutUsage","backgroundUsage","frameUsage","stickerUsage","extendedPaletteContent","type"],a.prototype.init=function(d){return this.values=d,this._cachedProduct=null,this._reportingTable=null,this._cachedImageCollection=null,this.ModelInitializer.initialize(this,this.values,b),this.ModelInitializer.initializeImmutable(a.prototype,c),this._initReportingFieldCache(),this.product,this.imageCollection,this.projectEvents.init(this.values),this},a._sfgetter("product",function(){return null!=this._cachedProduct?this._cachedProduct:this._cachedProduct=this.productModelStrategy.initProduct(this.$injector,this.values)}),a._sfsetter("product",function(a){if(a.constructor===this.product.constructor)return null!=this.values.book?this.values.book=a.values:this.values.product=a.values,this._cachedProduct=null}),a._sfgetter("imageCollection",function(){var a;return null!=this._cachedImageCollection?this._cachedImageCollection:this._cachedImageCollection="function"==typeof(a=this.providedImageCollection).init?a.init(this.values.imageCollection,this):void 0}),a._sfgetter("ordered",function(){return"boolean"==typeof this.values.ordered?this.values.ordered:"true"===this.values.ordered.toLowerCase()}),a._sfsetter("ordered",function(a){if(this.ModelInitializer.isType(a,"boolean","Project.ordered"))return this.values.ordered=a}),a._sfgetter("hasUnfinishedUploads",function(){return"boolean"==typeof this.values.hasUnfinishedUploads?this.values.hasUnfinishedUploads:"true"===this.values.hasUnfinishedUploads.toLowerCase()}),a._sfsetter("hasUnfinishedUploads",function(a){if(this.ModelInitializer.isType(a,"boolean","Project.hasUnfinishedUploads"))return this.values.hasUnfinishedUploads=a}),a._sfgetter("hasBeenSaved",function(){return null!=this.projectGUID}),a._sfgetter("titleStr",function(){return this.hasBeenSaved?this.title:"Unsaved"}),a.prototype.ensureDefaultTitle=function(){if(!this.hasBeenSaved)return this.title=this.product.defaultTitle},a.prototype.setInitalReportingValue=function(a,b){if(null==this._reportingTable[a])return this.setReportingValue(a,b)},a.prototype.setReportingValue=function(a,b){var c;if(null!=b)return null==b.toString?void("undefined"!=typeof console&&null!==console&&"function"==typeof console.error&&console.error("Reporting data value: "+b+" for key: "+a+" doesn't have toString function.")):(null==this._reportingTable[a]&&(c=this.values.reportingData.properties,c.push({key:a,value:""}),this._reportingTable[a]=c[c.length-1]),this._reportingTable[a].value=b.toString())},a._sfgetter("reportingData",function(){return this._reportingTable}),a.prototype.getReportingValue=function(a){if(this._reportingTable[a])return this._reportingTable[a].value},a.prototype.removeReportingProperty=function(a){var b,c;return c=null,null!=this._reportingTable[a]&&(b=this.values.reportingData.properties.indexOf(this._reportingTable[a]))!==-1&&(c=this.values.reportingData.properties.splice(b,1)[0],delete this._reportingTable[a]),c},a.prototype.setExtendedPaletteContent=function(a){if(this.ModelInitializer.isType(a,"object"))return this.values.extendedPaletteContent=a},a.prototype.setReportingObject=function(a,b){if(("layoutUsage"===a||"backgroundUsage"===a||"stickerUsage"===a||"frameUsage"===a)&&this.ModelInitializer.isType(b,"object"))return this.values[a]=b},a.prototype._initReportingFieldCache=function(){var a,b,c,d,e;if(!this._reportingTable){for(this._reportingTable={},d=this.values.reportingData.properties,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(this._reportingTable[a.key]=a);return e}},a._sfgetter("isReadyToSave",function(){return this.imageCollection.isReadyToSave()}),a.prototype.updateProductImageAsset=function(a,b){var c,d,e,f,g,h,i,j,k,l;for(null==b&&(b=!1),k=this.product.allSurfaces,l=[],g=0,i=k.length;g<i;g++){for(e=k[g],f=!1,d=e.layout.assets,h=0,j=d.length;h<j;h++)c=d[h],c.projectImageId===a.productImageID&&(c.updateImage(a,b),f=!0);f?l.push(this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED,{pageNumber:e.surfaceNumber})):l.push(void 0)}return l},a.prototype.productContainsImageId=function(a){var b,c,d,e,f,g,h,i;if("string"!=typeof a)return!1;for(h=this.product.allSurfaces,d=0,f=h.length;d<f;d++)for(c=h[d],i=c.layout.assets,e=0,g=i.length;e<g;e++)if(b=i[e],b.imageId===a)return!0;return!1},a.prototype.clearProductImages=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;for(m=this.product.allSurfaces,n=[],g=0,j=m.length;g<j;g++){for(e=m[g],f=!1,c=e.layout.assets,h=0,k=c.length;h<k;h++)for(b=c[h],i=0,l=a.length;i<l;i++)d=a[i],b.projectImageId===d.productImageID&&(b.removeImageAssignment(),f=!0);f?n.push(this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED,{pageNumber:e.surfaceNumber})):n.push(void 0)}return n},a.prototype.clearAllProductImages=function(){var a,b,c,d,e,f,g,h;for(h=this.product.allSurfaces,d=0,f=h.length;d<f;d++)for(c=h[d],b=c.layout.assets,e=0,g=b.length;e<g;e++)a=b[e],"image"===a.asset.assetType&&a.removeImageAssignment();return this.product.invalidatePages()},a.prototype.clearOrphanedImageAssignments=function(){var a,b,c,d,e,f,g,h;for(c=[],this.imageCollection.projectImages.forEach(function(a){return c[a.productImageID]=a}),g=this.product.allSurfaces,h=[],e=0,f=g.length;e<f;e++)d=g[e],h.push(function(){var e,f,g,h;for(g=d.layout.assets,h=[],e=0,f=g.length;e<f;e++)a=g[e],"image"!==a.asset.assetType&&"graphic"!==a.asset.assetType||(b=c[a.projectImageId],null==(null!=b?b.imageId:void 0)||b.imageId!==a.imageId?h.push(a.removeImageAssignment()):h.push(void 0));return h}());return h},a._sfgetter("usedContent",function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n;for(b={},d={},f=this._usedContentArray(),g=0,j=f.length;g<j;g++){for(e=f[g],m=e.fontColors,h=0,k=m.length;h<k;h++)a=m[h],b[a.toUpperCase()]=a;for(n=e.fontIds,i=0,l=n.length;i<l;i++)c=n[i],d[c]=c}return{fontColors:b,fontIds:d}}),a.prototype._usedContentArray=function(){var a,b,c,d,e;for(d=this.product.allSurfaces,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(a.usedContent);return e},a._sfgetter("eventCollection",function(){return this.projectEvents.eventCollection}),a._sfgetter("isHiddenProject",function(){var a;return a={RANGER:!0,VOYAGER:!0},a[this.product.subtype.toUpperCase()]===!0}),a}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("project",["modelInitializer","$injector","imageCollection","$filter","eventBus","productModelStrategy","projectEvents",a])}.call(this),function(){"use strict";var a;a=function(){function a(a){this.config=a,this.imageAssociationsMap={}}return a.prototype.init=function(a){if(this.values=a,this.values.eventCollection&&this.config.features.advancedEventsTab&&this.values.eventCollection.imageAssociations)return this.imageAssociationsMap={},this.values.eventCollection.imageAssociations.forEach(function(a){return function(b){return a.imageAssociationsMap[b.eventId]=b}}(this))},a._sfgetter("eventCollection",function(){return this.values.eventCollection||(this.values.eventCollection={eventItems:[]}),this.values.eventCollection.imageAssociations||this.config.features.advancedEventsTab&&(this.values.eventCollection.imageAssociations=[]),this.values.eventCollection}),a.prototype.addEvent=function(a){if(this._getEventCollectionIndex(a)===-1)return a=this._cleanEvent(a),this.eventCollection.eventItems.push(a),a},a.prototype.publicEventDates=function(){var a,b,c,d;d={},this.eventCollection.eventItems.forEach(function(a){var b;if("public"===a.visibility)return b=new Date(a.year,a.month-1,a.day),null==d[b.getTime()]?d[b.getTime()]=b:void 0}),c=[];for(b in d)a=d[b],c.push(a);return c},a.prototype.eventsMatchingEventDate=function(a){return this.eventCollection.eventItems.filter(function(b){return""+b.day==""+a.day&&""+b.month==""+a.month&&""+b.year==""+a.year})},a.prototype._getEventCollectionIndex=function(a){var b,c,d,e,f;for(b=0,f=this.eventCollection.eventItems,d=0,e=f.length;d<e;d++){if(c=f[d],c.id===a.id)return b;b++}return-1},a.prototype._cleanEvent=function(a){return{id:a.id,year:a.year,month:a.month,day:a.day,name:a.name,type:a.type,relationship:a.relationship,visibility:a.visibility,recurring:a.recurring}},a.prototype.updateEvent=function(a){var b;if(b=this._getEventCollectionIndex(a),b>=0)return this.eventCollection.eventItems[b]=this._cleanEvent(a)},a.prototype.deleteEvent=function(a){var b;if(b=this._getEventCollectionIndex(a),b>=0)return this.eventCollection.eventItems.splice(b,1)[0]},a.prototype.getImageInformationForImage=function(a){var b,c,d;return b="llx="+a.cropllx+",lly="+a.croplly+",urx="+a.cropurx+",ury="+a.cropury,c="rotation="+a.rotation,d={imageMediaId:a.sflyId,imageView:""+b+","+c,projectImageId:a.productImageID}},a.prototype.addImageAssociation=function(a,b){var c;if(!this.config.features.advancedEventsTab)return null;if(c=this.getImageAssociation(a))throw new Error("event image association for eventId, "+a+", exists");return c=this._createImageAssociation(a,b),this.eventCollection.imageAssociations.push(c),this.imageAssociationsMap[a]=c,c},a.prototype._createImageAssociation=function(a,b){var c;return c={eventId:a,imageMediaId:b.imageMediaId,imageView:b.imageView,projectImageId:b.projectImageId,active:this._getActiveAssociationValue(b)}},a.prototype.updateImageAssociation=function(a,b){var c;if(!this.config.features.advancedEventsTab)return null;if(c=this.getImageAssociation(a),!c)throw new Error("event image association for eventId, "+a+", does not exist");return c.imageMediaId=b.imageMediaId,c.imageView=b.imageView,c.projectImageId=b.projectImageId,c},a.prototype._getActiveAssociationValue=function(a){return a.active===!0||"true"===a.active||void 0},a.prototype.removeImageAssociation=function(a){var b,c;return this.config.features.advancedEventsTab&&(b=this.getImageAssociation(a))?(c=this.eventCollection.imageAssociations.indexOf(b),c>=0&&this.eventCollection.imageAssociations.splice(c,1),delete this.imageAssociationsMap[a]):null},a.prototype._getImageAssociationIndex=function(a){var b,c,d,e,f;for(f=this.eventCollection.imageAssociations,c=d=0,e=f.length;d<e;c=++d)if(b=f[c],b.eventId===a)return c;return-1},a.prototype.getImageAssociation=function(a){return this.config.features.advancedEventsTab?this.imageAssociationsMap[a]||null:null},a}(),a.$inject=["CONFIG"],"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("projectEvents",a)}.call(this),function(){var a,b,c;c=0,a=function(){function a(a,b,c,d){this.ModelInitializer=a,this.layoutFactory=b,this.config=c,this.deviceDetectionService=d,this.superSimple=this.config.superSimple,this.superSimpleTablet=this.superSimple&&this.deviceDetectionService.isDeviceATablet()}var b;return a.TITLE_PAGE_NUMBER=1,a.BACK_FILLER_PAGE_NUMBER=-6,a.FRONT_FILLER_PAGE_NUMBER=-5,a.BACK_COVER_PAGE_NUMBER=-3,a.FRONT_COVER_PAGE_NUMBER=-1,a.SPINE_PAGE_NUMBER=-2,b=["layoutName"],a.prototype.init=function(a){return this.values=null!=a?a:{},this._cachedLayout=null,this._cachedInlayLayout=null,this._cachedFontIds=null,this._isStockCover=null!=this.values.stockCover,this.ModelInitializer.initialize(this,this.values,b),this.uid=c++,this.hideTextBoxes=!this.isCover()&&this.superSimpleTablet,this},a.prototype._fontIdDesiredFromText=function(a,b){return null!=(null!=a?a.fontId:void 0)&&null==b[a.fontId]&&(b[a.fontId]=!0,!0)},a.prototype.isEven=function(){return this.surfaceNumber>=this.constructor.TITLE_PAGE_NUMBER&&this.surfaceNumber%2===0},a.prototype.isBackFiller=function(){return this.surfaceNumber===this.constructor.BACK_FILLER_PAGE_NUMBER},a.prototype.isFrontFiller=function(){return this.surfaceNumber===this.constructor.FRONT_FILLER_PAGE_NUMBER},a.prototype.isFiller=function(){return this.isBackFiller()||this.isFrontFiller()},a.prototype.isTitlePage=function(){return this.surfaceNumber===this.constructor.TITLE_PAGE_NUMBER},a.prototype.isCover=function(){return this.isFrontCover()||this.isBackCover()||this.isSpine()},a.prototype.isFrontCover=function(){return this.surfaceNumber===this.constructor.FRONT_COVER_PAGE_NUMBER},a.prototype.isBackCover=function(){return this.surfaceNumber===this.constructor.BACK_COVER_PAGE_NUMBER},a.prototype.isSpine=function(){return this.surfaceNumber===this.constructor.SPINE_PAGE_NUMBER},a.prototype.isInnerPage=function(){return!(this.isFiller()||this.isCover()||this.surfaceNumber<=this.constructor.TITLE_PAGE_NUMBER)},a.prototype.isRemovablePage=function(){return this._isRemovable&&!this.isTitlePage()},a.prototype.getAdaptivePageType=function(){switch(!1){case!this.isFrontCover():return"front";case!this.isTitlePage():return"title";case!this.isBackCover():return"back";case!this.isSpine():return"spine";default:return"inner"}},a.prototype.indexOfAsset=function(a){var b,c,d,e,f;for(f=this.layout.assets,c=d=0,e=f.length;d<e;c=++d)if(b=f[c],b===a)return c;return-1},a.prototype.indexOfAssets=function(a,b){var c,d,e,f,g;for(g=this.layout.assets,c=e=0,f=g.length;e<f;c=++e)if(d=g[c],d&&d.uniqueProjectRef===b)return c;return-1},a.prototype.indexOfGraphicAsset=function(a,b,c){var d,e,f,g,h;if(null==this.values.layout)return-1;for(h=this.values.layout.assets,d=f=0,g=h.length;f<g;d=++f)if(e=h[d],e&&"graphic"===e.assetType&&e.assetReference.assetId===b&&e.container.id===a){if(!Array.isArray(c))return d;if(e.container.xOffset===c[0]&&e.container.yOffset===c[1])return d}return-1},a.prototype.getImageById=function(a){var b;return b=this.indexOfAssets("image",a),b===-1?null:this.layout.assets[b]},a.prototype.getInlayImage=function(){var a,b,c,d;if(!this.isStockCover)return null;for(d=this.inlayLayout.assets,b=0,c=d.length;b<c;b++)if(a=d[b],a&&"image"===a.asset.assetType)return a;return null},a.prototype.removeAssetAtIndex=function(a){return this.layout.removeAssetAtIndex(a)},a.prototype.removeAsset=function(a){return this.layout.removeAsset(a)},a.prototype.removeImage=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;if(this.isStockCover){for(c=null,j=this.values.stockCover.assets,f=0,h=j.length;f<h;f++)b=j[f],(null!=(k=b.container)?k.id:void 0)===a&&(c=b);for(l=this.values.layout.assets,g=0,i=l.length;g<i;g++)b=l[g],(null!=(m=c.imageAssignment)&&null!=(n=m.imageReference)?n.id:void 0)===(null!=(o=b.imageAssignment)&&null!=(p=o.imageReference)?p.id:void 0)&&(b.imageAssignment=null,c.imageAssignment=null);return d=this.getInlayImage(),d.removeImageAssignment(),this._cachedLayout=null}return e=this.indexOfAssets("image",a),e!==-1&&(null!=(q=this.layout.assets[e])&&q.removeImageAssignment(),!0)},a.prototype.removeGraphic=function(a,b,c){var d;return d=this.indexOfGraphicAsset(a,b,c),d!==-1&&(this.values.layout.assets.splice(d,1),this._cachedLayout=null,!0)},a.prototype.isSpread=function(){return this.layout.isSpread()},a.prototype.isPhotoSpready=function(){return this.isSpread()&&this.layout.isPhotoSpready()},a.prototype.isEmpty=function(){var a,b,c,d,e;for(e=this.layout.assets,c=0,d=e.length;c<d;c++)if(b=e[c],a=b.asset,a&&"image"===a.assetType||a&&"text"===a.assetType||"graphic"===a.assetType&&"background"!==a.type)return!1;return!0},a.prototype.hasNoText=function(){return 0===this.getFirstText()},a.prototype.getFirstText=function(){var a,b,c,d,e,f;for(b=-1,f=this.layout.assets,d=0,e=f.length;d<e;d++)c=f[d],b+=1,a=c.asset,a&&"text"===a.assetType;return b},a.prototype.isAutofillable=function(){return 0===this.getImages().length&&0===this.getText().length},a.prototype.isCustomizable=function(){return!(this.isStockCover&&this.isCover())},a.prototype.getImages=function(){return this.layout.assets.filter(function(a){return null!=a.asset&&"image"===a.asset.assetType&&a.hasAssignedImage()})},a.prototype.getEmptyImageWells=function(){return this.layout.assets.filter(function(a){return null!=a.asset&&"image"===a.asset.assetType&&!a.hasAssignedImage()})},a.prototype.getText=function(){return this.layout.assets.filter(function(a){return null!=a.asset&&"text"===a.asset.assetType&&a.hasContent()})},a.prototype.getFirstImage=function(){var a;return a=this.getImages(),a.length>0?a[0]:null},a.prototype.getFirstBackground=function(){var a;return a=this.getBackgrounds(),a.length>0?a[0]:null},a.prototype.getBackgroundsBeginningToEnding=function(){return this.getBackgrounds().sort(function(a,b){return a.asset.xOffset-b.asset.xOffset})},a.prototype.getBackgrounds=function(){return this._getGraphicsByType("background")},a.prototype.getStickers=function(){return this._getGraphicsByType("embellishment")},a.prototype.getFrames=function(){var a,b,c,d,e,f,g;for(d=[],g=this.layout.assets,e=0,f=g.length;e<f;e++)b=g[e],a=b.asset,"image"===a.assetType&&(c=a.values.container.objectStyle,"frame_none"!==c&&d.push(c));return d},a.prototype._getGraphicsByType=function(a){var b,c,d,e,f,g;for(d=[],g=this.layout.assets,e=0,f=g.length;e<f;e++)c=g[e],b=c.asset,b&&"graphic"===b.assetType&&b.type===a&&d.push(c);return d},a.prototype.getTextAreas=function(){var a,b,c,d,e,f;for(c=[],f=this.layout.assets,d=0,e=f.length;d<e;d++)b=f[d],a=b.asset,a&&"text"===a.assetType&&c.push(b);return c},a.prototype.hasPopulatedTextAreas=function(){var a,b,c,d;for(d=this.getTextAreas(),b=0,c=d.length;b<c;b++)if(a=d[b],a.hasContent())return!0;return!1},a.prototype.removeAllText=function(){var a,b,c,d,e;for(e=this.getTextAreas(),c=0,d=e.length;c<d;c++)b=e[c],b.hasContent()&&(a=b.styles,a.verticalAlign="top",b.updateTextWithWrapsAndStyle(null,[],!1,a))},a.prototype.getFrameAppliedImages=function(){var a,b,c,d,e,f;for(c=[],f=this.layout.assets,d=0,e=f.length;d<e;d++)b=f[d],a=b.asset,a&&"image"===a.assetType&&a.objectStyle&&"frame_none"!==a.objectStyle&&c.push(b);return c},a.prototype.moveAssetAtIndex=function(a,b){return this.layout.moveAssetAtIndex(a,b)},a.prototype.addEmbellishment=function(a){return this.layout.addAsset(a),this._cachedLayout=null,this.customLayout=!0},a.prototype.addAsset=function(a){if(null!=a)return this.layout.addAsset(a)},a.prototype.hasAudio=function(){var a,b,c,d;for(d=this.layout.assets,b=0,c=d.length;b<c;b++)if(a=d[b],"audio"===a.asset.assetType)return!0;return!1},a.prototype.hasStorytellingAsset=function(a){var b,c,d,e,f,g;for(f=this.layout.assets,d=0,e=f.length;d<e;d++)if(c=f[d],b=c.asset,b&&"graphic"===b.assetType&&a.hasAsset(null!=(g=b.values.assetReference)?g.assetId:void 0))return!0;return!1},a.prototype.hasStorytellingLayout=function(a){return this.isSpread()?a.hasAsset(this.getSpreadLayoutName()):a.hasAsset(this.layoutName)},a.prototype.getSpreadLayoutName=function(){return this._parseAssetSourceId(this.layout.values.template.assetSource.id)},a.prototype._parseAssetSourceId=function(a){var b;return null!=a&&(b=/([\w-]+).indd$/.exec(a),null!=b&&2===b.length)?b[1]:""},a.initGettersSetters=function(){return this._sfgetter("isGrid",function(){var a;return(null!=(a=this.surfaceKey)?a.length:void 0)>0&&this.surfaceNumber%2===1&&1!==this.surfaceNumber}),this._sfgetter("layout",function(){return null!=this._cachedLayout?this._cachedLayout:this.isStockCover?this._cachedLayout=this.layoutFactory.newInstance(this.values.stockCover):this._cachedLayout=this.layoutFactory.newInstance(this.values.layout)}),this._sfsetter("layout",function(a){if(this.ModelInitializer.isType(a,"object","Page.layout"))return this.values.layout=a.values,this._isStockCover=!1,this._cachedLayout=null,this._cachedInlayLayout=null,this._cachedFontIds=null}),this._sfgetter("inlayLayout",function(){return null!=this._cachedInlayLayout?this._cachedInlayLayout:this.isStockCover&&this.values.layout?this._cachedInlayLayout=this.layoutFactory.newInstance(this.values.layout):this._cachedInlayLayout=null}),this._sfgetter("layoutVersion",function(){return parseInt(this.values.layoutVersion)}),this._sfsetter("layoutVersion",function(a){if(this.ModelInitializer.isType(a,"number","Page.layoutVersion"))return this.values.layoutVersion=a.toString()}),this._sfgetter("surfaceNumber",function(){return parseInt(this.values.surfaceNumber)}),this._sfsetter("surfaceNumber",function(a){if(this.ModelInitializer.isType(a,"number","Page.surfaceNumber"))return this.values.surfaceNumber=a.toString()}),this._sfgetter("surfaceKey",function(){return this.values.surfaceKey}),this._sfsetter("surfaceKey",function(a){return null!=a?this.values.surfaceKey=a:delete this.values.surfaceKey}),this._sfgetter("ideaLayout",function(){var a;return"boolean"==typeof this.values.ideaLayout?this.values.ideaLayout:"true"===(null!=(a=this.values.ideaLayout)?a.toLowerCase():void 0)}),this._sfsetter("ideaLayout",function(a){if(this.ModelInitializer.isType(a,"boolean","Page.ideaLayout"))return this.values.ideaLayout=a}),this._sfgetter("customLayout",function(){var a;return"boolean"==typeof this.values.customLayout?this.values.customLayout:"true"===(null!=(a=this.values.customLayout)?a.toLowerCase():void 0)}),this._sfsetter("customLayout",function(a){if(this.ModelInitializer.isType(a,"boolean","Page.customLayout"))return this.values.customLayout=a}),this._sfgetter("flippedLayout",function(){return null!=this.values.flippedLayout&&("boolean"==typeof this.values.flippedLayout?this.values.flippedLayout:"true"===this.values.flippedLayout.toLowerCase())}),this._sfsetter("flippedLayout",function(a){if(this.ModelInitializer.isType(a,"boolean","Page.flippedLayout"))return this.values.flippedLayout=a}),this._sfgetter("appliedLayout",function(){var a;return!(this.layout.assets.length<=1&&(null!=(a=this.layoutName)?a.indexOf("universal_00_00L00P00"):void 0)!==-1)}),this._sfgetter("displayPageNumber",function(){return this.isFrontCover()?"SilverApp.frontCover":this.isBackCover()?"SilverApp.backCover":this.surfaceNumber>=this.constructor.TITLE_PAGE_NUMBER?this.surfaceNumber:""}),this._sfgetter("fontIds",function(){var a,b,c,d;return null!=this._cachedFontIds?this._cachedFontIds:(this._cachedFontIds=[],(null!=(c=this.layout)&&null!=(d=c.assets)?d.length:void 0)>0?(a={},this._cachedFontIds=function(){var c,d,e,f;for(e=this.layout.assets,f=[],c=0,d=e.length;c<d;c++)b=e[c],this._fontIdDesiredFromText(b,a)&&f.push(b.fontId);return f}.call(this),this._cachedFontIds):this._cachedFontIds)}),this._sfgetter("usedContent",function(){var a,b,c,d,e,f,g,h,i,j;for(c={},b={},i=this.layout.assets,g=0,h=i.length;g<h;g++)f=i[g],null!=(null!=f?f.fontId:void 0)&&(c[f.fontId]=f.fontId,e=null!=(j=f.styles.color)?j.toUpperCase():void 0,b[e]=f.styles.color);return{fontIds:function(){var a;a=[];for(d in c)a.push(d);return a}(),fontColors:function(){var c;c=[];for(a in b)c.push(a);return c}()}}),this._sfgetter("isStockCover",function(){return this._isStockCover}),this._sfgetter("isFlippingAllowed",function(){return!(this._isStockCover||this.isSpine()||this.isGrid)})},a}(),b=function(){function b(b,c,d,e){this.ModelInitializer=b,this.layoutFactory=c,this.config=d,this.deviceDetectionService=e,this.Page=a,a.initGettersSetters()}return b.prototype.newInstance=function(b,c){var d;return null==c&&(c=!0),d=new a(this.ModelInitializer,this.layoutFactory,this.config,this.deviceDetectionService).init(b),d._isRemovable=c,d},b}(),b.$inject=["modelInitializer","layoutFactory","CONFIG","deviceDetectionService"],"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("pageFactory",b)}.call(this),function(){var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b,d,e,f,g,h){this.ModelInitializer=a,this.graphicAssetFactory=b,this.imageAssetFactory=d,this.textAssetFactory=e,this.audioAssetFactory=f,this.contentService=g,this.globalContentService=h,this._audioAsset=c(this._audioAsset,this),this._textAsset=c(this._textAsset,this),this._graphicAsset=c(this._graphicAsset,this),this._imageAsset=c(this._imageAsset,this),
this._hasValidValues=c(this._hasValidValues,this)}var b;return b=["type"],a.prototype.init=function(a){return this.values=null!=a?a:{},this._cachedAssets=null,this.ModelInitializer.initialize(this,this.values,b),this},a.prototype._methodForAssetType=function(a){return"_"+a+"Asset"},a.prototype._hasValidValues=function(a){var b;return"text"===a.assetType&&this._applyFontName(a),("text"!==a.assetType||"page_num_"!==(null!=a&&null!=(b=a.paraStyle)?b.substring(0,9):void 0))&&"function"==typeof this[this._methodForAssetType(a.assetType)]},a.prototype._imageAsset=function(a){return this.imageAssetFactory.newInstance(a)},a.prototype._graphicAsset=function(a){return this.graphicAssetFactory.newInstance(a)},a.prototype._textAsset=function(a){return this.textAssetFactory.newInstance(a)},a.prototype._audioAsset=function(a){return this.audioAssetFactory.newInstance(a)},a.prototype._applyFontName=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;if(null!=(null!=(g=a.text)&&null!=(h=g.TextFlow)?h.p:void 0))for(i=a.text.TextFlow.p,c=0,e=i.length;c<e;c++)b=i[c],this._applyFontNameToParagraph(b);if(null!=(null!=(j=a.text)&&null!=(k=j.TextFlow)&&null!=(l=k.div)?l.p:void 0)){for(m=a.text.TextFlow.div.p,n=[],d=0,f=m.length;d<f;d++)b=m[d],n.push(this._applyFontNameToParagraph(b));return n}},a.prototype._applyFontNameToParagraph=function(a){var b,c,d,e,f,g;for(e=a.spans,g=[],c=0,d=e.length;c<d;c++)b=e[c],null==b.fontName?g.push(b.fontName=null!=(f=this.globalContentService.getFontForFontId(b.fontId))?f.fontName:void 0):g.push(void 0);return g},a.prototype.clearAboveBackground=function(){var a,b,c,d;if(this.assets.length>0){for(d=[],a=b=c=this.assets.length-1;c<=0?b<=0:b>=0;a=c<=0?++b:--b)this.assets[a].asset.isBackground()?d.push(void 0):d.push(this.removeAssetAtIndex(a));return d}},a.prototype.convertToSpread=function(){var a,b,c,d,e;if(!this.isSpread()&&(null!=(c=this.values)&&null!=(d=c.template)&&null!=(e=d.surfaces)?e.length:void 0)>0)return this.width=2*this.width,this.type="Spread",a=this.values.template.surfaces[0],b={xOffset:""+a.width,yOffset:"0",width:""+a.width,height:""+a.height},this.values.template.surfaces=[a,b]},a.prototype.isSpread=function(){return"Spread"===this.type},a.prototype.isPhotoSpready=function(){return!!this.isSpread()&&this.hasPictureAsBackground()},a.prototype.hasPictureAsBackground=function(){var a,b,c,d,e,f;if(null!=(null!=(d=this.assets[0].values)?d.imageAssignment:void 0)&&this.assets[0].values.imageAssignment.imageReference)return!0;for(e=this.assets,b=0,c=e.length;b<c;b++)if(a=e[b],"image"===(null!=(f=a.asset)?f.assetType:void 0))return a.background===!0;return!1},a.prototype.getBackgroundImageAssignment=function(){var a,b,c,d,e,f;if(null!=(null!=(d=this.assets[0].values.imageAssignment)?d.imageReference:void 0))return this.assets[0].values.imageAssignment;for(e=this.assets,b=0,c=e.length;b<c;b++)if(a=e[b],"image"===(null!=(f=a.asset)?f.assetType:void 0)&&a.background===!0)return a.values.imageAssignment;return null},a.prototype.addAsset=function(a){var b,c;if(b=a.values,null!=(c=this.values.assets)&&c.push(b),this._cachedAssets&&this._hasValidValues(b))return this._cachedAssets.push(this[this._methodForAssetType(b.assetType)](b))},a.prototype.addAssetByIndex=function(a,b,c){var d,e;if(d=a.values,this._cachedAssets&&this._hasValidValues(d))return this._cachedAssets.splice(b,0,this[this._methodForAssetType(d.assetType)](d)),null!=(e=this.values.assets)?e.splice(c,0,d):void 0},a.prototype.indexOfAssetValues=function(a){var b,c,d,e,f;for(f=this.values.assets,b=d=0,e=f.length;d<e;b=++d)if(c=f[b],angular.equals(c,a.values))return b;return-1},a.prototype.nextSeqNum=function(a){var b,c,d,e,f;for(c=0,f=this.assets,d=0,e=f.length;d<e;d++)b=f[d],b.asset.assetType===a&&c++;return c+1},a.prototype.generateContainerId=function(){var a,b,c,d,e;for(b=Math.round(8999*Math.random()+1e3),e=this.assets,c=0,d=e.length;c<d;c++)if(a=e[c],a.asset.containerId===b)return this.generateContainerId();return b.toString()},a.prototype.removeAssetAtIndex=function(a){var b,c,d,e,f,g,h,i;if(a>=0&&null!=a){for(f=this.values.assets,c=d=0,e=f.length;d<e;c=++d)if(b=f[c],b===(null!=(g=this._cachedAssets[a])?g.values:void 0)){null!=(h=this.values.assets)&&h.splice(c,1);break}return null!=(i=this._cachedAssets)?i.splice(a,1):void 0}},a.prototype.moveAssetAtIndex=function(a,b){var c,d;if(a!==b)return null!=this._cachedAssets&&(c=this.values.assets.indexOf(this._cachedAssets[a].values),d=this.values.assets.indexOf(this._cachedAssets[b].values),this._cachedAssets.splice(b,0,this._cachedAssets.splice(a,1)[0])),this.values.assets.splice(d,0,this.values.assets.splice(c,1)[0])},a.prototype.removeAsset=function(a){var b,c,d,e,f,g,h;if(null!=a){if(a.assetType===(null!=(f=a.asset)?f.constructor.VIRTUAL_IMAGE_TYPE:void 0))return this.removeVirtualAsset(a);for(c=a,null!=a.values&&(c=a.values),g=this._cachedAssets,h=[],b=d=0,e=g.length;d<e;b=++d){if(a=g[b],angular.equals(a.values,c)){this.removeAssetAtIndex(b);break}h.push(void 0)}return h}},a.prototype.removeVirtualAsset=function(a){var b,c,d,e,f,g;if(null!=a){for(f=this._cachedAssets,g=[],b=d=0,e=f.length;d<e;b=++d){if(c=f[b],angular.equals(c,a)){this.removeAssetAtIndex(b);break}g.push(void 0)}return g}},a.initGettersSetters=function(){return this._sfgetter("assets",function(){var a,b;return null!=this._cachedAssets?this._cachedAssets:(this._cachedAssets=[],null==(null!=(b=this.values)?b.assets:void 0)?this._cachedAssets:this._cachedAssets=function(){var b,c,d,e;for(d=this.values.assets,e=[],b=0,c=d.length;b<c;b++)a=d[b],this._hasValidValues(a)&&e.push(this[this._methodForAssetType(a.assetType)](a));return e}.call(this))}),this._sfgetter("bleedBottom",function(){return parseFloat(this.values.bleedBottom)}),this._sfsetter("bleedBottom",function(a){if(this.ModelInitializer.isType(a,"number","Layout.bleedBottom"))return this.values.bleedBottom=a.toString()}),this._sfgetter("bleedTop",function(){return parseFloat(this.values.bleedTop)}),this._sfsetter("bleedTop",function(a){if(this.ModelInitializer.isType(a,"number","Layout.bleedTop"))return this.values.bleedTop=a.toString()}),this._sfgetter("bleedInside",function(){return parseFloat(this.values.bleedInside)}),this._sfsetter("bleedInside",function(a){if(this.ModelInitializer.isType(a,"number","Layout.bleedInside"))return this.values.bleedInside=a.toString()}),this._sfgetter("bleedOutside",function(){return parseFloat(this.values.bleedOutside)}),this._sfsetter("bleedOutside",function(a){if(this.ModelInitializer.isType(a,"number","Layout.bleedOutside"))return this.values.bleedOutside=a.toString()}),this._sfgetter("isFlippable",function(){return!!this.values.template.assetReference.isFlippable&&"true"===this.values.template.assetReference.isFlippable}),this._sfgetter("width",function(){return parseFloat(this.values.width)}),this._sfsetter("width",function(a){if(this.ModelInitializer.isType(a,"number","Layout.width"))return this.values.width=a.toString()}),this._sfgetter("height",function(){return parseFloat(this.values.height)}),this._sfsetter("height",function(a){if(this.ModelInitializer.isType(a,"number","Layout.height"))return this.values.height=a.toString()}),this._sfgetter("templateAssetId",function(){var a;return null!=(a=this.values.template)?a.assetReference.assetId:void 0}),this._sfgetter("templateAssetVersion",function(){var a,b;if(a=null!=(b=this.values.template)?b.assetReference.version:void 0)return parseInt(a)}),this._sfgetter("spreadAssetWidth",function(){return 2*this.width+(this.bleedInside+this.bleedOutside)}),this._sfgetter("fullBleedWidth",function(){return this.width+(this.bleedInside+this.bleedOutside)})},a}(),b=function(){function b(b,c,d,e,f,g,h,i){this.ModelInitializer=b,this.assetFactory=c,this.graphicAssetFactory=d,this.imageAssetFactory=e,this.textAssetFactory=f,this.audioAssetFactory=g,this.contentService=h,this.globalContentService=i,a.initGettersSetters()}return b.prototype.newInstance=function(b){return new a(this.ModelInitializer,this.assetFactory,this.graphicAssetFactory,this.imageAssetFactory,this.textAssetFactory,this.audioAssetFactory,this.contentService,this.globalContentService).init(b)},b}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("layoutFactory",["modelInitializer","graphicAssetFactory","imageAssetFactory","textAssetFactory","audioAssetFactory","contentService","globalContentService",b])}.call(this),function(){"use strict";var a,b,c;c=0,a=function(){function a(a){this.ModelInitializer=a}var b;return a.IMAGE_TYPE="image",a.GRAPHIC_TYPE="graphic",a.TEXT_TYPE="text",a.VIRTUAL_IMAGE_TYPE="virtual-image",b=["assetType","layer","scriptLabel","seqNum","guidanceText"],a.prototype.init=function(a){return this.values=a,this.generatedAssetId=""+c++,this.cachedSfProperties={},this},a.prototype.isSplitBottom=function(){return/-2$/.test(this.containerId)},a.prototype.isSplitComparedToImageAsset=function(a){return this.isSplitBottom()||this.height<=a.height/2},a.prototype.isBackground=function(){var a,b;return"background"===(null!=(a=this.values)&&null!=(b=a.type)?b.toLowerCase():void 0)},a.prototype._validFloat=function(a){return!isNaN(parseFloat(a))},a.initGettersSetters=function(){return this._sfgetter("type",function(){var a,b;return null!=(a=this.values.assetReference)&&null!=(b=a.assetType)?b.toLowerCase():void 0}),this._sfgetter("assetId",function(){var a;return null!=(a=this.values.assetReference)?a.assetId:void 0}),this._sfgetter("borderColor",function(){return this.values.container.borderColor}),this._sfsetter("borderColor",function(a){if(this.ModelInitializer.isType(a,"string","Asset.borderColor"))return this.values.container.borderColor=a}),this._sfgetter("borderColorRGB",function(){return this.values.container.borderColorRGB}),this._sfsetter("borderColorRGB",function(a){if(this.ModelInitializer.isType(a,"string","Asset.borderColorRGB"))return this.values.container.borderColorRGB=a}),this._sfgetter("borderStroke",function(){var a;return null!=(a=this.cachedSfProperties).borderStroke?a.borderStroke:a.borderStroke=parseFloat(this.values.container.borderStroke)}),this._sfsetter("borderStroke",function(a){if(this.ModelInitializer.isType(a,"number","Asset.borderStroke"))return this.cachedSfProperties.borderStroke=null,this.values.container.borderStroke=a.toString()}),this._sfgetter("displayAsObject",function(){return"boolean"==typeof this.values.container.displayAsObject?this.values.container.displayAsObject:"true"===this.values.container.displayAsObject.toLowerCase()}),this._sfgetter("frameOwnedByUser",function(){return"boolean"==typeof this.values.container.frameOwnedByUser?this.values.container.frameOwnedByUser:"true"===this.values.container.frameOwnedByUser.toLowerCase()}),this._sfsetter("frameOwnedByUser",function(a){return this.values.container.frameOwnedByUser=a===!0||"true"===a}),this._sfgetter("locked",function(){var a;return null!=(a=this.cachedSfProperties).locked?a.locked:a.locked="true"===(""+this.values.container.locked).toLowerCase()}),this._sfgetter("objectStyle",function(){return this.values.container.objectStyle}),this._sfsetter("objectStyle",function(a){if(this.ModelInitializer.isType(a,"string","Asset.objectStyle"))return this.values.container.objectStyle=a}),this._sfgetter("paraStyle",function(){return this.values.container.paraStyle}),this._sfgetter("visible",function(){return"boolean"==typeof this.values.container.visible?this.values.container.visible:"true"===this.values.container.visible.toLowerCase()}),this._sfsetter("visible",function(a){return this.values.container.visible=a===!0||"true"===a}),this._sfsetter("overflow",function(a){return this.values.container.overflow=a===!0||"true"===a}),this._sfgetter("overflow",function(){return"boolean"==typeof this.values.container.overflow?this.values.container.overflow:"true"===this.values.container.overflow.toLowerCase()}),this._sfgetter("rotationLimit",function(){return null!=this.imageRotationLimit?this.imageRotationLimit:this.containerRotationLimit}),this._sfgetter("verticalScale",function(){return null!=this.imageVerticalScale?this.imageVerticalScale:this.containerVerticalScale}),this._sfgetter("xOffset",function(){return null!=this.imageXOffset?this.imageXOffset:this.containerXOffset}),this._sfsetter("xOffset",function(a){if(this.ModelInitializer.isType(a,"number","Asset.xOffset"))return null!=this.imageXOffset&&(this.imageXOffset=a),null!=this.containerXOffset?this.containerXOffset=a:void 0}),this._sfsetter("yOffset",function(a){if(this.ModelInitializer.isType(a,"number","Asset.yOffset"))return null!=this.imageYOffset&&(this.imageYOffset=a),null!=this.containerYOffset?this.containerYOffset=a:void 0}),this._sfgetter("yOffset",function(){return null!=this.imageYOffset?this.imageYOffset:this.containerYOffset}),this._sfsetter("height",function(a){if(this.ModelInitializer.isType(a,"number","Asset.height"))return null!=this.imageHeight&&(this.imageHeight=a),null!=this.containerHeight?this.containerHeight=a:void 0}),this._sfgetter("height",function(){return null!=this.imageHeight?this.imageHeight:this.containerHeight}),this._sfsetter("width",function(a){if(this.ModelInitializer.isType(a,"number","Asset.width"))return null!=this.imageWidth&&(this.imageWidth=a),null!=this.containerWidth?this.containerWidth=a:void 0}),this._sfgetter("width",function(){return null!=this.imageWidth?this.imageWidth:this.containerWidth}),this._sfsetter("rotation",function(a){if(this.ModelInitializer.isType(a,"number","Asset.rotation"))return null!=this.imageRotation&&(this.imageRotation=a),this.containerRotation=a}),this._sfgetter("rotation",function(){return null!=this.imageRotation?this.imageRotation:this.containerRotation}),this._sfgetter("containerType",function(){return this.values.container.type}),this._sfgetter("containerId",function(){return this.values.container.id}),this._sfgetter("containerNextId",function(){return this.values.container.nextId}),this._sfgetter("containerPreviousId",function(){return this.values.container.previousId}),this._sfgetter("containerWidth",function(){var a;return null!=(a=this.cachedSfProperties).containerWidth?a.containerWidth:a.containerWidth=parseFloat(this.values.container.width)}),this._sfsetter("containerWidth",function(a){if(this.ModelInitializer.isType(a,"number","Asset.containerWidth"))return this.cachedSfProperties.containerWidth=null,this._validFloat(a)?this.values.container.width=a:void 0}),this._sfgetter("containerHeight",function(){var a;return null!=(a=this.cachedSfProperties).containerHeight?a.containerHeight:a.containerHeight=parseFloat(this.values.container.height)}),this._sfsetter("containerHeight",function(a){if(this.ModelInitializer.isType(a,"number","Asset.containerHeight"))return this.cachedSfProperties.containerHeight=null,this._validFloat(a)?this.values.container.height=a:void 0}),this._sfgetter("containerRotation",function(){var a;return null!=(a=this.cachedSfProperties).containerRotation?a.containerRotation:a.containerRotation=parseFloat(this.values.container.rotation)}),this._sfsetter("containerRotation",function(a){if(this.ModelInitializer.isType(a,"number","Asset.containerRotation"))return this.cachedSfProperties.containerRotation=null,this._validFloat(a)?this.values.container.rotation=a:void 0}),this._sfgetter("containerRotationLimit",function(){return parseFloat(this.values.container.rotationLimit)}),this._sfgetter("containerVerticalScale",function(){var a;return null!=(a=this.cachedSfProperties).containerVerticalScale?a.containerVerticalScale:a.containerVerticalScale=parseFloat(this.values.container.verticalScale)}),this._sfgetter("containerXOffset",function(){var a;return null!=(a=this.cachedSfProperties).containerXOffset?a.containerXOffset:a.containerXOffset=parseFloat(this.values.container.xOffset)}),this._sfsetter("containerXOffset",function(a){if(this.ModelInitializer.isType(a,"number","Asset.containerXOffset"))return this.cachedSfProperties.containerXOffset=null,this._validFloat(a)?this.values.container.xOffset=a:void 0}),this._sfgetter("containerYOffset",function(){var a;return null!=(a=this.cachedSfProperties).containerYOffset?a.containerYOffset:a.containerYOffset=parseFloat(this.values.container.yOffset)}),this._sfsetter("containerYOffset",function(a){if(this.ModelInitializer.isType(a,"number","Asset.containerYOffset"))return this.cachedSfProperties.containerYOffset=null,this._validFloat(a)?this.values.container.yOffset=a:void 0}),this._sfgetter("imageWidth",function(){var a;return null!=(a=this.cachedSfProperties).imageWidth?a.imageWidth:a.imageWidth=null!=this.values.imageRectangle?parseFloat(this.values.imageRectangle.width):null}),this._sfsetter("imageWidth",function(a){if(this.ModelInitializer.isType(a,"number","Asset.imageWidth"))return this.cachedSfProperties.imageWidth=null,this._validFloat(a)&&null!=this.values.imageRectangle?this.values.imageRectangle.width=a:void 0}),this._sfgetter("imageHeight",function(){var a;return null!=(a=this.cachedSfProperties).imageHeight?a.imageHeight:a.imageHeight=null!=this.values.imageRectangle?parseFloat(this.values.imageRectangle.height):null}),this._sfsetter("imageHeight",function(a){if(this.ModelInitializer.isType(a,"number","Asset.imageHeight"))return this.cachedSfProperties.imageHeight=null,this._validFloat(a)&&null!=this.values.imageRectangle?this.values.imageRectangle.height=a:void 0}),this._sfgetter("imageRotation",function(){var a;return null!=(a=this.cachedSfProperties).imageRotation?a.imageRotation:a.imageRotation=null!=this.values.imageRectangle?parseFloat(this.values.imageRectangle.rotation):null}),this._sfsetter("imageRotation",function(a){if(this.ModelInitializer.isType(a,"number","Asset.imageRotation"))return this.cachedSfProperties.imageRotation=null,this._validFloat(a)&&null!=this.values.imageRectangle?this.values.imageRectangle.rotation=a:void 0}),this._sfgetter("imageRotationLimit",function(){return null!=this.values.imageRectangle?parseFloat(this.values.imageRectangle.rotationLimit):null}),this._sfgetter("imageVerticalScale",function(){var a;return null!=(a=this.cachedSfProperties).imageVerticalScale?a.imageVerticalScale:a.imageVerticalScale=null!=this.values.imageRectangle?parseFloat(this.values.imageRectangle.verticalScale):null}),this._sfgetter("imageXOffset",function(){var a;return null!=(a=this.cachedSfProperties).imageXOffset?a.imageXOffset:a.imageXOffset=null!=this.values.imageRectangle?parseFloat(this.values.imageRectangle.xOffset):null}),this._sfsetter("imageXOffset",function(a){if(this.ModelInitializer.isType(a,"number","Asset.imageXOffset"))return this.cachedSfProperties.imageXOffset=null,this._validFloat(a)&&null!=this.values.imageRectangle?this.values.imageRectangle.xOffset=a:void 0}),this._sfgetter("imageYOffset",function(){var a;return null!=(a=this.cachedSfProperties).imageYOffset?a.imageYOffset:a.imageYOffset=null!=this.values.imageRectangle?parseFloat(this.values.imageRectangle.yOffset):null}),this._sfsetter("imageYOffset",function(a){if(this.ModelInitializer.isType(a,"number","Asset.imageYOffset"))return this.cachedSfProperties.imageYOffset=null,this._validFloat(a)&&null!=this.values.imageRectangle?this.values.imageRectangle.yOffset=a:void 0})},a}(),b=function(){function b(b){var c;this.ModelInitializer=b,c=["assetType","layer","scriptLabel","seqNum","guidanceText"],a.initGettersSetters(),this.ModelInitializer.initializeImmutable(a.prototype,c)}return b.prototype.newInstance=function(b){return new a(this.ModelInitializer).init(b)},b}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("assetFactory",["modelInitializer",b])}.call(this),function(){var a,b;a=function(){function a(){}return a.prototype.init=function(a){return this.values=a,this._cachedStyles=null,this},a.initGettersSetters=function(){return this._sfgetter("styles",function(){var a,b,c;return null!=this._cachedStyles?this._cachedStyles:(c=this.values.spans[0],a=parseFloat(null!=c?c.fontSize:void 0),b=parseFloat(null!=c?c.lineHeight:void 0),this._cachedStyles={marginBottom:null===this.values.marginBottom?0:parseFloat(this.values.marginBottom),marginTop:null===this.values.marginTop?0:parseFloat(this.values.marginTop),baselineShift:parseFloat(null!=c?c.baselineShift:void 0),color:null!=c?c.color:void 0,fontFamily:null!=c?c.fontFamily:void 0,fontName:null!=c?c.fontName:void 0,fontId:null!=c?c.fontId:void 0,fontSize:a,fontStyle:null!=c?c.fontStyle:void 0,fontWeight:null!=c?c.fontWeight:void 0,lineHeight:b,leading:b,textDecoration:null!=c?c.textDecoration:void 0,textAlign:this.values.textAlign,halfLeading:1.2*a-a},this._cachedStyles)}),this._sfgetter("text",function(){var a,b;return null!=(a=this.values.spans[0])&&null!=(b=a.text)?b.split("").slice(this.begin,this.end).join(""):void 0})},a}(),b=function(){function b(){a.initGettersSetters()}return b.prototype.newInstance=function(b,c,d){var e;return e=(new a).init(b),e.begin=c,e.end=d,e},b}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("textLineFactory",[b])}.call(this),function(){var a,b;a=function(){function a(a,b){this.assetFactory=a,this.textLineFactory=b}return a.prototype.init=function(a){return this.values=a,this._cachedAsset=null,this._cachedLines=null,this._hardWrappedLines=null,this.values.useWeb2Print="true",this.cachedSfProperties={},this},a.prototype._processHardWrappedLines=function(a){var b,c,d,e,f,g;for(g=[],c=0,d=a.length;c<d;c++)b=a[c],g.push(this._hardWrappedLines.push(null!=b&&null!=(e=b.spans)&&null!=(f=e[0])?f.text:void 0));return g},a.prototype._processParagraph=function(a,b,c){var d,e,f,g,h,i,j;if(null==c&&(c=!1),(null!=b&&null!=(g=b.spans)?g.length:void 0)>0)return f=null!=(h=this.values.text)&&null!=(i=h.textWraps[0])&&null!=(j=i.paragraphs[a])?j.lines:void 0,(null==f||(null!=f?f.length:void 0)<1)&&(f=[{startAtChar:1}]),this._cachedLines=this._cachedLines.concat(function(){var a,c,g;for(g=[],e=a=0,c=f.length;a<c;e=++a)d=f[e],g.push(this._processWrap(e,f,d,b));return g}.call(this))},a.prototype._processWrap=function(a,b,c,d){var e,f,g;return g=d.spans[0],1===b.length?(e=0,f=void 0):(e=0===a?0:this._beginIndexForWrap(c),f=a===b.length-1?g.text.length:this._endIndexForWrap(b[a+1])),this.textLineFactory.newInstance(d,e,f)},a.prototype._beginIndexForWrap=function(a){return null==(null!=a?a.startAtChar:void 0)?0:a.startAtChar-1},a.prototype._endIndexForWrap=function(a){if(null!=(null!=a?a.startAtChar:void 0))return a.startAtChar-1},a.prototype.hasContent=function(){var a;return null!=(a=this.lines)?a.some(function(a,b,c){var d;return(null!=(d=a.text)?d.length:void 0)>0}):void 0},a.prototype.hasLatinCharacters=function(){var a,b,c,d,e;for(a=/[áéíóúüÜñÑ¿¡ÁÉÍÓÚ]/,e=this.lines,c=0,d=e.length;c<d;c++)if(b=e[c],a.test(b.text))return!0;return!1},a.prototype.updateTextWithWrapsAndStyle=function(a,b,c,d){var e,f,g,h;return this._validateStyles(d),b.sort(function(a,b){return a-b}),a=null==a?"":a,f=a.split(/\r\n|\r|\n/g),g=[],g=g.concat(function(){var a,b,c;for(c=[],a=0,b=f.length;a<b;a++)e=f[a],c.push(this._paragraph(d,e));return c}.call(this)),h=this._textFlow(d),h.p=g,this.values.text={},this.values.hasTextOverflow=c,this.values.text.TextFlow=h,this.values.text.textWraps=this._textWraps(this._createWrapLines(f,b)),this.init(this.values)},a.prototype.updateTextOverflow=function(a){return this.values.hasTextOverflow=a},a.prototype._createWrapLines=function(a,b){var c,d,e,f,g;if(!((null!=a?a.length:void 0)>0))return[];if(!((null!=b?b.length:void 0)>0))return function(){var b,d,e;for(e=[],b=0,d=a.length;b<d;b++)c=a[b],e.push(this._wrapLines([1]));return e}.call(this);for(this._charCount=0,g=[],e=0,f=a.length;e<f;e++)d=a[e],g.push(this._linesForHardLine(b,d));return g},a.prototype._linesForHardLine=function(a,b){var c;return this._charCount+=b.length,(null!=b?b.length:void 0)>0&&this._charCount-(b.length+2)<a[a.length-1]?(c=[1],a.some(function(a){return function(d,e,f){var g;return g=d-(a._charCount-b.length),d>a._charCount||!(g<2)&&(c.push(g+1),!1)}}(this)),this._wrapLines(c)):this._wrapLines([1])},a.prototype._wrapLines=function(a){var b;return{lines:function(){var c,d,e;for(e=[],c=0,d=a.length;c<d;c++)b=a[c],e.push(this._wrapLine(b));return e}.call(this)}},a.prototype._wrapLine=function(a){return{startAtChar:""+a,visible:null}},a.prototype._textWraps=function(a){return[{paragraphs:a}]},a.prototype._textFlow=function(a){return{blockProgression:null,breakOpportunity:"auto",div:null,kerning:"on",ligatureLevel:"minimum",p:[],trackingRight:"0",verticalAlign:a.verticalAlign,whiteSpaceCollapse:"preserve"}},a.prototype._paragraph=function(a,b){return{marginBottom:""+a.marginBottom,marginTop:""+a.marginTop,textAlign:""+a.textAlign,spans:[{baselineShift:"0",color:a.color,fontId:a.fontId,fontFamily:a.fontFamily,fontName:a.fontName,fontSize:""+a.fontSize,fontStyle:a.fontStyle,fontWeight:""+a.fontWeight,lineHeight:""+a.lineHeight,text:""+b,textDecoration:""}]}},a.prototype._validateStyles=function(a){var b,c;if(b=[],null!=a.textAlign&&"string"==typeof a.textAlign||b.push("textAlign"),null!=a.verticalAlign&&"string"==typeof a.verticalAlign||b.push("verticalAlign"),null!=a.marginBottom&&"number"==typeof a.marginBottom||b.push("marginBottom"),null!=a.marginTop&&"number"==typeof a.marginTop||b.push("marginTop"),null!=a.color&&"string"==typeof a.color||"object"==typeof a.color||b.push("color"),null!=a.fontId&&"string"==typeof a.fontId||b.push("fontId"),null!=a.fontFamily&&"string"==typeof a.fontFamily||b.push("fontFamily"),null!=a.fontName&&"string"==typeof a.fontName||b.push("fontName"),null!=a.fontSize&&"number"==typeof a.fontSize||b.push("fontSize"),null!=a.fontWeight&&"string"==typeof a.fontWeight||b.push("fontWeight"),null!=a.lineHeight&&"number"==typeof a.lineHeight||b.push("lineHeight"),b.length>0)throw c=b.join(","),new Error("Invalid styles: '"+c+"' passed to TextAsset.updateTextWithWrapsAndStyle")},a.initGettersSetters=function(){return this._sfgetter("useWeb2Print",function(){var a;return"true"===(null!=(a=this.values.useWeb2Print)?a.toLowerCase():void 0)}),this._sfgetter("asset",function(){return null!=this._cachedAsset?this._cachedAsset:this._cachedAsset=this.assetFactory.newInstance(this.values)}),this._sfgetter("canRemove",function(){return!this.asset.locked}),this._sfgetter("isDateTextAsset",function(){var a;return 0===(null!=(a=this.asset.guidanceText)&&"function"==typeof a.indexOf?a.indexOf("date"):void 0)}),this._sfgetter("isEventTextAsset",function(){var a;return null!=(a=this.cachedSfProperties).isEventTextAsset?a.isEventTextAsset:a.isEventTextAsset=function(a){return function(){var b,c,d,e,f;for(e=["date","event"],c=0,d=e.length;c<d;c++)if(b=e[c],0===(null!=(f=a.asset.guidanceText)&&"function"==typeof f.indexOf?f.indexOf(b):void 0))return!0;return!1}}(this)()}),this._sfgetter("dateValue",function(){var a,b;return this.isDateTextAsset||this.isEventTextAsset?(a=null!=(b=this.asset.guidanceText)?b.split("-"):void 0,parseInt(a[1],10)):NaN}),this._sfgetter("associatedImage",function(){return!!this.isEventTextAsset&&this.values.associatedImage}),this._sfgetter("verticalAlign",function(){var a,b,c;return null==(null!=(a=this.values)&&null!=(b=a.text)&&null!=(c=b.TextFlow)?c.verticalAlign:void 0)?"top":this.values.text.TextFlow.verticalAlign}),this._sfgetter("styles",function(){return this.lines.length>0?this.lines[0].styles:{}}),this._sfgetter("lines",function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;if(null!=this._cachedLines)return this._cachedLines;if(this._cachedLines=[],null!=(null!=(g=this.values.text)&&null!=(h=g.TextFlow)?h.p:void 0))for(i=this.values.text.TextFlow.p,a=c=0,e=i.length;c<e;a=++c)b=i[a],this._processParagraph(a,b);if(null!=(null!=(j=this.values.text)&&null!=(k=j.TextFlow)&&null!=(l=k.div)?l.p:void 0))for(m=this.values.text.TextFlow.div.p,a=d=0,f=m.length;d<f;a=++d)b=m[a],this._processParagraph(a,b);return this._cachedLines}),this._sfgetter("editorContent",function(){var a,b,c,d,e;return null!=this._hardWrappedLines?this._hardWrappedLines.join("\n"):(this._hardWrappedLines=[],null!=(null!=(a=this.values.text)&&null!=(b=a.TextFlow)?b.p:void 0)&&this._processHardWrappedLines(this.values.text.TextFlow.p),null!=(null!=(c=this.values.text)&&null!=(d=c.TextFlow)&&null!=(e=d.div)?e.p:void 0)&&this._processHardWrappedLines(this.values.text.TextFlow.div.p),this._hardWrappedLines.join("\n"))}),this._sfgetter("fontId",function(){var a,b,c,d,e,f,g,h,i;return null!=(null!=(a=this.values.text)&&null!=(b=a.TextFlow)&&null!=(c=b.p)?c[0]:void 0)?null!=(d=this.values.text.TextFlow.p[0].spans[0])?d.fontId:void 0:null!=(null!=(e=this.values.text)&&null!=(f=e.TextFlow)&&null!=(g=f.div)&&null!=(h=g.p)?h[0]:void 0)&&null!=(i=this.values.text.TextFlow.div.p[0].spans[0])?i.fontId:void 0}),this._sfgetter("hasTextOverflow",function(){return null!=this.values.hasTextOverflow&&(this.values.hasTextOverflow===!0||"true"===this.values.hasTextOverflow)})},a}(),b=function(){function b(b,c){this.assetFactory=b,this.textLineFactory=c,a.initGettersSetters()}return b.prototype.newInstance=function(b){return new a(this.assetFactory,this.textLineFactory).init(b)},b}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("textAssetFactory",["assetFactory","textLineFactory",b])}.call(this),function(){var a,b;a=function(){function a(a,b,c,d){this.ModelInitializer=a,this.assetFactory=b,this.autofill=c,this.mediaPreferenceService=d}var b,c;return b="background",c="AFS-MercuryFRC",a.prototype.init=function(a){var b;return this.values=a,this._cachedAsset=null,this._imageReference=null!=(b=this.values.imageAssignment)?b.imageReference:void 0,this._uppTempURL=null,this.convertToAFSEffect(),this},a.prototype.convertToAFSEffect=function(){var a;if("Monochrome"===(null!=(a=this._imageReference)?a.effect:void 0))return this._imageReference.effect="AFS-BlackWhite"},a.prototype.rotateCropAFSString=function(a){var b,c,d,e,f;return null==a&&(a=!0),d=this.imageAssignmentRotation,b=c=0,e=f=1,a&&(b=this.imageAssignmentLlx,c=this.imageAssignmentLly,e=this.imageAssignmentUrx,f=this.imageAssignmentUry),""+d+" "+b+" "+c+" "+e+" "+f},a.prototype.removeImageAssignment=function(){return this._imageReference=null,this.values.imageAssignment=null,this.asset.visible=!1,this},a.prototype.assignImage=function(a){var b,c;return null==this.values.imageAssignment&&(this.values.imageAssignment={}),null!=(b=this.values.imageAssignment)&&(b.imageReference=a),this._imageReference=null!=(c=this.values.imageAssignment)?c.imageReference:void 0,this.asset.visible=!0,this.convertToAFSEffect(),this},a.prototype.hasAssignedImage=function(){return null!=this._imageReference},a.prototype.hasActualFineRotation=function(){return this.hasEffect("AFS-MercuryFRC")&&this.imageAssignmentRotation%90!==0},a.prototype.hasEffect=function(a){var b,c,d,e,f;return b=null!=a?a.toLowerCase():void 0,c="auto"!==b||""!==(null!=(d=this._imageReference)?d.effect:void 0)&&null!=(null!=(e=this._imageReference)?e.effect:void 0)?null!=(null!=(f=this._imageReference)?f.effect:void 0)&&this._imageReference.effect.toLowerCase().indexOf(b)>-1:this.mediaPreferenceService.vividPics},a.prototype.updateImage=function(a,b){return null==b&&(b=!1),this.data=a.data,this.imageId=a.imageId,this.redeye=a.redeye,b&&(this.imageAssignmentRotation=a.rotation),this.imageAssignmentWidth=a.Xwidth,this.imageAssignmentHeight=a.Xheight},a.prototype.calculateNewImageCrop=function(a){var b,c,d,e,f;return d=90===(f=a.rotation)||270===f?{width:a.Xheight,height:a.Xwidth}:{width:a.Xwidth,height:a.Xheight},c={llx:0,lly:0,urx:1,ury:1},b={width:this.imageAssignmentWidth,height:this.imageAssignmentHeight},e=this.autofill.utils.CropUtil.expandCropForArea(d,c,b),this.imageAssignmentLlx=e.llx,this.imageAssignmentLly=e.lly,this.imageAssignmentUrx=e.urx,this.imageAssignmentUry=e.ury},a.initGettersSetters=function(){return this._sfgetter("background",function(){return this.values.associatedText===b}),this._sfsetter("background",function(a){return this.values.associatedText=a===!0?b:""}),this._sfgetter("asset",function(){return null!=this._cachedAsset?this._cachedAsset:this._cachedAsset=this.assetFactory.newInstance(this.values);
}),this._sfgetter("data",function(){var a;return null!=(a=this._imageReference)?a.data:void 0}),this._sfsetter("data",function(a){var b;if(null!=a.toString)return null!=(b=this._imageReference)?b.data=a.toString():void 0}),this._sfgetter("canRemove",function(){return!this.asset.locked}),this._sfgetter("uniqueProjectRef",function(){return this.values.container.id}),this._sfgetter("imageId",function(){var a;return null!=(a=this._imageReference)?a.id:void 0}),this._sfsetter("imageId",function(a){var b;if(null!=a.toString)return null!=(b=this._imageReference)?b.id=a.toString():void 0}),this._sfgetter("projectImageId",function(){var a;return parseInt(null!=(a=this._imageReference)?a.projectImageId:void 0)}),this._sfsetter("projectImageId",function(a){var b;if(this.ModelInitializer.isType(a,"number","ImageAsset.projectImageId"))return null!=(b=this._imageReference)?b.projectImageId=a.toString():void 0}),this._sfgetter("description",function(){var a;return null!=(a=this._imageReference)?a.description:void 0}),this._sfsetter("description",function(a){var b;if(null!=a.toString)return null!=(b=this._imageReference)?b.description=a.toString():void 0}),this._sfgetter("filterEffect",function(){var a,b,d,e;if(this.effect===c||null==this.effect)return"";if(this.effect.indexOf(";")===-1)return this.effect;for(e=this.effectsAsCollection,b=0,d=e.length;b<d;b++)if(a=e[b],a!==c)return a;return""}),this._sfgetter("effect",function(){var a,b;return a=null==(null!=(b=this._imageReference)?b.effect:void 0)?this.mediaPreferenceService.vividPics?"Auto":"None":this._imageReference.effect}),this._sfsetter("effect",function(a){var b;if(null!=a.toString)return null!=(b=this._imageReference)?b.effect=a.toString():void 0}),this._sfgetter("effectsAsCollection",function(){var a,b;return""===(null!=(a=this._imageReference)?a.effect:void 0)?[]:null!=(b=this._imageReference)?b.effect.replace(new RegExp(" ","g"),"").split(";"):void 0}),this._sfgetter("fadeColor",function(){var a;return null!=(a=this._imageReference)?a.fadeColor:void 0}),this._sfsetter("fadeColor",function(a){var b;if(null!=(null!=a?a.toString:void 0))return null!=(b=this._imageReference)?b.fadeColor=a.toString():void 0}),this._sfgetter("fadeValue",function(){var a;return parseFloat(null!=(a=this._imageReference)?a.fadeValue:void 0)}),this._sfsetter("fadeValue",function(a){var b;if(this.ModelInitializer.isType(a,"number","ImageAsset.fadeValue"))return null!=(b=this._imageReference)?b.fadeValue=a.toString():void 0}),this._sfgetter("imageAssignmentWidth",function(){var a;return parseFloat(null!=(a=this._imageReference)?a.width:void 0)}),this._sfsetter("imageAssignmentWidth",function(a){var b;if(this.ModelInitializer.isType(a,"number","ImageAsset.imageAssignmentWidth"))return null!=(b=this._imageReference)?b.width=a.toString():void 0}),this._sfgetter("imageAssignmentHeight",function(){var a;return parseFloat(null!=(a=this._imageReference)?a.height:void 0)}),this._sfsetter("imageAssignmentHeight",function(a){var b;if(this.ModelInitializer.isType(a,"number","ImageAsset.imageAssignmentHeight"))return null!=(b=this._imageReference)?b.height=a.toString():void 0}),this._sfgetter("redeye",function(){var a;return null!=(a=this._imageReference)?a.redeye:void 0}),this._sfsetter("redeye",function(a){var b;return null!=(b=this._imageReference)?b.redeye="string"==typeof a?a.toString():"":void 0}),this._sfgetter("imageAssignmentRotation",function(){var a;return parseFloat(null!=(a=this._imageReference)?a.rotation:void 0)}),this._sfsetter("imageAssignmentRotation",function(a){var b;if(this.ModelInitializer.isType(a,"number","ImageAsset.imageAssignmentRotation"))return null!=(b=this._imageReference)?b.rotation=a.toString():void 0}),this._sfgetter("imageAssignmentUrx",function(){var a;return parseFloat(null!=(a=this._imageReference)?a.urx:void 0)}),this._sfsetter("imageAssignmentUrx",function(a){var b;if(this.ModelInitializer.isType(a,"number","ImageAsset.imageAssignmentUrx"))return null!=(b=this._imageReference)?b.urx=a.toString():void 0}),this._sfgetter("imageAssignmentUry",function(){var a;return parseFloat(null!=(a=this._imageReference)?a.ury:void 0)}),this._sfsetter("imageAssignmentUry",function(a){var b;if(this.ModelInitializer.isType(a,"number","ImageAsset.imageAssignmentUry"))return null!=(b=this._imageReference)?b.ury=a.toString():void 0}),this._sfgetter("imageAssignmentLlx",function(){var a;return parseFloat(null!=(a=this._imageReference)?a.llx:void 0)}),this._sfsetter("imageAssignmentLlx",function(a){var b;if(this.ModelInitializer.isType(a,"number","ImageAsset.imageAssignmentLlx"))return null!=(b=this._imageReference)?b.llx=a.toString():void 0}),this._sfgetter("imageAssignmentLly",function(){var a;return parseFloat(null!=(a=this._imageReference)?a.lly:void 0)}),this._sfsetter("imageAssignmentLly",function(a){var b;if(this.ModelInitializer.isType(a,"number","ImageAsset.imageAssignmentLly"))return null!=(b=this._imageReference)?b.lly=a.toString():void 0}),this._sfgetter("imageAssignment",function(){return this._imageReference}),this._sfgetter("userAdded",function(){return this.values.userAdded===!0||"true"===this.values.userAdded}),this._sfgetter("crop",function(){return null!=this._imageReference?[parseFloat(this._imageReference.llx),parseFloat(this._imageReference.lly),parseFloat(this._imageReference.urx),parseFloat(this._imageReference.ury)]:[]}),this._sfsetter("uppTempURL",function(a){return this._uppTempURL=a}),this._sfgetter("uppTempURL",function(){return this._uppTempURL})},a}(),b=function(){function b(b,c,d,e){this.ModelInitializer=b,this.assetFactory=c,this.autofill=d,this.mediaPreferenceService=e,a.initGettersSetters()}return b.prototype.newInstance=function(b){return new a(this.ModelInitializer,this.assetFactory,this.autofill,this.mediaPreferenceService).init(b)},b}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("imageAssetFactory",["modelInitializer","assetFactory","autofill","mediaPreferenceService",b])}.call(this),function(){var a,b;a=function(){function a(a,b,c,d,e,f){this.ModelInitializer=a,this.assetFactory=b,this.config=c,this.imageURLService=d,this.mediaPreferenceService=e,this.eventBus=f}var b;return b="AFS-MercuryFRC",a.prototype.init=function(a){var b;return this.values=a,this._cachedAsset=null,this._isHollow=null,this._imageReference=null!=(b=this.values.imageAssignment)?b.imageReference:void 0,this.cachedSfProperties={},this},a.prototype.hasActualFineRotation=function(){return this.hasEffect("AFS-MercuryFRC")&&this.imageAssignmentRotation%90!==0},a.prototype.hasEffect=function(a){var b,c,d,e;return b=""!==(null!=(c=this._imageReference)?c.effect:void 0)&&null!=(null!=(d=this._imageReference)?d.effect:void 0)||"Auto"!==a&&"None"!==a?null!=(null!=(e=this._imageReference)?e.effect:void 0)&&this._imageReference.effect.indexOf(a)>-1:this.mediaPreferenceService.vividPics===("Auto"===a)},a.prototype._emptyImage=function(){return"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="},a.prototype.removeImageAssignment=function(){var a;return this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,{imageId:null!=(a=this._imageReference)?a.id:void 0}),this._imageReference=null,this.values.imageAssignment=null,this.asset.visible=!1,this},a.prototype.assignImage=function(a){var b,c;return null==this.values.imageAssignment&&(this.values.imageAssignment={}),null!=(b=this.values.imageAssignment)&&(b.imageReference=a),this._imageReference=null!=(c=this.values.imageAssignment)?c.imageReference:void 0,this.asset.visible=!0,this.convertToAFSEffect(this._imageReference),this},a.prototype.convertToAFSEffect=function(a){if("Monochrome"===(null!=a?a.effect:void 0))return a.effect="AFS-BlackWhite"},a.prototype.assignContentGraphicAsset=function(a,b){var c,d;this._validateContainerId(b)&&this._validateContentGraphicAsset(a)&&(d=a.assetType,d=d.charAt(0).toUpperCase()+d.slice(1),c={assetId:a.assetId,version:a.version,sourceUrl:a.mobileUrl,assetType:a.assetType,isFlippable:"false"},this.values.assetSource=null,this.values.container.id=b,this.values.scriptLabel="id="+b+"|contentType="+d,this.cachedSfProperties.sourceUrl=null,this.values.assetReference=c,this.removeImageAssignment())},a.prototype._validateContainerId=function(a){return this.ModelInitializer.isType(a,"number","")||this.ModelInitializer.isType(a,"string","")},a.prototype._validateContentGraphicAsset=function(a){var b,c,d;return d=this.ModelInitializer.isType(a.version,"number","")||this.ModelInitializer.isType(a.version,"string",""),b=this.ModelInitializer.isType(a.assetId,"string",""),c=this.ModelInitializer.isType(a.assetType,"string",""),d&&b&&c},a.initGettersSetters=function(){return this._sfgetter("asset",function(){return null!=this._cachedAsset?this._cachedAsset:this._cachedAsset=this.assetFactory.newInstance(this.values)}),this._sfgetter("uniqueProjectRef",function(){return this.values.container.id}),this._sfgetter("version",function(){return this.values.assetReference.version}),this._sfgetter("imageId",function(){var a;return null!=(a=this._imageReference)?a.id:void 0}),this._sfsetter("imageId",function(a){var b;if(null!=a.toString)return null!=(b=this._imageReference)?b.id=a.toString():void 0}),this._sfgetter("sourceUrl",function(){var a,b;return null==(null!=(b=this.values.assetReference)?b.sourceUrl:void 0)?this._emptyImage():null!=this.cachedSfProperties.sourceUrl?this.cachedSfProperties.sourceUrl:(a=this.values.assetReference.sourceUrl,a=this.config.protocolRelativeUrl(a),this.cachedSfProperties.sourceUrl=a.replace("emb.swf","emb.mobile").replace("bkg.swf","bkg.mobile"))}),this._sfgetter("isHollow",function(){var a;return null===this._isHollow&&(this._isHollow="hollow"===(null!=(a=this.values.assetReference)?a.selectionType:void 0)),this._isHollow}),this._sfgetter("canRemove",function(){return!this.asset.locked}),this._sfgetter("imageAssignmentWidth",function(){var a;return parseFloat(null!=(a=this._imageReference)?a.width:void 0)}),this._sfsetter("imageAssignmentWidth",function(a){var b;if(this.ModelInitializer.isType(a,"number","ImageAsset.imageAssignmentWidth"))return null!=(b=this._imageReference)?b.width=a.toString():void 0}),this._sfgetter("imageAssignmentHeight",function(){var a;return parseFloat(null!=(a=this._imageReference)?a.height:void 0)}),this._sfsetter("imageAssignmentHeight",function(a){var b;if(this.ModelInitializer.isType(a,"number","ImageAsset.imageAssignmentHeight"))return null!=(b=this._imageReference)?b.height=a.toString():void 0}),this._sfgetter("imageAssignmentUrx",function(){var a;return parseFloat(null!=(a=this._imageReference)?a.urx:void 0)}),this._sfsetter("imageAssignmentUrx",function(a){var b;if(this.ModelInitializer.isType(a,"number","ImageAsset.imageAssignmentUrx"))return null!=(b=this._imageReference)?b.urx=a.toString():void 0}),this._sfgetter("imageAssignmentUry",function(){var a;return parseFloat(null!=(a=this._imageReference)?a.ury:void 0)}),this._sfsetter("imageAssignmentUry",function(a){var b;if(this.ModelInitializer.isType(a,"number","ImageAsset.imageAssignmentUry"))return null!=(b=this._imageReference)?b.ury=a.toString():void 0}),this._sfgetter("imageAssignmentLlx",function(){var a;return parseFloat(null!=(a=this._imageReference)?a.llx:void 0)}),this._sfsetter("imageAssignmentLlx",function(a){var b;if(this.ModelInitializer.isType(a,"number","ImageAsset.imageAssignmentLlx"))return null!=(b=this._imageReference)?b.llx=a.toString():void 0}),this._sfgetter("imageAssignmentLly",function(){var a;return parseFloat(null!=(a=this._imageReference)?a.lly:void 0)}),this._sfsetter("imageAssignmentLly",function(a){var b;if(this.ModelInitializer.isType(a,"number","ImageAsset.imageAssignmentLly"))return null!=(b=this._imageReference)?b.lly=a.toString():void 0}),this._sfgetter("imageAssignmentRotation",function(){var a;return parseFloat(null!=(a=this._imageReference)?a.rotation:void 0)}),this._sfsetter("imageAssignmentRotation",function(a){var b;if(this.ModelInitializer.isType(a,"number","ImageAsset.imageAssignmentRotation"))return null!=(b=this._imageReference)?b.rotation=a.toString():void 0}),this._sfgetter("imageAssignment",function(){return this._imageReference}),this._sfgetter("filterEffect",function(){var a,c,d,e;if(this.effect===b||null==this.effect)return"";if(this.effect.indexOf(";")===-1)return this.effect;for(e=this.effectsAsCollection,c=0,d=e.length;c<d;c++)if(a=e[c],a!==b)return a;return""}),this._sfgetter("effect",function(){var a,b;return a=null==(null!=(b=this._imageReference)?b.effect:void 0)?this.mediaPreferenceService.vividPics?"Auto":"None":this._imageReference.effect}),this._sfsetter("effect",function(a){var b;if(null!=a.toString)return null!=(b=this._imageReference)?b.effect=a.toString():void 0}),this._sfgetter("fadeColor",function(){var a;return null!=(a=this._imageReference)?a.fadeColor:void 0}),this._sfsetter("fadeColor",function(a){var b;if(null!=a.toString)return null!=(b=this._imageReference)?b.fadeColor=a.toString():void 0}),this._sfgetter("fadeValue",function(){var a;return parseFloat(null!=(a=this._imageReference)?a.fadeValue:void 0)}),this._sfsetter("fadeValue",function(a){var b;if(this.ModelInitializer.isType(a,"number","ImageAsset.fadeValue"))return null!=(b=this._imageReference)?b.fadeValue=a.toString():void 0})},a}(),b=function(){function b(b,c,d,e,f,g){this.ModelInitializer=b,this.assetFactory=c,this.config=d,this.imageURLService=e,this.mediaPreferenceService=f,this.eventBus=g,a.initGettersSetters()}return b.prototype.newInstance=function(b){return new a(this.ModelInitializer,this.assetFactory,this.config,this.imageURLService,this.mediaPreferenceService,this.eventBus).init(b)},b}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("graphicAssetFactory",["modelInitializer","assetFactory","CONFIG","imageURLService","mediaPreferenceService","eventBus",b])}.call(this),function(){"use strict";var a,b;a=function(){function a(a){this.assetFactory=a}return a.prototype.init=function(a){return this.values=a,this._cachedAsset=null,this},a.initGettersSetters=function(){return this._sfgetter("asset",function(){return null!=this._cachedAsset?this._cachedAsset:this._cachedAsset=this.assetFactory.newInstance(this.values)})},a}(),b=function(){function b(b){this.assetFactory=b,a.initGettersSetters()}return b.prototype.newInstance=function(b){return new a(this.assetFactory).init(b)},b}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("audioAssetFactory",["assetFactory",b])}.call(this),function(){var a,b;a=function(){function a(a,b,c,d,e,f,g){this.ModelInitializer=a,this.imageURLService=b,this.uppObjectCollection=c,this.imageOrigin=d,this.$filter=e,this.mediaPreferenceService=f,this.config=g}return a.THUMB_WIDTH=90,a.THUMB_HEIGHT=90,a.STORYBOARD_THUMB_WIDTH=160,a.STORYBOARD_THUMB_HEIGHT=160,a.PREVIEW_WIDTH=540,a.PREVIEW_HEIGHT=540,a.PHOTOCCINO_WIDTH=1e3,a.PHOTOCCINO_HEIGHT=1e3,a.CROP_DECIMAL_PRECISION=4,a.prototype.init=function(a){return this.values=a,this._parsedValues={},this._hasError=!1,this._isThumb=!1,this._isAnonymous=!1,this._rankInProgress=!1,a.source?this._processUPPImage(this.values):this._processImage(this.values),this._parsedValues.useCount=0,this},a.prototype.createTimestampedDescription=function(){var a,b,c;switch(b=function(a){return function(b){return a.$filter("date")(new Date(b),"short")}}(this),a="null"===this.captureTime?null:this.captureTime,c="null"===this.filename?null:this.filename,!1){case!(a&&c):return""+b(a)+" - "+c;case!a:return""+b(a);case!c:return c;default:return""}},a.prototype.hasUnencodedImageId=function(){return/^\d+$/.test(this.imageId)},a.prototype.isRawSuperfly=function(){return this.hasUnencodedImageId()&&"THISLIFE"===this.Xorigin},a.prototype._isDate=function(a){return a instanceof Date&&!isNaN(a.valueOf())},a.prototype._processImage=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;try{n=decodeURI(a.view)}catch(b){e=b,j=a.view.replace(/%[0-9A-F]{2}/gi,""),i=/%u([\d\w]{4})/gi,j=j.replace(i,function(a,b){return String.fromCharCode(parseInt(b,16))}),n=decodeURI(j,"")}for(m=n.split("&"),h=function(){var a,b,c,d;for(d=[],a=0,b=m.length;a<b;a++)g=m[a],d.push((c=g.split("="),f=c[0],l=c[1],c));return d}(),o=0,p=h.length;o<p;o++)q=h[o],f=q[0],l=q[1],this._parsedValues[f]=l;this._parsedValues.rotation=this._validateRotation(this._parsedValues.rotation);try{this._parsedValues.title=decodeURIComponent(this._parsedValues.title)}catch(a){e=a,this._parsedValues.title=this._parsedValues.title.replace(/%[0-9A-F]{2}/gi,"")}try{this._parsedValues.filename=decodeURIComponent(this._parsedValues.filename)}catch(a){e=a,this._parsedValues.filename=this._parsedValues.filename.replace(/%[0-9A-F]{2}/gi,"")}try{this._parsedValues.description=decodeURIComponent(this._parsedValues.description)}catch(a){e=a,this._parsedValues.description=this._parsedValues.description.replace(/%[0-9A-F]{2}/gi,"")}b=decodeURIComponent(this._parsedValues.captureTime),this._isDate(new Date(b))||(b=""),this._parsedValues.captureTime=b,k=decodeURIComponent(this._parsedValues.uploadTime),this._isDate(new Date(k))||(k=""),this._parsedValues.uploadTime=k,c=decodeURIComponent(this._parsedValues.cropll).split(","),this._parsedValues.cropllx=this._validateCropll(parseFloat(c[0])||0),this._parsedValues.croplly=this._validateCropll(parseFloat(c[1])||0),d=decodeURIComponent(this._parsedValues.cropur).split(","),this._parsedValues.cropurx=this._validateCropur(parseFloat(d[0])||1),this._parsedValues.cropury=this._validateCropur(parseFloat(d[1])||1),this._calculateThumbSize(),"uppTemp"===this.data&&this._processUppTemp(),"anonymous"===this.data&&this._processAnonymous(),this._refreshURLs()},a.prototype._refreshURLs=function(){if(this._parsedValues.thumbSrc=this._getImageURL(96,96),!this._isThumb)return this._parsedValues.storyboardThumbSrc=this._getImageURL(200,200),this._parsedValues.previewSrc=this._getImageURL(540,540)},a.prototype._processUPPImage=function(a){var b;return b=decodeURIComponent(a.captureTime),this._isDate(new Date(b))||(b=""),this._parsedValues.Xwidth=this._validateWidth(a.width),this._parsedValues.Xheight=this._validateWidth(a.height),this._parsedValues.captureTime=this._validateString(b),this._parsedValues.uploadTime=a.uploadTime,this._parsedValues.filename=this._validateString(a.filename),null==this._parsedValues.effect&&(this._parsedValues.effect=this._validateEffect(a.effect)),this._parsedValues.redeye=this._validateString(a.redeye),this._parsedValues.ranking=this._validateRanking(a.ranking),this._parsedValues.rotation=this._validateRotation(a.rotation),this._parsedValues.title=this._validateString(a.title),this._parsedValues.description=this._validateString(a.description),this._parsedValues.cropllx=this._validateCropll(a.crop.llx),this._parsedValues.croplly=this._validateCropll(a.crop.lly),this._parsedValues.cropurx=this._validateCropur(a.crop.urx),this._parsedValues.cropury=this._validateCropur(a.crop.ury),this._parsedValues.Xorigin=this.imageOrigin.fromValue(a.source),this._parsedValues.imageID=a.id,this._parsedValues.sflyId=a.sflyId,this._calculateThumbSize(),a.data?"object"==typeof a.data?this._processThumb(a):this._processSfly(a):this._processAnonymous(a),this.values={productImageID:this.values.productImageID}},a.prototype._processThumb=function(a){if(this._parsedValues.uppObject=a.data,this._parsedValues.DATA="uppTemp",this._isThumb=!0,this._parsedValues.uppObject.productImageID=this.productImageID,this._parsedValues.thumbSrc=a.data.getThumbnailUrl(96,96,function(a){return function(b){if(a.isThumb)return a._parsedValues.Xwidth=a._parsedValues.uppObject.width,a._parsedValues.Xheight=a._parsedValues.uppObject.height,a._parsedValues.thumbSrc=b,a._calculateThumbSize(),b}}(this)),"myComputer"!==a.source&&"device"!==a.source)return this._parsedValues.previewSrc=a.data.getThumbnailUrl(540,540,function(a){return function(b){if(a.isThumb)return a._parsedValues.previewSrc=b}}(this)),this._parsedValues.storyboardThumbSrc=a.data.getThumbnailUrl(200,200,function(a){return function(b){if(a.isThumb)return a._parsedValues.storyboardThumbSrc=b}}(this))},a.prototype._processSfly=function(a){return this._parsedValues.DATA=a.data,this._parsedValues.thumbSrc=this._validateString(this._getImageURL(96,96)),this._parsedValues.storyboardThumbSrc=this._validateString(this._getImageURL(200,200)),this._parsedValues.previewSrc=this._validateString(this._getImageURL(540,540))},a.prototype._processUppTemp=function(){var a;return this._isThumb=!0,this._parsedValues.uppObject=this.uppObjectCollection.getUppObject(this.imageId),null!=(a=this._parsedValues.uppObject)?a.productImageID=this.productImageID:void 0},a.prototype._processAnonymous=function(a){var b;return this._isAnonymous=!0,b=this.previewSize,this._parsedValues.thumbSrc=this._validateString(this._getImageURL(this.thumbWidth,this.thumbHeight)),this._parsedValues.storyboardThumbSrc=this._validateString(this._getImageURL(this.storyboardThumbWidth,this.storyboardThumbHeight)),this._parsedValues.previewSrc=this._validateString(this._getImageURL(b.width,b.height))},a.prototype._getImageURL=function(a,b){return this.isAnonymous?(this.Xwidth>this.Xheight?b=b*this.Xheight/this.Xwidth:a=a*this.Xwidth/this.Xheight,this.imageURLService.imageURLForAnonymousImage(this.asset,a,b)):this.imageURLService.imageURLForImage(this,"fit"+a+"x"+b)},a.prototype._floatOrOrigValue=function(a,b){return a=parseFloat(a),isNaN(a)?b:a},a.prototype.setSourceCrop=function(a,b,c,d){return this._parsedValues.cropllx=this._floatOrOrigValue(a,this._parsedValues.cropllx),this._parsedValues.croplly=this._floatOrOrigValue(b,this._parsedValues.croplly),this._parsedValues.cropurx=this._floatOrOrigValue(c,this._parsedValues.cropurx),this._parsedValues.cropury=this._floatOrOrigValue(d,this._parsedValues.cropury),this._calculateThumbSize(),this._refreshImageView()},a.prototype.getScaledCroppedSize=function(a,b){var c,d,e;return this.Xheight&&this.Xwidth?(90===this.rotation||270===this.rotation?(e=this.Xheight,c=this.Xwidth):(e=this.Xwidth,c=this.Xheight),c*=this.cropury-this.croplly,e*=this.cropurx-this.cropllx,d=Math.max(c/b,e/a),{width:Math.round(e/d),height:Math.round(c/d)}):{}},a.prototype.getScaledSize=function(a,b){var c,d,e;return this.Xheight&&this.Xwidth?(90===this.rotation||270===this.rotation?(e=this.Xheight,c=this.Xwidth):(e=this.Xwidth,c=this.Xheight),d=Math.max(c/b,e/a),{width:Math.round(e/d),height:Math.round(c/d)}):{}},a.prototype.useCountAdd=function(){this._parsedValues.useCount++},a.prototype.useCountSubtract=function(){this._parsedValues.useCount--,this._parsedValues.useCount<0&&(this._parsedValues.useCount=0)},a.prototype.clearError=function(){return this._hasError=!1},a.prototype.updateThumbnail=function(a){return this._processUPPImage(a),this._isThumb=!1},a.prototype.updateAnonymousImage=function(a){var b;return b=a.substr(a.indexOf("?")+1),this._isAnonymous=!1,this._processImage({view:b})},a.prototype._notEmpty=function(a){return null!=a&&this._notEmptyStr(a)},a.prototype._notEmptyStr=function(a){return"string"!=typeof a||a.length>0},a.prototype._refreshImageView=function(){var a;return a=[],null!=this.imageId&&a.push("imageID="+this.imageId),null!=this.rotation&&a.push("rotation="+this._validateRotation(this.rotation)),null!=this.cropllx&&null!=this.croplly&&a.push("cropll="+this.cropllx+","+this.croplly),null!=this.cropurx&&null!=this.cropury&&a.push("cropur="+this.cropurx+","+this.cropurx),null!=this.effect&&a.push("effect="+this.effect),null!=this.description&&a.push("description="+encodeURIComponent(this.description)),null!=this.filename&&a.push("filename="+encodeURIComponent(this.filename)),null!=this.title&&a.push("title="+encodeURIComponent(this.title)),null!=this.data&&a.push("DATA="+this.data),null!=this.Xwidth&&a.push("Xwidth="+this.Xwidth),null!=this.Xheight&&a.push("Xheight="+this.Xheight),null!=this.captureTime&&a.push("captureTime="+encodeURIComponent(this.captureTime)),null!=this.uploadTime&&a.push("uploadTime="+encodeURIComponent(this.uploadTime)),null!=this.Xorigin&&a.push("Xorigin="+this.Xorigin),"string"==typeof this.redeye&&this.redeye.length>0&&a.push("redeye="+this.redeye),a.push("ranking="+this.ranking),this.config.features.eventImageFix&&"string"==typeof this.sflyId&&this.sflyId.length>0&&a.push("sflyId="+this.sflyId),this.values.view=a.join("&"),this._refreshURLs()},a.prototype._validateRotation=function(a){return a=parseInt(a,10),90!==a&&180!==a&&270!==a?0:a},a.prototype._validateWidth=function(a){return this.ModelInitializer.isType(a,"number","")?a:160},a.prototype._validateString=function(a){return this.ModelInitializer.isType(a,"string","")?a:""},a.prototype._validateRanking=function(a){return this.ModelInitializer.isType(a,"number","")?a:0},a.prototype._validateEffect=function(a){var b;return this.ModelInitializer.isType(a,"string","")?b=a:this.mediaPreferenceService.vividPics?"Auto":"None"},a.prototype._validateCropll=function(a){return this.ModelInitializer.isType(a,"number","")?this._roundCropValue(a):0},a.prototype._validateCropur=function(a){return this.ModelInitializer.isType(a,"number","")?this._roundCropValue(a):1},a.prototype._roundCropValue=function(b){return parseFloat(b.toFixed(a.CROP_DECIMAL_PRECISION))},a.prototype._calculateThumbSize=function(){var a,b;return a=this.thumbSize,this._parsedValues.thumbWidth=a.width,this._parsedValues.thumbHeight=a.height,b=this.storyboardThumbSize,this._parsedValues.storyboardThumbWidth=b.width,this._parsedValues.storyboardThumbHeight=b.height},a.initGettersSetters=function(){return this._sfgetter("photoccinoImageURL",function(){return this._getImageURL(a.PHOTOCCINO_WIDTH,a.PHOTOCCINO_HEIGHT)}),this._sfgetter("rankInProgress",function(){return this._rankInProgress}),this._sfsetter("rankInProgress",function(a){return this._rankInProgress=a}),this._sfgetter("isUploading",function(){return"uppTemp"===this._parsedValues.DATA}),this._sfgetter("productImageID",function(){return parseInt(this.values.productImageID)}),this._sfsetter("productImageID",function(a){if(this.ModelInitializer.isType(a,"number","image.productImageID"))return this.values.productImageID=a}),this._sfgetter("useCount",function(){return this._parsedValues.useCount}),this._sfsetter("useCount",function(a){if(this.ModelInitializer.isType(a,"number","image.useCount"))return this._parsedValues.useCount=a}),this._sfgetter("data",function(){return this.isAnonymous?"anonymous":this._parsedValues.DATA}),this._sfgetter("Xheight",function(){return parseInt(this._parsedValues.Xheight)}),this._sfgetter("Xorigin",function(){return this._parsedValues.Xorigin}),this._sfgetter("isFrom3rdPartySource",function(){return this.imageOrigin.isThirdPartyImage(this._parsedValues.Xorigin)}),this._sfgetter("Xwidth",function(){return parseInt(this._parsedValues.Xwidth)}),this._sfgetter("hasDimensionValue",function(){return!(void 0===this._parsedValues.Xwidth&&void 0===this._parsedValues.Xheight)}),this._sfgetter("captureTime",function(){return this._parsedValues.captureTime}),this._sfgetter("captureDate",function(){return new Date(this._parsedValues.captureTime).getTime()}),this._sfgetter("cropllx",function(){return this._parsedValues.cropllx}),this._sfsetter("cropllx",function(a){return this._parsedValues.cropllx=this._floatOrOrigValue(a,this._parsedValues.cropllx),this._refreshImageView()}),this._sfgetter("croplly",function(){return this._parsedValues.croplly}),this._sfsetter("croplly",function(a){return this._parsedValues.croplly=this._floatOrOrigValue(a,this._parsedValues.croplly),this._refreshImageView()}),this._sfgetter("cropurx",function(){return this._parsedValues.cropurx}),this._sfsetter("cropurx",function(a){return this._parsedValues.cropurx=this._floatOrOrigValue(a,this._parsedValues.cropurx),this._refreshImageView()}),this._sfgetter("cropury",function(){return this._parsedValues.cropury}),this._sfsetter("cropury",function(a){return this._parsedValues.cropury=this._floatOrOrigValue(a,this._parsedValues.cropury),this._refreshImageView()}),this._sfgetter("description",function(){return this._parsedValues.description}),this._sfgetter("effect",function(){return this._parsedValues.effect}),this._sfgetter("redeye",function(){return this._parsedValues.redeye}),this._sfsetter("redeye",function(a){return this._parsedValues.redeye=null==a||"string"!=typeof a?void 0:a,this._refreshImageView()}),this._sfgetter("filename",function(){return this._parsedValues.filename}),this._sfgetter("imageId",function(){return this._parsedValues.imageID}),this._sfgetter("sflyId",function(){return this._parsedValues.sflyId}),this._sfgetter("ranking",function(){return parseFloat(this._parsedValues.ranking)||0}),this._sfsetter("ranking",function(a){if(this.ModelInitializer.isType(a,"number","image.ranking"))return this._parsedValues.ranking=a}),this._sfgetter("pHash",function(){return this._parsedValues.pHash||this._parsedValues.imageID}),this._sfsetter("pHash",function(a){if(this.ModelInitializer.isType(a,"string","image.pHash"))return this._parsedValues.pHash=a}),this._sfgetter("rotation",function(){return parseInt(this._parsedValues.rotation)||0}),this._sfgetter("title",function(){return this._parsedValues.title}),this._sfgetter("uploadTime",function(){return this._parsedValues.uploadTime}),this._sfgetter("useCount",function(){return this._parsedValues.useCount}),this._sfgetter("thumbSize",function(){return this.getScaledSize(a.THUMB_HEIGHT,a.THUMB_WIDTH)}),this._sfgetter("thumbWidth",function(){return this._parsedValues.thumbWidth}),this._sfgetter("thumbHeight",function(){return this._parsedValues.thumbHeight}),this._sfgetter("storyboardThumbSize",function(){return this.getScaledSize(a.STORYBOARD_THUMB_HEIGHT,a.STORYBOARD_THUMB_WIDTH)}),this._sfgetter("storyboardThumbWidth",function(){return this._parsedValues.storyboardThumbWidth}),this._sfgetter("storyboardThumbHeight",function(){return this._parsedValues.storyboardThumbHeight}),this._sfgetter("previewSize",function(){return this.getScaledSize(a.PREVIEW_HEIGHT,a.PREVIEW_WIDTH)}),this._sfgetter("thumbSrc",function(){return this._isThumb&&!this._parsedValues.thumbSrc?this._parsedValues.uppObject.getThumbnailUrl(96,96):this._parsedValues.thumbSrc}),this._sfgetter("storyboardThumbSrc",function(){return this._isThumb&&!this._parsedValues.storyboardThumbSrc?this._parsedValues.uppObject.getThumbnailUrl(200,200):this._parsedValues.storyboardThumbSrc}),this._sfgetter("previewSrc",function(){return this._isThumb&&!this._parsedValues.previewSrc?this._parsedValues.uppObject.getThumbnailUrl(540,540):this._parsedValues.previewSrc}),this._sfgetter("isThumb",function(){return this._isThumb}),this._sfgetter("hasError",function(){return this._hasError}),this._sfsetter("hasError",function(a){if(this.ModelInitializer.isType(a,"boolean","image.hasError"))return this._hasError=!!a}),this._sfgetter("isDragDisabled",function(){return this._hasError}),this._sfgetter("isAnonymous",function(){return this._isAnonymous}),this._sfgetter("errorStyle",function(){var a,b,c;return this._errorStyle||(a=Math.atan2(this.thumbHeight,this.thumbWidth),b="rotate("+a+"rad)",c=Math.round(Math.sqrt(Math.pow(this.thumbWidth,2)+Math.pow(this.thumbHeight,2)))-2,this._errorStyle="transform:"+b+";-ms-transform:"+b+";-webkit-transform:"+b+";width:"+c+"px;"),this._errorStyle}),this._sfgetter("asset",function(){return{data:this.data,imageId:this.imageId,effect:this.effect,redeye:this.redeye,imageAssignmentRotation:this.rotation,imageAssignmentLlx:this.cropllx,imageAssignmentLly:this.croplly,imageAssignmentUrx:this.cropurx,imageAssignmentUry:this.cropury,rotateCropAFSString:function(a){return function(){return""+a.rotation+" "+a.cropllx+" "+a.croplly+" "+a.cropurx+" "+a.cropury}}(this)}}),this._sfgetter("projectData",function(){return this._refreshImageView(),angular.copy(this.values)}),this._sfgetter("uppObject",function(){return this._parsedValues.uppObject})},a}(),b=function(){function b(b,c,d,e,f,g,h){this.ModelInitializer=b,this.imageURLService=c,this.uppObjectCollection=d,this.imageOrigin=e,this.$filter=f,this.mediaPreferenceService=g,
this.config=h,a.initGettersSetters()}return b.prototype.newInstance=function(b){return new a(this.ModelInitializer,this.imageURLService,this.uppObjectCollection,this.imageOrigin,this.$filter,this.mediaPreferenceService,this.config).init(b)},b}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("imageFactory",["modelInitializer","imageURLService","uppObjectCollection","imageOrigin","$filter","mediaPreferenceService","CONFIG",b])}.call(this),function(){"use strict";var a;a=function(){var a,b,c,d,e,f,g,h;return e="SFLY_LIGHTBOX",f="SFLY_SHARE",d="LOCAL",c="INSTAGRAM",a="FACEBOOK",g="THISLIFE",b="FLICKR",h={sfly:e,myComputer:d,device:d,thisLife:g,sites:f,fb:a,instagram:c,flickr:b},Object.freeze({SFLY_LIGHTBOX:e,SFLY_SHARE:f,LOCAL:d,INSTAGRAM:c,FACEBOOK:a,THISLIFE:g,FLICKR:b,fromValue:function(a){return h[a]},isThirdPartyImage:function(a){return a!==e&&a!==d}})},angular.module("galleon").factory("imageOrigin",a)}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h){this.ModelInitializer=a,this.imageFactory=c,this.eventBus=d,this.imageOrigin=e,this.$timeout=g,this.uppObjectCollection=h,this.updateAnonymousImages=b(this.updateAnonymousImages,this),this.get3rdPartyImagesWithError=b(this.get3rdPartyImagesWithError,this),this.getUsedImagesWithError=b(this.getUsedImagesWithError,this),this.getImageIndex=b(this.getImageIndex,this),this.setUploadError=b(this.setUploadError,this),this.checkForIncompleteUploads=b(this.checkForIncompleteUploads,this),this.completeUpload=b(this.completeUpload,this),this.imageUploaded=b(this.imageUploaded,this),this.updateThumbnail=b(this.updateThumbnail,this),this._currentUploadTotalList=[],this._currentUploadInProgressList=[],this._uploadErrorList=[],this._logger=f.newInstance("ImageCollection"),this._usedImages=0}var c,d;return c=["maxSize","fontDescriptor","sortOrder"],d=1e3,a.prototype.init=function(a,b){return this.values=a,this.project=b,this._cachedProjectImages=null,this.ModelInitializer.initialize(this,this.values,c),this},a._sfgetter("projectImages",function(){var a,b;return null==this.values?null:null!=this._cachedProjectImages?this._cachedProjectImages:(this.values.projectImages=this.dedupeProjectImages(this.values.projectImages),this._cachedProjectImages=function(){var c,d,e,f;for(e=this.values.projectImages,f=[],c=0,d=e.length;c<d;c++)b=e[c],a=this.imageFactory.newInstance(b),this.uppObjectCollection.addProductImageId(a.imageId,a.productImageID),a.isThumb&&this._currentUploadTotalList.indexOf(a.productImageID)===-1&&(this._currentUploadTotalList.push(a.productImageID),this._currentUploadInProgressList.push(a.productImageID)),f.push(a);return f}.call(this))}),a._sfgetter("lastProductImageID",function(){return parseInt(this.values.lastProductImageID)}),a._sfgetter("stripBorders",function(){return"boolean"==typeof this.values.stripBorders?this.values.stripBorders:"true"===this.values.stripBorders.toLowerCase()}),a._sfgetter("currentUploadTotal",function(){return this._currentUploadTotalList.length}),a._sfgetter("currentUploadInProgress",function(){return this._currentUploadInProgressList.length}),a._sfgetter("currentProductImageIDsUploading",function(){return[].concat(this._currentUploadInProgressList)}),a._sfgetter("currentUploadErrors",function(){return this._uploadErrorList.length}),a.prototype.createIdMap=function(){var a,b,c,d,e;for(b={},e=this.projectImages,c=0,d=e.length;c<d;c++)a=e[c],b[a.imageId]=!0;return b},a.prototype.dedupeProjectImages=function(a){var b,c;return c=[],b=a.filter(function(a){return!c[a.productImageID]&&(c[a.productImageID]=!0,!0)}),b.length<a.length&&this.eventBus.publish(this.eventBus.events.PROJECT_SAVE_FULL),b},a.prototype.isReadyToSave=function(){var a;return a=0===this.currentUploadInProgress&&0===this.currentUploadErrors,a&&(this.checkForIncompleteUploads(),this.currentUploadErrors>0)?(this.eventBus.publish(this.eventBus.events.MODAL_UPLOAD_ERROR_SHOW,{}),!1):a},a.prototype.resetUploadErrors=function(){return this._uploadErrorList=[]},a.prototype.resetUploadTotalList=function(){return this._currentUploadTotalList=[]},a.prototype.retryFailedUploads=function(){return this.resetUploadTotalList(),this._currentUploadInProgressList=[],this.projectImages.forEach(function(a){return function(b){var c;if(b.hasError){if(c=b.uppObject,!c||c.cancelled)return;return b.clearError(),a._currentUploadTotalList.indexOf(b.productImageID)===-1&&(a._currentUploadTotalList.push(b.productImageID),a._currentUploadInProgressList.push(b.productImageID)),b.Xorigin!==a.imageOrigin.LOCAL&&c.mPath&&100===c.state?a.eventBus.publish(a.eventBus.events.UPP_IMAGE_UPDATE,{detail:c}):"function"==typeof c.retry?c.retry():void 0}}}(this))},a.prototype.invalidateImageUseCounts=function(){return this._usedImages=0,this.projectImages.forEach(function(a){return a.useCount=0})},a.prototype.mergeImageCollection=function(a){var b;return b=this.projectImages.map(function(a){return a.productImageID}),a.projectImages.filter(function(a){return b.indexOf(a.productImageID)===-1}).reverse().forEach(function(a){return function(b){return a.projectImages.unshift(b),a.values.projectImages.unshift(b.projectData),a.uppObjectCollection.addProductImageId(b.imageId,b.productImageID)}}(this)),this._updateLastProductImageId()},a.prototype.replaceImageCollection=function(a){return this._cachedProjectImages=null,this.values.projectImages=[],a.projectImages.forEach(function(a){return function(b){var c;if(a.projectImages.push(b),b.hasError!==!0)return a.values.projectImages.push(b.projectData),"function"==typeof(c=a.project).updateProductImageAsset?c.updateProductImageAsset(b):void 0}}(this)),this._updateLastProductImageId()},a.prototype.removeUnusedImages=function(){var a,b,c,d,e,f,g,h,i;for(b=[],i=this._cachedProjectImages,d=e=0,g=i.length;e<g;d=++e)c=i[d],0===c.useCount&&b.push(c);for(f=0,h=b.length;f<h;f++)a=b[f],this.removeImage(this.getImageIndex(a.productImageID)),this.eventBus.publish(this.eventBus.events.PALETTE_IMAGES_REMOVED,a);return function(){var c,d,e;for(e=[],c=0,d=b.length;c<d;c++)a=b[c],e.push(a.values);return e}()},a.prototype.removeImage=function(a){var b,c,d,e,f,g,h;for(b=this._cachedProjectImages[a],!b.hasError&&b.isThumb&&(e=this._currentUploadInProgressList.indexOf(b.productImageID),e===-1?this._logger.error("oops, image not in currentUploadInProgressList"):this._currentUploadInProgressList.splice(e,1),e=this._currentUploadTotalList.indexOf(b.productImageID),e===-1?this._logger.error("oops, image not in currentUploadTotalList"):this._currentUploadTotalList.splice(e,1),this._currentUploadInProgressList.length<=0&&this.$timeout(this.completeUpload,100)),this._cachedProjectImages.splice(a,1),h=this.values.projectImages,d=f=0,g=h.length;f<g;d=++f)if(c=h[d],parseInt(null!=c?c.productImageID:void 0)===b.productImageID)return void this.values.projectImages.splice(d,1)},a.prototype.addImageAt=function(a,b){var c,d,e,f,g;for(g=this.values.projectImages,d=e=0,f=g.length;e<f;d=++e)if(c=g[d],parseInt(null!=c?c.productImageID:void 0)===a.productImageID)return;this.values.projectImages.splice(b,0,a),this._cachedProjectImages.splice(b,0,this.imageFactory.newInstance(a))},a.prototype.addImage=function(a){var b;return b=this.imageFactory.newInstance(a),!(this.values.projectImages.length>=d)&&(a.productImageID=++this.values.lastProductImageID,this.values.projectImages.push(a),this._cachedProjectImages.push(b),!0)},a.prototype.containsImage=function(a){var b,c,d,e;for(e=this.projectImages,c=0,d=e.length;c<d;c++)if(b=e[c],b.imageId===a)return!0;return!1},a.prototype.getImageByProductImageId=function(a){var b,c,d,e;if(null!=(c=this.projectImages))for(d=0,e=c.length;d<e;d++)if(b=c[d],b.productImageID===a)return b;return null},a.prototype.getImageByImageId=function(a){var b,c,d,e;for(e=this.projectImages,c=0,d=e.length;c<d;c++)if(b=e[c],b.imageId===a)return b;return null},a.prototype.addThumbnail=function(a){var b;return a.productImageID=++this.values.lastProductImageID,b=this.imageFactory.newInstance(a),this.uppObjectCollection.addProductImageId(b.imageId,b.productImageID),this._cachedProjectImages.push(b),b.isThumb?this._currentUploadTotalList.indexOf(b.productImageID)===-1&&(this._currentUploadTotalList.push(b.productImageID),this._currentUploadInProgressList.push(b.productImageID)):this.updateProjectImages(b.projectData),b},a.prototype.updateThumbnail=function(a,b){var c;if(c=this.getImageByProductImageId(a),null!=c)return this.imageUploaded(c),c.hasError=!1,c.updateThumbnail(b),this.updateProjectImages(c.projectData),c},a.prototype.updateProjectImages=function(a){var b,c,d,e,f;for(f=this.values.projectImages,c=d=0,e=f.length;d<e;c=++d)if(b=f[c],parseInt(null!=b?b.productImageID:void 0)===parseInt(a.productImageID))return void(this.values.projectImages[c]=a);return this.values.projectImages.push(a)},a.prototype.removeFromProjectImages=function(a){var b,c,d,e,f;for(f=this.values.projectImages,c=d=0,e=f.length;d<e;c=++d)if(b=f[c],parseInt(null!=b?b.productImageID:void 0)===parseInt(a))return void this.values.projectImages.splice(c,1)},a.prototype.imageUploaded=function(a){var b;if(this._currentUploadInProgressList.length>0&&(b=this._currentUploadInProgressList.indexOf(a.productImageID))>=0)return this._currentUploadInProgressList.splice(b,1),this._currentUploadInProgressList.length<=0?this.$timeout(this.completeUpload,100):void 0},a.prototype.completeUpload=function(){return this.resetUploadTotalList(),this._currentUploadInProgressList=[],this.checkForIncompleteUploads(),this._uploadErrorList.length>0?this.eventBus.publish(this.eventBus.events.MODAL_UPLOAD_ERROR_SHOW,{}):this.eventBus.publish(this.eventBus.events.UPP_UPLOAD_COMPLETED,{})},a.prototype.checkForIncompleteUploads=function(){return this.values.projectImages.forEach(function(a){return function(b){var c,d;if(/&DATA=uppTemp&/.test(b.view))return d=b.view.match(/imageID=([^&].*?)&/),c=d[1],a.setUploadError(b.productImageID,c)}}(this))},a.prototype.uploadErrors=function(){return this.checkForIncompleteUploads(),this._uploadErrorList.slice()},a.prototype.setUploadError=function(a,b){var c;if((null!=a||null!=b)&&(null!=a?c=this.getImageByProductImageId(a):null!=b&&(c=this.getImageByImageId(b)),null!=c&&(c.hasError=!0),this.removeFromProjectImages(a),!(this._uploadErrorList.indexOf(a)>-1)&&c))return this._uploadErrorList.push(a),this.imageUploaded(c)},a.prototype.cancelUpload=function(a){var b;if(null!=a)return b=this.getImageIndex(a),b>-1?this.removeImage(b):void 0},a.prototype.getImageIndex=function(a){var b,c,d,e,f;for(f=this.projectImages,c=d=0,e=f.length;d<e;c=++d)if(b=f[c],parseInt(b.productImageID)===parseInt(a))return c;return-1},a.prototype._updateLastProductImageId=function(){return this.values.lastProductImageID=this.projectImages.map(function(a){return a.productImageID}).reduce(function(a,b){return a>b?a:b},0)},a.prototype.getUsedImagesWithError=function(){var a,b,c,d,e,f;for(c=[],f=this.projectImages,b=d=0,e=f.length;d<e;b=++d)a=f[b],a.hasError&&a.useCount>0&&c.push(a);return c},a.prototype.get3rdPartyImagesWithError=function(){var a,b,c,d,e,f;for(c=[],f=this.projectImages,b=d=0,e=f.length;d<e;b=++d)a=f[b],a.hasError&&a.isFrom3rdPartySource&&c.push(a);return c},a.prototype.updateAnonymousImages=function(a){var b,c,d,e,f;for(f=[],d=0,e=a.length;d<e;d++)c=a[d],b=this.getImageByImageId(c.anonymousId),(null!=b?b.isAnonymous:void 0)?(b.updateAnonymousImage(c.procsimpleUrl),this.updateProjectImages(b.projectData),f.push(this.project.updateProductImageAsset(b))):f.push(void 0);return f},a.prototype.usedImagesAdd=function(){return this._usedImages++},a.prototype.usedImagesSubtract=function(){return this._usedImages--},a.prototype.getUsedImages=function(){return this._usedImages},a}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("imageCollection",["modelInitializer","imageFactory","eventBus","imageOrigin","loggerFactory","$timeout","uppObjectCollection",a])}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b,d,e,f,g){this.styleProvider=a,this.imageURLService=b,this.$routeParams=d,this.projectContentValidator=e,this.$translate=f,this.config=g,this.textAssetImageURL=c(this.textAssetImageURL,this),this.contentForLines=c(this.contentForLines,this),this.styleForTextAsset=c(this.styleForTextAsset,this),this.sourceURLForAsset=c(this.sourceURLForAsset,this),this.imageAssetURL=c(this.imageAssetURL,this),this.styleForPABFade=c(this.styleForPABFade,this),this.styleForUIElement=c(this.styleForUIElement,this),this.styleForFadeUnderlay=c(this.styleForFadeUnderlay,this),this.styleForImage=c(this.styleForImage,this),this.styleForImageWrapper=c(this.styleForImageWrapper,this),this.styleForAsset=c(this.styleForAsset,this),this.serverText="false"!==this.$routeParams.serverText}var b,d;return d=100,b=40,a.prototype.init=function(a,b,c,d,e){return this.page=a,this.width=b,this.height=c,this.assetScale=d,this.stylesAsString=null==e||e,this.pageStyle=this._prepareStyles(this.styleProvider.styleForPage(this.page,this.assetScale)),this.page.isStockCover&&(this.stockCoverStyle=this._prepareStyles(this.styleProvider.styleForStockCover(this.page,this.assetScale))),this.pageClasses=this.page.ideaLayout?"":"non-idea-layout",this.classForAsset=this.styleProvider.classForAsset,this},a.prototype.styleForAsset=function(a){return this._prepareStyles(this.styleProvider.styleForAsset(a))},a.prototype.styleForImageWrapper=function(a){return this._prepareStyles(this.styleProvider.styleForImageAssetWrapper(a))},a.prototype.tooltipForAsset=function(a){var b;if(null==(null!=a&&null!=(b=a.asset)?b.assetType:void 0)||(null!=a?a.isHollow:void 0))return"";switch(a.asset.assetType){case"graphic":if(this.config.superSimple&&(this.page.isTitlePage()||this.page.isCover()))return"";if(this.page.isCover()||this.page.isTitlePage())return this.$translate("SilverApp.arrangeCoverPageTooltip");if(this.config.superSimple)return this.$translate("SilverApp.pageTabPageTooltip");if(this.config.arrange)return this.$translate("SilverApp.arrangeInnerPageTooltip");break;case"image":return a.hasAssignedImage()?this.$translate("SilverApp.imageDragTooltip"):this.$translate("SilverApp.imageTooltipEmpty")}return""},a.prototype.tooltipForImageRemoveButton=function(a){return null==(null!=a?a.hasAssignedImage:void 0)?"":a.hasAssignedImage()?this.$translate("SilverApp.removeImageTooltip"):this.$translate("SilverApp.removeImageTooltipEmpty")},a.prototype.classForImage=function(a){return a.hasAssignedImage()?"has-assigned-image":""},a.prototype.styleForImage=function(a){return this._prepareStyles(this.styleProvider.styleForImageAsset(a))},a.prototype.styleForFadeUnderlay=function(a){return this._prepareStyles(this.styleProvider.styleForFadeUnderlay(a))},a.prototype.styleForUIElement=function(a,b,c,d){return this._prepareStyles(this.styleProvider.styleForUIElement(a,b,c,d))},a.prototype.styleForPABFade=function(a){return this._prepareStyles(this.styleProvider.styleForPABFade(a))},a.prototype.imageAssetURL=function(a){return"uppTemp"===a.data?this._escapeQuotes(this.imageURLService.thumbURLForImageAsset(a)):this._escapeQuotes(this.imageURLService.imageURLForImageAsset(a,this.assetScale))},a.prototype.sourceURLForAsset=function(a){return null!=a.imageAssignment?this.imageAssetURL(a):this._escapeQuotes(a.sourceUrl)},a.prototype.classForGraphicAsset=function(a){var b;return null!=(null!=a&&null!=(b=a.asset)?b.type:void 0)?a.asset.type+"-asset":""},a.prototype.shouldRenderTextLowRes=function(a){return this.width<d&&this.height<d&&a.styles.fontSize<b},a.prototype.styleForTextAsset=function(a){return this._prepareStyles(this.styleProvider.styleForTextAsset(a))},a.prototype.contentForLines=function(a){var b,c,d,e;for(c=[],d=0,e=a.length;d<e;d++)b=a[d],c.push(this.projectContentValidator.escapeAndSanitizeContent(b.text));return c.join("<br />")},a.prototype.textAssetImageURL=function(a){return this._escapeQuotes(this.imageURLService.imageURLForTextAsset(a))},a.prototype.reverseScaleStyle=function(a){return"-webkit-transform: scale("+1/a+");\n-moz-transform: scale("+1/a+");\n-o-transform: scale("+1/a+");\n-ms-transform: scale("+1/a+");\ntransform: scale("+1/a+");"},a.prototype._prepareStyles=function(a){var b,c,d;if(!this.stylesAsString)return a;b="";for(c in a)d=a[c],b+=""+c+": "+d+"; ";return b},a.prototype._escapeQuotes=function(a){var b;return this.stylesAsString?(b=null!=a?a.replace(/"/g,"&quot;"):void 0,b=null!=b?b.replace(/'/g,"\\'"):void 0,"'"+b+"'"):a},a}(),b=function(){function b(a,b,c,d,e,f){this.styleProvider=a,this.imageURLService=b,this.$routeParams=c,this.projectContentValidator=d,this.$translate=e,this.config=f}return b.prototype.newInstance=function(b,c,d,e,f){var g;return g=new a(this.styleProvider,this.imageURLService,this.$routeParams,this.projectContentValidator,this.$translate,this.config),g.init(b,c,d,e,f)},b}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("pageRenderDataFactory",["pageStyleProvider","imageURLService","$routeParams","projectContentValidator","$translate","CONFIG",b])}.call(this),function(){"use strict";var a,b,c;c=1e6,a=function(){function a(a){this.ModelInitializer=a}return a.VIRTUAL_IMAGE_TYPE="virtual-image",a.prototype.init=function(a){return this.asset={assetType:this._validateAssetType(a.assetType),xOffset:this._validateValue(a.xOffset,"VirtualAsset.xOffset"),yOffset:this._validateValue(a.yOffset,"VirtualAsset.yOffset"),width:this._validateValue(a.width,"VirtualAsset.width"),height:this._validateValue(a.height,"VirtualAsset.height"),imageXOffset:a.xOffset,imageYOffset:a.yOffset,containerXOffset:a.xOffset,containerYOffset:a.yOffset,borderStroke:"0",isBackground:function(){return!1},containerId:a.containerId,locked:!0,rotation:"0",uniqueProjectRef:a.uniqueProjectRef,generatedAssetId:c++}},a.prototype._validateAssetType=function(b){if(b!==a.VIRTUAL_IMAGE_TYPE)throw new Error("unknown virtual asset assetType, "+b);return b},a.prototype._validateValue=function(a,b){if(!this.ModelInitializer.isType(a,"number",b&&this._isValidFloat()))throw new Error("invalid virtual asset property, "+b+", value, "+a);return a},a.prototype._isValidFloat=function(a){return!isNaN(parseFloat(a))},a.prototype.isBackground=function(){return!1},a}(),b=function(){function b(a){this.modelInitializer=a}return b.prototype.newInstance=function(b){return new a(this.modelInitializer).init(b)},b}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("virtualAssetFactory",["modelInitializer",b])}.call(this),function(){"use strict";var a,b;a=function(){function a(a){this.virtualAssetFactory=a}return a.VIRTUAL_IMAGE_TYPE="virtual-image",a.prototype.init=function(a){return this._cachedValues=a,this._cachedAsset=null,this},a.prototype.hasAssignedImage=function(){return!1},a.initGettersSetters=function(){return this._sfgetter("asset",function(){return null==this._cachedAsset&&(this._cachedAsset=this.virtualAssetFactory.newInstance(this._cachedValues),this._cachedValues=null),this._cachedAsset}),this._sfgetter("canRemove",function(){return!1})},a}(),b=function(){function b(b){this.virtualAssetFactory=b,a.initGettersSetters()}return b.prototype.newInstance=function(b){return b.assetType=a.VIRTUAL_IMAGE_TYPE,new a(this.virtualAssetFactory).init(b)},b}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("virtualImageAssetFactory",["virtualAssetFactory",b])}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g){this.$http=a,this.config=b,this.productModelStrategy=d,this.productRequestBuilder=e,this.$q=f,this.deviceDetectionService=g,this.logger=c.newInstance("DocsmithAPI")}return a.SUBTYPE_GCP="GCP",a.SUBTYPE_GSS="GSS",a.SUBTYPE_GSP="GSP",a.SUBTYPE_MMB="MMB",a.SUBTYPE_MMB_HIDDEN="MMB_HIDDEN",a.SUBTYPE_VOYAGER="VOYAGER",a.SUBTYPE_RANGER="RANGER",a.SUBTYPE_GCOLLAGE="GCOLLAGE",a.prototype._getConversionUrl=function(){return""+this.config.docsmith.url+"/api/"+this.config.dsVersion+"/docsmith/conversion"},a.prototype._getOccasionUrl=function(a){return""+this.config.docsmith.url+"/api/"+this.config.dsVersion+"/content/occasions/"+a},a.prototype.convertProject=function(a,b){var c,d,e,f,g,h;return c=this.$q.defer(),a.existingProject=this.productModelStrategy.wrapProject(b),a.saveProject=this.config.saveOnConversion&&null!=b.projectGUID,this.config.superSimple&&null!=(null!=(h=(f=this.deviceDetectionService.getSuperSimpleDefaults()).constraints)?h.layoutCategory:void 0)&&(a.constraints=this.config.defaults.constraints,a.constraints.LayoutCategoryConstraint={category:f.constraints.layoutCategory}),e=function(a){return function(d){return a.logDocsmithError(d),d.data.project=b,c.reject(d)}}(this),g=this._getConversionUrl(),d=this.$http({method:"POST",url:g,extendedTimeout:!0,data:this.productRequestBuilder.applyConversionRequest(a)}),d.success(function(a,b,d){var f,h,i,j;for(j=a.warnings,h=0,i=j.length;h<i;h++)if(f=j[h],"error"===f.level)return void e({url:g,data:a,status:b,headers:d});return c.resolve({url:g,data:a,status:b,headers:d})}),d.error(function(a,b,c){return e({url:g,data:a,status:b,headers:c})}),c.promise},a.prototype.convertPage=function(a){var b,c,d,e;return b=this.$q.defer(),d=function(a){return function(c){return a.logDocsmithError(c),b.reject(c)}}(this),e=this._getConversionUrl(),c=this.$http({method:"POST",url:e,extendedTimeout:!0,data:this.productRequestBuilder.applyPageConversionRequest(a)}),c.success(function(a,c,f){var g,h,i,j;for(j=a.warnings,h=0,i=j.length;h<i;h++)if(g=j[h],"error"===g.level)return void d({url:e,data:a,status:c,headers:f});return b.resolve({url:e,data:a,status:c,headers:f})}),c.error(function(a,b,c){return d({url:e,data:a,status:b,headers:c})}),b.promise},a.prototype.occasions=function(a){var b;return b=this.$http({method:"GET",url:this._getOccasionUrl(a)})},a.prototype.changeSize=function(a,b){return this.convertProject({bookSize:a},b)},a.prototype.changeCoverType=function(a,b,c){return this.convertProject({coverType:a,finish:b},c)},a.prototype.changeStyle=function(a,b,c){var d;return d={styleId:a,styleVersion:b},c.product.isBlank()&&(d.constraints={TextAreaCountConstraint:{rule:"none"}}),this.convertProject(d,c.values)},a.prototype.changeSizeAndCover=function(a,b,c){return this.convertProject({coverSpecId:a,finish:b},c)},a.prototype.logDocsmithError=function(a){var b,c,d,e,f,g,h,i;h=a.url,c=a.data,g=a.status,d=a.headers;try{i=d("docsmith-worker-index"),f=d("docsmith-service-version"),b=d("docsmith-api-version"),e=d("docsmith-service-hostname")}catch(a){}return this.logger.error("Docsmith service error:\nurl: "+h+"\nHTTP status: "+g+"\nerror:"+JSON.stringify(c,null,2),{url:h,data:c,status:g,workerIndex:i,serviceVersion:f,apiVersion:b,hostname:e})},a.prototype.preventSubtypeRewrite=function(b){var c;return(c=null!=b?b.subtype:void 0)===a.SUBTYPE_MMB||c===a.SUBTYPE_MMB_HIDDEN||c===a.SUBTYPE_VOYAGER||c===a.SUBTYPE_RANGER},a.prototype.rewriteSubtype=function(b){var c,d,e;return e=this.productModelStrategy.wrapProject(b),c=this.productModelStrategy.unwrapProduct(e),this.config.richSubtypes?this.preventSubtypeRewrite(c)?this.productModelStrategy.unwrapProject(e):(d=this.config.superSimple?a.SUBTYPE_GSS:this.config.customize?a.SUBTYPE_GCP:a.SUBTYPE_GSP,"editor"===this.config.defaults.productMode&&(d=a.SUBTYPE_GCOLLAGE),null!=c&&(c.subtype=d),this.productModelStrategy.unwrapProject(e)):b},a}(),a.$inject=["$http","CONFIG","loggerFactory","productModelStrategy","productRequestBuilder","$q","deviceDetectionService"],angular.module("galleon").service("docsmithAPI",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l){this.docsmithAPI=a,this.commandService=c,this.eventBus=d,this.contentService=e,this.omnitureService=g,this.uppService=h,this.translate=i,this.productModelStrategy=j,this.deviceDetectionService=k,this.$q=l,this._convertProjectForStyleChange=b(this._convertProjectForStyleChange,this),this._convertProjectForSizeOrCoverChange=b(this._convertProjectForSizeOrCoverChange,this),this._postProjectUpdateAction=b(this._postProjectUpdateAction,this),this.logger=f.newInstance("DocsmithConversionService")}return a.prototype.start=function(a,b,c){var d,e,f;return null==c&&(c={}),e=this.$q.defer(),d=this.logger.asyncMetric("docsmithConversion"),this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this.uppService.pauseUpload(),this.uppService.deferUppEvents(),f=this.docsmithAPI.convertProject(b,a.values),f.then(function(f){return function(g){var h;return d.success(),h=g.data.project,g.data.oldProject={PhotobookProject:a.values},f.doUpdateProjectCommand(a,h,f._convertProjectForSizeOrCoverChange,function(){var a;if(b.saveProject&&(null!=(a=g.data.projectMetadata)?a.updateTime:void 0)&&(f.eventBus.publish(f.eventBus.events.PROJECT_SAVE_COMPLETED),f.eventBus.publish(f.eventBus.events.UPDATE_SAVE_TIME,{lastModifiedTime:g.data.projectMetadata.updateTime})),null!=c.forceWarning&&g.data.warnings.push(c.forceWarning),!(c.postConversion&&f.hasPostChangeSizeWarnings(c.postConversion.warning)||f.deviceDetectionService.isDeviceATablet()))switch(!1){case!f.hasChangeSizeWarnings(g.data.warnings):f.eventBus.publish(f.eventBus.events.SHOW_SIZE_CHANGE_WARNING_DIALOG,g.data);break;case!f.hasChangeCoverWarnings(g.data.warnings):f.eventBus.publish(f.eventBus.events.SHOW_COVER_CHANGE_WARNING_DIALOG,g.data)}return f.eventBus.publish(f.eventBus.events.PLEASE_WAIT_HIDE),e.resolve(g),f._postProjectUpdateAction(c.postConversion)})}}(this),function(a){return function(c){var f;return a._handleConversionError(d,c.status,c.data),f=JSON.stringify(b,["coverType","coverSpecId","finish","bookSize"]),a.logger.critical("Docsmith conversion failed (with request "+f+"): "+a._getErrorMessage(c.data,c.status)),e.reject(c)}}(this)),e.promise},a.prototype.startChangeStyle=function(a,b,c){var d,e;return d=this.logger.asyncMetric("changeStyle"),this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),e=this.docsmithAPI.changeStyle(b,c,a),e.then(function(b){return function(c){var e;return d.success(),e=c.data.project,b.eventBus.publish(b.eventBus.events.PLEASE_WAIT_HIDE),b.doUpdateProjectCommand(a,e,b._convertProjectForStyleChange)}}(this),function(a){return function(b){return a._handleConversionError(d,b.status,b.data),a.logger.critical("Change style conversion failed "+a._getErrorMessage(b.data,b.status))}}(this)),e},a.prototype._handleConversionError=function(a,b,c){return a.failure({status:b,response:c}),this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_HIDE),this.uppService.resumeUpload(),this.eventBus.publish(this.eventBus.events.PROJECT_CONVERSION_ERROR)},a.prototype.hasChangeSizeWarnings=function(a){return a.some(function(a){var b;return"aspectRatioChanged"===(b=a.id)||"coverChanged"===b})},a.prototype.hasPostChangeSizeWarnings=function(a){return!!a&&"postChangeSize"===a.id},a.prototype.hasChangeCoverWarnings=function(a){return a.some(function(a){return"sizeChanged"===a.id})},a.prototype.doUpdateProjectCommand=function(a,b,c,d){var e;return e=this.contentService.fetchStyle(this.productModelStrategy.unwrapProduct(b)),e.then(function(e){return function(f){var g;return g=a.imageCollection.projectImages.slice(),c(b,f,g),d&&angular.isFunction(d)&&d(),e.uppService.resumeUpload()}}(this),function(a){return function(b){return a.eventBus.publish(a.eventBus.events.PROJECT_CONVERSION_ERROR),a.logger.error("Error fetching style after conversion: "+b.message),a.uppService.resumeUpload()}}(this))},a.prototype._postProjectUpdateAction=function(a){var b;if(a&&this.hasPostChangeSizeWarnings(a.warning))return b=a.warning,this.eventBus.publish(this.eventBus.events.SHOW_POST_SIZE_CHANGE_WARNING_DIALOG,b)},a.prototype._convertProjectForSizeOrCoverChange=function(a,b,c){return this.commandService.execute("ConversionCommand",{project:a,style:b,images:c})},a.prototype._convertProjectForStyleChange=function(a,b,c){var d;return d={previousStyleName:this.contentService.currentStyle.displayName,newStyleName:b.displayName,continue:function(){}},this.commandService.execute("ConversionCommand",{project:a,style:b,images:c}),this.omnitureService.trackLink({linkName:this.omnitureService.CHANGE_STYLE_LINK_NAME})},a.prototype._getErrorMessage=function(a,b){return null!=a&&""!==a?b+" "+a:b},a.prototype.describeProjectConversion=function(a,b){var c,d,e;return c=this.productModelStrategy.unwrapProduct(a),e=this.productModelStrategy.unwrapProduct(b),d={sizeBefore:c.bookSizeID,coverBefore:this._describeCoverType(c),sizeAfter:e.bookSizeID,coverAfter:this._describeCoverType(e)}},a.prototype._describeCoverType=function(a){var b,c,d;return b=a.cover.coverSpecID,c=a.cover.sku,d=null!=a.photobookDustJacket?""+b+"_dustjacket":c,this.translate(d)},a.prototype.convertPage=function(a){return this.docsmithAPI.convertPage(a)},a}(),a.$inject=["docsmithAPI","commandService","eventBus","contentService","loggerFactory","omnitureService","uppService","$translate","productModelStrategy","deviceDetectionService","$q"],angular.module("galleon").service("docsmithConversionService",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.autofill=a,this.imageCollection=b}return a.prototype.galleonAssetToAutofillAssetDetails=function(a){return{container:{width:a.width,height:a.height}}},a.prototype.galleonImageModelToAutofillImage=function(a){var b,c;return b=this.galleonImageModelToDocsmithImage(a),c=this.getImageDimension(a),b.rotatedWidth=c.width,b.rotatedHeight=c.height,b.croppedWidth=b.rotatedWidth*(a.cropurx-a.cropllx),b.croppedHeight=b.rotatedHeight*(a.cropury-a.croplly),b},a.prototype.galleonImageModelToDocsmithImage=function(a){var b;return b=a.data,"object"==typeof b&&(b="uppTemp"),{width:a.Xwidth,height:a.Xheight,captureTime:a.captureTime,uploadTime:a.uploadTime,filename:a.filename,effect:a.effect,redeye:a.redeye,ranking:a.ranking,rotation:a.rotation,title:a.title,description:a.description,crop:{llx:a.cropllx,lly:a.croplly,urx:a.cropurx,ury:a.cropury},xOrigin:a.Xorigin,id:a.imageId,data:b,projectImageId:a.productImageID}},a.prototype.galleonImageModelToGalleonImageReference=function(a){return{data:a.data,description:a.description,effect:a.effect,fadeColor:"#FFFFFF",fadeValue:"1",height:a.Xheight,id:a.imageId,llx:a.cropllx,lly:a.croplly,redeye:a.redeye,rotation:a.rotation,urx:a.cropurx,ury:a.cropury,width:a.Xwidth,projectImageId:""+a.productImageID}},a.prototype.imageToAssignedImageReference=function(a,b){var c,d,e,f,g;return null!=a&&b?(g=this.galleonImageModelToGalleonImageReference(a),d=this.galleonImageModelToAutofillImage(a),c=this.galleonAssetToAutofillAssetDetails(b.asset),e={width:d.rotatedWidth,height:d.rotatedHeight},f=this.autofill.utils.CropUtil.expandCropForArea(e,d.crop,c.container),this.applyCrop(g,f)):null},a.prototype.applyCrop=function(a,b){return a.llx=b.llx,a.lly=b.lly,a.urx=b.urx,a.ury=b.ury,a},a.prototype.imageAssignmentForNewAsset=function(a,b){var c,d,e,f,g,h;return null==a||null==b?null:(h=angular.copy(a.imageAssignment),d=this.imageCollection.getImageByProductImageId(a.projectImageId),e=this.getAssignedImageDimens(d,a),g={llx:a.imageAssignmentLlx,lly:a.imageAssignmentLly,urx:a.imageAssignmentUrx,ury:a.imageAssignmentUry},c=this.galleonAssetToAutofillAssetDetails(b.asset),f=this.autofill.utils.CropUtil.expandCropForArea(e,g,c.container),this.applyCrop(h,f))},a.prototype.getAssignedImageDimens=function(a,b){return this.getImageDimension(a,b.imageAssignmentRotation)},a.prototype.getImageDimension=function(a,b){var c,d,e;null==b&&(b=null),c=null===b?a.rotation:b;try{c=parseInt(c,10)}catch(a){c=0}return e=a.Xwidth,d=a.Xheight,this.autofill.utils.RotationEnum.rotationFlipsDimensions(c)&&(e=a.Xheight,d=a.Xwidth),{width:e,height:d}},a}(),a.$inject=["autofill","imageCollection"],angular.module("galleon").service("modelAdapter",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){
return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){this.$http=a,this.$q=c,this.config=d,this.project=e,this.eventBus=f,this.contentService=h,this.reportingDataCalculator=i,this.docsmithAPI=j,this.projectValidator=k,this.magicShopService=l,this.upsellReportingService=m,this.dateUtil=n,this.productRequestBuilder=o,this.globalContentService=p,this.productModelStrategy=q,this.productEventsInitializer=r,this.httpService=s,this.deviceDetectionService=t,this.galleon=u,this.legacyProjectClient=v,this.projectClient=w,this.innerPages=b(this.innerPages,this),this.createDocsmithProject=b(this.createDocsmithProject,this),this.create=b(this.create,this),this.loadShared=b(this.loadShared,this),this.load=b(this.load,this),this.fetchProjectJSON=b(this.fetchProjectJSON,this),this.multipleSummaries=b(this.multipleSummaries,this),this.singleSummary=b(this.singleSummary,this),this.summaries=b(this.summaries,this),this.id=Math.random(),this.currentProject={},this.lastModifiedTime="",this.logger=g.newInstance("ProjectService"),this.autoSaveErrorCounter=0,this.eventBus.subscribe(this.eventBus.events.UPDATE_SAVE_TIME,function(a){return function(b,c){return a._handleSaveTimeUpdate(c)}}(this))}return a.AUTOSAVE_TRIGGER="Auto",a.MAX_SAVE_FAILURE_LOGS=6,a.prototype.init=function(){var a;return a=100*Math.random(),(this.config.legacySave||a>100)&&!this.config.forceIncrSave?(this.goLegacy(),"legacy"):(this.goIncremental(),"incremental")},a.prototype.goLegacy=function(a){return null==a&&(a=!1),this.config.legacySave=!0,this.config.incrementalSave=!1,a?(this.eventBus.unsubscribe(this.eventBus.events.PROJECT_OBSERVED_FOR_PATCH),this.logger.warn("fallback to legacy save")):this.logger.warn("legacy save"),this.projectClient=this.legacyProjectClient},a.prototype.goIncremental=function(){return this.config.legacySave=!1,this.config.incrementalSave=!0,this.logger.warn("incremental save"),this.projectClient=this.projectClient,this.observeToken=this.eventBus.subscribe(this.eventBus.events.PROJECT_OBSERVED_FOR_PATCH,function(a){return function(){return a._applyProjectModifications()}}(this))},a.prototype.summaries=function(a,b){var c;return null==b&&(b="GCP"),c=this.$q.defer(),this._fetchSummaries(a,b).then(function(a){return function(b){return c.resolve(b),a.summaryData=b,a.eventBus.publish(a.eventBus.events.PROJECT_SUMMARIES,a.summaryData)}}(this),function(a){return c.reject(a)}),c.promise},a.prototype.singleSummary=function(a,b){var c;return c=this.$q.defer(),this._fetchSingleSummary(a,b).then(function(a){return c.resolve(a)},function(a){return c.reject(a)}),c.promise},a.prototype.multipleSummaries=function(a,b){var c,d,e,f,g,h,i;for(null==b&&(b=["GCP"]),e=this.$q.defer(),d={PaginatedCollection:{items:[],startIndex:0,itemCount:0,requestedPageSize:50*b.length}},c=function(a){var b,c,e,f,g;for(g=null!=a&&null!=(f=a.PaginatedCollection)?f.items:void 0,c=0,e=g.length;c<e;c++)b=g[c],d.PaginatedCollection.items.push(b),d.PaginatedCollection.itemCount++},f=[],h=0,i=b.length;h<i;h++)g=b[h],f.push(this._fetchSummaries(a,g).then(c));return this.$q.all(f).then(function(a){return function(){return e.resolve(d),a.summaryData=d,a.summaryData.PaginatedCollection.items.sort(a._sortByUpdtimeDescending),a.eventBus.publish(a.eventBus.events.PROJECT_SUMMARIES,a.summaryData)}}(this),function(){return e.reject(c)}),e.promise},a.prototype._sortByUpdtimeDescending=function(a,b){return a.updtime<b.updtime?1:b.updtime<a.updtime?-1:0},a.prototype._fetchSingleSummary=function(a,b){var c,d,e;return c=this.$q.defer(),d=this.config.projectLoadService,e=d+("/"+a+"/photobooks/summary/"+b),this.$http({method:"GET",url:e}).success(function(a,b,d,e){return c.resolve(a)}).error(function(a){return function(b,d,e,f){var g;return a.logger.warn("Could not get summary: "+b),g={PaginatedCollection:{items:[],startIndex:0,itemCount:0,requestedPageSize:50}},c.resolve(g)}}(this)),c.promise},a.prototype._fetchSummaries=function(a,b){var c,d,e,f;return c=this.$q.defer(),e=this.config.projectLoadService,f=e+("/"+a+"/photobooks/summaries?sort=updtime:desc&pageSize=50&bookType="+b),d=this.logger.asyncMetric("loadSummaries",f),this.$http({method:"GET",url:f}).success(function(a,b,e,f){return d.success(),c.resolve(a)}).error(function(a){return function(b,d,e,f){var g;return a.logger.warn("Could not get summaries: "+b),g={PaginatedCollection:{items:[],startIndex:0,itemCount:0,requestedPageSize:50}},c.resolve(g)}}(this)),c.promise},a.prototype.fetchProjectJSON=function(a,b,c){var d,e,f,g,h;return d=this.$q.defer(),h=this.projectClient.getLoadProjectEndpoint(a,b),e=this.logger.asyncMetric("loadProject",h),g=function(a){return d.resolve(a),e.success()},f=function(a){return function(b){return e.failure({status:b.status,response:b.data}),a.logger.critical("Could not load project: "+b.data),d.reject(new Error("Could not load project"))}}(this),this.projectClient.loadProject(a,b,c).then(g,f),d.promise},a.prototype.load=function(a,b,c){var d,e,f;return this.superSimple=this.config.superSimple,this.superSimpleTablet=this.superSimple&&this.deviceDetectionService.isDeviceATablet(),d=this.$q.defer(),f=function(a){return function(b){return a.lastModifiedTime=b.lastModified,a._loadProject(d,b.data)}}(this),e=function(){return d.reject(new Error("Could not load project"))},this.fetchProjectJSON(a,b,c).then(f,e),d.promise},a.prototype.loadShared=function(a){var b,c,d;return b=this.$q.defer(),d=this.config.sharedProjectLoadService+("/"+a),c=this.logger.asyncMetric("loadProject",d),this.$http({method:"GET",url:d}).success(function(a){return function(d,e,f,g){return a._loadProject(b,d,!0),c.success()}}(this)).error(function(a){return function(d,e,f,g){return c.failure({status:e,response:d}),a.logger.critical("Could not load project: "+d),b.reject(new Error("Could not load project"))}}(this)),b.promise},a.prototype._loadProject=function(a,b,c){var d,e,f,g,h,i,j,k,l;if(null==c&&(c=!1),this.projectWasShared=c,g=this.productModelStrategy.unwrapProject(angular.fromJson(b)),e=null,d=null!=(j=g.reportingData)&&null!=(k=j.properties)?k.filter(function(a){return"lastDevice"===a.key}):void 0,1===d.length&&(e=d[0].value),this.forbidDesktopToMobile(e,this.deviceDetectionService.getDeviceType()),this._createProject(g),this.config.incrementalSave||this._applyProjectModifications(),a.resolve(this.currentProject),this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.currentProject),this.contentService.setStyleAfterInitialProjectLoad(this.currentProject),this.superSimpleTablet)for(l=this.currentProject.product.pages,h=0,i=l.length;h<i;h++)f=l[h],f.hideTextBoxes=!f.isCover()&&!f.hasPopulatedTextAreas()},a.prototype._applyProjectModifications=function(){var a,b,c,d,e;try{if(null!=(e=this.eventBus)&&e.unsubscribe(this.observeToken),c=this.docsmithAPI.rewriteSubtype(this.currentProject.values),d=this.productModelStrategy.wrapProject(c),a=this.productModelStrategy.unwrapProduct(d),this.currentProject.product.subtype=null!=a?a.subtype:void 0,this.projectValidator.validate(this.currentProject,{event:"ProjectService load",intensity:"thorough"}),this.projectWasShared)return delete(this.currentProject.values.projectGUID=void 0)}catch(a){return b=a,console.log(b),this.logger.warn("can not apply project load modifications",b)}},a.prototype.forbidDesktopToMobile=function(a,b){if("Desktop"!==b&&("Desktop"===a||null===a))return this.eventBus.publish(this.eventBus.events.SHOW_OPEN_ON_DESKTOP_WARNING_DIALOG),null},a.prototype._createProject=function(a){return this.currentProject=this.project.init(a),this.upsellReportingService.init(this),this.currentProject},a.prototype.create=function(a,b){var c,d;return null==b&&(b=!0),a=this.productRequestBuilder.applyCreationDefaults(a,this.config,this.deviceDetectionService),this.deviceDetectionService.isDeviceAPhone()?(d=this.config.phoneCoverLayouts,a.cover=d):this.deviceDetectionService.isDeviceATablet()&&(a.cover={frontLayoutId:this.deviceDetectionService.getSuperSimpleDefaults().coverLayouts.front}),c=this.createDocsmithProject(a),this._createNewProject(c,"DocSmith new book creation",b)},a.prototype._createNewProject=function(a,b,c){var d;return null==c&&(c=!0),d=this.$q.defer(),a.then(function(a){return function(e){return a._createProject(e),a.productEventsInitializer.addDefaultEvents(a.currentProject.product).then(function(){return d.resolve(e),c&&a.eventBus.publish(a.eventBus.events.PROJECT_LOADED,a.currentProject),a.contentService.setStyleAfterInitialProjectLoad(a.currentProject),c&&a.eventBus.publish(a.eventBus.events.PROJECT_LOADED,a.currentProject),a.projectValidator.validate(a.currentProject,{event:b,intensity:"thorough"})})}}(this)),a.catch(function(a){return d.reject(a)}),d.promise},a.prototype.createDocsmithProject=function(a){var b,c,d,e,f,g;return(null!=(f=this.contentService.currentStyle)?f.allowsAutofill:void 0)||(a.constraints.LayoutAttributesMatchConstraint={}),this.createDocsmithProjectPromise?this.createDocsmithProjectPromise:(b=this.$q.defer(),this.createDocsmithProjectPromise=b.promise,e=this.productRequestBuilder.buildCreationRequest(a,this.config),c=!(null!=(g=a.images)?g.length:void 0),d=c?this.logger.asyncMetric("createProject",e.url):this.logger.asyncMetric("createAutofilledProject",e.url),this.$http(e).success(function(a){return function(c,e,f,g){return d.success(),b.resolve(a.docsmithAPI.rewriteSubtype(a.productModelStrategy.unwrapProject(c))),a.createDocsmithProjectPromise=null}}(this)).error(function(a){return function(c,f,g,h){return a.docsmithAPI.logDocsmithError({url:e.url,data:c,status:f,headers:g}),d.failure({status:f,response:c}),a.logger.critical("Could not create project: "+c),b.reject(new Error("Could not create project")),a.createDocsmithProjectPromise=null}}(this)),b.promise)},a.prototype.innerPages=function(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o;return null==b&&(b=this.config.styleId),null==c&&(c=this.config.styleVersion),null==d&&(d=this.config.coverSpecId),null==e&&(e=""),null==f&&(f=1),null==g&&(g=1),null==h&&(h=111),k=this.$q.defer(),l=a||[],j=this._createInnerPageConstraints(f,g,h,a),o=this.currentProject.product.lastPage().surfaceNumber+1,n=this.productRequestBuilder.buildInnerPageRequest({images:l,styleId:b,binding:e,constraints:j,config:this.config,coverSpecId:d,stockCoverSpecId:i,density:f,startingPageNumber:o}),m=this.logger.asyncMetric("createInnerPages",n.url),this.$http(n).success(function(a,b,c,d){return m.success(),k.resolve(a)}).error(function(a){return function(b,c,d,e){return a.docsmithAPI.logDocsmithError({url:n.url,data:b,status:c,headers:d}),m.failure({status:c,response:b}),k.reject(new Error("Could not get innerPages"))}}(this)),k.promise},a.prototype._createInnerPageConstraints=function(a,b,c,d){var e;return e={GroupCountConstraint:{min:b,max:c},LinearDensityConstraint:{densityPoints:[[1e3,a]]},ImageCountConstraint:{fallback:"fallback_no_assignment"}},(null!=d?d.length:void 0)>0?e.ImageCountConstraint.match="equal_or_greater_match":(e.ImageCountConstraint.match="exact_match",e.TextAreaCountConstraint={rule:"none"}),e},a.prototype._autoSaveErrorsExcessive=function(){return this.autoSaveErrorCounter>this.constructor.MAX_SAVE_FAILURE_LOGS},a.prototype.save=function(a,b){var c,d,e,f,g,h;return null==b&&(b=""),this.eventBus.publishSync(this.eventBus.events.PROJECT_SAVING_IN_PROGRESS),c=this.$q.defer(),h=this.projectClient.getUpdateProjectEndpoint(a.id,this.currentProject.projectGUID,a.oAuthToken),d=this.logger.asyncMetric("saveProject"+b,h),this.projectValidator.validate(this.currentProject,{event:"ProjectService save",intensity:"thorough"}),this._validationErrorsAddressed(d,c)?c.promise:this.config.features.saveErrorGuard===!0&&this._hasUnrecoverableErrors(d,c)?c.promise:(this.productModelStrategy.clean(this.currentProject),this._convertBookStartTime(),this.reportingDataCalculator.calculate(this.currentProject),this.upsellReportingService.recordRemovedFeatures(),g=this.productModelStrategy.wrapProject(this.currentProject.values),f=function(a){return function(b){return a.lastModifiedTime=b.lastModified,a.autoSaveErrorCounter=0,d.success(a._calculateSaveMetricData()),c.resolve()}}(this),e=function(a){return function(e){var f,g,h,i;return f=e.data,i=e.status,g=e.headers,null!=f&&(h=f.indexOf("Caused"),h!==-1&&(f=f.substring(h))),a._autoSaveErrorsExcessive()||d.failure({status:i,response:f}),a._rejectSave(c,f,i,g,b)}}(this),this.projectClient.updateProject(a.id,a.oAuthToken,g,a.apigeeToken).then(f,e),c.promise)},a.prototype._validationErrorsAddressed=function(a,b){var c,d;return c=this.actionableValidationErrors(),(null!=c?c.length:void 0)>0&&(this.actOnValidationErrors(c),a.failure({status:"Validation failed",error:null!=(d=c[0])?d.message:void 0}),b.reject({validationErrors:c}),!0)},a.prototype._hasUnrecoverableErrors=function(a,b){return 0!==this.projectValidator.existingErrors.length&&(a.failure({status:"Unrecoverable errors from validator"}),b.reject({unrecoverableErrors:this.projectValidator.existingErrors}),!0)},a.prototype.saveNew=function(a,b){var c,d,e,f,g,h;return null==b&&(b=""),this.eventBus.publishSync(this.eventBus.events.PROJECT_SAVING_IN_PROGRESS),c=this.$q.defer(),h=this.projectClient.getCreateProjectEndpoint(a.id,a.oAuthToken),d=this.logger.asyncMetric("saveNewProject"+b,h),this.projectValidator.validate(this.currentProject,{event:"ProjectService saveNew",intensity:"thorough"}),this._validationErrorsAddressed(d,c)?c.promise:this.config.features.saveErrorGuard===!0&&this._hasUnrecoverableErrors(d,c)?c.promise:(this.productModelStrategy.clean(this.currentProject),this._convertBookStartTime(),this.reportingDataCalculator.calculate(this.currentProject),this.upsellReportingService.recordRemovedFeatures(),g=this.productModelStrategy.wrapProject(this.currentProject.values),f=function(a){return function(b){var e;return e=null==a.currentProject.projectGUID,g=a.productModelStrategy.unwrapProject(b.data),a.lastModifiedTime=b.lastModified,a.currentProject.projectGUID=g.projectGUID,a.currentProject.product.guid=a.productModelStrategy.getProductGUID(g),a.currentProject.userId=g.userId,a.autoSaveErrorCounter=0,d.success(a._calculateSaveMetricData(e)),c.resolve(b)}}(this),e=function(a){return function(b){var e,f;return e=b.data,(f=e.indexOf("Caused"))!==-1&&(e=e.substring(f)),a._autoSaveErrorsExcessive()||d.failure({status:b.status,response:e}),a._rejectSave(c,e,b.status),c.reject()}}(this),this.projectClient.createProject(a.id,a.oAuthToken,g,a.apigeeToken).then(f,e),c.promise)},a.prototype._calculateSaveMetricData=function(a){var b;return null==a&&(a=!1),b={},a&&(b.ttfs=(new Date).getTime()-this.galleon.startTime),null!=this.timeOfLastSave&&(b.tsls=(new Date).getTime()-this.timeOfLastSave),this.timeOfLastSave=(new Date).getTime(),b},a.prototype.actionableValidationErrors=function(){var a,b,c,d,e,f,g,h,i,j,k;for(a={},d=this._actionableErrorTypes(),g=0,i=d.length;g<i;g++)c=d[g],a[""+c]=[];for(k=this.projectValidator.existingErrors,h=0,j=k.length;h<j;h++)b=k[h],Array.isArray(a[b.message])&&a[b.message].push(b);for(e in a)return f=a[e]},a.prototype.actOnValidationErrors=function(a){var b;switch(null!=a&&null!=(b=a[0])?b.message:void 0){case this.projectValidator.constructor.MISSING_IMAGE_OR_DATA:return this._removeOrphanedImageAssignments()}},a.prototype._actionableErrorTypes=function(){return[this.projectValidator.constructor.MISSING_IMAGE_OR_DATA]},a.prototype._removeOrphanedImageAssignments=function(){return this.project.clearOrphanedImageAssignments()},a.prototype._rejectSave=function(a,b,c,d,e){return null==e&&(e=""),this.autoSaveErrorCounter++,this.autoSaveErrorCounter===this.constructor.MAX_SAVE_FAILURE_LOGS+1&&this.logger.critical("Exceeded save error log threshold "+this.constructor.MAX_SAVE_FAILURE_LOGS),this._autoSaveErrorsExcessive()||this.logger.critical("Could not save project: "+b),a.reject(new Error("Could not save project http status:"+c))},a.prototype._convertBookStartTime=function(){var a,b;if(a=this.currentProject.product.bookStartTime,null==a&&(a=(new Date).toString()),this.dateUtil.isISODateTime(a))return b=this.dateUtil.convertISODateTimeToLegacyDate(a),null!=b?this.currentProject.product.bookStartTime=b:this.logger.warn("bookStartTime conversion failure of value: "+a)},a.prototype.validate=function(a){return this.projectValidator.validate(this.currentProject,a)},a.prototype.loadMagicshopProject=function(a,b){var c;return c=this.magicShopService.createProject(a,b),this._createNewProject(c,"DocSmith magicshop creation")},a.prototype.rewriteSubtype=function(a){var b,c,d;if(this.config.richSubtypes&&!this.docsmithAPI.preventSubtypeRewrite(null!=(b=this.currentProject)?b.product:void 0))return null!=(c=this.currentProject)&&null!=(d=c.product)?d.subtype=a?this.docsmithAPI.constructor.SUBTYPE_GSP:this.docsmithAPI.constructor.SUBTYPE_GCP:void 0},a.prototype.hasStickers=function(){var a,b;return a=null!=(b=this.currentProject)?b.product:void 0,null!=a&&null!=a.allSurfaces&&a.allSurfaces.some(function(a){return a.getStickers().length>0})},a.prototype.removeAllStickersFromPage=function(a){var b,c,d,e,f;if(null!=a&&null!=a.layout&&null!=a.layout.assets)for(d=a.layout.assets,e=f=d.length-1;f>=0;e=f+=-1)c=d[e],b=c.asset,b&&"graphic"===b.assetType&&"embellishment"===b.type&&a.removeAssetAtIndex(e)},a.prototype.removeAllStickers=function(){var a,b,c,d,e,f;if(a=null!=(e=this.currentProject)?e.product:void 0,null!=a)for(f=a.allSurfaces,c=0,d=f.length;c<d;c++)b=f[c],this.removeAllStickersFromPage(b),this.eventBus.publish(this.eventBus.events.SURFACE_EMBELLISHMENT_REMOVED,{pageNumber:b.surfaceNumber})},a.prototype.containsSpreadStartingAt=function(a){var b,c,d,e,f;if(null==this.currentProject)return!1;for(f=null!=(e=this.currentProject)?e.product.pages:void 0,c=0,d=f.length;c<d;c++)if(b=f[c],b.surfaceNumber>=a&&"Spread"===b.layout.type)return!0;return!1},a.prototype.getLastModifiedTime=function(){return this.lastModifiedTime},a.prototype._handleSaveTimeUpdate=function(a){return this.lastModifiedTime=a.lastModifiedTime},a}(),a.$inject=["$http","$q","CONFIG","project","eventBus","loggerFactory","contentService","reportingDataCalculator","docsmithAPI","projectValidator","magicShopService","upsellReportingService","dateUtil","productRequestBuilder","globalContentService","productModelStrategy","productEventsInitializer","httpService","deviceDetectionService","galleon","legacyProjectClient","projectClient"],angular.module("galleon").service("projectService",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.http=a,this.q=b,this.productModelStrategy=d,this.serviceHost=""+c.apigeeUrl+"/projects/v1",this.apiKey=""+c.apiKey}return a.prototype.loadProject=function(a,b,c){var d,e,f;return d=this.q.defer(),f=this.getLoadProjectEndpoint(a,b),e=this._projectServiceHeaders(c),this.http({url:f,method:"GET",extendedTimeout:!0,headers:this._projectServiceHeaders(c)}).then(this.createBodyHandler(d),this.createErrorHandler(d)),d.promise},a.prototype.getLoadProjectEndpoint=function(a,b){return""+this.serviceHost+"/users/"+a+"/projects/"+b},a.prototype.createProject=function(a,b,c,d){var e,f,g;return e=this.q.defer(),g=this.getCreateProjectEndpoint(a),f={projectDTO:this.buildDtoForCreate(a,c)},this.http({url:g,method:"POST",extendedTimeout:!0,headers:this._projectServiceHeaders(d),data:f}).then(this.createBodyHandler(e),this.createErrorHandler(e)),e.promise},a.prototype.getCreateProjectEndpoint=function(a,b){return null==b&&(b=null),""+this.serviceHost+"/users/"+a+"/projects"},a.prototype.updateProject=function(a,b,c,d){var e,f,g,h,i;return e=this.q.defer(),h=this.productModelStrategy.unwrapProject(c),i=this.getUpdateProjectEndpoint(a,h.projectGUID),g=this.buildDtoForUpdate(a,c),f=function(a){var b;return b={status:a.status,lastModified:a.data.projectMetadata.updateDate},e.resolve(b)},this.http({url:i,method:"PUT",extendedTimeout:!0,headers:this._projectServiceHeaders(d),data:g}).then(f,this.createErrorHandler(e)),e.promise},a.prototype.getUpdateProjectEndpoint=function(a,b,c){return null==c&&(c=null),""+this.serviceHost+"/users/"+a+"/projects/"+b},a.prototype.patchProject=function(b,c,d,e,f){var g,h,i;return g=this.q.defer(),i=this.getUpdateProjectEndpoint(b,d),h=function(a){var b;return b={status:a.status,lastModified:a.headers("last-modified")},g.resolve(b)},this.http({url:i,method:"PATCH",extendedTimeout:!0,headers:{Accept:"application/json, text/plain, */*","Content-Type":a.DEFAULT_CONTENT_TYPE,"If-Unmodified-Since":f,Authorization:"Bearer "+c,"SFLY-apikey":this.apiKey},data:e}).then(h,this.createErrorHandler(g)),g.promise},a.prototype._projectServiceHeaders=function(b){return{Accept:a.DEFAULT_CONTENT_TYPE,"Content-Type":a.DEFAULT_CONTENT_TYPE,Authorization:"Bearer "+b,"SFLY-apikey":this.apiKey}},a.prototype.createErrorHandler=function(a){return function(b){var c;return a.reject({status:b.status,data:null!=(c=b.data)?c.message:void 0,headers:b.headers()})}},a.prototype.createBodyHandler=function(a){return function(b){var c;return c={status:b.status,lastModified:b.data.projectMetadata.updateDate,data:JSON.parse(b.data.projectDocument.projectBody)},a.resolve(c)}},a.prototype.buildDtoForCreate=function(a,b){var c;return c=this.createProjectDto(a,b),delete c.projectMetadata.guid,c},a.prototype.buildDtoForUpdate=function(a,b){return this.createProjectDto(a,b)},a.prototype.createProjectDto=function(a,b){var c,d,e,f;return e=this.productModelStrategy.unwrapProject(b),d=this.productModelStrategy.unwrapProduct(b),c={projectMetadata:{userId:a,title:e.title,type:e.type,subType:null!=(f=d.subtype)?f:"GCP",projectGroup:"USER",activityState:"ACTIVE",guid:e.projectGUID},projectDocument:{projectBody:JSON.stringify(b)}}},a}(),Object.defineProperty(a,"DEFAULT_CONTENT_TYPE",{value:"application/vnd.shutterfly.projects.matisse.v1+json",writable:!1}),a.$inject=["$http","$q","CONFIG","productModelStrategy"],angular.module("galleon").service("projectClient",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.http=a,this.q=b,this.loadServiceHost=c.projectLoadService,this.saveServiceHost=c.projectSaveService}return a.prototype.loadProject=function(a,b){var c,d;return c=this.q.defer(),d=this.getLoadProjectEndpoint(a,b),this.http({url:d,method:"GET",extendedTimeout:!0}).then(c.resolve,c.reject),c.promise},a.prototype.getLoadProjectEndpoint=function(a,b){return""+this.loadServiceHost+"/"+a+"/photobooks/"+b},a.prototype.createProject=function(a,b,c){var d,e;return d=this.q.defer(),e=this.getCreateProjectEndpoint(a,b),this.http({url:e,method:"POST",extendedTimeout:!0,headers:{Accept:"application/json","Content-Type":"text/plain;charset=UTF-8"},data:c}).then(d.resolve,d.reject),d.promise},a.prototype.getCreateProjectEndpoint=function(a,b){return""+this.saveServiceHost+"/"+a+"/photobooks?access_token="+b},a.prototype.updateProject=function(a,b,c){var d,e;return d=this.q.defer(),e=this.saveServiceHost+("/"+a+"/photobooks?access_token="+b),this.http({url:e,method:"PUT",extendedTimeout:!0,headers:{Accept:"text/plain","Content-Type":"text/plain;charset=UTF-8"},data:c}).then(d.resolve,d.reject),d.promise},a.prototype.getUpdateProjectEndpoint=function(a,b,c){return""+this.saveServiceHost+"/"+a+"/photobooks?access_token="+c},a}(),a.$inject=["$http","$q","CONFIG"],angular.module("galleon").service("legacyProjectClient",a)}.call(this),function(){"use strict";var a,b;b=function(){function b(a,b,c,d,e,f,g){this.docsmithConversionService=b,this.bookOptionsService=c,this.enums=d,this.eventBus=e,this.$modal=f,this.logger=g.newInstance("ProjectUpgradeService"),this.adaptiveLib=a.adaptiveLib,this.eventBus.subscribe(this.eventBus.events.PROJECT_LOADED,function(a){return function(b,c){return a.upgradeProject(c)}}(this)),this.modalInstance=null}return b.prototype.hasUnsupportedFeature=function(b){var c,d,e,f,g;return null!=(null!=b&&null!=(e=b.product)?e.cover:void 0)&&("5x7"===(null!=b&&null!=(f=b.values)&&null!=(g=f.book)?g.bookSizeID:void 0)||(c=b.product.cover.isStockCover?this.adaptiveLib.globalContent.getStockCover(b.product.cover.stockCoverSpecID):this.adaptiveLib.globalContent.getCover(b.product.cover.coverSpecID),d=this._isHiddenFinish(b.product.finish,c),null==c||c.state===a.HIDDEN||d))},b.prototype._isHiddenFinish=function(b,c){var d,e,f,g,h;if(null==c)return!1;if((null!=(g=c.finishes)?g.length:void 0)>0)for(h=c.finishes[0].finish,e=0,f=h.length;e<f;e++)if(d=h[e],d.id===b)return d.state===a.HIDDEN;return!1},b.prototype.upgradeProject=function(a){return!!this.hasUnsupportedFeature(a)&&(this._logUpgrade(a),this._createModalInstance(),this.docsmithConversionService.start(a,this._conversionParamsForProject(a)),!0)},b.prototype._createModalInstance=function(){return this._releaseModalInstance(),this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/upgrade-project-warning.html",controller:"UpgradeProjectWarningCtrl",backdrop:"static",keyboard:!1})},b.prototype._releaseModalInstance=function(){if(null!=this.modalInstance)return this.modalInstance.close(),this.modalInstance=null},b.prototype._conversionParamsForProject=function(a){var b;return a.product.cover.isStockCover?(b=this.bookOptionsService.STOCK_LEATHER_BLACK,{coverType:b.coverType,colorId:b.colorId}):a.product.finish===this.enums.Finish.PADDED?(b=this.bookOptionsService.HARD,{coverType:b.coverType,finish:"none"}):"5x7"===a.values.book.bookSizeID?{bookSize:"7x9",sizeId:"7x9"}:(b=this.bookOptionsService.HARD,{coverType:b.coverType})},b.prototype._logUpgrade=function(a){var b;return b={projectGUID:a.projectGUID,userId:a.userId,styleId:a.product.styleId,coverSpecID:a.product.cover.coverSpecID,stockCoverSpecID:a.product.cover.stockCoverSpecID},this.logger.warn("project upgrade required "+JSON.stringify(b))},b}(),a={ACTIVE:"A",HIDDEN:"H"},b.$inject=["adaptiveLayoutService","docsmithConversionService","bookOptionsService","enums","eventBus","$modal","loggerFactory"],angular.module("galleon").service("projectUpgradeService",b)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h){this.$http=a,this.$q=c,this.config=d,this.md5=e,this.docsmithAPI=g,this.productModelStrategy=h,this._createProjectFromMagicShopTemplate=b(this._createProjectFromMagicShopTemplate,this),this.logger=f.newInstance("MagicShopService")}return a.MATISSE_CALENDAR="MATISSE_CALENDAR",a.PHOTOBOOK_30="PHOTOBOOK_30",a.prototype.createProject=function(b,c){var d,e;return d=this.$q.defer(),e=this._getMagicShopTemplate(b.userId,c),e.then(function(c){return function(e){var f;return f=c._identifyTemplateProductType(e),c._setRequestTemplateProperty(b,e),f===a.PHOTOBOOK_30&&(b.constraints={GroupCountConstraint:{min:c.config.defaults.constraints.GroupCountConstraint.min,max:c.config.defaults.constraints.GroupCountConstraint.max}}),c._createProjectFromMagicShopTemplate(b,f,d)}}(this)),e.catch(function(a){return d.reject(a)}),d.promise},a.prototype._identifyTemplateProductType=function(b){var c;switch(null!=(c=b.info)?c.product:void 0){case a.PHOTOBOOK_30:case a.MATISSE_CALENDAR:return b.info.product;default:return a.PHOTOBOOK_30}},a.prototype._setRequestTemplateProperty=function(a,b){return this.config.magicShopProduct?a.magicShopTemplate=b:a.magicShopBook=b},a.prototype._getMagicShopTemplate=function(a,b){var c,d,e,f,g,h;return d=function(a){return a.magicShopProduct?a.magicShopTemplateService:a.magicshopGetBookService},c=this.$q.defer(),g=this._createSignature(a,b),h=d(this.config)+("userId="+a+"&projectId="+b),h+="&signature="+g,f=this.logger.asyncMetric("getMagicShopBook",h),a&&b?(this.$http({method:"GET",url:h}).success(function(a,b,d,e){return c.resolve(a),f.success()}).error(function(a){return function(b,d,g,h){return f.failure({status:d,response:b}),e="Could not get magicshop template",a.logger.critical(""+e+": "+d+" "+b),c.reject(new Error(e))}}(this)),c.promise):(e="Missing necessary data for fetching magicshop template",c.reject(new Error(e)),this.logger.critical(e),c.promise)},a.prototype._createProjectFromMagicShopTemplate=function(b,c,d){var e,f,g;return g=""+this.config.docsmith.url+"/api/docsmith/"+this.config.docsmith.version+"/from_magicshop",f=this.logger.asyncMetric("createProjectFromMagicShopTemplate",g),e={method:"POST",url:g},c===a.PHOTOBOOK_30?e.data={BookCreationRequest:b}:c===a.MATISSE_CALENDAR&&(e.data={CalendarCreationRequest:b}),this.$http(e).success(function(a){return function(b,c,e,g){return f.success(),d.resolve(a.docsmithAPI.rewriteSubtype(a.productModelStrategy.unwrapProject(b)))}}(this)).error(function(a){return function(b,c,e,h){var i;return a.docsmithAPI.logDocsmithError({url:g,data:b,status:c,headers:e}),f.failure({status:c,response:b}),i="Could not create project from magicshop template",a.logger.critical(""+i+": "+c+" "+b),d.reject(new Error(i))}}(this))},a.prototype._createSignature=function(a,b){var c;return c=a+b+"MagicShopGreatProducts",this.md5.createHash(c)},a}(),a.$inject=["$http","$q","CONFIG","md5","loggerFactory","docsmithAPI","productModelStrategy"],angular.module("galleon").service("magicShopService",a)}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}},c=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};a=function(){function a(a,c,d,e,f){this.assetOrderRepaired=b(this.assetOrderRepaired,this),this.logger=c.newInstance("ProjectValidator"),this.enable=a.features.debug_frequentProjectValidation,this._autofill=d,this._modelAdapter=e,this._mediaPreferenceService=f,this.existingErrors=[]}return a.MISSING_IMAGE_OR_DATA="Placed image not found in projectImages list, or is missing data",a.MALFORMED_BACKPAGE_ASSETID="Back page's assetId doesn't end with '_backcover'",a.NAN_IMAGE_DIMENSIONS="Found NaN dimensions in imageCollection",a.NAN_OFFSET_COORDS="Found NaN coords in asset",a.IMAGEID_NOT_ENCODED="Found unencoded imageIDs in imageCollection",a.BOGUS_CROP_VALUES="Found bad crop values in assigned image",a.SWAPPED_CROP_VALUES="Found swapped upper and lower crop limits in assigned image",a.BACKGROUND_ASSET_NOT_FIRST="Found a background image on page following other non-background assets",a.LOGO_PAGE_MISMATCH="Logo page size does not match product",a.BOGUS_LAYOUT="Found layout not suitable for page",a.BOGUS_TEXT_COLOR="Found invalid text color",a.BAD_LAST_PRODUCT_IMAGE_ID="Found invalid last product image id",a.BAD_USE_COUNT="Bad image use count",a.prototype._runValidationSteps=function(a,b,c){return"thorough"===c.intensity&&(this.checkForLogoPageMismatch(a,b),this.checkForBogusTextColors(a,b),this.checkBackPageAssetId(a,b),this.checkForUnencodedImageIDs(a,b),this.checkForBadLastProductImageID(a,b),this.correlateProjectImages(a,b)),this.checkForBackgroundNotFirstAsset(a,b),this.checkForNaNImageDimensions(a,b),this.checkForNanAssetOffsets(a,b)},a.prototype._validate=function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;for(e=[],this._runValidationSteps(a,e,b),f=function(){var a,b,c;for(c=[],a=0,b=e.length;a<b;a++)d=e[a],c.push(JSON.stringify(d));return c}(),h=function(){var a,b,c,e;for(c=this.existingErrors,e=[],a=0,b=c.length;a<b;a++)d=c[a],e.push(JSON.stringify(d));return e}.call(this),j=0,l=e.length;j<l;j++)d=e[j],n=JSON.stringify(d),c.call(h,n)<0&&(i="New project validation error: "+JSON.stringify(d),null!=b.event&&(i+=". Most recent event: "+JSON.stringify(b.event)),this.logger.warn(i));for(o=this.existingErrors,k=0,m=o.length;k<m;k++)g=o[k],p=JSON.stringify(g),c.call(f,p)<0&&this.logger.info("Project validation error was resolved: "+JSON.stringify(g));return this.existingErrors=e},a.prototype.validate=function(a,b){var c,d,e;if(null==b&&(b={}),e=[],!this.enable)return e;try{d=this.existingErrors.length,e=this._validate(a,b),d<this.existingErrors.length&&(e=this._validate(a,b))}catch(a){c=a,this.logger.warn(c.stack)}return e},a.prototype.pagesAsMap=function(a){var b,c,d,e,f,g;for(d={},null!=(b=a.product.cover)&&(d.frontCover=b.frontPage,d.backCover=b.backPage,d.spinePage=b.spinePage),g=a.product.pages,e=0,f=g.length;e<f;e++)c=g[e],d["inner_"+c.surfaceNumber]=c;
return d},a.prototype.parseImageCollection=function(a){var b,c,d,e,f,g,h,i,j,k,l;return j=function(){var j,m,n,o,p,q,r,s;j=a.imageCollection.projectImages,s=[];for(g in j)i=j[g],f=i.imageId,null==f&&(f=null!=(m=/imageID=(.*?)&/.exec(i.view))?m[1]:void 0),b=null!=(n=i._parsedValues)?n.Xheight:void 0,c=null!=(o=i._parsedValues)?o.Xwidth:void 0,k=null!=(p=i._parsedValues)?p.rotation:void 0,l=null!=(q=i._parsedValues)?q.useCount:void 0,d=null!=(r=i._parsedValues)?r.captureTime:void 0,h=i.productImageID,e=i.data,s.push({imageId:f,Xheight:b,Xwidth:c,rotation:k,productImageID:h,data:e,useCount:l,captureTime:d});return s}()},a.prototype.correlateProjectImages=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;for(n=this.pagesAsMap(a),q={},p={},f={},t=this.parseImageCollection(a),r=0,s=t.length;r<s;r++)o=t[r],q[o.imageId]=o,null!=o.data&&(p[o.imageId]=o.data);for(m in n){l=n[m],u=l.layout.assets;for(d in u)c=u[d],null!=c.imageAssignment&&(null!=c.values&&(c=c.values),i=c.imageAssignment.imageReference,null!=i&&(h=i.id,g=i.data,null==f[h]&&(f[h]=0),f[h]++,null==g&&(g=""),null!=q[h]&&p[h]===g||(b.push({message:this.constructor.MISSING_IMAGE_OR_DATA,imageId:h,data:g,page:m,assetIndex:d,surfaceNumber:l.surfaceNumber}),1!==f[h]||this._imageIdNotEncoded(h)||(j=a.imageCollection.getImageIndex(i.projectImageId),j!==-1&&a.imageCollection.removeImage(j),k=this.imageReferenceToImage(h,i),a.imageCollection.addImageAt(k,a.imageCollection.projectImages.length),q[h]=k,null!=g&&(p[h]=g))),this.checkCrop(c,h,q[h],m,d,b,i),this.scavengeDataFromImageCollection(i,q[h]),null==i.effect&&(this._mediaPreferenceService.vividPics?i.effect="Auto":i.effect="None")))}v=a.imageCollection.projectImages,w=[];for(j in v)o=v[j],h=o.imageId,e=null!=f[h]?f[h]:0,o.useCount!==e?(o.useCount=e,w.push(b.push({message:this.constructor.BAD_USE_COUNT,imageId:h}))):w.push(void 0);return w},a.prototype.checkCrop=function(a,b,c,d,e,f,g){var h,i,j,k,l;if(null!=c&&(i=this.extractCropFromImageAssignment(a.imageAssignment),h=[parseFloat(i.llx),parseFloat(i.lly),parseFloat(i.urx),parseFloat(i.ury)],0!==h.filter(function(a){return a<0||1<a||isNaN(a)}).length&&(f.push({message:this.constructor.BOGUS_CROP_VALUES,imageId:b,page:d,assetIndex:e}),this.fixCrop(a.container.width,a.container.height,c,a.imageAssignment.imageReference),i=this.extractCropFromImageAssignment(a.imageAssignment)),j=!1,parseFloat(i.llx)>parseFloat(i.urx)&&(k=[i.llx,i.urx],i.urx=k[0],i.llx=k[1],j=!0),parseFloat(i.lly)>parseFloat(i.ury)&&(l=[i.lly,i.ury],i.ury=l[0],i.lly=l[1],j=!0),j))return f.push({message:this.constructor.SWAPPED_CROP_VALUES,imageId:b,page:d,assetIndex:e}),this._modelAdapter.applyCrop(g,i)},a.prototype.fixCrop=function(a,b,c,d){var e,f,g,h;return h={llx:0,lly:0,urx:1,ury:1},e={width:a,height:b},f=this._modelAdapter.getImageDimension(c,d.rotation),g=this._autofill.utils.CropUtil.expandCropForArea(f,h,e),this._modelAdapter.applyCrop(d,g)},a.prototype.scavengeDataFromImageCollection=function(a,b){var c,d,e,f,g,h;if(null!=b){for(g=["description","effect","redeye","data","fileName","uploadTime","captureTime","vividPicsImage","shutterPicsImage","renderFarmImage"],h=[],e=0,f=g.length;e<f;e++)d=g[e],null===a[d]?(delete a[d],null!=b[d]?(a[d]=b[d],"uploadTime"===d||"captureTime"===d?(c=Date.parse(a[d]),isNaN(c)?h.push(delete a[d]):h.push(a[d]=new Date(c).toISOString())):h.push(void 0)):h.push(void 0)):h.push(void 0);return h}},a.prototype.imageReferenceToImage=function(a,b){var c,d,e;return c=b.data,void 0!==c&&null!==c||(c=""),e="imageID="+a+"&rotation="+b.rotation,e=e+"&DATA="+c,null!=b.llx&&null!=b.lly&&null!=b.urx&&null!=b.ury&&(e=e+"&cropll="+b.llx+","+b.lly+"&cropur="+b.urx+","+b.ury),null!=b.effect&&(e=e+"&effect="+b.effect),null!=b.description&&(e=e+"&description="+b.description),null!=b.filename&&(e=e+"&filename="+b.filename),null!=b.width&&null!=b.height&&(e=e+"&Xwidth="+b.width+"&Xheight="+b.height),d={productImageID:b.projectImageId,view:e,useCount:1}},a.prototype.extractCropFromImageAssignment=function(a){var b;return b=a.imageReference,{llx:b.llx,lly:b.lly,urx:b.urx,ury:b.ury}},a.prototype.checkForBogusTextColors=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;if(null!=(null!=a&&null!=(n=a.product)?n.allSurfaces:void 0)){o=a.product.allSurfaces;for(f in o)if(e=o[f],null!=e&&null!=(p=e.layout)?p.assets:void 0){q=e.layout.assets;for(c in q)if(i=q[c],null!=(null!=(r=i.values)?r.assetType:void 0)&&"text"===i.values.assetType&&(null!=(s=i.values.text)&&null!=(t=s.TextFlow)?t.p:void 0))for(u=i.values.text.TextFlow.p,j=0,l=u.length;j<l;j++)if(g=u[j],null!=g.spans)for(v=g.spans,k=0,m=v.length;k<m;k++)h=v[k],null!=h.color&&(d=h.color.toUpperCase(),d!==h.color&&b.push({message:this.constructor.BOGUS_TEXT_COLOR,page:f,assetIndex:c}),h.color=d)}}},a.prototype.checkForBackgroundNotFirstAsset=function(a,b){var c,d,e,f;e=a.product.allSurfaces,f=[];for(d in e)c=e[d],f.push(function(){var a;for(a=[];this.assetOrderRepaired(d,c,b););return a}.call(this));return f},a.prototype.assetOrderRepaired=function(a,b,c){var d,e,f,g,h,i;g=0,h=b.layout.assets;for(e in h)if(d=h[e],null!=(null!=(i=d.values)?i.type:void 0)&&"Background"===d.values.type){if(f=parseInt(e,10),g!==f)return c.push({message:this.constructor.BACKGROUND_ASSET_NOT_FIRST,page:a,assetIndex:e}),b.moveAssetAtIndex(f,g),!0;g++}return!1},a.prototype.checkBackPageAssetId=function(a,b){var c,d;if(null!=a.product.cover&&!a.product.cover.isStockCover)return d=a.product.cover.backPage,null!=d.values&&(d=d.values),c=d.layout.template.assetReference.assetId,/(_(idea)?backcover)$/.test(c)?void 0:b.push({message:this.constructor.MALFORMED_BACKPAGE_ASSETID,actualAssetId:c})},a.prototype.checkForBadLastProductImageID=function(a,b){var c,d,e,f,g;for(c=-1,g=a.imageCollection.projectImages,e=0,f=g.length;e<f;e++)d=g[e],c<d.productImageID&&(c=d.productImageID);if(a.imageCollection.lastProductImageID<c)return b.push({message:this.constructor.BAD_LAST_PRODUCT_IMAGE_ID,badValue:a.imageCollection.lastProductImageID}),a.imageCollection.values.lastProductImageID=c},a.prototype.checkForNaNImageDimensions=function(a,b){var c,d,e,f,g;for(f=a.imageCollection.projectImages,g=[],d=0,e=f.length;d<e;d++)c=f[d],c.hasDimensionValue&&(isNaN(c.Xwidth)||isNaN(c.Xheight))&&g.push(b.push({message:this.constructor.NAN_IMAGE_DIMENSIONS,productImageID:c.productImageID}));return g},a.prototype.checkForNanAssetOffsets=function(a,b){var c,d,e,f;for(f=a.product.allSurfaces,d=0,e=f.length;d<e;d++)for(c=f[d];this._findAndRemoveFirstBadEmbellishmentIfAny(c,b););},a.prototype._findAndRemoveFirstBadEmbellishmentIfAny=function(a,b){var c,d,e;e=a.layout.assets;for(d in e)if(c=e[d],"graphic"===c.asset.assetType&&"embellishment"===c.asset.type){if(isNaN(parseFloat(c.asset.imageXOffset)))return this._addOffsetError(a,"imageXOffset",d,a.surfaceNumber,b),a.removeAssetAtIndex(d),!0;if(isNaN(parseFloat(c.asset.imageYOffset)))return this._addOffsetError(a,"imageYOffset",d,a.surfaceNumber,b),a.removeAssetAtIndex(d),!0;if(isNaN(parseFloat(c.asset.containerXOffset)))return this._addOffsetError(a,"containerXOffset",d,a.surfaceNumber,b),a.removeAssetAtIndex(d),!0;if(isNaN(parseFloat(c.asset.containerYOffset)))return this._addOffsetError(a,"containerYOffset",d,a.surfaceNumber,b),a.removeAssetAtIndex(d),!0}return!1},a.prototype._addOffsetError=function(a,b,c,d,e){return e.push({message:this.constructor.NAN_OFFSET_COORDS,key:b,assetIndex:c,surfaceNumber:a.surfaceNumber})},a.prototype.checkForUnencodedImageIDs=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n;for(k=a.product.allSurfaces,g=0,i=k.length;g<i;g++){e=k[g],l=e.layout.assets;for(d in l)c=l[d],null!=c.imageId&&this._imageIdNotEncoded(c.imageId)&&b.push({message:this.constructor.IMAGEID_NOT_ENCODED,imageId:c.imageId,assetIndex:d,surfaceNumber:e.surfaceNumber})}for(m=this.parseImageCollection(a.values),n=[],h=0,j=m.length;h<j;h++)f=m[h],this._imageIdNotEncoded(f.imageId)&&b.push({message:this.constructor.IMAGEID_NOT_ENCODED,productImageID:f.productImageID,imageId:f.imageId});return n},a.prototype._imageIdNotEncoded=function(a){return/^\d+$/.test(a)},a.prototype.checkForLogoPageMismatch=function(a,b){var c,d,e;if(null!=a.product.logoPage)return c=a.product.logoPage.layoutName,d=c.substring(0,c.indexOf("_")),e=a.product.sizeId,d!==e?b.push({message:this.constructor.LOGO_PAGE_MISMATCH,expectedSize:e,actualSize:d}):void 0},a.prototype.checkForUnsuitableLayouts=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n;h=this.pagesAsMap(a),n=[];for(g in h)e=h[g],d=e,(null!=d&&null!=(j=d.values)&&null!=(k=j.layout)&&null!=(l=k.template)&&null!=(m=l.assetReference)?m.assetId:void 0)&&(c=d.values.layout.template.assetReference.assetId,f=d.values.layoutName,i=f.indexOf("_"),c.substring(0,i)!==f.substring(0,i)&&b.push({message:this.constructor.BOGUS_LAYOUT,page:g}));return n},a}(),a.$inject=["CONFIG","loggerFactory","autofill","modelAdapter","mediaPreferenceService"],angular.module("galleon").service("projectValidator",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g,h,i,j){this.$http=a,this.$q=b,this.config=c,this.loggerFactory=d,this.eventBus=e,this.$timeout=f,this.$translate=g,this.$window=h,this.$document=i,this.uploadService=j,this.logger=d.newInstance("InternalProjectService"),this.doc=document}return a.prototype.deleteProjects=function(a,b,c){var d,e;return e=""+this.config.projectSaveService+"/"+c+"/photobooks/delete/"+a+"?access_token="+b,d=this.$q.defer(),this.$http({method:"DELETE",url:e,transformResponse:function(a){return a}}).success(function(a,b,c,e){return d.resolve()}).error(function(a){return function(b,c,e,f){return d.resolve(),a.logger.critical("Could not delete project: "+c)}}(this)),d.promise},a.prototype._loadAndRender=function(a){var b;this.$window.PdfService?(this.$window.PdfService.$http||this.$window.PdfService.init(this.$http,this.$q,this.config,this.loggerFactory,this.eventBus,this.$timeout,this.$translate,this.uploadService),a()):(this.$window.onPdfServiceLoaded=function(b){return function(){return b.pdfService=b.$window.PdfService,b.$window.PdfService.init(b.$http,b.$q,b.config,b.loggerFactory,b.eventBus,b.$timeout,b.$translate,b.uploadService),a()}}(this),b=this.doc.createElement("script"),b.src=""+this.config.cdnServer+"/pb/builds/"+this.$window.galleon.uuid+"/scripts/optional.pdf.app.js",this.doc.body.appendChild(b))},a.prototype.renderBook=function(a,b,c,d){var e;return null==d&&(d="exported"),e=function(e){return function(){return e.$window.PdfService.renderBook(a,b,c,d)}}(this),this._loadAndRender(e)},a.prototype.renderSinglePage=function(a,b,c,d,e,f,g,h){var i;return null==g&&(g=!1),null==h&&(h=!1),i=function(i){return function(){return i.$window.PdfService.renderSinglePage(a,b,c,d,e,f,g,h)}}(this),this._loadAndRender(i)},a.prototype._dismissDialog=function(){return this.$timeout(function(a){return function(){return a.eventBus.publish(a.eventBus.events.MODAL_EXPORT_PDF_DISMISS)}}(this)),this.$timeout(function(a){return function(){return a.eventBus.publish(a.eventBus.events.MODAL_SAVE_JPG_DISMISS)}}(this))},a.prototype.loadSoftRenderPage=function(a,b,c,d,e){var f,g;return null==d&&(d="maximum"),null==e&&(e="144"),f=this.$q.defer(),g=this.loadSDXML(a,b,c),g.then(function(a){return function(b){return a._renderPage(b,f,d,e)}}(this)),g.catch(function(){return f.resolve(null)}),f.promise},a.prototype._renderPage=function(a,b,c,d){var e,f,g;return e=this.config.dsVersion,f=this.config.docsmith.url,g=""+f+"/api/"+e+this.config.arfRenderPageService,g=g.replace("[JPEG_QUALITY]",c),g=g.replace("[IS_TESTING]","true"),g=g.replace("[JPEG_RESOLUTION]",d),this.$http({method:"POST",transformRequest:angular.identity,responseType:"arraybuffer",headers:{"Content-Type":"application/xml",Accept:"*/*"},data:a,url:g}).success(function(a){return function(c,d,e,f){var g,h,i;g=null;try{i=a._stringForArrayBuffer(c),g="data:image/jpeg;base64,"+btoa(i),a.exportInProgress-=1}catch(b){h=b,a.logger.warn("Error decoding render data: ",h)}return b.resolve(g)}}(this)).error(function(a){return function(c,d,e,f){var g;return g="Could not load rendered page: "+d,a.logger.warn(g),b.resolve(null)}}(this))},a.prototype._stringForArrayBuffer=function(a){var b,c,d,e,f;for(d="",b=new Uint8Array(a),e=0,f=b.length;e<f;e++)c=b[e],d+=String.fromCharCode(c);return d},a.prototype.loadSDXML=function(a,b,c){var d,e,f,g;return f=this.$q.defer(),d=this.config.dsVersion,e=this.config.docsmith.url,g=""+e+"/api/"+d+"/sdxml",g+="/user/"+a+"/project/"+b+"/surface/"+c,this.$http({method:"GET",url:g}).success(function(a,b,c,d){return f.resolve(a)}).error(function(a){return function(b,c,d,e){var g;return g="Could not load sdxml: "+c,a.logger.warn(g),f.reject(g)}}(this)),f.promise},a}(),a.$inject=["$http","$q","CONFIG","loggerFactory","eventBus","$timeout","$translate","$window","$document","uploadService"],angular.module("galleon").service("internalProjectService",a)}.call(this),function(){var a;a=function(){function a(a,b,c,d,e){this.deviceData=a,this.config=b,this.uppObjectCollection=d,this.mediaPreferenceService=e,this.magicWiggleForWeb2Print=.019,this.w2pClient=new c.Web2PrintClient({hostname:this.config.web2PrintHost})}return a.prototype.BLANK_GIF="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",a.prototype.wrapsURLForTextAsset=function(a,b,c){return null==b&&(b=null),null==c&&(c="pdf"),(null!=a?a.hasContent():void 0)||(null!=b?b.length:void 0)?a.isDateTextAsset?null:this.w2pClient.getMetadataURLForAsset(a.values,b,c):null},a.prototype.imageURLForTextAsset=function(a){var b;return(null!=a?a.hasContent():void 0)?(b=2,this.w2pClient.getURLForAsset(a.values,b,72*b,"png")):this.BLANK_GIF},a.prototype._textContentForTextAsset=function(a,b){var c,d,e,f,g;if(null!=b)return angular.toJson(b);for(d=[],g=a.lines,e=0,f=g.length;e<f;e++)c=g[e],d.push(c.text);return angular.toJson(d.join("\n"))},a.prototype.imageURLForImageAsset=function(a,b,c){var d,e,f;if(null==c&&(c=!0),null==(null!=a?a.imageId:void 0))return this.BLANK_GIF;if(f=null,"uppTemp"===a.data)a.uppTempURL||(e=this._getScaledImageSize(a,b),a.uppTempURL=this._uppTempURL(a,e)),f=a.uppTempURL;else if("anonymous"===a.data)e=this._getScaledImageSize(a,b),f=c?this._procServCropURL(a,e.width,e.height):this._procServURL(a,e.width,e.height);else{if(a.hasActualFineRotation())return d=this._renderSizeKey(a,1.5*b,c),f=this._mercuryFrcURL(a,d),this._afsServiceURL(a,f,c);d=this._renderSizeKey(a,b,c),f=this._procSimpleURL(a,d,c)}if(!/afs-/i.test(a.effect))return f;switch(this.config.afsMode){case"client":case"off":return f;case"server":return this._afsServiceURL(a,f,c)}},a.prototype.thumbURLForImageAsset=function(a){return null==(null!=a?a.imageId:void 0)?this.BLANK_GIF:"uppTemp"===a.data?this._uppTempURL(a,{width:96,height:96}):this._procSimpleURL(a,"fit96x96",!1)},a.prototype.imageURLForImage=function(a,b){var c;return null==(null!=a?a.imageId:void 0)?this.BLANK_GIF:"uppTemp"===a.data?(c=this._getSizeFromString(b),this._uppTempURL(a,c)):this._procSimpleURL(a.asset,b,!1)},a.prototype._uppTempURL=function(a,b){var c,d,e,f;f=Math.min(this.config.defaults.uppLocalImageSizeLimit.width,b.width),d=Math.min(this.config.defaults.uppLocalImageSizeLimit.height,b.height),e=this.uppObjectCollection.getUppObject(a.imageId);try{return null!=e?e.getThumbnailUrl(f,d):void 0}catch(a){return c=a,this.BLANK_GIF}},a.prototype.imageURLForAnonymousImage=function(a,b,c){return this._procServURL(a,b,c)},a.prototype._procServURL=function(a,b,c){var d,e,f,g,h;return d={llx:0,lly:0,urx:1,ury:1},b=Math.ceil((d.urx-d.llx)*b),c=Math.ceil((d.ury-d.lly)*c),90===a.imageAssignmentRotation||270===a.imageAssignmentRotation?(h=c,e=b):(h=b,e=c),f=Math.floor(a.imageAssignmentRotation/90),g=""+this.config.procServService+"?f=0&g=2.2&cb=16777215&b=1&bw=0&sc=0&si="+a.imageId+"&r="+f+"&cr="+d.llx+","+d.lly+","+d.urx+","+d.ury+"&pa=0&sa=0&p=1&po=1&dsbg=221&ph=65535&px="+h+"&py="+e+"&rx="+h+"&ry="+e+"&ps=23"},a.prototype.imageURLForAnonymousCropImage=function(a,b,c){return this._procServCropURL(a,b,c)},a.prototype._procServCropURL=function(a,b,c){var d,e,f,g,h;return d=this._getCropForRotation(a),b=Math.ceil((d.urx-d.llx)*b),c=Math.ceil((d.ury-d.lly)*c),90===a.imageAssignmentRotation||270===a.imageAssignmentRotation?(h=c,e=b):(h=b,e=c),f=a.imageAssignmentRotation/90,g=""+this.config.procServService+"?f=0&g=2.2&cb=16777215&b=1&bw=0&sc=0&si="+a.imageId+"&r="+f+"&cr="+d.llx+","+d.lly+","+d.urx+","+d.ury+"&pa=0&sa=0&p=1&po=1&dsbg=221&ph=65535&px="+h+"&py="+e+"&rx="+h+"&ry="+e+"&ps=23"},a.prototype._getCropForRotation=function(a){return 90===a.imageAssignmentRotation?{llx:1-a.imageAssignmentUry,lly:a.imageAssignmentLlx,urx:1-a.imageAssignmentLly,ury:a.imageAssignmentUrx}:180===a.imageAssignmentRotation?{llx:1-a.imageAssignmentUrx,lly:1-a.imageAssignmentUry,urx:1-a.imageAssignmentLlx,ury:1-a.imageAssignmentLly}:270===a.imageAssignmentRotation?{llx:a.imageAssignmentLly,lly:1-a.imageAssignmentUrx,urx:a.imageAssignmentUry,ury:1-a.imageAssignmentLlx}:{llx:a.imageAssignmentLlx,lly:a.imageAssignmentLly,urx:a.imageAssignmentUrx,ury:a.imageAssignmentUry}},a.prototype._procSimpleURL=function(a,b,c){var d;return null==c&&(c=!0),d=""+this.config.procSimpleService+"?imageID="+a.imageId+"&rotation="+a.imageAssignmentRotation,c&&(d+="&cropll="+a.imageAssignmentLlx+","+a.imageAssignmentLly+"&cropur="+a.imageAssignmentUrx+","+a.imageAssignmentUry),d+="&rendersize="+b,d=null!=a.data?""+d+"&DATA="+a.data:d,d=/afs-/i.test(a.effect)?this.mediaPreferenceService.vividPics?""+d+"&effect=Auto":""+d+"&effect=None":""+d+"&effect="+a.effect,this._urlWithRedeyeForImageAsset(a,d)},a.prototype._mercuryFrcURL=function(a,b){return""+this.config.procSimpleService+"?imageID="+a.imageId+"&effect="+a.effect+"&"+("DATA="+a.data+"&rendersize="+b)},a.prototype._afsServiceURL=function(a,b,c){var d;return null==c&&(c=!0),b=this._urlWithRedeyeForImageAsset(a,b),d=encodeURIComponent(angular.toJson(this._afsFilter(a,b,c))),""+this.config.afsService+"/process?string="+d},a.prototype._urlWithRedeyeForImageAsset=function(a,b){return null!=a.redeye&&a.redeye.length>0?""+b+"&redeye="+a.redeye:b},a.prototype._renderSizeKey=function(a,b,c){var d,e,f,g,h,i,j,k,l,m;return d=1,e=1,c||(d=a.imageAssignmentUrx-a.imageAssignmentLlx),c||(e=a.imageAssignmentUry-a.imageAssignmentLly),h=a.asset.containerWidth,g=a.asset.containerHeight,j=this.deviceData.pixelRatio(),m=(null!=h?h:0)*b/d,f=(null!=g?g:0)*b/e,i=m>f?m:f,l=i*j,k=this._renderSizeForScale(l)},a.prototype._renderSizeForScale=function(a){return a<96?"fit96x96":a<200?"fit200x200":a<350?"fit350x350":a<540?"fit540x540":a<700?"fit700x700":a<800?"fit800x800":a<1e3?"fit1000x1000":a<1600?"fit1600x1600":a<2e3?"fit2000x2000":a<2600?"fit2600x2600":a<3e3?"fit3000x3000":a>=3e3?"fit3600x3600":"fit96x96"},a.prototype._afsFilter=function(a,b,c){var d,e,f,g,h;if(d={apiversion:"1.0",appid:"silver",fx:[],highPriorityFlag:!0,img:""+b,response_format:"binary"},null!=a.effectsAsCollection)for(h=a.effectsAsCollection,f=0,g=h.length;f<g;f++)e=h[f],d.fx.push(this._toAfsEffect(e,a,c));return d},a.prototype._toAfsEffect=function(a,b,c){return"AFS-MercuryFRC"===a?{id:"MercuryFRC",meta:{rotatecrop:""+b.rotateCropAFSString(c)}}:{id:a.split("AFS-")[1]}},a.prototype._getSizeFromString=function(a){var b;return b=a.replace("fit","").split("x"),{width:parseInt(b[0]),height:parseInt(b[1])}},a.prototype._getScaledImageSize=function(a,b){var c,d,e,f;return f=Math.max(a.asset.containerHeight/a.imageAssignmentHeight,a.asset.containerWidth/a.imageAssignmentWidth),d=a.imageAssignmentWidth*f,c=a.imageAssignmentHeight*f,e=this.deviceData.pixelRatio(),{width:(null!=d?d:0)*b*e,height:(null!=c?c:0)*b*e}},a.prototype.getParameterByName=function(a,b){var c,d;return a?(a=a.replace(/[\[\]]/g,"\\$&"),c=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)","i"),d=c.exec(b),d?d[2]?decodeURIComponent(d[2].replace(/\+/g," ")):"":null):null},a.prototype.stripURLServicePath=function(a){return a?a.replace(/^[^\?]*\?/g,""):null},a.prototype.getEventImageURL=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;if(!a)return null;if(g=a.view_efx.encodedMspPath,null==g)throw new Error("imageID must be defined");if(null==a.thumbnail)throw new Error("thumbnail must be defined");return h=this.getParameterByName("rotation",a.thumbnail)||0,c=this.getParameterByName("cropll",a.thumbnail)||"0,0",d=this.getParameterByName("cropur",a.thumbnail)||"1,1",i=a.title||"",e=this.getParameterByName("DATA",a.thumbnail),k=(null!=(l=a.image_def)?l.primary_width:void 0)||0,f=(null!=(m=a.image_def)?m.primary_height:void 0)||0,b=a.instime||"",j=a.updtime||"","imageID="+g+"&rotation="+h+"&cropll="+c+"&cropur="+d+"&effect=AUTO&filename="+i+"&title="+i+"&DATA="+e+"&Xwidth="+k+"&Xheight="+f+"&captureTime="+b+"&uploadTime="+j},a}(),a.$inject=["deviceData","CONFIG","autofill","uppObjectCollection","mediaPreferenceService"],angular.module("galleon").service("imageURLService",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h){this.$rootScope=a,this.eventBus=c,this.projectService=d,this.commandFactory=e,this.navService=f,this.deviceDetectionService=g,this.config=h,this._broadcastEvent=b(this._broadcastEvent,this),this.canUndo=!1,this.canRedo=!1,this._executeStack=[],this._undoneStack=[],this.bookIsDirty=!1,this.maxLength=this.config.defaults.undoLimitLength}return a.prototype.execute=function(a,b){var c,d;return this.projectService.validate({event:"preparing to call "+a+".execute",intensity:"partial"}),c=this.commandFactory.getInstance(a,b),c.stage="execute",c.execute(this.commandFactory.getCommandTarget(c),b),c.hasSequel=b.hasSequel,c.hasAntecedent=b.hasAntecedent,c.selectedPageAfter&&this.navService.setSelectedPage(c.selectedPageAfter,!1),(null==c.canUndo||c.canUndo)&&(this._executeStack.length>=this.maxLength&&this._executeStack.shift(),this._executeStack.push(c)),this._undoneStack=[],this._updateCanValues(),"function"==typeof(d=this.projectService).validate&&d.validate({event:a+".execute",intensity:"partial"}),this._broadcastEvent(c,"execute",c.activePageNumber)},a.prototype.undo=function(){var a,b;if(a=this._executeStack.pop(),null!=a)return a.stage="undo",this.projectService.validate({event:"preparing to call "+a.name+".reverse",intensity:"partial"}),a.reverse(this.commandFactory.getCommandTarget(a),a.options),a.selectedPageAfter&&this.navService.setSelectedPage(a.selectedPageAfter,!1),b=a.beforeCommandPageNumber||a.activePageNumber,(null==a.canRedo||a.canRedo)&&this._undoneStack.push(a),this._updateCanValues(),this.projectService.validate({event:a.name+".reverse",intensity:"partial"}),this.projectService.actOnValidationErrors(this.projectService.actionableValidationErrors()),this._broadcastEvent(a,"undo",b)},a.prototype.redo=function(){var a;if(a=this._undoneStack.pop(),null!=a)return a.stage="redo",this.projectService.validate({event:"preparing to redo "+a.name,intensity:"partial"}),a.execute(this.commandFactory.getCommandTarget(a),a.options),a.selectedPageAfter&&this.navService.setSelectedPage(a.selectedPageAfter,!1),this._executeStack.push(a),this._updateCanValues(),this._broadcastEvent(a,"redo",a.activePageNumber),this.projectService.validate({event:"CommandService.redo for command: "+a.name,intensity:"partial"}),this.projectService.actOnValidationErrors(this.projectService.actionableValidationErrors())},a.prototype.willBeLongUndoOperation=function(){var a;return this.canUndo!==!1&&(a=this._executeStack[this._executeStack.length-1],this._isLongOperation(a))},a.prototype.willBeLongRedoOperation=function(){var a;return this.canRedo!==!1&&(a=this._undoneStack[this._undoneStack.length-1],this._isLongOperation(a))},a.prototype._isLongOperation=function(a){return(null!=a?a.isLongOperation:void 0)===!0},a.prototype._updateCanValues=function(){var a;return a=this.deviceDetectionService.isDeviceATablet(),this.canUndo=a?this._executeStack.length>1:this._executeStack.length>0,this.canRedo=this._undoneStack.length>0,this.canUndo?this.bookIsDirty=!0:this.bookIsDirty=!1},a.prototype.setBookIsClean=function(){return this.bookIsDirty=!1},a.prototype._broadcastEvent=function(a,b,c){switch(this.eventBus.publish(this.eventBus.events.COMMAND_EXECUTED,{commandName:a.name,executionType:b,canUndo:this.canUndo,canRedo:this.canRedo,activePageNumber:c}),a.type){case"page":return this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED,{pageNumber:a.activePageNumber});case"book":return this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.projectService.currentProject),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED)}},a}(),a.$inject=["$rootScope","eventBus","projectService","commandFactory","navService","deviceDetectionService","CONFIG"],angular.module("galleon").service("commandService",a)}.call(this),function(){"use strict";var a;a=function(){function a(){}return a.prototype.prepareApplyEmbellishmentCommand=function(){return null},a.prototype.prepareApplyNewWellCommand=function(){return null},a.prototype.prepareApplyTextAreaCommand=function(){return null},a}(),angular.module("galleon").service("customizeService",a)}.call(this),function(){"use strict";var a,b;a=function(){function a(){this.pointSizes_5x7=b.create(.5,2,4),this.pointSizes_7x9=b.create(1,3,7),this.pointSizes_8x8=b.create(1,3,7),this.pointSizes_10x10=b.create(2,5,10),this.pointSizes_8x11=b.create(2,5,10),this.pointSizes_12x12=b.create(2,5,10),this.pointSizes_11x14=b.create(2,5,10)}return a.prototype.getPointSize=function(a,b){return/5x7/.test(a)?this.pointSizes_5x7[b]:/7x9/.test(a)?this.pointSizes_7x9[b]:/8x8/.test(a)?this.pointSizes_8x8[b]:/10x10/.test(a)?this.pointSizes_10x10[b]:/8x11/.test(a)?this.pointSizes_8x11[b]:/11x14/.test(a)?this.pointSizes_11x14[b]:/12x12/.test(a)?this.pointSizes_12x12[b]:this.pointSizes_10x10.medium},a}(),a.$inject=[],angular.module("galleon").service("framePointSizeService",a),b=function(){function a(){}return a.create=function(a,b,c){return{fine:a,medium:b,heavy:c}},a}()}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.$injector=a,this.projectService=b,this.navService=c}return a.prototype.getInstance=function(a,b){var c,d;if(c=this.$injector.get(a),d=this.$injector.instantiate(c),null==d.type)throw new Error("type property must be defined on command");switch(d.type){case"page":return this.initPageCommand(d,b);case"book":return this.initBookCommand(d,b);case"custom":return this.initCustomCommand(d,b);default:throw new Error("type "+d.type+" is unsupported")}},a.prototype.getCommandTarget=function(a){var b;switch(a.type){case"page":return b=a.options.pageNumber,angular.isArray(b)?b.map(function(a){return function(b){return a.projectService.currentProject.product.pageBySurfaceNumber(b)}}(this)):this.projectService.currentProject.product.pageBySurfaceNumber(b);case"book":return this.projectService.currentProject.product;default:return null}},a.prototype.initPageCommand=function(a,b){var c;return a.options=b,c=this.getCommandTarget(a),a.activePageNumber=c.surfaceNumber,a.selectedPageBefore=this.navService.selectedPage,a.selectedPageAfter=angular.isArray(c)?c[c.length-1]:c,a.serialized=angular.isArray(c)?c.map(function(a){return angular.toJson(a.values)}):angular.toJson(c.values),null==a.reverse&&(a.reverse=function(b){return function(c,d){var e,f,g,h;if(angular.isArray(c))for(e=g=0,h=c.length;g<h;e=++g)f=c[e],b.projectService.currentProject.product.applyPageValuesObj(f.surfaceNumber,angular.fromJson(a.serialized[e]));else b.projectService.currentProject.product.applyPageValuesObj(c.surfaceNumber,angular.fromJson(a.serialized));if(a.afterReverse)return a.afterReverse(c)}}(this)),a},a.prototype.initBookCommand=function(a,b){var c,d;return d=this.$injector.get("book"),a.options=b,a.activePageNumber=b.activePageNumber,a.beforeCommandPageNumber=b.beforeCommandPageNumber,c=this.getCommandTarget(a),a.serialized=angular.toJson(c.values),null==a.reverse&&(a.reverse=function(b){return function(c,e){var f;if(f=b.projectService.currentProject.product.guid,b.projectService.currentProject.product=d.init(angular.fromJson(a.serialized)),b.projectService.currentProject.product.guid=f,a.afterReverse)return a.afterReverse(b.projectService.currentProject.product)}}(this)),a},a.prototype.initCustomCommand=function(a,b){return a.options=b,a.activePageNumber=b.activePageNumber,a.beforeCommandPageNumber=b.beforeCommandPageNumber,a.rememberActionPage&&(a.selectedPageAfter=this.projectService.currentProject.product.pageBySurfaceNumber(b.activePageNumber)),a},a}(),a.$inject=["$injector","projectService","navService"],angular.module("galleon").service("commandFactory",a)}.call(this),function(){var a;a=function(){function a(){}return a.prototype.sizeForPageAndSize=function(a,b){var c,d,e;if(null!=a&&null!=b)return d=a.layout.height/a.layout.width,c=b.height,e=b.width,b.height/b.width<d||a.isSpine()?e=c/d:c=e*d,{width:e,height:c}},a}(),angular.module("galleon").service("pageResizer",a)}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}},c=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};a=function(){function a(a,c,d){this.dropProxyHelper=a,this.deviceDetectionService=c,this.appState=d,this.classForAsset=b(this.classForAsset,this),this.styleForSoftRender=b(this.styleForSoftRender,this),this.styleForStockCover=b(this.styleForStockCover,this)}return a.prototype.styleForCanvasPage=function(a,b){var c,d,e,f,g,h,i,j,k,l;if(null!=a&&null!=b)return l=this._bleedValuesForPage(a,b),f=l[0],e=l[1],c=l[2],d=l[3],j=a.layout.width*b,i=a.layout.height*b,h=j+(e+d),g=i+(f+c),k={overflow:"hidden",position:"absolute",width:""+j+"px",height:""+i+"px",clip:"rect(-"+f+"px, "+h+"px, "+g+"px, -"+d+"px)"},a.isStockCover||(k["-webkit-box-shadow"]="1px 1px 9px rgba(0, 0, 0, 0.5)"),k},a.prototype.styleForPage=function(a,b){var c,d,e,f,g,h,i,j,k;return k=this._bleedValuesForPage(a),f=k[0],e=k[1],c=k[2],d=k[3],h=a.layout.width+(e+d),a.isSpine()&&(h+=2),i=a.layout.width,g=a.layout.height+(f+c),j={"background-color":"white",position:"absolute",width:""+i+"px",height:""+a.layout.height+"px",overflow:"hidden",clip:"rect(-"+f+"px, "+h+"px, "+g+"px, -"+d+"px)","-webkit-transform":"scale("+b+")","-moz-transform":"scale("+b+")","-o-transform":"scale("+b+")","-ms-transform":"scale("+b+")",transform:"scale("+b+")","-moz-transform-origin":"0% 0%","-webkit-transform-origin":"0% 0%","-ms-transform-origin":"0% 0%","transform-origin":"0% 0%"},a.isStockCover||(j["-webkit-box-shadow"]="1px 1px 9px rgba(0, 0, 0, 0.5)"),j},a.prototype.styleForBinder=function(a,b){var c,d,e,f,g,h;return d=40,c=5,f=-1*(d*b+c),g=36*b,e=a.layout.width,h={position:"absolute",overflow:"hidden","margin-top":""+f+"px",padding:"0 "+g+"px",width:""+e+"px",background:"transparent","-webkit-transform":"scale("+b+")","-moz-transform":"scale("+b+")","-o-transform":"scale("+b+")","-ms-transform":"scale("+b+")",transform:"scale("+b+")","-moz-transform-origin":"0% 0%","-webkit-transform-origin":"0% 0%","-ms-transform-origin":"0% 0%","transform-origin":"0% 0%"}},a.prototype.styleForBinderRing=function(a,b){var c,d,e;return c=36*b,e=a.layout.width-2*c,d={width:""+e+"px"}},a.prototype.styleForBarcodeContainer=function(a,b){var c,d,e,f,g,h;return e=5,d=91,c=55,g=(d-d*b)*-1,f=(c-c*b-e*b)*-1,h={position:"absolute",width:""+d+"px",height:""+c+"px",bottom:""+f+"px",right:""+g+"px",overflow:"hidden","-webkit-transform":"scale("+b+")","-moz-transform":"scale("+b+")","-o-transform":"scale("+b+")","-ms-transform":"scale("+b+")",transform:"scale("+b+")","-moz-transform-origin":"0% 0%","-webkit-transform-origin":"0% 0%","-ms-transform-origin":"0% 0%","transform-origin":"0% 0%","background-color":"white"}},a.prototype.styleForStockCover=function(a){var b,c,d,e,f,g;return g=this._bleedValuesForPage(a),e=g[0],d=g[1],b=g[2],c=g[3],f={position:"absolute",top:"-"+e+"px",left:"-"+c+"px",width:""+(a.layout.width+(d+c))+"px",height:""+(a.layout.height+(e+b))+"px"}},a.prototype.styleForSoftRender=function(a,b){var c,d,e,f,g,h;if(null!=a)return h=this._bleedValuesForPage(a),
f=h[0],e=h[1],c=h[2],d=h[3],g={opacity:b,position:"absolute",top:"-"+f+"px",left:"-"+d+"px",width:""+(a.layout.width+(e+d))+"px",height:""+(a.layout.height+(f+c))+"px"}},a.prototype._bleedValuesForPage=function(a,b){var c,d;return null==b&&(b=1),d=(null!=a?a.isEven():void 0)&&!(null!=a?a.isCover():void 0)?null!=a?a.layout.bleedInside:void 0:null!=a?a.layout.bleedOutside:void 0,c=(null!=a?a.isEven():void 0)&&!(null!=a?a.isCover():void 0)?null!=a?a.layout.bleedOutside:void 0:null!=a?a.layout.bleedInside:void 0,[(null!=a?a.layout.bleedTop:void 0)*b,d*b,(null!=a?a.layout.bleedBottom:void 0)*b,c*b]},a.prototype.classForAsset=function(a,b){var d;return d=[""+a.asset.assetType+"-asset"],c.call(this.appState.backgroundsWaitingForPicture,a)>=0?"empty-asset photoAsBackground-asset":("image"===a.asset.assetType||"virtual-image"===a.asset.assetType?(a.hasAssignedImage()?d.push(""+a.filterEffect):d.push("empty-asset"),b&&this.dropProxyHelper.canAssetServeAsDropProxy(a,b)&&d.push("image-proxy-class--"+a.uniqueProjectRef)):"text"!==a.asset.assetType||a.hasContent()||d.push("empty-asset"),a.canRemove&&d.push("removeable-asset"),d.join(" "))},a.prototype.styleForWarning=function(a){var b,c,d;return b=a.verticalScale<0?" scale(1, -1)":"",c={left:""+a.xOffset+"px",top:""+a.yOffset+"px","margin-top":"0","margin-left":"0"},0!==a.rotation&&(d="rotate("+a.rotation+"deg)"+b,c["-moz-transform-origin"]="0% 0%",c["-webkit-transform-origin"]="0% 0%",c["-ms-transform-origin"]="0% 0%",c["transform-origin"]="0% 0%",c["-moz-transform"]=d,c["-webkit-transform"]=d,c["-ms-transform"]=d,c.transform=d),c},a.prototype.styleForAsset=function(a){var b,c,d,e,f,g;return d=a.borderStroke/2,c=a.width+a.borderStroke,b=a.height+a.borderStroke,e=a.verticalScale<0?" scale(1, -1)":"",g=0!==a.rotation?"rotate("+a.rotation+"deg)"+e:""+e,f={position:"absolute",left:""+a.xOffset+"px",top:""+a.yOffset+"px",width:""+a.width+"px",height:""+a.height+"px",clip:"rect(-"+d+"px, "+c+"px, "+b+"px, -"+d+"px)"},""!==g&&(f["-moz-transform-origin"]="0% 0%",f["-webkit-transform-origin"]="0% 0%",f["-ms-transform-origin"]="0% 0%",f["transform-origin"]="0% 0%",f["-moz-transform"]=g,f["-webkit-transform"]=g,f["-ms-transform"]=g,f.transform=g),f},a.prototype.styleForAssetArea=function(a){var b,c,d,e,f,g;return d=a.borderStroke/2,c=a.width+a.borderStroke,b=a.height+a.borderStroke,e=a.verticalScale<0?" scale(1, -1)":"",f={position:"absolute",left:""+a.xOffset+"px",top:""+a.yOffset+"px",width:""+a.width+"px",height:""+a.height+"px"},0!==a.rotation&&(g="rotate("+a.rotation+"deg)"+e,f["-moz-transform-origin"]="0% 0%",f["-webkit-transform-origin"]="0% 0%",f["-ms-transform-origin"]="0% 0%",f["transform-origin"]="0% 0%",f["-moz-transform"]=g,f["-webkit-transform"]=g,f["-ms-transform"]=g,f.transform=g),f},a.prototype.styleForImageAssetWrapper=function(a){var b,c;return b=a.asset.borderStroke/2,c={top:"-"+b+"px",left:"-"+b+"px",right:"-"+b+"px",bottom:"-"+b+"px",position:"absolute"},null!=a.imageAssignment&&(c["background-color"]="#"+a.asset.borderColorRGB),c},a.prototype.styleForImageAsset=function(a){var b,c,d,e,f,g,h,i,j,k,l;return e=a.asset.borderStroke/2,"uppTemp"===a.data?(c=a.imageAssignmentWidth*(a.imageAssignmentUrx-a.imageAssignmentLlx),h=c/a.asset.containerWidth,g=a.imageAssignmentWidth*a.imageAssignmentLlx/h,i=a.imageAssignmentWidth*a.imageAssignmentUrx/h,k=(a.imageAssignmentHeight-a.imageAssignmentHeight*a.imageAssignmentUry)/h,b=(a.imageAssignmentHeight-a.imageAssignmentHeight*a.imageAssignmentLly)/h,j={position:"absolute",top:""+(e-k)+"px",left:""+(e-g)+"px",width:""+(a.imageAssignmentWidth/h-e)+"px",height:""+(a.imageAssignmentHeight/h-e)+"px"},"frame_none"!==a.asset.objectStyle&&(j.clip="rect("+(k+e)+"px, "+(i-e)+"px, "+(b-e)+"px, "+(g+e)+"px)")):(l=a.asset.width,f=a.asset.height,b=a.asset.height-e,i=a.asset.width-e,d=a.fadeValue,.5===d&&(d=.3),j={position:"absolute",top:""+e+"px",left:""+e+"px",height:""+f+"px",width:""+l+"px",opacity:""+d,"z-index":"inherit"},"frame_none"!==a.asset.objectStyle&&(j.clip="rect("+e+"px, "+i+"px, "+b+"px, "+e+"px)")),j},a.prototype.styleForTextAsset=function(a){return{"max-width":""+a.asset.width+"px",width:""+a.asset.width+"px",height:""+a.asset.height+"px",display:"table-cell","margin-bottom":""+a.styles.marginBottom+"px","margin-top":""+a.styles.marginTop+"px","baseline-shift":""+a.styles.baselineShift+"px",color:a.styles.color,"font-family":"'"+a.styles.fontFamily+"'","font-size":""+a.styles.fontSize+"px","font-style":a.styles.fontStyle,"font-weight":a.styles.fontWeight,"line-height":(a.styles.lineHeight/a.styles.fontSize).toFixed(1),"text-decoration":a.styles.textDecoration,"text-align":a.styles.textAlign,"vertical-align":a.verticalAlign,"white-space":"nowrap"}},a.prototype.styleForUIElement=function(a,b,c,d){var e,f,g,h;return null!=c&&null!=d&&this.deviceDetectionService.isDeviceATablet()?(e=1/d,f={"-webkit-transform":"scale("+e+", "+e+")","-moz-transform":"scale("+e+", "+e+")","-o-transform":"scale("+e+", "+e+")","-ms-transform":"scale("+e+", "+e+")",transform:"scale("+e+", "+e+")","-moz-transform-origin":"100% 0%","-webkit-transform-origin":"100% 0%","-ms-transform-origin":"100% 0%","transform-origin":"100% 0%"},h=Math.max(0,b.asset.yOffset*-1),f.top=""+(c.top/d+h)+"px",g=Math.max(0,b.asset.xOffset+b.asset.width-a.layout.width),f.right=""+(c.right/d+g)+"px",f):{}},a.prototype.styleForPABFade=function(a){return c.call(this.appState.backgroundsWaitingForPicture,a)>=0?{"background-color":"#CCCCCC"}:{"background-color":a.fadeColor,opacity:1-a.fadeValue}},a.prototype.styleForFadeUnderlay=function(a){var b,c,d,e,f,g,h,i;return d=a.asset.borderStroke/2,i=a.asset.width,e=a.asset.height,c=a.asset.height-d,g=a.asset.width-d,b="white",f=1,a.hasAssignedImage()||(b="gray",f=.1),h={top:""+d+"px",left:""+d+"px",height:""+e+"px",width:""+i+"px","background-color":b,position:"absolute","z-index":"inherit",opacity:f},"frame_none"!==a.asset.objectStyle&&(h.clip="rect("+d+"px, "+g+"px, "+c+"px, "+d+"px)"),h},a}(),a.$inject=["dropProxyHelper","deviceDetectionService","appState"],angular.module("galleon").service("pageStyleProvider",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e){this.$q=a,this.$http=b,this.imageURLService=c,this.$timeout=e,this.logger=d.newInstance("Web2PrintService")}return a.prototype.textMetadataForAsset=function(a,b,c){var d,e,f;return null==c&&(c="pdf"),d=this.$q.defer(),e=this.imageURLService.wrapsURLForTextAsset(a,b,c),null==e?(this.$timeout(function(){return d.resolve({wraps:[],overflow:!1,image:null})},0,!1),d.promise):(f=this.logger.asyncMetric("textMetadataForAsset"),this.$http({method:"GET",url:e}).success(function(a,b,c,g){var h,i;return f.success(),i=angular.fromJson(c("Word-Wrap")),h="true"===c("Overflow"),d.resolve({wraps:i,overflow:h,image:e})}).error(function(a,b,c,e){return f.failure({status:b,response:a}),d.reject(new Error("Could not load text wraps with status: "+b))}),d.promise)},a}(),a.$inject=["$q","$http","imageURLService","loggerFactory","$timeout"],angular.module("galleon").service("web2PrintService",a)}.call(this),function(){var a;a=function(){function a(a,c){this.imageCollection=a,this.config=c,this.WARNINGS=b,this.JPEG_DPI=72}var b;return b={lowResolution:{id:"lowRes",message:"SilverApp.editImage.warnings.lowResolution"},textOverflow:{id:"overflow",message:"SilverApp.editText.overflow"},edgeWarning:{id:"edge",message:"SilverApp.editText.edgeWarning"}},a.prototype.findImageErrors=function(a){var b;return b=[],(null!=a?a.hasAssignedImage():void 0)&&this.isLowResolutionImage(a)&&b.push(this.WARNINGS.lowResolution),b},a.prototype.isLowResolutionImage=function(a,b,c){var d,e,f,g,h,i,j;return null!=a&&(d=b||a.asset,e=c||{urx:a.imageAssignmentUrx,ury:a.imageAssignmentUry,llx:a.imageAssignmentLlx,lly:a.imageAssignmentLly},j=this._getCroppedDimens(a,e),g=j[0],f=j[1],!(g<0)&&(h=g*this.JPEG_DPI/d.containerWidth,i=f*this.JPEG_DPI/d.containerHeight,Math.min(h,i)<this.config.defaults.minimumImageDPI))},a.prototype._getCroppedDimens=function(a,b){var c,d,e,f,g,h,i;return e=this.imageCollection.getImageByProductImageId(a.projectImageId),null==e?[-1,-1]:(h=Math.abs(e.rotation+a.imageAssignmentRotation)%360,i=this._getDisplayDimens(e,h),g=i[0],f=i[1],d=g*(b.urx-b.llx),c=f*(b.ury-b.lly),[d,c])},a.prototype.calculateBoundingRectangle=function(a,b,c,d,e){var f,g,h,i,j,k,l;return e=e||0,f=e*Math.PI/180,l=f+Math.atan2(d,c),k=Math.sqrt(Math.pow(c/2,2)+Math.pow(d/2,2)),h=a+k*Math.cos(l),i=b+k*Math.sin(l),j=c*Math.abs(Math.cos(f))+d*Math.abs(Math.sin(f)),g=d*Math.abs(Math.cos(f))+c*Math.abs(Math.sin(f)),{left:h-j/2,top:i-g/2,width:j,height:g}},a.prototype.calculateBoundingRectangleInGroup=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q;return e=e||0,h=h||0,n=h*Math.PI/180,i=e*Math.PI/180,p=n+Math.atan2(b,a),o=Math.sqrt(Math.pow(a,2)+Math.pow(b,2)),k=f+o*Math.cos(p),l=g+o*Math.sin(p),q=n+i,m=c*Math.abs(Math.cos(q))+d*Math.abs(Math.sin(q)),j=d*Math.abs(Math.cos(q))+c*Math.abs(Math.sin(q)),{left:k-m/2,top:l-j/2,width:m,height:j}},a.prototype.isContainerTooCloseToEdge=function(a,b,c,d){var e;return null==d&&(d=1),e=this.config.defaults.innerMarginPx*d,a.left<e||a.top<e||b-(a.left+a.width)<e||c-(a.top+a.height)<e},a.prototype._isTextTooCloseToEdge=function(a,b){var c;return!!b&&(c=this.calculateBoundingRectangle(a.xOffset,a.yOffset,a.width,a.height,a.rotation),this.isContainerTooCloseToEdge(c,b.layout.width,b.layout.height))},a.prototype._getDisplayDimens=function(a,b){return 90===b||270===b?[a.Xheight,a.Xwidth]:[a.Xwidth,a.Xheight]},a.prototype.findTextErrors=function(a,b){var c;return c=[],(null!=a?a.hasTextOverflow:void 0)&&c.push(this.WARNINGS.textOverflow),(null!=a?a.hasContent():void 0)&&this._isTextTooCloseToEdge(a.asset,b)&&c.push(this.WARNINGS.edgeWarning),c},a.prototype.hasPageErrors=function(a){var b,c,d,e,f,g,h,i;if(null==a)return!1;for(h=a.getImages(),d=0,f=h.length;d<f;d++)if(b=h[d],this.findImageErrors(b).length>0)return!0;for(i=a.getText(),e=0,g=i.length;e<g;e++)if(c=i[e],this.findTextErrors(c,a).length>0)return!0;return!1},a}(),a.$inject=["imageCollection","CONFIG"],angular.module("galleon").service("warningUtil",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.$http=a,this.imageCollection=b,this.$q=c,this.config=d}var b;return b=function(a,b){var c,d,e;for(e=new Uint8Array(a.length),d=0;d<a.length;)e[d]=a.charCodeAt(d),d++;return c=new Blob([e],{type:b})},a.prototype.addImageToCollection=function(a){},a.prototype.save=function(a,c,d){var e,f,g,h,i;return g=this.$q.defer(),e=b(c,"image/jpeg"),f=new FormData,f.append("Image.Data",e),h=this.config.uploadService,i=h+("/"+a+"/images?folderTitle=My Albums&albumName=")+d+"&image.name=test",this.$http({method:"POST",url:i,data:f,headers:{"Content-Type":void 0},transformRequest:function(a){return a}}).success(function(a){return console.log("uploaded image",a),g.resolve()}).error(function(){return console.log("failed to upload image"),g.reject()}),g.promise},a}(),a.$inject=["$http","imageCollection","$q","CONFIG"],angular.module("galleon").service("uploadService",a)}.call(this),function(){var a;a=function(){function a(a){var b,c,d,e,f,g,h;for(this.$sanitize=a,this.supportedChars={},this.compendiumSupportChars={},g=this.constructor.SUPPORTED_CHARS,c=0,e=g.length;c<e;c++)b=g[c],this.supportedChars[b]=!0;for(h=this.constructor.COMPENDIUM_CHARS,d=0,f=h.length;d<f;d++)b=h[d],this.compendiumSupportChars[b]=!0;this.greaterThanRegExp=new RegExp(">","g"),this.lessThanRegExp=new RegExp("<","g"),this.ampersandRegExp=new RegExp("&","g")}return a.SUPPORTED_CHARS="úü¿!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz {|}~¡¢£¤¥¦§¨©ÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖØÙÚÛÜÝÞßàáâãäåæçèéêëìíîïðñòóôõö \n\r",a.COMPENDIUM_CHARS="!\"#$%&'()*+,-./0123456789:;=?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]_`abcdefghijklmnopqrstuvwxyz {|}~¢£¤¨ \n\r",a.prototype.cleanNonPrintableCharactersInContent=function(a,b){var c,d,e,f,g,h;if(null==b&&(b=!1),!((null!=a?a.length:void 0)>0))return[];for(f={},e=a.split("").filter(function(a){return function(c){return null==f[c]&&(f[c]=!0,b?!a.compendiumSupportChars[c]:null==a.supportedChars[c])}}(this)),g=0,h=e.length;g<h;g++)c=e[g],d="\\"===c?new RegExp("\\\\","g"):new RegExp(c,"g"),a=a.replace(d,"");return{invalidCharacters:e,cleanContent:a}},a.prototype.escapeAndSanitizeContent=function(a){return a=a.replace(this.ampersandRegExp,"&amp;"),a=a.replace(this.greaterThanRegExp,"&gt;"),a=a.replace(this.lessThanRegExp,"&lt;"),this.$sanitize(a)},a}(),a.$inject=["$sanitize"],angular.module("galleon").service("projectContentValidator",a)}.call(this),function(){"use strict";var a,b;b=function(){function b(a,b){this.galleon=a,this.deviceDetectionService=b}return b.prototype.calculate=function(b){return b.setReportingValue("appVersionUpdate",""+this.galleon.buildNumber+" "+this.galleon.timeStamp),b.setReportingValue("lastDevice",this.deviceDetectionService.getDeviceType()),b.setReportingValue("subtype",b.product.values.subtype),b.setInitalReportingValue("appVersionCreate",""+this.galleon.buildNumber+" "+this.galleon.timeStamp),b.setInitalReportingValue("pictureSource","lightbox"),b.setInitalReportingValue("albumKey","null"),b.setInitalReportingValue("initialDevice",this.deviceDetectionService.getDeviceType()),this._calculateAssetUsage(b),this._calculateImageCollectionRelatedCounts(b),this._calculatePlacedImageCount(b),this._calculateLatinCharProperty(b),a.calculate(b)},b.prototype._calculatePlacedImageCount=function(a){var b,c,d,e,f,g;for(b={imageIdTable:{},placedImageCount:0,uniquePlacedImageCount:0},g=a.product.pages,e=0,f=g.length;e<f;e++)c=g[e],("undefined"!=typeof d&&null!==d?d.isSpread():void 0)||this._calculatePlacedImageCountForPage(c,b),d=c;return a.product.numTotalImages=b.placedImageCount,a.product.numUniqueImages=b.uniquePlacedImageCount},b.prototype._calculatePlacedImageCountForPage=function(a,b){var c,d,e,f;for(d=a.getImages(),b.placedImageCount+=d.length,e=0,f=d.length;e<f;e++)c=d[e],null==b.imageIdTable[c.imageId]&&b.uniquePlacedImageCount++,b.imageIdTable[c.imageId]=!0;return b},b.prototype._calculateImageCollectionRelatedCounts=function(a){var b,c,d,e,f,g;for(c={LOCAL:0,SFLY_LIGHTBOX:0,FACEBOOK:0,THISLIFE:0,SFLY_SHARE:0,INSTAGRAM:0,FLICKR:0},g=a.imageCollection.projectImages,e=0,f=g.length;e<f;e++)b=g[e],this._calculateStatsForImage(b,c);for(d in c)a.setReportingValue("assignedImageCount-"+d,c[d]);return a.setReportingValue("assignedImageCount-TOTAL",a.imageCollection.projectImages.length)},b.prototype._calculateStatsForImage=function(a,b){if(null!=b[a.Xorigin])return b[a.Xorigin]=b[a.Xorigin]+1},b.prototype._calculateLatinCharProperty=function(a){var b,c,d,e,f,g;for(b=a.product.allSurfaces,c=!1,f=0,g=b.length;f<g;f++){if(d=b[f],!("undefined"!=typeof e&&null!==e?e.isSpread():void 0)&&this._hasLatinChars(d,a)){c=!0;break}e=d}return a.setReportingValue("hasLatin",c.toString())},b.prototype._hasLatinChars=function(a,b){var c,d,e,f;for(f=a.getTextAreas(),d=0,e=f.length;d<e;d++)if(c=f[d],c.hasLatinCharacters())return!0;return!1},b.prototype._calculateAssetUsage=function(a){var b,c,d,e,f,g,h;for(c=a.product.allSurfaces,b={counts:{numStickers:0,numSpreadStickers:0,numIdeaPages:0,numSpreads:0,numSpreadIdeaPages:0,numFrames:0,numUserAddedTextAreas:0,numSpreadUserAddedTextAreas:0,numSunshineEffects:0,numVintageEffects:0,numVibrantEffects:0,numSepiaEffects:0,numMonochromeEffects:0},layoutUsageMap:{},backgroundUsageMap:{},stickerUsageMap:{},frameUsageMap:{}},g=0,h=c.length;g<h;g++)e=c[g],("undefined"!=typeof f&&null!==f?f.isSpread():void 0)||this._calculateAssetUsageForPage(e,b),f=e;for(d in b.counts)a.setReportingValue(d,b.counts[d]);return a.setReportingObject("layoutUsage",this._createAssetUsageReport(b.layoutUsageMap,"layouts")),a.setReportingObject("backgroundUsage",this._createAssetUsageReport(b.backgroundUsageMap,"assets")),a.setReportingObject("stickerUsage",this._createAssetUsageReport(b.stickerUsageMap,"assets")),a.setReportingObject("frameUsage",this._createAssetUsageReport(b.frameUsageMap,"assets"))},b.prototype._calculateAssetUsageForPage=function(a,b){return this._calculateAssetsStatsForPage(a,b.counts),this._calculateLayoutUsageForPage(a,b.layoutUsageMap),this._calculateBackgroundUsageForPage(a,b.backgroundUsageMap),this._calculateStickerUsageForPage(a,b.stickerUsageMap),this._calculateFrameUsageForPage(a,b.frameUsageMap)},b.prototype._calculateAssetsStatsForPage=function(a,b){var c,d,e,f,g,h,i,j;for(this._calculateLayoutStatsForPage(a,b),h=a.layout.assets,j=[],f=0,g=h.length;f<g;f++)e=h[f],c=e.asset,"image"===c.assetType?this._calculateImageAssetStats(c,b):"text"===c.assetType?this._calculateTextAssetStats(c,a,b):"embellishment"===c.type&&this._calculateStickerAssetStats(c,a,b),null!=(d=null!=(i=e.imageAssignment)?i.effect:void 0)?j.push(this._calculateImageEffectsStats(d,b)):j.push(void 0);return j},b.prototype._calculateLayoutStatsForPage=function(a,b){if(a.layout.isSpread()&&b.numSpreads++,a.ideaLayout)return a.layout.isSpread()?b.numSpreadIdeaPages++:b.numIdeaPages++},b.prototype._calculateImageAssetStats=function(a,b){if(a.borderStroke>0)return b.numFrames++},b.prototype._calculateTextAssetStats=function(a,b,c){if("true"===a.values.userAdded||a.values.userAdded)return b.isSpread()?c.numSpreadUserAddedTextAreas++:c.numUserAddedTextAreas++},b.prototype._calculateStickerAssetStats=function(a,b,c){return b.isSpread()?c.numSpreadStickers++:c.numStickers++},b.prototype._calculateImageEffectsStats=function(a,b){switch(a){case"AFS-Sunshine":return b.numSunshineEffects++;case"AFS-Vintage":return b.numVintageEffects++;case"AFS-Vibrant":return b.numVibrantEffects++;case"AFS-Sepia":return b.numSepiaEffects++;case"AFS-BlackWhite":return b.numMonochromeEffects++}},b.prototype._calculateLayoutUsageForPage=function(a,b){var c;if(c=this._incrementPageAssetUsage(b,a.layoutName,a,this._createLayoutUsageEntry),null!=c&&a.customLayout)return c.numCustomized++},b.prototype._createLayoutUsageEntry=function(a){var b;return b={id:a.layoutName,version:a.layoutVersion,numUses:0,ideaPage:!!a.ideaLayout,numCustomized:0}},b.prototype._incrementPageAssetUsage=function(a,b,c,d){var e;return e=null,null!=b&&(e=a[b],null==e&&(a[b]=e=d(c)),null!=e&&e.numUses++),e},b.prototype._calculateBackgroundUsageForPage=function(a,b){var c,d,e,f,g,h,i,j;for(d=a.getBackgrounds(),j=[],g=0,h=d.length;g<h;g++)e=d[g],c=null!=e&&null!=(i=e.asset)?i.assetId:void 0,f=null!=e?e.version:void 0,j.push(this._incrementIndividualAssetUsage(b,c,f,this._createBackgroundUsageEntry));return j},b.prototype._createBackgroundUsageEntry=function(a,b){var c;return c={id:a,version:b,numUses:0}},b.prototype._calculateStickerUsageForPage=function(a,b){var c,d,e,f,g,h;for(f=a.getStickers(),g=0,h=f.length;g<h;g++)c=f[g],d=c.asset.assetId,e=c.version,this._incrementIndividualAssetUsage(b,d,e,this._createStickerUsageEntry)},b.prototype._incrementIndividualAssetUsage=function(a,b,c,d){var e;return e=null,null!=b&&(e=a[b],null==e&&(a[b]=e=d(b,c)),null!=e&&e.numUses++),e},b.prototype._createStickerUsageEntry=function(a,b){var c;return c={id:a,version:b,numUses:0}},b.prototype._calculateFrameUsageForPage=function(a,b){var c,d,e,f,g,h;for(c=a.getFrameAppliedImages(),h=[],f=0,g=c.length;f<g;f++)e=c[f],d=e.asset.objectStyle,h.push(this._incrementIndividualAssetUsage(b,d,1,this._createFrameUsageEntry));return h},b.prototype._createFrameUsageEntry=function(a,b){var c;return c={id:a,version:b,numUses:0}},b.prototype._createAssetUsageReport=function(a,b){var c,d,e,f;f=[];for(c in a)e=a[c],f.push(e);return d={},d[b]=f,d},b}(),b.$inject=["galleon","deviceDetectionService"],angular.module("galleon").service("reportingDataCalculator",b),a={calculate:function(a){return this.calculateStickerUsage(a),this.calculateFrameUsage(a),this.calculateBackgroundUsage(a),this.calculateLayoutUsage(a)},calculateStickerUsage:function(a){var b,c,d,e,f,g;for(d=0,c=0,g=a.stickerUsage.assets,e=0,f=g.length;e<f;e++)b=g[e],this._isExtendedPaletteAsset(a,"sticker",b.id)?d++:this._isExtendedPaletteAsset(a,"patternband",b.id)&&c++;return a.setReportingValue("numExtendedPaletteStickers",d),a.setReportingValue("numExtendedPatternBars",c)},_isExtendedPaletteAsset:function(a,b,c){var d,e,f,g,h,i,j,k;if(null==a.extendedPaletteContent)return!1;for(j=a.extendedPaletteContent.assetListTypes,f=0,h=j.length;f<h;f++)if(e=j[f],e.assetType===b)for(k=e.elements,g=0,i=k.length;g<i;g++)if(d=k[g],d.id===c)return!0;return!1},calculateFrameUsage:function(a){var b,c,d,e,f;for(c=0,f=a.frameUsage.assets,d=0,e=f.length;d<e;d++)b=f[d],this._isExtendedPaletteAsset(a,"frame",b.id)&&c++;return a.setReportingValue("numExtendedPaletteFrames",c)},calculateBackgroundUsage:function(a){var b;return b=this._createExtendedPaletteAssetMap(a,"background"),this._calculateCoverBackgroundUsage(a,b),this._calculateInnerPageBackgroundUsage(a,b)},_createExtendedPaletteAssetMap:function(a,b){var c,d,e,f,g,h,i,j,k;if(c={},null!=a.extendedPaletteContent)for(j=a.extendedPaletteContent.assetListTypes,f=0,h=j.length;f<h;f++)if(e=j[f],e.assetType===b)for(k=e.elements,g=0,i=k.length;g<i;g++)d=k[g],c[d.id]=d.id;return c},_calculateCoverBackgroundUsage:function(a,b){var c,d,e,f;c={numBackgrounds:0},this._incrementBackgroundUsage(null!=(d=a.product.cover)?d.backPage:void 0,b,c),this._incrementBackgroundUsage(null!=(e=a.product.cover)?e.spinePage:void 0,b,c),this._incrementBackgroundUsage(null!=(f=a.product.cover)?f.frontPage:void 0,b,c),a.setReportingValue("numExtendedPaletteCoverBackgrounds",c.numBackgrounds)},_incrementBackgroundUsage:function(a,b,c){var d,e,f,g,h,i,j;if(null!=a){for(h=a.getBackgrounds(),j=[],f=0,g=h.length;f<g;f++)d=h[f],e=null!=(i=d.values.assetReference)?i.assetId:void 0,null!=e&&null!=b[e]?(c.numBackgrounds++,j.push(b[e]=void 0)):j.push(void 0);return j}},_calculateInnerPageBackgroundUsage:function(a,b){var c,d,e,f,g,h;for(c={numBackgrounds:0},h=a.product.pages,f=0,g=h.length;f<g;f++)d=h[f],("undefined"!=typeof e&&null!==e?e.isSpread():void 0)||this._incrementBackgroundUsage(d,b,c),e=d;a.setReportingValue("numExtendedPaletteBackgrounds",c.numBackgrounds)},calculateLayoutUsage:function(a){var b;return b=this._createExtendedPaletteAssetMap(a,"layout"),this._calculateCoverLayoutUsage(a,b),this._calculateInnerPageLayoutUsage(a,b)},_calculateCoverLayoutUsage:function(a,b){var c,d,e,f,g,h,i,j,k;return c=0,e=0,d=0,(null!=(f=a.product.cover)&&null!=(g=f.backPage)?g.ideaLayout:void 0)&&null!=b[a.product.cover.backPage.layoutName]&&(c=1),(null!=(h=a.product.cover)&&null!=(i=h.spinePage)?i.ideaLayout:void 0)&&null!=b[a.product.cover.spinePage.layoutName]&&(e=1),(null!=(j=a.product.cover)&&null!=(k=j.frontPage)?k.ideaLayout:void 0)&&null!=b[a.product.cover.frontPage.layoutName]&&(d=1),a.setReportingValue("numExtendedPaletteIdeaBackPages",c),a.setReportingValue("numExtendedPaletteIdeaSpinePages",e),a.setReportingValue("numExtendedPaletteIdeaFrontPages",d)},_calculateInnerPageLayoutUsage:function(a,b){var c,d,e,f,g,h,i,j,k;for(d=c=f=e=0,k=a.product.pages,i=0,j=k.length;i<j;i++)g=k[i],("undefined"!=typeof h&&null!==h?h.isSpread():void 0)||null!=b[g.layoutName]&&(g.ideaLayout?g.isSpread()?e++:c++:g.isSpread()?f++:d++,b[g.layoutName]=void 0),h=g;a.setReportingValue("numExtendedPaletteLayouts",d),a.setReportingValue("numExtendedPaletteIdeaPages",c),a.setReportingValue("numExtendedPaletteSpreadLayouts",f),a.setReportingValue("numExtendedPaletteSpreadIdeaPages",e)}}}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.pageRenderDataFactory=a,this.pageResizer=b}return a.prototype.resizedDimensions=function(a,b,c){var d,e;return e=this.pageResizer.sizeForPageAndSize(a,{width:b,height:c}),b=e.width,c=e.height,d=e.width/a.layout.width,{width:e.width,height:e.height,assetScale:d}},a.prototype.templateDataWithObjectStyles=function(a,b,c,d){return this._templateData(a,b,c,d,!1)},a.prototype.templateDataWithStringStyles=function(a,b,c,d){return this._templateData(a,b,c,d,!0)},a.prototype._templateData=function(a,b,c,d,e){return null==e&&(e=!0),this.pageRenderDataFactory.newInstance(a,b,c,d,e)},a}(),a.$inject=["pageRenderDataFactory","pageResizer"],angular.module("galleon").service("pageRenderAssistant",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f){this.eventBus=a,this.projectService=c,this.adaptiveLayoutService=d,this.contentService=e,this.layoutFactory=f,this._handleSpineAlteringEvent=b(this._handleSpineAlteringEvent,this),this._handleCommandInvocation=b(this._handleCommandInvocation,this),this.captureSpineAlteringEvents()}return a.WIDE_VARIANT="wide",a.prototype.captureSpineAlteringEvents=function(){return this.eventBus.subscribe(this.eventBus.events.COMMAND_EXECUTED,this._handleCommandInvocation),this.eventBus.subscribe(this.eventBus.events.CROSSED_WIDELAYFLAT_PAGE_LIMIT,this._handleSpineAlteringEvent),this.eventBus.subscribe(this.eventBus.events.PROJECT_CONVERSION_COMPLETE,this._handleSpineAlteringEvent),this.eventBus.subscribe(this.eventBus.events.PROJECT_UNDO_CONVERSION_COMPLETE,this._handleSpineAlteringEvent)},a.prototype._commandCanAffectSpine=function(a){var b;return!!/Autofill(\w+)BookCommand/.test(a.commandName)||("AddPagesCommand"===(b=a.commandName)||"RemovePageCommand"===b||"AdaptPageCommand"===b)},a.prototype._handleCommandInvocation=function(a,b){if(this._commandCanAffectSpine(b))return this.ensureCorrectSpineWidth()},a.prototype._handleSpineAlteringEvent=function(a,b){return this.ensureCorrectSpineWidth()},a.prototype.ensureCorrectSpineWidth=function(){var a,b,c,d;if(a=this.projectService.currentProject.product,!this._hasCorrectSpine(a)&&(c=a.cover.spinePage,c.isSpine()))return d=this.adaptiveLayoutService.createProductSpec(this.projectService.currentProject.product,c),b={pageCount:this.projectService.currentProject.product.pages.length,styleJson:this.contentService.currentStyle},this.adaptiveLayoutService.getAdaptiveLayoutRetainingImages(c,d,b).then(function(b){return function(c){b._updateSpineLayout(a,c),b._updateCoverVariant(a),b.contentService.setStyleAfterInitialProjectLoad(b.projectService.currentProject)}}(this))},a.prototype._hasCorrectSpine=function(a){return a.canApplyWideSpine()?a.hasWideSpine():!a.hasWideSpine()},a.prototype._updateSpineLayout=function(a,b){var c;return c=a.cover.spinePage,c.layout=this.layoutFactory.newInstance(angular.copy(b.content)),c.layoutName=b.id,c.layoutVersion=b.version,this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:a.pageFactory.Page.SPINE_PAGE_NUMBER,redrawRequired:!0})},a.prototype._updateCoverVariant=function(b){return b.canApplyWideSpine()?b.cover.variant=a.WIDE_VARIANT:b.cover.variant=void 0},a}(),a.$inject=["eventBus","projectService","adaptiveLayoutService","contentService","layoutFactory"],angular.module("galleon").service("spineConversionService",a)}.call(this),function(){"use strict";var a;a=function(){function a(a){this.enums=a,this.reportKeys={},this.reportKeys[this.enums.ProductFeature.HARD_PHOTO_COVER]="addedHardCover",this.reportKeys[this.enums.ProductFeature.CLOTH_COVER]="addedClothCover",this.reportKeys[this.enums.ProductFeature.CRUSHED_SILK_COVER]="addedCrushSilk",this.reportKeys[this.enums.ProductFeature.GENUINE_LEATHER_COVER]="addedGenuineLeather",this.reportKeys[this.enums.ProductFeature.LEATHER_COVER]="addedLeatherCover",this.reportKeys[this.enums.ProductFeature.LINEN_COVER]="addedLinen",this.reportKeys[this.enums.ProductFeature.PADDED_COVER]="addedPadded",this.reportKeys[this.enums.ProductFeature.MATTE_COVER]="addedMatteCover",this.reportKeys[this.enums.ProductFeature.DUST_JACKET]="addedDustJacket",this.reportKeys[this.enums.ProductFeature.GLOSSY_PAGES]="addedGlossyPages",this.reportKeys[this.enums.ProductFeature.STANDARD_PAGES]="addedStandardPages",this.reportKeys[this.enums.ProductFeature.LAYFLAT]="addedLayflat",this.reportKeys[this.enums.ProductFeature.HINGED_LAYFLAT]="addedHinged",this.reportKeys[this.enums.ProductFeature.KEEPSAKE_POCKET]="addedMemorabiliaPocket",this.reportValues={DEFAULT:"default",EDIT:"booktab",UPSELL:"upsell"}}return a.prototype.init=function(a){var b,c,d,e,f;this.projectService=a,d=this.projectService.currentProject,e=this.reportKeys,f=[];for(b in e)c=e[b],this._hasFeature(b,d)&&null==d.getReportingValue(c)?f.push(d.setReportingValue(c,this.reportValues.DEFAULT)):f.push(void 0);return f},a.prototype._hasFeature=function(a,b){var c,d;d=!1;try{d=this._isFeatureAddedToProject(a,b)}catch(a){c=a,d=!1}return d},a.prototype._isFeatureAddedToProject=function(a,b){var c;switch(c=b.product,a){case this.enums.ProductFeature.HARD_PHOTO_COVER:return c.cover.isHardCover();case this.enums.ProductFeature.CLOTH_COVER:return c.cover.getCoverType()===this.enums.CoverType.STOCK_CLOTH;case this.enums.ProductFeature.CRUSHED_SILK_COVER:return c.cover.getCoverType()===this.enums.CoverType.STOCK_SILK;case this.enums.ProductFeature.GENUINE_LEATHER_COVER:return c.cover.getCoverType()===this.enums.CoverType.STOCK_PREMIUM;case this.enums.ProductFeature.LEATHER_COVER:return c.cover.getCoverType()===this.enums.CoverType.STOCK_LEATHER;case this.enums.ProductFeature.LINEN_COVER:return c.cover.getCoverType()===this.enums.CoverType.STOCK_LINEN;case this.enums.ProductFeature.PADDED_COVER:return c.hasPaddedFinish();case this.enums.ProductFeature.MATTE_COVER:return c.hasMatteFinish();case this.enums.ProductFeature.DUST_JACKET:return c.hasDustJacket();case this.enums.ProductFeature.GLOSSY_PAGES:return c.hasGlossyPages();case this.enums.ProductFeature.STANDARD_PAGES:return c.hasStandardPages();case this.enums.ProductFeature.LAYFLAT:return c.cover.hasLayflatBinding();case this.enums.ProductFeature.HINGED_LAYFLAT:return c.cover.hasHingedLayflatBinding();case this.enums.ProductFeature.KEEPSAKE_POCKET:return c.hasKeepsakePocket()}return!1},a.prototype.addFeatureOnEdit=function(a){return this._recordFeature(a,this.reportValues.EDIT,"edit")},a.prototype.addFeatureOnUpsell=function(a){return this._recordFeature(a,this.reportValues.UPSELL,"upsell")},a.prototype._recordFeature=function(a,b,c){return this._validateFeature(a,c),this.projectService.currentProject.setReportingValue(this.reportKeys[a],b)},a.prototype._validateFeature=function(a,b){if(null==this.reportKeys[a])throw new Error("Unknown reported feature="+a+" on "+b)},a.prototype.recordRemovedFeatures=function(){var a,b,c,d,e;c=this.projectService.currentProject,d=this.reportKeys,e=[];for(a in d)b=d[a],this._hasFeature(a,c)||null==c.getReportingValue(b)?e.push(void 0):e.push(c.removeReportingProperty(b));return e},a}(),a.$inject=["enums"],angular.module("galleon").service("upsellReportingService",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l){this.projectService=a,this.eventBus=c,this.config=d,this.projectClient=f,this.userService=g,this.productModelStrategy=h,this.$window=i,this.$q=j,this.projectValidator=k,this.reportingDataCalculator=l,this._resetPatchState=b(this._resetPatchState,this),this._projectSaved=b(this._projectSaved,this),this._projectLoaded=b(this._projectLoaded,this),this.releaseObserver=b(this.releaseObserver,this),this._performFullSave=b(this._performFullSave,this),this.commitProject=b(this.commitProject,this),this.jsonPatch=this.$window.jsonpatch,this.observer=null,this.observedGuid=null,this.delayedPatchCount=0,this._patchQueue=[],this._needsFullSave=!1,this.eventBus.subscribe(this.eventBus.events.PROJECT_SAVE_FULL,this._performFullSave),this.eventBus.subscribe(this.eventBus.events.PROJECT_SAVE_COMPLETED,this._projectSaved),this.eventBus.subscribe(this.eventBus.events.PROJECT_LOADED,this._projectLoaded),this.logger=e.newInstance("PatchService")}return a.ERROR_NOT_AUTHENTICATED="User is not logged in",a.ERROR_NO_OBSERVATION="Changes must be observed prior to commit",a.INFO_NO_CHANGES="No changes detected",a.prototype.observeProject=function(){return!!this.config.incrementalSave&&(null!=this.projectService.currentProject.projectGUID&&(this._needsFullSave===!1&&(null==this.observer&&(this.observer=this.jsonPatch.observe(this.projectService.currentProject.values),
this.observedGuid=this.projectService.currentProject.projectGUID,this.eventBus.publish(this.eventBus.events.PROJECT_OBSERVED_FOR_PATCH)),!0)))},a.prototype.commitProject=function(){var b,c,d,e,f,g;return this._needsFullSave?this._performFullSave():null==this.observer?this.createRejectedPromise(a.ERROR_NO_OBSERVATION):(this.projectValidator.validate(this.projectService.currentProject,{event:"PatchService commitProject",intensity:"thorough"}),this.reportingDataCalculator.calculate(this.projectService.currentProject),this.productModelStrategy.clean(this.projectService.currentProject),d=this.jsonPatch.generate(this.observer),d=this.decoratePatches(d),this._addPatchesToQueue(d),g=angular.copy(this._patchQueue),this._clearPatchQueue(),g.length>0?(b=this.$q.defer(),f=function(a){return function(d){return a.delayedPatchCount=0,c.success(),a.eventBus.publish(a.eventBus.events.UPDATE_SAVE_TIME,{lastModifiedTime:d.lastModified}),b.resolve({status:d.status,patches:g})}}(this),e=function(a){return function(d){var e,f;return a.logger.warn("Patch failed: "+d.status),409===d.status?(c.success({status:d.status,response:d.data}),a._saveFullProject(b)):429===d.status&&a.delayedPatchCount>=a.config.maxDelayedPatchCount-1?(c.success({status:d.status,response:d.data}),a._saveFullProject(b)):429===d.status?(c.success({status:d.status,response:d.data}),a.delayedPatchCount++,a._addPatchesToFrontOfQueue(g),e=1e3*parseInt(d.headers["retry-after"],10),a.logger.warn("Patch requests rate limited: "+d.status+" "+e),b.reject({status:d.status,data:d.data,interval:e,patches:g})):400<=(f=d.status)&&f<500?(c.success({status:d.status,response:d.data}),a._saveFullProject(b)):(c.failure({status:d.status,response:d.data}),a._addPatchesToFrontOfQueue(g),a.logger.critical("Could not patch project: "+d.status+" "+d.data),b.reject({status:d.status,data:d.data,patches:g}))}}(this),c=this.logger.asyncMetric("patch"),this._withALoggedInUser(function(a){return function(b){var c;return c=a.projectService.getLastModifiedTime(),a.projectClient.patchProject(b.id,b.apigeeToken,a.observedGuid,g,c).then(f,e)}}(this),b,g),b.promise):this.createResolvedPromise(a.INFO_NO_CHANGES))},a.prototype._withALoggedInUser=function(b,c,d){return null==d&&(d={}),this.userService.userInfo().then(function(e){return(null!=e?e.isLoggedIn:void 0)?b(e):c.reject({data:a.ERROR_NOT_AUTHENTICATED,patches:d})})},a.prototype._performFullSave=function(){var a;return a=this.$q.defer(),this._saveFullProject(a),a.promise},a.prototype._saveFullProject=function(a){var b,c,d;return this.delayedPatchCount=0,b=this.logger.asyncMetric("clobberSave"),d=function(c){return function(d){return b.success(),c._needsFullSave=!1,c.eventBus.publish(c.eventBus.events.UPDATE_SAVE_TIME,{lastModifiedTime:d.lastModified}),a.resolve({status:d.status,lastModified:d.lastModified})}}(this),c=function(c){return function(d){return 403===d.status?c.eventBus.publish(c.eventBus.events.PROJECT_SAVE_AS):(c.logger.critical("Could not save project: "+d.status+" "+d.data),b.failure({status:d.status,response:d.data}),a.reject({status:d.status,data:d.data}))}}(this),this._withALoggedInUser(function(a){return function(b){var e;return e=a.productModelStrategy.wrapProject(a.projectService.currentProject.values),a.projectClient.updateProject(b.id,b.oAuthToken,e,b.apigeeToken).then(d,c)}}(this),a)},a.prototype.createRejectedPromise=function(a){var b;return b=this.$q.defer(),b.reject({data:a}),b.promise},a.prototype.createResolvedPromise=function(a){var b;return b=this.$q.defer(),b.resolve({data:a,patches:[]}),b.promise},a.prototype.decoratePatches=function(a){var b;return b="/projectDocument/projectBody/"+this.productModelStrategy.getWrapperName(),a.map(function(a){return a.path=b+a.path,null!=a.value&&(a.value=JSON.stringify(a.value)),a})},a.prototype.releaseObserver=function(){if(null!=this.observer)return this.observer.unobserve(),delete this.observer},a.prototype._projectLoaded=function(){return this.observer&&(this._needsFullSave=!0),this._resetPatchState()},a.prototype._projectSaved=function(){return this._needsFullSave=!1,this._resetPatchState()},a.prototype._resetPatchState=function(){if(this.delayedPatchCount=0,this.releaseObserver(),this._clearPatchQueue(),null!=this.projectService.currentProject.projectGUID)return this.observeProject()},a.prototype._addPatchesToQueue=function(a){var b,c,d;if(null!=a){if(!Array.isArray(a))throw new Error(""+a+" is not of type Array");for(c=0,d=a.length;c<d;c++)b=a[c],this._patchQueue.push(b)}},a.prototype._addPatchesToFrontOfQueue=function(a){var b,c,d,e;if(null!=a){if(!Array.isArray(a))throw new Error(""+a+" is not of type Array");for(b=d=0,e=a.length;d<e;b=++d)c=a[b],this._patchQueue.splice(b,0,c)}},a.prototype._clearPatchQueue=function(){return this._patchQueue=[]},a}(),a.$inject=["projectService","eventBus","CONFIG","loggerFactory","projectClient","userService","productModelStrategy","$window","$q","projectValidator","reportingDataCalculator","productModelStrategy"],angular.module("galleon").service("patchService",a)}.call(this),function(){var a;a=function(){function a(){}return a.prototype.applyCreationDefaults=function(a,b,c){var d,e;return null==a.images&&(a.images=[]),null==a.styleId&&(a.styleId=b.styleId),null==a.styleVersion&&(a.styleVersion=b.styleVersion),null==a.productSize&&(a.productSize=b.sizeId),null==a.constraints&&(a.constraints=b.constraints),b.superSimple&&null!=(null!=(e=(d=c.getSuperSimpleDefaults()).constraints)?e.layoutCategory:void 0)&&(constraints.LayoutCategoryConstraint={category:d.constraints.layoutCategory}),a.title="My Calendar",a},a.prototype.buildCreationRequest=function(a,b){var c;return a.startingMonth=b.startingMonth,a.startingYear=b.startingYear,a.omitEmptyAssets=b.virtualAssets,c={method:"POST",data:{CalendarCreationRequest:a},url:this.getPostURL(b)}},a.prototype.buildInnerPageRequest=function(a){var b,c,d,e,f,g,h;return c=a.config,e=a.images,h=a.styleId,b=a.binding,d=a.constraints,g={styleId:h,binding:b,images:e,constraints:d},f={method:"POST",data:{CalendarCreationRequest:g},url:""+this.getPostURL(c)+"?innerPagesOnly=true"}},a.prototype.applyConversionRequest=function(a){return{CalendarConversionRequest:a}},a.prototype.getPostURL=function(a){var b,c;return b=a.dsVersion,c=a.docsmith.url,""+c+"/api/docsmith/"+b+"/calendar"},a.prototype.getProjectReloadURL=function(a,b){var c,d,e,f,g;return null!=b.projectGUID?""+a+"/gc/#/?projectGuid="+b.projectGUID:(f=b.product.styleId,d=b.product.sizeId,e=b.product.getCalendarStartDate(),c=e.month,g=e.year,""+a+"/gc/#/?styleId="+f+"&sizeId="+d+"&startingMonth="+c+"&startingYear="+g)},a}(),angular.module("galleon-gc").service("productRequestBuilder",a)}.call(this),function(){var a;a=function(){function a(a,b,c){this.deviceDetectionService=a,this.contentService=b,this.config=c}return a.prototype.applyCreationDefaults=function(a,b,c){return null==a.images&&(a.images=[]),null==a.styleId&&(a.styleId=b.styleId),null==a.styleVersion&&(a.styleVersion=b.styleVersion),null==a.coverSpecId&&(a.coverSpecId=b.coverSpecId),null==a.finish&&(a.finish=b.coverFinish),null==a.binding&&(a.binding=b.defaults.coverBinding),null==a.constraints&&(a.constraints=b.constraints),null==a.stockCoverSpecId&&(a.stockCoverSpecId=b.stockCoverSpecId),a.title="My Photo Book","editor"===this.config.defaults.productMode&&(a.title="My Collage"),this._applySuperSimpleConstraints(a,b,c),a},a.prototype._applySuperSimpleConstraints=function(a,b,c,d){var e,f,g,h;if(b.superSimple)return e=c.getSuperSimpleDefaults().constraints,f=a.constraints,c.isDeviceATablet()&&null!=this.contentService.currentStyleCategory?(f.LayoutCategoryConstraint={category:this.contentService.currentStyleCategory},null!=(null!=e?e.ImageCountConstraint:void 0)&&(f.ImageCountConstraint=e.ImageCountConstraint)):null!=(null!=e?e.layoutCategory:void 0)&&(f.LayoutCategoryConstraint={category:e.layoutCategory}),null!=(null!=e?e.SpreadConstraint:void 0)&&(f.SpreadConstraint=null!=e?e.SpreadConstraint:void 0),null!=(null!=e?e.LinearDensityConstraint:void 0)&&(f.LinearDensityConstraint=null!=e?e.LinearDensityConstraint:void 0),null!=(null!=(g=b.constraints)?g.TextAreaCountConstraint:void 0)&&(f.TextAreaCountConstraint=null!=(h=b.constraints)?h.TextAreaCountConstraint:void 0),null!=d&&(f.LinearDensityConstraint.densityPoints=[[1e3,d/2]]),f.LayoutAttributesMatchConstraint=null!=e?e.LayoutAttributesMatchConstraint:void 0,a},a.prototype.buildCreationRequest=function(a,b){var c;return c={method:"POST",data:{BookCreationRequest:a},url:this.getPostURL(b)}},a.prototype.buildInnerPageRequest=function(a){var b,c,d,e,f,g,h,i,j,k,l;return c=a.config,g=a.images,l=a.styleId,b=a.binding,d=a.constraints,e=a.coverSpecId,k=a.stockCoverSpecId,f=a.density,j=a.startingPageNumber,i={styleId:l,binding:b,images:g,constraints:d},null!=k?i.stockCoverSpecId=k:i.coverSpecId=e,this._applySuperSimpleConstraints(i,c,this.deviceDetectionService,f),this.deviceDetectionService.isDeviceAPhone()&&(i.cover=c.phoneCoverLayouts),h={method:"POST",data:{BookCreationRequest:i},url:""+this.getPostURL(c)+"?innerPagesOnly=true"},c.superSimple&&(h.url=""+h.url+"&startingPageNumber="+j),h},a.prototype.applyConversionRequest=function(a){return{BookConversionRequest:a}},a.prototype.applyPageConversionRequest=function(a){return{PageConversionRequest:a}},a.prototype.getPostURL=function(a){var b,c;return b=a.dsVersion,c=a.docsmith.url,""+c+"/api/docsmith/"+b+"/photobook"},a.prototype.getProjectReloadURL=function(a,b){var c,d,e;return null!=b.projectGUID?""+a+"/pb/#/?projectGuid="+b.projectGUID:(e=b.product.styleId,d=b.product.cover.coverSpecID,c=b.product.cover.binding,""+a+"/pb/#/?binding="+c+"&styleId="+e+"&coverSpecId="+d)},a}(),a.$inject=["deviceDetectionService","contentService","CONFIG"],angular.module("galleon-pb").service("productRequestBuilder",a)}.call(this),function(){var a;a=function(){function a(){}return a.prototype.applyCreationDefaults=function(a,b){return null==a.images&&(a.images=[]),null==a.styleId&&(a.styleId=b.styleId),null==a.styleVersion&&(a.styleVersion=b.styleVersion),null==a.coverSpecId&&(a.coverSpecId=b.coverSpecId),null==a.finish&&(a.finish=b.coverFinish),null==a.binding&&(a.binding=b.defaults.coverBinding),null==a.constraints&&(a.constraints=b.constraints),null==a.stockCoverSpecId&&(a.stockCoverSpecId=b.stockCoverSpecId),a.title="My Collage",this._applySuperSimpleConstraints(a,b),a},a.prototype._applySuperSimpleConstraints=function(a,b){return b.superSimple&&b.defaults.useUniversalStylesOnly&&(a.constraints.LayoutCategoryConstraint={category:b.superSimpleDefaults.constraints.layoutCategory}),a},a.prototype.buildCreationRequest=function(a,b){var c;return c={method:"POST",data:{BookCreationRequest:a},url:this.getPostURL(b)}},a.prototype.buildInnerPageRequest=function(a){var b,c,d,e,f,g,h,i,j;return c=a.config,f=a.images,j=a.styleId,b=a.binding,d=a.constraints,e=a.coverSpecId,i=a.stockCoverSpecId,h={styleId:j,binding:b,images:f,constraints:d},null!=i?h.stockCoverSpecId=i:h.coverSpecId=e,this._applySuperSimpleConstraints(h,c),c.phone&&(h.cover=c.phoneCoverLayouts),g={method:"POST",data:{BookCreationRequest:h},url:""+this.getPostURL(c)+"?innerPagesOnly=true"}},a.prototype.applyConversionRequest=function(a){return{BookConversionRequest:a}},a.prototype.getPostURL=function(a){var b,c;return b=a.docsmith.version,c=a.docsmith.url,""+c+"/api/docsmith/"+b+"/photobook"},a}(),angular.module("galleon-ss").service("productRequestBuilder",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.$q=a,this.eventsService=b,this.projectEvents=c,this.defaultPublicEvents={"New Year's Day":!0,"Martin Luther King Jr. Day":!0,"Ash Wednesday":!0,"Valentine's Day":!0,"President's Day":!0,"Daylight Savings Begins":!0,"St. Patrick's Day":!0,"Palm Sunday":!0,"Good Friday":!0,Easter:!0,"Passover Begins":!0,"Mother's Day":!0,"Memorial Day":!0,"Ramadan Begins":!0,"Father's Day":!0,"Independence Day":!0,"Labor Day":!0,"Rosh Hashanah":!0,"Columbus Day":!0,"Yom Kippur":!0,Halloween:!0,"Daylight Savings Ends":!0,"Veterans' Day":!0,Thanksgiving:!0,Christmas:!0,"Hanukkah Begins":!0,Kwanzaa:!0}}return a.prototype.addDefaultEvents=function(a){var b,c,d;return b=this.$q.defer(),d=a.getCalendarStartDate(),c=a.getCalendarEndDate(),this.eventsService.loadPublicEvents(d,c).then(function(e){return function(f){var g,h,i,j;for(g=h=i=d.year,j=c.year;i<=j?h<=j:h>=j;g=i<=j?++h:--h)e.addEventsForYear(g,d,c,a,f,!0);return b.resolve()}}(this),function(){return b.reject()}),b.promise},a.prototype.addEventsForYear=function(a,b,c,d,e,f){var g,h,i,j,k,l,m;for(null==f&&(f=!1),i={},l=0,m=e.length;l<m;l++)if(h=e[l],g={month:h.month,year:a},(this.defaultPublicEvents[h.name]||f===!1)&&this._isDateWithinRange(g,b,c)){if(a!==h.year&&(h=angular.copy(h),h.year=a),h=this.projectEvents.addEvent(h),null==h)continue;g=new Date(h.year,h.month-1,h.day),null==i[g.getTime()]&&(i[g.getTime()]={events:[],date:g}),i[g.getTime()].events.push(h)}for(j in i)k=i[j],d.setEventsOnDate(k.events,k.date);this.eventsService.loadProjectEvents().forEach(function(a){return a.isSelected=!0})},a.prototype._isDateWithinRange=function(a,b,c){return this._compareDates(a,b)<=0&&this._compareDates(a,c)>=0},a.prototype._compareDates=function(a,b){var c;return c=b.year-a.year,0!==c?c:b.month-a.month},a}(),a.$inject=["$q","eventsService","projectEvents"],angular.module("galleon-gc").service("productEventsInitializer",a)}.call(this),function(){"use strict";var a;a=function(){function a(a){this.$q=a}return a.prototype.addDefaultEvents=function(a){var b;return b=this.$q.defer(),b.resolve(),b.promise},a}(),a.$inject=["$q"],angular.module("galleon-pb").service("productEventsInitializer",a)}.call(this),function(){"use strict";var a;a=function(){function a(a){this.$q=a}return a.prototype.addDefaultEvents=function(a){var b;return b=this.$q.defer(),b.resolve(),b.promise},a}(),a.$inject=["$q"],angular.module("galleon-ss").service("productEventsInitializer",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.projectService=a,this.eventBus=b,this.project=c,this.imageCollection=d}return a.prototype.cacheProject=function(a,b,c){if(null==a[b])return a[b]={project:angular.toJson(c.values)}},a.prototype.doRedo=function(a){var b,c;return b=null!=(null!=(c=a.target)?c.project:void 0),b&&(this.reconstituteProjectFromJson(a.target.project),this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.projectService.currentProject)),b},a.prototype.reconstituteProjectFromJson=function(a){var b;return b=this.project.init(angular.fromJson(a)),this.projectService.currentProject=b},a.prototype.doReverse=function(a){var b;return this.cacheProject(a,"target",this.projectService.currentProject),b={projectImages:this.imageCollection.projectImages},this.reconstituteProjectFromJson(a.source.project),this.projectService.currentProject.imageCollection.replaceImageCollection(b),this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.projectService.currentProject)},a.prototype.copyProjectMetadata=function(a,b){var c;return b.title=a.title,null!=a.projectID&&(b.projectID=a.projectID),null!=a.projectGUID&&(b.projectGUID=a.projectGUID),null!=(null!=(c=a.product)?c.guid:void 0)&&(b.product.guid=a.product.guid),this._copyInitalReportingValues(a,b)},a.prototype._copyInitalReportingValues=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;return b.setReportingValue("appVersionCreate",null!=(c=a.reportingData)&&null!=(d=c.appVersionCreate)?d.value:void 0),b.setReportingValue("initialPrice",null!=(k=a.reportingData)&&null!=(l=k.initialPrice)?l.value:void 0),b.setReportingValue("initialNumPics",null!=(m=a.reportingData)&&null!=(n=m.initialNumPics)?n.value:void 0),b.setReportingValue("initProjectGuid",null!=(o=a.reportingData)&&null!=(p=o.initProjectGuid)?p.value:void 0),b.setReportingValue("initialStyleName",null!=(q=a.reportingData)&&null!=(r=q.initialStyleName)?r.value:void 0),b.setReportingValue("initialNumPages",null!=(e=a.reportingData)&&null!=(f=e.initialNumPages)?f.value:void 0),b.setReportingValue("initialSize",null!=(g=a.reportingData)&&null!=(h=g.initialSize)?h.value:void 0),b.setReportingValue("initialCoverType",null!=(i=a.reportingData)&&null!=(j=i.initialCoverType)?j.value:void 0)},a}(),a.$inject=["projectService","eventBus","project","imageCollection"],angular.module("galleon").service("AbstractAutofillCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.projectService=a,this.commandFactory=b,this.eventBus=c,this.navService=d,this.type="custom",this.name="AddImageToFillerPageCommand"}return a.prototype.execute=function(a,b){if(!this._optionsValid(b)&&null==this.addPageOptions)throw new Error("Invalid options given");return null==this.activePageNumber&&(this.activePageNumber=this._lastPageSurfaceNumber()),this._setUpOptions(b),this._executeCommands(b)},a.prototype._setUpOptions=function(a){if(null==this.addPageOptions&&(this.addPageOptions=this._addPageOptions(a)),null==this.adaptOptions&&null!=a.imageId&&(this.adaptOptions=this._adaptPageOptions(a)),null==this.moveImageOptions&&null!=a.imageAsset)return this.moveImageOptions=this._moveImageOptions(a)},a.prototype._executeCommands=function(a){return null==this.addPageCommand&&(this.addPageCommand=this.commandFactory.getInstance("AddPagesCommand",this.addPageOptions)),this.addPageCommand.execute(this._book(),this.addPageOptions),null!=a.imageId&&this._executeAdaptPage(),null!=a.imageAsset&&this._executeMoveImage(),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED,{pageNumber:this._lastPageSurfaceNumber()})},a.prototype._executeMoveImage=function(){return null==this.moveImageCommand&&(this.moveImageCommand=this.commandFactory.getInstance("MoveWellImageCommand",this.moveImageOptions)),this.moveImageCommand.execute(this._book(),this.moveImageOptions)},a.prototype._executeAdaptPage=function(){return null==this.adaptPageCommand&&(this.adaptPageCommand=this.commandFactory.getInstance("AdaptPageCommand",this.adaptOptions)),this.adaptPageCommand.execute(this._book().pageBySurfaceNumber(this._lastPageSurfaceNumber()),this.adaptOptions)},a.prototype._addPageOptions=function(a){var b;return b=this._lastPageSurfaceNumber()+1,{add:{pages:[a.newPage],addAtPageNumber:b},beforeCommandPageNumber:this._lastPageSurfaceNumber(),activePageNumber:b}},a.prototype._adaptPageOptions=function(a){return{pageNumber:this._lastPageSurfaceNumber()+1,imageId:a.imageId,layoutInfo:a.layoutInfo}},a.prototype._moveImageOptions=function(a){return{originPageNumber:a.sourcePageNumber,targetPageNumber:this._lastPageSurfaceNumber()+1,imageAsset:a.imageAsset,layoutInfo:a.layoutInfo}},a.prototype._lastPageSurfaceNumber=function(){return this.projectService.currentProject.product.lastPage().surfaceNumber},a.prototype._book=function(){return this.projectService.currentProject.product},a.prototype._optionsValid=function(a){return null!=a&&"object"==typeof a&&(("string"==typeof a.imageId||"object"==typeof a.imageAsset&&"number"==typeof a.sourcePageNumber)&&!(null!=a.imageId&&null!=a.imageAsset)&&"object"==typeof a.layoutInfo&&"object"==typeof a.newPage)},a.prototype.reverse=function(a,b){return null!=this.adaptOptions&&this.adaptPageCommand.reverse(this._book().pageBySurfaceNumber(this._lastPageSurfaceNumber()),this.adaptOptions),null!=this.moveImageOptions&&this.moveImageCommand.reverse(this._book(),this.moveImageOptions),this.addPageCommand.reverse(this._book(),this.addPageOptions),this.navService.gotoPage(this.activePageNumber),this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.projectService.currentProject),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED)},a}(),a.$inject=["projectService","commandFactory","eventBus","navService"],angular.module("galleon").value("AddImageToFillerPageCommand",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c){this.eventBus=a,this.storytellingAssetRegistry=c,this.afterReverse=b(this.afterReverse,this),this.type="page",this.name="ApplyBackgroundCommand",this.hasStorytellingChange=!1}return a.prototype.execute=function(a,b){var c,d,e,f,g;if(this._validateParameters(a,b),d=b.contentGraphicAsset,this.hasStorytellingChange=this.storytellingAssetRegistry.hasAsset(d.assetId),null!=b.backgroundIndex)this._applyBackgroundAtIndex(d,b.backgroundIndex,a);else for(g=a.getBackgrounds(),e=0,f=g.length;e<f;e++)c=g[e],this._applyBackground(c,d,a);if(this.eventBus.publish(this.eventBus.events.SURFACE_BACKGROUND_UPDATED,{pageNumber:b.pageNumber}),this.hasStorytellingChange)return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a.prototype._validateParameters=function(a,b){if(!(a&&b&&b.contentGraphicAsset&&this._isValidBackgroundIndex(b.backgroundIndex,a)))throw new Error("Invalid argument!")},a.prototype._isValidBackgroundIndex=function(a,b){return null==a||a>=0&&a<b.getBackgrounds().length},a.prototype._applyBackgroundAtIndex=function(a,b,c){var d,e;return e=c.getBackgroundsBeginningToEnding(),d=e[b],this._applyBackground(d,a,c)},a.prototype._applyBackground=function(a,b,c){return this.hasStorytellingChange||(this.hasStorytellingChange=this._isBackgroundStorytellingAsset(a)),a.assignContentGraphicAsset(b,c.layout.generateContainerId())},a.prototype._isBackgroundStorytellingAsset=function(a){var b,c;return b=null!=a&&null!=(c=a.values.assetReference)?c.assetId:void 0,this.storytellingAssetRegistry.hasAsset(b)},a.prototype.afterReverse=function(a){if(this.eventBus.publish(this.eventBus.events.SURFACE_BACKGROUND_UPDATED,{pageNumber:a.surfaceNumber}),this.hasStorytellingChange)return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a}(),a.$inject=["eventBus","storytellingAssetRegistry"],angular.module("galleon").value("ApplyBackgroundCommand",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d){this.eventBus=a,this.graphicAssetFactory=c,this.storytellingAssetRegistry=d,this.afterReverse=b(this.afterReverse,this),this.type="page",this.name="ApplyEmbellishmentCommand"}return a.prototype.execute=function(a,b){var c,d;if(!(a&&b&&b.contentGraphicAsset))throw new Error("Invalid argument!");if(b.location=b.location||{xPercent:.5,yPercent:.5},a.customLayout=!0,c=b.contentGraphicAsset,d=this.graphicAssetFactory.newInstance(c.createEmbellishmentModelAsset(a,b.location)),a.addEmbellishment(d),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:b.pageNumber}),this.storytellingAssetRegistry.hasAsset(c.assetId))return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a.prototype.afterReverse=function(a){if(this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:a.surfaceNumber}),this.storytellingAssetRegistry.hasAsset(this.options.contentGraphicAsset.assetId))return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a}(),a.$inject=["eventBus","graphicAssetFactory","storytellingAssetRegistry"],angular.module("galleon").value("ApplyEmbellishmentCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.projectService=a,this.commandFactory=b,this.eventBus=c,this.navService=d,this.type="custom",this.name="ApplySpreadToLastPageCommand"}return a.prototype.execute=function(a,b){if(!this._optionsValid(b)&&null==this.addPageOptions)throw new Error("Invalid options given");return this._setUpOptions(b),this._executeCommands(b),this.navService.gotoPage(b.pageNumber)},a.prototype._setUpOptions=function(a){if(null==this.addPageOptions&&(this.addPageOptions=this._addPageOptions(a)),null==this.adaptOptions)return this.adaptOptions=this._adaptPageOptions(a)},a.prototype._executeCommands=function(a){return this._executeAddPages(),this._executeAdaptPage(a),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED,{pageNumber:a.pageNumber})},a.prototype._executeAddPages=function(){return null==this.addPageCommand&&(this.addPageCommand=this.commandFactory.getInstance("AddPagesCommand",this.addPageOptions)),this.addPageCommand.execute(this._book(),this.addPageOptions)},a.prototype._executeAdaptPage=function(a){return null==this.adaptPageCommand&&(this.adaptPageCommand=this.commandFactory.getInstance("AdaptPageCommand",this.adaptOptions)),this.adaptPageCommand.execute(this._book().pageBySurfaceNumber(a.pageNumber),this.adaptOptions)},a.prototype._addPageOptions=function(a){return{add:{pages:[a.newPage],addAtPageNumber:a.pageNumber+1},beforeCommandPageNumber:a.pageNumber,activePageNumber:a.pageNumber}},a.prototype._adaptPageOptions=function(a){return{pageNumber:a.pageNumber,layoutInfo:a.layoutInfo,backgroundContentGraphicAsset:a.backgroundContentGraphicAsset}},a.prototype._book=function(){return this.projectService.currentProject.product},a.prototype._optionsValid=function(a){return null!=a&&"object"==typeof a&&("number"==typeof a.pageNumber&&"object"==typeof a.layoutInfo&&"object"==typeof a.newPage)},a.prototype.reverse=function(a,b){return null!=this.adaptOptions&&this.adaptPageCommand.reverse(this._book().pageBySurfaceNumber(b.pageNumber),this.adaptOptions),this.addPageCommand.reverse(this._book(),this.addPageOptions),this.navService.gotoPage(b.pageNumber),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED)},a}(),a.$inject=["projectService","commandFactory","eventBus","navService"],angular.module("galleon").value("ApplySpreadToLastPageCommand",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d){this.eventBus=a,this.contentService=c,this.textAssetFactory=d,this.afterReverse=b(this.afterReverse,this),this.type="page",this.name="ApplyTextAreaCommand"}return a.prototype.execute=function(a,b){var c,d;if(!(a&&b&&b.pageNumber&&b.width&&b.height))throw new Error("Invalid argument!");return a.customLayout=!0,c=this.contentService.createTextArea(a.layout.generateContainerId(),a.layout.nextSeqNum("text"),b),d=this.textAssetFactory.newInstance(c),a.layout.addAsset(d),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:b.pageNumber})},a.prototype.afterReverse=function(a){return this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:a.surfaceNumber})},a}(),a.$inject=["eventBus","contentService","textAssetFactory"],angular.module("galleon").value("ApplyTextAreaCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e){this.eventBus=a,this.web2PrintService=b,this.contentService=c,this.$q=d,this.$timeout=e,this.type="custom",this.name="ApplyTextSettingsCommand",this.isLongOperation=!1,this.currentAssetCount=0}return a.prototype.execute=function(a,b){return this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this.$timeout(function(a){return function(){if(!a._optionsValid(b))throw new Error("Invalid options given.");return a._setUpOptions(b),a._assets=a._getTextAssets(),a.currentAssetCount=a._assets.length,a._dispatchProgress(a.currentAssetCount,a._assets.length),a._originalAssets=angular.copy(a._getTextAssets()),a._applyStyles(a._styleSettings)}}(this),500)},a.prototype.reverse=function(a,b){return this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this.$timeout(function(a){return function(){return a.currentAssetCount=a._assets.length,a._dispatchProgress(a.currentAssetCount,a._assets.length),a._revertStyles(a._originalStyleSettings)}}(this),500)},a.prototype._dispatchProgress=function(a,b){return this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_PROGRESS,{current:a,max:b})},a.prototype._setUpOptions=function(a){return this._pages=a.pages,this._styleSettings=a.styleSettings,this._originalStyleSettings=a.originalStyleSettings},a.prototype._applyStyles=function(a){var b,c,d,e,f;for(c=[],f=this._assets,d=0,e=f.length;d<e;d++)b=f[d],c.push(this._applyAssetStyles(b,a));return this.$q.all(c).then(function(b){return function(){return b._onStylesApplied(a)}}(this),function(b){return function(){return b._onStylesApplied(a)}}(this))},a.prototype._applyAssetStyles=function(a,b){var c,d,e;for(d=0,e=b.length;d<e&&(c=b[d],c.paraStyle!==a.asset.paraStyle);d++);return a.styles.color=c.selectedFontColor.color,a.styles.colorId=c.selectedFontColor.id,a.styles.fontFamily=c.selectedFont.fontFamily,a.styles.fontFamilyId=c.selectedFontFamily.fontFamilyId,a.styles.fontId=c.selectedFont.fontId,a.styles.fontName=c.selectedFont.fontName,a.styles.fontSize=c.selectedFontSize,a.styles.verticalAlign=a.verticalAlign,this._applyAssetChanges(a)},a.prototype._revertStyles=function(a){var b,c,d,e,f,g;for(d=[],g=this._assets,c=e=0,f=g.length;e<f;c=++e)b=g[c],d.push(this._revertedAssetStyles(b,this._originalAssets[c]));return this.$q.all(d).then(function(b){return function(){return b._onStylesApplied(a)}}(this),function(b){return function(){return b._onStylesApplied(a)}}(this))},a.prototype._revertedAssetStyles=function(a,b){return a.styles.color=b.styles.color,a.styles.colorId=b.styles.colorId,a.styles.fontFamily=b.styles.fontFamily,a.styles.fontFamilyId=b.styles.fontFamilyId,a.styles.fontId=b.styles.fontId,a.styles.fontName=b.styles.fontName,a.styles.fontSize=b.styles.fontSize,a.styles.verticalAlign=b.verticalAlign,this._applyAssetChanges(a)},a.prototype._applyAssetChanges=function(a){var b,c;return b=this.$q.defer(),this._needsWraps(a)?(c=a.editorContent,this.web2PrintService.textMetadataForAsset(a,c).then(function(c){return function(d){return null!=c._assets&&c._dispatchProgress(--c.currentAssetCount,c._assets.length),a.updateTextWithWrapsAndStyle(a.editorContent,d.wraps,a.overflow,a.styles),b.resolve()}}(this),function(c){return function(){return null!=c._assets&&c._dispatchProgress(--c.currentAssetCount,c._assets.length),a.updateTextWithWrapsAndStyle(null,[],!1,a.styles),b.resolve()}}(this)),b.promise):(a.updateTextWithWrapsAndStyle(a.editorContent,[],!1,a.styles),b.resolve(),b.promise)},a.prototype._onStylesApplied=function(a){return this._updateStyleDefaults(a),this.eventBus.publish(this.eventBus.events.MODAL_TEXT_SETTINGS_UPDATED,{styleSettings:a}),this._invalidatePagesWithText(a),this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_HIDE)},a.prototype._updateStyleDefaults=function(a){var b,c,d,e,f,g;for(b=this.contentService.currentStyle.fontAssignmentSet.fontAssignment,g=[],e=0,f=a.length;e<f;e++)d=a[e],g.push(function(){var a,e,f;for(f=[],a=0,e=b.length;a<e;a++)if(c=b[a],d.paraStyle===c.key){c.fontDescriptor.colorId=d.selectedFontColor.id,c.fontDescriptor.fontFamilyId=d.selectedFontFamily.fontFamilyId,c.fontDescriptor.fontId=d.selectedFont.fontId,c.fontDescriptor.pointSize=d.selectedFontSize;break}return f}());return g},a.prototype._invalidatePagesWithText=function(a){var b,c,d,e,f,g;for(f=this._pages,g=[],d=0,e=f.length;d<e;d++)c=f[d],this._pageHasUpdatedTextAsset(c,a)&&g.push(function(){var a,d,e,f;for(e=c.layout.assets,f=[],a=0,d=e.length;a<d;a++)b=e[a],"text"===b.asset.assetType&&f.push(this.eventBus.publish(this.eventBus.events.SURFACE_TEXT_UPDATED,{pageNumber:c.surfaceNumber,asset:b}));return f}.call(this));return g},a.prototype._pageHasUpdatedTextAsset=function(a,b){var c,d,e,f,g,h,i;for(i=a.layout.assets,e=0,g=i.length;e<g;e++)if(c=i[e],"text"===c.asset.assetType)for(f=0,h=b.length;f<h;f++)if(d=b[f],d.paraStyle===c.asset.paraStyle)return!0;return!1},a.prototype._optionsValid=function(a){return null!=a&&"object"==typeof a&&Array.isArray(a.styleSettings)},a.prototype._getTextAssets=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;for(b=[],k=this._pages,e=0,h=k.length;e<h;e++)for(c=k[e],l=c.layout.assets,f=0,i=l.length;f<i;f++)if(a=l[f],this._validTextAsset(a))for(m=this._styleSettings,g=0,j=m.length;g<j;g++)if(d=m[g],d.paraStyle===a.asset.paraStyle){b.push(a);break}return b},a.prototype._validTextAsset=function(a){return"text"===a.asset.assetType&&Object.keys(a.styles).length>0},a.prototype._needsWraps=function(a){var b;return"text"===a.asset.assetType&&a.hasContent()&&0!==(null!=(b=a.asset.guidanceText)?b.indexOf("date"):void 0)},
a}(),a.$inject=["eventBus","web2PrintService","contentService","$q","$timeout"],angular.module("galleon").value("ApplyTextSettingsCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.projectService=a,this.commandFactory=b,this.type="custom",this.name="ApplyImageEditsCommand",this.rememberActionPage=!0}return a.prototype.execute=function(a,b){var c;if(null==(null!=b&&null!=(c=b.source)?c.pageNumber:void 0))throw new Error("Invalid page number given");return null==this.options&&(this.options=b),this._createCommands(),this._executeCommands(),this._applyRedeyeGlobally(this.options.source.redeyeData,this.options.source.imageId)},a.prototype._createCommands=function(){if(null==this.addImageCommand)return this.addImageCommand=this.commandFactory.getInstance("AddWellImageCommand",this.options)},a.prototype._executeCommands=function(){var a;return a=this.projectService.currentProject.product,this.addImageCommand.stage=this.stage,this.addImageCommand.execute(a.pageBySurfaceNumber(this.options.source.pageNumber),this.options)},a.prototype._applyRedeyeGlobally=function(a,b){var c,d;if(null!=a&&(d=this.projectService.currentProject,c=d.imageCollection.getImageByImageId(b),null!=c))return c.redeye=a,d.imageCollection.updateProjectImages(c.values),d.updateProductImageAsset(c)},a.prototype.reverse=function(a,b){var c,d;return c=this.projectService.currentProject.product,this.addImageCommand.reverse(c.pageBySurfaceNumber(this.options.source.pageNumber),this.options),d=null==this.options.target.redeyeData?"":this.options.target.redeyeData,this._applyRedeyeGlobally(d,this.options.target.imageId)},a}(),a.$inject=["projectService","commandFactory"],angular.module("galleon").value("ApplyImageEditsCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.projectService=a,this.project=b,this.eventBus=c,this.name="ApplyToOtherPagesCommand",this.type="custom"}return a.prototype.cacheProject=function(a,b,c){if(null==a[b])return a[b]={project:angular.toJson(c.values)}},a.prototype.execute=function(a,b){var c;return this.cacheProject(b,"target",this.projectService.currentProject),c=this.project.init(angular.fromJson(b.project)),this.projectService.currentProject=c,this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.projectService.currentProject),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED)},a.prototype.reverse=function(a,b){var c;if(null!=(null!=(c=b.target)?c.project:void 0))return this.projectService.currentProject=this.project.init(angular.fromJson(b.target.project)),this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.projectService.currentProject),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED)},a}(),a.$inject=["projectService","project","eventBus"],angular.module("galleon").value("ApplyToOtherPagesCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g){this.projectService=a,this.project=b,this.eventBus=c,this.navService=e,this.contentService=f,this.productModelStrategy=g,this.log=d.newInstance("ConversionCommand"),this.type="custom",this.name="ConversionCommand",this.isLongOperation=!0,this.activePageNumber=null,this.originalStyle=null}return a.prototype.cacheProject=function(a,b,c){if(null==a[b])return a[b]={project:angular.toJson(c.values)}},a.prototype.execute=function(a,b){var c,d,e,f,g,h;if("redo"===this.stage&&(d=this.projectService.currentProject.imageCollection.projectImages,b.images=d),null==b.project)throw new Error("ConversionCommand requres .project");if(null==b.style)throw new Error("ConversionCommand requres .style");if(this.beforeCommandPageNumber=this.navService.selectedPage.surfaceNumber,this.activePageNumber=(null!=(g=this.projectService.currentProject.product.cover)?g.frontPage.surfaceNumber:void 0)||1,this.originalStyle=this.contentService.currentStyle,this.cacheProject(b,"target",this.projectService.currentProject),f=this.productModelStrategy.unwrapProject(angular.fromJson(b.project)),c=this.project.init(angular.extend({},f)),this.projectService.currentProject=c,this.selectPage(),this.stylesMatch(b.style)||this.contentService.changeCurrentStyle(b.style),this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_HIDE),b.images&&((null!=(h=this.projectService.currentProject)?h.imageCollection.currentUploadInProgress:void 0)>0&&c.imageCollection.replaceImageCollection({projectImages:b.images}),this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.projectService.currentProject)),this.eventBus.publish(this.eventBus.events.PROJECT_CONVERSION_COMPLETE),e=this.projectService.currentProject.product.pageBySurfaceNumber(this.activePageNumber),this.beforeCommandPageNumber===e.surfaceNumber)return this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED)},a.prototype.reverse=function(a,b){var c,d;return c=this.projectService.currentProject.imageCollection.projectImages,b.images=c,null!=(null!=(d=b.target)?d.project:void 0)&&(this.projectService.currentProject=this.project.init(angular.fromJson(b.target.project)),this.selectPage()),this.stylesMatch(this.contentService.currentStyle)||this.contentService.changeCurrentStyle(this.originalStyle),b.images&&this.projectService.currentProject.imageCollection.replaceImageCollection({projectImages:b.images}),this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.projectService.currentProject),this.eventBus.publish(this.eventBus.events.PROJECT_UNDO_CONVERSION_COMPLETE),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED)},a.prototype.stylesMatch=function(a){var b,c;return(null!=(b=this.originalStyle)?b.sizeId:void 0)===(null!=a?a.sizeId:void 0)&&(null!=(c=this.originalStyle)?c.styleId:void 0)===(null!=a?a.styleId:void 0)},a.prototype.selectPage=function(){if(this.selectedPageAfter=this.projectService.currentProject.product.pageBySurfaceNumber(this.activePageNumber),this.selectedPageAfter.isCover()&&this.selectedPageAfter.isStockCover)return this.navService.next()},a}(),a.$inject=["projectService","project","eventBus","loggerFactory","navService","contentService","productModelStrategy"],angular.module("galleon").value("ConversionCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g){this.calendarEventsImageService=a,this.eventsService=b,this.projectEvents=c,this.eventBus=d,this.projectService=e,this.imageCollection=f,this.calendarGrid=g,this.type="page",this.name="ShowCalendarEventCommand"}return a.prototype.execute=function(a,b){var c;if(null==(null!=b?b.event:void 0)||null==a)throw new Error("Invalid arguments. Requires both a page and an event");return this.serializedEvents=angular.toJson(this.projectEvents.values.eventCollection),this.lastProductImageID=this.imageCollection.lastProductImageID,this.event=b.event,this.calendarEventsImageService.importDefaultEventImage(this.event),this.calendarEventsImageService.reassignSelectedEventPhoto(this.event),this.event.isSelected=!this.event.isSelected,this._showEvent(this.event,b.deleteEvent),this.calendarEventsImageService.reassignUpdatedEventPhoto(this.event),this._isCandidateForImageAutoAssociation(this.event,b)&&null!=(c=this._getGridCellImageForDate(this.event.date,a))&&this._autoAssociateImageToEvent(c,this.event),this.eventBus.publish(this.eventBus.events.CALENDAR_EVENT_UPDATED,this.event)},a.prototype._showEvent=function(a,b){var c,d;return!b&&a.isSelected?this.projectEvents.addEvent(a):(this.projectEvents.deleteEvent(a),b===!0&&this.eventsService.deleteEvent(a)),this.eventsService.updateEvent(this.event,!1),d=this.projectEvents.eventsMatchingEventDate(a),c=new Date(a.year,a.month-1,a.day),this.projectService.currentProject.product.setEventsOnDate(d,c)},a.prototype._isCandidateForImageAutoAssociation=function(a,b){return!(!a.isSelected||b.deleteEvent)&&(null==this.projectEvents.getImageAssociation(a.id)&&null==this.calendarEventsImageService.getActiveImageAssociationOnDate(a.year,a.month,a.day))},a.prototype._getGridCellImageForDate=function(a,b){var c;return c=this.calendarGrid.findImageAreaForDate(this.event.date,b),(null!=c?c.hasAssignedImage():void 0)?this.imageCollection.getImageByProductImageId(c.projectImageId):null},a.prototype._autoAssociateImageToEvent=function(a,b){var c;return c=this.projectEvents.getImageInformationForImage(a),c.active=!0,this.projectEvents.addImageAssociation(b.id,c),b.imageMediaId=c.imageMediaId,b.imageView=c.imageView,this.eventsService.updateEvent(b,!0)},a.prototype.reverse=function(a,b){var c,d,e,f,g,h;if(this.event){for(e=this.event.isSelected,this.event.isSelected=!this.event.isSelected,this.eventsService.updateEvent(this.event,!1),this.calendarEventsImageService.removeGridCellImage(this.event),this.projectService.currentProject.product.applyPageValuesObj(a.surfaceNumber,angular.fromJson(this.serialized)),h=this.imageCollection.projectImages,d=f=0,g=h.length;f<g;d=++f)c=h[d],(null!=c?c.productImageID:void 0)>this.lastProductImageID&&this.imageCollection.removeImage(d);return this.projectService.currentProject.values.eventCollection=angular.fromJson(this.serializedEvents),this.projectEvents.init(this.projectService.currentProject.values),this.eventsService.loadProjectEvents(),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:a.surfaceNumber}),this.eventBus.publish(this.eventBus.events.CALENDAR_EVENT_UPDATED,this.event)}},a}(),a.$inject=["calendarEventsImageService","eventsService","projectEvents","eventBus","projectService","imageCollection","calendarGrid"],angular.module("galleon-gc").value("ShowCalendarEventCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e){this.eventsService=a,this.projectService=b,this.projectEvents=c,this.navService=d,this.eventBus=e,this.type="custom",this.name="UpdateCalendarEventCommand"}return a.prototype.execute=function(a,b){var c;if(!((null!=b?b.originalEvent:void 0)&&b.editedEvent&&(null!=(c=b.gridPage)?c.isGrid:void 0)))throw new Error("Invalid argument!");return this.originalEvent=b.originalEvent,this.editedEvent=b.editedEvent,this.gridPage=b.gridPage,this._updateEvent(this.originalEvent,this.editedEvent),this.eventsService.updateEvent(this.editedEvent),this.eventBus.publish(this.eventBus.events.CALENDAR_EVENT_UPDATED)},a.prototype._updateEvent=function(a,b){if(this.projectEvents.updateEvent(b),b.isSelected&&this._modifyGridEventsMatchingEvent(b),!this._eventDatesMatch([b,a]))return this._modifyGridEventsMatchingEvent(a)},a.prototype._eventDatesMatch=function(a){var b,c,d,e;if(!Array.isArray(a)||0===a.length)return!1;for(c=a[0],d=0,e=a.length;d<e;d++)if(b=a[d],c.year!==b.year||c.month!==b.month||c.day!==b.day)return!1;return!0},a.prototype._modifyGridEventsMatchingEvent=function(a){var b,c;return c=this.projectEvents.eventsMatchingEventDate(a),b=new Date(a.year,a.month-1,a.day),this.projectService.currentProject.product.setEventsOnDate(c,b)},a.prototype.reverse=function(a,b){return this._updateEvent(this.editedEvent,this.originalEvent),this.eventsService.updateEvent(this.originalEvent),this.navService.gotoPage(this.gridPage.surfaceNumber),this.eventBus.publish(this.eventBus.events.CALENDAR_EVENT_UPDATED)},a}(),a.$inject=["eventsService","projectService","projectEvents","navService","eventBus"],angular.module("galleon-gc").value("UpdateCalendarEventCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g,h){this.projectService=a,this.eventBus=b,this.adaptiveLayoutService=c,this.projectEvents=d,this.calendarGrid=e,this.calendar=f,this.calendarEventsImageService=g,this.config=h,this.type="page",this.name="RemoveWellImageCommand",this.serializedEvents=null}return a.prototype.execute=function(a,b){var c,d;if(a&&(null!=b?b.imageId:void 0)&&b.uniqueProjectRef){if(a.isGrid){if(this.config.virtualAssets&&(d=a.layout.values.assets.length,this._conditionallyDeflateGridCell(b.uniqueProjectRef,a),d-a.layout.values.assets.length!==0))return void this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,b);c=this._getActiveImageAssociation(a,b.uniqueProjectRef),(null!=c?c.active:void 0)&&this._setImageAssociationInactive(c)}return a.removeImage(b.uniqueProjectRef),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,b)}throw new Error("Invalid argument!")},a.prototype._getActiveImageAssociation=function(a,b){var c;return c=this.calendar.getDateForGridImageArea(a,b),null==c?null:this.calendarEventsImageService.getActiveImageAssociationOnDate(c.getFullYear(),c.getMonth()+1,c.getDate())},a.prototype._setImageAssociationInactive=function(a){return this.serializedEvents=angular.toJson(this.projectEvents.values.eventCollection),delete a.active},a.prototype._conditionallyDeflateGridCell=function(a,b){var c,d,e,f;if(d=function(b,c){return a=c[0],b.asset.assetType===b.asset.constructor.IMAGE_TYPE&&b.uniqueProjectRef===a},f=this.calendarGrid.seekToGridCell(b,d,[a]),c=f.gridCellIterator,e=f.matchingAsset,this.calendarGrid.canDeflateGridCell(c,e)&&e)return this.calendarGrid.deflateGridCell(e,c,b)},a.prototype.reverse=function(a,b){return this.projectService.currentProject.product.applyPageValuesObj(a.surfaceNumber,angular.fromJson(this.serialized)),null!=this.serializedEvents&&this._restoreSerializedEvents(),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_ADDED,b)},a.prototype._restoreSerializedEvents=function(){return this.projectService.currentProject.values.eventCollection=angular.fromJson(this.serializedEvents),this.projectEvents.init(this.projectService.currentProject.values)},a}(),a.$inject=["projectService","eventBus","adaptiveLayoutService","projectEvents","calendarGrid","calendar","calendarEventsImageService","CONFIG"],angular.module("galleon-gc").value("RemoveWellImageCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e){this.eventBus=a,this.eventsService=b,this.projectEvents=c,this.calendarEventsImageService=d,this.projectService=e,this.type="page",this.name="UpdateEventImageCommand"}return a.prototype.execute=function(a,b){var c,d,e,f,g;for(this.event=b.event,this.serializedEvents=angular.toJson(this.projectEvents.values.eventCollection),g=this.eventsService.events,e=0,f=g.length;e<f;e++)d=g[e],"custom"===d.visibility&&d.day===this.event.day&&d.month===this.event.month&&d.year===this.event.year&&d.id!==this.event.id&&(c=angular.copy(this.projectEvents.getImageAssociation(d.id)),null!=c&&(delete c.active,this.projectEvents.removeImageAssociation(d.id),this.projectEvents.addImageAssociation(d.id,c)));if(c=this.projectEvents.getImageAssociation(this.event.id),null!=c||null!=this.event.imageMediaId)return null==c?this.projectEvents.addImageAssociation(this.event.id,{imageMediaId:this.event.imageMediaId,imageView:this.event.imageView,projectImageId:this.event.projectImageId,active:!0}):(c.active===!0?delete c.active:c.active=!0,this.projectEvents.updateImageAssociation(this.event.id,c)),(null!=c?c.active:void 0)!==!0?this.calendarEventsImageService.removeGridCellImage(this.event):this.calendarEventsImageService.setGridCellImage(this.event),this.eventBus.publish(this.eventBus.events.CALENDAR_EVENT_UPDATED,this.event)},a.prototype.reverse=function(a,b){if(this.event)return this.projectService.currentProject.product.applyPageValuesObj(a.surfaceNumber,angular.fromJson(this.serialized)),this.projectService.currentProject.values.eventCollection=angular.fromJson(this.serializedEvents),this.projectEvents.init(this.projectService.currentProject.values),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:a.surfaceNumber}),this.eventBus.publish(this.eventBus.events.CALENDAR_EVENT_UPDATED,this.event)},a}(),a.$inject=["eventBus","eventsService","projectEvents","calendarEventsImageService","projectService"],angular.module("galleon").value("UpdateEventImageCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g,h,i){this.projectService=a,this.project=b,this.eventBus=c,this.projectEvents=d,this.calendarEventsImageService=e,this.calendar=f,this.productEventsInitializer=g,this.eventsService=h,this.navService=i,this.type="custom",this.name="ChangeStartDateCommand"}return a.prototype.execute=function(a,b){var c,d,e,f,g,h,i,j,k,l;if(d=b.monthsRequiringUpdate,null==b.layouts||null==d||b.layouts.length!==d.length)throw new Error(""+this.name+" requires matching layouts and monthsRequiringUpdate");if(null==b.indexOfNewStart)throw new Error(""+this.name+" requires an indexOfNewStart for changing start date");if(null==(null!=(h=b.startDate)?h.year:void 0)||null==(null!=(i=b.startDate)?i.month:void 0))throw new Error(""+this.name+" requires a startDate with month/year");if(null==(null!=(j=b.endDate)?j.year:void 0)||null==(null!=(k=b.endDate)?k.month:void 0))throw new Error(""+this.name+" requires a endDate with month/year");if(!Array.isArray(b.publicEvents))throw new Error(""+this.name+" requires an Array for options.publicEvents");for(this.serializedProject=angular.toJson(this.projectService.currentProject.values),this.serializedEvents=angular.toJson(this.eventsService.events),this.beforeCommandPageNumber=this.navService.selectedPage.surfaceNumber,e=angular.fromJson(this.serializedProject),this.requiresUpdate={},l=b.monthsRequiringUpdate,f=0,g=l.length;f<g;f++)c=l[f],this.requiresUpdate[""+c.pageDate.month+"-"+c.pageDate.year]=!0;return this._adjustEvents(b),this._readjustCalendar(e,b),this._reorderPages(e,b),this.projectService.currentProject=this.project.init(e),this._adjustProjectEvents(b),this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.projectService.currentProject),1===this.navService.selectedPage.surfaceNumber&&this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED),this.eventBus.publish(this.eventBus.events.CALENDAR_EVENT_UPDATED),this.selectedPageAfter=this.projectService.currentProject.product.pageBySurfaceNumber(1)},a.prototype._readjustCalendar=function(a,b){var c,d,e,f,g,h,i,j,k,l;for(i=b.startDate,l=b.layouts,d=j=0,k=l.length;j<k;d=++j)e=l[d],null!=(f=b.monthsRequiringUpdate[d])&&(h=a.product.pages[f.page.surfaceNumber-1],h.layout=e,g=f.pageDate.month<i.month?i.year+1:i.year,h.surfaceKey=""+g+"-"+f.pageDate.month,null!=(c=a.product.pages[h.surfaceNumber-2])&&(c.surfaceKey=h.surfaceKey))},a.prototype._reorderPages=function(a,b){var c,d,e,f,g,h,i,j;for(e=a.product.pages,f=e.splice(b.indexOfNewStart),f.unshift(e.shift()),a.product.pages=f.concat(e),i=a.product.pages,j=[],c=g=0,h=i.length;g<h;c=++g)d=i[c],j.push(d.surfaceNumber=c+1);return j},a.prototype._adjustEvents=function(a){var b,c,d,e,f,g,h,i;for(e=a.startDate,this.publicEventsSelected={},f=[],i=this.eventsService.events,g=0,h=i.length;g<h;g++)b=i[g],this.publicEventsSelected[b.name]=b.isSelected,(null==this.requiresUpdate[""+b.month+"-"+b.year]||"custom"===b.visibility&&b.recurring===!0)&&(d=b.month<e.month?e.year+1:e.year,b.year=d,c=new Date(b.year,b.month-1,b.day),b.date=c,b.dateMillis=c.getTime(),f.push(b));this.eventsService.events=f},a.prototype._adjustProjectEvents=function(a){var b,c,d,e,f,g,h,i,j,k,l;for(j=a.startDate,b={},f=k=l=this.projectEvents.eventCollection.eventItems.length-1;l<=0?k<=0:k>=0;f=l<=0?++k:--k)d=this.projectEvents.eventCollection.eventItems[f],null!=this.requiresUpdate[""+d.month+"-"+d.year]&&(i=d.month<j.month?j.year+1:j.year,h=new Date(i,d.month-1,d.day),d.recurring!==!0?this._removeOnetimeEvent(d,h):"custom"===d.visibility?(b[""+d.day+d.month+d.year]=d,this._moveRecurringEvent(d,h)):this.projectEvents.deleteEvent(d));this._reapplyPublicEvents(a);for(g in b)d=b[g],e=this.projectEvents.eventsMatchingEventDate(d),c=new Date(d.year,d.month-1,d.day),this.calendar.setEventsOnDate(e,c)},a.prototype._removeOnetimeEvent=function(a,b){return this.calendarEventsImageService.removeGridCellImage({date:b}),this.projectEvents.deleteEvent(a)},a.prototype._moveRecurringEvent=function(a,b){return a.year=b.getFullYear(),this.projectEvents.updateEvent(a)},a.prototype._reapplyPublicEvents=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;for(this.eventsService.addEvents(a.publicEvents),this.eventsService.syncSelectedPublicEvents(this.publicEventsSelected),j=a.startDate,d={},l={},q=a.monthsRequiringUpdate,m=0,o=q.length;m<o;m++)f=q[m],l[f.pageDate.year]=f.pageDate.year;for(e in l)for(k=l[e],r=a.publicEvents,n=0,p=r.length;n<p;n++)b=r[n],h=b.month<j.month?j.year+1:j.year,g=null!=this.requiresUpdate[""+b.month+"-"+k]||null!=this.requiresUpdate[""+b.month+"-"+h],i="public"!==b.visibility||this.publicEventsSelected[b.name]===!0,b.year===h&&g&&i&&(Array.isArray(d[h])||(d[h]=[]),d[h].push(b));for(k in d)c=d[k],this.productEventsInitializer.addEventsForYear(k,a.startDate,a.endDate,this.calendar,c)},a.prototype.reverse=function(a,b){return this.projectService.currentProject=this.project.init(angular.fromJson(this.serializedProject)),this.eventsService.restoreEvents(angular.fromJson(this.serializedEvents)),this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.projectService.currentProject),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED),this.eventBus.publish(this.eventBus.events.CALENDAR_EVENT_UPDATED)},a}(),a.$inject=["projectService","project","eventBus","projectEvents","calendarEventsImageService","calendar","productEventsInitializer","eventsService","navService"],angular.module("galleon-gc").value("ChangeStartDateCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.projectService=a,this.eventBus=b,this.type="page",this.name="RemoveWellImageCommand"}return a.prototype.execute=function(a,b){if(a&&b&&b.imageId&&b.uniqueProjectRef)return a.removeImage(b.uniqueProjectRef),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,b);throw new Error("Invalid argument!")},a.prototype.reverse=function(a,b){return this.projectService.currentProject.product.applyPageValuesObj(a.surfaceNumber,angular.fromJson(this.serialized)),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_ADDED,b)},a}(),a.$inject=["projectService","eventBus"],angular.module("galleon-pb").value("RemoveWellImageCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.projectService=a,this.eventBus=b,this.type="page",this.name="RemoveWellImageCommand"}return a.prototype.execute=function(a,b){if(a&&b&&b.imageId&&b.uniqueProjectRef)return a.removeImage(b.uniqueProjectRef),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,b);throw new Error("Invalid argument!")},a.prototype.reverse=function(a,b){return this.projectService.currentProject.product.applyPageValuesObj(a.surfaceNumber,angular.fromJson(this.serialized)),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_ADDED,b)},a}(),a.$inject=["projectService","eventBus"],angular.module("galleon-ss").value("RemoveWellImageCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.projectService=a,this.eventBus=b,this.type="page",this.name="RemoveWellCommand"}return a.prototype.execute=function(a,b){var c;if(a&&b&&b.pageNumber&&b.asset){if(null!=(c=b.asset)&&"function"==typeof c.hasAssignedImage?c.hasAssignedImage():void 0)throw new Error("Has assigned image.  Use RemoveWellImageCommand instead!");return a.removeAsset(b.asset),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:b.pageNumber})}throw new Error("Invalid argument!")},a.prototype.reverse=function(a,b){return this.projectService.currentProject.product.applyPageValuesObj(a.surfaceNumber,angular.fromJson(this.serialized)),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:b.pageNumber})},a}(),a.$inject=["projectService","eventBus"],angular.module("galleon").value("RemoveWellCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.projectService=a,this.commandFactory=b,this.eventBus=c,this.navService=d,this.type="custom",this.name="RemoveWellImageAndAdaptCommand"}return a.prototype.execute=function(a,b){return this._validateOptions(b),this._setUpOptions(b),this._executeCommands(b)},a.prototype._validateOptions=function(a){return this._expectArgument(a,"options"),this._expectArgument(a.pageNumber,"options.pageNumber"),this._expectArgument(a.imageId,"options.imageId"),this._expectArgument(a.uniqueProjectRef,"options.uniqueProjectRef"),this._expectArgument(a.layoutInfo,"options.layoutInfo")},a.prototype._setUpOptions=function(a){if(null==this.removeWellImageOptions&&(this.removeWellImageOptions=this._removeWellImageOptions(a)),null==this.adaptOptions&&(this.adaptOptions=this._adaptPageOptions(a)),null==this.removeProjectImageOptions)return this.removeProjectImageOptions=this._removeProjectImageOptions(a)},a.prototype._executeCommands=function(a){var b,c;if(null==this.removeWellImageCommand&&(this.removeWellImageCommand=this.commandFactory.getInstance("RemoveWellImageCommand",this.removeWellImageOptions)),this.removeWellImageCommand.execute(this._page(),this.removeWellImageOptions),null==this.adaptPageCommand&&(this.adaptPageCommand=this.commandFactory.getInstance("AdaptPageCommand",this.adaptOptions)),this.adaptPageCommand.execute(this._page(),this.adaptOptions),null==this.removeProjectImageCommand&&this._shouldRemoveProjectImage(a)&&(this.removeProjectImageCommand=this.commandFactory.getInstance("RemovePaletteImageCommand",this.removeProjectImageOptions)),null!=this.removeProjectImageCommand)return c=this.projectService.currentProject.imageCollection,c.usedImagesSubtract(),b=c.getImageByProductImageId(a.projectImageIdToRemove),this.eventBus.publish(this.eventBus.events.PALETTE_IMAGES_REMOVED,b),this.removeProjectImageCommand.execute(null,this.removeProjectImageOptions)},a.prototype._shouldRemoveProjectImage=function(a){return null!=a.projectImageIdToRemove&&this.projectService.currentProject.productContainsImageId(a.imageId)===!1},a.prototype._expectArgument=function(a,b){if(null==a)throw this._argumentError(b)},a.prototype._argumentError=function(a){return new Error("RemoveWellImageAndAdaptCommand invoked with missing argument")},a.prototype._removeWellImageOptions=function(a){return{imageId:a.imageId,uniqueProjectRef:a.uniqueProjectRef,pageNumber:a.pageNumber,beforeCommandPageNumber:a.beforeCommandPageNumber||this._beforeCommandPageNumber(),activePageNumber:a.pageNumber}},a.prototype._adaptPageOptions=function(a){return{pageNumber:a.pageNumber,layoutInfo:a.layoutInfo}},a.prototype._removeProjectImageOptions=function(a){return{bypassUseCountCheck:!0,productImageId:a.projectImageIdToRemove}},a.prototype._beforeCommandPageNumber=function(){return this.navService.selectedPage.surfaceNumber||this.projectService.currentProject.product.lastPage().surfaceNumber},a.prototype._page=function(){return this._book().pageBySurfaceNumber(this.adaptOptions.pageNumber)},a.prototype._book=function(){return this.projectService.currentProject.product},a.prototype.reverse=function(a,b){if(null!=this.removeProjectImageCommand&&(this.projectService.currentProject.imageCollection.usedImagesAdd(),this.removeProjectImageCommand.reverse(null,this.removeProjectImageOptions)),null!=this.adaptOptions&&this.adaptPageCommand.reverse(this._page(),this.adaptOptions),null!=this.removeWellImageCommand)return this.removeWellImageCommand.reverse(this._page(),this.removeWellImageOptions)},a}(),a.$inject=["projectService","commandFactory","eventBus","navService"],angular.module("galleon").value("RemoveWellImageAndAdaptCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e){this.projectService=a,this.project=b,this.imageCollection=c,this.eventBus=d,this.$timeout=e,this.type="custom",this.name="RemoveAllImagesCommand",this.isLongOperation=!0}return a.prototype.cacheProject=function(a,b,c){if(null==a[b])return a[b]={project:angular.toJson(c.values)}},a.prototype.execute=function(a,b){var c;return b.source?(c={projectImages:this.imageCollection.projectImages},this.projectService.currentProject=this.project.init(angular.fromJson(b.source.project)),this.projectService.currentProject.imageCollection.replaceImageCollection(c)):(this.activePageNumber=b.activePageNumber,this.selectedPageAfter=b.activePageNumber,this.cacheProject(b,"target",this.projectService.currentProject),this.projectService.currentProject.clearAllProductImages(),this.imageCollection.invalidateImageUseCounts()),this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.projectService.currentProject),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED)},a.prototype.reverse=function(a,b){var c;return b.source||this.cacheProject(b,"source",this.projectService.currentProject),c={projectImages:this.imageCollection.projectImages},this.projectService.currentProject=this.project.init(angular.fromJson(b.target.project)),this.projectService.currentProject.imageCollection.replaceImageCollection(c),this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.projectService.currentProject),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED)},a}(),a.$inject=["projectService","project","imageCollection","eventBus","$timeout"],angular.module("galleon").value("RemoveAllImagesCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.projectService=a,this.project=b,this.eventBus=c,this.calendarGridCellIteratorFactory=d,this.type="custom",this.name="RemoveEmptyGridAssetsCommand",this.isLongOperation=!0}return a.prototype.cacheProject=function(a,b,c){if(null==a[b])return a[b]={project:angular.toJson(c.values)}},a.prototype.execute=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;for(this.cacheProject(b,"target",this.projectService.currentProject),q=this.project.product.pages,t=[],m=0,o=q.length;m<o;m++)if(l=q[m],l.isGrid){for(h=this.calendarGridCellIteratorFactory.newInstance(l),d=[];h.next();)if(j=function(a,b){var c;return c=b[0],a.asset.assetType===a.asset.constructor.TEXT_TYPE&&a.asset.guidanceText==="event-"+c},k=function(a,b){var c;return c=b[0],a.asset.assetType===a.asset.constructor.IMAGE_TYPE&&a.uniqueProjectRef===c},h.currentDate())for(e=h.currentDate().day,f=[e],h.isSplitGridCell()&&f.push(e+7),n=0,p=f.length;n<p;n++)e=f[n],(g=null!=(r=h.findGridCellAsset(j,[e]))?r.asset:void 0)&&(i=null!=(s=h.findGridCellAsset(k,[g.associatedImage]))?s.asset:void 0,g.hasContent()||i.hasAssignedImage()||(d.push(g.asset),d.push(i.asset)));d.length>0?t.push(function(){var a,b,e;for(e=[],a=0,b=d.length;a<b;a++)c=d[a],e.push(l.removeAsset(c));return e}()):t.push(void 0)}return t},a.prototype.reverse=function(a,b){var c;if(null!=(c=b.target)?c.project:void 0)return this.projectService.currentProject=this.project.init(angular.fromJson(b.target.project)),this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.projectService.currentProject)},a}(),a.$inject=["projectService","project","eventBus","calendarGridCellIteratorFactory"],angular.module("galleon").value("RemoveEmptyGridAssetsCommand",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d){this.project=a,this.imageCollection=c,this.eventBus=d,this.reverse=b(this.reverse,this),this.type="custom",this.name="RemoveUnusedImagesCommand",this.isLongOperation=!0}return a.prototype.execute=function(a,b){var c;this.activePageNumber=b.activePageNumber,this.selectedPageAfter=b.activePageNumber,c=this.project.imageCollection,this.serialized={},null!=c&&(this.serialized=angular.toJson(c.removeUnusedImages()))},a.prototype.reverse=function(a,b){var c,d,e,f;for(c=angular.fromJson(this.serialized),e=0,f=c.length;e<f;e++)d=c[e],this.project.imageCollection.addImageAt(d,this.project.imageCollection.values.projectImages.length);this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.project),this.serialized=null},a}(),a.$inject=["project","imageCollection","eventBus"],angular.module("galleon").value("RemoveUnusedImagesCommand",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e){this.projectService=a,this.navService=c,this.eventBus=d,this.appState=e,
this.reverse=b(this.reverse,this),this.execute=b(this.execute,this),this.type="custom",this.name="RemoveAllEmbellishmentsCommand",this.isLongOperation=!0}return a.prototype.execute=function(a,b){var c,d,e,f,g;if(this.options=b,f=this.options.activePageNumber,d=this.options.isRemovingFromBook===!0,c=null!=(g=this.projectService.currentProject)?g.product:void 0,null!=c){if("redo"!==this.stage&&(this.serialized=angular.toJson(c.values)),d)this.projectService.removeAllStickers();else{if(e=c.pageBySurfaceNumber(f),null==e)return;this.navService.gotoPage(f),this.projectService.removeAllStickersFromPage(e),this.eventBus.publish(this.eventBus.events.SURFACE_EMBELLISHMENT_REMOVED,{pageNumber:f})}this.appState.isCustomizing()&&this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.projectService.currentProject)}},a.prototype.reverse=function(){var a,b;a=this.projectService.currentProject.product,b=a.guid,this.projectService.currentProject.product=a.init(angular.fromJson(this.serialized)),this.projectService.currentProject.product.guid=b,this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.projectService.currentProject),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED)},a}(),a.$inject=["projectService","navService","eventBus","appState"],angular.module("galleon").value("RemoveAllEmbellishmentsCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e){this.projectService=a,this.eventBus=b,this.layoutFactory=c,this.loggerFactory=d,this.storytellingAssetRegistry=e,this.isLongOperation=!0,this.type="page",this.name="AdaptPageCommand",this.logger=d.newInstance("AdaptPageCommand"),this.hasStorytellingChange=!1,this.adaptingSpread=void 0}return a.LAYOUT_TYPE_IDEA="ideapage",a.prototype._validateInput=function(a){if("number"!=typeof a.pageNumber)throw new Error("AdaptPageCommand requires a pageNumber in options")},a.prototype._adaptLayout=function(b,c){var d,e,f,g,h,i,j,k;if(e=b.layout.getBackgroundImageAssignment(),this._checkForStorytellingChange(b,c.layoutInfo),b.layoutName=c.layoutInfo.id,b.layoutVersion=c.layoutInfo.version,b.ideaLayout=(null!=(i=c.layoutInfo.attributes)?i.layoutType:void 0)===a.LAYOUT_TYPE_IDEA,b.layout=this.layoutFactory.newInstance(angular.copy(c.layoutInfo.content)),null!=e&&null!=(j=b.layout.values.assets)&&(j[0].imageAssignment=e),b.customLayout=!1,b.flippedLayout=!1,d=this._isAdaptNewImageCommand(c),!this.adaptingSpread&&d||this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:b.surfaceNumber}),d)for(k=c.imageIds,g=0,h=k.length;g<h;g++)f=k[g],this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_ADDED,{imageId:f,pageNumber:b.surfaceNumber});else this._hasUnassignedImages(c.layoutInfo)&&this._sendImageEvents(b,c.layoutInfo.unassignedImages,this.eventBus.events.SURFACE_IMAGE_REMOVED);if(c.backgroundContentGraphicAsset&&b.ideaLayout&&!b.isSpread()&&(b.getBackgrounds().forEach(function(a){return a.assignContentGraphicAsset(c.backgroundContentGraphicAsset,b.layout.generateContainerId())}),this.eventBus.publish(this.eventBus.events.SURFACE_BACKGROUND_UPDATED,{pageNumber:b.surfaceNumber})),this.hasStorytellingChange)return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a.prototype._checkForStorytellingChange=function(a,b){return this.hasStorytellingChange=a.hasStorytellingLayout(this.storytellingAssetRegistry)||this.storytellingAssetRegistry.hasAsset(b.id)||a.hasStorytellingAsset(this.storytellingAssetRegistry)},a.prototype._isAdaptNewImageCommand=function(a){return null!=a.imageId||Array.isArray(a.imageIds)},a.prototype._hasUnassignedImages=function(a){return a.unassignedImages&&a.unassignedImages.length>=0},a.prototype._sendImageEvents=function(a,b,c){var d,e,f,g;for(g=[],e=0,f=b.length;e<f;e++)d=b[e],g.push(this.eventBus.publish(c,{imageId:d.id,pageNumber:a.surfaceNumber}));return g},a.prototype.execute=function(a,b){return void 0===this.adaptingSpread&&(this.adaptingSpread=null!=a?a.isSpread():void 0),null!=b.imageId&&(Array.isArray(b.imageIds)||(b.imageIds=[]),b.imageIds.push(b.imageId)),this._validateInput(b),this._adaptLayout(a,b)},a.prototype.reverse=function(a,b){var c,d,e,f,g;if(this.projectService.currentProject.product.applyPageValuesObj(a.surfaceNumber,angular.fromJson(this.serialized)),c=this._isAdaptNewImageCommand(b),!this.adaptingSpread&&c||this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:b.pageNumber}),c)for(g=b.imageIds,e=0,f=g.length;e<f;e++)d=g[e],this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,{imageId:d,pageNumber:b.pageNumber});else this._hasUnassignedImages(b.layoutInfo)&&this._sendImageEvents(a,b.layoutInfo.unassignedImages,this.eventBus.events.SURFACE_IMAGE_ADDED);if(this.hasStorytellingChange)return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a}(),a.$inject=["projectService","eventBus","layoutFactory","loggerFactory","storytellingAssetRegistry"],angular.module("galleon").value("AdaptPageCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g,h){this.eventBus=a,this.eventsService=b,this.projectEvents=c,this.imageCollection=d,this.calendarEventsImageService=e,this.projectService=f,this.type="page",this.name="ApplyEventImageCommand",this.updateEventImageCommand=g.instantiate(h)}return a.prototype.execute=function(a,b){var c;if(this.serializedEvents=angular.toJson(this.projectEvents.values.eventCollection),this.lastProductImageID=this.imageCollection.lastProductImageID,this.eventCopy=angular.copy(b.event),this.event=angular.copy(b.event),this.event.imageMediaId=b.imageMediaId||null,this.event.imageView=b.imageView||null,this.event.projectImageId=b.projectImageId||null,null===this.event.imageMediaId&&this.calendarEventsImageService.clearImportedEventCacheForEvent(this.event),c=this.projectEvents.getImageAssociation(this.event.id),this.calendarEventsImageService.reassignSelectedEventPhoto(this.event),null===this.event.imageMediaId&&null!=c?(this.projectEvents.removeImageAssociation(this.event.id),this.projectEvents.updateEvent(this.event)):this._updateEvent(this.event,c),this.eventsService.updateEvent(this.event,!0),this._modifyGridEventsMatchingEvent(this.event),this.calendarEventsImageService.reassignUpdatedEventPhoto(this.event),this.eventBus.publish(this.eventBus.events.CALENDAR_EVENT_UPDATED,this.event),this.event.isSelected)return this.updateEventImageCommand.execute(a,b)},a.prototype._modifyGridEventsMatchingEvent=function(a){var b,c;return c=this.projectEvents.eventsMatchingEventDate(a),b=new Date(a.year,a.month-1,a.day),this.projectService.currentProject.product.setEventsOnDate(c,b)},a.prototype._updateEvent=function(a,b){return null!=b?this.projectEvents.updateImageAssociation(a.id,{imageMediaId:a.imageMediaId,imageView:a.imageView,projectImageId:a.projectImageId}):this.projectEvents.addImageAssociation(a.id,{imageMediaId:a.imageMediaId,imageView:a.imageView,projectImageId:a.projectImageId})},a.prototype.reverse=function(a,b){var c,d,e,f,g;if(this.eventCopy){for(this.eventsService.updateEvent(this.eventCopy),this.projectService.currentProject.product.applyPageValuesObj(a.surfaceNumber,angular.fromJson(this.serialized)),g=this.imageCollection.projectImages,d=e=0,f=g.length;e<f;d=++e)c=g[d],c.productImageID>this.lastProductImageID&&this.imageCollection.removeImage(d);return this.projectService.currentProject.values.eventCollection=angular.fromJson(this.serializedEvents),this.projectEvents.init(this.projectService.currentProject.values),this.eventsService.loadProjectEvents(),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:a.surfaceNumber}),this.eventBus.publish(this.eventBus.events.CALENDAR_EVENT_UPDATED,this.eventCopy)}},a}(),a.$inject=["eventBus","eventsService","projectEvents","imageCollection","calendarEventsImageService","projectService","$injector","UpdateEventImageCommand"],angular.module("galleon").value("ApplyEventImageCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.projectService=a,this.eventBus=b,this.layoutFactory=c,this.isLongOperation=!1,this.type="page",this.name="ApplyLayoutCommand",this.logger=d.newInstance("ApplyLayoutCommand")}return a.prototype.execute=function(a,b){return this._validateInput(b),this._applyLayout(a,b)},a.prototype._validateInput=function(a){if("number"!=typeof a.pageNumber)throw new Error("Options for ApplyLayoutCommand must include a pageNumber");if(null==a.layout)throw new Error("Options for ApplyLayoutCommand must include layout JSON")},a.prototype._applyLayout=function(a,b){return a.layout=this.layoutFactory.newInstance(b.layout),b.toggleFlippedLayout&&(a.flippedLayout=!a.flippedLayout),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:a.surfaceNumber})},a.prototype.reverse=function(a,b){return this.projectService.currentProject.product.applyPageValuesObj(a.surfaceNumber,angular.fromJson(this.serialized)),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:b.pageNumber})},a}(),a.$inject=["projectService","eventBus","layoutFactory","loggerFactory"],angular.module("galleon").value("ApplyLayoutCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.projectService=a,this.commandFactory=b,this.eventBus=c,this.navService=d,this.type="custom",this.name="AddWellImageAndEnsureNoEmptyWellCommand"}return a.prototype.execute=function(a,b){return this._validateOptions(b),this._setUpOptions(b),this._executeCommands(b)},a.prototype._validateOptions=function(a){return this._expectArgument(a,"options"),this._expectArgument(a.source,"options.source"),this._expectArgument(a.pageNumber,"options.pageNumber"),this._expectArgument(a.layoutInfo,"options.layoutInfo")},a.prototype._setUpOptions=function(a){if(null==this.addWellImageOptions&&(this.addWellImageOptions=this._addWellImageOptions(a)),null==this.adaptOptions)return this.adaptOptions=this._adaptPageOptions(a)},a.prototype._executeCommands=function(a){var b,c;return null==this.adaptPageCommand&&(this.adaptPageCommand=this.commandFactory.getInstance("AdaptPageCommand",this.adaptOptions)),this.adaptPageCommand.execute(this._page(),this.adaptOptions),null==this.addWellImageCommand&&(b=this._page().getEmptyImageWells(),c=b[0],c&&(this.addWellImageOptions.target={imageId:c.imageId,uniqueProjectRef:c.uniqueProjectRef}),this.addWellImageCommand=this.commandFactory.getInstance("AddWellImageCommand",this.addWellImageOptions)),this.addWellImageCommand.execute(this._page(),this.addWellImageOptions)},a.prototype._expectArgument=function(a,b){if(null==a)throw this._argumentError(b)},a.prototype._argumentError=function(a){return new Error("AddWellImageAndEnsureNoEmptyWellCommand invoked with missing argument")},a.prototype._addWellImageOptions=function(a){return{source:a.source,pageNumber:a.pageNumber,beforeCommandPageNumber:a.beforeCommandPageNumber||this._beforeCommandPageNumber(),activePageNumber:a.pageNumber}},a.prototype._adaptPageOptions=function(a){return{pageNumber:a.pageNumber,layoutInfo:a.layoutInfo}},a.prototype._beforeCommandPageNumber=function(){return this.navService.selectedPage.surfaceNumber||this.projectService.currentProject.product.lastPage().surfaceNumber},a.prototype._page=function(){return this._book().pageBySurfaceNumber(this.adaptOptions.pageNumber)},a.prototype._book=function(){return this.projectService.currentProject.product},a.prototype.reverse=function(a,b){if(null!=this.addWellImageCommand&&this.addWellImageCommand.reverse(this._page(),this.addWellImageOptions),null!=this.adaptOptions)return this.adaptPageCommand.reverse(this._page(),this.adaptOptions)},a}(),a.$inject=["projectService","commandFactory","eventBus","navService"],angular.module("galleon").value("AddWellImageAndEnsureNoEmptyWellCommand",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d){this.contentService=a,this.imageAssetFactory=c,this.eventBus=d,this.afterReverse=b(this.afterReverse,this),this.type="page",this.name="AddNewImageWellCommand"}return a.prototype.execute=function(a,b){var c,d;if(!(a&&b&&b.pageNumber&&b.width&&b.height))throw new Error("Invalid argument!");return c=this.contentService.createImageArea(a.layout.generateContainerId(),a.layout.nextSeqNum("image"),b),a.customLayout=!0,d=this.imageAssetFactory.newInstance(c),a.layout.addAsset(d),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_ADDED,{imageId:b.image.imageId,pageNumber:b.pageNumber}),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:b.pageNumber})},a.prototype.afterReverse=function(a){return this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,{pageNumber:a.surfaceNumber,imageId:this.options.image.imageId})},a}(),a.$inject=["contentService","imageAssetFactory","eventBus"],angular.module("galleon").value("AddNewImageWellCommand",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d){this.contentService=a,this.imageAssetFactory=c,this.eventBus=d,this.afterReverse=b(this.afterReverse,this),this.type="page",this.name="AddNewEmptyWellCommand"}return a.prototype.execute=function(a,b){var c,d;if(!(a&&b&&b.pageNumber&&b.width&&b.height))throw new Error("Invalid argument!");return c=this.contentService.createEmptyImageArea(a.layout.generateContainerId(),a.layout.nextSeqNum("image"),b),a.customLayout=!0,d=this.imageAssetFactory.newInstance(c),a.layout.addAsset(d),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:b.pageNumber})},a.prototype.afterReverse=function(a){return this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,{pageNumber:a.surfaceNumber})},a}(),a.$inject=["contentService","imageAssetFactory","eventBus"],angular.module("galleon").value("AddNewEmptyWellCommand",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f){this.projectService=a,this.eventBus=c,this.autofill=d,this.modelAdapter=e,this.imageCollection=f,this._applyNewCropValues=b(this._applyNewCropValues,this),this.type="page",this.name="SwapWellImageCommand"}return a.prototype.execute=function(a,b){var c,d,e,f,g,h,i,j,k,l,m;if(!(a&&angular.isArray(a)&&b&&b.source&&b.target))throw new Error("Invalid argument!");if(k=a[0],j={},i=null,l=b.source.uniqueProjectRef,k.isStockCover?(j=k.getInlayImage(),i=k.getImageById(l)):j=k.getImageById(l),null!=j&&(m=j.imageAssignment,null!=m&&(e=a[1],f={},d=null,g=b.target.uniqueProjectRef,e.isStockCover?(f=e.getInlayImage(),d=e.getImageById(g)):f=e.getImageById(g),null!=f)))return h=f.imageAssignment,k.removeImage(l),e.removeImage(g),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,{pageNumber:b.pageNumber[0],imageId:b.source.imageId,uniqueProjectRef:b.source.uniqueProjectRef}),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,{pageNumber:b.pageNumber[1],imageId:b.target.imageId,uniqueProjectRef:b.target.uniqueProjectRef}),b.overrideCropValues?(m.llx=""+b.overrideCropValues.llx,m.lly=""+b.overrideCropValues.lly,m.urx=""+b.overrideCropValues.urx,m.ury=""+b.overrideCropValues.ury):this._applyNewCropValues(m,f.asset),f.assignImage(m),null!=d&&(d.removeImageAssignment(),c=angular.copy(m),d.assignImage(c)),null!=h&&(this._applyNewCropValues(h,j.asset),j.assignImage(h),null!=i&&(i.removeImageAssignment(),c=angular.copy(h),i.assignImage(c))),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_ADDED,{pageNumber:b.pageNumber[1],imageId:b.source.imageId,uniqueProjectRef:b.source.uniqueProjectRef}),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_ADDED,{pageNumber:b.pageNumber[0],imageId:b.target.imageId,uniqueProjectRef:b.target.uniqueProjectRef}),this.beforeCommandPageNumber=b.pageNumber[0],this.activePageNumber=b.pageNumber[1]},a.prototype.reverse=function(a,b){var c,d,e,f;for(c=e=0,f=a.length;e<f;c=++e)d=a[c],this.projectService.currentProject.product.applyPageValuesObj(d.surfaceNumber,angular.fromJson(this.serialized[c]));return this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,{pageNumber:b.pageNumber[1],imageId:b.source.imageId,uniqueProjectRef:b.source.uniqueProjectRef}),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,{pageNumber:b.pageNumber[0],imageId:b.target.imageId,uniqueProjectRef:b.target.uniqueProjectRef}),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_ADDED,{pageNumber:b.pageNumber[0],imageId:b.source.imageId,uniqueProjectRef:b.source.uniqueProjectRef}),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_ADDED,{pageNumber:b.pageNumber[1],imageId:b.target.imageId,uniqueProjectRef:b.target.uniqueProjectRef})},a.prototype._applyNewCropValues=function(a,b){var c,d,e,f,g;return g={llx:a.llx,lly:a.lly,urx:a.urx,ury:a.ury},c={width:b.containerWidth,height:b.containerHeight},d=this.imageCollection.getImageByImageId(a.id),e=this.modelAdapter.getImageDimension(d,a.rotation),f=this.autofill.utils.CropUtil.expandCropForArea(e,g,c),this.modelAdapter.applyCrop(a,f)},a}(),a.$inject=["projectService","eventBus","autofill","modelAdapter","imageCollection"],angular.module("galleon").value("SwapWellImageCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f){this.projectService=a,this.eventBus=b,this.project=c,this.imageCollection=d,this.helper=e,this.config=f,this.TITLE_PAGE_NUMBER=1,this.type="custom",this.name="AutofillBlankBookCommand",this.isLongOperation=!0}return a.prototype.execute=function(a,b){var c,d,e,f,g;if(d=this.project.init(angular.fromJson(b.target.project)),this.projectService.currentProject=d,f={title:b.bookProperties.title,projectID:b.bookProperties.projectId,projectGUID:b.bookProperties.projectGuid,product:{guid:b.bookProperties.bookGuid},reportingData:b.reportingData},this.helper.copyProjectMetadata(f,d),d.imageCollection.mergeImageCollection(b.imageCollection),this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.projectService.currentProject),this.eventBus.publish(this.eventBus.events.START_UPLOADS),b.beforeCommandPageNumber&&b.beforeCommandPageNumber>this.projectService.currentProject.product.pages.length&&(this.activePageNumber=this.TITLE_PAGE_NUMBER,this.selectedPageAfter=this.projectService.currentProject.product.pageBySurfaceNumber(this.activePageNumber)),c=this.config.defaults.constraints.GroupCountConstraint.max,g=b.images.length,e=g-this.projectService.currentProject.product.numTotalImages,e>0&&this.projectService.currentProject.product.pages.length===c)return this.eventBus.publish(this.eventBus.events.AUTOFILL_UNPLACED_IMAGES,{numPlaced:this.projectService.currentProject.product.numTotalImages,numUnplaced:e})},a.prototype.reverse=function(a,b){return this.helper.doReverse(b)},a}(),a.$inject=["projectService","eventBus","project","imageCollection","AbstractAutofillCommand","CONFIG"],angular.module("galleon").value("AutofillBlankBookCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e){this.projectService=a,this.eventBus=b,this.imageCollection=c,this.project=d,this.helper=e,this.type="custom",this.name="AutofillFilledBookCommand",this.isLongOperation=!0}return a.prototype.execute=function(a,b){var c;return c=this.projectService.currentProject,a=c.product,b.cannotAutofill?void this.eventBus.publish(this.eventBus.events.AUTOFILL_UNPLACED_IMAGES,{numPlaced:0,numUnplaced:b.images.length}):(this._insertAutofillPages(b.data,a,b),this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,c),this.eventBus.publish(this.eventBus.events.START_UPLOADS))},a.prototype._insertAutofillPages=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n;for(f=b.pages.length,e=f,d=j=m=e-1;j>=1&&b.pages[d].isAutofillable();d=j+=-1)e=b.pages[d-1].isSpread()?d+1:d;for(n=a.pages,k=0,l=n.length;k<l;k++)g=n[k],e<f?(h=e+1,g.surfaceNumber=""+h,g.layout.displayPageNumber="false",b.applyPageValuesObj(h,g),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED,{pageNumber:h,redrawRequired:!0}),e++):b.addPage(g);if(a.unusedImages.length>0)return i=c.images.length-a.unusedImages.length,this.eventBus.publish(this.eventBus.events.AUTOFILL_UNPLACED_IMAGES,{numPlaced:i,numUnplaced:a.unusedImages.length})},a.prototype.reverse=function(a,b){return this.helper.doReverse(b)},a}(),a.$inject=["projectService","eventBus","imageCollection","project","AbstractAutofillCommand"],angular.module("galleon").value("AutofillFilledBookCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.projectService=a,this.navService=b,this.eventBus=c,this.type="custom",this.name="MovePageCommand",this.isLongOperation=!0}return a.prototype.execute=function(a,b){var c,d,e,f;for(f=b.move,d=0,e=f.length;d<e;d++)c=f[d],this.projectService.currentProject.product.movePageTo(c.currentPageNumber,c.finalPageNumber);return this.navService.gotoPage(b.activePageNumber),this.dispatchInvalidatedEvent(b)},a.prototype.reverse=function(a,b){var c,d,e,f;for(d=e=f=b.move.length-1;f<=0?e<=0:e>=0;d=f<=0?++e:--e)c=b.move[d],this.projectService.currentProject.product.movePageTo(c.finalPageNumber,c.currentPageNumber);return this.navService.gotoPage(b.beforeCommandPageNumber),this.dispatchInvalidatedEvent(b,!0)},a.prototype.dispatchInvalidatedEvent=function(a,b){var c,d,e,f,g;for(null==b&&(b=!1),f=a.move,g=[],d=0,e=f.length;d<e;d++)c=f[d],this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED,{pageNumber:c.currentPageNumber}),g.push(this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED,{pageNumber:c.finalPageNumber,autoMoved:!b&&c.autoMoved}));return g},a}(),a.$inject=["projectService","navService","eventBus"],angular.module("galleon").value("MovePageCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a){this.projectService=a,this.type="custom",this.name="RemovePaletteImageCommand"}return a.prototype.execute=function(a,b){var c,d,e,f,g,h,i;if(null==(null!=b?b.productImageId:void 0))throw new Error("Invalid argument!");for(d=this.projectService.currentProject.imageCollection,f=d.projectImages,i=[],e=g=0,h=f.length;g<h;e=++g)if(c=f[e],c.productImageID===b.productImageId){if(b.bypassUseCountCheck===!0||0===c.useCount){null==b.image&&(b.index=e,b.image=c.projectData),d.removeImage(e);break}i.push(void 0)}return i},a.prototype.reverse=function(a,b){var c;return c=this.projectService.currentProject.imageCollection,c.addImageAt(b.image,b.index)},a}(),a.$inject=["projectService"],angular.module("galleon").value("RemovePaletteImageCommand",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e){this.projectService=a,this.navService=c,this.eventBus=d,this.bookModel=e,this.reverse=b(this.reverse,this),this.execute=b(this.execute,this),this.type="custom",this.name="AddPagesCommand",this.isLongOperation=!0}return a.prototype.execute=function(a,b){var c,d,e;for(this.options=b,a=this.projectService.currentProject.product,a.addPagesAtPosition(angular.copy(this.options.add.pages),this.options.add.addAtPageNumber),this.navService.gotoPage(this.options.add.addAtPageNumber),this.eventBus.publish(this.eventBus.events.PROJECT_MODIFIED,this.projectService.currentProject),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED),c=this.options.add.addAtPageNumber,d=this.options.add.addAtPageNumber+this.options.add.pages.length,e=c;e<d;)this.eventBus.publish(this.eventBus.events.SURFACE_ADDED,a.pageBySurfaceNumber(e)),e++;return this.eventBus.publish(this.eventBus.events.SURFACES_ADDED,{from:c,toInclusive:d-1})},a.prototype.reverse=function(){var a,b,c,d;for(b=this.options.add.addAtPageNumber-1,c=this.options.add.addAtPageNumber+this.options.add.pages.length-1,a=this.projectService.currentProject.product,d=c;b<d;)this.eventBus.publish(this.eventBus.events.SURFACE_REMOVED,a.pageBySurfaceNumber(d)),a.removePage(d),d--;return this.eventBus.publish(this.eventBus.events.SURFACES_REMOVED,{from:b+1,toInclusive:c}),this.navService.gotoPage(this.options.beforeCommandPageNumber),this.eventBus.publish(this.eventBus.events.PROJECT_MODIFIED,this.projectService.currentProject),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED)},a}(),a.$inject=["projectService","navService","eventBus","book"],angular.module("galleon").value("AddPagesCommand",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e){this.navService=a,this.projectService=c,this.eventBus=d,this.storytellingAssetRegistry=e,this.execute=b(this.execute,this),this.type="custom",this.name="RemovePageCommand",this.isLongOperation=!0,this.addedEndPagesCount=0,this.removedPagesValues=[],this.movedPages=[],this.hasStorytellingChange=!1}return a.prototype._fixSpreadsPosition=function(){var a,b,c,d,e,f,g,h;for(c=null,e=!1,a=this.projectService.currentProject.product,b=f=g=this.options.removeOptions.removeAtPageNumber,h=a.pages.length+1;g<=h?f<h:f>h;b=g<=h?++f:--f)if(e)e=!1;else{if(d=a.pageBySurfaceNumber(b),!d)return;d.isSpread()?(c||(c=b),e=!0):c&&(this.movedPages.push({from:b,to:c}),a.movePageTo(b,c),c=null)}},a.prototype.execute=function(a,b){var c,d,e,f,g;for(this.options=b,this.removedPagesValues=[],this.movedPages=[],a=this.projectService.currentProject.product,(null!=(f=this.options.removeOptions.replacementPages)?f.length:void 0)&&(this.addedEndPagesCount=this.options.removeOptions.replacementPages.length,a.addPagesAtPosition(this.options.removeOptions.replacementPages,a.pages.length+1)),c=e=0,g=this.options.removeOptions.numOfPagesToRemove;0<=g?e<g:e>g;c=0<=g?++e:--e)d=a.pageBySurfaceNumber(this.options.removeOptions.removeAtPageNumber),this.hasStorytellingChange||this._checkForStorytellingChange(d),this.removedPagesValues.push(angular.copy(d.values)),a.removePage(this.options.removeOptions.removeAtPageNumber),this.eventBus.publish(this.eventBus.events.SURFACE_REMOVED,d);if(this.options.removeOptions.numOfPagesToRemove%2&&this._fixSpreadsPosition(),this.eventBus.publish(this.eventBus.events.SURFACES_REMOVED,{from:this.options.removeOptions.removeAtPageNumber,toInclusive:this.options.removeOptions.removeAtPageNumber+(this.options.removeOptions.numOfPagesToRemove-1)}),this.navService.gotoPage(this.options.removeOptions.removeAtPageNumber,!0),this.eventBus.publish(this.eventBus.events.PROJECT_MODIFIED,this.projectService.currentProject),this.hasStorytellingChange)return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a.prototype._checkForStorytellingChange=function(a){return this.hasStorytellingChange=a.hasStorytellingLayout(this.storytellingAssetRegistry)||a.hasStorytellingAsset(this.storytellingAssetRegistry)},a.prototype.reverse=function(a,b){var c,d,e,f,g,h,i,j,k,l;for(a=this.projectService.currentProject.product,j=this.movedPages,f=0,i=j.length;f<i;f++)e=j[f],a.movePageTo(e.to,e.from);for(a.addPagesAtPosition(this.removedPagesValues,this.options.removeOptions.removeAtPageNumber),d=g=0,k=this.addedEndPagesCount;0<=k?g<k:g>k;d=0<=k?++g:--g)a.removePage(a.lastPage().surfaceNumber);for(d=h=0,l=this.removedPagesValues.length;0<=l?h<l:h>l;d=0<=l?++h:--h)c=a.pageBySurfaceNumber(this.options.removeOptions.removeAtPageNumber+d),this.eventBus.publish(this.eventBus.events.SURFACE_ADDED,c);if(this.eventBus.publish(this.eventBus.events.SURFACES_ADDED,{from:this.options.removeOptions.removeAtPageNumber,toInclusive:this.options.removeOptions.removeAtPageNumber+(this.removedPagesValues.length-1)}),this.navService.gotoPage(this.options.removeOptions.removeAtPageNumber,!0),this.eventBus.publish(this.eventBus.events.PROJECT_MODIFIED,this.projectService.currentProject),this.hasStorytellingChange)return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a}(),a.$inject=["navService","projectService","eventBus","storytellingAssetRegistry"],angular.module("galleon").value("RemovePageCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e){this.commandService=a,this.projectService=b,this.config=c,this.eventBus=d,this.$timeout=e,this.eventBus.subscribe(this.eventBus.events.PROJECT_LOADED,function(a){return function(b,c){return a.project=c}}(this))}return a.prototype.remove=function(a,b){var c;if(null==b&&(b=1),null==a)throw new Error("surfaceNumber must be provided to remove a page");return c=parseInt(this.config.defaults.minPages,10)-(this.project.product.pages.length-b),c<=0&&b%2&&this.projectService.currentProject.product.lastPageIsSpread()&&(c=1),c>0?this.projectService.innerPages([],this.project.product.styleId,this.project.product.styleContentVersion,this.project.product.cover.coverSpecID,this.project.product.cover.binding,null,c,c,this.project.product.cover.stockCoverSpecID).then(function(c){return function(d){return c._executeRemoveCommand(a,b,d.pages)}}(this)):this._executeRemoveCommand(a,b)},a.prototype._executeRemoveCommand=function(a,b,c){return null==c&&(c=[]),this.commandService.execute("RemovePageCommand",{removeOptions:{replacementPages:c,removeAtPageNumber:a,numOfPagesToRemove:b},beforeCommandPageNumber:a,activePageNumber:a})},a}(),a.$inject=["commandService","projectService","CONFIG","eventBus","$timeout"],angular.module("galleon").service("removePageOperation",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.eventBus=a,this.eventsService=b,this.projectEvents=c,this.calendarEventsImageService=d,this.type="custom",this.name="SwapEventImageCommand"}return a.prototype.execute=function(a,b){if(!b.sourceEvent||!b.targetEvent)throw new Error("Invalid options");return this._swapImageAssociations(b.sourceEvent,b.targetEvent),this.eventBus.publish(this.eventBus.events.CALENDAR_EVENT_UPDATED),this._updateGridCellImage(b.sourceEvent,b.targetEvent)},a.prototype._swapImageAssociations=function(a,b){var c,d;return c=angular.copy(this.projectEvents.getImageAssociation(a.id)),d=angular.copy(this.projectEvents.getImageAssociation(b.id)),b=angular.copy(b),b.imageMediaId=null!=c?c.imageMediaId:void 0,b.imageView=null!=c?c.imageView:void 0,b.projectImageId=null!=c?c.projectImageId:void 0,this._updateEvent(b),a=angular.copy(a),a.imageMediaId=null!=d?d.imageMediaId:void 0,a.imageView=null!=d?d.imageView:void 0,a.projectImageId=null!=d?d.projectImageId:void 0,this._updateEvent(a)},a.prototype._updateEvent=function(a){return null!=a.projectImageId?this.projectEvents.getImageAssociation(a.id)?this.projectEvents.updateImageAssociation(a.id,{imageMediaId:a.imageMediaId,imageView:a.imageView,projectImageId:a.projectImageId}):this.projectEvents.addImageAssociation(a.id,{imageMediaId:a.imageMediaId,imageView:a.imageView,projectImageId:a.projectImageId}):(this.projectEvents.removeImageAssociation(a.id),a.imageMediaId=a.imageView=null,delete a.projectImageId),this.eventsService.updateEvent(a)},a.prototype._updateGridCellImage=function(a,b){var c;if(b.isSelected||a.isSelected)return(null!=(c=this.projectEvents.getImageAssociation(b.id))?c.active:void 0)===!0?this.calendarEventsImageService.setGridCellImage(b):this.calendarEventsImageService.setGridCellImage(a)},a.prototype.reverse=function(a,b){return this._swapImageAssociations(b.sourceEvent,b.targetEvent),this._updateGridCellImage(b.sourceEvent,b.targetEvent),this.eventBus.publish(this.eventBus.events.CALENDAR_EVENT_UPDATED)},a}(),a.$inject=["eventBus","eventsService","projectEvents","calendarEventsImageService"],angular.module("galleon").value("SwapEventImageCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e){this.helper=a,this.projectService=b,this.eventBus=c,this.navService=d,this.$timeout=e,this.type="custom",this.name="UndoAutofillCommand",this.isLongOperation=!0}return a.prototype.execute=function(a,b){var c,d,e;return this.activePageNumber=this.navService.selectedPage.surfaceNumber,c=null!=(null!=(e=b.target)?e.project:void 0),c&&(d={projectImages:this.projectService.currentProject.imageCollection.projectImages
},this.helper.reconstituteProjectFromJson(b.target.project),this.projectService.currentProject.imageCollection.replaceImageCollection(d),this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.projectService.currentProject)),delete b.target},a.prototype.reverse=function(a,b){var c;return this.activePageNumber=this.navService.selectedPage.surfaceNumber,this.helper.doReverse(b),c=angular.fromJson(b.target.project),this.helper.copyProjectMetadata(c,this.projectService.currentProject),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED,{pageNumber:this.activePageNumber})},a}(),a.$inject="AbstractAutofillCommand projectService eventBus navService $timeout".split(" "),angular.module("galleon").value("UndoAutofillCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a){this.eventBus=a,this.type="page",this.name="UpdateTextCommand"}return a.prototype.execute=function(a,b){var c;if(null==(null!=a?a.surfaceNumber:void 0))throw new Error("Target is not a valid instance of Page.");if(!this._optionsValid(b))throw new Error("Invalid options given.");if(c=this._fetchAssetByIndex(a,b.assetIndex),"text"!==c.asset.assetType)throw new Error("Target asset should have assetType 'text' but was '"+c.asset.assetType+"'");return c.updateTextWithWrapsAndStyle(b.text,b.wraps,b.hasOverflow,b.style),this._executeToggleEventTextBackgroundFn(a,c,b),this.eventBus.publish(this.eventBus.events.SURFACE_TEXT_UPDATED,{pageNumber:b.pageNumber,asset:c})},a.prototype._executeToggleEventTextBackgroundFn=function(a,b,c){var d,e,f,g,h,i,j,k,l,m;if(null!=c.toggleEventTextBackgroundFn&&(i=a.indexOfAsset(b),i>0)){if(j=c.toggleEventTextBackgroundFn(),j.removed)return void a.removeAssetAtIndex(i-1);for(m=j.gridCellAssets,h=k=0,l=m.length;k<l;h=++k)if(d=m[h],d===b.values){f=h;break}if(null!=(e=j.gridCellAssets[f-1]))return a.addAsset({values:e}),g=a.layout.assets.length-1,a.moveAssetAtIndex(g,i)}},a.prototype._fetchAssetByIndex=function(a,b){var c;return null!=a&&null!=(c=a.layout)?c.assets[b]:void 0},a.prototype._optionsValid=function(a){return null!=a&&"object"==typeof a&&("string"==typeof a.text&&Array.isArray(a.wraps)&&"boolean"==typeof a.hasOverflow&&"object"==typeof a.style&&"number"==typeof a.assetIndex&&"number"==typeof a.pageNumber)},a}(),a.$inject=["eventBus"],angular.module("galleon").value("UpdateTextCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.projectService=a,this.commandFactory=b,this.type="custom",this.name="MoveWellImageCommand",this.rememberActionPage=!0}return a.prototype.execute=function(a,b){if(b.originPageNumber===b.targetPageNumber&&null!=b.originPageNumber&&b.targetPageNumber)throw new Error("Cannot move image to same page");if(!this._optionsValid(b)&&null==this.adaptOptions)throw new Error("Invalid options given");return this._setUpOptions(b),this._createCommands(),this._executeCommands(b)},a.prototype._setUpOptions=function(a){return null==this.adaptOptions&&(this.adaptOptions=this._adaptPageOptions(a)),null==this.removeWellOptions&&(this.removeWellOptions=this._removeWellOptions(a)),this.beforeCommandPageNumber=a.originPageNumber,this.activePageNumber=a.targetPageNumber},a.prototype._createCommands=function(){if(null==this.adaptPageCommand&&(this.adaptPageCommand=this.commandFactory.getInstance("AdaptPageCommand",this.adaptOptions)),null==this.removeWellImageCommand)return this.removeWellImageCommand=this.commandFactory.getInstance("RemoveWellImageCommand",this.removeWellOptions)},a.prototype._executeCommands=function(a){var b;return b=this.projectService.currentProject.product,this.adaptPageCommand.stage=this.stage,this.removeWellImageCommand.stage=this.stage,this.adaptPageCommand.execute(b.pageBySurfaceNumber(a.targetPageNumber),this.adaptOptions),this.removeWellImageCommand.execute(b.pageBySurfaceNumber(a.originPageNumber),this.removeWellOptions)},a.prototype._removeWellOptions=function(a){return{imageId:a.imageAsset.imageId,uniqueProjectRef:a.imageAsset.uniqueProjectRef,pageNumber:a.originPageNumber}},a.prototype._adaptPageOptions=function(a){return{pageNumber:a.targetPageNumber,imageId:a.imageAsset.imageId,layoutInfo:a.layoutInfo}},a.prototype._optionsValid=function(a){var b,c;return null!=a&&"object"==typeof a&&("number"==typeof a.originPageNumber&&"number"==typeof a.targetPageNumber&&null!=(null!=(b=a.imageAsset)?b.uniqueProjectRef:void 0)&&null!=(null!=(c=a.imageAsset)?c.imageId:void 0)&&"object"==typeof a.layoutInfo)},a.prototype.reverse=function(a,b){return a=this.projectService.currentProject.product,this.removeWellImageCommand.reverse(a.pageBySurfaceNumber(b.originPageNumber),this.removeWellOptions),this.adaptPageCommand.reverse(a.pageBySurfaceNumber(b.targetPageNumber),this.adaptOptions)},a}(),a.$inject=["projectService","commandFactory"],angular.module("galleon").value("MoveWellImageCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.projectService=a,this.commandFactory=b,this.eventBus=c,this.navService=d,this.type="custom",this.name="MoveStoryBoardPageImageCommand"}return a.prototype.execute=function(a,b){return this._validateOptions(b),this._setUpOptions(b),this._executeCommands(b)},a.prototype._validateOptions=function(a){return this._expectArgument(a,"options"),this._expectArgument(a.targetPageNumber,"options.targetPageNumber"),this._expectArgument(a.originPageNumber,"options.originPageNumber"),this._expectArgument(a.imageAsset,"options.imageAsset"),this._expectArgument(a.targetPageLayoutInfo,"options.targetPageLayoutInfo"),this._expectArgument(a.sourcePageLayoutInfo,"options.sourcePageLayoutInfo")},a.prototype._setUpOptions=function(a){if(null==this.moveWellImageOptions&&(this.moveWellImageOptions=this._moveWellImageOptions(a)),null==this.adaptOptions)return this.adaptOptions=this._adaptPageOptions(a)},a.prototype._executeCommands=function(a){return null==this.moveWellImageCommand&&(this.moveWellImageCommand=this.commandFactory.getInstance("MoveWellImageCommand",this.moveWellImageOptions)),this.moveWellImageCommand.execute(this._book(),this.moveWellImageOptions),null==this.adaptPageCommand&&(this.adaptPageCommand=this.commandFactory.getInstance("AdaptPageCommand",this.adaptOptions)),this.adaptPageCommand.execute(this._page(),this.adaptOptions)},a.prototype._expectArgument=function(a,b){if(null==a)throw this._argumentError(b)},a.prototype._argumentError=function(a){return new Error("MoveStoryBoardPageImageCommand invoked with missing argument")},a.prototype._moveWellImageOptions=function(a){return{activePageNumber:a.targetPageNumber,originPageNumber:a.originPageNumber,targetPageNumber:a.targetPageNumber,imageAsset:a.imageAsset,layoutInfo:a.targetPageLayoutInfo}},a.prototype._adaptPageOptions=function(a){return{pageNumber:a.originPageNumber,layoutInfo:a.sourcePageLayoutInfo}},a.prototype._page=function(){return this._book().pageBySurfaceNumber(this.adaptOptions.pageNumber)},a.prototype._book=function(){return this.projectService.currentProject.product},a.prototype.reverse=function(a,b){if(null!=this.adaptOptions&&this.adaptPageCommand.reverse(this._page(),this.adaptOptions),null!=this.moveWellImageCommand)return this.moveWellImageCommand.reverse(this._book(),this.moveWellImageOptions)},a}(),a.$inject=["projectService","commandFactory","eventBus","navService"],angular.module("galleon").value("MoveStoryBoardPageImageCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.projectService=a,this.eventBus=b,this.storytellingAssetRegistry=c,this.type="page",this.name="RemoveEmbellishmentCommand"}return a.prototype.execute=function(a,b){if(!(a&&b&&b.offsets&&b.uniqueProjectRef))throw new Error("Invalid argument!");if(a.customLayout=!0,this.activePageNumber=b.pageNumber,a.removeGraphic(b.containerId,b.assetId,b.offsets),this.eventBus.publish(this.eventBus.events.SURFACE_EMBELLISHMENT_REMOVED,{pageNumber:b.pageNumber,offsets:b.offsets,uniqueProjectRef:b.uniqueProjectRef}),this.storytellingAssetRegistry.hasAsset(b.uniqueProjectRef))return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a.prototype.reverse=function(a,b){if(this.projectService.currentProject.product.applyPageValuesObj(a.surfaceNumber,angular.fromJson(this.serialized)),this.eventBus.publish(this.eventBus.events.SURFACE_EMBELLISHMENT_ADDED,{pageNumber:b.pageNumber,offsets:b.offsets,uniqueProjectRef:b.uniqueProjectRef}),this.storytellingAssetRegistry.hasAsset(b.uniqueProjectRef))return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a}(),a.$inject=["projectService","eventBus","storytellingAssetRegistry"],angular.module("galleon").value("RemoveEmbellishmentCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.commandFactory=a,this.eventBus=b,this.storytellingAssetRegistry=c,this.type="page",this.name="ObjectsModifiedCommand",this.isLongOperation=!1}return a.prototype.execute=function(a,b){var c,d,e,f,g,h;for(this.page=a,this.options=b,this._validateOptions(this.options),this.options.modifications.sort(function(a,b){return b.assetIndex-a.assetIndex}),d=!1,h=this.options.modifications,f=0,g=h.length;f<g;f++)e=h[f],c=this.page.layout.assets[e.assetIndex],"redo"===this.stage&&null==c||(e.delete?(this._executeDeletion(c,e),!d&&this._isStorytellingAsset(c)&&(d=!0)):this._executeModify(c,e));if(d)return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a.prototype._isStorytellingAsset=function(a){var b,c;return"graphic"===a.asset.assetType&&this.storytellingAssetRegistry.hasAsset(null!=(b=a.values)&&null!=(c=b.assetReference)?c.assetId:void 0)},a.prototype._executeDeletion=function(a,b){if(this.page.customLayout=!0,this.page.removeAssetAtIndex(b.assetIndex),null!=a.imageId)return this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,{imageId:a.imageId,pageNumber:this.page.surfaceNumber})},a.prototype._executeModify=function(a,b){var c;if(this.page.customLayout=!0,a.asset.xOffset=b.xOffset/this.options.scale,a.asset.yOffset=b.yOffset/this.options.scale,a.asset.width=b.width/this.options.scale,a.asset.height=b.height/this.options.scale,null!=b.rotation&&(a.asset.rotation=b.rotation),null!=a.imageAssignment&&null!=b.overrideCropValues)return c=b.overrideCropValues,a.imageAssignmentLlx=c.llx,a.imageAssignmentLly=c.lly,a.imageAssignmentUrx=c.urx,a.imageAssignmentUry=c.ury},a.prototype.afterReverse=function(a){var b,c,d,e,f,g;for(c=!1,g=this.options.modifications,e=0,f=g.length;e<f;e++)d=g[e],b=a.layout.assets[d.assetIndex],null!=b&&d.delete&&(null!=b.imageId?this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_ADDED,{imageId:b.imageId,pageNumber:a.surfaceNumber}):!c&&this._isStorytellingAsset(b)&&(c=!0));if(c)return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a.prototype._validateOptions=function(a){if(!this._scaleValid(a))throw new Error("scale is required and must be a number");if(!(a.modifications instanceof Array&&a.modifications.length>0))throw new Error("must provide at least one modification")},a.prototype._scaleValid=function(a){var b,c,d,e;if("number"==typeof a.scale)return!0;for(e=a.modifications,c=0,d=e.length;c<d;c++)if(b=e[c],b.delete!==!0)return!1;return!0},a}(),a.$inject=["commandFactory","eventBus","storytellingAssetRegistry"],angular.module("galleon").value("ObjectsModifiedCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(){this.type="page",this.name="ObjectsLayeredCommand",this.isLongOperation=!1}return a.prototype.execute=function(a,b){var c,d,e,f,g;for(this._validateOptions(b),f=b.modifications,g=[],d=0,e=f.length;d<e;d++)c=f[d],g.push(a.moveAssetAtIndex(c[0],c[1]));return g},a.prototype._validateOptions=function(a){if(!(a.modifications instanceof Array&&a.modifications.length>0))throw new Error("must provide at least one modification")},a}(),a.$inject=[],angular.module("galleon").value("ObjectsLayeredCommand",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e){this.eventBus=a,this.graphicAssetFactory=c,this.projectService=d,this.framePointSizeService=e,this.afterReverse=b(this.afterReverse,this),this.type="page",this.name="ApplyFramesCommand"}return a.prototype.execute=function(a,b){var c,d,e,f,g,h,i,j;if(!this._optionsValid(a,b))throw new Error("Invalid arguments!");if(d=this.projectService.currentProject.product,e=null!=(h=this.framePointSizeService.getPointSize(d.sizeId,b.frameWidth))?h:0,this.applyToAll=!((null!=(i=b.assetIndices)?i.length:void 0)>0),this.indicesMap={},!this.applyToAll)for(j=b.assetIndices,f=0,g=j.length;f<g;f++)c=j[f],this.indicesMap[c]=!0;return this._applyFrames(a,e,b),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:b.pageNumber})},a.prototype._applyFrames=function(a,b,c){var d,e,f,g,h,i,j;for(i=null!=a&&null!=(h=a.layout)?h.assets:void 0,j=[],e=f=0,g=i.length;f<g;e=++f)d=i[e],this._shouldApply(null!=d?d.asset:void 0,e)?j.push(this._applyFrame(null!=d?d.asset:void 0,b,c)):j.push(void 0);return j},a.prototype._applyFrame=function(a,b,c){return a.borderColor=c.frameColorId,a.borderColorRGB=c.frameColorHex,a.borderStroke=b,a.objectStyle=c.frameId,a.frameOwnedByUser="true"},a.prototype._shouldApply=function(a,b){return(this.applyToAll||null!=this.indicesMap[b])&&"image"===(null!=a?a.assetType:void 0)&&!a.locked},a.prototype._optionsValid=function(a,b){return null!=a&&null!=(null!=b?b.frameColorId:void 0)&&null!=(null!=b?b.frameColorHex:void 0)&&(null!=b?b.frameId:void 0)},a.prototype.afterReverse=function(a){return this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:a.surfaceNumber})},a}(),a.$inject=["eventBus","graphicAssetFactory","projectService","framePointSizeService"],angular.module("galleon").value("ApplyFramesCommand",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f){this.contentService=a,this.imageAssetFactory=c,this.eventBus=d,this.layoutFactory=e,this.storytellingAssetRegistry=f,this.afterReverse=b(this.afterReverse,this),this.type="page",this.name="ConvertToPhotoSpreadCommand",this.hasStorytellingChange=!1}var c;return c="ideapage",a.prototype.execute=function(a,b){var c,d,e;if(null==a||null==(null!=b?b.pageNumber:void 0)||(null!=b?b.pageNumber:void 0)%2!==0||a.isSpread()||null==(null!=b?b.emptySpreadLayout:void 0)||null==(null!=b?b.overlappedPage:void 0))throw new Error("Invalid argument!");if(this.overlappedPageNumber=null!=(c=this.overlappedPageNumber)?c:b.overlappedPage.surfaceNumber,this.overlappedImages=null!=(d=this.overlappedImages)?d:b.overlappedPage.getImages(),this.mainPageImages=null!=(e=this.mainPageImages)?e:a.getImages(),this._checkSpreadForStorytellingChange(a,b.overlappedPage),this._updatePage(a,b.emptySpreadLayout),this._sendImageEvents(b.pageNumber,this.mainPageImages,this.eventBus.events.SURFACE_IMAGE_REMOVED),this._sendImageEvents(this.overlappedPageNumber,this.overlappedImages,this.eventBus.events.SURFACE_IMAGE_REMOVED),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:b.pageNumber}),this.hasStorytellingChange)return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a.prototype._checkSpreadForStorytellingChange=function(a,b){return this.hasStorytellingChange=a.hasStorytellingAsset(this.storytellingAssetRegistry)||a.hasStorytellingLayout(this.storytellingAssetRegistry)||b.hasStorytellingAsset(this.storytellingAssetRegistry)||b.hasStorytellingLayout(this.storytellingAssetRegistry)},a.prototype._updatePage=function(a,b){var d,e,f,g;return d=this.layoutFactory.newInstance(angular.copy(b.content)),d.addAsset(this._createImageAsset(a)),null!=(null!=b?b.attributes:void 0)&&(a.ideaLayout=b.attributes.layoutType===c),a.layoutName=null!=(e=b.id)?e:a.layoutName,a.layoutVersion=null!=(f=b.version)?f:a.layoutVersion,a.customLayout=null!=(g=b.customLayout)?g:a.customLayout,a.layout=d},a.prototype._createImageAsset=function(a){var b,c,d,e;return this.containerId=null!=(d=this.containerId)?d:a.layout.generateContainerId(),this.seqNum=null!=(e=this.seqNum)?e:a.layout.nextSeqNum(),b=a.getFirstBackground(),c=this.contentService.createEmptyImageArea(this.containerId,this.seqNum,{width:a.layout.spreadAssetWidth,height:b.asset.height,xOffset:b.asset.xOffset,yOffset:b.asset.yOffset}),this.imageAssetFactory.newInstance(c)},a.prototype._sendImageEvents=function(a,b,c){var d,e,f,g;for(g=[],e=0,f=b.length;e<f;e++)d=b[e],g.push(this.eventBus.publish(c,{imageId:d.imageId,pageNumber:a}));return g},a.prototype.afterReverse=function(a){if(this._sendImageEvents(a.surfaceNumber,this.mainPageImages,this.eventBus.events.SURFACE_IMAGE_ADDED),this._sendImageEvents(this.overlappedPageNumber,this.overlappedImages,this.eventBus.events.SURFACE_IMAGE_ADDED),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:a.surfaceNumber}),this.hasStorytellingChange)return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a}(),a.$inject=["contentService","imageAssetFactory","eventBus","layoutFactory","storytellingAssetRegistry"],angular.module("galleon").value("ConvertToPhotoSpreadCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.projectService=a,this.eventBus=b,this.layoutFactory=c,this.navService=d,this.type="custom",this.name="MakeSpreadCommand"}var b;return b="ideapage",a.prototype.execute=function(a,b){var c;return this._verifyOptions(b),this.originalSelectedNumber=null!=(c=this.originalSelectedNumber)?c:this.navService.selectedPage.surfaceNumber,this._updateLayout(b,"left"),this._updateLayout(b,"right"),this.navService.gotoPage(b.left.pageNumber,!0)},a.prototype._updateLayout=function(a,c){var d,e,f,g,h,i,j;return d=this.projectService.currentProject.product,f=a[c],e=d.pageBySurfaceNumber(f.pageNumber),this[c]=angular.copy(e.values),null!=(null!=(g=f.layoutValues)?g.attributes:void 0)&&(e.ideaLayout=f.layoutValues.attributes.layoutType===b),e.layoutName=null!=(h=f.layoutValues.id)?h:e.layoutName,e.layoutVersion=null!=(i=f.layoutValues.version)?i:e.layoutVersion,e.customLayout=null!=(j=f.layoutValues.customLayout)?j:e.customLayout,e.layout=this.layoutFactory.newInstance(angular.copy(f.layoutValues.content)),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:f.pageNumber})},a.prototype.reverse=function(a,b){return this._restoreLayout(b,"left"),this._restoreLayout(b,"right"),this.navService.gotoPage(this.originalSelectedNumber,!0)},a.prototype._restoreLayout=function(a,b){var c,d,e;return c=this.projectService.currentProject.product,e=a[b],d=c.pageBySurfaceNumber(e.pageNumber),c.applyPageValuesObj(d.surfaceNumber,this[b]),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:e.pageNumber})},a.prototype._verifyOptions=function(a){return this._verifyPageOptions(a,"left"),this._verifyPageOptions(a,"right"),this._verifyPageNumberCombo(a)},a.prototype._verifyPageNumberCombo=function(a){if(a.left.pageNumber%2!==0||a.right.pageNumber%2!==1||a.left.pageNumber!==a.right.pageNumber-1)throw new Error("Page numbers should be even/odd ascending")},a.prototype._verifyPageOptions=function(a,b){var c;if(null==(null!=a&&null!=(c=a[b])?c.pageNumber:void 0)||null==(null!=a?a[b].layoutValues:void 0))throw Error(""+b+" page options are invalid")},a}(),a.$inject=["projectService","eventBus","layoutFactory","navService"],angular.module("galleon").value("MakeSpreadCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e){this.projectService=a,this.eventBus=b,this.layoutFactory=c,this.navService=d,this.storytellingAssetRegistry=e,this.type="custom",this.name="SplitSpreadCommand",this.rememberActionPage=!0,this.hasStorytellingChange=!1}return a.LAYOUT_TYPE_IDEA="ideapage",a.prototype.execute=function(a,b){var c,d,e;if(this._verifyOptions(b),c=this.projectService.currentProject.product,d=c.pageBySurfaceNumber(b.left.pageNumber),e=c.pageBySurfaceNumber(b.right.pageNumber),this._checkSpreadForStorytellingChange(d,e),this._updateLayout(b,"left"),this._updateLayout(b,"right"),this.hasStorytellingChange)return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a.prototype._updateLayout=function(b,c){var d,e,f,g;return d=this.projectService.currentProject.product,f=b[c],e=d.pageBySurfaceNumber(f.pageNumber),this[c]=angular.copy(e.values),e.layoutName=f.layoutValues.id,e.customLayout=f.layoutValues.customLayout,e.layoutVersion=f.layoutValues.version,e.ideaLayout=(null!=(g=f.layoutValues.attributes)?g.layoutType:void 0)===a.LAYOUT_TYPE_IDEA,e.layout=this.layoutFactory.newInstance(angular.copy(f.layoutValues.content)),this.hasStorytellingChange||this._checkForStorytellingChange(e),f.select&&this.navService.setSelectedPage(e,!0,!0),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:f.pageNumber})},a.prototype._checkSpreadForStorytellingChange=function(a,b){return this.hasStorytellingChange=a.hasStorytellingAsset(this.storytellingAssetRegistry)||a.hasStorytellingLayout(this.storytellingAssetRegistry)||b.hasStorytellingAsset(this.storytellingAssetRegistry)||b.hasStorytellingLayout(this.storytellingAssetRegistry)},a.prototype._checkForStorytellingChange=function(a){return this.hasStorytellingChange=a.hasStorytellingAsset(this.storytellingAssetRegistry)||a.hasStorytellingLayout(this.storytellingAssetRegistry)},a.prototype.reverse=function(a,b){if(this._restoreLayout(b,"left"),this._restoreLayout(b,"right"),this.hasStorytellingChange)return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a.prototype._restoreLayout=function(a,b){var c,d,e;return c=this.projectService.currentProject.product,e=a[b],d=c.pageBySurfaceNumber(e.pageNumber),c.applyPageValuesObj(d.surfaceNumber,this[b]),e.select&&this.navService.setSelectedPage(d,!0,!0),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:e.pageNumber})},a.prototype._verifyOptions=function(a){return this._verifyPageOptions(a,"left"),this._verifyPageOptions(a,"right"),this._verifyPageNumberCombo(a)},a.prototype._verifyPageNumberCombo=function(a){if(a.left.pageNumber%2!==0||a.right.pageNumber%2!==1||a.left.pageNumber!==a.right.pageNumber-1)throw new Error("Page numbers should be even/odd ascending")},a.prototype._verifyPageOptions=function(a,b){var c;if(null==(null!=a&&null!=(c=a[b])?c.pageNumber:void 0)||null==(null!=a?a[b].layoutValues:void 0))throw Error(""+b+" page options are invalid")},a}(),a.$inject=["projectService","eventBus","layoutFactory","navService","storytellingAssetRegistry"],angular.module("galleon").value("SplitSpreadCommand",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}},c=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};a=function(){function a(a,c,d,e){this.contentService=a,this.imageAssetFactory=c,this.eventBus=d,this.storytellingAssetRegistry=e,this.afterReverse=b(this.afterReverse,this),this.type="page",this.name="AddPictureAsBackgroundCommand",this.hasStorytellingChange=!1}return a.prototype.execute=function(a,b){var d,e,f;if(this.options=b,null==a||null==(null!=(d=this.options)?d.pageNumber:void 0))throw new Error("Invalid argument!");if(!a.layout.hasPictureAsBackground())return this.backgroundIndex=(e=this.options.backgroundIndex,c.call(function(){f=[];for(var b=0,c=a.getBackgrounds().length;0<=c?b<=c:b>=c;0<=c?b++:b--)f.push(b);return f}.apply(this),e)>=0?this.options.backgroundIndex:0),this._checkSpreadForStorytellingChange(a),this._updatePage(a),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:this.options.pageNumber}),this.hasStorytellingChange?this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE):void 0},a.prototype._checkSpreadForStorytellingChange=function(a){return this.hasStorytellingChange=a.hasStorytellingAsset(this.storytellingAssetRegistry)||a.hasStorytellingLayout(this.storytellingAssetRegistry)},a.prototype._updatePage=function(a){var b,c,d;return d=this._createImageAsset(a),d.background=!0,a.layout.addAsset(d),b=a.layout.assets.length-1,c=a.getBackgrounds().length,a.moveAssetAtIndex(b,c),a.customLayout=!0},a.prototype._createImageAsset=function(a){var b,c,d,e;return this.containerId=null!=(d=this.containerId)?d:a.layout.generateContainerId(),this.seqNum=null!=(e=this.seqNum)?e:a.layout.nextSeqNum(),b=a.getBackgroundsBeginningToEnding()[this.backgroundIndex],c=this.contentService.createEmptyImageArea(this.containerId,this.seqNum,{width:null!=this.options.backgroundIndex?b.asset.width:a.layout.fullBleedWidth,height:b.asset.height,xOffset:b.asset.xOffset,yOffset:b.asset.yOffset}),this.imageAssetFactory.newInstance(c)},a.prototype.afterReverse=function(a){if(this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:a.surfaceNumber}),this.hasStorytellingChange)return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a}(),a.$inject=["contentService","imageAssetFactory","eventBus","storytellingAssetRegistry"],angular.module("galleon").value("AddPictureAsBackgroundCommand",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h){this.contentService=a,this.imageAssetFactory=c,this.eventBus=d,this.storytellingAssetRegistry=e,this.appState=f,this.modelAdapter=g,this.$rootScope=h,this.afterReverse=b(this.afterReverse,this),this.type="page",this.name="AddRealPictureAsBackgroundCommand",this.hasStorytellingChange=!1}return a.prototype.execute=function(a,b){var c,d,e,f,g,h;if(this.options=b,null==a||null==(null!=(f=this.options)?f.pageNumber:void 0))throw new Error("Invalid argument!");if(!a.isSpread()&&null==this.options.contentGraphicAsset)throw new Error("Invalid argument!");if(d=a.isSpread()?1:0,c=a.layout.assets[d],!/graphic/i.test(c.values.assetType)&&!/background/i.test(c.values.assetReference.assetType))throw new Error("unexpected asset type in zeroth position");if((null!=(g=c.values)&&null!=(h=g.imageAssignment)?h.imageReference:void 0)&&this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,{imageId:c.values.imageAssignment.imageReference.id,pageNumber:a.surfaceNumber}),c.values.imageAssignment={vividPicsImage:null,shutterPicsImage:null,renderFarmImage:null},c.values.imageRectangle={xOffset:c.values.container.xOffset,yOffset:c.values.container.yOffset,width:a.isSpread()?a.layout.fullBleedWidth:c.values.container.width,height:c.values.container.height,rotation:"0",verticalScale:"100",rotationLimit:""},a.isSpread()&&(c.values.imageRectangle.xOffset=0,c.values.imageRectangle.width*=2),e=this.modelAdapter.imageToAssignedImageReference(this.options.contentGraphicAsset,c),c.assignImage(e),e.fadeValue="0.617",e.fadeColor="#FFFFFF",this.appState.backgroundsWaitingForPicture=[],this._checkSpreadForStorytellingChange(a),this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:this.options.pageNumber}),a.layout._cachedAssets=null,a.isSpread()||(this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_ADDED,{imageId:e.id,pageNumber:a.surfaceNumber}),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED,{pageNumber:this.options.pageNumber})),this.hasStorytellingChange)return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a.prototype._checkSpreadForStorytellingChange=function(a){return this.hasStorytellingChange=a.hasStorytellingAsset(this.storytellingAssetRegistry)||a.hasStorytellingLayout(this.storytellingAssetRegistry)},a.prototype.afterReverse=function(a){if(this.eventBus.publish(this.eventBus.events.SURFACE_LAYOUT_UPDATED,{pageNumber:a.surfaceNumber}),this.hasStorytellingChange)return this.eventBus.publish(this.eventBus.events.PROJECT_PRICE_CHANGE)},a}(),a.$inject=["contentService","imageAssetFactory","eventBus","storytellingAssetRegistry","appState","modelAdapter","$rootScope"],angular.module("galleon").value("AddRealPictureAsBackgroundCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.projectService=a,this.adaptiveLayoutService=b,this.eventBus=c,this.type="page",this.name="ShufflePageImagesCommand"}return a.prototype.execute=function(a,b){return this._validateOptions(b),this.originalImageIds=this._getAssignedImageIds(a),this.adaptiveLayoutService.shuffleLayoutImages(a.layout,this.projectService.currentProject.imageCollection.projectImages),a.layout.init(a.layout.values),this._sendImageEvents(a,this.originalImageIds,this.eventBus.events.SURFACE_IMAGE_REMOVED),this._sendImageEvents(a,this._getAssignedImageIds(a),this.eventBus.events.SURFACE_IMAGE_ADDED),this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED,{pageNumber:a.surfaceNumber})},a.prototype._validateOptions=function(a){if("number"!=typeof a.pageNumber)throw new Error("Invalid pageNumber option")},a.prototype._getAssignedImageIds=function(a){var b,c,d,e,f;for(b=[],f=a.getImages(),d=0,e=f.length;d<e;d++)c=f[d],b.push(c.imageId);return b},a.prototype._sendImageEvents=function(a,b,c){var d,e,f,g;for(g=[],e=0,f=b.length;e<f;e++)d=b[e],g.push(this.eventBus.publish(c,{imageId:d,pageNumber:a.surfaceNumber}));return g},a.prototype.reverse=function(a,b){return this._sendImageEvents(a,this._getAssignedImageIds(a),this.eventBus.events.SURFACE_IMAGE_REMOVED),this.projectService.currentProject.product.applyPageValuesObj(a.surfaceNumber,angular.fromJson(this.serialized)),this._sendImageEvents(a,this.originalImageIds||[],this.eventBus.events.SURFACE_IMAGE_ADDED)},a}(),a.$inject=["projectService","adaptiveLayoutService","eventBus"],angular.module("galleon").value("ShufflePageImagesCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g,h,i,j){this.projectService=a,this.eventBus=b,this.imageCollection=c,this.autofill=d,this.modelAdapter=e,this.imageAssetFactory=f,this.calendarGrid=g,this.eventsService=h,this.projectEvents=i,this.commandFactory=j,this.type="page",this.name="AddWellImageCommand"}return a.prototype.execute=function(a,b){var c,d,e,f,g,h,i,j,k,l;if(this._expectArgument(a,"page"),this._expectArgument(b,"options"),this._expectArgument(b.source,"options.source"),this._expectArgument(b.target,"options.target"),this.projectImage=this.imageCollection.getImageByImageId(b.source.imageId),h={},c=null,g=b.target.uniqueProjectRef,a.isStockCover)h=a.getInlayImage(),c=a.getImageById(g);else if(a.isGrid){if((null!=b?b.virtualTarget:void 0)?(k=null!=b?b.virtualTarget:void 0,j=k.asset.uniqueProjectRef,f=this.calendarGrid.getGridCellIteratorFromVirtualAsset(a,k),this.calendarGrid.inflateGridCell(f,a),h=a.getImageById(j)):h=a.getImageById(g),!this._skipEventImageCommandExecution(b)&&(this._executeEventImageCommand(a,h,b),"ApplyEventImageCommand"===(null!=(l=this.eventImageCommand)?l.name:void 0)))return}else h=a.getImageById(g);if(h){if(h.removeImageAssignment(),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,{pageNumber:b.pageNumber,imageId:b.target.imageId,uniqueProjectRef:b.target.uniqueProjectRef}),i=this._createImageReference(h,b),h.assignImage(i),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_ADDED,{pageNumber:b.pageNumber,imageId:b.source.imageId,uniqueProjectRef:b.source.uniqueProjectRef}),null!=c)return c.removeImageAssignment(),e=angular.copy(i),d=this.autofill.utils.CropUtil.reduceCrop(e,h.asset,c.asset),this.modelAdapter.applyCrop(e,d),c.assignImage(e)}else if("redo"!==this.stage)throw new Error("Page does not contain image with id "+g)},a.prototype._skipEventImageCommandExecution=function(a){return a.skipEventImageExecution||a.source.imageId===a.target.imageId},a.prototype._executeEventImageCommand=function(a,b,c){var d,e,f,g,h,i,j,k,l;if(h=this._eventsOnDay(a,b),h.length>0){for(g=void 0,e=!1,k=0,l=h.length;k<l;k++)if(f=h[k],d=this.projectEvents.getImageAssociation(f.id),null!=d&&(e=!0,d.active===!0)){g=f;break}if(e!==!0||null!=g)return null!=g?(j=c.target.imageId,i=c.source.imageId,
void this._updateSwappedImageAssociation(f.id,j,i)):e===!1?this._executeApplyEventImageCommand(h[0],a):void 0}},a.prototype._updateSwappedImageAssociation=function(a,b,c){var d,e,f;if(e=this.imageCollection.getImageByImageId(c),f=this.projectEvents.getImageInformationForImage(e),c!==b)return d=this.projectEvents.updateImageAssociation(a,f),d.active===!0},a.prototype._eventsOnDay=function(a,b){var c,d,e,f;return d=function(a,b){var c;return c=b[0],a.asset.assetType===a.asset.constructor.TEXT_TYPE&&a.associatedImage===c},f=this.calendarGrid.seekToGridCell(a,d,[b.asset.containerId]),c=f.gridCellIterator,e=f.__,this.eventsService.getSelectedEventsOnSameDay(c.currentDate(),!0)},a.prototype._executeApplyEventImageCommand=function(a,b){return this.eventImageOptions={event:a,imageMediaId:this.projectImage.sflyId,projectImageId:this.projectImage.productImageID,pageNumber:b.surfaceNumber,skipGridCellMutation:!0},this.eventImageCommand=this.commandFactory.getInstance("ApplyEventImageCommand",this.eventImageOptions),this.eventImageCommand.execute(b,this.eventImageOptions)},a.prototype._executeUpdateEventImageCommand=function(a,b){return this.eventImageOptions={event:a,pageNumber:b.surfaceNumber},this.eventImageCommand=this.commandFactory.getInstance("UpdateEventImageCommand",this.eventImageOptions),this.eventImageCommand.execute(b,this.eventImageOptions)},a.prototype._expectArgument=function(a,b){if(null==a)throw this._argumentError(b)},a.prototype._argumentError=function(a){return new Error("AddImageWellCommand invoked with missing argument: "+a)},a.prototype._createImageReference=function(a,b){return null!=b.source.serializedImageAsset?this._getPregeneratedImageAsset(a,b):this._getPaletteImageReference(a,b)},a.prototype._getPregeneratedImageAsset=function(a,b){var c;return c=this.imageAssetFactory.newInstance(angular.fromJson(b.source.serializedImageAsset)),this.modelAdapter.imageAssignmentForNewAsset(c,a)},a.prototype._getPaletteImageReference=function(a,b){return this.modelAdapter.imageToAssignedImageReference(this.projectImage,a)},a.prototype._reverseSwappedImageAssociation=function(a,b,c){var d,e,f,g,h,i,j,k;if(g=this._eventsOnDay(a,b),g.length>0){for(f=void 0,j=0,k=g.length;j<k;j++)if(e=g[j],d=this.projectEvents.getImageAssociation(e.id),null!=d&&d.active===!0){f=e;break}null!=f&&(i=c.source.imageId,h=c.target.imageId,this._updateSwappedImageAssociation(e.id,i,h))}},a.prototype.reverse=function(a,b){var c,d;if(null!=this.eventImageCommand?this.eventImageCommand.reverse(a,this.eventImageOptions):this.projectService.currentProject.product.applyPageValuesObj(a.surfaceNumber,angular.fromJson(this.serialized)),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,{pageNumber:b.pageNumber,imageId:b.source.imageId,uniqueProjectRef:b.source.uniqueProjectRef}),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_ADDED,{pageNumber:b.pageNumber,imageId:b.target.imageId,uniqueProjectRef:b.target.uniqueProjectRef}),a.isGrid)return d=b.target.uniqueProjectRef,c=a.getImageById(d),this._reverseSwappedImageAssociation(a,c,b)},a}(),a.$inject=["projectService","eventBus","imageCollection","autofill","modelAdapter","imageAssetFactory","calendarGrid","eventsService","projectEvents","commandFactory"],angular.module("galleon-gc").value("AddWellImageCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f){this.projectService=a,this.eventBus=b,this.imageCollection=c,this.autofill=d,this.modelAdapter=e,this.imageAssetFactory=f,this.type="page",this.name="AddWellImageCommand"}return a.prototype.execute=function(a,b){var c,d,e,f,g,h;if(this._expectArgument(a,"page"),this._expectArgument(b,"options"),this._expectArgument(b.source,"options.source"),this._expectArgument(b.target,"options.target"),g={},c=null,f=b.target.uniqueProjectRef,a.isStockCover?(g=a.getInlayImage(),c=a.getImageById(f)):g=a.getImageById(f),g){if(g.removeImageAssignment(),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,{pageNumber:b.pageNumber,imageId:b.target.imageId,uniqueProjectRef:b.target.uniqueProjectRef}),h=this._createImageReference(g,b),g.assignImage(h),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_ADDED,{pageNumber:b.pageNumber,imageId:b.source.imageId,uniqueProjectRef:b.source.uniqueProjectRef}),null!=c)return c.removeImageAssignment(),e=angular.copy(h),d=this.autofill.utils.CropUtil.reduceCrop(e,g.asset,c.asset),this.modelAdapter.applyCrop(e,d),c.assignImage(e)}else if("redo"!==this.stage)throw new Error("Page does not contain image with id "+f)},a.prototype._expectArgument=function(a,b){if(null==a)throw this._argumentError(b)},a.prototype._argumentError=function(a){return new Error("AddImageWellCommand invoked with missing argument: "+a)},a.prototype._createImageReference=function(a,b){return null!=b.source.serializedImageAsset?this._getPregeneratedImageAsset(a,b):this._getPaletteImageReference(a,b)},a.prototype._getPregeneratedImageAsset=function(a,b){var c;return c=this.imageAssetFactory.newInstance(angular.fromJson(b.source.serializedImageAsset)),this.modelAdapter.imageAssignmentForNewAsset(c,a)},a.prototype._getPaletteImageReference=function(a,b){var c;return c=this.imageCollection.getImageByImageId(b.source.imageId),this.modelAdapter.imageToAssignedImageReference(c,a)},a.prototype.reverse=function(a,b){return this.projectService.currentProject.product.applyPageValuesObj(a.surfaceNumber,angular.fromJson(this.serialized)),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,{pageNumber:b.pageNumber,imageId:b.source.imageId,uniqueProjectRef:b.source.uniqueProjectRef}),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_ADDED,{pageNumber:b.pageNumber,imageId:b.target.imageId,uniqueProjectRef:b.target.uniqueProjectRef})},a}(),a.$inject=["projectService","eventBus","imageCollection","autofill","modelAdapter","imageAssetFactory"],angular.module("galleon-pb").value("AddWellImageCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f){this.projectService=a,this.eventBus=b,this.imageCollection=c,this.autofill=d,this.modelAdapter=e,this.imageAssetFactory=f,this.type="page",this.name="AddWellImageCommand"}return a.prototype.execute=function(a,b){var c,d,e,f,g,h;if(this._expectArgument(a,"page"),this._expectArgument(b,"options"),this._expectArgument(b.source,"options.source"),this._expectArgument(b.target,"options.target"),g={},c=null,f=b.target.uniqueProjectRef,g=a.getImageById(f)){if(g.removeImageAssignment(),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,{pageNumber:b.pageNumber,imageId:b.target.imageId,uniqueProjectRef:b.target.uniqueProjectRef}),h=this._createImageReference(g,b),g.assignImage(h),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_ADDED,{pageNumber:b.pageNumber,imageId:b.source.imageId,uniqueProjectRef:b.source.uniqueProjectRef}),null!=c)return c.removeImageAssignment(),e=angular.copy(h),d=this.autofill.utils.CropUtil.reduceCrop(e,g.asset,c.asset),this.modelAdapter.applyCrop(e,d),c.assignImage(e)}else if("redo"!==this.stage)throw new Error("Page does not contain image with id "+f)},a.prototype._expectArgument=function(a,b){if(null==a)throw this._argumentError(b)},a.prototype._argumentError=function(a){return new Error("AddImageWellCommand invoked with missing argument: "+a)},a.prototype._createImageReference=function(a,b){return null!=b.source.serializedImageAsset?this._getPregeneratedImageAsset(a,b):this._getPaletteImageReference(a,b)},a.prototype._getPregeneratedImageAsset=function(a,b){var c;return c=this.imageAssetFactory.newInstance(angular.fromJson(b.source.serializedImageAsset)),this.modelAdapter.imageAssignmentForNewAsset(c,a)},a.prototype._getPaletteImageReference=function(a,b){var c;return c=this.imageCollection.getImageByImageId(b.source.imageId),this.modelAdapter.imageToAssignedImageReference(c,a)},a.prototype.reverse=function(a,b){return this.projectService.currentProject.product.applyPageValuesObj(a.surfaceNumber,angular.fromJson(this.serialized)),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,{pageNumber:b.pageNumber,imageId:b.source.imageId,uniqueProjectRef:b.source.uniqueProjectRef}),this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_ADDED,{pageNumber:b.pageNumber,imageId:b.target.imageId,uniqueProjectRef:b.target.uniqueProjectRef})},a}(),a.$inject=["projectService","eventBus","imageCollection","autofill","modelAdapter","imageAssetFactory"],angular.module("galleon-ss").value("AddWellImageCommand",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.projectService=a,this.adaptiveLayoutService=b,this.type="custom",this.name="SuperProjectCommand"}return a.prototype.execute=function(a,b){return this._validateOptions(b),this._createSuperProject(b)},a.prototype._validateOptions=function(a){return this._expectArgument(a,"styleJSON")},a.prototype._createSuperProject=function(a){return this.adaptiveLayoutService.getSuperbookTemplate(a.styleJSON,a.book).then(function(a){return function(b,c){var d;return null!=c?console.error("getSuperbook:error",c):a.projectService.loadMagicshopProject(b,(null!=(d=a.projectService.currentProject)?d.projectGuid:void 0)||"123-456-789-1234")}}(this))},a.prototype._expectArgument=function(a,b){if(null==a)throw this._argumentError(b)},a.prototype._argumentError=function(a){return new Error("SuperProjectCommand invoked with missing argument")},a}(),a.$inject=["projectService","adaptiveLayoutService"],angular.module("galleon").value("SuperProjectCommand",a)}.call(this),function(){"use strict";var a,b;a=function(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,s,t,u,v,w;h.classNameFilter(/animate-\w+/),g.imgSrcSanitizationWhitelist(/^\s*(https?|ftp|file|blob):|data:image\//),g.debugInfoEnabled("true"===(null!=i?i.enableNGDebugInfo:void 0)),e.interceptors.push("myHttpInterceptor"),t=c.$get(),t.__karma__||e.useApplyAsync(!0),w=t.translations;for(n in w)r=w[n],b.translations(n,r);b.preferredLanguage("en"),b.useMissingTranslationHandlerLog(),p=!1,q="SilverApp/views/unsupported-browser.html",l="UnsupportedBrowserCtrl",s=bowser.version,o=!1,j=!1,(bowser.msie&&s>=10||bowser.firefox&&s>=28||bowser.chrome&&s>=32||bowser.opera&&s>=28||bowser.safari&&s>=6||bowser.msedge||bowser.tablet&&!bowser.android||bowser.tablet&&bowser.silk||bowser.mobile&&!bowser.android||bowser.mobile&&bowser.android&&bowser.chrome||bowser.tablet&&bowser.android&&bowser.chrome)&&(p=!0),k=p,(bowser.mobile&&i.features.disableMobile||bowser.tablet&&i.features.disableTablet)&&(p=!1),p&&((bowser.safari&&"6.0"===s||bowser.msie&&"10.0"===s)&&(j=!0),q="SilverApp/views/editable-book.html",l="MainCtrl"),p&&t.shouldUseSuperSimple&&(q="SilverApp/views/superSimple.html",o=!0),m=function(a,b,c){var d,e,f;if(e=c,e.redir=b,d=$.param(e),f=!c.warning,j&&f)return"/updateBrowser?"+d};try{window.localStorage.setItem("test","test"),window.localStorage.removeItem("test")}catch(a){p=!1,l="UnsupportedBrowserCtrl",console.log("unsupported"),q="SilverApp/views/no-cookies.html"}return a.when("/",{templateUrl:q,controller:l,redirectTo:m,superSimple:o}).when("/updateBrowser",{templateUrl:"SilverApp/views/pb/advocate-browser-upgrade.html",controller:"AdvocateBrowserUpgradeCtrl"}).when("/unsupported",{templateUrl:"SilverApp/views/unsupported-browser.html",controller:"UnsupportedBrowserCtrl"}).when("/slideshow",{templateUrl:k?"SilverApp/views/slideshow.html":q,controller:k?"MainCtrl":l,slideshow:!0,redirectTo:m}).when("/simple",{templateUrl:q,controller:l,superSimple:o,simple:!0,redirectTo:m}).otherwise({redirectTo:"/"}),d.setPrefix("galleon"),f.options({popupDelay:1e3,placement:"bottom"}),f.setTriggers({mouseenter:"mouseleave",click:"click",focus:"blur",never:"mouseleave",manualShow:"manualHide"}),u=void 0,v=0,t.document.body.addEventListener("touchstart",function(a){return u=a.touches[0].screenX,v=a.touches[0].screenY}),t.document.body.addEventListener("touchmove",function(a){var b,c;if(b=Math.abs(a.touches[0].screenX-u),c=Math.abs(a.touches[0].screenY-v),Shr.Dialogs.UniversalPicker.isOpen);else if(3*c>b){if(!$(".allowVerticalScroll").has($(a.target)).length)return a.preventDefault()}else if(!$(".allowHorizontalScroll").has($(a.target)).length)return a.preventDefault()},!1),t.addEventListener("load",function(){return FastClick.attach(document.body)},!1)},a.$inject=["$routeProvider","$translateProvider","$windowProvider","localStorageServiceProvider","$httpProvider","$tooltipProvider","$compileProvider","$animateProvider","_CONFIG_JSON"],b=angular.module("silverApp",["ngRoute","angular-gestures","pascalprecht.translate","LocalStorageModule","ui.bootstrap","galleon","ngSanitize","ngClipboard","cfp.hotkeys","ngDraggable","ngSlider","FBAngular","overrideUITemplates","rzModule","angular-loading-bar","angularHelpOverlay"]).config(a),b.run(["$window","$rootScope",function(a,b){if(!window.__karma__)return b.$on("$locationChangeStart",function(b,c,d){if(c!==d&&c!==""+d+"#/")return a.location.href=c,a.location.reload()})}])}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j){this.scope=a,this.imageCollection=c,this.commandService=d,this.modelAdapter=e,this.projectService=f,this.navService=g,this.eventBus=h,this.autofillService=i,this.uppService=j,this.canAutofill=b(this.canAutofill,this),this.scope.ctrls.AutofillCtrl=this}return a.prototype.autofill=function(){var a,b,c;if(this.canAutofill())return a="",c={},b=this.imageCollection.projectImages.filter(function(a){return 0===a.useCount&&!a.hasError}).map(this.modelAdapter.galleonImageModelToDocsmithImage),this.uppService.deferUppEvents(),this.projectService.currentProject.product.hasFilledPages()?(a="AutofillFilledBookCommand",c=this.autofillService.prepareAutofillFilledBookCommand(b)):(a="AutofillBlankBookCommand",c=this.autofillService.prepareAutofillBlankBookCommand(b)),c.cannotAutofill?void this.eventBus.publish(this.eventBus.events.AUTOFILL_UNPLACED_IMAGES,{numPlaced:0,numUnplaced:b.length}):c.then(function(c){return function(d){return d.images=b,d.beforeCommandPageNumber=c.navService.selectedPage.surfaceNumber,d.activePageNumber=c.navService.selectedPage.surfaceNumber,c.commandService.execute(a,d)}}(this))},a.prototype.canAutofill=function(){var a,b,c;return(null!=(a=this.imageCollection)&&null!=(b=a.projectImages)?b.length:void 0)>(null!=(c=this.imageCollection)?c.getUsedImages():void 0)},a}(),a.$inject=["$scope","imageCollection","commandService","modelAdapter","projectService","navService","eventBus","autofillService","uppService"],angular.module("silverApp").controller("AutofillCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l){var m;this.$scope=a,this.config=c,this.eventBus=d,this.browserDetectionService=e,this.$translate=f,this.omnitureService=g,this.$timeout=h,this.$modal=i,this.movePageService=j,this.appState=k,this.tabIntroModalService=l,this._handleCommandExecution=b(this._handleCommandExecution,this),this.hoverMap={},this.arrangeEnabled=this.config.arrange,this.superSimple=this.config.superSimple,this.hideArrangeIntro=this.config.hideArrangeIntro,this.shownArrangeIntro=!1,this.currentPaletteItemIndex=0,this.startupTab=this.config.startupTab,this.config.superSimple?(this.arrangeInnerPageTooltip=this.$translate("SilverApp.pageTabPageTooltip"),this.arrangeCoverPageTooltip="",this.arrangeInsertPageTooltip=""):(this.arrangeInnerPageTooltip=this.$translate("SilverApp.arrangeInnerPageTooltip"),this.arrangeCoverPageTooltip=this.$translate("SilverApp.arrangeCoverPageTooltip"),this.arrangeCoverPageLayoutsTooltip=this.$translate("SilverApp.arrangeCoverPageLayoutsTooltip"),this.arrangeInsertPageTooltip=this.$translate("SilverApp.arrangeInsertPageTooltip")),this.arrangeInnerPageTooltipDynamicString=this.arrangeInnerPageTooltip,this.ignoredCommandsForAutoscroll={SwapWellImageCommand:!0,MoveWellImageCommand:!0,AdaptPageCommand:!0},this.eventBus.subscribe(this.eventBus.events.COMMAND_EXECUTED,this._handleCommandExecution,this.$scope),null==(m=this.$scope).ctrls&&(m.ctrls={}),this.$scope.ctrls.ArrangeTabCtrl=this}return a.prototype._handleCommandExecution=function(a,b){if(this.hoverMap={},!this.ignoredCommandsForAutoscroll[b.commandName])return this.currentPaletteItemIndex=!this.currentPaletteItemIndex},a.prototype.updateHoverState=function(a,b){return this.hoverMap[a]=b,this.$timeout(function(a){return function(){return a.$scope.$digest()}}(this))},a.prototype.tabWasMadeActive=function(){if(this.appState.cancelBackgroundWaitingForPicture(),this.appState.activeTab="arrange",this.arrangeInactive=!1,this.omnitureService.trackPageName({pageName:this.omnitureService.ARRANGE_PAGE_NAME}),this.appState.customizeMode=this.appState.customize.NONE,this.$timeout(function(a){return function(){return a.currentPaletteItemIndex=!a.currentPaletteItemIndex,a.$scope.$digest()}}(this),500),!this.shownArrangeIntro&&!this.hideArrangeIntro&&this.config.advancedArrange&&!this.config.superSimple&&"arrange"!==this.startupTab)return this.shownArrangeIntro=!0,this.tabIntroModalService.open(this.$scope,"hideArrangeIntro",{titleKey:"SilverApp.arrangeTitle",bodyKey:"SilverApp.arrangeText",buttonDtk:"button_arrangeIntro_ok",inputDtk:"button_arrangeIntro_disable"})},a.prototype.tabWasMadeInactive=function(){return this.arrangeInactive=!0,this.currentPaletteItemIndex=!this.currentPaletteItemIndex},a.prototype.onDragComplete=function(a,b){},a.prototype.onDropComplete=function(a,b,c){if(a!==b)return console.log("drop success, sourcePage, destPage",b,a),this.movePageService.assignSource(b),this.movePageService.assignTarget(a),this.movePageService.executeMove()},a.prototype.handleDoubleClick=function(){if(this.superSimple!==!0)return this.eventBus.publish(this.eventBus.events.SELECT_EDIT_TAB)},a}(),a.$inject=["$scope","CONFIG","eventBus","browserDetectionService","$translate","omnitureService","$timeout","$modal","movePageService","appState","tabIntroModalService"],angular.module("silverApp").controller("ArrangeTabCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){var c;this.$scope=a,this.$timeout=b,null==(c=this.$scope).ctrls&&(c.ctrls={}),this.$scope.ctrls.PagesViewCtrl=this,this.currentPaletteItemIndex=0}return a.prototype.tabWasMadeActive=function(){return this.$timeout(function(a){return function(){return a.currentPaletteItemIndex=!a.currentPaletteItemIndex,a.$scope.$digest()}}(this),500)},a.prototype.tabWasMadeInactive=function(){return this.currentPaletteItemIndex=!this.currentPaletteItemIndex},a}(),a.$inject=["$scope","$timeout"],angular.module("silverApp").controller("PagesViewCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g,h){var i;this.$scope=a,this.config=b,this.imageURLService=c,this.imageCollection=d,this.appState=e,this.omnitureService=f,this.tabIntroModalService=g,this.eventBus=h,this.storyboardEnabled=this.config.storyboard,this.hideStoryboardIntro=this.config.hideStoryboardIntro,this.shownStoryboardIntro=!1,null==(i=this.$scope).ctrls&&(i.ctrls={}),this.$scope.ctrls.StoryboardTabCtrl=this,this.expandedPagesBySurfaceNumber={}}return a.prototype.tabWasMadeActive=function(){if(this.appState.cancelBackgroundWaitingForPicture(),this.appState.activeTab="storyboard",this.storyboardInactive=!1,this.appState.customizeMode=this.appState.customize.NONE,this.omnitureService.trackPageName({pageName:this.omnitureService.STORYBOARD_PAGE_NAME}),!this.shownStoryboardIntro)return this.shownStoryboardIntro=!0,this.tabIntroModalService.open(this.$scope,"hideStoryboardIntro",{titleKey:"SilverApp.storyBoardTitle",bodyKey:"SilverApp.storyBoardText",buttonDtk:"button_storyboardIntro_ok",inputDtk:"button_storyboardIntro_disable"}),this.eventBus.publish(this.eventBus.events.RECLUSTER_REQUIRED)},a.prototype.tabWasMadeInactive=function(){return this.storyboardInactive=!0},a.prototype.getImage=function(a){return this.imageCollection.getImageByProductImageId(a.projectImageId)},a.prototype.imageAssetURL=function(a){return this.imageURLService.thumbURLForImageAsset(a)},a.prototype.returnToEdit=function(){return this.eventBus.publish(this.eventBus.events.SELECT_EDIT_TAB)},a.prototype.getPhotoStackTooltipClass=function(a){var b,c,d,e,f,g,h,i,j;return e=300,d=a.currentTarget.parentElement.parentElement.parentElement,c=d.parentElement,i=a.currentTarget.querySelector(".photo-stack-tooltip"),f=c.parentElement.parentElement.scrollTop,j=c.parentElement.parentElement.clientHeight,h=d.offsetTop-f,g=j-(h+d.clientHeight),b="",d.offsetLeft<100?b+="left-align":d.offsetLeft>c.clientWidth-i.clientWidth&&(b+="right-align"),g<e&&h>e&&(b+=" top-align"),b},a.prototype.toggleExpandCollapsePage=function(a){if(null!=a)return this.expandedPagesBySurfaceNumber[a.surfaceNumber]=!this.expandedPagesBySurfaceNumber[a.surfaceNumber],a.surfaceNumber%2===0?this.expandedPagesBySurfaceNumber[a.surfaceNumber+1]=this.expandedPagesBySurfaceNumber[a.surfaceNumber]:this.expandedPagesBySurfaceNumber[a.surfaceNumber-1]=this.expandedPagesBySurfaceNumber[a.surfaceNumber]},a.prototype.shouldExpandPage=function(a){return this.expandedPagesBySurfaceNumber[a]},a}(),a.$inject=["$scope","CONFIG","imageURLService","imageCollection","appState","omnitureService","tabIntroModalService","eventBus"],angular.module("silverApp").controller("StoryboardTabCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e){this.$scope=a,this.projectService=b,this.navService=c,this.eventBus=d,this.appState=e,this.$scope.ctrls||(this.$scope.ctrls={}),this.$scope.ctrls.EditTabCtrl=this}return a.prototype.handleFrontCoverPageDoubleClick=function(){if(!this.appState.inPreviewMode)return this.navService.selectCoverSpread(this.projectService.currentProject.product.cover.frontPage),this.selectArrangeTab()},a.prototype.handleBackCoverPageDoubleClick=function(){if(!this.appState.inPreviewMode)return this.navService.selectCoverSpread(this.projectService.currentProject.product.cover.backPage),this.selectArrangeTab()},a.prototype.handleFrontFillerPageDoubleClick=function(){if(!this.appState.inPreviewMode)return this.navService.setSelectedPage(this.projectService.currentProject.product.frontFillerPage),this.selectArrangeTab()},a.prototype.handleBackFillerPageDoubleClick=function(){if(!this.appState.inPreviewMode)return this.navService.setSelectedPage(this.projectService.currentProject.product.backFillerPage),this.selectArrangeTab()},a.prototype.handleInnerPageDoubleClick=function(a){if(!this.appState.inPreviewMode)return this.navService.setSelectedPage(a),this.selectArrangeTab()},a.prototype.selectArrangeTab=function(){var a;if(null!=(a=this.$scope.ctrls.ArrangeTabCtrl)?a.arrangeEnabled:void 0)return this.eventBus.publish(this.eventBus.events.SELECT_ARRANGE_TAB)},a}(),a.$inject=["$scope","projectService","navService","eventBus","appState"],angular.module("silverApp").controller("EditTabCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f){var g;this.$scope=a,this.$modalInstance=b,this.$timeout=d,this.config=e,this.deviceDetectionService=f,null==(g=this.$scope).ctrls&&(g.ctrls={}),this.$scope.ctrls.EditImageCtrl=this,this.page=c.page,this.originalAsset=c.asset}return a.prototype.dismiss=function(){return this.$modalInstance.dismiss()},a.prototype.done=function(){var a,b;if("function"==typeof this.tabChangedCallback&&this.tabChangedCallback(),this.setTabChangedCallback(null),this.$modalInstance.close(),this.deviceDetectionService.isDeviceAPhone())return b=this.page.surfaceNumber,a="#simple_"+b,this.$timeout(function(){var b;return b=$(a),b.css("display","none").height(),b.css("display","block")},this.config.defaults.hoverDelay)},a.prototype.setTabChangedCallback=function(a){this.tabChangedCallback=a},a}(),a.$inject=["$scope","$modalInstance","data","$timeout","CONFIG","deviceDetectionService"],angular.module("silverApp").controller("EditImageCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.$scope=a,this.$modalInstance=b,this.data=c,this.$scope.ctrls=this.$scope.ctrls||{},this.$scope.ctrls.SimpleModalCtrl=this}return a.prototype.ok=function(){return this.$modalInstance.close()},a.prototype.cancel=function(){return this.$modalInstance.dismiss("cancel")},a}(),a.$inject=["$scope","$modalInstance","data"],angular.module("silverApp").controller("SimpleModalCtrl",a)}.call(this),function(){"use strict";var a,b,c,d,e,f=function(a,b){return function(){return a.apply(b,arguments)}};d=310,a=function(){function a(a,b,c,d,e){this.scope=a,this.$modal=b,this.layoutFactory=c,this.contentService=d,this.eventBus=e,this.showError=f(this.showError,this),this.handleNomorePhotosCanbeAdded=f(this.handleNomorePhotosCanbeAdded,this),this.handleCannotAddPhotoArea=f(this.handleCannotAddPhotoArea,this)}return a.prototype.handleCannotAddPhotoArea=function(a,b){var c;return c=this.$modal.open({templateUrl:"SilverApp/views/cannot-add-photo-area-modal.html",backdrop:"static",scope:this.scope,controller:"SimpleModalCtrl",resolve:{data:function(){return b}}})},a.prototype.handleNomorePhotosCanbeAdded=function(a,b){var c;return c=this.$modal.open({templateUrl:"SilverApp/views/nomore-photos-canbe-added-modal.html",backdrop:"static",scope:this.scope,controller:"SimpleModalCtrl",resolve:{data:function(){return b}}})},a.prototype.showError=function(a,b){var c,d;if(!this.isShowErrorDialogOpen)return this.isShowErrorDialogOpen=!0,d=this.$modal.open({templateUrl:"SilverApp/views/error-dialog.html",backdrop:"static",scope:this.scope,controller:"ErrorDialogCtrl",resolve:{data:function(){return b}}}),c=function(a){return function(){return a.isShowErrorDialogOpen=!1}}(this),d.result.then(c,c)},a}(),b=function(){function b(a,b,d,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q){this.$scope=a,this.$routeParams=d,this.projectService=g,this.uppService=h,this.uppImageFactory=i,this.eventBus=j,this.$modal=k,this.pleaseWaitService=m,this.config=n,this.$translate=o,this.userService=p,this.browserExitService=q,this.contentService=r,this.localStorageService=s,this.browserDetectionService=t,this.$window=u,this.$timeout=v,this.omnitureService=w,this.crossSellService=x,this.$q=y,this.bookInitService=z,this.upsellService=A,this.photoPlacementUppHook=B,this.layoutFactory=C,this.enums=D,this.spineConversionService=E,this.appState=F,this.projectUpgradeService=G,this.photoccinoService=H,this.Fullscreen=I,this.productInitializer=J,this.globalContentService=K,this.tabIntroModalService=L,this.productTrackingStrategy=M,this.deviceDetectionService=N,this.redirectionService=O,this.idleTimeoutService=P,this.galleon=Q,this._loginAndStartWithUpp=f(this._loginAndStartWithUpp,this),this._startWithUpp=f(this._startWithUpp,this),this.startNewProject=f(this.startNewProject,this),this._displayTabletWelcomeDialog=f(this._displayTabletWelcomeDialog,this),this._startWithArrange=f(this._startWithArrange,this),this.welcomeOk=f(this.welcomeOk,this),this._promptForUpp=f(this._promptForUpp,this),this.promptForCover=f(this.promptForCover,this),this.captureProjectEvents=f(this.captureProjectEvents,this),this._hidePleaseWait=f(this._hidePleaseWait,this),this.$scope.ctrls={},this.projectService.init(),this.routeUtil=new c(d),this.logger=l.newInstance("MainCtrl"),this.$window.logApplicationLoad("MainCtrl startup","MainCtrl"),this.logger.info("Starting application"),this.startupMetric=this.logger.asyncMetric("appStartup"),this.config.photoccinoSuggestedCrop&&this.photoccinoService.subscribe(),m.show(),this.appState.displayingInIframe=!1,this.pageTabPageTooltip=this.$translate("SilverApp.pageTabPageTooltip"),this.initializeExperimentalFeatures(b),this.uppService.bootstrapUppEvents(),this.captureProjectEvents(),this.captureConfigValues(),this.captureUserPreferences(),this.setProductHeader(),this.tourInvokedAtStartup=!1,this.previewMode=!1,this.Fullscreen.$on("FBFullscreen.change",function(a){return function(){return a.handleFullscreenChange()}}(this)),u.onTourEnd=function(a){return function(){if(a.inTourMode=!1,a.tourInvokedAtStartup===!0)return a._promptForUpp()}}(this),u.onTourStart=function(a){return function(){return a.inTourMode=!0}}(this),this.date=new Date,this.$scope.ctrls.MainCtrl=this,this.initBugsnag(),this.uppLoader=new e(this.$scope,this.uppService,this.uppImageFactory,this.config,this.projectService,this.contentService,this.eventBus,this.$q,this.$timeout,this.photoPlacementUppHook,this),this.eventBus.subscribe(this.eventBus.events.MAGIC_SHOP_CONTINUE,function(a){return function(){return a.loadMagicShopProjectMaster()}}(this)),this.globalContentService.requestGlobalContent().finally(function(a){return function(){return a.startUserSession()}}(this))}return b.prototype.initBugsnag=function(){var a,b;return"undefined"!=typeof Bugsnag&&null!==Bugsnag&&(b=100*Math.random(),b>70)?(console.log("bugsnag init"),Bugsnag.apiKey="b8057163c2ed8f2f93fbfce042fee558",Bugsnag.releaseStage=this.config.env,Bugsnag.appVersion=""+this.galleon.buildNumber,void(Bugsnag.metaData={build:{buildNumber:""+this.galleon.buildNumber,timeStamp:""+this.galleon.timeStamp,uuid:""+this.galleon.uuid,commit:""+this.galleon.commit}})):(a=void 0,console.log("bugsnag off"))},b.prototype.getFirstBrowserLanguage=function(){var a,b,c,d;if(d=this.$window.navigator,a=["language","browserLanguage","systemLanguage","userLanguage"],b=void 0,c=void 0,Array.isArray(d.languages))for(b=0;b<d.languages.length&&(c=d.languages[b],!c||!c.length);)b++;else for(b=0;b<a.length&&(c=d[a[b]],!c||!c.length);)b++;return null!=c&&c.indexOf("-")!==-1&&(c=c.split("-")[0]),c},b.prototype.setProductHeader=function(){return this.$window.document.title=this.config.productTitle},b.prototype.startUserSession=function(){var a;return null!=this.routeUtil.param("projectGuid")?(a=this.loadUserProject(),a.then(function(a){return function(b){if(a._conditionalyDisplayMakeMyBookWelcomeDialog(b),a.startupMetric.success(),a.omnitureService.trackProjectOpen(),a.routeUtil.isCrossSellRequest()&&a.crossSellService.changeProject(),a.config.changeStartDate&&!a.appState.inSlideshow)return a.promptChangeStartDate(b)}}(this)),a.catch(function(a){return function(b){return"Failed to load project: user is not authenticated"!==b||a.routeUtil.isCrossSellRequest()?a._booForStartupFailure(b):a.startNewProject()}}(this))):null!=this.routeUtil.param("shareId")?(a=this.loadSharedProject(),a.then(function(a){return function(b){return a.startupMetric.success(),a.omnitureService.trackProjectOpen()}}(this)),a.catch(function(a){return function(b){return a._booForStartupFailure(b)}}(this))):null!=this.routeUtil.param("initProjectGUID")?this.loadMagicShopProjectMaster():this.startNewProject()},b.prototype.loadMagicShopProjectMaster=function(){var a;return a=this.loadMagicshopProject(),a.then(function(a){return function(){return a.project=a.projectService.currentProject,a.startupMetric.success(),a.omnitureService.trackProjectStart()}}(this)),a.catch(function(a){return function(b){return a._booForStartupFailure(b)}}(this))},b.prototype._conditionalyDisplayMakeMyBookWelcomeDialog=function(a){var b,c;if("MMB"===(null!=a&&null!=(c=a.product)?c.subtype:void 0))return!this.appState.inSlideshow&&this.deviceDetectionService.isDeviceMobile()?this.redirectionService.redirect("/slideshow",!0):!this.appState.inSlideshow||this.appState.inSlideshow&&this.deviceDetectionService.isDeviceMobile()?(b=this.deviceDetectionService.isDeviceMobile()?"SilverApp.mmb.introText.mobile":"SilverApp.mmb.introText",this.tabIntroModalService.open(this.$scope,"mmbIntro",{titleKey:"SilverApp.mmb.introTitle",bodyKey:b,btnKey:"SilverApp.mmb.reviewBook",buttonDtk:"button_mmb_welcome_modal_ok",inputDtk:"button_mmb_welcome_disable"})):void 0},b.prototype._hidePleaseWait=function(){return this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_HIDE)},b.prototype.switchToTab=function(a){switch(a){case"edit":return this.eventBus.publish(this.eventBus.events.SELECT_EDIT_TAB);case"arrange":return this.eventBus.publish(this.eventBus.events.SELECT_ARRANGE_TAB);
case"storyboard":return this.eventBus.publish(this.eventBus.events.SELECT_STORYBOARD_TAB);case"book":return this.eventBus.publish(this.eventBus.events.SELECT_BOOK_TAB);case"style":return this.eventBus.publish(this.eventBus.events.SELECT_STYLE_TAB)}},b.prototype.toggleFullScreen=function(){return this.Fullscreen.isEnabled()?this.Fullscreen.cancel():this.Fullscreen.all()},b.prototype.handleFullscreenChange=function(){return this.Fullscreen.isEnabled()?this.inFullScreenMode=!0:this.inFullScreenMode=!1},b.prototype.enablePreviewMode=function(a){var b;return this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this.previewMode=a,a?(this.appState.inPreviewMode=!0,this.saveTab=this.appState.activeTab,this.eventBus.publish(this.eventBus.events.SELECT_EDIT_TAB),this.omnitureService.backupReportingPageName(),this.omnitureService.trackPageName({pageName:this.omnitureService.PB_PREVIEW_PAGE_NAME}),this.appState.customizeMode=this.appState.customize.NONE,this.modeName="preview",this.$scope.ctrls.PaletteCtrl.forceDualPaletteMode(!1),this.productInitializer.initPreview(this)):(this.appState.inPreviewMode=!1,this.eventBus.publishSync(this.eventBus.events.STOP_AUTOPLAY),this.config.playButton=!1,this.modeName="","dual"===this.userPalette&&this.$scope.ctrls.PaletteCtrl.forceDualPaletteMode(!0),b=this.omnitureService.getSavedReportingPageName(),b&&this.omnitureService.trackPageName({pageName:b}),this.inFullScreenMode===!0&&(this.toggleFullScreen(),this.inFullScreenMode=!1)),this.$timeout(function(a){return function(){return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)}}(this))},b.prototype.shouldShowFullScreen=function(){var a,b;return this.cachedShouldShowFullScreen?this.cachedShouldShowFullScreen:(a=this.browserDetectionService.getBrowserName(),b=this.browserDetectionService.getBrowserVersion(),"Internet Explorer"===a&&"10.0"===b||this.deviceDetectionService.isDeviceMobile()?(this.cachedShouldShowFullScreen=!1,this.cachedShouldShowFullScreen):(this.cachedShouldShowFullScreen=!0,this.cachedShouldShowFullScreen))},b.prototype.switchToSimpleMode=function(a){var b;return this.appState.cancelBackgroundWaitingForPicture(),b=a!==!0,this.simpleMode=a,this.appState.simpleMode=this.simpleMode,this.config.customize=b,this.config.styleDialog=b,this.config.features.embellishments=b,this.config.features.textSettings=b,this.config.storyboard=b,this.config.features.extendedPalette=b,this.config.clearAutofillPrompt=b,this.config.storyboard=!a,this.storyboardEnabled=!a,this.config.customize=!a,this.customize=!a,this.appState.customizeMode=this.appState.customize.NONE,this.omnitureService.currentAppMode=a?this.omnitureService.constructor.GALLEON_SIMPLE_PATH:this.omnitureService.constructor.GALLEON_CUSTOM_PATH,this.projectService.rewriteSubtype(a)},b.prototype.initializeExperimentalFeatures=function(a){var b,c,d;return this.superSimple=!1,this.allowHotKeys=this.config.allowHotKeys,this.isMac=navigator.platform.toUpperCase().indexOf("MAC")>=0,this.isMac?(this.addPhotosTooltip=this.$translate("SilverApp.hotkey.addphotos.mac"),this.addTextTooltip=this.$translate("SilverApp.hotkey.addtext.mac"),this.addPhotoTooltip=this.$translate("SilverApp.hotkey.addphoto.mac"),this.undoToolTip=this.$translate("SilverApp.hotkey.undo.mac"),this.redoToolTip=this.$translate("SilverApp.hotkey.redo.mac")):(this.addPhotosTooltip=this.$translate("SilverApp.hotkey.addphotos.windows"),this.addTextTooltip=this.$translate("SilverApp.hotkey.addtext.windows"),this.addPhotoTooltip=this.$translate("SilverApp.hotkey.addphoto.windows"),this.undoToolTip=this.$translate("SilverApp.hotkey.undo.windows"),this.redoToolTip=this.$translate("SilverApp.hotkey.redo.windows")),this.startupTab="edit","arrange"===this.config.startupTab&&(this.config.arrange=!0,this.config.arrangeEnabled=!0,this.startupTab="arrange"),this.simpleMode=!1,this.browserIsIE10=!1,this.browserIsIE11=!1,b=this.browserDetectionService.getBrowserName(),c=this.browserDetectionService.getBrowserVersion(),"Internet Explorer"===b&&"10.0"===c&&(this.browserIsIE10=!0),"Internet Explorer"===b&&"11.0"===c&&(this.browserIsIE11=!0),this.omnitureService.currentAppMode=this.omnitureService.constructor.GALLEON_CUSTOM_PATH,(null!=(d=a.current)?d.simple:void 0)===!0&&this.switchToSimpleMode(!0),this.productInitializer.initProductSettings(this)},b.isSuperSmallPhoneMode=!1,b.prototype.updateDeviceOrientation=function(a,b){return this.isDeviceAPhone()?(a>b?this.deviceOrientation="landscape":this.deviceOrientation="portrait",b<d?this.isSuperSmallPhoneMode=!0:this.isSuperSmallPhoneMode=!1):void(this.deviceOrientation="none")},b.prototype.isDeviceAPhone=function(){return this.deviceDetectionService.isDeviceAPhone()},b.prototype.isDeviceATablet=function(){return this.deviceDetectionService.isDeviceATablet()},b.prototype.isDeviceMobile=function(){return this.deviceDetectionService.isDeviceMobile()},b.prototype.captureConfigValues=function(){if(this.helpUrl=this.config.help,this.features=this.config.features,this.storyboardEnabled=this.config.storyboard,this.preview=this.config.preview,this.openProjectEnabled=this.config.features.openProject,this.switchLanguageEnabled=this.config.switchLanguage,this.switchPalettesEnabled=this.config.features.switchPalettes,this.zoom=this.config.zoom,this.saveJPG=this.config.saveJPG,this.customize=this.config.customize,this.passiveMode=this.config.passiveMode,this.exportToPDF=this.config.exportToPDF,this.customize&&(this.config.features.embellishments=!0),this.hoverDelay=this.config.defaults.hoverDelay,this.spreadPhoto=this.config.spreadPhoto,this.playButton=this.config.playButton,this.pinterest=this.config.pinterest,this.config.features.autoSwitchLanguage)return this._setLanguageFromBrowser()},b.prototype.captureUserPreferences=function(){return this.userLanguage=this.localStorageService.get("language"),this.hideUsed=this.localStorageService.get("hideUsed"),this.groupDuplicates=this.localStorageService.get("groupDuplicates"),this.clusterStoryboard=this.localStorageService.get("clusterStoryboard"),this.highlights=!1,this.hideStoryboardIntro=this.localStorageService.get("hideStoryboardIntro"),this.hideCustomizeIntro=this.localStorageService.get("hideCustomizeIntro"),this.ranIntroTour=this.localStorageService.get("ranIntroTour"),this.hideArrangeIntro=this.localStorageService.get("hideArrangeIntro"),this.config.setUserPrefs({language:this.userLanguage,hideUsed:this.hideUsed,highlights:this.highlights,hideStoryboardIntro:this.hideStoryboardIntro,hideCustomizeIntro:this.hideCustomizeIntro,ranIntroTour:this.ranIntroTour,hideArrangeIntro:this.hideArrangeIntro,groupDuplicates:this.groupDuplicates,clusterStoryboard:this.clusterStoryboard})},b.prototype.captureProjectEvents=function(){return this.globalEventHandlers=new a(this.$scope,this.$modal,this.layoutFactory,this.contentService,this.eventBus),this.eventBus.subscribe(this.eventBus.events.CANNOT_ADD_PHOTO_AREA,function(a){return function(){return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE),a.$timeout(function(){return a.globalEventHandlers.handleCannotAddPhotoArea()})}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.NOMORE_PHOTOS_CANBE_ADDED,this.globalEventHandlers.handleNomorePhotosCanbeAdded,this.$scope),this.eventBus.subscribe(this.eventBus.events.SHOW_CRITICAL_ERROR_DIALOG,this.globalEventHandlers.showError,this.$scope),this.eventBus.subscribe(this.eventBus.events.CANNOT_APPLY_LAYOUT,this.globalEventHandlers.showError,this.$scope),this.eventBus.subscribe(this.eventBus.events.COMMAND_EXECUTED,function(a){return function(b,c){if("RemovePageCommand"===c.commandName&&a.isDeviceAPhone())return a.projectService.currentProject.imageCollection.removeUnusedImages()}}(this))},b.prototype.startTour=function(a){return null==a&&(a=!1),this.tourInvokedAtStartup=a,this.eventBus.publish(this.eventBus.events.MODAL_OPENED),this.eventBus.publish(this.eventBus.events.START_INTRO_TOUR,{invokedAtStart:a})},b.prototype.startNewFeatures=function(){return this.eventBus.publish(this.eventBus.events.START_NEW_FEATURES)},b.prototype.startOver=function(){this.$window.location.reload()},b.prototype.setLanguageFromMenu=function(a){return this.config.language=a,this._setLanguage(a)},b.prototype._setLanguage=function(a){return this.config.language=a,this.$translate.uses(a),this.localStorageService.add("language",a)},b.prototype._setLanguageFromBrowser=function(){var a,b;return b=this.config.language,a=this.getFirstBrowserLanguage(),"es"===a?b="es":"fr"===a&&(b="fr"),this._setLanguage(b)},b.prototype.loadUserProject=function(){var a,b,c,d,e,f;return a=this.$q.defer(),b="Failed to load project",e=this.routeUtil.param("projectGuid"),d=function(c){return function(){var d;return d=c.projectService.load(c.user.id,e,c.user.apigeeToken),d.catch(function(){return a.reject(b)}),d.then(function(b){return c.project=b,a.resolve(b),c.eventBus.publish(c.eventBus.events.APP_READY)})}}(this),this.eventBus.subscribe(this.eventBus.events.PROJECT_LOAD,function(){return d()}),f=this.eventBus.subscribe(this.eventBus.events.LOGIN_PROMPT_CLOSED,function(c){return function(){return c.$timeout(function(){return c.eventBus.unsubscribe(f)},0),a.reject(""+b+": user is not authenticated")}}(this)),c=this.userService.userInfo(),c.catch(function(c){return a.reject(""+b+": "+c)}),c.then(function(c){return function(e){var f;return c.user=e,null!=(null!=(f=c.user)?f.id:void 0)?d():c.routeUtil.isCrossSellRequest()?a.reject(""+b+": user is not authenticated"):c.eventBus.publish(c.eventBus.events.LOGIN_PROMPT,c.eventBus.events.PROJECT_LOAD)}}(this)),a.promise},b.prototype.loadSharedProject=function(){var a,b,c,d;return a=this.$q.defer(),b="Failed to load project",d=this.routeUtil.param("shareId"),c=this.projectService.loadShared(d),c.catch(function(){return a.reject(b)}),c.then(function(b){return function(c){return b.project=c,a.resolve(c),b.eventBus.publish(b.eventBus.events.APP_READY)}}(this)),a.promise},b.prototype._loadMagicshopProjectOnUserAuthentication=function(a,b){var c,d,e;return d=this.routeUtil.param("initProjectGUID"),c={userId:this.user.id,accessToken:this.user.oAuthToken,pictureSource:this.routeUtil.param("fromLocation"),interceptSource:this.routeUtil.param("reportingSrc")},e=this.projectService.loadMagicshopProject(c,d),e.catch(function(){return a.reject(b)}),e.then(function(b){return function(c){return b.project=c,a.resolve(c),b.eventBus.publish(b.eventBus.events.APP_READY)}}(this))},b.prototype.loadMagicshopProject=function(){var a,b,c,d;return a=this.$q.defer(),b="Failed to load magic shop project",d=this.eventBus.subscribe(this.eventBus.events.LOGIN_PROMPT_CLOSED,function(c){return function(){return c.$timeout(function(){return c.eventBus.unsubscribe(d)},0),a.reject(""+b+": user is not authenticated")}}(this)),c=this.userService.userInfo(),c.catch(function(c){return a.reject(""+b+": "+c)}),c.then(function(c){return function(d){var e;return c.user=d,null!=(null!=(e=c.user)?e.id:void 0)?c._loadMagicshopProjectOnUserAuthentication(a,b):c.eventBus.publish(c.eventBus.events.LOGIN_PROMPT,c.eventBus.events.MAGIC_SHOP_CONTINUE)}}(this)),this.photoPlacementUppHook.setEnable(!this.config.features.disableAutofill),a.promise},b.prototype.promptForCover=function(a,b){var c,d,e,f,g,h;return c=this.config.appServer,g=this.deviceDetectionService.isDeviceOSAndroidNative(),this.startupMetric.success(),this.config.isBaconV2?(b={appServerPath:c,nativeAndroid:g},this.eventBus.publish(this.eventBus.events.SHOW_BACON_CHOOSE_COVER,b)):(this.omnitureService.trackPageName({pageName:this.omnitureService.SELECT_COVER_PAGE_NAME}),this.eventBus.subscribe(this.eventBus.events.CONTINUE_TO_UPP,function(a){return function(){return a.$timeout(function(){return a._loginAndStartWithUpp()},200)}}(this)),e="iPhone"===this.browserDetectionService.getBrowserName()&&this.browserDetectionService.getBrowserVersion()<8?this._loginAndStartWithUpp:this._startWithUpp,f=this.$modal.open({templateUrl:"SilverApp/views/choose-cover.html",backdrop:"static",controller:"ChooseCoverCtrl",resolve:{data:function(){return{appServerPath:c,nativeAndroid:g}}}}),h=function(){return e(),f.close()},d=function(){return e()},f.result.then(h,d))},b.prototype._promptForUpp=function(a,b){var c,d,e,f;return this.superSimple===!1&&this.config.whatsNewTour&&this.$timeout(function(a){return function(){return a.startNewFeatures()}}(this),500),this.startupMetric.success(),this.omnitureService.backupReportingPageName(),this.omnitureService.trackPageName({pageName:this.omnitureService.INITIAL_ADD_PHOTO_PROMPT_PAGE_NAME}),f="SilverApp/views/"+this.productTrackingStrategy.productizeTemplateDirectory()+"/add-photos-modal.html",d=this.$modal.open({templateUrl:f,backdrop:"static",controller:"SimpleModalCtrl",resolve:{data:function(){return b}}}),e=function(a){return function(){var b;return b=a.omnitureService.getSavedReportingPageName(),b&&a.omnitureService.trackPageName({pageName:b}),a.eventBus.publish(a.eventBus.events.APP_READY),a._startWithUpp()}}(this),c=function(a){return function(){var b,c;return b=a.omnitureService.getSavedReportingPageName(),b&&a.omnitureService.trackPageName({pageName:b}),a.photoPlacementUppHook.setEnable(!0),"function"==typeof(c=a.project).ensureDefaultTitle&&c.ensureDefaultTitle(),a._hoorayForStartupSuccess(),a.eventBus.publish(a.eventBus.events.PALETTE_SELECTION_REQUIRED,{select:"images"}),a.eventBus.publish(a.eventBus.events.APP_READY)}}(this),d.result.then(e,c)},b.prototype.promptChangeStartDate=function(a){var b,c,d,e,f,g;if(this.config.changeStartDate)return b=null!=(g=a.product)?g.pages[1].surfaceKey.split("-"):void 0,d=parseInt(b[0]),c=parseInt(b[1]),f=(new Date).getFullYear(),e=(new Date).getMonth()+1,d<f||d===f&&c<e?this.$scope.ctrls.ChangeStartDateCtrl.openDialog():void 0},b.prototype.welcomeOk=function(){return this._promptForUpp()},b.prototype._startWithArrange=function(){var a;return a=this.tabIntroModalService.open(this.$scope,"hideArrangeIntro",{titleKey:"SilverApp.arrangeTitle",bodyKey:"SilverApp.arrangeText",buttonDtk:"button_arrangeIntro_ok",inputDtk:"button_arrangeIntro_disable"}),a.finally(this.welcomeOk)},b.prototype._startWithStyle=function(){return this.switchToTab("style")},b.prototype._displayTabletWelcomeDialog=function(){var a,b;return b=this.deviceDetectionService.isDeviceAnIpad(),a=this.tabIntroModalService.open(this.$scope,"hideTabletIntro",{titleKey:"SilverApp.tabletTitle",bodyKey:"SilverApp.tabletText",buttonDtk:"button_tabletIntro_ok",inputDtk:"button_tabletIntro_disable",showLink:b}),this.startupMetric.success(),a.finally(this._startWithUpp)},b.prototype._startTourOrUPP=function(){return"upp"===this.config.startupMode?this.$timeout(function(a){return function(){return a._startWithUpp()}}(this),1e3):this.superSimple===!1&&this.config.features.tour===!0&&this.config.tourOnStart&&!this.config.ranIntroTour||this.config.forceTourOnStart?(this.$timeout(function(a){return function(){return a.startTour(!0)}}(this),1e3),this.localStorageService.add("ranIntroTour",!0)):this.$timeout(function(a){return function(){return a._promptForUpp()}}(this),1e3)},b.prototype.startNewProject=function(){var a,b,c,d,e,f,g,h;return this.superSimple&&this.isDeviceATablet()?(d=this.$q.defer(),g=d.promise,d.resolve()):(c=this._getDefaultConstraints(),this.config.smartStoryboard&&(c.SpreadConstraint.min=0,c.SpreadConstraint.max=0),c.LayoutAttributesMatchConstraint={},b={images:[],constraints:c},null!=(e=this.routeUtil.param("coverFinish"))&&(b.finish=e),null!=(a=this.routeUtil.param("binding"))&&(b.binding=a),null!=(h=this.routeUtil.param("stockCoverSpecId"))&&(b.stockCoverSpecId=h),(f=this.routeUtil.param("pageFinish"))&&f===this.enums.PageFinish.GLOSSY&&(b.glossyPages="true"),g=this.projectService.create(b,!1)),g.then(function(a){return function(){return null!=a.routeUtil.param("fromLocation")?a._startWithBookInit(a.routeUtil.param("fromLocation"),a.routeUtil.param("bookInitId"),a.routeUtil.param("interceptSource"),a.routeUtil.param("pictureSource")):a.uppService.loadUppOnStart()&&"editor"!==a.config.defaults.productMode?"normal"===a.config.startupMode?a._startWithUpp():(null!=a.projectService.currentProject.product&&(a.project=a.projectService.currentProject,a.eventBus.publish(a.eventBus.events.PROJECT_LOADED,a.projectService.currentProject)),"arrange"===a.config.startupTab?a.$timeout(function(){return a._startWithArrange()},1e3):"style"!==a.config.startupTab?a.isDeviceAPhone()?(a.omnitureService.trackPageName({pageName:a.omnitureService.ARRANGE_PAGE_NAME}),a.$timeout(function(){return a.promptForCover()},1e3)):a.isDeviceATablet()?a.localStorageService.get("hideTabletIntro")?a._startWithUpp():a.$timeout(function(){return a._displayTabletWelcomeDialog()},1e3):a._startTourOrUPP():void 0):(a.project=a.projectService.currentProject,a.eventBus.publish(a.eventBus.events.PROJECT_LOADED,a.projectService.currentProject),a._hoorayForStartupSuccess(),a.eventBus.publish(a.eventBus.events.APP_READY))}}(this)),g.catch(function(a){return function(b){return a._booForStartupFailure(b.message)}}(this)),g},b.prototype._getDefaultConstraints=function(){var a;return a=this.config.constraints,a.GroupCountConstraint.max=a.GroupCountConstraint.min,a},b.prototype._startWithUpp=function(){var a;return a=this.uppLoader.loadUPP(),a.then(function(a){return function(){return a._hoorayForStartupSuccess()}}(this)),a.catch(function(a){return function(b){return a._booForStartupFailure(b)}}(this))},b.prototype._loginAndStartWithUpp=function(){return this.userService.userInfo().then(function(a){return function(b){return b.isLoggedIn?a._startWithUpp():a.eventBus.publish(a.eventBus.events.LOGIN_PROMPT_FORCE,a.eventBus.events.CONTINUE_TO_UPP)}}(this))},b.prototype._startWithBookInit=function(a,b,c,d){var e;return e=this.bookInitService.request(a,b),e.then(function(a){return function(b){var e,f;if(a.project=a.projectService.currentProject,b.images.length>0)return a.eventBus.publishSync(a.eventBus.events.PLEASE_WAIT_SHOW),f=angular.toJson(a.projectService.currentProject.values),e={images:b.images},null!=c&&(e.interceptSource=c),null!=d&&(e.pictureSource=d),a.projectService.create(e).then(function(){var b;return a.project=a.projectService.currentProject,"function"==typeof(b=a.project).ensureDefaultTitle&&b.ensureDefaultTitle(),a.eventBus.publish(a.eventBus.events.PROJECT_CREATED,{oldProjectJson:f}),a.eventBus.publish(a.eventBus.events.APP_READY)})}}(this))},b.prototype._hoorayForStartupSuccess=function(){return this._hidePleaseWait(),this.omnitureService.trackProjectStart()},b.prototype._booForStartupFailure=function(a){return this.startupMetric.failure({response:a}),this._hidePleaseWait(),this.logger.critical(a)},b}(),c=function(){function a(a){this.routeParams=a}return a.prototype.param=function(a){var b,c,d,e;b=a.toLowerCase(),e=this.routeParams;for(c in e)if(d=e[c],c.toLowerCase()===b)return this.routeParams[c];return null},a.prototype.isCrossSellRequest=function(){return null!=this.param("projectGuid")&&null!=this.param("toSize")&&null!=this.param("toCover")},a}(),e=function(){function a(a,b,c,d,e,g,h,i,j,k,l){this.$scope=a,this.uppService=b,this.uppImageFactory=c,this.config=d,this.projectService=e,this.contentService=g,this.eventBus=h,this.$q=i,this.$timeout=j,this.photoPlacementUppHook=k,this.mainCtrl=l,this._handleUppStart=f(this._handleUppStart,this),this.showAllowUndoAutofillOptionDialog=f(this.showAllowUndoAutofillOptionDialog,this),this.options={backgroundImport:!0,onSignin:function(a){return function(){return a.eventBus.publish(a.eventBus.events.UPP_USER_SIGNIN,{})}}(this),onCancel:function(a){return function(){var b,c,d,e;return a._unsubscribe(),a.mainCtrl.isDeviceMobile()&&(a.eventBus.publishSync(a.eventBus.events.PLEASE_WAIT_SHOW),d=angular.toJson(a.projectService.currentProject.values),c=a.config.constraints,c.GroupCountConstraint.max=c.GroupCountConstraint.min,b={images:[],constraints:c},a.projectService.create(b,!1).then(function(){return a.eventBus.publish(a.eventBus.events.PROJECT_CREATED,{oldProjectJson:d})})),a.photoPlacementUppHook.setEnable(!0),a.mainCtrl.project=a.projectService.currentProject,"function"==typeof(e=a.mainCtrl.project).ensureDefaultTitle&&e.ensureDefaultTitle(),a.eventBus.publish(a.eventBus.events.PROJECT_LOADED,a.projectService.currentProject),a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE),a.eventBus.publish(a.eventBus.events.APP_READY)}}(this),onLoadComplete:function(a){return function(){return a.photoPlacementUppHook.setEnable(!0),a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)}}(this)}}return a.prototype.showAllowUndoAutofillOptionDialog=function(){var a,b;return this.mainCtrl.omnitureService.backupReportingPageName(),b=this.mainCtrl.$modal.open({templateUrl:"SilverApp/views/allow-undo-autofill-modal.html",backdrop:"static",controller:"AllowUndoAutofillModalCtrl"}),a=function(a){return function(){var b;if(a.eventBus.publish(a.eventBus.events.START_UPLOADS),a.eventBus.publish(a.eventBus.events.APP_READY),b=a.mainCtrl.omnitureService.getSavedReportingPageName())return a.mainCtrl.omnitureService.trackPageName({pageName:b})}}(this),b.result.then(a,a)},a.prototype.loadUPP=function(){var a,b,c;return b=this.$q.defer(),c=this.$timeout(function(a){return function(){if(!a.uppService.isUppReady())return b.reject("Could not load picture picker"),a.uppService.uppFailedToLoad()}}(this),1e4),a=function(d){return function(){return d.uppService.isUppReady()?(d.$timeout.cancel(c),d._showUPP(),b.resolve()):d.$timeout(a,500)}}(this),a(),b.promise},a.prototype._unsubscribe=function(){return this.$timeout(function(a){return function(){return a.eventBus.unsubscribe(a.token)}}(this),0)},a.prototype._showUPP=function(){this.token=this.eventBus.subscribe(this.eventBus.events.UPP_IMAGE_START,this._handleUppStart,this.$scope),this.uppService.show("UniversalPicker",this.options)},a.prototype._handleUppStart=function(a,b){return this.uppService.gatherUppImagesData().then(function(a){return function(){var c,d,e,f,g,h;if(f=b.detail.wait.concat(b.detail.done,b.detail.xfer),d=a._convertUppImages(f),a.mainCtrl.superSimple||0!==d.length||a._unsubscribe(),d.length<a.config.defaults.autofillMinImages||d.length>a.config.defaults.autofillMaxImages||a.config.initialAutofill===!1||(null!=(h=a.contentService.currentStyle)?h.allowsAutofill:void 0)===!1){if(a.mainCtrl.project=a.projectService.currentProject,"function"==typeof(g=a.mainCtrl.project).ensureDefaultTitle&&g.ensureDefaultTitle(),a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE),a.mainCtrl.superSimple)return;a.eventBus.publish(a.eventBus.events.PROJECT_LOADED,a.projectService.currentProject),a.eventBus.publish(a.eventBus.events.START_UPLOADS),a.config.initialAutofill&&a.eventBus.publish(a.eventBus.events.PALETTE_THUMBNAILS_ADDED,f),a.eventBus.publish(a.eventBus.events.PALETTE_SELECTION_REQUIRED,{select:"images"}),a.eventBus.publish(a.eventBus.events.APP_READY)}else a.uppService.deferUppEvents(),a.eventBus.publishSync(a.eventBus.events.PLEASE_WAIT_SHOW),e=angular.toJson(a.projectService.currentProject.values),c=a.config.constraints,d.length<c.GroupCountConstraint.min&&(c.GroupCountConstraint.max=c.GroupCountConstraint.min),a.projectService.create({images:d,constraints:c}).then(function(){var b;return a.mainCtrl.project=a.projectService.currentProject,"function"==typeof(b=a.mainCtrl.project).ensureDefaultTitle&&b.ensureDefaultTitle(),a.eventBus.publish(a.eventBus.events.PROJECT_CREATED,{oldProjectJson:e}),a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE),a.config.clearAutofillPrompt?a.$timeout(a.showAllowUndoAutofillOptionDialog):(a.eventBus.publish(a.eventBus.events.START_UPLOADS),a.eventBus.publish(a.eventBus.events.APP_READY))});if(d.length)return a._unsubscribe()}}(this))},a.prototype._convertUppImages=function(a){var b;return b=(a||[]).map(function(a){return function(b){var c;return c=a.uppImageFactory.newInstance(b),"object"==typeof c.data&&(c.data="uppTemp"),c}}(this)).filter(function(a){return null!=a.width})},a}(),b.$inject=["$scope","$route","$routeParams","projectService","uppService","uppImageFactory","eventBus","$modal","loggerFactory","pleaseWaitService","CONFIG","$translate","userService","browserExitService","contentService","localStorageService","browserDetectionService","$window","$timeout","omnitureService","crossSellService","$q","bookInitService","upsellService","photoPlacementUppHook","layoutFactory","enums","spineConversionService","appState","projectUpgradeService","photoccinoService","Fullscreen","productInitializer","globalContentService","tabIntroModalService","productTrackingStrategy","deviceDetectionService","redirectionService","idleTimeoutService","galleon"],angular.module("silverApp").controller("MainCtrl",b)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.$scope=a,this.config=b,this.$rootScope=c,this.$rootScope.showHelp=!1,this.helpOverlay=this.config.helpOverlay,this.$scope.ctrls.HelpOverlayCtrl=this}return a.prototype.showHelpOverlay=function(){return this.$rootScope.showHelp=!0},a}(),a.$inject=["$scope","CONFIG","$rootScope"],angular.module("silverApp").controller("HelpOverlayCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.$scope=a,this.browserDetectionService=b,this.$scope.ctrls={},this.browserName=this.browserDetectionService.getBrowserName(),this.browserVersion=this.browserDetectionService.getBrowserVersion(),this.$scope.ctrls.UnsupportedBrowserCtrl=this}return a}(),a.$inject=["$scope","browserDetectionService"],angular.module("silverApp").controller("UnsupportedBrowserCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.$scope=a,this.$location=b,this.browserExitService=c,this.$scope.ctrls={},this.$scope.ctrls.AdvocateBrowserUpgradeCtrl=this}return a.prototype.goBack=function(){var a;return this.browserExitService.disablePrompt=!0,a=null!=this.$location.search().redir?this.$location.search().redir:"/",this.$location.path(a).search("redir",null).search("warning",!0)},a}(),a.$inject=["$scope","$location","browserExitService"],angular.module("silverApp").controller("AdvocateBrowserUpgradeCtrl",a)}.call(this),function(){var a;a=function(){function a(){}return a.prototype.previous=function(a){return a.previous()},a.prototype.next=function(a){return a.next()},a}(),angular.module("galleon-pb").service("navStrategy",a)}.call(this);(function(){var a;a=function(){function a(){}return a.prototype.previous=function(a,b,c){return b.bottomRightPageSelected?b.selectLeftPage(c):a.previous()},a.prototype.next=function(a,b,c){return!b.activeRightPage.isFiller()&&b.topLeftPageSelected?b.selectRightPage(c):a.next()},a.prototype.nextMonth=function(a,b){return!b.activeRightPage.isFiller()&&b.topLeftPageSelected?a.next():a.nextMonth()},a.prototype.previousMonth=function(a,b){return b.bottomRightPageSelected?a.previous():a.previousMonth()},a}(),angular.module("galleon-gc").service("navStrategy",a)}).call(this);(function(){var a;a=function(){function a(){}return a.prototype.previous=function(a){return a.previous()},a.prototype.next=function(a){return a.next()},a}(),angular.module("galleon-ss").service("navStrategy",a)}).call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g){var h;this.$scope=a,this.userService=b,this.eventBus=c,this.omnitureService=d,this.appState=e,this.$translate=g,this.editor=f.newInstance(),this.editor.$scope=this.$scope,this.editor.updateIsLoggedIn(),this.eventBus.subscribe(this.eventBus.events.ACTIVATE_EVENT_FOR_ASSET,function(a){return function(b,c){return a._activateEventForAsset(c)}}(this)),null==(h=this.$scope).ctrls&&(h.ctrls={}),this.$scope.ctrls.EventsCtrl=this,this.selectedEventFilter=this.eventFilters.SHOW_ALL,this.activatedEvent=0}return a.prototype.eventHover=null,a.prototype.imageHover=null,a.prototype.eventFilters={SHOW_ALL:"showAll",MY_EVENTS:"myEvents",PUBLIC_HOLIDAYS:"publicEvents"},a.prototype.eventFilterCriteria={showAll:{visibility:"!!"},myEvents:{visibility:"!public"},publicEvents:{visibility:"public"}},a.prototype.translatePhotoRadioLabel=function(a,b){return""+b+this.$translate("Calendar.cover."+a.month)+" "+a.day},a.prototype.finishEditingEvent=function(){var a;return a=this.editor.finishEditingEvent(),this._animateToNewEvent(a)},a.prototype.saveNewEvent=function(){return this.editor.saveNewEvent().then(function(a){return function(b){return a._animateToNewEvent(b)}}(this))},a.prototype._activateEventForAsset=function(a){var b,c;return this.editor.activate(),b={month:a.dateObj.month,day:this.editor.getDayFromAsset(a.asset)},c=".date_"+b.month+"-"+b.day,setTimeout(function(d){return function(){var e;return(null!=(e=a.asset)?e.hasContent():void 0)?d.$scope.$apply(function(){return d.activatedEventTargetClassifier=c,d.activatedEvent++}):void d.editor.startCreatingNewEvent(b)}}(this),500)},a.prototype.tabWasMadeActive=function(){return this.editor.activate(),this.appState.activeTab="events",this.omnitureService.trackPageName({pageName:"/@@p/Events"}),this.appState.customizeMode=this.appState.customize.NONE,this.userService.isUserSignedIn().then(function(a){return function(b){if(a.editor.isLoggedIn=b,a.editor.publicEventsLoaded||a.editor.loadPublicEvents(),a.editor.myEventsLoaded||a.editor.loadMyEvents(),!a.editor.isLoggedIn)return a.editor.login()}}(this))},a.prototype.tabWasMadeInactive=function(){return this.editor.cancelCreatingNewEvent(),this.editor.deactivate()},a.prototype._animateToNewEvent=function(a){return setTimeout(function(){var b;return b=$(".event-list"),b.animate({scrollTop:b.scrollTop()+$(".event_"+a.id).offset().top-165},50)})},a}(),a.$inject=["$scope","userService","eventBus","omnitureService","appState","eventsEditingServiceFactory","$translate"],angular.module("galleon-gc").controller("EventsCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l,m){this.$scope=a,this.$modalInstance=c,this.eventBus=d,this.projectService=e,this.config=f,this.$timeout=h,this.graphicAssetFactory=i,this.textAssetFactory=j,this.imageAssetFactory=k,this.calendarGrid=l,this.imageCollection=m,this._refreshCellPreview=b(this._refreshCellPreview,this),this.eventBus.subscribe(this.eventBus.events.CALENDAR_EVENT_UPDATED,this._refreshCellPreview,this.$scope),this.eventBus.subscribe(this.eventBus.events.SURFACE_IMAGE_ADDED,this._refreshCellPreview,this.$scope),this.$scope.ctrls.EventsDialogCtrl=this,this.eventsDate={month:1,day:1,year:2016},this.isEmptyGrid=!1,this.dateClass="2016-1",this.hasAssignedValue=!1,this._activateEventForAsset(g)}return a.prototype.dismiss=function(){return this.hasAssignedValue=!1,this.$modalInstance.dismiss()},a.prototype._refreshCellPreview=function(a,b){var c;c=this.calendarGrid.getEditableAssetsByClickedGridCellAsset(this.page,this.originalAsset).gridCellAssets,this._parseEditableAssets(this.originalAsset,c),this._recheckImageEmptiness()},a.prototype._recheckImageEmptiness=function(){var a,b;return(null!=(b=this.imageAsset)?b.hasAssignedImage():void 0)?(a=this.imageCollection.getImageByProductImageId(this.imageAsset.projectImageId),this.isEmptyGrid=a.isThumb):this.isEmptyGrid=!0},a.prototype._activateEventForAsset=function(a){if(!this.hasAssignedValue)return this.hasAssignedValue=!0,this.dateClass=(null!=a?a.dateObj.year:void 0)+"-"+(null!=a?a.dateObj.month:void 0),this.isEmptyGrid=null!=a?a.emptyGrid:void 0,this._getEventInfo(null!=a?a.dateObj:void 0),this._parseEditableAssets(a.originalAsset,a.gridCellAssets),this.page=a.page,this.eventsDialogItems={editPhoto:this.originalAsset===this.imageAsset&&this.imageAsset.hasAssignedImage(),event:this.originalAsset===this.eventTextAsset||this.originalAsset===this.imageAsset&&!this.imageAsset.hasAssignedImage(),textStyle:this.originalAsset===this.dateTextAsset},this.activeTextTab="event",this.originalAsset===this.dateTextAsset?this.activeTextTab="date":void 0},a.prototype._parseEditableAssets=function(a,b){var c,d,e,f,g,h,i,j;for(this.gridCellAssets=this._duplicateGridCellAssets(b),g={},e={},j=this.gridCellAssets,
h=0,i=j.length;h<i;h++)c=j[h],c.asset.assetType===c.asset.constructor.IMAGE_TYPE?e[c.asset.containerId]=c:c.asset.assetType===c.asset.constructor.TEXT_TYPE&&(g[c.asset.guidanceText]=c);a.asset.assetType===c.asset.constructor.IMAGE_TYPE?(this.imageAsset=e[a.asset.containerId],this.originalAsset=this.imageAsset):a.asset.assetType===c.asset.constructor.TEXT_TYPE&&(this.imageAsset=e[a.associatedImage],this.originalAsset=g[a.asset.guidanceText]),delete e[this.imageAsset.asset.containerId];for(d in g)f=g[d],f.associatedImage===this.imageAsset.asset.containerId&&(/event-[0-9]+$/.test(d)?this.eventTextAsset=f:this.dateTextAsset=f,delete g[d]);return this._removeUnreferencedEditableAssets(g,e)},a.prototype._duplicateGridCellAssets=function(a){var b,c,d,e,f;for(c=[],e=0,f=a.length;e<f;e++)switch(b=a[e],d=JSON.parse(JSON.stringify(b.asset.values)),b.asset.assetType){case b.asset.constructor.GRAPHIC_TYPE:c.push(this.graphicAssetFactory.newInstance(d));break;case b.asset.constructor.TEXT_TYPE:c.push(this.textAssetFactory.newInstance(d));break;case b.asset.constructor.IMAGE_TYPE:c.push(this.imageAssetFactory.newInstance(d))}return c},a.prototype._removeUnreferencedEditableAssets=function(a,b){var c,d,e,f;for(d=e=f=this.gridCellAssets.length-1;f<=0?e<=0:e>=0;d=f<=0?++e:--e)c=this.gridCellAssets[d],(c.asset.assetType===c.asset.constructor.IMAGE_TYPE&&null!=b[c.asset.containerId]||c.asset.assetType===c.asset.constructor.TEXT_TYPE&&null!=a[c.asset.guidanceText])&&this.gridCellAssets.splice(d,1);return this.gridCellAssets},a.prototype._getEventInfo=function(a){var b,c,d;return c=a.month,b=a.day,d=a.year,b=parseInt(b,10),c=parseInt(c,10),d=this._inferYear(c),this.eventsDate={month:c,day:b,year:d}},a.prototype._inferYear=function(a){var b,c;return b=this.projectService.currentProject.product.getCalendarStartDate(),c=b.year,a<b.month&&(c+=1),c},a.prototype.editEvents=function(){return this._flushChanges(),this.$timeout(function(a){return function(){return a.eventsDialogItems={event:!0,textStyle:!1,editPhoto:!1}}}(this),0)},a.prototype.editTextStyle=function(){return this._flushChanges(),this.$timeout(function(a){return function(){return a.eventsDialogItems={event:!1,textStyle:!0,editPhoto:!1}}}(this),0)},a.prototype.editPhoto=function(){if(!this.isEmptyGrid)return this._flushChanges(),this.$timeout(function(a){return function(){return a.eventsDialogItems={event:!1,textStyle:!1,editPhoto:!0}}}(this),0)},a.prototype.setTabChangedCallback=function(a){this.tabChangedCallback=a},a.prototype._flushChanges=function(){return"function"==typeof this.tabChangedCallback&&this.tabChangedCallback(),this.setTabChangedCallback(null)},a.prototype.commit=function(){return this._flushChanges(),this.dismiss()},a}(),a.$inject=["$scope","$modalInstance","eventBus","projectService","CONFIG","data","$timeout","graphicAssetFactory","textAssetFactory","imageAssetFactory","calendarGrid","imageCollection"],angular.module("galleon-gc").controller("EventsDialogCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.$scope=a,this.$modalInstance=b,this.dragDropService=c,this.$scope.ctrls.MissDayTargetWarningCtrl=this,this.doNotShowAgain=!1}return a.prototype.close=function(){return this.dragDropService.doNotShwoWarningAgain=this.doNotShowAgain,this.$modalInstance.dismiss("cancel")},a}(),a.$inject=["$scope","$modalInstance","dragDropService"],angular.module("galleon-gc").controller("MissDayTargetWarningCtrl",a)}.call(this),function(){var a,b,c,d,e=function(a,b){return function(){return a.apply(b,arguments)}};d=function(){function a(a,b,c,d,f,g,h,i,j,k,l,m,n,o,p,q){this.$scope=a,this.navService=b,this.$timeout=c,this.eventBus=d,this.pageResizer=f,this.config=g,this.appState=h,this.omnitureService=i,this.$interval=j,this.pageDimensionCalculator=k,this.navStrategy=l,this.deviceDetectionService=n,this.projectService=o,this.$modal=p,this.imageCollection=q,this._nextPageOnTimer=e(this._nextPageOnTimer,this),this._refreshActiveSpread=e(this._refreshActiveSpread,this),this.setZoomValue=e(this.setZoomValue,this),this.animating=!1,this.waitingToRefresh=!1,this.superSimple=this.config.superSimple,this.superSimpleTablet=this.superSimple&&this.deviceDetectionService.isDeviceATablet(),this.startupTab=this.config.startupTab,this.showNewNavigation=this.config.newNav,this.playing=!1,this.isPhotoSpready=!1,this.zoomFactor=this.config.zoomFactor,this.zoomMin=100*this.zoomFactor,this.pagesViewIsActive=!1,this.previewFromPagesView=!1,this.config.startWithSummary||this.superSimpleTablet&&!this.appState.inSlideshow?this._setSummaryVisible(!0):this._setSummaryVisible(!1),this.$scope.$watch(function(a){return function(){var b;return null!=(b=a.navService)?b.showingSummary:void 0}}(this),function(a){return function(b){return a.showingSummary=b}}(this)),this.config.zoom&&this.$scope.$watch("ctrls.NavCtrl.zoomMin",function(a){return function(b){return a.setZoomValue(b)}}(this)),this.$timeout(function(){return m.$broadcast("rzSliderForceRender")}),"arrange"===this.startupTab||this.deviceDetectionService.isDeviceAPhone()&&!h.inSlideshow?this.arrangeIsActive=!0:"storyboard"===this.startupTab?this.storyboardIsActive=!0:"style"===this.startupTab?this.styleIsActive=!0:(this.editIsActive=!0,this.omnitureService.trackPageName({pageName:this.omnitureService.EDIT_PAGE_NAME})),this._setViewablePages(),this.eventBus.subscribe(this.eventBus.events.STOP_AUTOPLAY,function(a){return function(b,c){return a.cancelPlay()}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.SELECT_EDIT_TAB,function(a){return function(b,c){if(a.editIsActive=!0,a.superSimple&&a.deviceDetectionService.isDeviceAPhone())return a.arrangeIsActive=!0}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.SELECT_ARRANGE_TAB,function(a){return function(b,c){return a.arrangeIsActive=!0,a.appState.customizeMode=a.appState.customize.NONE}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.SELECT_STORYBOARD_TAB,function(a){return function(b,c){return a.storyboardIsActive=!0,a.appState.customizeMode=a.appState.customize.NONE}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.SELECT_BOOK_TAB,function(a){return function(b,c){return a.bookIsActive=!0,a.appState.customizeMode=a.appState.customize.NONE}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.SELECT_STYLE_TAB,function(a){return function(b,c){return a.styleIsActive=!0,a.appState.customizeMode=a.appState.customize.NONE}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.SURFACE_SELECTED,function(a){return function(b,c){return a.selectedPage=a.navService.selectedPage,a.appState.cancelBackgroundWaitingForPicture(),a.isPhotoSpready=a.navService.currentlyPhotoSpready(),a._setViewablePages()}}(this),this.$scope),this.eventBus.events.SELECT_EVENTS_TAB&&(this.eventBus.subscribe(this.eventBus.events.SELECT_EVENTS_TAB,function(a){return function(b,c){return a.selectEventsTab(c.page,c.asset,c.dateAsset,c.eventAsset,c.imageAsset,c.gridCellAssets)}}(this)),this.eventBus.subscribe(this.eventBus.events.SELECT_EVENTS_TAB_FROM_PALETTE,function(a){return function(b,c){return a.storyboardIsActive=!1,a.editIsActive=!1,a.eventsIsActive=!0,a.appState.customizeMode=a.appState.customize.NONE}}(this),this.$scope)),this.eventBus.subscribe(this.eventBus.events.SURFACE_INVALIDATED,this._refreshActiveSpread,this.$scope),this.eventBus.subscribe(this.eventBus.events.COMMAND_EXECUTED,function(a){return function(b,c){var d,e,f,g,h,i,j;if(a.appState.cancelBackgroundWaitingForPicture(),null!=c.activePageNumber)switch(c.commandName){case"AddPagesCommand":return"function"==typeof(d=a.navService).gotoPage?d.gotoPage(c.activePageNumber):void 0;case"AutofillFilledBookCommand":case"AutofillBlankBookCommand":case"UndoAutofillCommand":return a.navService.selectedPage.surfaceNumber!==c.activePageNumber?"function"==typeof(e=a.navService).gotoPage?e.gotoPage(c.activePageNumber,!0):void 0:a._refreshActiveSpread();case"MoveWellImageCommand":case"SwapWellImageCommand":case"MoveStoryBoardPageImageCommand":return a.navService.selectedPage.surfaceNumber!==c.activePageNumber?"function"==typeof(f=a.navService).gotoPage?f.gotoPage(c.activePageNumber,!0):void 0:a._refreshActiveSpread();default:if(c.activePageNumber!==(null!=(h=a.selectedPage)?h.surfaceNumber:void 0)&&c.activePageNumber!==(null!=(i=a.activeLeftPage)?i.surfaceNumber:void 0)&&c.activePageNumber!==(null!=(j=a.activeRightPage)?j.surfaceNumber:void 0))return"function"==typeof(g=a.navService).gotoPage?g.gotoPage(c.activePageNumber):void 0}}}(this),this.$scope),this.$scope.ctrls.NavCtrl=this}return a.FIRST_SPREAD_INDEX=-1,a.MIDDLE_SPREAD_INDEX=0,a.LAST_SPREAD_INDEX=1,a.prototype.setZoomValue=function(a){return this.zoomFactor=a/100,this.appState.zoomFactor=this.zoomFactor,a>this.zoomMin&&this.selectLeftPage(),this.resize()},a.prototype.changeValueToPercentage=function(a){return a+"%"},a.prototype.selectEventsTab=function(a,b,c,d,e,f){var g,h,i,j;return h=this._surfaceKeyToObj(this.activeLeftPage.surfaceKey,d),this.config.calendarV2?((null!=e?e.hasAssignedImage():void 0)?(j=this.imageCollection.getImageByProductImageId(e.projectImageId),i=j.isThumb):i=!0,g={asset:d,dateAsset:c,dateObj:h,emptyGrid:i,imageAsset:e,originalAsset:b,gridCellAssets:f,page:a},this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/gc/event-dialog.html",backdrop:"static",controller:"EventsDialogCtrl",resolve:{data:function(){return g}}})):(this.storyboardIsActive=!1,this.editIsActive=!1,this.eventsIsActive=!0,this.appState.customizeMode=this.appState.customize.NONE,d?this.eventBus.publish(this.eventBus.events.ACTIVATE_EVENT_FOR_ASSET,{asset:d,dateObj:h}):void 0)},a.prototype._surfaceKeyToObj=function(a,b){var c,d;return c=a.split("-"),2!==c.length?null:d={day:""+(null!=b?b.dateValue:void 0),month:c[1],year:c[0]}},a.prototype._setViewablePages=function(){var a;return this.animating?void(this.waitingToRefresh=!0):(this.waitingToRefresh=!1,a=this._shouldMoveSpread(),this.lastDirectionForward=this.navService.lastDirectionForward,this.activeLeftPage=this.navService.leftPage,this.activeRightPage=this.navService.rightPage,this.spinePage=this.navService.spinePage,a&&this._moveSpread(),null!=this.spreadSize?this.updatePageDimensions(this.spreadSize.width,this.spreadSize.height):void 0)},a.prototype._shouldMoveSpread=function(){var a,b,c,d,e;return!((null!=(a=this.activeLeftPage)?a.surfaceNumber:void 0)===(null!=(b=this.navService)&&null!=(c=b.leftPage)?c.surfaceNumber:void 0)||(null!=(d=this.activeRightPage)?d.surfaceNumber:void 0)===(null!=(e=this.navService.rightPage)?e.surfaceNumber:void 0))},a.prototype._moveSpread=function(){return this.appState.customizeMode===this.appState.customize.PASSIVE&&(this.appState.customizeMode=this.appState.customize.NONE),this.lastDirectionForward?this._moveActiveSpreadForward():this._moveActiveSpreadBackward()},a.prototype._refreshActiveSpread=function(){switch(this.selectedPage=this.navService.selectedPage,this.isPhotoSpready=this.navService.currentlyPhotoSpready(),this.activeLeftPage=this.navService.leftPage,this.activeRightPage=this.navService.rightPage,this.spinePage=this.navService.spinePage,this.activeSpreadIndex){case this.constructor.FIRST_SPREAD_INDEX:this.firstLeftPage=this.activeLeftPage,this.firstRightPage=this.activeRightPage;break;case this.constructor.MIDDLE_SPREAD_INDEX:this.middleLeftPage=this.activeLeftPage,this.middleRightPage=this.activeRightPage;break;case this.constructor.LAST_SPREAD_INDEX:this.lastLeftPage=this.activeLeftPage,this.lastRightPage=this.activeRightPage}return this.$scope.$evalAsync()},a.prototype._updateSideSelectedState=function(){var a;if(null!=this.navService.selectedPage)return a=this.navService.selectedPage.surfaceNumber,this.topLeftPageSelected=null!=this.activeLeftPage&&this.activeLeftPage.surfaceNumber===a,this.bottomRightPageSelected=null!=this.activeRightPage&&this.activeRightPage.surfaceNumber===a},a.prototype.trackPreviewPageLoad=function(){return this.omnitureService.trackPageName({pageName:this.omnitureService.PB_PREVIEW_PAGE_NAME})},a.prototype.cancelPlay=function(){return this.$interval.cancel(this.timer),this.playing=!1},a.prototype.startPlay=function(){return this.showingSummary&&this.hideSummary(),this.timer=this.$interval(this._nextPageOnTimer,3e3),this.playing=!0},a.prototype.play=function(){if(this.editIsActive&&!this.animating)return this.playing?this.cancelPlay():(this.navService.isLastPage()&&this.next(),this.startPlay())},a.prototype._nextPageOnTimer=function(){var a;if(this.editIsActive&&!this.animating)return this.navService.isLastPage()||this.navService.isLastPage(this.navService.rightPage)?this.cancelPlay():(a=!0,this.navStrategy.next(this.navService,this,a))},a.prototype.next=function(){if(this.editIsActive&&!this.animating)return this.playing&&this.cancelPlay(),this.showingSummary?(this.hideSummary(),this.superSimpleTablet?this.$timeout(function(a){return function(){return a.navService.gotoPage(a.selectedPage.constructor.TITLE_PAGE_NUMBER)}}(this),100):this.appState.inSlideshow?this.navStrategy.next(this.navService,this):void 0):this.navService.isLastSpread()&&this.appState.inSlideshow?this.showSummary():this.navService.isLastPage()&&this.superSimpleTablet&&!this.appState.inSlideshow?this.showSummary():this.navStrategy.next(this.navService,this)},a.prototype.previous=function(){if(this.editIsActive&&!this.animating)return this.playing&&this.cancelPlay(),this.navService.isFirstSpread()&&this.superSimpleTablet&&!this.appState.inSlideshow?this.showSummary():this.navStrategy.previous(this.navService,this)},a.prototype.nextMonth=function(){if(this.editIsActive&&!this.animating)return this.playing&&this.cancelPlay(),this.showingSummary?(this.hideSummary(),this.navStrategy.nextMonth(this.navService,this)):this.navService.isLastMonth()&&this.appState.inSlideshow?this.showSummary():this.navStrategy.nextMonth(this.navService,this)},a.prototype.previousMonth=function(){if(this.editIsActive&&!this.animating)return this.playing&&this.cancelPlay(),this.navStrategy.previousMonth(this.navService,this)},a.prototype.selectLeftPage=function(a){if(this.selectedPage!==this.activeLeftPage)return this.playing&&!a&&this.cancelPlay(),this.navService.setSelectedPage(this.activeLeftPage),this._updateSideSelectedState()},a.prototype.selectRightPage=function(a){if(this.selectedPage!==this.activeRightPage)return this.playing&&!a&&this.cancelPlay(),this.navService.setSelectedPage(this.activeRightPage),this._updateSideSelectedState()},a.prototype.selectSpinePage=function(){if(this.selectedPage!==this.spinePage)return this.navService.setSelectedPage(this.spinePage)},a.prototype.resize=function(){if(null!=this.spreadSize)return null==this.originalSpreadSize&&(this.originalSpreadSize={width:this.spreadSize.width,height:this.spreadSize.height}),this.updatePageDimensions(this.originalSpreadSize.width*this.zoomFactor,this.originalSpreadSize.height*this.zoomFactor)},a.prototype.updatePageDimensions=function(a,b){var c,d;if("edit"!==this.appState.activeTab&&!this.appState.inSlideshow||0!==a&&0!==b){this.previousPageWidth=this.pageWidth,this.previousPageHeight=this.pageHeight,this.spreadSize={width:a,height:b},this.originalSpreadSize={width:a/this.zoomFactor,height:b/this.zoomFactor},this.spineWidth=0,d=this.pageDimensionCalculator.calc(this.spreadSize,[this.activeLeftPage,this.activeRightPage],[this.navService.previousLeftPage,this.navService.previousRightPage],this.spinePage,this.pageResizer),this.pageWidth=d.pageWidth,this.pageHeight=d.pageHeight,this.pageHeightSansSpine=d.pageHeightSansSpine,this.spineWidth=d.spineWidth,null==this.previousPageWidth&&(this.previousPageWidth=this.pageWidth),null==this.previousPageHeight&&(this.previousPageHeight=this.pageHeight);try{return this.$scope.$digest()}catch(a){c=a}}},a.prototype.updateSummaryDimensions=function(a,b){var c,d;if(!this.summaryPage)return void(a&&b&&(this.summaryPageSize={width:a,height:b}));d=this.pageResizer.sizeForPageAndSize(this.summaryPage,{width:a,height:b}),this.pageWidth=d.width,this.pageHeight=d.height;try{return this.$scope.$digest()}catch(a){c=a}},a.prototype._moveActiveSpreadForward=function(){switch(this.activeSpreadIndex){case this.constructor.FIRST_SPREAD_INDEX:return this._initMiddleSpreadIndex();case this.constructor.MIDDLE_SPREAD_INDEX:return this._initLastSpreadIndex();case this.constructor.LAST_SPREAD_INDEX:return this._initFirstSpreadIndex();default:return this._initMiddleSpreadIndex()}},a.prototype._moveActiveSpreadBackward=function(){switch(this.activeSpreadIndex){case this.constructor.FIRST_SPREAD_INDEX:return this._initLastSpreadIndex();case this.constructor.MIDDLE_SPREAD_INDEX:return this._initFirstSpreadIndex();case this.constructor.LAST_SPREAD_INDEX:return this._initMiddleSpreadIndex();default:return this._initMiddleSpreadIndex()}},a.prototype._initFirstSpreadIndex=function(){return this.activeSpreadIndex=this.constructor.FIRST_SPREAD_INDEX,this.lastDirectionForward?(this.previousSpreadIndex=this.constructor.LAST_SPREAD_INDEX,this.nextSpreadIndex=this.constructor.MIDDLE_SPREAD_INDEX):(this.previousSpreadIndex=this.constructor.MIDDLE_SPREAD_INDEX,this.nextSpreadIndex=this.constructor.LAST_SPREAD_INDEX),this._setSpreadStageState(),this.firstLeftPage=this.navService.leftPage,this.firstRightPage=this.navService.rightPage},a.prototype._setUpPreviousNextForFirstSpread=function(){return this.waitingToRefresh?void this._setViewablePages():(this.lastLeftPage=this.navService.previousLeftPage,this.lastRightPage=this.navService.previousRightPage,this.middleLeftPage=this.navService.nextLeftPage,this.middleRightPage=this.navService.nextRightPage)},a.prototype._initMiddleSpreadIndex=function(a,b){return this.activeSpreadIndex=this.constructor.MIDDLE_SPREAD_INDEX,this.lastDirectionForward?(this.previousSpreadIndex=this.constructor.FIRST_SPREAD_INDEX,this.nextSpreadIndex=this.constructor.LAST_SPREAD_INDEX):(this.previousSpreadIndex=this.constructor.LAST_SPREAD_INDEX,this.nextSpreadIndex=this.constructor.FIRST_SPREAD_INDEX),this._setSpreadStageState(),this.middleLeftPage=this.navService.leftPage,this.middleRightPage=this.navService.rightPage},a.prototype._setUpPreviousNextForMiddleSpread=function(){return this.waitingToRefresh?void this._setViewablePages():(this.firstLeftPage=this.navService.previousLeftPage,this.firstRightPage=this.navService.previousRightPage,this.lastLeftPage=this.navService.nextLeftPage,this.lastRightPage=this.navService.nextRightPage)},a.prototype._initLastSpreadIndex=function(a,b){return this.activeSpreadIndex=this.constructor.LAST_SPREAD_INDEX,this.lastDirectionForward?(this.previousSpreadIndex=this.constructor.MIDDLE_SPREAD_INDEX,this.nextSpreadIndex=this.constructor.FIRST_SPREAD_INDEX):(this.previousSpreadIndex=this.constructor.FIRST_SPREAD_INDEX,this.nextSpreadIndex=this.constructor.MIDDLE_SPREAD_INDEX),this._setSpreadStageState(),this.lastLeftPage=this.navService.leftPage,this.lastRightPage=this.navService.rightPage},a.prototype._setUpPreviousNextForLastSpread=function(){return this.waitingToRefresh?void this._setViewablePages():(this.middleLeftPage=this.navService.previousLeftPage,this.middleRightPage=this.navService.previousRightPage,this.firstLeftPage=this.navService.nextLeftPage,this.firstRightPage=this.navService.nextRightPage)},a.prototype._setSpreadStageState=function(){return this.firstSpreadIndexOffstageRight=this._spreadIndexShouldBeOffstageRight(this.constructor.FIRST_SPREAD_INDEX),this.firstSpreadIndexOffstageLeft=this._spreadIndexShouldBeOffstageLeft(this.constructor.FIRST_SPREAD_INDEX),this.middleSpreadIndexOffstageRight=this._spreadIndexShouldBeOffstageRight(this.constructor.MIDDLE_SPREAD_INDEX),this.middleSpreadIndexOffstageLeft=this._spreadIndexShouldBeOffstageLeft(this.constructor.MIDDLE_SPREAD_INDEX),this.lastSpreadIndexOffstageRight=this._spreadIndexShouldBeOffstageRight(this.constructor.LAST_SPREAD_INDEX),this.lastSpreadIndexOffstageLeft=this._spreadIndexShouldBeOffstageLeft(this.constructor.LAST_SPREAD_INDEX),this._updateSideSelectedState()},a.prototype._spreadIndexShouldBeOffstageRight=function(a){return this.lastDirectionForward&&this.nextSpreadIndex===a||!this.lastDirectionForward&&this.previousSpreadIndex===a},a.prototype._spreadIndexShouldBeOffstageLeft=function(a){return!this.lastDirectionForward&&this.nextSpreadIndex===a||this.lastDirectionForward&&this.previousSpreadIndex===a},a.prototype.tabWasMadeActive=function(){if(this.appState.activeTab="edit",this.appState.customizeMode=this.appState.customize.NONE,this.$scope.ctrls.PagesCtrl.currentPaletteItemIndex=this.activeSpreadIndex,this.eventBus.publish(this.eventBus.events.ENSURE_SECONDARY_PALETTE_REDRAW),this.appState.inPreviewMode||this.omnitureService.trackPageName({pageName:this.omnitureService.EDIT_PAGE_NAME}),this.zoomFactor>1)return this.selectLeftPage()},a.prototype.handleSpreadTransitionStart=function(){return this.animating=!0},a.prototype.handleSpreadTransitionStop=function(){switch(this.animating=!1,this.activeSpreadIndex){case this.constructor.FIRST_SPREAD_INDEX:this._setUpPreviousNextForFirstSpread();break;case this.constructor.MIDDLE_SPREAD_INDEX:this._setUpPreviousNextForMiddleSpread();break;case this.constructor.LAST_SPREAD_INDEX:this._setUpPreviousNextForLastSpread()}return this.eventBus.publish(this.eventBus.events.SURFACE_ANIMATION_DONE)},a.prototype.showSummary=function(){if(this.playing&&this.cancelPlay(),this._setSummaryVisible(!0),this.superSimpleTablet)return this._setFrontCoverAsSelected()},a.prototype.hideSummary=function(){if(this.showingSummary===!0)return this._setSummaryVisible(!1)},a.prototype._setSummaryVisible=function(a){return this.showingSummary=a,this.navService.showingSummary=a},a.prototype._setFrontCoverAsSelected=function(){return this.navService.setSelectedPage(this.projectService.currentProject.product.cover.frontPage,!0)},a.prototype.summaryPageLoaded=function(a){return this.summaryPage=a,this.summaryPageSize&&this.updateSummaryDimensions(this.summaryPageSize.width,this.summaryPageSize.height),this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_HIDE)},a.prototype.enterPreview=function(a){return this.previewFromPagesView=a,this.editIsActive=!0},a.prototype.exitPreview=function(){return this.previewFromPagesView?this.pagesViewIsActive=!0:this.arrangeIsActive=!0},a.prototype.exitPreviewText=function(){return this.previewFromPagesView?"SilverApp.edit":"SilverApp.returnToEdit"},a}(),d.$inject=["$scope","navService","$timeout","eventBus","pageResizer","CONFIG","appState","omnitureService","$interval","pageDimensionCalculator","navStrategy","$rootScope","deviceDetectionService","projectService","$modal","imageCollection"],angular.module("silverApp").controller("NavCtrl",d),a=function(){function a(a){this.$scope=a,this.$scope.ctrls.FirstSpreadCtrl=this,this.$scope.spreadIndex=d.FIRST_SPREAD_INDEX,this.$scope.leftPageId="firstLeftPage",this.$scope.rightPageId="firstRightPage",this.$scope.spinePageId="firstSpinePage",this.$scope.offstageRightId="firstSpreadIndexOffstageRight",this.$scope.offstageLeftId="firstSpreadIndexOffstageLeft"}return a}(),a.$inject=["$scope"],angular.module("silverApp").controller("FirstSpreadCtrl",a),c=function(){function a(a){this.$scope=a,this.$scope.ctrls.MiddleSpreadCtrl=this,this.$scope.spreadIndex=d.MIDDLE_SPREAD_INDEX,this.$scope.leftPageId="middleLeftPage",this.$scope.rightPageId="middleRightPage",this.$scope.spinePageId="middleSpinePage",this.$scope.offstageRightId="middleSpreadIndexOffstageRight",this.$scope.offstageLeftId="middleSpreadIndexOffstageLeft"}return a}(),c.$inject=["$scope"],angular.module("silverApp").controller("MiddleSpreadCtrl",c),b=function(){function a(a){this.$scope=a,this.$scope.ctrls.LastSpreadCtrl=this,this.$scope.spreadIndex=d.LAST_SPREAD_INDEX,this.$scope.leftPageId="lastLeftPage",this.$scope.rightPageId="lastRightPage",this.$scope.spinePageId="lastSpinePage",this.$scope.offstageRightId="lastSpreadIndexOffstageRight",this.$scope.offstageLeftId="lastSpreadIndexOffstageLeft"}return a}(),b.$inject=["$scope"],angular.module("silverApp").controller("LastSpreadCtrl",b)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g){this.$scope=a,this.pricingService=c,this.$translate=e,this.projectService=f,this.$modal=g,this.onProjectPriceChange=b(this.onProjectPriceChange,this),this.onProjectChanged=b(this.onProjectChanged,this),d.subscribe(d.events.PROJECT_LOADED,this.onProjectChanged,a),d.subscribe(d.events.PROJECT_MODIFIED,this.onProjectChanged,a),d.subscribe(d.events.PROJECT_PRICE_CHANGE,this.onProjectPriceChange,a),null==this.$scope.ctrls&&(this.$scope.ctrls={}),this.priceableComponents=null,this.defaultPricing=this.pricingService.getDefaultPricing(),this.$scope.ctrls.PriceCtrl=this,this.$scope.project=null,this.$scope.bookPricing=this.defaultPricing,this.hasShownCapDialog=!1}return a.prototype.onProjectChanged=function(a,b){var c;return this.$scope.project=b,c=this.pricingService.getProjectPrice(b),c.then(function(a){return function(c){return a.$scope.bookPricing=a._aggregateStorytellingPricing(c.pricing),a.priceableComponents=c.priceableComponents,b.setInitalReportingValue("initialPrice",c.pricing.totalOrigPrice)}}(this)),c.catch(function(a){return function(b){return a.$scope.bookPricing=a.defaultPricing,a.priceableComponents=null}}(this))},a.prototype.onProjectPriceChange=function(a){var b;return this.$scope.project=this.projectService.currentProject,b=this.pricingService.getIncrementalProjectPrice(this.$scope.project),b.then(function(a){return function(b){return a.$scope.bookPricing=a._aggregateStorytellingPricing(b.pricing),a.priceableComponents=b.priceableComponents}}(this)),b.catch(function(a){return function(b){return a.$scope.bookPricing=a.defaultPricing,a.priceableComponents=null}}(this))},a.prototype._aggregateStorytellingPricing=function(a){var b,c,d,e,f,g;if(c=a.contentPrice,null==(null!=c?c.contentCategory:void 0))return a;for(b={sku:"ST",quantity:0},g=c.contentCategory,e=0,f=g.length;e<f;e++){if(d=g[e],"PASS_SFLY"===d.sku||/Storytelling Style/.test(d.description))return this.pricingService.shouldChargeForPremiumItems=!1,"PASS_SFLY"===d.sku?(b.description=this._translate("SilverApp.storytellingPass"),this._showStorytellingCapModal()):b.description=this._translate("SilverApp.storytellingStyle"),b.quantity=1,b.totalOrigPrice=d.totalOrigPrice,b.totalSalePrice=d.totalSalePrice,this._createPriceFromAggregate(a,b);/Storytelling/.test(d.description)&&(b.quantity+=d.quantity)}return this.pricingService.shouldChargeForPremiumItems=!0,b.quantity>0?(b.description=this._translate("SilverApp.storytellingItemCount",b.quantity),b.totalOrigPrice=c.totalOrigPrice,b.totalSalePrice=c.totalSalePrice,this._createPriceFromAggregate(a,b)):a},a.prototype._showStorytellingCapModal=function(){var a;if(!this.hasShownCapDialog)return a=this.$modal.open({templateUrl:"Common/views/storytelling-cap-modal.html",backdrop:"static",controller:"SimpleModalCtrl",resolve:{data:function(){return null}}}),this.hasShownCapDialog=!0},a.prototype._translate=function(a,b){return null==b&&(b=void 0),null!=b?this.$translate(a,{value:b}):this.$translate(a)},a.prototype._createPriceFromAggregate=function(a,b){var c;return c=JSON.parse(JSON.stringify(a)),c.contentPrice={contentCategory:[b],totalOrigPrice:b.totalOrigPrice,totalSalePrice:b.totalSalePrice},c},a.$inject=["$scope","pricingService","eventBus","$translate","projectService","$modal"],a}(),angular.module("silverApp").controller("PriceCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l,m,n){this.$scope=a,this.$modal=c,this.commandService=d,this.projectService=e,this.adaptiveLayoutService=f,this.removePageService=g,this.appState=h,this.eventBus=i,this.contentService=j,this.config=k,this.$timeout=l,this.productModelStrategy=m,this.deviceDetectionService=n,this._onImageDoubleClick=b(this._onImageDoubleClick,this),this.onRemovePage=b(this.onRemovePage,this),this._handleImageRemoved=b(this._handleImageRemoved,this),this.$scope.ctrls.SurfaceCtrl||i.subscribe(i.events.CUSTOMIZE_IMAGE_DBLCLICK,this._onImageDoubleClick,a),this.deviceDetectionService.isDeviceATablet()&&this.config.superSimple&&i.subscribe(i.events.SURFACE_IMAGE_REMOVED,this._handleImageRemoved,a),this.$scope.ctrls.SurfaceCtrl=this,this.spreadLoadCounter=0,this.editImageRequestActive=!1}return a.prototype._handleImageRemoved=function(a,b){var c;if(c=this.projectService.currentProject.product.pageBySurfaceNumber(b.pageNumber),!((null!=c?c.isCover():void 0)===!0||c.getImages().length>0))return this.$modal.open({keyboard:!1,templateUrl:"SilverApp/views/tablet-empty-page-options-dialog.html",windowClass:"tablet-empty-page-options-window",backdrop:"static",controller:"SimpleModalCtrl",resolve:{data:function(){return{page:c}}}})},a.prototype.onRemoveImage=function(a,b){var c;return this.deviceDetectionService.isDeviceATablet()&&this.config.superSimple&&(null!=b&&"function"==typeof b.hasAssignedImage?b.hasAssignedImage():void 0)?void this.removeImageFromPageAndAdapt(a,b):(null!=b&&"function"==typeof b.hasAssignedImage?b.hasAssignedImage():void 0)?this.commandService.execute("RemoveWellImageCommand",{imageId:b.imageId,uniqueProjectRef:b.uniqueProjectRef,pageNumber:a.surfaceNumber}):a.isGrid?this.commandService.execute("RemoveWellCommand",{asset:b,pageNumber:a.surfaceNumber}):(c=b.userAdded,this._adaptPage(a,c))},a.prototype.onRemoveEmbellishment=function(a,b){return this.commandService.execute("RemoveEmbellishmentCommand",{offsets:[b.values.container.xOffset,b.values.container.yOffset],uniqueProjectRef:b.uniqueProjectRef,containerId:b.values.container.id,assetId:b.values.assetReference.assetId,pageNumber:a.surfaceNumber})},a.prototype.removeImageFromPageAndAdapt=function(a,b){var c,d,e,f,g;return(null!=b&&"function"==typeof b.hasAssignedImage?b.hasAssignedImage():void 0)?(c=this.projectService.currentProject.product,g=this.adaptiveLayoutService.createProductSpec(c,a),e=this.deviceDetectionService.isDeviceATablet()&&this.config.superSimple,f={pageCount:this.projectService.currentProject.product.pages.length,styleJson:this.contentService.currentStyle,projectType:this.projectService.currentProject.type,exactConstraintMatch:e,styleSpecificLayoutCategory:e?this.contentService.currentStyleCategory:void 0},this.adaptiveLayoutService.getAdaptiveLayout(a,g,b.imageAssignment,f,!0,!1,!0).then(function(c){return function(d){return d.id!==a.layoutName?c.commandService.execute("RemoveWellImageAndAdaptCommand",{imageId:b.imageId,uniqueProjectRef:b.uniqueProjectRef,pageNumber:a.surfaceNumber,layoutInfo:d,projectImageIdToRemove:c._shouldRemoveImageFromProject(b)}):c.commandService.execute("RemoveWellImageCommand",{imageId:b.imageId,uniqueProjectRef:b.uniqueProjectRef,pageNumber:a.surfaceNumber})}}(this))):(d=b.userAdded,this._adaptPage(a,d))},a.prototype._shouldRemoveImageFromProject=function(a){if(this.deviceDetectionService.isDeviceATablet()&&this.config.superSimple)return a.projectImageId},a.prototype._adaptPage=function(a,b){var c,d,e,f;return null==b&&(b=!1),this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW,{subtle:!0}),c=this.projectService.currentProject.product,f=this.adaptiveLayoutService.createProductSpec(c,a),e={pageCount:this.projectService.currentProject.product.pages.length,styleJson:this.contentService.currentStyle,projectType:this.projectService.currentProject.type},d=!0,this.adaptiveLayoutService.getAdaptiveLayout(a,f,null,e,d).then(function(c){return function(d){return d.id!==a.layoutName?c.commandService.execute("AdaptPageCommand",{pageNumber:a.surfaceNumber,layoutInfo:d}):b===!0&&a.customLayout===!0&&c.commandService.execute("AdaptPageCommand",{pageNumber:a.surfaceNumber,layoutInfo:d}),c.$timeout(function(){return c.eventBus.publish(c.eventBus.events.PLEASE_WAIT_HIDE)}),c.currentlyDraggedAsset=null}}(this),function(a){return function(b){return a.$timeout(function(){return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE);
})}}(this))},a.prototype.onRemovePage=function(a){return this.removePageService.removePage(a)},a.prototype.onImageDoubleClick=function(a,b,c,d){return null==c&&(c=!1),null==d&&(d=!0),c?this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/cannot-edit-photo-modal.html",backdrop:"static",controller:"SimpleModalCtrl",scope:this.scope,resolve:{data:function(){return{allowUpload:d}}}}):this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/edit-image-simple.html",backdrop:"static",controller:"EditImageCtrl",windowClass:"image-editor-modal",scope:this.$scope,resolve:{data:function(){return{page:a,asset:b}}}})},a.prototype.dismiss=function(){return this.modalInstance.dismiss()},a.prototype.done=function(){return this.modalInstance.dismiss()},a.prototype._onImageDoubleClick=function(a,b){return this.onImageDoubleClick(b.page,b.asset)},a.prototype.editOneUpImageOnPage=function(a){var b,c;return b=a.getFirstImage(),c="uppTemp"===b.data,this.onImageDoubleClick(a,b,c,c)},a.prototype.reportSpreadPageLoad=function(){if(!this.appState.twoPageSpreadHasLoaded&&!this.productModelStrategy.enoughSpreadsLoadedForInit(this.spreadLoadCounter))return this.spreadLoadCounter++,this.productModelStrategy.enoughSpreadsLoadedForInit(this.spreadLoadCounter)?(this.appState.twoPageSpreadHasLoaded=!0,this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_HIDE)):void 0},a}(),a.$inject=["$scope","$modal","commandService","projectService","adaptiveLayoutService","removePageService","appState","eventBus","contentService","CONFIG","$timeout","productModelStrategy","deviceDetectionService"],angular.module("silverApp").controller("SurfaceCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e){this.$scope=a,this.config=b,this.deviceDetectionService=c,this.commandService=d,this.navService=e,this.$scope.ctrls.SummaryCtrl=this,this._defaultIosApp="voyager",this.appLink="",this.appText="",this.showLink=!1,this._generateAppLink()}return a.prototype._generateAppLink=function(){if(this.deviceDetectionService.isDeviceIos()?this.deviceDetectionService.isDeviceAnIpad()?this._generateLinkforIpadApp():this._generateLinkForIphoneApp():this.deviceDetectionService.isDeviceMobile()||(this.config.appType?this._generateLinkForIphoneApp():this._generateLinkforIpadApp()),this.appLink&&this.appText)return this.showLink=!0},a.prototype._generateLinkForIphoneApp=function(){var a,b;return a=(null!=(b=this.config.appType)?b.toLowerCase():void 0)||this._defaultIosApp,this.appLink=this.config.appStoreLinks.iphone[a],this.appText="Slideshow.iphone."+a+".downloadApp"},a.prototype._generateLinkforIpadApp=function(){return this.appLink=this.config.appStoreLinks.ipad.mercury,this.appText="Slideshow.ipad.mercury.downloadApp"},a.prototype.onShuffleClick=function(){return this.commandService.execute("ShufflePageImagesCommand",{pageNumber:this.navService.selectedPage.surfaceNumber})},a}(),a.$inject=["$scope","CONFIG","deviceDetectionService","commandService","navService"],angular.module("silverApp").controller("SummaryCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){return this.$scope=a,this.$modal=c,this.projectService=d,this.userService=e,this.eventBus=f,this.$interval=h,this.omnitureService=i,this.config=j,this.commandService=k,this.projectEventService=l,this.hotkeys=m,this.$timeout=n,this.$window=o,this.projectValidator=p,this.$translate=q,this.$filter=r,this.idleTimeoutService=s,this.internalProjectService=t,this.appState=u,this.patchService=v,this._waitForUploadNotShowModal=b(this._waitForUploadNotShowModal,this),this._waitForUpload=b(this._waitForUpload,this),this.autoSave=b(this.autoSave,this),this.saveAs=b(this.saveAs,this),this.saveInBackground=b(this.saveInBackground,this),this.save=b(this.save,this),this.$scope.ctrls.SaveCtrl?this.$scope.ctrls.SaveCtrl:(this.log=g.newInstance("SaveCtrl"),this.uploadListener=null,this.appState.saving=!1,this.notShowUploadModal=!1,this.$scope.ctrls.SaveCtrl=this,this.autoSaveAttempts=0,this.config.incrementalSave?this.autoSaveInterval=this.config.patchSaveInterval:this.autoSaveInterval=this.config.autoSaveTimer,this.eventBus.subscribe(this.eventBus.events.LOGIN_PROMPT_WITH_DETAIL_CLOSED,function(a){return function(){return a._promptSignInWithDetail()}}(this),a),this.eventBus.subscribe(this.eventBus.events.PROJECT_LOADED,function(a){return function(b,c){return a.currentProject=c,a.title=a.currentProject.title}}(this),a),this.eventBus.subscribe(this.eventBus.events.PROJECT_SAVE_AS,function(a){return function(b,c){return c&&(a.callbackEvent=c),a.saveAs()}}(this),a),this.eventBus.subscribe(this.eventBus.events.PROJECT_SAVE,function(a){return function(b,c){return c&&(a.callbackEvent=c),a.save()}}(this),a),this.eventBus.subscribe(this.eventBus.events.PROJECT_CONTINUE_REDIRECT,function(a){return function(b,c){return a._continueRedirect()}}(this),a),this.eventBus.subscribe(this.eventBus.events.PROJECT_AUTO_SAVE,function(a){return function(){return a._resetAutoSaveAttempts(),a.autoSave()}}(this),a),this.eventBus.subscribe(this.eventBus.events.UPP_USER_SIGNIN,function(a){return function(){return a._resetAutoSaveAttempts()}}(this),a),this.eventBus.subscribe(this.eventBus.events.APP_READY,function(a){return function(){if(a.config.allowAutoSave&&(a.$timeout(function(){return a._user().then(function(b){if(!b.isLoggedIn)return a._promptSignInWithDetail()})},a.config.defaults.initialAutoSaveTimer),!a.idleTimeoutService.autoSaveTimer))return a.idleTimeoutService.autoSaveTimer=a.$interval(a.autoSave,a.autoSaveInterval)}}(this),a),this.eventBus.subscribe(this.eventBus.events.UPDATE_SAVE_TIME,function(a){return function(){return a.lastSavedDate=new Date}}(this),a),this.eventBus.subscribe(this.eventBus.events.MODAL_UPLOAD_PROGRESS_DISMISS,function(a){return function(){return a._postUploadCallback=null,a.callbackEvent=null}}(this),a),void(this.config.allowHotKeys&&this.hotkeys.add({combo:"mod+s",description:"Save",callback:function(a){return function(b,c){a.save(),b.preventDefault()}}(this)})))}return a.prototype._saveJPG=function(a){var b,c;return this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this.saveJPGFilenamePage="Book Pages",c=this.projectService.currentProject.projectGUID,b=this.projectService.currentProject.product,this.internalProjectService.renderSinglePage(a.id,c,b,2,this.saveJPGFilenamePage,!1,!0,!0)},a.prototype._gotoPhotos=function(){return this._user().then(function(a){return function(b){return a._saveJPG(b)}}(this))},a.prototype._continueRedirect=function(){this.$timeout(function(a){return function(){return a._user().then(function(b){var c;return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE),c=""+a.config.secureAppServer+"/forwardingSignin/start.sfly?authTicket="+b.openflyToken+"&forwardToURL=",a.photosUrl=c+encodeURIComponent(""+a.config.secureAppServer+"/nav/mypics.sfly"),a.$timeout(function(){return a.$window.open(a.photosUrl,"_self")})})}}(this),5e3)},a.prototype.save=function(a){return null==a&&(a=!1),this.redirect=a,this._resetTimer(),this.currentProject.hasBeenSaved?this._user().then(function(a){return function(b){return a.currentProject.isReadyToSave?b.isLoggedIn?(a.eventBus.publishSync(a.eventBus.events.PROJECT_SAVING_IN_PROGRESS),a._resetAutoSaveAttempts(),a._saveNow(b)):a.eventBus.publish(a.eventBus.events.LOGIN_PROMPT,a.eventBus.events.PROJECT_SAVE):(a._postUploadCallback=a.save,void a._waitForUpload())}}(this)):this.currentProject.isHiddenProject?this.saveInBackground():this.saveAs()},a.prototype.saveInBackground=function(){var a;return a=this.currentProject.title,this.currentProject.title=this.title,this.userService.userInfo().then(function(b){return function(c){return c.isLoggedIn?(b._resetAutoSaveAttempts(),b._saveUppRecipe(),b.projectService.saveNew(c).then(function(){return b.projectEventService.reportCreate(),b.omnitureService.trackProjectSave(),b._saveSuccess()},function(c){return b.currentProject.title=a,b.title=a,b._messageError(c)})):b.eventBus.publish(b.eventBus.events.LOGIN_PROMPT)}}(this))},a.prototype.saveAs=function(){return this._user().then(function(a){return function(b){return b.isLoggedIn?(a._resetTimer(),a.currentProject.isReadyToSave?a._showSaveAsDialog():(a._postUploadCallback=a.saveAs,void(a.notShowUploadModal?(a._waitForUploadNotShowModal(),a.notShowUploadModal=!1):a._waitForUpload()))):a.eventBus.publish(a.eventBus.events.LOGIN_PROMPT,a.eventBus.events.PROJECT_SAVE_AS)}}(this))},a.prototype._resetTimer=function(a){if(null==a&&(a=this.autoSaveInterval),this.$interval.cancel(this.idleTimeoutService.autoSaveTimer),this.config.allowAutoSave)return this.idleTimeoutService.autoSaveTimer=this.$interval(this.autoSave,a)},a.prototype._resetAutoSaveAttempts=function(){return this.autoSaveAttempts=0},a.prototype.saveDialogHandler=function(){return this.modalInstance.close(),this.saveInBackground()},a.prototype.autoSave=function(){if(null!=this.currentProject&&this.currentProject.isReadyToSave&&!(this.autoSaveAttempts>1))return this._resetTimer(),this._user().then(function(a){return function(b){if(!b.isLoggedIn)return a.autoSaveAttempts++,void a.eventBus.publish(a.eventBus.events.LOGIN_PROMPT,a.eventBus.events.PROJECT_AUTO_SAVE);if(a.commandService.bookIsDirty||!a.currentProject.hasBeenSaved)return a._saveNow(b,!0,a.projectService.constructor.AUTOSAVE_TRIGGER)}}(this))},a.prototype._messageError=function(a){return this.appState.saving=!1,this._messageValidationErrors(null!=a?a.validationErrors:void 0),this._messageUnrecoverableErrors(null!=a?a.unrecoverableErrors:void 0)},a.prototype._messageUnrecoverableErrors=function(a){var b;if(Array.isArray(a))return b=this.$modal.open({templateUrl:"SilverApp/views/error-dialog.html",backdrop:"static",scope:this.$scope,controller:"ErrorDialogCtrl",resolve:{data:function(b){return function(){return{message:a.map(function(a){return JSON.stringify(a)}).join("\n"),hasUnrecoverableErrors:!0,project:b.currentProject}}}(this)}})},a.prototype._messageValidationErrors=function(a){var b,c,d;if((null!=a&&null!=(d=a[0])?d.message:void 0)===this.projectValidator.constructor.MISSING_IMAGE_OR_DATA)return b=this._humanizePageNumbers(this._dedupePageNumbers(a)),c=this.$modal.open({templateUrl:"SilverApp/views/missing-images-warning.html",backdrop:"static",controller:"SimpleModalCtrl",resolve:{data:function(){return{pageNumbers:b}}}}),c.result.finally(function(a){return function(){return a.save()}}(this))},a.prototype._dedupePageNumbers=function(a){var b;return b=[],a.filter(function(a){return b[a.surfaceNumber]!==!0&&(b[a.surfaceNumber]=!0,!0)})},a.prototype._humanizePageNumbers=function(a){var b;b=void 0;try{b=this.$filter("calendarizeMonth")}catch(a){}return a.map(function(a){return function(c){var d;return c.surfaceNumber<1?a.$translate("Palette.extended.cover"):(d=a.currentProject.product.pageBySurfaceNumber(c.surfaceNumber),null!=(null!=d?d.surfaceKey:void 0)&&null!=b?a.$translate(b(d.surfaceKey)):(null!=d?d.isSpread():void 0)?""+c.surfaceNumber+"/"+(c.surfaceNumber+1):c.surfaceNumber)}}(this)).join(", ")},a.prototype._waitForUpload=function(){if(this.eventBus.publish(this.eventBus.events.MODAL_UPLOAD_PROGRESS_SHOW,{source:"save"}),!this.uploadListener)return this.uploadListener=this.eventBus.subscribe(this.eventBus.events.UPP_UPLOAD_COMPLETED,function(a){return function(){return a._handleUploadCompleted()}}(this),this.$scope)},a.prototype._waitForUploadNotShowModal=function(){if(!this.uploadListener)return this.uploadListener=this.eventBus.subscribe(this.eventBus.events.UPP_UPLOAD_COMPLETED,function(a){return function(){return a._handleUploadCompleted()}}(this),this.$scope)},a.prototype._handleUploadCompleted=function(){if(this.eventBus.publish(this.eventBus.events.MODAL_UPLOAD_PROGRESS_HIDE),setTimeout(function(a){return function(){return a.eventBus.unsubscribe(a.uploadListener),a.uploadListener=null}}(this),100),this._postUploadCallback)return this._postUploadCallback()},a.prototype._saveUppRecipe=function(){var a,b,c,d;return a=null!=(b=$window.Shr)&&null!=(c=b.Dialogs)&&null!=(d=c.UniversalPicker)?d.newPP:void 0,this.currentProject.setReportingValue("newUPP",a||!1)},a.prototype._saveNow=function(a,b,c){var d,e;return null==b&&(b=!1),null==c&&(c=""),this.currentProject.hasBeenSaved?this.config.incrementalSave?(e=function(a){return function(){return a._saveSuccess(b)}}(this),d=function(a){return function(b){if(null!=b.interval)return a._resetTimer(b.interval)}}(this),this.patchService.commitProject().then(e,d).finally(function(a){return function(){return a.appState.saving=!1,a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)}}(this))):this.projectService.save(a,c).then(function(a){return function(){return a._saveSuccess(b)}}(this),function(a){return function(b){return a.$timeout(function(){return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)}),a._messageError(b)}}(this)):(this._saveUppRecipe(),this.projectService.saveNew(a,c).then(function(a){return function(){return a.projectEventService.reportCreate(),a.omnitureService.trackProjectSave(),a._saveSuccess(b)}}(this),function(a){return function(b){return a.$timeout(function(){return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)}),a._messageError(b)}}(this)))},a.prototype._showSaveAsDialog=function(){var a,b;if(!this.isShowSaveAsDialogOpen)return this.eventBus.publish(this.eventBus.events.MODAL_OPENED),this.isShowSaveAsDialogOpen=!0,this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/save-as.html",backdrop:"static",scope:this.$scope}),this.modalInstance.opened.then(function(a){return function(){return a.omnitureService.trackPageName({pageName:"/@@p/save project dialog"})}}(this)),a=function(a){return function(){return a.isShowSaveAsDialogOpen=!1}}(this),b=function(a){return function(){return a.isShowSaveAsDialogOpen=!1,a.callbackEvent=null}}(this),this.modalInstance.result.then(a,b)},a.prototype._saveSuccess=function(a){if(null==a&&(a=!1),this.appState.saving=!1,this.lastSavedDate=new Date,this._handlePleaseWait(a),this.commandService.setBookIsClean(),this.eventBus.publish(this.eventBus.events.PROJECT_SAVE_COMPLETED),null!=this.callbackEvent&&(this.eventBus.publish(this.callbackEvent),this.callbackEvent=null),this.redirect)return this._gotoPhotos()},a.prototype._handlePleaseWait=function(a){if(null==a&&(a=!1),this.callbackEvent!==this.eventBus.events.PROJECT_CONTINUE_ORDER&&!a)return this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_HIDE)},a.prototype._user=function(){return this.userService.userInfo()},a.prototype.close=function(){return this.modalInstance.dismiss(),this.callbackEvent=null},a.prototype._promptSignInWithDetail=function(){return this.eventBus.publish(this.eventBus.events.LOGIN_PROMPT_WITH_DETAIL),this.notShowUploadModal=!0,this.$interval.cancel(this.idleTimeoutService.autoSaveTimer),this.saveAs()},a}(),a.$inject=["$scope","$modal","projectService","userService","eventBus","loggerFactory","$interval","omnitureService","CONFIG","commandService","projectEventService","hotkeys","$timeout","$window","projectValidator","$translate","$filter","idleTimeoutService","internalProjectService","appState","patchService"],angular.module("silverApp").controller("SaveCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g){return this.$scope=a,this.commandService=c,this.eventBus=d,this.$timeout=e,this.hotkeys=f,this.config=g,this._initWatchers=b(this._initWatchers,this),this.$scope.ctrls=this.$scope.ctrls||{},this.$scope.ctrls.CommandCtrl?this.$scope.ctrls.CommandCtrl:(this.$scope.ctrls.CommandCtrl=this,this.canUndo=this.commandService.canUndo,this.canRedo=this.commandService.canRedo,this._initWatchers(),void(this.config.allowHotKeys&&(this.hotkeys.add({combo:"mod+z",description:"Undo",callback:function(a){return function(b,c){a.undo(),b.preventDefault()}}(this)}),navigator.platform.toUpperCase().indexOf("MAC")>=0?this.hotkeys.add({combo:"shift+mod+z",description:"Redo",callback:function(a){return function(b,c){a.redo(),b.preventDefault()}}(this)}):this.hotkeys.add({combo:"mod+y",description:"Redo",callback:function(a){return function(b,c){a.redo(),b.preventDefault()}}(this)}))))}return a.prototype.undo=function(){return!!this.commandService.canUndo&&(this.commandService.willBeLongUndoOperation()?(this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this.$timeout(function(a){return function(){return a.commandService.undo(),a.$timeout(function(){return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)})}}(this),500)):this.commandService.undo(),!1)},a.prototype.redo=function(){return!!this.commandService.canRedo&&(this.commandService.willBeLongRedoOperation()?(this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this.$timeout(function(a){return function(){return a.commandService.redo(),a.$timeout(function(){return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)})}}(this),500)):this.commandService.redo(),!1)},a.prototype._initWatchers=function(){return this.eventBus.subscribe(this.eventBus.events.COMMAND_EXECUTED,function(a){return function(b,c){return a.$scope.$evalAsync(function(){return a.canUndo=a.commandService.canUndo,a.canRedo=a.commandService.canRedo})}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.COMMAND_UNDO,function(a){return function(){return a.undo()}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.COMMAND_REDO,function(a){return function(){return a.redo()}}(this),this.$scope)},a}(),a.$inject=["$scope","commandService","eventBus","$timeout","hotkeys","CONFIG"],angular.module("silverApp").controller("CommandCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}},c=function(a,b){return(a%b+ +b)%b};a=function(){function a(a,c,d,e,f,g){return this.$scope=a,this.$modal=c,this.projectService=d,this.commandService=e,this.layoutService=f,this.config=g,this.selectNextLayout=b(this.selectNextLayout,this),this.$scope.ctrls.ChangeLayoutCtrl?this.$scope.ctrls.ChangeLayoutCtrl:(this.$scope.ctrls.ChangeLayoutCtrl=this,void(this.nextLayoutNumber=0))}return a.prototype.selectNextLayout=function(){var a,b,d,e,f,g,h,i,j,k,l,m,n;for(d=this.projectService.currentProject.product.cover.isSoftCover(),this.coverOptions=this.config.getCoverOptions(d),f=null!=(i=this.projectService)&&null!=(j=i.currentProject)&&null!=(k=j.product)?k.cover.frontPage:void 0,a=null!=(l=this.projectService)&&null!=(m=l.currentProject)&&null!=(n=m.product)?n.sizeId:void 0,b=f.getFirstImage(),h=0;h++<this.coverOptions.length;)if(this.nextLayoutNumber=c(this.nextLayoutNumber+1,this.coverOptions.length),g=this.coverOptions[this.nextLayoutNumber],g=null!=g?g.phoneCoverLayouts:void 0,this.layoutService.layoutCandidates=null!=g?g.layoutCandidates:void 0,null!=this.layoutService.layoutCandidates&&(e=this.layoutService.getId(this.layoutService.layoutCandidates,a,b,d,!1),null!=e))return void this.changeLayout(f,e)},a.prototype.changeLayout=function(a,b){var c,d;return c=[],c.id=b,c.version="1",c.isSpread=function(){return!1},c.isIdeaLayout=function(){return!0},this.serviceURI=this.config.styleServiceBase,d=""+this.serviceURI+"/asset/fetch/"+c.id+"/layout.json/v"+c.version,c.jsonUrl=d,this.layoutService.applyToPage(c,a,null)},a}(),a.$inject=["$scope","$modal","projectService","commandService","layoutService","CONFIG"],angular.module("silverApp").controller("ChangeLayoutCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g,h,i){this.$scope=a,this.$modal=b,this.projectService=c,this.pricingService=d,this.eventBus=e,this.docsmithConversionService=f,this.config=g,this.sizeInitializer=h,this.productTrackingStrategy=i,this.coverTypesBySizeId=this.sizeInitializer.getCoverTypes(),this.sizeInitializer.setHardCover=!1,this.$scope.ctrls.ChangeSizeCtrl=this,this.sizeOptions=this.sizeInitializer.getSizeOptions(),this.eventBus.subscribe(this.eventBus.events.SHOW_BACON_CHOOSE_COVER,function(a){return function(b,c){return a.openBaconChooseCover(c)}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.SHOW_SIZE_CHANGE_WARNING_DIALOG,function(a){return function(b,c){return a.openWarningDialog(c)}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.SHOW_POST_SIZE_CHANGE_WARNING_DIALOG,function(a){return function(b,c){return a.openPostChangeSizeWarningDialog(c)}}(this),this.$scope)}return a._pricesAreNonZero=function(a){return 0!==a.origPrice&&0!==a.salePrice},a.prototype.savings=function(b){return a._pricesAreNonZero(b)&&b.isOnSale?Math.round(100*(1-b.salePrice/b.origPrice)):0},a.prototype.origPriceStyling=function(b){var c;return c=function(b){return!a._pricesAreNonZero(b)},c(b)?"size-option-hidden-price":b.isOnSale?"size-option-strikethrough-price":"size-option-price"},a.prototype.salePriceStyling=function(b){var c;return c=function(b){return!(a._pricesAreNonZero(b)&&b.isOnSale)},c(b)?"size-option-hidden-price":"size-option-sale-price"},a.prototype.openDialog=function(){return this.selectedSize=this.projectService.currentProject.product.sizeId,this.eventBus.publish(this.eventBus.events.MODAL_OPENED),this.pricingService.requestCoverPricing(this.coverTypesBySizeId).then(function(a){return function(b){return a._setPricing(),a._openChangeSizeDialog()}}(this),function(a){return function(b){return a._setPricing(),a._openChangeSizeDialog()}}(this))},a.prototype._openChangeSizeDialog=function(){var a;return a="SilverApp/views/"+this.productTrackingStrategy.productizeTemplateDirectory()+"/change-size.html",this.modalInstance=this.$modal.open({templateUrl:a,backdrop:"static",scope:this.$scope})},a.prototype._setPricing=function(){var a,b,c,d,e;for(b=d=0,e=this.sizeOptions.length;0<=e?d<e:d>e;b=0<=e?++d:--d)c=this.sizeOptions[b],a=this.pricingService.coverPricesBySize[this.sizeOptions[b].size],c.isOnSale=a.isOnSale,c.origPrice=a.origPrice,c.salePrice=a.salePrice},a.prototype.changeSize=function(){if(this.modalInstance.close(),this.selectedSize!==this.projectService.currentProject.product.sizeId)return this.docsmithConversionService.start(this.projectService.currentProject,{bookSize:this.selectedSize,sizeId:this.selectedSize})},a.prototype.cancel=function(){return this.modalInstance.dismiss("cancel")},a.prototype.openWarningDialog=function(a){return this.$modal.open({templateUrl:"SilverApp/views/change-size-warning.html",backdrop:"static",scope:this.$scope,controller:"ChangeSizeWarningCtrl",resolve:{data:function(){return a}}})},a.prototype.openPostChangeSizeWarningDialog=function(a){return this.$modal.open({templateUrl:"SilverApp/views/post-change-size-warning.html",backdrop:"static",scope:this.$scope,controller:"SimpleModalCtrl",resolve:{data:function(){return a}}})},a.prototype.openBaconChooseCover=function(a){return this.$modal.open({templateUrl:"SilverApp/views/bacon-choose-cover.html",backdrop:"static",scope:this.$scope,controller:"ChooseCoverCtrl",resolve:{data:function(){return a}}})},a.prototype.select=function(a){return this.selectedSize=a},a}(),a.$inject=["$scope","$modal","projectService","pricingService","eventBus","docsmithConversionService","CONFIG","sizeInitializer","productTrackingStrategy"],angular.module("silverApp").controller("ChangeSizeCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g,h,i,j){var k;this.$scope=a,this.$modalInstance=b,this.data=c,this.docsmithConversionService=d,this.pricingService=e,this.projectService=f,this.config=g,this.omnitureService=h,this.eventBus=i,this.sizeInitializer=j,this.appServerPath=this.data.appServerPath,this.nativeAndroid=this.data.nativeAndroid,this.$scope.ctrls=this.$scope.ctrls||{},this.$scope.ctrls.ChooseCoverCtrl=this,this.coverOptions=this.config.getCoverOptions(!1,!0),k=this.pricingService.getDefaultPricing(),this.priceOptions={"8x8_bk_hard":k,"8x8_bk_soft":k},this.hardCoverBookTypes=[{size:"8x8",bookType:"8x8_bk_hard",coverType:"USER_CUSTOM"},{size:"10x10",bookType:"10x10_bk_hard",coverType:"USER_CUSTOM"},{size:"12x12",bookType:"12x12_bk_hard",coverType:"USER_CUSTOM"}],this.softCoverBookTypes=[{size:"8x8",bookType:"8x8_bk_soft",coverType:"USER_CUSTOM_SOFT"},{size:"10x10",bookType:"10x10_bk_soft",coverType:"USER_CUSTOM_SOFT"}],this.projectService.currentProject.product.descriptionId.match(/hard$/i)?(this.hardCoverSelected=!0,this.activeCoverType=JSON.parse(JSON.stringify(this.hardCoverBookTypes[0]))):(this.hardCoverSelected=!1,this.activeCoverType=JSON.parse(JSON.stringify(this.softCoverBookTypes[0]))),this.showUpp=this.omnitureService.firstTimeLoadPage,this.activeCoverType.bookType=JSON.parse(JSON.stringify(this.projectService.currentProject.product.descriptionId)),this.selectedSize=this.projectService.currentProject.product.sizeId,this.activeCover=this.config.getCoverOptions(!this.hardCoverSelected)[0],this.config.isBaconV2?this._initPriceOptionsV2():this._initPriceOptions()}return a.prototype.selectCover=function(a){return this.omnitureService.trackPageName(),this.activeCover=a,this.config.phoneCoverLayouts=this.activeCover.phoneCoverLayouts,this.config.defaults.coverSpecId=this.activeCover.bookDesc,this.$modalInstance.dismiss("cancel")},a.prototype._initPriceOptions=function(){var a,b,c;return c=this.projectService.currentProject,a=this.pricingService.getProjectPriceForDifferentCoverId(c,"8x8_bk_hard"),a.then(function(a){return function(b){return a.priceOptions["8x8_bk_hard"]=b.pricing}}(this)),b=this.pricingService.getProjectPriceForDifferentCoverId(c,"8x8_bk_soft"),b.then(function(a){return function(b){return a.priceOptions["8x8_bk_soft"]=b.pricing}}(this))},a.prototype.baconChangeSize=function(){return this.$modalInstance.dismiss("cancel"),this.omnitureService.firstTimeLoadPage?(this.eventBus.publish(this.eventBus.events.APP_READY),this.omnitureService.firstTimeLoadPage=!1,this.config.defaults.coverSpecId=this.activeCoverType.bookType):this.activeCoverType.bookType!==this.projectService.currentProject.product.descriptionId?(this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this.docsmithConversionService.start(this.projectService.currentProject,{bookSize:this.selectedSize,sizeId:this.selectedSize,coverType:this.coverType})):void 0},a.prototype.hardCover=function(){return this.hardCoverSelected=!0,this.activeCoverType=this.hardCoverBookTypes[0],this.selectedSize=this.activeCoverType.size,this.coverType=this.activeCoverType.coverType,this.config.defaults.coverSpecId=this.activeCoverType.bookType},a.prototype.softCover=function(){return this.hardCoverSelected=!1,this.activeCoverType=this.softCoverBookTypes[0],this.selectedSize=this.activeCoverType.size,this.coverType=this.activeCoverType.coverType,this.config.defaults.coverSpecId=this.activeCoverType.bookType},a.prototype.bookTypes=function(){return this.hardCoverSelected?this.hardCoverBookTypes:this.softCoverBookTypes},a.prototype._initPriceOptionsV2=function(){return this.pricingService.requestCoverPricing(this.sizeInitializer.getCoverTypes()).then(function(a){return function(){return a.coverPricesBySize=a.pricingService.coverPricesBySize,a.originHardCoverPrice=JSON.parse(JSON.stringify(a.coverPricesBySize))}}(this)),this.pricingService.requestCoverPricing(this.sizeInitializer.getCoverTypes()).then(function(a){return function(){return a.coverPricesBySize=a.pricingService.coverPricesBySize,a.originSoftCoverPrice=JSON.parse(JSON.stringify(a.coverPricesBySize))}}(this))},a.prototype.getPriceForSize=function(a){var b,c,d,e;return this.hardCoverSelected?null==(null!=(b=this.originHardCoverPrice)&&null!=(c=b[a])?c.salePrice:void 0)?"...":this.originHardCoverPrice[a].salePrice:null==(null!=(d=this.originSoftCoverPrice)&&null!=(e=d[a])?e.salePrice:void 0)?"...":this.originSoftCoverPrice[a].salePrice},a.prototype.baconSelect=function(a,b){return this.activeCoverType=b,this.selectedSize=a,this.activeCoverType=this.activeCoverType},a}(),a.$inject=["$scope","$modalInstance","data","docsmithConversionService","pricingService","projectService","CONFIG","omnitureService","eventBus","sizeInitializer"],angular.module("silverApp").controller("ChooseCoverCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g,h,i,j){return this.$scope=a,this.$modal=b,this.projectService=c,this.adaptiveLayoutService=d,this.navService=e,this.commandService=f,this.contentService=g,this.$timeout=h,this.layoutService=i,this.config=j,this.$scope.ctrls.ChooseCoverPhotoCtrl?this.$scope.ctrls.ChooseCoverPhotoCtrl:void(this.$scope.ctrls.ChooseCoverPhotoCtrl=this)}return a.prototype.selectCoverPhoto=function(){var a;return(null!=(a=this.projectService.currentProject)?a.imageCollection.currentUploadInProgress:void 0)>0?this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/cannot-choose-cover-photo-modal.html",backdrop:"static",controller:"SimpleModalCtrl",scope:this.$scope,resolve:{data:function(){}}}):this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/choose-cover-photo.html",backdrop:"static",scope:this.$scope})},a.prototype._addImageToWell=function(a,b,c){if(null!=b)return this.commandService.execute("AddWellImageCommand",{source:{imageId:b.imageId,uniqueProjectRef:c.uniqueProjectRef},pageNumber:a.surfaceNumber,target:{imageId:c.imageId,uniqueProjectRef:c.uniqueProjectRef}})},a.prototype.changeCoverPhoto=function(a){var b,c,d,e,f,g,h,i,j,k,l;return f=null!=(g=this.projectService)&&null!=(h=g.currentProject)&&null!=(i=h.product)?i.cover.frontPage:void 0,this.navService.selectCoverSpread(f),d=this.projectService.currentProject.product.cover.isSoftCover(),e=this.layoutService.layoutCandidates,e||(d=this.projectService.currentProject.product.cover.isSoftCover(),e=this.config.getCoverOptions(d)[0].phoneCoverLayouts.layoutCandidates),b=[],b.id=this.layoutService.getId(e,null!=(j=this.projectService)&&null!=(k=j.currentProject)&&null!=(l=k.product)?l.sizeId:void 0,a,d,!0),this.modalInstance.close(),c=f.getFirstImage(),this._addImageToWell(f,a,c)},a.prototype.cancel=function(){return this.modalInstance.dismiss("cancel")},a}(),a.$inject=["$scope","$modal","projectService","adaptiveLayoutService","navService","commandService","contentService","$timeout","layoutService","CONFIG"],angular.module("silverApp").controller("ChooseCoverPhotoCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g){this.$scope=a,this.$modalInstance=b,this.conversionService=c,this.data=d,this.eventBus=e,this.uppService=f,this.projectService=g,this.$scope.ctrls.ChangeSizeWarningCtrl=this,this._warningMessages={coverChange:{title:"SilverApp.changeSizeWarningDialog.coverChangeTitle",coverMesg:"SilverApp.changeSizeWarningDialog.coverChangeMessage",note:["SilverApp.changeSizeWarningDialog.coverChangeReviewNote","SilverApp.changeSizeWarningDialog.aspectChangeReviewNote","SilverApp.changeSizeWarningDialog.priceChangeReviewNote"]},aspectChange:{title:"SilverApp.changeSizeWarningDialog.aspectChangeTitle",sizeMesg:"SilverApp.changeSizeWarningDialog.aspectChangeMessage",note:["SilverApp.changeSizeWarningDialog.aspectChangeReviewNote","SilverApp.changeSizeWarningDialog.priceChangeReviewNote"]},coverAndAspectChange:{title:"SilverApp.changeSizeWarningDialog.coverChangeTitle",coverMesg:"SilverApp.changeSizeWarningDialog.coverChangeMessage",sizeMesg:"SilverApp.changeSizeWarningDialog.coverAndAspectChangeMessage",note:["SilverApp.changeSizeWarningDialog.coverChangeReviewNote","SilverApp.changeSizeWarningDialog.aspectChangeReviewNote","SilverApp.changeSizeWarningDialog.priceChangeReviewNote"]},default:{title:"Error",note:[]}},this.warningType=this._getWarningType(),this.params=this.conversionService.describeProjectConversion(d.oldProject,d.project)}return a.prototype._getWarningType=function(){var a,b,c,d,e,f;if(b=!1,a=!1,this.data.warnings)for(f=this.data.warnings,d=0,e=f.length;d<e;d++)c=f[d],"coverChanged"===c.id&&(b=!0),"aspectRatioChanged"===c.id&&(a=!0);return b&&a?this._warningMessages.coverAndAspectChange:b?this._warningMessages.coverChange:a?this._warningMessages.aspectChange:this._warningMessages.default;
},a.prototype.showCoverSizeWarning=function(){return null!=this.warningType.coverMesg},a.prototype.showSizeWarning=function(){return null!=this.warningType.sizeMesg},a.prototype.continue=function(){return this.$modalInstance.close()},a.prototype.cancel=function(){return this.eventBus.publish(this.eventBus.events.COMMAND_UNDO),this.$modalInstance.dismiss("cancel")},a}(),a.$inject=["$scope","$modalInstance","docsmithConversionService","data","eventBus","uppService","projectService"],angular.module("silverApp").controller("ChangeSizeWarningCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g){this.$scope=a,this.$modalInstance=b,this.conversionService=c,this.eventBus=d,this.data=e,this.uppService=f,this.projectService=g,this.$scope.ctrls.ChangeCoverWarningCtrl=this,this.params=this.conversionService.describeProjectConversion(this.data.oldProject,this.data.project),this.isCoverUpgrade=this.projectService.currentProject.product.cover.isSoftCover()}return a.prototype.continue=function(){return this.$modalInstance.close()},a.prototype.cancel=function(){return this.$modalInstance.dismiss("cancel"),this.eventBus.publish(this.eventBus.events.COMMAND_UNDO),this.eventBus.publish(this.eventBus.events.BOOK_TAB_SELECT_CURRENT_COVER)},a}(),a.$inject=["$scope","$modalInstance","docsmithConversionService","eventBus","data","uppService","projectService"],angular.module("silverApp").controller("ChangeCoverWarningCtrl",a)}.call(this),function(){"use strict";var a,b=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};a=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l){this.$scope=a,this.$modal=b,this.projectService=c,this.eventBus=d,this.docsmithConversionService=e,this.config=f,this.productTrackingStrategy=g,this.autofill=h,this.contentService=i,this.adaptiveLayoutService=j,this.commandService=k,this.eventsService=l,this.$scope.ctrls.ChangeStartDateCtrl=this,this.currentStartDate={year:null,month:null},this.modalInstance=null,this.yearProperty=null,this.monthProperty=null,this.lastSavedDate={year:null,month:null},this.defaultYear=(new Date).getFullYear(),this.defaultMonth=(new Date).getMonth()+1,this.changeStartDateAllowed=this.config.changeStartDate}return a.prototype.months=["January","February","March","April","May","June","July","August","September","October","November","December"],a.prototype._getProjectStartDate=function(){return this.currentStartDate=this.projectService.currentProject.product.getCalendarStartDate(),this.monthProperty=this.months[this.currentStartDate.month-1],this.yearProperty=this.currentStartDate.year},a.prototype.getAllYears=function(){var a,b;return function(){b=[];for(var c=a=this.defaultYear-1,d=this.defaultYear+3;a<=d?c<=d:c>=d;a<=d?c++:c--)b.push(c);return b}.apply(this)},a.prototype.openDialog=function(){return this.eventBus.publish(this.eventBus.events.MODAL_OPENED),this._getProjectStartDate(),this._openChangeStartDateDialog()},a.prototype._openChangeStartDateDialog=function(){return this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/gc/change-start-date.html",backdrop:"static",scope:this.$scope})},a.prototype.changeStartDate=function(){var a,b,c;return this.lastSavedDate.year=null!=(a=this.yearProperty)?a:this.currentStartDate.year,this.lastSavedDate.month=null!=(b=this.monthProperty)?b:this.months[this.currentStartDate.month-1],null!=(c=this.modalInstance)&&c.close(),this._executeChangeStartDate()},a.prototype._executeChangeStartDate=function(){var a,c,d,e,f,g,h;if(f={year:parseInt(this.lastSavedDate.year,10),month:this.months.indexOf(this.lastSavedDate.month)+1},isNaN(f.year)||isNaN(f.month)||(h=f.month,b.call([1,2,3,4,5,6,7,8,9,10,11,12],h)<0))throw new Error("Invalid year: "+this.lastSavedDate.year+" or month: "+this.lastSavedDate.month);f.year===this.currentStartDate.year&&f.month===this.currentStartDate.month||(e=this.projectService.currentProject,g=this.contentService.currentStyle,d=f.month>1?f.year+1:f.year,c=1===f.month?12:f.month-1,a={year:d,month:c},this.eventsService.events.length>0||this._loadProjectEvents(),this.eventsService.publicEventsLoaded=!1,this.eventsService.loadPublicEvents(f,a,!1).then(function(b){return function(c){return b.adaptiveLayoutService.getRecalculatedGridPages(f,e,g,b._contentClient()).then(function(d){return b.commandService.execute("ChangeStartDateCommand",{startDate:f,endDate:a,layouts:d.layouts,monthsRequiringUpdate:d.monthsRequiringUpdate,indexOfNewStart:d.indexOfNewStart,publicEvents:c})})}}(this)))},a.prototype._loadProjectEvents=function(){return this.eventsService.loadProjectEvents().forEach(function(a){return a.isSelected=!0})},a.prototype._contentClient=function(){return{getLayout:function(a){return function(b){var c,d;return c=a.projectService.currentProject.product.sizeId,d=a.contentService.getLayoutByAttributes(b.id,c),a.autofill.utils.Promise.createFinishedPromise(d)}}(this)}},a.prototype.cancel=function(){var a;return null!=(a=this.modalInstance)&&a.dismiss("cancel"),this.setDateProperty("year",this.lastSavedDate.year),this.setDateProperty("month",this.lastSavedDate.month)},a.prototype.setDateProperty=function(a,b){return"year"===a?this.yearProperty=b:"month"===a?this.monthProperty=b:void 0},a.prototype.isYearPropertyNull=function(){if(null===this.yearProperty)return!0},a.prototype.isMonthPropertyNull=function(){if(null===this.monthProperty)return!0},a.prototype.isStartDatePast=function(){if(this.currentStartDate.year===this.defaultYear){if(this.currentStartDate.month<this.defaultMonth)return!0}else if(this.currentStartDate.year<this.defaultYear)return!0},a}(),a.$inject=["$scope","$modal","projectService","eventBus","docsmithConversionService","CONFIG","productTrackingStrategy","autofill","contentService","adaptiveLayoutService","commandService","eventsService"],angular.module("silverApp").controller("ChangeStartDateCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){var e,f;this.$scope=a,this.$modalInstance=b,this.eventBus=c,this.$route=d,null==a.ctrls&&(this.$scope.ctrls={}),this.$scope.ctrls.UpgradeProjectWarningCtrl=this,this.upgradeInProgress=!0,this.eventBus.subscribe(this.eventBus.events.PROJECT_LOADED,function(a){return function(){return a.upgradeInProgress=!1}}(this)),this.showBriefDesc=!1,(null!=(e=this.$route)&&null!=(f=e.current)?f.slideshow:void 0)&&(this.showBriefDesc=!0)}return a.prototype.continue=function(){return this.$modalInstance.close()},a}(),a.$inject=["$scope","$modalInstance","eventBus","$route"],angular.module("silverApp").controller("UpgradeProjectWarningCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l,m,n,o){this.$scope=a,this.$rootScope=c,this.$modal=d,this.projectService=e,this.navService=f,this.eventBus=g,this.commandService=h,this.config=i,this.removePageService=j,this.adaptiveLayoutService=k,this.layoutFactory=l,this.contentService=m,this.appState=n,this.movePageService=o,this._handleMovePageResponse=b(this._handleMovePageResponse,this),this._handleSurfaceSelected=b(this._handleSurfaceSelected,this),this._handleLayoutUpdated=b(this._handleLayoutUpdated,this),this.$scope.ctrls.PageActionsCtrl=this,this.$rootScope.ctrls=this.$rootScope.ctrls||{},this.$rootScope.ctrls.PageActionsCtrl=this,this.pencilIsOpen=!1,this.disabledMove=!1,this.disabledRemove=!1,this.disabledImportPage=!1,this.disableStoryboardAddPage=this.config.removeAddPage,this.disableStoryboardRemovePage=this.config.removeRemovePage,this.disabledDupe=!1,this.disabledAddPages=!1,this.disabledAddPagesAtEnd=!1,this.allowedPageCount=this.config.defaults.constraints.GroupCountConstraint.max,this.eventBus.subscribe(this.eventBus.events.SURFACE_SELECTED,this._handleSurfaceSelected,this.$scope),this.eventBus.subscribe(this.eventBus.events.SURFACE_LAYOUT_UPDATED,this._handleLayoutUpdated,this.$scope),this.eventBus.subscribe(this.eventBus.events.COMMAND_EXECUTED,function(a){return function(b,c){return a._ensureCanAddPages()}}(this),this.$scope),this.addPagesOmniTrackLinks={edit:{pagestab:{button:"Edit, Pages tab, Add Pages",inpages:"Edit, Pages tab-in pages, Add Pages"},menubar:{button:"Edit, Menu bar, Add Pages"},projectmenu:{menu:"Edit, Project menu, Add Pages"}},"advanced-edit":{pagestab:{button:"Advanced Edit, Pages tab, Add Pages",inpages:"Advanced Edit, Pages tab-in pages, Add Pages"},menubar:{button:"Advanced Edit, Menu bar, Add Pages"},projectmenu:{menu:"Advanced Edit, Project menu, Add Pages"}},arrange:{menubar:{button:"Arrange, Menu bar, Add Pages"},pages:{inpages:"Arrange, In pages, Add Pages"},projectmenu:{menu:"Arrange, Project menu, Add Pages"}},storyboard:{pages:{inpages:"Storyboard, In pages, Add Pages"},toolbar:{button:"Storyboard, Tool bar, Add Pages"}}}}return a.prototype._handleLayoutUpdated=function(a,b){var c;if(null!=(null!=b?b.pageNumber:void 0))return c=this.projectService.currentProject.product.pageBySurfaceNumber(b.pageNumber),this._updateMakeSpreadMenuState(c)},a.prototype._handleSurfaceSelected=function(a,b){return this.isSpecialPageSelected=b.surfaceNumber<2,this.disabledMove=this.isSpecialPageSelected||this._lastEvenPageWithSpreadBefore(b),this.disabledRemove=this.isSpecialPageSelected,this._updateMakeSpreadMenuState(b)},a.prototype._lastEvenPageWithSpreadBefore=function(a){var b,c;return b=this.projectService.currentProject.product,c=a.surfaceNumber-2,this._pageIsLastAndEven(a,b)&&b.pageBySurfaceNumber(c).isSpread()},a.prototype._updateMakeSpreadMenuState=function(a){return this.disabledDupe=!a.isRemovablePage()||this._ensureCanAddPages()},a.prototype._ensureCanAddPages=function(a){var b,c,d,e;return null==a&&(a=this.projectService.currentProject.product.pages.length),c=this.navService.selectedPage.surfaceNumber,d=this.navService.selectedPage.isSpread(),e=null!=this.projectService.currentProject.product.spreadNumberAfterPageNumber(c),b=e||d?this.allowedPageCount-1:this.allowedPageCount,this.disabledAddPagesAtEnd=this.allowedPageCount-a<=0,this.disabledAddPages=b-a<=0,this.disabledImportPage=this.allowedPageCount-1-a<=0},a.prototype.addPageAtEnd=function(){return this.addPage(!1,function(a){return function(){return a.disabledAddPagesAtEnd}}(this))},a.prototype.addPage=function(a,b){if(null==a&&(a=!1),null==b&&(b=function(a){return function(){return a.disabledAddPages}}(this)),this._ensureCanAddPages(),!b())return this._ensureCanAddPages(this.projectService.currentProject.product.pages.length+1),a?this._fetchNewPages(1,this.navService.selectedPage.surfaceNumber+1,this.navService.selectedPage.surfaceNumber):this._fetchNewPages(1,this.projectService.currentProject.product.pages.length+1,this.navService.selectedPage.surfaceNumber)},a.prototype.getOmniTrackLinkForAddPages=function(a,b,c){return this.addPagesOmniTrackLinks[a]&&this.addPagesOmniTrackLinks[a][b]&&this.addPagesOmniTrackLinks[a][b][c]?this.addPagesOmniTrackLinks[a][b][c]:"Unknown tracking link for Add Pages"},a.prototype.addPages=function(){var a,b,c,d,e,f,g;if(this._ensureCanAddPages(),!this.disabledAddPages)return this.eventBus.publish(this.eventBus.events.MODAL_OPENED),a=this.projectService.currentProject.product,f=this.allowedPageCount-a.pages.length,d=this.isSpecialPageSelected,c=this.navService.selectedPage.surfaceNumber,b=a.pages.length,e=this.navService.selectedPage.isSpread(),g=null!=a.spreadNumberAfterPageNumber(c),this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/add-pages-modal.html",scope:this.$scope,backdrop:"static",controller:"AddPagesModalCtrl",resolve:{params:function(){return{isOnSpecialPage:d,numPagesLeftToAdd:f,currentPageCount:b,currentPageNumber:c,isSpread:e,spreadAfterPage:g}}}}),this.modalInstance.result.then(function(a){return function(d){var e,f;return f=d.numOfPagesToAdd,e=d.addPageAt,a._ensureCanAddPages(b+f),d.extraPageCheck?a._handleExtraPageRequirement(f,e,c):a._fetchNewPages(f,e,c)}}(this),function(){})},a.prototype._handleExtraPageRequirement=function(a,b,c,d){var e;return null==d&&(d=void 0),this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/add-after-spread-check.html",backdrop:"static",controller:"SimpleModalCtrl",resolve:{data:function(){return{}}}}),e=function(e){return function(){return e._fetchNewPages(a+1,b,c,d)}}(this),this.modalInstance.result.then(e,function(){})},a.prototype._fetchNewPages=function(a,b,c,d){var e;return null==d&&(d=void 0),e=this.projectService.currentProject,this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this.projectService.innerPages([],e.product.styleId,e.product.styleContentVersion,e.product.cover.coverSpecID,e.product.cover.binding,null,a,a,e.product.cover.stockCoverSpecID).then(function(a){return function(e){var f;return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE),f=Array.isArray(d)?d.concat(e.pages):e.pages,a._executeAddPagesCommand(f,b,c)}}(this))},a.prototype._executeAddPagesCommand=function(a,b,c){var d;return d={add:{pages:a,addAtPageNumber:b},beforeCommandPageNumber:c,activePageNumber:b},this.commandService.execute("AddPagesCommand",d)},a.prototype.removePage=function(){var a;if(!this.disabledRemove)return a=this.navService.selectedPage,this.eventBus.publish(this.eventBus.events.MODAL_OPENED),this.removePageService.removePage(a)},a.prototype.isMakeSpreadDisabled=function(){var a;return!(null!=(a=this.navService.selectedPage)?a.isRemovablePage():void 0)||this.navService.rightPage.isFiller()||this.navService.leftPage.isSpread()},a.prototype.makeSpread=function(){var a,b,c,d,e;if(!this.isMakeSpreadDisabled())return b=this.navService.leftPage.layout.values,c=this.navService.leftPage.surfaceNumber,d=this.navService.rightPage.layout.values,e=this.navService.rightPage.surfaceNumber,a=this.layoutFactory.newInstance(angular.copy(d)),a.clearAboveBackground(),this.adaptiveLayoutService.joinLayouts(b,d).then(function(b){return function(d){return b._executeMakeSpreadCommand(c,d,e,{content:a.values})}}(this))},a.prototype.breakSpread=function(){var a,b,c,d;if(this.navService.leftPage.isSpread())return c=this.navService.leftPage.layout.values,d=this.contentService.currentStyle,b=this.adaptiveLayoutService.createProductSpec(this.projectService.currentProject.product,this.navService.leftPage),a={leftLayoutId:null,rightLayoutId:null,isCustomizing:this.appState.isCustomizing()},this.adaptiveLayoutService.splitSpread(c,d,b,a).then(function(a){return function(b){return a.commandService.execute("SplitSpreadCommand",{left:{layoutValues:b.leftLayout,pageNumber:a.navService.leftPage.surfaceNumber,select:!0},right:{layoutValues:b.rightLayout,pageNumber:a.navService.rightPage.surfaceNumber,select:!1},unassignedImages:b.unassignedImages})}}(this))},a.prototype._executeMakeSpreadCommand=function(a,b,c,d){var e;return e={left:{layoutValues:b,pageNumber:a},right:{layoutValues:d,pageNumber:c}},this.commandService.execute("MakeSpreadCommand",e)},a.prototype.dupePage=function(){var a,b,c,d,e;if(!this.disabledDupe)return this.appState.cancelBackgroundWaitingForPicture(),e=this.navService.selectedPage.surfaceNumber,b=this.navService.selectedPage.isSpread(),a=b?e+2:e+1,c=[this._clonePage(a,this.navService.selectedPage.values)],b&&c.push(this._clonePage(a+1,this._hiddenPageValues(e))),d=this.projectService.currentProject.product.spreadNumberAfterPageNumber(e),null==d||b?this._executeAddPagesCommand(c,a,e):this._handleExtraPageRequirement(0,a,e,c),c},a.prototype._clonePage=function(a,b){var c;return c=angular.copy(b),c.surfaceNumber=a.toString(),c},a.prototype._hiddenPageValues=function(a){var b;return b=this.projectService.currentProject.product.pageBySurfaceNumber(a+1),b.values},a.prototype.flipPage=function(){var a;return a=this.navService.selectedPage,this.adaptiveLayoutService.flipLayout(angular.copy(a.layout.values)).then(function(b){return function(c){return b.commandService.execute("ApplyLayoutCommand",{pageNumber:a.surfaceNumber,layout:c,toggleFlippedLayout:!0})}}(this))},a.prototype.movePage=function(){var a,b;if(!this.disabledMove)return this.eventBus.publish(this.eventBus.events.MODAL_OPENED),b=this._movablePagesData(),a=this.navService.selectedPage,this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/move-page-modal.html",scope:this.$scope,backdrop:"static",controller:"MovePageModalCtrl",resolve:{params:function(){return{movablePages:b,currentPage:a}}}}),this.modalInstance.result.then(this._handleMovePageResponse,function(){})},a.prototype._handleMovePageResponse=function(a){var b,c;return b=a.currentPage,c=a.pageNumber,"BEFORE"===a.dir&&(c-=1),this.movePageService.assignSource(b),this.movePageService.assignTarget(c),this.movePageService.executeMove()},a.prototype._movablePagesData=function(){var a,b,c,d,e,f,g,h,i,j,k,l;for(c=this.navService.selectedPage,a=this.projectService.currentProject.product,i=!1,b=this._pageIsLastAndEven(c,a),f=a.spreadNumberAfterPageNumber(1),e=[],l=this.projectService.currentProject.product.pages,d=j=0,k=l.length;j<k;d=++j)g=l[d],i!==!0?(i=g.isSpread(),g.surfaceNumber!==c.surfaceNumber&&1!==g.surfaceNumber&&(null!=f&&f>g.surfaceNumber||(f=a.spreadNumberAfterPageNumber(g.surfaceNumber)),h={page:g,index:d,label:g.isSpread()?""+g.surfaceNumber+" - "+(g.surfaceNumber+1):g.surfaceNumber},g.isSpread()?h.enabled=!b:h.enabled=!(b&&null!=f),e.push(h))):i=!1;return e},a.prototype._pageIsLastAndEven=function(a,b){return a===b.lastPage()&&a.isEven()},a.prototype.handlePencilToggle=function(a){return this.pencilIsOpen=a},a}(),a.$inject=["$scope","$rootScope","$modal","projectService","navService","eventBus","commandService","CONFIG","removePageService","adaptiveLayoutService","layoutFactory","contentService","appState","movePageService"],angular.module("silverApp").controller("PageActionsCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i){return this.$scope=a,this.navService=c,this.commandService=d,this.eventBus=e,this.$timeout=f,this.config=g,this.imageCollection=h,this.$modal=i,this.canRemoveUnusedPhotos=b(this.canRemoveUnusedPhotos,this),this.canRemoveAllPhotos=b(this.canRemoveAllPhotos,this),this.removeUnusedPhotosFromBook=b(this.removeUnusedPhotosFromBook,this),this.removeAllPhotosFromBook=b(this.removeAllPhotosFromBook,this),this.$scope.ctrls.PhotoActionsCtrl?this.$scope.ctrls.PhotoActionsCtrl:(this.$scope.ctrls.PhotoActionsCtrl=this,void(this.modalInstance=null))}return a.prototype.removeAllPhotosFromBook=function(){if(this.canRemoveAllPhotos())return this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this.$timeout(function(a){return function(){return a.commandService.execute("RemoveAllImagesCommand",{beforeCommandPageNumber:a.navService.selectedPage.surfaceNumber,activePageNumber:a.navService.selectedPage.surfaceNumber}),a.$timeout(function(){return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)})}}(this),500)},a.prototype.openDialog=function(){if(this.canRemoveUnusedPhotos())return this.dialogIsOpen=!0,this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/remove-unused-photos-modal.html",backdrop:"static",scope:this.$scope}),this.eventBus.publish(this.eventBus.events.MODAL_OPENED)},a.prototype.closeDialog=function(){var a;return null!=(a=this.modalInstance)&&a.close(),this.modalInstance=null},a.prototype.cancel=function(){var a;return null!=(a=this.modalInstance)&&a.dismiss("cancel"),this.modalInstance=null},a.prototype.removeUnusedPhotosFromBook=function(){if(this.canRemoveUnusedPhotos())return this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this.$timeout(function(a){return function(){return a.commandService.execute("RemoveUnusedImagesCommand",{beforeCommandPageNumber:a.navService.selectedPage.surfaceNumber,activePageNumber:a.navService.selectedPage.surfaceNumber}),a.$timeout(function(){return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)}),a.closeDialog()}}(this),500)},a.prototype.canRemoveAllPhotos=function(){var a;return(null!=(a=this.imageCollection)?a.getUsedImages():void 0)>0},a.prototype.canRemoveUnusedPhotos=function(){var a,b,c;return(null!=(a=this.imageCollection)&&null!=(b=a.projectImages)?b.length:void 0)>(null!=(c=this.imageCollection)?c.getUsedImages():void 0)},a}(),a.$inject=["$scope","navService","commandService","eventBus","$timeout","CONFIG","imageCollection","$modal"],angular.module("silverApp").controller("PhotoActionsCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i){return this.$scope=a,this.navService=c,this.commandService=d,this.eventBus=e,this.$timeout=f,this.projectService=g,this.$modal=h,this.$translate=i,this.removeAllEmbellishments=b(this.removeAllEmbellishments,this),this.$scope.ctrls.EmbellishmentActionsCtrl?this.$scope.ctrls.EmbellishmentActionsCtrl:(this.$scope.ctrls.EmbellishmentActionsCtrl=this,this.modalInstance=null,this.OPTION_FROM_PAGE="PAGE",this.OPTION_FROM_BOOK="BOOK",void(this.isRemovingFrom=this.OPTION_FROM_BOOK))}return a.prototype.openDialog=function(){if(this.canRemoveAllEmbellishments())return this.dialogIsOpen=!0,this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/remove-all-embellishments-modal.html",backdrop:"static",scope:this.$scope}),this.eventBus.publish(this.eventBus.events.MODAL_OPENED)},a.prototype.closeDialog=function(){var a;return null!=(a=this.modalInstance)&&a.close(),this.modalInstance=null},a.prototype.cancel=function(){var a;return null!=(a=this.modalInstance)&&a.dismiss("cancel"),this.modalInstance=null},a.prototype.removeAllEmbellishments=function(){this.canRemoveAllEmbellishments()&&(this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this.$timeout(function(a){return function(){return a.commandService.execute("RemoveAllEmbellishmentsCommand",{isRemovingFromBook:a.isRemovingFrom===a.OPTION_FROM_BOOK,beforeCommandPageNumber:a.navService.selectedPage.surfaceNumber,activePageNumber:a.navService.selectedPage.surfaceNumber}),a.$timeout(function(){return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)}),a.closeDialog()}}(this),500))},a.prototype.currentPageNumber=function(){var a;return a=this.navService.selectedPage,null==a?"":a.isCover()?this.$translate(a.displayPageNumber).toLowerCase():this.$translate("SilverApp.removeStickers.fromPage.formatedPageNumber",{value:a.displayPageNumber})},a.prototype.canRemoveAllEmbellishments=function(){return null!=this.navService.selectedPage&&this.navService.selectedPage.getStickers().length>0||this.projectService.hasStickers()},a}(),a.$inject=["$scope","navService","commandService","eventBus","$timeout","projectService","$modal","$translate"],angular.module("silverApp").controller("EmbellishmentActionsCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.$scope=a,this.$modalInstance=b,this.params=c,this.$translate=d,this.movablePages=this.params.movablePages,this.currentPage=this.params.currentPage,this.pageIndexToMove=0,this.moveDirections=[{value:"BEFORE",label:this.$translate("SilverApp.beforePage")},{value:"AFTER",label:this.$translate("SilverApp.afterPage")}],this.moveDirection=this.moveDirections[0],this.findFirstValidIndex(),this.disableInvalidSpreadTargets(),this.$scope.ctrls.MovePageModalCtrl=this}return a.prototype.ok=function(){var a;return a=this.movablePages[this.pageIndexToMove],this.$modalInstance.close({dir:this.moveDirection.value,currentPage:this.currentPage.surfaceNumber,pageNumber:a.page.surfaceNumber})},a.prototype.cancel=function(){return this.$modalInstance.dismiss("cancel")},a.prototype.disableInvalidSpreadTargets=function(){var a,b,c,d,e,f;if(this.currentPage.isSpread()){for(a=void 0,f=this.movablePages,b=d=0,e=f.length;d<e;b=++d)c=f[b],!c.page.isSpread()&&(c.page.isEven()&&this.moveDirection===this.moveDirections[1]||!c.page.isEven()&&this.moveDirection===this.moveDirections[0])?c.invalidSpreadTarget=!0:(null==a&&(a=b),c.invalidSpreadTarget=!1);return this.pageIndexToMove=a}},a.prototype.findFirstValidIndex=function(){var a,b,c,d,e;for(e=this.movablePages,a=c=0,d=e.length;c<d;a=++c)if(b=e[a],b.enabled)return void(this.pageIndexToMove=a)},a}(),a.$inject=["$scope","$modalInstance","params","$translate"],angular.module("silverApp").controller("MovePageModalCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){return this.$scope=a,this.eventBus=b,this.$modal=c,this.userService=d,this.projectService=e,this.productModelStrategy=f,this.docsmithAPI=g,this.docsmithConversionService=h,this.pageFactory=i,this.commandService=j,this.navService=k,this.$q=l,this.imageFactory=m,this.paletteService=n,this.$scope.ctrls.ImportPageModalCtrl?this.$scope.ctrls.ImportPageModalCtrl:(this.IMPORT_AFTER="AFTER",this.IMPORT_BEFORE="BEFORE",this.IMPORT_BEGINNING="BEGINNING",this.IMPORT_END="END",this.sections=["selectProject","selectPage","confirmImport"],this.currentSection=this.sections[0],this.projects=[],this.currentProject=null,this._requestedModal=!1,this.hasNoProjects=!1,this.$scope.ctrls.ImportPageModalCtrl=this,this.eventBus.subscribe(this.eventBus.events.CONTINUE_TO_IMPORT_PAGE,function(a){return function(b,c){return a._getSummaries()}}(this),this.$scope),void this.eventBus.subscribe(this.eventBus.events.PROJECT_SUMMARIES,function(a){return function(b,c){return a._requestedModal&&(a._parseProjects(c),a._openDialog()),a._requestedModal=!1}}(this),this.$scope))}return a.prototype.open=function(){return this.currentSection=this.sections[0],this._getSummaries()},a.prototype._getSummaries=function(){return this.userService.userInfo().then(function(a){return function(b){return a.userId=b.id,a.apigeeToken=b.apigeeToken,b.isLoggedIn?(a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_SHOW),a._requestSummaries(b)):a.eventBus.publish(a.eventBus.events.LOGIN_PROMPT,a.callbackEvent||a.eventBus.events.CONTINUE_TO_IMPORT_PAGE)}}(this))},a.prototype._openDialog=function(){var a;0===this.projects.length||this.hasNoProjects?(this.hasNoProjects=!0,a="SilverApp/views/import-page-modal-open-with-no-project.html"):a="SilverApp/views/import-page-modal.html",this.$modalInstance=this.$modal.open({templateUrl:a,backdrop:"static",scope:this.$scope,resolve:{data:function(){return{}}}})},a.prototype._requestSummaries=function(a){return this._requestedModal=!0,this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this.projectService.multipleSummaries(a.id,["GCP","GSP","GSS","PS","MMB"]).then(function(a){return function(){return a._summariesSuccess()}}(this))},a.prototype._summariesSuccess=function(){if(this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_HIDE),null!=this.callbackEvent)return this.eventBus.publish(this.callbackEvent)},a.prototype._parseProjects=function(a){var b,c,d,e;for(this.projects=[],e=a.PaginatedCollection.items,c=0,d=e.length;c<d;c++)b=e[c],this.projects.push({url:b.thumbnailURI,title:b.title,guid:b.projectGUID,updtime:b.updtime})},a.prototype.selectProject=function(a){return this.selectedProjectJSON=null,this.selectedProjectPages=null,this.selectedProjectFrontFillerPage=null,this.selectedProjectBackFillerPage=null,this._loadSelectedProject(a).then(function(a){return function(b){var c,d,e,f,g,h;for(d=a.productModelStrategy.unwrapProject(angular.fromJson(b.data)),e=a.docsmithAPI.rewriteSubtype(d),a.selectedProjectJSON=e,a.selectedProjectPages=[],h=a.selectedProjectJSON.book.pages,f=0,g=h.length;f<g;f++)c=h[f],a.selectedProjectPages.push(a.pageFactory.newInstance(c));return a.selectedProjectFrontFillerPage=a._createFillerPage(a.selectedProjectPages[0]),a.selectedProjectBackFillerPage=a._createFillerPage(a.selectedProjectPages[0])}}(this),function(){}),this.next()},a.prototype._createFillerPage=function(a){var b;return b=angular.copy(a.values),b.layout.assets=[],this.pageFactory.newInstance(b,!1)},a.prototype.selectPage=function(a){return this.selectedPage=a,this.next()},a.prototype.importPage=function(){var a;return a=function(a){return function(b){a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)}}(this),this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this._convertPage().then(function(b){return function(c){var d;return d=c.data.page,b._getEmptyPage().then(function(a){return b._incrementNumImportedPages(),b._importUsedImages(d),b.commandService.execute("AddPagesCommand",b._getAddPageOptions(d,a)),b.paletteService.scrapePage(b.pageFactory.newInstance(d)),b.eventBus.publish(b.eventBus.events.PLEASE_WAIT_HIDE)},function(b){return a(b)})}}(this),function(b){return a(b)}),this.$modalInstance.close()},a.prototype._importUsedImages=function(a){var b,c,d,e,f,g,h,i,j,k;for(j=a.layout.assets,f=0,h=j.length;f<h;f++)if(b=j[f],"image"===b.assetType)for(k=this.selectedProjectJSON.imageCollection.projectImages,g=0,i=k.length;g<i;g++)if(d=k[g],null!=b.imageAssignment&&parseInt(d.productImageID)===parseInt(b.imageAssignment.imageReference.projectImageId)){e=this.imageFactory.newInstance(d),this.projectService.currentProject.imageCollection.containsImage(e.imageId)?(c=this.projectService.currentProject.imageCollection.getImageByImageId(e.imageId),b.imageAssignment.imageReference.projectImageId=c.productImageID):(this.projectService.currentProject.imageCollection.addImage(d),b.imageAssignment.imageReference.projectImageId=this.projectService.currentProject.imageCollection.lastProductImageID);break}},a.prototype._incrementNumImportedPages=function(){var a;return a=this.projectService.currentProject.getReportingValue("numImportedPages"),a=null!=a?parseInt(a):0,this.projectService.currentProject.setReportingValue("numImportedPages",++a)},a.prototype._convertPage=function(){var a;return a={sizeId:this.projectService.currentProject.product.sizeId,styleId:""+this.projectService.currentProject.product.styleId,existingPage:this.selectedPage.values,projectSummary:{sizeId:this.selectedProjectJSON.book.bookSizeID,styleId:this.selectedProjectJSON.book.styleId,projectType:this.selectedProjectJSON.type}},this.docsmithConversionService.convertPage(a)},a.prototype._getEmptyPage=function(){var a;return a=this.$q.defer(),this.projectService.innerPages([],this.projectService.currentProject.product.styleId,this.projectService.currentProject.product.styleContentVersion,this.projectService.currentProject.product.cover.coverSpecID,this.projectService.currentProject.product.cover.binding,null,1,1,this.projectService.currentProject.product.cover.stockCoverSpecID).then(function(b){return a.resolve(b.pages[0])},function(){return a.reject(result)}),a.promise},a.prototype._getAddPageOptions=function(a,b){var c,d,e,f,g,h,i,j;switch(this.selectedImportLocation){case"BEGINNING":d=2,f="Spread"===a.layout.type||this.projectService.containsSpreadStartingAt(d)?[a,b]:[a];break;case"END":d=this.projectService.currentProject.product.pages.length+1,"Spread"===a.layout.type?d%2===0?f=[a,b]:(f=[angular.copy(b),a,angular.copy(b)],c=d+1):f=[a];break;case"BEFORE":d=null!=(g=this.navService.selectedPage)?g.surfaceNumber:void 0,"Spread"===a.layout.type?d%2===0?f=[a,b]:(f=[angular.copy(b),a,angular.copy(b)],c=d+1):f=this.projectService.containsSpreadStartingAt(d)?[a,b]:[a];break;case"AFTER":d=(null!=(h=this.navService.selectedPage)?h.surfaceNumber:void 0)+1,"Spread"===(null!=(i=this.navService.selectedPage)?i.layout.type:void 0)&&d++,"Spread"===a.layout.type?d%2===0?f=[a,b]:(f=[angular.copy(b),a,angular.copy(b)],c=d+1):f=this.projectService.containsSpreadStartingAt(d)?[a,b]:[a]}return e={add:{pages:f,addAtPageNumber:d},beforeCommandPageNumber:null!=(j=this.navService.selectedPage)?j.surfaceNumber:void 0,activePageNumber:c}},a.prototype.cancel=function(){return this.$modalInstance.dismiss("cancel")},a.prototype.next=function(){var a;if(a=this._getSectionIndexByName(this.currentSection),!(a<0||a>=this.sections.length-1))return this.currentSection=this.sections[a+1]},a.prototype.previous=function(){var a;if(a=this._getSectionIndexByName(this.currentSection),!(a<=0))return this.currentSection=this.sections[a-1]},a.prototype._getSectionIndexByName=function(a){
var b,c,d,e,f;for(f=this.sections,b=d=0,e=f.length;d<e;b=++d)if(c=f[b],c===a)return b;return-1},a.prototype._loadSelectedProject=function(a){var b;return this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),b=this.projectService.fetchProjectJSON(this.userId,a.guid,this.apigeeToken),b.then(function(a){return function(){return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)}}(this)),b},a}(),a.$inject=["$scope","eventBus","$modal","userService","projectService","productModelStrategy","docsmithAPI","docsmithConversionService","pageFactory","commandService","navService","$q","imageFactory","paletteService"],angular.module("silverApp").controller("ImportPageModalCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k){var l;this.$scope=a,this.$modal=c,this.eventBus=d,this.userService=e,this.config=f,this.$window=g,this.omnitureService=h,this.$timeout=i,this.$sce=j,this.projectService=k,this._loginSuccess=b(this._loginSuccess,this),this.showingSignUp=!1,this.submitDisabled=!1,this.rememberEmail=!0,this.signInModalWithDetail=!1,this.jquery=this.$window.$,this.openOptions="height=800,width=800,left=200,top=100,location=no,menubars=no,scrollbars=yes,toolbars=no, resizable=yes",this.logoUrl=this.config.secureAppServer,this.forgotUrl=this.config.forgotPassword,this.myShutterfly=this.config.myShutterfly,this.signInActionUrl=this.$sce.trustAsResourceUrl(""+this.config.appServer+"/nonVisualSignin/start.sfly"),this.signUpActionUrl=this.$sce.trustAsResourceUrl(""+this.config.appServer+"/nonVisualSignup/start.sfly"),this.targetSubdomain=""+this.$window.location.protocol+"//"+this.$window.location.hostname,this.$scope.ctrls.AuthenticationCtrl=this,this.eventBus.subscribe(this.eventBus.events.NONVISUAL_USER_SIGNUP_ERROR,function(a){return function(b,c){return a._catchSignupError(c.reason)}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.LOGIN_PROMPT_WITH_DETAIL,function(a){return function(b,c){return a._loginPromptWithDetail(c)}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.LOGIN_PROMPT,function(a){return function(b,c){return a._loginPrompt(c)}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.LOGIN_PROMPT_FORCE,function(a){return function(b,c){return a.forceLogin=!0,a._loginPrompt(c)}}(this),this.$scope),d.subscribe(d.events.PROJECT_SAVE_COMPLETED,function(a){return function(){return a._parseValueToFeedback()}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.UPP_USER_SIGNIN,function(a){return function(){return a.$timeout(function(){return a._parseValueToFeedback()},2e3)}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.PROJECT_LOADED,function(a){return function(){return a._parseValueToFeedback()}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.LOGIN_SUCCEEDED,function(a){return function(b,c){return a._loginSuccess(c),a.$timeout(function(){return a._parseValueToFeedback()},2e3)}}(this),this.$scope),l=this._decodeEmailFromCookie(),null!=l&&(this.email=l)}var c,d;return d="em:",c="sflySec",a.prototype._loginPrompt=function(a){return this.callbackEvent=a,this._openLogin()},a.prototype._loginPromptWithDetail=function(){return this.signInModalWithDetail=!0,this._openLogin()},a.prototype.openTermsAndConditions=function(){this.$window.open(this.config.termsAndConditionsUrl,"galleonTAndC",this.openOptions)},a.prototype.openPrivacyPolicy=function(){this.$window.open(this.config.privacyPolicyUrl,"galleonPrivacyPolicy",this.openOptions)},a.prototype.goHome=function(){this.$timeout(function(a){return function(){return a.$window.open(a.logoUrl,"_self")}}(this))},a.prototype.gotoMyShutterfly=function(){this.$timeout(function(a){return function(){return a.$window.open(a.myShutterfly,"_self")}}(this))},a.prototype.openChat=function(){this.$window.open(this.config.chat,"galleonChat",this.openOptions)},a.prototype.openHelp=function(){this.$window.open(this.config.help,"galleonHelp",this.openOptions)},a.prototype.close=function(){return this.signInModalWithDetail&&(this.signInModalWithDetail=!1,this.$timeout(function(a){return function(){return a.eventBus.publish(a.eventBus.events.LOGIN_PROMPT_WITH_DETAIL_CLOSED)}}(this),this.config.autoSaveTimer)),this._resetForms(),this.modalInstance.dismiss(),this.eventBus.publish(this.eventBus.events.LOGIN_PROMPT_CLOSED)},a.prototype._resetForms=function(){return this.email="",this.password="",this.newPassword="",this.showingSignUp=!1,this.rememberEmail=!0,this.termsAccepted=!1,this.firstName="",this.lastName="",this.emailExists=!1,this.submitDisabled=!1},a.prototype._openLogin=function(){if(null==this.modalInstance)return this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/auth-forms.html",backdrop:"static",scope:this.$scope}),this.modalInstance.result.then(null,function(a){return function(){return a.modalInstance=null}}(this)),this.modalInstance.opened.then(function(a){return function(){return a.omnitureService.trackPageName({pageName:"/@@p/signin"})}}(this))},a.prototype.emailChanged=function(){return this.emailExists=!1,this.submitDisabled=!1},a.prototype.flipForm=function(){return this.showingSignUp=!this.showingSignUp},a.prototype.forgetEmail=function(){if(this.rememberEmail!==!0)return this._setEmailCookie()},a.prototype._setEmailCookie=function(){return this._initCookieEncodingState(),this.jquery.cookie(this._emailCookieName(),this._encodeEmailForCookie(),this._cookieOptions()),this.jquery.cookie.raw=this.previousCookieEncodingFlag},a.prototype._decodeEmailFromCookie=function(){var a,b,c;return this._initCookieEncodingState(),a=this.jquery.cookie(this._emailCookieName()),this.jquery.cookie.raw=this.previousCookieEncodingFlag,null==a||"string"!=typeof a?null:(a=a.replace(/"/g,""),b=a.split(d),b.length<2||!((null!=(c=b[1])?c.length:void 0)>0)?null:decodeURIComponent(b[1]))},a.prototype._cookieOptions=function(){return{path:"/",domain:this.config.secureAppServer.substring(11)}},a.prototype._initCookieEncodingState=function(){return this.previousCookieEncodingFlag=this.jquery.cookie.raw,this.jquery.cookie.raw=!0},a.prototype._encodeEmailForCookie=function(){var a;return this.rememberEmail===!1?'"'+d+'"':(a=encodeURIComponent(this.email),'"'+d+a+'"')},a.prototype._emailCookieName=function(){return"prod"===this.config.env?c:""+c+"_"+this.config.env},a.prototype.reportLoginSubmit=function(){return this.userService.reportLoginStarted(),this.submitDisabled=!0,this.invalidCredentials=!1},a.prototype._loginSuccess=function(a){var b;return this._setEmailCookie(),this.submitDisabled=!1,this.emailExists=!1,this.alreadyLogin=!1,a.isLoggedIn?(this.showingSignUp===!1?this.omnitureService.trackLogin():this.omnitureService.trackSignUp(),this._updateExitUrls(a),null!=(b=this.modalInstance)&&b.dismiss(),angular.isObject(this.callbackEvent)?null!=this.callbackEvent.name&&this.eventBus.publish(this.callbackEvent.name,this.callbackEvent.data):null!=this.callbackEvent&&this.eventBus.publish(this.callbackEvent),this.callbackEvent=null):this.invalidCredentials=!0},a.prototype._updateExitUrls=function(a){var b,c;return c=""+this.config.secureAppServer+"/forwardingSignin/start.sfly?authTicket="+a.openflyToken+"&forwardToURL=",this.logoUrl=c+encodeURIComponent(""+this.config.secureAppServer+"/home"),b=c+encodeURIComponent(""+this.config.secureAppServer+"/application/silver.gif"),this.sessionUrl=this.$sce.trustAsResourceUrl(b),this.myShutterfly=c+encodeURIComponent(""+this.config.myShutterfly)},a.prototype.reportSignUp=function(){return this.userService.reportSignupStarted(),this.submitDisabled=!0},a.prototype._catchSignupError=function(a){return this.showingSignUp?(this.emailExists="Email exists"===a,this.alreadyLogin="Already logged in"===a):(this._setEmailCookie(),this.invalidCredentials=!0,this.submitDisabled=!1,this.emailExists=!1,this.alreadyLogin=!1),this.$timeout(function(a){return function(){return a.$scope.$digest()}}(this))},a.prototype._parseValueToFeedback=function(){return this.userService.userInfo().then(function(a){return function(b){var c,d,e,f,g,h;if(c=null!=b?b.id:void 0,a.parsedValue=[{GUID:null!=(d=a.projectService)&&null!=(e=d.currentProject)?e.projectGUID:void 0,UID:c,subtype:null!=(f=a.projectService)&&null!=(g=f.currentProject)&&null!=(h=g.product)?h.subtype:void 0}],$window.parsedValue=a.parsedValue,"undefined"!=typeof Bugsnag&&null!==Bugsnag)return Bugsnag.user={id:null!=b?b.id:void 0,email:null!=b?b.email:void 0,firstName:null!=b?b.firstName:void 0}}}(this))},a}(),a.$inject=["$scope","$modal","eventBus","userService","CONFIG","$window","omnitureService","$timeout","$sce","projectService"],angular.module("silverApp").controller("AuthenticationCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h){return this.$scope=a,this.config=c,this.$modal=d,this.$sce=e,this.eventBus=f,this.$window=h,this.openWarningDialog=b(this.openWarningDialog,this),this.$scope.ctrls.ShowOpenOnDesktopCtrl?this.$scope.ctrls.ShowOpenOnDesktopCtrl:(this.warningModalInstance=null,this.styleModalInstance=null,this.warningData=null,this.log=g.newInstance("ShowOpenOnDesktopCtrl"),this.$scope.ctrls.ShowOpenOnDesktopCtrl=this,void this.eventBus.subscribe(this.eventBus.events.SHOW_OPEN_ON_DESKTOP_WARNING_DIALOG,function(a){return function(b,c){return a.openWarningDialog(c)}}(this),this.$scope))}return a.prototype.openWarningDialog=function(a){return this.warningData=a,this.warningModalInstance=this.$modal.open({templateUrl:"SilverApp/views/open-on-desktop-warning.html",backdrop:"static",scope:this.$scope,keyboard:!1})},a.prototype.warningContinue=function(){var a;if(this.warningModalInstance.close(),null!=(null!=(a=this.warningData)?a.continue:void 0)&&"function"==typeof this.warningData.continue)return this.warningData.continue()},a.prototype.closeDialog=function(){var a;return null!=(a=this.styleModalInstance)&&a.close(),this.styleModalInstance=null},a.prototype.exitToMyProjects=function(){var a;a=""+this.config.secureAppServer+"/myProjects/start.sfly",this.$window.open(a,"_self")},a.prototype.cancel=function(){var a;return null!=(a=this.styleModalInstance)&&a.dismiss("cancel"),this.styleModalInstance=null},a}(),a.$inject=["$scope","CONFIG","$modal","$sce","eventBus","loggerFactory","$window"],angular.module("silverApp").controller("ShowOpenOnDesktopCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e){this.$scope=a,this.$modalInstance=c,this.params=d,this.appState=e,this.ok=b(this.ok,this),this.isOnSpecialPage=this.params.isOnSpecialPage,this.appState.cancelBackgroundWaitingForPicture(),this.currentPageNumber=parseInt(this.params.currentPageNumber,10),this.afterPageNumber=this.currentPageNumber,this.afterPageNumber=this.params.isSpread?this.currentPageNumber+1:this.currentPageNumber,this.currentPageCount=parseInt(this.params.currentPageCount,10),this.selectedDirection="AFTER",this.numOfPagesToAdd=1,this.refreshPagesLeftToAdd(),this.OPTION_AFTER="AFTER",this.OPTION_BEFORE="BEFORE",this.OPTION_END="END",this.$scope.ctrls.AddPagesModalCtrl=this}return a.prototype.ok=function(){var a,b,c;return b=2,c=!1,a=this.numOfPagesToAdd%2===1,this.isOnSpecialPage?(b="AFTER"===this.selectedDirection?2:this.currentPageCount+1,c=this.params.spreadAfterPage&&a&&"AFTER"===this.selectedDirection):"AFTER"===this.selectedDirection?(b=this.params.isSpread?this.currentPageNumber+2:this.currentPageNumber+1,c=this.params.spreadAfterPage&&a):"BEFORE"===this.selectedDirection?(b=this.currentPageNumber,c=(this.params.spreadAfterPage||this.params.isSpread)&&a):b=this.currentPageCount+1,this.$modalInstance.close({addPageAt:b,numOfPagesToAdd:this.numOfPagesToAdd,extraPageCheck:c})},a.prototype.cancel=function(){return this.$modalInstance.dismiss("cancel")},a.prototype.refreshPagesLeftToAdd=function(){if(this.numPagesLeftToAdd=parseInt(this.params.numPagesLeftToAdd,10),(this.params.spreadAfterPage||this.params.isSpread&&"BEFORE"===this.selectedDirection)&&"END"!==this.selectedDirection)return this.numPagesLeftToAdd--},a}(),a.$inject=["$scope","$modalInstance","params","appState"],angular.module("silverApp").controller("AddPagesModalCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){var c;c=b.pageFieldName,a.enableLabel=function(){var b;return null!=c&&(b=a[c],null!=b&&!b.isFiller()&&b.ideaLayout)}}return a}(),a.$inject=["$scope","$attrs"],angular.module("silverApp").controller("IdeaPageLabelCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.$scope=a,this.$modalInstance=b,this.data=c,this.$scope.ctrls=this.$scope.ctrls||{},this.$scope.ctrls.RemovePageModalCtrl=this}return a.prototype.ok=function(){return this.$modalInstance.close()},a.prototype.cancel=function(){return this.$modalInstance.dismiss("cancel")},a}(),a.$inject=["$scope","$modalInstance","data"],angular.module("silverApp").controller("RemovePageModalCtrl",a)}.call(this),function(){"use strict";var a,b;a=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l){this.$scope=a,this.projectService=b,this.docsmithConversionService=c,this.navService=d,this.bookOptionsService=e,this.$modal=f,this.eventBus=g,this.omnitureService=h,this.config=i,this.enums=j,this.upsellReportingService=k,this.appState=l,null==a.ctrls&&(a.ctrls={}),this.$scope.ctrls.BookTabCtrl=this,this.eventBus.subscribe(this.eventBus.events.SHOW_COVER_CHANGE_WARNING_DIALOG,function(a){return function(b,c){return a.openWarningDialog(c)}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.BOOK_TAB_SELECT_CURRENT_COVER,function(a){return function(b){return a.tabWasMadeActive()}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.PROJECT_LOADED,function(a){return function(b,c){return a._onProjectChanged()}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.PROJECT_MODIFIED,function(a){return function(b,c){return a._onProjectChanged()}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.PROJECT_CONVERSION_COMPLETE,function(a){return function(b){return a._reportAddedFeatures()}}(this),this.$scope)}return a.prototype.PAGES_LAYFLAT="layflat",a.prototype.PAGES_HINGED_LAYFLAT="hinged",a.prototype.PAGES_LOOSELEAF="looseleaf",a.prototype.PAGES_GLOSSY="glossy",a.prototype._onProjectChanged=function(){var a;return a=this.projectService.currentProject.product,this.selectedCover=this.bookOptionsService.getSelectedOption(a),this.pageOption=this._getSelectedPageOption(a),this.setMarketingMaterialToCurrentCover(),this.isKeepsakeVisible=this.config.features.keepsakePocket,this.isKeepsakeDisabled=a.cover.isSoftCover(),this.isKeepsakeSelected=a.hasKeepsakePocket()},a.prototype._getSelectedPageOption=function(a){return a.cover.binding===this.enums.BindingType.LAYFLAT?this.PAGES_LAYFLAT:a.cover.binding===this.enums.BindingType.HINGED_LAYFLAT?this.PAGES_HINGED_LAYFLAT:a.hasGlossyPages()?this.PAGES_GLOSSY:this.PAGES_LOOSELEAF},a.prototype._reportAddedFeatures=function(){if(null!=this.upsellMetrics)return this.upsellMetrics.reportAddedFeatures(this.projectService.currentProject.product),this.upsellMetrics=null},a.prototype.getAvailableOptions=function(){return this.bookOptionsService.getAvailableOptions()},a.prototype.getAvailableCoverCategories=function(){return this.bookOptionsService.getAvailableCoverCategories()},a.prototype.tabWasMadeActive=function(){var a;return this.appState.activeTab="book",this.appState.cancelBackgroundWaitingForPicture(),a=this.projectService.currentProject.product,this.initialCover=this.bookOptionsService.getSelectedOption(a),this._onProjectChanged(),this.showHingedLayflatColumn=this.config.hingedLayflat,this.omnitureService.trackPageName({pageName:this.omnitureService.BOOK_PAGE_NAME})},a.prototype.tabWasMadeInactive=function(){if(this.initialCover!==this.selectedCover)return this.navService.selectCoverSpread(this.projectService.currentProject.product.cover.frontPage)},a.prototype.setMarketingMaterial=function(a){return this.currentMarketingAsset=a.asset,this.currentMarketingText=a.text},a.prototype.setMarketingMaterialToCurrentCover=function(){return this.setMarketingMaterial(this.selectedCover)},a.prototype.setSelectedCover=function(a,c){var d;return null==c&&(c=this.PAGES_LOOSELEAF),this.upsellMetrics=b.create(this.projectService.currentProject.product,this.enums,this.upsellReportingService),d={coverType:a.coverType,finish:a.finish,dustJacket:a.dustJacket,keepsakePocket:this.isKeepsakeSelected,glossyPages:c===this.PAGES_GLOSSY},c===this.PAGES_LAYFLAT?d.binding=this.enums.BindingType.LAYFLAT:c===this.PAGES_HINGED_LAYFLAT?d.binding=this.enums.BindingType.HINGED_LAYFLAT:d.binding=this.enums.BindingType.LOOSELEAF,a.colorId&&(d.colorId=a.colorId),this.omnitureService.trackBookOptionsSelection(a,c),this.docsmithConversionService.start(this.projectService.currentProject,d)},a.prototype.toggleKeepsakePocket=function(){if(!this.isKeepsakeDisabled)return this.setSelectedCover(this.selectedCover,this.pageOption)},a.prototype.openWarningDialog=function(a){return this.$modal.open({templateUrl:"SilverApp/views/change-cover-warning.html",backdrop:"static",scope:this.$scope,controller:"ChangeCoverWarningCtrl",resolve:{data:function(){return a}}})},a}(),b=function(){function a(a,b,c){this.enums=b,this.upsellReportingService=c,this.features=this._getBookFeatures(a)}return a.create=function(b,c,d){return new a(b,c,d)},a.prototype._getBookFeatures=function(a){return{coverType:a.cover.getCoverType(),finish:a.finish,hasDustJacket:a.hasDustJacket(),hasGlossyPages:a.hasGlossyPages(),hasStandardPages:a.hasStandardPages(),hasLayflatBinding:a.cover.hasLayflatBinding(),hasHingedLayflatBinding:a.cover.hasHingedLayflatBinding(),hasKeepsakePocket:a.hasKeepsakePocket()}},a.prototype.reportAddedFeatures=function(a){var b,c;return c=this.features,b=this._getBookFeatures(a),this._reportAddedCover(c.coverType,b.coverType),this._reportAddedFinish(c.finish,b.finish),this._reportAddedAccessory(c.hasDustJacket,b.hasDustJacket,this.enums.ProductFeature.DUST_JACKET),this._reportAddedAccessory(c.hasGlossyPages,b.hasGlossyPages,this.enums.ProductFeature.GLOSSY_PAGES),this._reportAddedAccessory(c.hasStandardPages,b.hasStandardPages,this.enums.ProductFeature.STANDARD_PAGES),this._reportAddedAccessory(c.hasLayflatBinding,b.hasLayflatBinding,this.enums.ProductFeature.LAYFLAT),this._reportAddedAccessory(c.hasKeepsakePocket,b.hasKeepsakePocket,this.enums.ProductFeature.KEEPSAKE_POCKET)},a.prototype._reportAddedCover=function(a,b){var c;if(a!==b){switch(c=null,b){case this.enums.CoverType.USER_CUSTOM:c=this.enums.ProductFeature.HARD_PHOTO_COVER;break;case this.enums.CoverType.STOCK_CLOTH:c=this.enums.ProductFeature.CLOTH_COVER;break;case this.enums.CoverType.STOCK_SILK:c=this.enums.ProductFeature.CRUSHED_SILK_COVER;break;case this.enums.CoverType.STOCK_PREMIUM:c=this.enums.ProductFeature.GENUINE_LEATHER_COVER;break;case this.enums.CoverType.STOCK_LEATHER:c=this.enums.ProductFeature.LEATHER_COVER;break;case this.enums.CoverType.STOCK_LINEN:c=this.enums.ProductFeature.LINEN_COVER}return null!=c?this.upsellReportingService.addFeatureOnEdit(c):void 0}},a.prototype._reportAddedFinish=function(a,b){var c;if(a!==b){switch(b){case this.enums.Finish.MATTE:c=this.enums.ProductFeature.MATTE_COVER;break;case this.enums.Finish.PADDED:c=this.enums.ProductFeature.PADDED_COVER}return null!=c?this.upsellReportingService.addFeatureOnEdit(c):void 0}},a.prototype._reportAddedAccessory=function(a,b,c){if(a!==b&&b)return this.upsellReportingService.addFeatureOnEdit(c)},a}(),a.$inject=["$scope","projectService","docsmithConversionService","navService","bookOptionsService","$modal","eventBus","omnitureService","CONFIG","enums","upsellReportingService","appState"],angular.module("silverApp").controller("BookTabCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p){return this.$scope=a,this.config=c,this.$modal=d,this.$sce=e,this.eventBus=f,this.docsmithConversionService=i,this.docsmithAPI=j,this.contentService=k,this.$q=l,this.omnitureService=m,this.projectService=n,this.appState=o,this.$timeout=p,this.openWarningDialog=b(this.openWarningDialog,this),this.$scope.ctrls.StyleTabCtrl?this.$scope.ctrls.StyleTabCtrl:(this.styleIdOccasionsMap={},this.warningModalInstance=null,this.styleModalInstance=null,this.warningData=null,this.styleStoreInactive=!0,this.styleStoreUrl=this.$sce.trustAsResourceUrl(this.config.styleCatalog),this.log=g.newInstance("StyleTabCtrl"),h.updateStyle=function(a){return function(b){return a.config.superSimple||a.tabWasMadeInactive(),a.executeChangeStyle(b.styleId,b.styleVersion)}}(this),this.$scope.ctrls.StyleTabCtrl=this,void this.eventBus.subscribe(this.eventBus.events.SHOW_STYLE_CHANGE_WARNING_DIALOG,function(a){return function(b,c){return a.openWarningDialog(c)}}(this),this.$scope))}return a.OCCASION_PRIORITY_MAP={"Simple Favorites":14,Everyday:13,Seasonal:12,Travel:11,Kids:10,Baby:9,Wedding:8,Family:7,Birthday:6,Portfolio:5,"School Memories":4,"Life Stories":3,"Our Top Picks":2,"New Styles":1},a.prototype.openWarningDialog=function(a){if(!this.config.superSimple)return this.warningData=a,this.warningModalInstance=this.$modal.open({templateUrl:"SilverApp/views/change-style-warning.html",backdrop:"static",scope:this.$scope,keyboard:!1})},a.prototype.warningContinue=function(){var a;if(this.warningModalInstance.close(),null!=(null!=(a=this.warningData)?a.continue:void 0)&&"function"==typeof this.warningData.continue)return this.warningData.continue()},a.prototype.executeChangeStyle=function(a,b){return this.docsmithConversionService.startChangeStyle(this.projectService.currentProject,a.toString(),b.toString()),this.$timeout(function(a){return function(){return a.eventBus.publish(a.eventBus.events.SELECT_EDIT_TAB)}}(this),1e3)},a.prototype.tabWasMadeActive=function(){return this.appState.activeTab="style",this.initTab()},a.prototype.initTab=function(){return null!=this.contentService.currentStyle?this._initTab(this.contentService.currentStyle.styleId,this.projectService.currentProject.product.sizeId):this._initTab(this.config.styleId,this.config.sizeId)},a.prototype._initTab=function(a,b){return this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this._getOccasionsForCurrentStyle(a).then(function(c){return function(d,e){var f,g,h,i,j,k;return f=c.config.styleCatalog.indexOf("?")===-1?"?":"&",i=c.config.styleCatalog+(""+f+"styleId="+a+"&bookSize="+b),null!=(null!=d&&null!=(j=d.data)?j.styleId:void 0)&&null!=(null!=d&&null!=(k=d.data)?k.occasions:void 0)?(c.styleIdOccasionsMap[d.data.styleId]=d.data.occasions,h=c.getPrioritizedOccasion(d.data.occasions),null!=h&&(h=encodeURIComponent(h),i+="&occasions="+h)):c.log.error("No occasions found for style"),g=c.$sce.trustAsResourceUrl(i),g!==c.styleStoreUrl&&(c.styleStoreUrl=g),c.styleStoreInactive=!1}}(this)),this.omnitureService.trackPageName({pageName:this.omnitureService.CHANGE_STYLE_PAGE_NAME})},a.prototype.tabWasMadeInactive=function(){return this.styleStoreInactive=!0,this.closeDialog()},a.prototype.getPrioritizedOccasion=function(b){var c,d,e,f,g,h;if(null==b||0===b.length)return null;for(f=b[0],c=0,g=0,h=b.length;g<h;g++)d=b[g],"Featured"===d&&(d="Our Top Picks"),e=a.OCCASION_PRIORITY_MAP[d],null!=e&&e>c&&(c=e,f=d);return f},a.prototype._getOccasionsForCurrentStyle=function(a){var b,c,d;return c=this.$q.defer(),d=c.promise,b=a,null!=this.styleIdOccasionsMap[b]?c.resolve({data:{styleId:b,occasions:this.styleIdOccasionsMap[b]}}):d=this.docsmithAPI.occasions(b),d},a.prototype.closeDialog=function(){var a;return null!=(a=this.styleModalInstance)&&a.close(),this.styleModalInstance=null},a.prototype.cancel=function(){var a;return null!=(a=this.styleModalInstance)&&a.dismiss("cancel"),this.styleModalInstance=null},a.prototype.openDialog=function(){return this.initTab(),this.eventBus.publish(this.eventBus.events.MODAL_OPENED),this.styleModalInstance=this.$modal.open({templateUrl:"SilverApp/views/change-style.html",backdrop:"static",scope:this.$scope})},a}(),a.$inject=["$scope","CONFIG","$modal","$sce","eventBus","loggerFactory","$window","docsmithConversionService","docsmithAPI","contentService","$q","omnitureService","projectService","appState","$timeout"],angular.module("silverApp").controller("StyleTabCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){this.$scope=a,this.$modal=c,this.web2PrintService=d,this.projectService=e,this.contentValidator=f,this.navService=g,this.$interval=h,this.$translate=i,this.contentService=j,this.omnitureService=k,this.config=l,this.deviceDetectionService=m,this.pageFactory=n,this.eventBus=o,this.imageURLService=p,this.textUpdateService=q,this.preview=b(this.preview,this),this._handleLastCharacterInterval=b(this._handleLastCharacterInterval,this),this._onTextDoubleClick=b(this._onTextDoubleClick,this),this.dialogIsOpen=!1,this.isDropdownOpen=!1,this._init(),this.$scope.ctrls.EditTextCtrl=this,this.nonPrintableWarning=this.$translate("SilverApp.editText.removeNonPrintable"),this.overflowWarning=this.$translate("SilverApp.editText.overflow"),this.maxAmountOfTextWarning=this.$translate("SilverApp.editText.maxAmountOfText"),this.eventBus.subscribe(this.eventBus.events.CUSTOMIZE_TEXT_DBLCLICK,this._onTextDoubleClick,this.$scope)}var c,d,e,f,g,h,i;return f=1.2,i=1.5,g=2,h=2.8,c=10,d=1e3,e=5e3,a.prototype._init=function(){var a,b;return this.textAsset=null,this.textStyles={},this.textContent="",this.warnings=[],this.nonPrintables=[],this.nonPrintablesCounter=0,this.textOverflowCounter=0,this.lastCharacterInterval=null,this.textOverflowing=!1,this.textLengthAtOverflow=0,this.textLimitReached=!1,this.truncateGuard=0,this.page=null,this.pageIsGrid=!1,this.allAssetPairs=null,this.currentPairIndex=-1,this.usedContent=null!=(a=this.projectService)&&null!=(b=a.currentProject)?b.usedContent:void 0,this.previewTextEnabled=this.config.previewText},a.prototype.close=function(){var a;if(this.dialogIsOpen!==!1)return this.dialogIsOpen=!1,this._stopLastCharacterWait(),null!=(a=this.modalInstance)?a.close():void 0},a.prototype.edit=function(a,b){var c,d,e,f,g,h,i;if(!this.dialogIsOpen){if(b===this.pageFactory.Page.FRONT_COVER_PAGE_NUMBER&&this.deviceDetectionService.isDeviceAPhone()){if(null!=(d=this.projectService)&&null!=(e=d.currentProject)&&null!=(f=e.product)?f.cover.frontPage.hasNoText():void 0)return;a=null!=(g=this.projectService)&&null!=(h=g.currentProject)&&null!=(i=h.product)?i.cover.frontPage.getFirstText():void 0,this.omnitureService.trackPageName({pageName:this.omnitureService.EDIT_TEXT_BOX_PAGE_NAME})}return this.dialogIsOpen=!0,this.assetIndex=a,this.surfaceNumber=b,this._init(),this._initEditor(),c=this.deviceDetectionService.isDeviceATablet()||this.deviceDetectionService.isDeviceAPhone()?"SilverApp/views/edit-text-tablet.html":"SilverApp/views/edit-text-simple.html",this.modalInstance=this.$modal.open({templateUrl:c,backdrop:"static",windowClass:"text-editor-modal",scope:this.$scope}),this.modalInstance.result.finally(function(a){return function(){return a.dialogIsOpen=!1}}(this))}},a.prototype._onTextDoubleClick=function(a,b){var c,d,e,f,g,h,i,j;if(null!=b&&null!=(h=b.page)&&null!=(i=h.layout)?i.assets:void 0){for(d=null,j=b.page.layout.assets,e=f=0,g=j.length;f<g;e=++f)c=j[e],b.asset===c&&(d=e);if(null!==d)return this.edit(d,b.page.surfaceNumber)}},a.prototype._initEditor=function(){return this.page=this.projectService.currentProject.product.pageBySurfaceNumber(this.surfaceNumber),this.pageIsGrid=this.page.isGrid,this.textAsset=this.page.layout.assets[this.assetIndex],this._generateEmptyText(),this.textStyles=this.textUpdateService.getUpdateableSettings(this.textAsset),this.nonPrintables=[],this.textContent=this.textAsset.editorContent,this.url=null,this.width=1e3,this.height=1e3,this.fetchOverflowStatus()},a.prototype._generateEmptyText=function(){var a;if(null==this.textAsset.fontId)return a=this.contentService.createTextArea("1","2",{width:this.textAsset.asset.width,height:this.textAsset.asset.height,paraStyle:this.textAsset.asset.paraStyle}),this.textAsset.values.text=a.text,this.textAsset.init(this.textAsset.values)},a.prototype.checkForWarnings=function(){return this._checkForNonPrintableWarnings(),this._checkForTextOverflowWarnings(),this._generateWarningsList()},a.prototype._truncateWithoutMercy=function(a){var b;return this.textLimitReached=!1,b=encodeURIComponent(encodeURIComponent(a)),b.length<=e?(this.textLimitReached=b.length===e,this._generateWarningsList(),a):(this.textLimitReached=!0,this._generateWarningsList(),this._truncateEncoded(b))},a.prototype._truncateEncoded=function(a){var b,c,d;d="";try{d=decodeURIComponent(decodeURIComponent(a.substring(0,e))),this.truncateGuard=0}catch(e){b=e,c=a.substring(0,a.length-1),this.truncateGuard++,this.truncateGuard<11&&(d=this._truncateEncoded(c))}return d},a.prototype._checkForTextOverflowWarnings=function(){return this.textOverflowCounter++,this.textOverflowCounter>c&&(this.textOverflowCounter=0,this.fetchOverflowStatus()),this._startLastCharacterWait()},a.prototype._handleLastCharacterInterval=function(){return this.fetchOverflowStatus(),this._stopLastCharacterWait()},a.prototype.fetchOverflowStatus=function(){var a,b,c;if(null==this.textContent||""===this.textContent||""===this.textContent.trim())return this.textOverflowing=!1,this.textLimitReached=!1,void this._generateWarningsList();if(this.textContent=this._truncateWithoutMercy(this.textContent),c=this.textContent.length,!(c>=this.textLengthAtOverflow&&this.textOverflowing))try{return a=this.textUpdateService.cloneAssetWithNewStyles(this.textAsset,this.textStyles,this.textContent),this.web2PrintService.textMetadataForAsset(a,this.textContent,"png").then(function(b){return function(d){return b.textOverflowing=d.overflow,b.textLengthAtOverflow=b.textOverflowing?c:0,b._generateWarningsList(),b.url=d.image,b.preview(a)}}(this))}catch(a){return b=a,this._stopLastCharacterWait()}},a.prototype._startLastCharacterWait=function(){return this._stopLastCharacterWait(),this.lastCharacterInterval=this.$interval(this._handleLastCharacterInterval,d)},a.prototype._stopLastCharacterWait=function(){if(null!=this.lastCharacterInterval)return this.$interval.cancel(this.lastCharacterInterval),this.lastCharacterInterval=void 0},a.prototype._checkForNonPrintableWarnings=function(){var a;return null==this.textContent||this.textContent.length<1?void(this.nonPrintables=[]):(a=this.contentValidator.cleanNonPrintableCharactersInContent(this.textContent,this._useFontHack(this.selectedFont)),this.textContent=a.cleanContent,0===a.invalidCharacters.length?this.nonPrintablesCounter++:this.nonPrintablesCounter=0,this.nonPrintables=a.invalidCharacters.concat(this.nonPrintables),this.nonPrintablesCounter>c?(this.nonPrintables=[],this.nonPrintablesCounter=0):void 0)},a.prototype._useFontHack=function(a){return"font_compendium_regular"===(null!=a?a.fontId:void 0)},a.prototype._generateWarningsList=function(){var a;return a=[],this.nonPrintables.length>0&&a.push(this.nonPrintableWarning),this.textOverflowing&&a.push(this.overflowWarning),this.textLimitReached&&a.push(this.maxAmountOfTextWarning),this.warnings=a},a.prototype.nextTextAsset=function(){return this._initAllAssets(),this._finishActiveSession(function(a){return function(){return a.currentPairIndex>=a.allAssetPairs.length-1?a.currentPairIndex=0:a.currentPairIndex++,a._initDifferentAsset()}}(this))},a.prototype.previousTextAsset=function(){return this._initAllAssets(),this._finishActiveSession(function(a){return function(){return a.currentPairIndex<=0?a.currentPairIndex=a.allAssetPairs.length-1:a.currentPairIndex--,a._initDifferentAsset()}}(this))},a.prototype._initAllAssets=function(){var a,b,c,d,e,f,g;if(null==this.allAssetPairs){
for(a=this.projectService.currentProject.product,this.allAssetPairs=a.assetPagePairsPassingTest(function(a){return null!=a.asset&&"text"===a.asset.assetType}),f=this.allAssetPairs,g=[],b=d=0,e=f.length;d<e;b=++d){if(c=f[b],c.assetIndex===this.assetIndex&&c.pageNumber===this.surfaceNumber){this.currentPairIndex=b;break}g.push(void 0)}return g}},a.prototype._initDifferentAsset=function(){var a;return a=this.allAssetPairs[this.currentPairIndex],this.assetIndex=a.assetIndex,this.surfaceNumber=a.pageNumber,this._initEditor(),this.navService.gotoPage(this.surfaceNumber)},a.prototype.done=function(){return this._finishActiveSession()},a.prototype.styleForAsset=function(a){var b;return b={width:""+this.width+"px",height:""+this.height+"px"}},a.prototype.preview=function(a){if(!this.config.superSimple&&this.previewTextEnabled&&null!=a&&null!=a.asset)return this.width=a.asset.width,this.height=a.asset.height,this.styles=this.styleForAsset(a)},a.prototype.editEvent=function(){var a,b;if(this.done(),a=this.textAsset,a.isEventTextAsset&&this.eventBus.events.SELECT_EVENTS_TAB)return a.isDateTextAsset&&(b=this.page.layout.assets.filter(function(b){return b.isEventTextAsset&&!b.isDateTextAsset&&b.dateValue===(null!=a?a.dateValue:void 0)}),a=b[0]),this.eventBus.publish(this.eventBus.events.SELECT_EVENTS_TAB,{page:this.page,asset:a})},a.prototype._finishActiveSession=function(a){return null==a&&(a=null),this.textContent=this._truncateWithoutMercy(this.textContent),this.textUpdateService.commitTextChanges(this.page,this.textAsset,this.textStyles,this.textContent).finally(function(b){return function(){return b._completeEditing(a)}}(this))},a.prototype._completeEditing=function(a){return null!=a?a():this.close()},a.prototype._forceOverflowStatusCheck=function(){return this.textLengthAtOverflow=e+1,this.fetchOverflowStatus()},a.prototype.onTextStyleChanged=function(a){return this.textStyles=angular.merge({},this.textStyles,a.textStyles),this._forceOverflowStatusCheck()},a}(),a.$inject=["$scope","$modal","web2PrintService","projectService","projectContentValidator","navService","$interval","$translate","contentService","omnitureService","CONFIG","deviceDetectionService","pageFactory","eventBus","imageURLService","textUpdateService"],angular.module("silverApp").controller("EditTextCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g){var h;this.$scope=a,this.$modalInstance=b,this.data=c,this.eventBus=d,this.$window=e,this.productRequestBuilder=f,this.$timeout=g,null!=(h=this.$scope.ctrls)&&(h.ErrorDialogCtrl=this),this.showDetails=!0}return a.prototype.ok=function(){return this.data.hasUnrecoverableErrors===!0?void this._reopenProject():this.$modalInstance.close()},a.prototype._reopenProject=function(){var a,b;return a=""+this.$window.location.protocol+"//"+this.$window.location.host,b=this.productRequestBuilder.getProjectReloadURL(a,this.data.project),this.$window.location.assign(b),this.$timeout(function(a){return function(){return a.$window.location.reload(!0)}}(this),500)},a.prototype.cancel=function(){return this.$modalInstance.dismiss("cancel")},a.prototype.show=function(){return this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_HIDE),this.showDetails},a.prototype.off=function(){return this.showDetails=!1},a.prototype.on=function(){return this.showDetails=!0},a}(),a.$inject=["$scope","$modalInstance","data","eventBus","$window","productRequestBuilder","$timeout"],angular.module("silverApp").controller("ErrorDialogCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l,m,n){this.$scope=a,this.$modal=c,this.userService=d,this.eventBus=e,this.config=f,this.$window=g,this.projectService=h,this.browserExitService=i,this.upsellService=j,this.projectEventService=l,this.internalProjectService=m,this.appState=n,this._customPathUrl=b(this._customPathUrl,this),this._orderUrl=b(this._orderUrl,this),this._loadUrl=b(this._loadUrl,this),this._logger=k.newInstance("OrderCtrl"),this.$scope.ctrls.OrderCtrl=this,this.eventBus.subscribe(this.eventBus.events.PROJECT_ORDER,function(a){return function(b,c){var d;return d=null==c||c.enableUpsell!==!1,a._order(d)}}(this)),this.eventBus.subscribe(this.eventBus.events.PROJECT_CONTINUE_ORDER,function(a){return function(b,c){return a.projectEventService.reportOrder().then(function(){return a._continueToOrder()})}}(this)),this.eventBus.subscribe(this.eventBus.events.INITIATE_UPSELL,function(a){return function(b,c){return a._initiateUpsell()}}(this))}return a.prototype._redirectHandlerCP=function(a){return function(b){return function(c){return a.success(),b._issueCPRedirect(c)}}(this)},a.prototype._issueCPRedirect=function(a){var b;return b=this._customPathUrl(a),this._loadUrl(b)},a.prototype._loadUrl=function(a){return this.appState.displayingInIframe===!0?this.$window.top.location.href=a:this.$window.location.href=a},a.prototype.order=function(a){var b;return null==a&&(a=!0),b=this.$modal.open({templateUrl:"SilverApp/views/inline-order-dialog.html",backdrop:"static",controller:"InlineOrderCtrl",resolve:{data:function(){return{}}}})},a.prototype._preview=function(){return this.$scope.ctrls.MainCtrl.enablePreviewMode(!0)},a.prototype.directOrder=function(){return this._order(!1)},a.prototype._initiateUpsell=function(){var a,b;return this.orderAndInUpsellModal=!0,a=this.$modal.open({controller:"UpsellCtrl",templateUrl:"SilverApp/views/upsell-modal.html",backdrop:"static",keyboard:!1,scope:this.$scope}),b=function(a){return function(){return a.orderAndInUpsellModal=!1}}(this),a.result.then(b,b)},a.prototype._identifyOperationOnSave=function(a){return a&&this.upsellService.hasUpsell()?this.eventBus.events.INITIATE_UPSELL:this.eventBus.events.PROJECT_CONTINUE_ORDER},a.prototype._order=function(a){var b;return this.eventBus.publish(this.eventBus.events.MODAL_OPENED),b=this._logger.asyncMetric("orderStart"),this.userService.userInfo().then(function(c){return function(d){var e;return b.log({loggedIn:d.isLoggedIn}),d.isLoggedIn?(e=c._identifyOperationOnSave(a),c.eventBus.publish(c.eventBus.events.PROJECT_SAVE,e)):c.eventBus.publish(c.eventBus.events.LOGIN_PROMPT,{name:c.eventBus.events.PROJECT_ORDER,data:{enableUpsell:a}})}}(this))},a.prototype._continueToOrder=function(){var a,b;return a=this._logger.asyncMetric("continueToOrder"),b=function(b){return function(c){return c.isLoggedIn?b._placeOrder(c,a):(a.log({loggedIn:!1}),b.eventBus.publish(b.eventBus.events.LOGIN_PROMPT,b.eventBus.events.PROJECT_ORDER))}}(this),this.userService.userInfo().then(b,this._failHandler(a))},a.prototype._placeOrder=function(a,b){return this.browserExitService.disablePrompt=!0,null==a.openflyToken?this.userService.getOpenflyToken().then(this._orderRedirectHandler(b),this._failHandler(b)):this._orderRedirectHandler(b)(a)},a.prototype._failHandler=function(a){return function(b){return a.failure({response:b})}},a.prototype._orderRedirectHandler=function(a){return function(b){return function(c){return a.success(),"function"==typeof b.config.orderRedirectHandler?void b.config.orderRedirectHandler(b.projectService.currentProject.projectGUID):b._loadUrl(b._orderUrl(c))}}(this)},a.prototype._orderUrl=function(a){return""+this.config.secureAppServer+"/forwardingSignin/start.sfly?authTicket="+a.openflyToken+"&forwardToURL="+this.config.secureAppServer+"/order/start.sfly?projectGuid="+this.projectService.currentProject.projectGUID+"&pid=SFLY&psid=WEB"},a.prototype._customPathUrl=function(a){return this.url=""+this.config.secureAppServer+"/forwardingSignin/start.sfly?authTicket="+a.openflyToken+"&forwardToURL="+this.config.appServer+"/custompath/start.sfly?projectGUID="+this.projectService.currentProject.projectGUID},a}(),a.$inject=["$scope","$modal","userService","eventBus","CONFIG","$window","projectService","browserExitService","upsellService","loggerFactory","projectEventService","internalProjectService","appState"],angular.module("silverApp").controller("OrderCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.$scope=a,this.$modalInstance=b,this.$scope.ctrls=this.$scope.ctrls||{},this.$scope.ctrls.InlineOrderCtrl=this,this.orderConfirmation=!1}return a.prototype.order=function(){return this.orderConfirmation=!0},a.prototype.dismiss=function(){return this.$modalInstance.dismiss("dismiss")},a}(),a.$inject=["$scope","$modalInstance"],angular.module("galleon").controller("InlineOrderCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l,m){return this.$scope=a,this.$modal=c,this.userService=d,this.eventBus=e,this.config=f,this.shareService=g,this.$translate=h,this.ngClip=i,this.$window=j,this.projectService=k,this.projectEventService=l,this.omnitureService=m,this.selectTab=b(this.selectTab,this),this.otherShareDialogHandler=b(this.otherShareDialogHandler,this),this.webLinkShareDialogHandler=b(this.webLinkShareDialogHandler,this),this.openFbShare=b(this.openFbShare,this),this.openPinterestShare=b(this.openPinterestShare,this),this.facebookShareDialogHandler=b(this.facebookShareDialogHandler,this),this.pinterestShareDialogHandler=b(this.pinterestShareDialogHandler,this),this.emailShareDialogHandler=b(this.emailShareDialogHandler,this),this.shareDialogHandler=b(this.shareDialogHandler,this),this.continueToShare=b(this.continueToShare,this),this.shareProject=b(this.shareProject,this),this.$scope.ctrls.ShareCtrl?this.$scope.ctrls.ShareCtrl:(this.$scope.ctrls.ShareCtrl=this,this.modalInstance=null,this.sent=!1,this.sentMessage="",this.emails="",this.emailSubject="",this.emailMessage="",this.urlMessage="",this.fbMessage="",this.pinterestMessage="",this.activeTab="weblink",this.shareUrl=null,this.isCopyDisabled=!0,this.isShareDisabled=!1,this.fbShareUrl=null,this.pinterestShareUrl=null,this.shareOther="sites",this.emailMessageCharRemainForDoubleCharNewLine=0,this.emailMessageCharRemainForSingleCharNewLine=0,this.pinterestMessageCharRemainForDoubleCharNewLine=0,this.pinterestMessageCharRemainForSingleCharNewLine=0,this.eventBus.subscribe(this.eventBus.events.PROJECT_SHARE,function(a){return function(b,c){return a.shareProject()}}(this),this.$scope),void this.eventBus.subscribe(this.eventBus.events.PROJECT_CONTINUE_SHARE,function(a){return function(b,c){return a.continueToShare()}}(this),this.$scope))}return a.prototype.updateEmailMessageLength=function(){return this.emailMessageCharRemainForDoubleCharNewLine=200-(this.emailMessage.length+this.emailMessage.split("\n").length-1),this.emailMessageCharRemainForSingleCharNewLine=200-this.emailMessage.length},a.prototype.updatePinterestMessageLength=function(){return this.pinterestMessageCharRemainForDoubleCharNewLine=200-(this.pinterestMessage.length+this.pinterestMessage.split("\n").length-1),this.pinterestMessageCharRemainForSingleCharNewLine=200-this.pinterestMessage.length},a.prototype.shareProject=function(){var a;return this.eventBus.publish(this.eventBus.events.MODAL_OPENED),this.sent=!1,this.emails="",this.fbMessage=this.$translate("SilverApp.Share.dialog.fbmessage"),this.pinterestMessage=this.$translate("SilverApp.Share.dialog.pinterestmessage"),this.isCopyDisabled=null!=(a=this.$window.ZeroClipboard)?a.isFlashUnusable():void 0,this.isShareDisabled=!1,this.userService.userInfo().then(function(a){return function(b){return b.isLoggedIn?(a.user=b,a.eventBus.publish(a.eventBus.events.PROJECT_SAVE,a.eventBus.events.PROJECT_CONTINUE_SHARE)):a.eventBus.publish(a.eventBus.events.LOGIN_PROMPT,a.eventBus.events.PROJECT_SHARE)}}(this))},a.prototype.continueToShare=function(){if(!this.modalInstance)return this.omnitureService.backupReportingPageName(),this.omnitureService.trackPageName({pageName:this.omnitureService.SHARE_DIALOG_PAGE_NAME}),this.emailMessage=this.$translate("SilverApp.Share.dialog.emailmessage"),this.emailSubject=this.$translate("SilverApp.Share.dialog.subject")+(" '"+this.projectService.currentProject.title+"'"),this.shareService.webLinkShare(this.$translate("SilverApp.Share.subject"),this.$translate("SilverApp.Share.message")).then(function(a){return function(b){return a.shareUrl=""+a.config.shareUrl+"?sid="+b+"&cid=SM-PBAPP",a.showShareDialog()}}(this),function(a){return function(b){return 406===b&&(a.isShareDisabled=!0),a.showShareDialog()}}(this))},a.prototype.showShareDialog=function(){var a;return this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/share.html",backdrop:"static",scope:this.$scope}),this.selectTab(this.activeTab),a=function(a){return function(){var b;if(b=a.omnitureService.getSavedReportingPageName())return a.omnitureService.trackPageName({pageName:b})}}(this),this.modalInstance.result.then(a,a)},a.prototype.close=function(){var a;return null!=(a=this.modalInstance)&&a.dismiss(),this.modalInstance=null},a.prototype.shareDialogHandler=function(){switch(this.activeTab){case"email":return this.emailShareDialogHandler();case"facebook":return this.facebookShareDialogHandler();case"weblink":return this.webLinkShareDialogHandler();case"other":return this.otherShareDialogHandler();case"pinterest":return this.pinterestShareDialogHandler()}},a.prototype.emailShareDialogHandler=function(){return this.shareService.emailShare(this.emails,this.emailSubject,this.emailMessage).then(function(a){return function(b){return a.projectEventService.reportEmailShare(),a.sent=!0,a.sentMessage=a.$translate("SilverApp.Share.dialog.emailsent")}}(this),function(a){return function(b){return a.sent=!0,a.sentMessage=a.$translate("SilverApp.Share.dialog.error")}}(this))},a.prototype.pinterestShareDialogHandler=function(){var a;return a=this.projectService.currentProject.projectGUID,this.projectService.singleSummary(this.user.id,a).then(function(a){return function(b){var c;return a.thumbnailUrl=b.ProjectSummaryResponse.thumbnailURI,a.pinterestShareUrl=""+a.config.pinterestShareUrl+encodeURIComponent(a.shareUrl),c=a.pinterestMessage.replace(/[#@&:/;]/g,""),a.pinterestShareUrl+="&description="+c+"&media="+encodeURIComponent(a.thumbnailUrl),a.sent=!0,a.sentMessage=a.$translate("SilverApp.Share.dialog.pinterestposted"),a.projectEventService.reportPinterestShare(),a.openPinterestShare()}}(this))},a.prototype.facebookShareDialogHandler=function(){return this.fbShareUrl=""+this.config.facebookShareUrl+encodeURIComponent(this.shareUrl),this.sent=!0,this.sentMessage=this.$translate("SilverApp.Share.dialog.fbposted"),this.projectEventService.reportFacebookShare(),this.openFbShare()},a.prototype.openPinterestShare=function(){var a,b;a=screen.width/2-450,b=screen.height/2-275,this.$window.open(this.pinterestShareUrl,"","top="+b+",left="+a+",width=700,height=350")},a.prototype.openFbShare=function(){var a,b;a=screen.width/2-250,b=screen.height/2-175,this.$window.open(this.fbShareUrl,"","top="+b+",left="+a+",width=500,height=350")},a.prototype.webLinkShareDialogHandler=function(){return this.sent=!0},a.prototype.otherShareDialogHandler=function(){var a,b;this.sent=!0,a=this.projectService.currentProject.projectGUID,b="sites"===this.shareOther?""+this.config.sitesShareUrl+"?projectId="+a+"&cancelURL=%2Fview%2Fprojects.jsp&shareType=PROJECT":""+this.config.embedShareUrl+"?projectId="+a+"&cancelURL=%2Fview%2Fprojects.jsp&shareType=PROJECT",this.$window.open(b)},a.prototype.isFormValid=function(a){var b;switch(this.activeTab){case"email":b=a.shareEmails&&!a.shareEmails.$error.sfMultipleEmails&&!a.shareEmails.$error.required;break;case"facebook":b=!0;break;case"weblink":b=!0;break;case"other":b=!0;break;case"pinterest":b=!0}return b},a.prototype.selectTab=function(a){return this.activeTab=a,this.sent=!1},a}(),a.$inject=["$scope","$modal","userService","eventBus","CONFIG","shareService","$translate","ngClip","$window","projectService","projectEventService","omnitureService"],angular.module("silverApp").controller("ShareCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g,h,i){return this.$scope=a,this.$modal=b,this.commandService=c,this.projectService=d,this.contentService=e,this.config=f,this.eventBus=g,this.globalContentService=h,this.navService=i,this.$scope.ctrls.TextSettingsCtrl?this.$scope.ctrls.TextSettingsCtrl:(this.modalInstance=null,this.fontFamilies=[],this.fontSizes=[],this.fontIndices={},this.savedSettings=[],this.selectedSettings=[],this.defaultStyles=[{paraStyle:"xsmall"},{paraStyle:"small"},{paraStyle:"medium"},{paraStyle:"large"},{paraStyle:"xlarge"},{paraStyle:"xxlarge"}],this.$scope.ctrls.TextSettingsCtrl=this,this.eventBus.subscribe(g.events.STYLE_LOADED,function(a){return function(){return a._styleLoaded()}}(this),a),void this.eventBus.subscribe(g.events.MODAL_TEXT_SETTINGS_UPDATED,function(a){return function(b,c){return a._onSettingsUpdated(c)}}(this),a))}return a.prototype._styleLoaded=function(){return this._init(),this._initFontFamilies(),this._initFontSizes(),this._initFontColors(),this._initSelectedItems(),this.savedSettings=angular.copy(this.defaultStyles),this.selectedSettings=angular.copy(this.defaultStyles)},a.prototype._init=function(){var a,b;return this.usedContent=null!=(a=this.projectService)&&null!=(b=a.currentProject)?b.usedContent:void 0},a.prototype._initFontFamilies=function(){return this.fontFamilies=this.contentService.currentFontFamilies(),this.allFontFamilies=this.globalContentService.fontFamilies,this.userSelectedFontFamilies=this._initUserSelectedFonts()},a.prototype._initFontSizes=function(){var a,b,c,d,e,f,g,h,i,j;if(!(this.fontSizes.length>0)){for(this.fontSizes=this.globalContentService.getFontSizes(),h=this.fontSizes,a=d=0,f=h.length;d<f;a=++d)b=h[a],this.fontIndices[""+b]=a;for(i=this.defaultStyles,j=[],e=0,g=i.length;e<g;e++)c=i[e],j.push(c.selectedFontSize=this.fontSizes[0]);return j}},a.prototype._initFontColors=function(){return this.colors=this.contentService.currentStyleColors(),this.allColors=this.contentService.allColors(),this.userSelectedColors=this._userSelectedColors()},a.prototype._initSelectedItems=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;for(q=this.defaultStyles,v=[],g=0,k=q.length;g<k;g++){for(f=q[g],c=null,r=this.contentService.currentStyle.fontAssignmentSet.fontAssignment,h=0,l=r.length;h<l;h++)if(b=r[h],f.paraStyle===b.key){c=b.fontDescriptor.fontId,f.selectedFontSize=b.fontDescriptor.pointSize;break}for(s=this.fontSizes,d=i=0,m=s.length;i<m;d=++i)if(e=s[d],e===f.selectedFontSize){f.selectedSizeIndex=d;break}if(f.selectedFontFamily=this.globalContentService.getFontFamilyForFontId(c),null!=f.selectedFontFamily)for(t=f.selectedFontFamily.fonts,j=0,n=t.length;j<n;j++)b=t[j],b.fontId===c&&(f.selectedFont=b);for(u=this.allColors,p=0,o=u.length;p<o;p++)a=u[p],a.color===f.color&&(f.selectedFontColor=a);null==f.selectedFontColor?v.push(f.selectedFontColor=this.colors[0]):v.push(void 0)}return v},a.prototype._initUserSelectedFonts=function(){var a,b,c,d,e,f;for(b=this._usedFontFamilies(),e=this.allFontFamilies,f=[],c=0,d=e.length;c<d;c++)a=e[c],this._isUsedNonStyleFont(b,a)&&f.push(a);return f},a.prototype._isUsedNonStyleFont=function(a,b){return null!=a[b.fontFamilyId]&&this.fontFamilies.indexOf(a[b.fontFamilyId])===-1},a.prototype._usedFontFamilies=function(){var a,b,c,d;d=this.usedContent.fontIds,a={};for(c in d)b=this.globalContentService.getFontFamilyForFontId(c),null!=b&&(a[b.fontFamilyId]=b);return a},a.prototype._userSelectedColors=function(){var a,b,c,d,e,f,g,h;for(d=this.usedContent.fontColors,c={},g=this.colors,e=0,f=g.length;e<f;e++)a=g[e],c[a.color]=!0;h=[];for(a in d)b=d[a],null==c[b]&&h.push(this.contentService.colorForHex(b));return h},a.prototype._onSettingsUpdated=function(a){return this.savedSettings=a.styleSettings,this.selectedSettings=a.styleSettings},a.prototype._getStyleByName=function(a){var b,c,d,e;for(e=this.selectedSettings,c=0,d=e.length;c<d;c++)if(b=e[c],b.paraStyle===a)return b;return null},a.prototype._updateStyleDefaults=function(){var a,b,c,d,e,f,g;for(a=this.contentService.currentStyle.fontAssignmentSet.fontAssignment,f=this.selectedSettings,g=[],d=0,e=f.length;d<e;d++)c=f[d],g.push(function(){var d,e,f;for(f=[],d=0,e=a.length;d<e;d++)if(b=a[d],c.paraStyle===b.key){b.fontDescriptor.colorId=c.selectedFontColor.id,b.fontDescriptor.fontFamilyId=c.selectedFontFamily.fontFamilyId,b.fontDescriptor.fontId=c.selectedFont.fontId,b.fontDescriptor.pointSize=c.selectedFontSize;break}return f}());return g},a.prototype._clonedAssetWithNewStyles=function(a,b){var c;return c=angular.copy(a),c.updateTextWithWrapsAndStyle(a.editorContent,[],!1,b),c},a.prototype._getCurrentPage=function(){var a,b,c,d;for(d=this.projectService.currentProject.product.allSurfaces,b=0,c=d.length;b<c;b++)if(a=d[b],a.surfaceNumber===this.navService.selectedPage.surfaceNumber)return a;return null},a.prototype.selectFontFamily=function(a,b){var c;return c=this._getStyleByName(a),c.selectedFontFamily=b,c.selectedFont=c.selectedFontFamily.fonts[0]},a.prototype.selectFontStyle=function(a,b){var c;return c=this._getStyleByName(a),c.selectedFont=b,c.selectedFontFamily=this.globalContentService.getFontFamilyForFontId(b.fontId)},a.prototype.incrementFontSize=function(a,b){var c,d;return d=this._getStyleByName(a),c=this.fontSizes.length-1,d.selectedSizeIndex=d.selectedSizeIndex>=c?c:d.selectedSizeIndex+1,d.selectedFontSize=this.fontSizes[d.selectedSizeIndex]},a.prototype.decrementFontSize=function(a,b){var c;return c=this._getStyleByName(a),c.selectedSizeIndex=c.selectedSizeIndex<=0?0:c.selectedSizeIndex-1,c.selectedFontSize=this.fontSizes[c.selectedSizeIndex]},a.prototype.selectFontSize=function(a,b){var c;return c=this._getStyleByName(a),c.selectedFontSize=b,c.selectedSizeIndex=this.fontIndices[""+c.selectedFontSize]},a.prototype.selectColor=function(a,b){var c;return c=this._getStyleByName(a),c.selectedFontColor=b},a.prototype.applySettingsToPage=function(){return this.commandService.execute("ApplyTextSettingsCommand",{pages:[this._getCurrentPage()],styleSettings:angular.copy(this.selectedSettings),originalStyleSettings:angular.copy(this.savedSettings)}),this.savedSettings=angular.copy(this.selectedSettings),this.closeDialog()},a.prototype.applySettingsToProject=function(){return this.commandService.execute("ApplyTextSettingsCommand",{pages:this.projectService.currentProject.product.allSurfaces,styleSettings:angular.copy(this.selectedSettings),originalStyleSettings:angular.copy(this.savedSettings)}),this.savedSettings=angular.copy(this.selectedSettings),this.closeDialog()},a.prototype.resetSettings=function(){return this.selectedSettings=angular.copy(this.defaultStyles)},a.prototype.openDialog=function(){return this.selectedSettings=angular.copy(this.savedSettings),this.dialogIsOpen=!0,this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/text-settings-modal.html",backdrop:"static",scope:this.$scope}),this.eventBus.publish(this.eventBus.events.MODAL_OPENED)},a.prototype.closeDialog=function(){var a;return null!=(a=this.modalInstance)&&a.close(),this.modalInstance=null},a.prototype.cancel=function(){var a;return null!=(a=this.modalInstance)&&a.dismiss("cancel"),this.modalInstance=null},a}(),a.$inject=["$scope","$modal","commandService","projectService","contentService","CONFIG","eventBus","globalContentService","navService"],angular.module("silverApp").controller("TextSettingsCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g,h,i,j,k){return this.$scope=a,this.$modal=b,this.commandService=c,this.projectService=d,this.project=e,this.contentService=f,this.config=g,this.eventBus=h,this.globalContentService=i,this.adaptiveLayoutService=j,this.navService=k,this.$scope.ctrls.ApplyToOtherPagesCtrl?this.$scope.ctrls.ApplyToOtherPagesCtrl:(this.modalInstance=null,this.$scope.selections={background:!1,layout:!1,frames:!1},void(this.$scope.ctrls.ApplyToOtherPagesCtrl=this))}return a.prototype.handleCoverPage=function(){var a;return(null!=(a=this.navService.selectedPage)?a.surfaceNumber:void 0)<1},a.prototype.getPageNumber=function(){return this.navService.selectedPage.surfaceNumber},a.prototype.openDialog=function(){if(!this.handleCoverPage())return this.dialogIsOpen=!0,this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/apply-to-other-pages-modal.html",backdrop:"static",scope:this.$scope}),this.eventBus.publish(this.eventBus.events.MODAL_OPENED)},a.prototype.closeDialog=function(){var a;return null!=(a=this.modalInstance)&&a.close(),this.modalInstance=null},a.prototype.cancel=function(){var a;return null!=(a=this.modalInstance)&&a.dismiss("cancel"),this.modalInstance=null},a.prototype.apply=function(){var a,b,c,d,e;return c=null!=(e=this.navService.selectedPage)?e.surfaceNumber:void 0,b=angular.fromJson(angular.toJson(this.projectService.currentProject.values)),d=this.contentService.currentStyle,a=this.$scope.selections,this.adaptiveLayoutService.applyToOtherPages(b,c,d,a).then(function(a){return function(b){return a.commandService.execute("ApplyToOtherPagesCommand",{project:b})}}(this)),this.$scope.selections={background:!1,layout:!1,frames:!1},this.closeDialog()},a}(),a.$inject=["$scope","$modal","commandService","projectService","project","contentService","CONFIG","eventBus","globalContentService","adaptiveLayoutService","navService"],angular.module("silverApp").controller("ApplyToOtherPagesCtrl",a)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b,d,e,f,g,h,i,j,k,l){this.$scope=a,this.$modalInstance=b,this.upsellService=d,this.upsellOptions=e,this.projectService=f,this.pricingService=g,this.eventBus=i,this.enums=j,this.omnitureService=k,this.upsellReportingService=l,this._reportAndProceedToOrder=c(this._reportAndProceedToOrder,this),this.$scope.ctrls=this.$scope.ctrls||{},this.$scope.ctrls.UpsellCtrl=this,this.adaptiveLayout=h.adaptiveLib,this._initialize()}return a.prototype._initialize=function(){return this.eventBus.subscribe(this.eventBus.events.PROJECT_CONVERSION_ERROR,this._reportAndProceedToOrder,this.$scope),this.eventBus.subscribe(this.eventBus.events.PROJECT_CONVERSION_COMPLETE,this._reportAndProceedToOrder,this.$scope),this.upsellProgress=this.upsellService.startProgress(),this.option={},this.book=this.projectService.currentProject.product,this.bookTitle=this.projectService.currentProject.title,this.bookSize=this.book.sizeId,this.coverSpecId=this.book.cover.coverSpecID,this.bookPageCount=this.book.pages.length,this.bookPricing=this.pricingService.getDefaultPricing(),this.bookComponents=this.pricingService.buildPricingRequest(this.projectService.currentProject),this._updatePricing(),this._setOptionDetail(this.upsellService.nextAvailableOption(this.upsellProgress))},a.prototype._updatePricing=function(){var a;return a=this.pricingService.getPrice(this.bookComponents),a.then(function(a){return function(b){return a.bookPricing=b.pricing}}(this)),a.catch(function(a){return function(b){return a.bookPricing=a.pricingService.getDefaultPricing()}}(this))},a.prototype._setOptionDetail=function(a){return this.option=b.create(a,this.upsellOptions),this._requestTentativePrice(),this.omnitureService.trackUpsellImpression(this._optionDetails())},a.prototype._requestTentativePrice=function(){var a,b;return a=this._getPricingComponentsForOption(this.option.name,this.bookComponents),b=this.pricingService.getPrice(a),b.then(function(a){return function(b){var c;return c=a.upsellService.getUpsellPriceFromResponse(a.option.name,b),a.option.origPrice=c.totalOrigPrice,a.option.salePrice=c.totalSalePrice,a.option.isOnSale=a.option.origPrice!==a.option.salePrice}}(this)),b.catch(function(a){return function(b){return a.option.origPrice=a.option.salePrice="",a.option.isOnSale=!1}}(this))},a.prototype._getPricingComponentsForOption=function(a,b){var c,d,e;switch(d=angular.copy(b),a){case this.upsellOptions.OPTION_HARD_COVER:c=this.book.cover.constructor.COVER_TYPE_USER_CUSTOM,e=this.adaptiveLayout.globalContent.getCoverBySizeAndType(this.bookSize,c),d.coverId=e.coverId;break;case this.upsellOptions.OPTION_MATTE_FINISH:d.coverFinishId=this.enums.Finish.MATTE;break;case this.upsellOptions.OPTION_LAYFLAT_BINDING:d.bindingId=this.enums.BindingType.LAYFLAT,delete d.pageFinishId,null!=b.dustJacketId&&this._applyDustJacketComponent(d);break;case this.upsellOptions.OPTION_HINGED_LAYFLAT_BINDING:d.bindingId=this.enums.BindingType.HINGED_LAYFLAT,delete d.pageFinishId,null!=b.dustJacketId&&this._applyDustJacketComponent(d);break;case this.upsellOptions.OPTION_DUST_JACKET:this._applyDustJacketComponent(d);break;case this.upsellOptions.OPTION_KEEPSAKE_POCKET:d.hasKeepsakePocket=!0;break;case this.upsellOptions.OPTION_GLOSSY_PAPER:d.pageFinishId="glossy"}return d},a.prototype._optionDetails=function(){return this.upsellOptions[this.option.name]},a.prototype._applyDustJacketComponent=function(a){var b,c,d;return c=null!=(d=a.bindingId)?d:"looseleaf",b=this.adaptiveLayout.globalContent.getCoverBinding(a.coverId,c),a.dustJacketId=null!=b?b.dustJacketCompositeId:void 0,a},a.prototype.yes=function(){return null!=this.option.name&&(this.upsellProgress.setChosen(this.option.name),this._requestModifiedPrice(),this.omnitureService.trackUpsellOptionResponse("Yes",this._optionDetails())),this._next()},a.prototype._requestModifiedPrice=function(){return this.bookComponents=this._getPricingComponentsForOption(this.option.name,this.bookComponents),this.coverSpecId=this.bookComponents.coverId,this._updatePricing()},a.prototype._next=function(){var a;return a=this.upsellService.nextAvailableOption(this.upsellProgress),this.upsellProgress.anyChosen()&&null===a?this._applyOptions():null===a?this._reportAndProceedToOrder():this._setOptionDetail(a)},a.prototype._applyOptions=function(){return this.upsellService.applyOptions(this.upsellProgress.chosen)},a.prototype._reportAndProceedToOrder=function(){var a,b,c,d;for(d=this.upsellProgress.chosen,b=0,c=d.length;b<c;b++)a=d[b],this.upsellReportingService.addFeatureOnUpsell(a);return this.eventBus.publish(this.eventBus.events.PROJECT_ORDER,{enableUpsell:!1})},a.prototype.no=function(){return null!=this.option.name&&(this.upsellProgress.setDismissed(this.option.name),this.omnitureService.trackUpsellOptionResponse("No",this._optionDetails())),this._next()},a.prototype.skip=function(){return this.omnitureService.trackUpsellOptionResponse("Skip",this._optionDetails()),this.upsellProgress.anyChosen()?this._applyOptions():this._reportAndProceedToOrder()},a}(),b=function(){function a(a,b,c,d,e){this.name=a,this.asset=b,this.title=c,this.descr=d,this.width=e,this.origPrice="",this.salePrice="",this.isOnSale=!1}return a.create=function(b,c){var d,e,f,g,h;switch(f=b,d="",g="",e="",h="",b){case c.OPTION_HARD_COVER:d="upsell-hard-cover",g="SilverApp.upsell.option.hardcover.title",e="SilverApp.upsell.option.hardcover.descr",h="upsell-width-400";break;case c.OPTION_MATTE_FINISH:d="upsell-matte-finish",g="SilverApp.upsell.option.mattefinish.title",e="SilverApp.upsell.option.mattefinish.descr",h="upsell-width-400";break;case c.OPTION_DUST_JACKET:d="upsell-dust-jacket",g="SilverApp.upsell.option.dustjacket.title",e="SilverApp.upsell.option.dustjacket.descr",h="upsell-width-400";break;case c.OPTION_LAYFLAT_BINDING:d="upsell-layflat",g="SilverApp.upsell.option.layflat.title",e="SilverApp.upsell.option.layflat.descr",h="upsell-width-400";break;case c.OPTION_HINGED_LAYFLAT_BINDING:d="upsell-hinged",g="SilverApp.upsell.option.hinged.title",e="SilverApp.upsell.option.hinged.descr",h="upsell-width-400";break;case c.OPTION_GLOSSY_PAPER:d="upsell-glossy-paper",g="SilverApp.upsell.option.glossypaper.title",e="SilverApp.upsell.option.glossypaper.descr",h="upsell-width-400";break;case c.OPTION_KEEPSAKE_POCKET:d="upsell-keepsake-pocket",g="SilverApp.upsell.option.keepsakepocket.title",e="SilverApp.upsell.option.keepsakepocket.descr",h="upsell-width-520"}return new a(f,d,g,e,h)},a}(),a.$inject=["$scope","$modalInstance","upsellService","upsellOptions","projectService","pricingService","adaptiveLayoutService","eventBus","enums","omnitureService","upsellReportingService"],
angular.module("silverApp").controller("UpsellCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g){var h,i,j,k,l,m;this.$scope=a,this.$modalInstance=b,this.commandService=c,this.$timeout=d,this.eventBus=e,this.omnitureService=f,this.imageCollection=g,this.$scope.ctrls=this.$scope.ctrls||{},this.$scope.ctrls.AllowUndoAutofillModalCtrl=this,null!=this.imageCollection&&(this.image1=null!=(h=this.imageCollection)&&null!=(i=h.projectImages)?i[0].thumbSrc:void 0,this.image2=null!=(j=this.imageCollection)&&null!=(k=j.projectImages)?k[1].thumbSrc:void 0,this.image3=null!=(l=this.imageCollection)&&null!=(m=l.projectImages)?m[2].thumbSrc:void 0),this.OPTION_YES="YES",this.OPTION_NO="NO",this.selectedOption="YES"}return a.prototype.ok=function(){return"YES"===this.selectedOption?this.keepAutofill():this.undoAutofill()},a.prototype.keepAutofill=function(){return this.omnitureService.trackPageName({pageName:this.omnitureService.KEEP_AUTOFILL_DIALOG_PAGE_NAME}),this.$modalInstance.close()},a.prototype.undoAutofill=function(){return this.commandService.willBeLongUndoOperation()?(this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this.$timeout(function(a){return function(){return a.commandService.undo(),a.$timeout(function(){return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)})}}(this),500)):this.commandService.undo(),this.$modalInstance.dismiss("cancel")},a}(),a.$inject=["$scope","$modalInstance","commandService","$timeout","eventBus","omnitureService","imageCollection"],angular.module("silverApp").controller("AllowUndoAutofillModalCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.config=a,this.$translate=b,this.omnitureService=c,this.appState=d,this.highlights=this.config.features.highlightsFeature}return a.prototype.isEnabled=function(){return this.config.features.tour},a.prototype.getTemplate=function(){var a,b,c,d,e,f,g;for(c="<div class='popover tour popover-padding' data-test-key='intro-tour'> <div class='popover-navigation'> <i class='removable-handler tour__close' data-role='end'></i> <div class='popover-content popover-content-padding'> </div> <div class='popover-bottom'> <span class='popover-title1 pull-left tour-button' style='padding-top: 3px;'>",d="",a=this.getSteps().length,e=f=1,g=a-1;1<=g?f<=g:f>=g;e=1<=g?++f:--f)d+="<span class='tour__step-indicator tour__step-indicator--"+e+"'></span>";return b="</span> <button class='btn btn-sm btn-default pull-right tour-button' data-role='next'>Next</button> <button class='btn btn-secondary pull-right tour-button' data-role='prev'>Back</button> </div> </div> </div>",c+d+b},a.prototype.getSteps=function(){var a;return a=[{orphan:!0,content:this.$translate("SilverApp.tour.introTourContent"),title:"",prev:-1,onShow:function(a){return function(){return a.omnitureService.trackPageName({pageName:a.omnitureService.INTRO_TOUR_START_PAGE_NAME})}}(this)},{element:"#backgroundsTab a",element2:"#layoutsTab a",content:this.$translate("SilverApp.tour.paletteTabTourContent"),placement:"right",title:"",onShow:function(a){return function(){return a.omnitureService.trackPageName({pageName:a.omnitureService.INTRO_TOUR_LAYOUTS_PAGE_NAME})}}(this)},{element:"#undoButton",element2:"#toolbar .tourable-item--toolbar",content:this.$translate("SilverApp.tour.toolbarTourContent"),placement:"bottom",title:"",onShow:function(a){return function(){return a.omnitureService.trackPageName({pageName:a.omnitureService.INTRO_TOUR_UNDO_PAGE_NAME})}}(this)},{element:"#arrangeTab a",element2:".tourable-item--tab a",content:this.$translate("SilverApp.tour.editTabTourContent"),placement:"bottom",title:"",onShow:function(a){return function(){return a.omnitureService.trackPageName({pageName:a.omnitureService.INTRO_TOUR_EDIT_PAGE_NAME})}}(this)},{element:"#storyboardTab a",content:this.$translate("SilverApp.tour.storyboardTabTourContent"),placement:"bottom",title:"",onShow:function(a){return function(){return a.omnitureService.trackPageName({pageName:a.omnitureService.INTRO_TOUR_STORYBOARD_PAGE_NAME})}}(this)}],this.highlights&&this.appState.paletteTabSelections.images?(a.push({element:"#saveButton",content:this.$translate("SilverApp.tour.saveButtonTourContent"),placement:"bottom",border:!0,title:"",onShow:function(a){return function(){return a.omnitureService.trackPageName({pageName:a.omnitureService.INTRO_TOUR_NAME_PAGE_NAME})}}(this)}),a.push({element:"#highlightsFilter",content:this.$translate("SilverApp.tour.highlightsTourContent"),placement:"top",title:"",next:-1,onShow:function(a){return function(){return a.omnitureService.trackPageName({pageName:a.omnitureService.INTRO_TOUR_HIGHLIGHTS_PAGE_NAME})}}(this)})):a.push({element:"#saveButton",content:this.$translate("SilverApp.tour.saveButtonTourContent"),placement:"bottom",border:!0,title:"",next:-1,onShow:function(a){return function(){return a.omnitureService.trackPageName({pageName:a.omnitureService.INTRO_TOUR_NAME_PAGE_NAME})}}(this)}),a},a}(),a.$inject=["CONFIG","$translate","omnitureService","appState"],angular.module("galleon-pb").service("introTourSettings",a)}.call(this),function(){var a;a=function(){function a(a,b,c,d){this.config=a,this.$translate=b,this.omnitureService=c,this.appState=d,this.highlights=this.config.features.highlightsFeature}return a.prototype.isEnabled=function(){return this.config.features.tour},a.prototype.getTemplate=function(){var a,b,c,d,e,f,g;for(c="<div class='popover tour popover-padding' data-test-key='intro-tour'> <div class='popover-navigation'> <i class='removable-handler tour__close' data-role='end'></i> <div class='popover-content popover-content-padding'> </div> <div class='popover-bottom'> <span class='popover-title1 pull-left tour-button' style='padding-top: 3px;'>",d="",a=this.getSteps().length,e=f=1,g=a-1;1<=g?f<=g:f>=g;e=1<=g?++f:--f)d+="<span class='tour__step-indicator tour__step-indicator--"+e+"'></span>";return b="</span> <button class='btn btn-sm btn-default pull-right tour-button' data-role='next'>Next</button> <button class='btn btn-secondary pull-right tour-button' data-role='prev'>Back</button> </div> </div> </div>",c+d+b},a.prototype.getSteps=function(){var a;return a=[{orphan:!0,content:this.$translate("SilverApp.gc.tour.introTourContent"),title:"",prev:-1,onShow:function(a){return function(){return a.omnitureService.trackPageName({pageName:a.omnitureService.INTRO_TOUR_START_PAGE_NAME})}}(this)},{element:"#editTab a",element2:"#eventsTab a",content:this.$translate("SilverApp.gc.tour.editTabTourContent"),placement:"bottom",title:"",onShow:function(a){return function(){return a.omnitureService.trackPageName({pageName:a.omnitureService.INTRO_TOUR_EDIT_PAGE_NAME})}}(this)},{element:"#storyboardTab a",content:this.$translate("SilverApp.gc.tour.storyboardTabTourContent"),placement:"bottom",title:"",onShow:function(a){return function(){return a.omnitureService.trackPageName({pageName:a.omnitureService.INTRO_TOUR_STORYBOARD_PAGE_NAME})}}(this)},{element:"#backgroundsTab a",element2:"#layoutsTab a",content:this.$translate("SilverApp.gc.tour.paletteTabTourContent"),placement:"right",title:"",onShow:function(a){return function(){return a.omnitureService.trackPageName({pageName:a.omnitureService.INTRO_TOUR_LAYOUTS_PAGE_NAME})}}(this)},{element:"#undoButton",element2:"#toolbar .tourable-item--toolbar",content:this.$translate("SilverApp.gc.tour.toolbarTourContent"),placement:"bottom",title:"",onShow:function(a){return function(){return a.omnitureService.trackPageName({pageName:a.omnitureService.INTRO_TOUR_UNDO_PAGE_NAME})}}(this)},{element:"#embellishmentsTab a",content:this.$translate("SilverApp.gc.tour.embellishmentsTourContent"),placement:"right",title:"",onShow:function(a){return function(){return a.omnitureService.trackPageName({pageName:a.omnitureService.INTRO_TOUR_EMBELLISHMENTS_PAGE_NAME})}}(this)}],this.highlights&&this.appState.paletteTabSelections.images&&a.push({element:"#highlightsFilter",content:this.$translate("SilverApp.gc.tour.highlightsTourContent"),placement:"top",title:"",next:-1,onShow:function(a){return function(){return a.omnitureService.trackPageName({pageName:a.omnitureService.INTRO_TOUR_HIGHLIGHTS_PAGE_NAME})}}(this)}),a},a}(),a.$inject=["CONFIG","$translate","omnitureService","appState"],angular.module("galleon-gc").service("introTourSettings",a)}.call(this),function(){var a;a=function(){function a(a,b,c){this.config=a,this.$translate=b,this.omnitureService=c,this.highlights=this.config.features.highlightsFeature}return a.prototype.isEnabled=function(){return!1},a.prototype.getTemplate=function(){return""},a.prototype.getSteps=function(){var a;return a=[]},a}(),a.$inject=["CONFIG","$translate","omnitureService"],angular.module("galleon-ss").service("introTourSettings",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.config=a,this.$translate=b}return a.prototype.isEnabled=function(){return this.config.whatsNewTour},a.prototype.getTemplate=function(){var a,b,c;return c="<div class='popover tour popover-padding' data-test-key='intro-tour'> <div class='popover-navigation'> <i class='removable-handler tour__close' data-role='end'></i> <div class='popover-content popover-content-padding'> </div> <div class='popover-bottom'> <span class='popover-title1 pull-left tour-button' style='padding-top: 3px;'>",a=this.getSteps().length,b="</span> <button class='btn btn-sm btn-default pull-right tour-button' data-role='next'>Next</button> <button class='btn btn-secondary pull-right tour-button' data-role='prev'>Back</button> </div> </div> </div>",c+b},a.prototype.getSteps=function(){var a;return a=[{element:"#projectMenu",content:this.$translate("SilverApp.tour.exportPDFTourContent"),placement:"bottom",title:"",nostart:!0},{element:"#pagesMenu",content:this.$translate("SilverApp.tour.importPageTourContent"),placement:"bottom",title:"",next:-1}]},a}(),a.$inject=["CONFIG","$translate"],angular.module("galleon-pb").service("newFeatureSettings",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.config=a,this.$translate=b}return a.prototype.isEnabled=function(){return this.config.whatsNewTour},a.prototype.getTemplate=function(){var a,b,c;return c="<div class='popover tour popover-padding' data-test-key='intro-tour'> <div class='popover-navigation'> <i class='removable-handler tour__close' data-role='end'></i> <div class='popover-content popover-content-padding'> </div> <div class='popover-bottom'> <span class='popover-title1 pull-left tour-button' style='padding-top: 3px;'>",a=this.getSteps().length,b="</span> <button class='btn btn-sm btn-default pull-right tour-button' data-role='next'>Next</button> <button class='btn btn-secondary pull-right tour-button' data-role='prev'>Back</button> </div> </div> </div>",c+b},a.prototype.getSteps=function(){var a;return a=[{element:"#projectMenu",content:this.$translate("SilverApp.tour.onePaletteWorkspaceContent"),placement:"bottom",title:"",nostart:!0,next:-1}]},a}(),a.$inject=["CONFIG","$translate"],angular.module("galleon-gc").service("newFeatureSettings",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.config=a,this.$translate=b}return a.prototype.isEnabled=function(){return!1},a.prototype.getTemplate=function(){return""},a.prototype.getSteps=function(){var a;return a=[]},a}(),a.$inject=["CONFIG","$translate"],angular.module("galleon-ss").service("newFeatureSettings",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g){this.$scope=a,this.omnitureService=b,this.introTourSettings=c,this.eventBus=d,this.$window=e,this.$timeout=f,this.appState=g,null==a.ctrls&&(a.ctrls={}),this.$scope.ctrls.IntroTourCtrl=this,this.initializeTour(),this.eventBus.subscribe(this.eventBus.events.START_INTRO_TOUR,function(a){return function(b,c){return a.startTour(b,c)}}(this),this.$scope),this.$scope.$watch("ctrls.IntroTourCtrl.appState.paletteTabSelections.images",function(a){return function(b){return a.initializeTour()}}(this))}return a.prototype.initializeTour=function(){var a;if(this.introTourSettings.isEnabled())return this.inTourMode=!1,this.tour=new this.$window.MyTour({name:"tour",onEnd:function(a){return function(b){var c;return c=a.omnitureService.getSavedReportingPageName(),c&&a.omnitureService.trackPageName({pageName:c}),onTourEnd()}}(this),onStart:function(a){return function(b){return a.omnitureService.backupReportingPageName(),onTourStart()}}(this),noarrow:!0,backdrop:!0,template:this.introTourSettings.getTemplate()}),a=this.introTourSettings.getSteps(),angular.forEach(a,function(a){return function(b){return a.tour.addStep(b)}}(this))},a.prototype.startTour=function(a,b){if(this.introTourSettings.isEnabled())return b&&b.invokedAtStart===!1&&this.tour.end(),this.tour.restart(!0)},a}(),a.$inject=["$scope","omnitureService","introTourSettings","eventBus","$window","$timeout","appState"],angular.module("silverApp").controller("IntroTourCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.$scope=a,this.newFeatureSettings=b,this.$window=c,this.eventBus=d,null==a.ctrls&&(a.ctrls={}),this.$scope.ctrls.NewFeatureCtrl=this,this.initializeTour(),this.eventBus.subscribe(this.eventBus.events.START_NEW_FEATURES,function(a){return function(){return a.startTour()}}(this),this.$scope)}return a.prototype.initializeTour=function(){var a;if(this.newFeatureSettings.isEnabled())return this.tour=new this.$window.MyTour({name:"newtour",onEnd:function(a){return onTourEnd()},onStart:function(a){return onTourStart()},noarrow:!0,backdrop:!0,template:this.newFeatureSettings.getTemplate()}),a=this.newFeatureSettings.getSteps(),angular.forEach(a,function(a){return function(b){var c;return"function"==typeof(c=a.tour).addStep?c.addStep(b):void 0}}(this))},a.prototype.startTour=function(){if(this.newFeatureSettings.isEnabled())return this.tour.restart(!0)},a}(),a.$inject=["$scope","newFeatureSettings","$window","eventBus"],angular.module("silverApp").controller("NewFeatureCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l){this.$scope=a,this.uppService=c,this.eventBus=d,this.imageCollection=e,this.adaptiveLayoutService=f,this.projectService=g,this.contentService=h,this.commandService=i,this.config=j,this.layoutService=k,this.deviceDetectionService=l,this._handleUploadComplete=b(this._handleUploadComplete,this),this._handleUploadStart=b(this._handleUploadStart,this),this.addPhotoEnabled=!this._totalMaxImagesReached(),this.maxPhotosPerSpread=this.deviceDetectionService.getSuperSimpleDefaults().photoSelection.maxPerSpread,this.lastStyleId=void 0,this.layouts={},this.swapQueue=void 0,this.swapCursor=0,this.$scope.$watch(function(a){return function(){var b;return null!=(b=a.selectedPage)?b.surfaceNumber:void 0}}(this),function(a){return function(){return a._initSelectedPage()}}(this)),this.$scope.$watch(function(a){return function(){var b,c;return null!=(b=a.layoutService.summarizeLayout(null!=(c=a.selectedPage)?c.layout:void 0))?b.imageCount:void 0}}(this),function(a){return function(){return a._initSelectedPage()}}(this)),this.lastAddedImages=[],this.eventBus.subscribe(this.eventBus.events.PALETTE_IMAGES_REMOVED,function(a){return function(){return a._refreshAddPhotoEnabled()}}(this),this.$scope)}return a.prototype.handleAddPhotos=function(){var a,b;if(null!=this.selectedPage)return a=this.deviceDetectionService,b=a.getSuperSimpleDefaults().photoSelection.max-this.imageCollection.projectImages.length,this._launchUpp(Math.min(this.maxPhotosPerSpread,b))},a.prototype.handleAddPhoto=function(){var a,b,c;if(null!=this.selectedPage)return a=this.selectedPage.getImages(),b=null!=a?a.length:0,c=this.maxPhotosPerSpread-b,c<=0?void 0:this._launchUpp(c)},a.prototype._launchUpp=function(a){var b;return this._unsubscribe(),this.uploadLoginCompletedToken=this.eventBus.subscribe(this.eventBus.events.UPP_IMAGE_FINISH,this._handleUploadComplete),this.uploadLoginStartedToken=this.eventBus.subscribe(this.eventBus.events.UPP_IMAGE_START,this._handleUploadStart),this.uploadCompletedToken=this.eventBus.subscribe(this.eventBus.events.UPP_IMAGE_PROCESSING_COMPLETE,this._handleUploadComplete),this.uploadStartedToken=this.eventBus.subscribe(this.eventBus.events.PALETTE_THUMBNAILS_ADDED,this._handleUploadStart),b={backgroundImport:!0,selectionLimit:{maxPhotos:this._maxAllowedImages(a),minPhotos:0}},this.uppService.show("UniversalPicker",b,!0)},a.prototype._maxAllowedImages=function(a){var b;return null==(null!=(b=this.imageCollection)?b.projectImages:void 0)?a:this.imageCollection.projectImages.length+a},a.prototype._totalMaxImagesReached=function(){var a;return(null!=(a=this.imageCollection.projectImages)?a.length:void 0)>=this.deviceDetectionService.getSuperSimpleDefaults().photoSelection.max},a.prototype._initSelectedPage=function(){if(this._refreshAddPhotoEnabled(),this.swapQueue=void 0,this.swapCursor=0,this.selectedPage)return this.tempSummary=this.layoutService.summarizeLayout(this.selectedPage.layout)},a.prototype._refreshAddPhotoEnabled=function(){var a;if(null!=this.selectedPage)return a=this.selectedPage.getImages().length<this.maxPhotosPerSpread||!this.selectedPage.isInnerPage(),this.addPhotoEnabled=!this._totalMaxImagesReached()&&a},a.prototype._handleUploadStart=function(a,b){return this.isUppImagesSelected()&&this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this.lastAddedImages=b},a.prototype._handleUploadComplete=function(a,b){var c,d,e,f,g,h,i,j;if(this.lastAddedImages.length>0){for(d=[],e=[],j=this.lastAddedImages,h=0,i=j.length;h<i;h++)g=j[h],c=this.imageCollection.getImageByImageId(g.id),e.push(c.imageId),d.push(c);return f=this.adaptiveLayoutService.createProductSpec(this.projectService.currentProject.product,this.selectedPage),this.adaptiveLayoutService.getAdaptiveLayoutForBatchImages(this.selectedPage,f,d,this._createAdaptOptions()).then(function(a){return function(b){return a.commandService.execute("AdaptPageCommand",{pageNumber:a.selectedPage.surfaceNumber,imageIds:e,layoutInfo:b}),a.lastAddedImages=[],a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE),a._initSelectedPage(),a._unsubscribe()}}(this))}},a.prototype._createAdaptOptions=function(){return{pageCount:this.projectService.currentProject.product.pages.length,styleJson:this.contentService.currentStyle,projectType:this.projectService.currentProject.type,exactConstraintMatch:!0,styleSpecificLayoutCategory:this.contentService.currentStyleCategory}},a.prototype._unsubscribe=function(){return this.eventBus.unsubscribe(this.uploadCompletedToken),this.eventBus.unsubscribe(this.uploadStartedToken),this.eventBus.unsubscribe(this.uploadLoginCompletedToken),this.eventBus.unsubscribe(this.uploadLoginStartedToken)},a.prototype.handleSwapLayouts=function(){var a,b;return this._refreshLayouts(),this._setUpSwapQueue(),"function"==typeof(a=this.swapQueue)[b=this.swapCursor]&&a[b](),this.swapCursor=this.swapCursor>=this.swapQueue.length-1?0:this.swapCursor+1},a.prototype._setUpSwapQueue=function(a){var b;null==this.swapQueue&&(this.swapQueue=[],this.swapCursor=0,a=this.layoutService.summarizeLayout(this.selectedPage.layout),b=this._matchingLayoutList().filter(function(b){return function(c){var d;return d=b.layoutService.summarizeLayout(c.layoutJson),d.imageCount===a.imageCount}}(this)),this.selectedPage.isInnerPage()&&this.swapQueue.push(this._createFlippedOperation()),b.sort(function(a){return function(b,c){return b.assetId===a.selectedPage.layoutName?1:-1}}(this)),b.forEach(function(a){return function(b){if((a.swapQueue.length>0||b.assetId!==a.selectedPage.layoutName)&&a.swapQueue.push(a._createApplyLayoutOperation(b)),a.selectedPage.isInnerPage()&&b.assetId!==a.selectedPage.layoutName)return a.swapQueue.push(a._createFlippedOperation())}}(this)))},a.prototype._createFlippedOperation=function(){return function(a){return function(){return a.adaptiveLayoutService.flipLayout(angular.copy(a.selectedPage.layout.values)).then(function(b){return a.commandService.execute("ApplyLayoutCommand",{pageNumber:a.selectedPage.surfaceNumber,layout:b,toggleFlippedLayout:!0})})}}(this)},a.prototype._createApplyLayoutOperation=function(a){return function(b){return function(){return b.layoutService.applyToSelectedPage(a)}}(this)},a.prototype._refreshLayouts=function(){var a;if(this.lastStyleId!==this.contentService.currentStyle.styleId)return this.lastStyleId=this.contentService.currentStyle.styleId,a=this.contentService.currentStyleCategory,this.layouts=this.layoutService.parseLayoutsFromStyle(this._styleSpecificFilter(a))},a.prototype._styleSpecificFilter=function(a){return function(b){return b.assetId.indexOf(a)!==-1}},a.prototype._matchingLayoutList=function(){return this.selectedPage.isSpread()?this.layouts.innerSpreadLayouts:this.selectedPage.isInnerPage()?this.layouts.innerLayouts:this.selectedPage.isFrontCover()?this.layoutService.filterLayoutsFromCurrentCoverType(this.layouts.frontCoverLayouts):this.selectedPage.isBackCover()?this.layoutService.filterLayoutsFromCurrentCoverType(this.layouts.backCoverLayouts):this.selectedPage.isSpine()?this.layoutService.filterLayoutsFromCurrentCoverType(this.layouts.spineLayouts,!0):this.selectedPage.isTitlePage()?this.layouts.titleLayouts:[]},a.prototype.hasTextButton=function(){this.selectedPage.hideTextBoxes=!this.selectedPage.hideTextBoxes,this.selectedPage.hideTextBoxes&&this.selectedPage.removeAllText(),this._refreshLayouts()},a.prototype.hasGreaterThanMinPages=function(){var a;return a=this.selectedPage.isSpread()?1:0,this.projectService.currentProject.product.pages.length>this.config.defaults.minPages+a},a.prototype.isUppImagesSelected=function(){var a,b,c,d,e,f;return("undefined"!=typeof data&&null!==data&&null!=(a=data.detail)&&null!=(b=a.done)?b.length:void 0)>0||("undefined"!=typeof data&&null!==data&&null!=(c=data.detail)&&null!=(d=c.wait)?d.length:void 0)>0||("undefined"!=typeof data&&null!==data&&null!=(e=data.detail)&&null!=(f=e.xfer)?f.length:void 0)>0},a}(),a.$inject=["$scope","uppService","eventBus","imageCollection","adaptiveLayoutService","projectService","contentService","commandService","CONFIG","layoutService","deviceDetectionService"],angular.module("silverApp").controller("TabletToolsCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i){this.$scope=a,this.eventBus=c,this.sizeInitializer=d,this.pricingService=e,this.$document=f,this.$timeout=g,this.docsmithConversionService=h,this.$modal=i,this._onConversionError=b(this._onConversionError,this),this._onProjectChanged=b(this._onProjectChanged,this),this._handleClick=b(this._handleClick,this),this.coverPricesBySize=null,this.selectedOption=null,this.project=null,this.eventBus.subscribe(this.eventBus.events.PROJECT_LOADED,this._onProjectChanged,this.$scope),this.eventBus.subscribe(this.eventBus.events.PROJECT_MODIFIED,this._onProjectChanged,this.$scope),this.eventBus.subscribe(this.eventBus.events.PROJECT_CONVERSION_ERROR,this._onConversionError,this.$scope)}return a.prototype.link=function(){var a;return this.areOptionsVisible=!1,this.sizeOptionLink=this._generateLinkName(),a=this._handleClick.bind(this),this.$document.off("click",a),this.$document.on("click",a)},a.prototype._handleClick=function(a){var b;return b=$(a.target),b.closest(".navbar-tablet-size-options").hasClass("navbar-tablet-size-options")?this.areOptionsVisible=!0:this.areOptionsVisible=!1,this.$timeout(function(a){return function(){return a.$scope.$apply()}}(this))},a.prototype._generateLinkName=function(){var a,b,c,d;for(c="",b=d=0;d<8;b=++d)a=Math.floor(26*Math.random())+65,c+=String.fromCharCode(a);return"pricingLink-"+c},a.prototype._onProjectChanged=function(a,b){return this.project=b,this.selectedOption="_"+b.product.sizeId,this.pricingService.requestCoverPricing(this.sizeInitializer.getCoverTypes()).then(function(a){return function(){return a.coverPricesBySize=a.pricingService.coverPricesBySize}}(this))},a.prototype._onConversionError=function(){if(null!=this.project)return this.selectedOption="_"+this.project.product.sizeId},a.prototype.getProductDescriptionIdForSize=function(a){return a+"_bk_hard"},a.prototype.changeSize=function(a){var b;if(b=a,null!=b&&null!=this.project&&b!==this.project.product.sizeId)return this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this.docsmithConversionService.start(this.project,{bookSize:b,sizeId:b})},a.prototype.getPriceForSize=function(a){var b,c;return null==(null!=(b=this.coverPricesBySize)&&null!=(c=b[a])?c.salePrice:void 0)?"...":this.coverPricesBySize[a].salePrice},a}(),a.$inject=["$scope","eventBus","sizeInitializer","pricingService","$document","$timeout","docsmithConversionService","$modal"],angular.module("silverApp").controller("TabletChangeSizeCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j){return this.$scope=a,this.config=c,this.$modal=d,this.userService=e,this.projectService=f,this.eventBus=g,this.internalProjectService=h,this.$timeout=i,this.navService=j,this.continueToExport=b(this.continueToExport,this),this.exportProject=b(this.exportProject,this),this.$scope.ctrls.ExportToPDFCtrl?this.$scope.ctrls.ExportToPDFCtrl:(this.eventBus.subscribe(this.eventBus.events.PROJECT_EXPORT,function(a){return function(b,c){return a.exportProject()}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.PROJECT_CONTINUE_EXPORT,function(a){return function(b,c){return a.continueToExport()}}(this),this.$scope),this.eventBus.subscribe(g.events.MODAL_EXPORT_PDF_DISMISS,function(a){return function(b){return a.cancel()}}(this),a),this.OPTION_PAGE="PAGE",this.OPTION_BOOK="BOOK",this.exportType=this.OPTION_PAGE,this.exporting=!1,void(this.$scope.ctrls.ExportToPDFCtrl=this))}return a.prototype.export=function(){var a;return this.exporting=!1,a=this.projectService.currentProject.projectGUID,this.exportType===this.OPTION_BOOK?this._renderBook(a):this._renderPage(a)},a.prototype.exportProject=function(){return this.userService.userInfo().then(function(a){return function(b){return b.isLoggedIn?a.eventBus.publish(a.eventBus.events.PROJECT_SAVE,a.eventBus.events.PROJECT_CONTINUE_EXPORT):a.eventBus.publish(a.eventBus.events.LOGIN_PROMPT,a.eventBus.events.PROJECT_EXPORT)}}(this))},a.prototype.continueToExport=function(){return this.userService.userInfo().then(function(a){return function(b){return a.user=b}}(this)),this.setFileName(),this.openDialog()},a.prototype._requestSurfaceNumber=function(a){return a.isFrontCover()?"frontPage":a.isBackCover()?"backPage":a.isSpine()?"spinePage":a.surfaceNumber},a.prototype.setFileName=function(){var a,b,c,d,e;return a=new Date,c=a.getMonth()+1,b=a.getDate(),e=a.getFullYear(),d=this.projectService.currentProject.titleStr,this.isSpread=this.navService.selectedPage.isSpread(),this.pageNum=this._requestSurfaceNumber(this.navService.selectedPage),b<10&&(b="0"+b),this.exportToPDFFilenameBook=d+"_"+c+b+e+".pdf",this.exportToPDFFilenamePage=d+"_"+this.pageNum+"_"+c+b+e+".pdf",console.log("@exportToPDFFilenameBook=",this.exportToPDFFilenameBook)},a.prototype._renderPage=function(a){if(null!=a)return this.exporting=!0,this.internalProjectService.renderSinglePage(this.user.id,a,this.projectService.currentProject.product,this.pageNum,this.exportToPDFFilenamePage,this.isSpread)},a.prototype._renderBook=function(a){if(null!=a)return this.exporting=!0,this.internalProjectService.renderBook(this.user.id,a,this.projectService.currentProject.product,this.exportToPDFFilenameBook)},a.prototype._handlePleaseWait=function(){return this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_HIDE)},a.prototype.disallowCurrentPageSelection=function(){return this.projectService.currentProject.product.cover.isStockCover&&this.isCurrentPageCover()},a.prototype.isCurrentPageCover=function(){return this.navService.selectedPage.isCover()},a.prototype.cancel=function(){var a,b;return null!=(a=this.modalInstance)&&"function"==typeof a.dismiss&&a.dismiss(),this.modalInstance=null,this.exporting=!1,null!=(b=this.internalProjectService.pdfService)?null!=b.exportTotal?b.exportTotal:b.exportTotal=0:void 0},a.prototype.openDialog=function(a){return this.disallowCurrentPageSelection()&&(this.exportType=this.OPTION_BOOK),this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/export-pdf.html",backdrop:"static",scope:this.$scope})},a}(),a.$inject=["$scope","CONFIG","$modal","userService","projectService","eventBus","internalProjectService","$timeout","navService"],angular.module("silverApp").controller("ExportToPDFCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k){this.$scope=a,this.config=c,this.$modal=d,this.userService=e,this.projectService=f,this.eventBus=g,this.internalProjectService=h,this.$timeout=i,this.navService=j,this.$window=k,this.continueToSave=b(this.continueToSave,this),this.savePage=b(this.savePage,this),null==a.ctrls&&(a.ctrls={}),this.eventBus.subscribe(this.eventBus.events.PROJECT_SAVE_JPG,function(a){return function(b,c){return a.savePage()}}(this),this.$scope),this.eventBus.subscribe(this.eventBus.events.PROJECT_CONTINUE_SAVE_JPG,function(a){return function(b,c){return a.continueToSave()}}(this),this.$scope),this.eventBus.subscribe(g.events.MODAL_SAVE_JPG_DISMISS,function(a){return function(b){return a.exportCompleted()}}(this),this.$scope),this.exporting=!1,this.exportComplete=!1,this.saveJPGFilenamePage="Book Pages",this.$scope.ctrls.SaveJpgCtrl=this}return a.prototype.exportCompleted=function(){return this.exportComplete=!0,this.exporting=!1,console.log("exportComplete=",this.exportComplete)},a.prototype.save=function(){var a;return this.exporting=!1,this.exportComplete=!1,this.setFileName(),a=this.projectService.currentProject.projectGUID,this._renderPage(a)},a.prototype.savePage=function(){return this.userService.userInfo().then(function(a){return function(b){return b.isLoggedIn?a.eventBus.publish(a.eventBus.events.PROJECT_SAVE,a.eventBus.events.PROJECT_CONTINUE_SAVE_JPG):a.eventBus.publish(a.eventBus.events.LOGIN_PROMPT,a.eventBus.events.PROJECT_SAVE_JPG)}}(this))},a.prototype.continueToSave=function(){return this.userService.userInfo().then(function(a){return function(b){return a.user=b,a.setFileName(),a.openDialog()}}(this))},a.prototype.setFileName=function(){return this.pageNum=this._requestSurfaceNumber(this.navService.selectedPage)},a.prototype._requestSurfaceNumber=function(a){return a.isFrontCover()?"frontPage":a.isBackCover()?"backPage":a.isSpine()?"spinePage":a.surfaceNumber},a.prototype._renderPage=function(a){if(null!=a)return this.exporting=!0,this.internalProjectService.renderSinglePage(this.user.id,a,this.projectService.currentProject.product,this.pageNum,this.saveJPGFilenamePage,!1,!0,!1)},a.prototype._handlePleaseWait=function(){return this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_HIDE)},a.prototype.isCurrentPageCover=function(){return this.navService.selectedPage.isCover()},a.prototype.gotoMyPhotos=function(){var a;this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_HIDE),a=""+this.config.secureAppServer+"/forwardingSignin/start.sfly?authTicket="+this.user.openflyToken+"&forwardToURL=",this.photosUrl=a+encodeURIComponent(""+this.config.secureAppServer+"/nav/mypics.sfly"),this.$timeout(function(a){return function(){return a.$window.open(a.photosUrl,"_blank")}}(this))},a.prototype.cancel=function(){var a,b;return null!=(a=this.modalInstance)&&"function"==typeof a.dismiss&&a.dismiss(),this.modalInstance=null,this.exporting=!1,this.exportComplete=!1,null!=(b=this.internalProjectService.pdfService)?null!=b.exportTotal?b.exportTotal:b.exportTotal=0:void 0},a.prototype.openDialog=function(a){return this.userService.isUserMigrated()?this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/save-jpg.html",
backdrop:"static",scope:this.$scope}):this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/cannot-save-jpg-modal.html",backdrop:"static",scope:this.$scope,controller:"SimpleModalCtrl",resolve:{data:function(){return a}}})},a}(),a.$inject=["$scope","CONFIG","$modal","userService","projectService","eventBus","internalProjectService","$timeout","navService","$window"],angular.module("silverApp").controller("SaveJpgCtrl",a)}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d){this.$document=a,this.config=c,this.eventBus=d,this.notSaving=b(this.notSaving,this),this.savingNow=b(this.savingNow,this),this.customize={PASSIVE:"passive",ACTIVE:"active",NONE:"none",DELETING_MODE_CLASS:"customize-delete-mode"},this.customizeMode=this.customize.NONE,this.dev={},this.twoPageSpreadHasLoaded=!1,this.zoomFactor=1,this.simpleMode=!1,this.saving=!1,this.backgroundsWaitingForPicture=[],this.eventBus.subscribe(this.eventBus.events.PROJECT_SAVING_IN_PROGRESS,this.savingNow),this.eventBus.subscribe(this.eventBus.events.PROJECT_SAVING_COMPLETE,this.notSaving),this.eventBus.subscribe(this.eventBus.events.MODAL_OPENED,this.cancelBackgroundWaitingForPicture),this.paletteTabSelections={images:!0,layouts:!0}}return a.prototype.savingNow=function(){return this.saving=!0},a.prototype.notSaving=function(){return this.saving=!1},a.prototype.canCustomize=function(){return this.config.customize},a.prototype.isCustomizing=function(){var a;return(a=this.customizeMode)===this.customize.PASSIVE||a===this.customize.ACTIVE},a.prototype.modalIsOpen=function(){return null!=this._document().querySelector("div[modal-window]")},a.prototype.cancelBackgroundWaitingForPicture=function(){return this.backgroundsWaitingForPicture=[]},a.prototype.activelyEditingText=function(){var a,b,c,d;return a=this._document().activeElement,null!=a&&(c=null!=(d=a.nodeName)?d.toLowerCase():void 0,b=a.type,"textarea"===c||"input"===c&&("text"===b||"password"===b))},a.prototype.closeOpenModal=function(){var a;if(a=angular.element(this._document().querySelector("i[class='icon-dialog-close']")),null!=a)return a.triggerHandler("click")},a.prototype._document=function(){return this.$document[0]},a.prototype._body=function(){return angular.element(this._document().body)},a.prototype.addBodyClass=function(a){return this._body().addClass(a)},a.prototype.removeBodyClass=function(a){return this._body().removeClass(a)},a.prototype.hideTooltips=function(a){var b,c,d,e,f;for(null!=a&&angular.element(a).triggerHandler("mouseleave"),e=this._document().querySelectorAll("div.tooltip"),f=[],c=0,d=e.length;c<d;c++)b=e[c],f.push(b.parentNode.removeChild(b));return f},a.prototype.toggleCustomize=function(){return this.isCustomizing()?this.customizeMode=this.customize.NONE:this.customizeMode=this.customize.ACTIVE},a}(),a.$inject=["$document","CONFIG","eventBus"],angular.module("silverApp").service("appState",a)}.call(this),function(){var a;a=function(){function a(a,b,c,d,e,f,g){this.config=a,this.$route=b,this.localStorageService=c,this.$window=d,this.appState=e,this.omnitureService=f,this.deviceDetectionService=g}return a.prototype.initProductSettings=function(a){return this.config.superSimple=!1,this._initSuperSimple(a),this._initSlideshow(a)},a.prototype.initPreview=function(a){return this.config.playButton=!0},a.prototype._initSuperSimple=function(a){var b;if((null!=(b=this.$route.current)?b.superSimple:void 0)===!0&&(this.config.arrange=!0,this.config.superSimple=!0,this.config.defaults.coverSpecId="8x8_bk_hard",this.config.defaults.styleId="5122",this.config.defaults.styleVersion="231",this.config.startWithFrontCover=!0,this.config.noTextOnCover?this.config.defaults.constraints.TextAreaCountConstraint.pageSpecific={inner:"none",cover:"none"}:this.config.defaults.constraints.TextAreaCountConstraint.pageSpecific={inner:"none"},this.config.customize=!1,this.config.playButton=!0,this.config.clearAutofillPrompt=!1,this.config.spreads=!1,this.config.features.highlightsFeature=!1,this.omnitureService.currentAppMode=this.omnitureService.constructor.GALLEON_SUPER_SIMPLE,a.superSimple=!0,this.deviceDetectionService.isDeviceAPhone()&&!this.deviceDetectionService.isDeviceATablet()&&(this.config.defaults.autoSaveTimer=6e4,this.config.defaults.maxAllowedImages=1e4),(this.deviceDetectionService.isDeviceAPhone()||this.deviceDetectionService.isDeviceATablet())&&(this.config.advancedArrange=!1,this.config.features.advancedText=!1,this.config.defaults.constraints.GroupCountConstraint.max=this.deviceDetectionService.getSuperSimpleDefaults().constraints.GroupCountConstraint.max,this.config.defaults.constraints.GroupCountConstraint.min=this.deviceDetectionService.getSuperSimpleDefaults().constraints.GroupCountConstraint.min,this.config.defaults.constraints.LinearDensityConstraint.densityPoints=this.deviceDetectionService.getSuperSimpleDefaults().constraints.LinearDensityConstraint.densityPoints),!this.deviceDetectionService.isDeviceAPhone()))return this.config.spreads=!0,this.config.defaults.coverSpecId="10x10_bk_hard",this.config.defaults.styleId="5214",this.config.defaults.styleVersion="2",this.config.defaults.constraints.SpreadConstraint=this.deviceDetectionService.getSuperSimpleDefaults().constraints.SpreadConstraint,this.config.defaults.constraints.ImageCountConstraint=this.deviceDetectionService.getSuperSimpleDefaults().constraints.ImageCountConstraint,this.config.defaults.constraints.TextAreaCountConstraint=this.deviceDetectionService.getSuperSimpleDefaults().constraints.TextAreaCountConstraint},a.prototype._initSlideshow=function(a){var b;if((null!=(b=this.$route.current)?b.slideshow:void 0)===!0)return this.config.slideshow=!0,this.config.customize=!1,this.config.playButton=!0,this.config.spreads=!0,this.config.arrange=!1,this.config.features.debug_frequentProjectValidation=!1,this.config.startWithFrontCover=!0,this.config.allowAutoSave=!1,this.config.allowHotKeys=!1,this.appState.displayingInIframe=!0,this.appState.inPreviewMode=!0,this.appState.inSlideshow=!0,a.allowHotKeys=!1,a.slideshow=!0,a.superSimple=!1,a.previewMode=!0,a.pageTabPageTooltip="",a.canOrderFromSlideshow=this.config.canOrderFromSlideshow,a.hideHeaderForSlideshow=this.config.hideHeaderForSlideshow},a}(),a.$inject=["CONFIG","$route","localStorageService","$window","appState","omnitureService","deviceDetectionService"],angular.module("galleon-pb").service("productInitializer",a)}.call(this),function(){var a;a=function(){function a(a,b,c,d,e,f){this.config=a,this.$route=b,this.localStorageService=c,this.browserDetectionService=d,this.$window=e,this.appState=f}return a.prototype.initProductSettings=function(a){return this._initSlideshow(a),this.config.arrange=!1,this.config.startWithFrontCover=!1,this.config.storyboard=!0,a.storyboardEnabled=!0,this.config.advancedArrange=!1},a.prototype.initPreview=function(a){return this.config.playButton=!1},a.prototype._initSlideshow=function(a){var b;if((null!=(b=this.$route.current)?b.slideshow:void 0)===!0)return this.config.slideshow=!0,this.config.customize=!1,this.config.playButton=!1,this.config.spreads=!0,this.config.features.debug_frequentProjectValidation=!1,this.config.allowAutoSave=!1,this.config.allowHotKeys=!1,this.appState.displayingInIframe=!0,this.appState.inPreviewMode=!0,this.appState.inSlideshow=!0,a.allowHotKeys=!1,a.slideshow=!0,a.superSimple=!1,a.previewMode=!0,a.pageTabPageTooltip="",a.canOrderFromSlideshow=this.config.canOrderFromSlideshow,a.hideHeaderForSlideshow=this.config.hideHeaderForSlideshow},a}(),a.$inject=["CONFIG","$route","localStorageService","browserDetectionService","$window","appState"],angular.module("galleon-gc").service("productInitializer",a)}.call(this),function(){var a;a=function(){function a(a,b,c,d,e){this.config=a,this.$route=b,this.localStorageService=c,this.$window=d,this.appState=e,this.appState.defaultSurfaceNumber=2}return a.prototype.initProductSettings=function(a){},a.prototype.initPreview=function(a){return this.config.playButton=!0},a.$inject=["CONFIG","$route","localStorageService","$window","appState"],a}(),angular.module("galleon-ss").service("productInitializer",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.cover=a,this.book=b,this.deviceDetectionService=c}return a.prototype.getCoverTypes=function(){return this.coverTypesBySizeId={},this.deviceDetectionService.isDeviceATablet()?(this.coverTypesBySizeId[this.book.constructor.SIZE_8x8]=this.cover.constructor.COVER_TYPE_USER_CUSTOM,this.coverTypesBySizeId[this.book.constructor.SIZE_8x11]=this.cover.constructor.COVER_TYPE_USER_CUSTOM,this.coverTypesBySizeId[this.book.constructor.SIZE_10x10]=this.cover.constructor.COVER_TYPE_USER_CUSTOM,this.coverTypesBySizeId[this.book.constructor.SIZE_12x12]=this.cover.constructor.COVER_TYPE_USER_CUSTOM,this.coverTypesBySizeId[this.book.constructor.SIZE_11x14]=this.cover.constructor.COVER_TYPE_USER_CUSTOM):this.deviceDetectionService.isDeviceAPhone()?this.setHardCover?(this.coverTypesBySizeId[this.book.constructor.SIZE_8x8]=this.cover.constructor.COVER_TYPE_USER_CUSTOM_SOFT,this.coverTypesBySizeId[this.book.constructor.SIZE_10x10]=this.cover.constructor.COVER_TYPE_USER_CUSTOM_SOFT,this.setHardCover=!1):(this.coverTypesBySizeId[this.book.constructor.SIZE_8x8]=this.cover.constructor.COVER_TYPE_USER_CUSTOM,this.coverTypesBySizeId[this.book.constructor.SIZE_10x10]=this.cover.constructor.COVER_TYPE_USER_CUSTOM,this.coverTypesBySizeId[this.book.constructor.SIZE_12x12]=this.cover.constructor.COVER_TYPE_USER_CUSTOM,this.setHardCover=!0):(this.coverTypesBySizeId[this.book.constructor.SIZE_5x7]=this.cover.constructor.COVER_TYPE_USER_CUSTOM_SOFT,this.coverTypesBySizeId[this.book.constructor.SIZE_7x9]=this.cover.constructor.COVER_TYPE_USER_CUSTOM_SOFT,this.coverTypesBySizeId[this.book.constructor.SIZE_8x8]=this.cover.constructor.COVER_TYPE_USER_CUSTOM_SOFT,this.coverTypesBySizeId[this.book.constructor.SIZE_8x11]=this.cover.constructor.COVER_TYPE_USER_CUSTOM_SOFT,this.coverTypesBySizeId[this.book.constructor.SIZE_10x10]=this.cover.constructor.COVER_TYPE_USER_CUSTOM_SOFT,this.coverTypesBySizeId[this.book.constructor.SIZE_12x12]=this.cover.constructor.COVER_TYPE_USER_CUSTOM,this.coverTypesBySizeId[this.book.constructor.SIZE_11x14]=this.cover.constructor.COVER_TYPE_USER_CUSTOM),this.coverTypesBySizeId},a.prototype.getSizeOptions=function(){return this.sizeOptions=[{size:this.book.constructor.SIZE_7x9,asset:"size-icon-7x9",selectedAsset:"size-icon-7x9-selected",coverOption:"SilverApp.softCover",isOnSale:!1,origPrice:0,salePrice:0},{size:this.book.constructor.SIZE_8x8,asset:"size-icon-8x8",selectedAsset:"size-icon-8x8-selected",coverOption:"SilverApp.softOrHardCover",isOnSale:!1,origPrice:0,salePrice:0},{size:this.book.constructor.SIZE_8x11,asset:"size-icon-8x11",selectedAsset:"size-icon-8x11-selected",coverOption:"SilverApp.softOrHardCover",isOnSale:!1,origPrice:0,salePrice:0},{size:this.book.constructor.SIZE_10x10,asset:"size-icon-10x10",selectedAsset:"size-icon-10x10-selected",coverOption:"SilverApp.softOrHardCover",isOnSale:!1,origPrice:0,salePrice:0},{size:this.book.constructor.SIZE_12x12,asset:"size-icon-12x12",selectedAsset:"size-icon-12x12-selected",coverOption:"SilverApp.hardCoverOnly",isOnSale:!1,origPrice:0,salePrice:0},{size:this.book.constructor.SIZE_11x14,asset:"size-icon-11x14",selectedAsset:"size-icon-11x14-selected",coverOption:"SilverApp.hardCoverOnly",isOnSale:!1,origPrice:0,salePrice:0}],this.sizeOptions},a}(),a.$inject=["cover","book","deviceDetectionService"],angular.module("galleon-pb").service("sizeInitializer",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.cover=a,this.calendar=b}return a.prototype.getCoverTypes=function(){return this.coverTypesBySizeId={},this.coverTypesBySizeId[this.calendar.constructor.SIZE_8x11]=null,this.coverTypesBySizeId[this.calendar.constructor.SIZE_12x12]=null,this.coverTypesBySizeId},a.prototype.getSizeOptions=function(){return this.sizeOptions=[{size:this.calendar.constructor.SIZE_8x11,asset:"size-icon-8x11-calendar",selectedAsset:"size-icon-8x11-selected-calendar",coverOption:"SilverApp.hardCoverOnly",isOnSale:!1,origPrice:0,salePrice:0},{size:this.calendar.constructor.SIZE_12x12,asset:"size-icon-12x12-calendar",selectedAsset:"size-icon-12x12-selected-calendar",coverOption:"SilverApp.hardCoverOnly",isOnSale:!1,origPrice:0,salePrice:0}],this.sizeOptions},a}(),a.$inject=["cover","calendar"],angular.module("galleon-gc").service("sizeInitializer",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.cover=a,this.book=b}return a.prototype.getCoverTypes=function(){return this.coverTypesBySizeId={},this.coverTypesBySizeId[this.book.constructor.SIZE_8x11]=null,this.coverTypesBySizeId[this.book.constructor.SIZE_12x12]=null,this.coverTypesBySizeId},a.prototype.getSizeOptions=function(){return this.sizeOptions=[{size:this.book.constructor.SIZE_12x12,asset:"size-icon-10x10",selectedAsset:"size-icon-10x10-selected",coverOption:"SilverApp.softOrHardCover",isOnSale:!1,origPrice:0,salePrice:0},{size:this.book.constructor.SIZE_8x11,asset:"size-icon-8x11",selectedAsset:"size-icon-8x11-selected",coverOption:"SilverApp.softOrHardCover",isOnSale:!1,origPrice:0,salePrice:0}],this.sizeOptions},a}(),a.$inject=["cover","book"],angular.module("galleon-ss").service("sizeInitializer",a)}.call(this),function(){"use strict";var a;a={SELECT_EVENTS_TAB:"events.tab.open",LOAD_MY_EVENTS:"events.load.mine",CREATE_NEW_EVENT:"events.new",SELECT_EVENTS_TAB_FROM_PALETTE:"events.tab.from.palette"},angular.module("galleon-gc").value("productSpecificEvents",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g,h,i){this.$injector=a,this.$q=b,this.$http=c,this.config=e,this.projectEvents=f,this.dateUtil=g,this.imageCollection=h,this.eventBus=i,this.logger=d.newInstance("EventsService"),this.events=[],this.isLoggedIn=!1,this.publicEventsLoaded=!1}var b,c;return a.prototype.occasions=["anniversary","birthday","graduation","wedding","celebration","bar_mitzvah","vacation","other"],a.prototype.occurrences=["false","true"],a.prototype.relationships=["my_own","significant_other","child","mother","father","sibling","grandparent","aunt_uncle","friend","teacher","other"],a.prototype.months=[1,2,3,4,5,6,7,8,9,10,11,12].map(function(a){var b;return b=new Date,b.setDate(2),b.setMonth(a-1),{month:a,date:b}}),a.prototype.days=function(){for(c=[],b=1;b<=31;b++)c.push(b);return c}.apply(this),a.prototype.sort=function(){return this.events.sort(this._sortByDate)},a.prototype.getSelectedEventsOnSameDay=function(a,b){return null==b&&(b=!1),this._eventsFilteredBy(a,b,!0)},a.prototype.getEventsOnSameDay=function(a,b){return null==b&&(b=!1),this._eventsFilteredBy(a,b,!1)},a.prototype._eventsFilteredBy=function(a,b,c){return null==b&&(b=!1),this.events.filter(function(d){return d.id!==a.id&&d.month===a.month&&d.day===a.day&&(!c||d.isSelected)&&(!b||"custom"===d.visibility)})},a.prototype.loadPublicEvents=function(a,b,c){var d,e,f,g;return null==c&&(c=!0),d=this.$q.defer(),f=d.promise,g=""+this.config.eventsService+"/public",e=this.logger.asyncMetric("loadPublicEvents",g),null!=a&&null!=b&&(g+="?"+this._createStartEndDataQueryParameters(a,b)),this.publicEventsLoaded?(d.resolve(this.events),f):(this._requestEventData(d,g,e,function(a){return"Could not load public events: "+a},c),f.then(function(a){return function(){return a.publicEventsLoaded=!0}}(this)),f)},a.prototype._createStartEndDataQueryParameters=function(a,b){var c,d;return d=""+this._zeroPad(a.year,4)+"-"+this._zeroPad(a.month)+"-01",c=""+this._zeroPad(b.year,4)+"-"+this._zeroPad(b.month)+"-"+this._zeroPad(this.dateUtil.getDaysInMonth(b.year,b.month)),"startDate="+d+"&endDate="+c},a.prototype.loadMyEvents=function(a,b){var c,d;return c=this.$q.defer(),d=c.promise,this._requireAuthentication(c,function(e){return function(f){var g,h;return h=e._createAuthenticatedUrl(""+e.config.eventsService+"/user/"+f.id,f),g=e.logger.asyncMetric("loadMyEvents",h),null!=a&&null!=b&&(h+="&"+e._createStartEndDataQueryParameters(a,b)),e.config.migrateEvents&&(h+="&migrate=true"),e._requestEventData(c,h,g,function(a){return"Could not load personal events: "+a},!0),d.then(function(a){var b,c,d,f,g;if(e.config.migrateEvents){for(c=[],d=0,f=a.length;d<f;d++)b=a[d],(null!=(g=b.imageVes)?g.length:void 0)>0&&c.push(b);return 0!==c.length?e._migrateEvents(c):void 0}})}}(this)),d},a.prototype._createAuthenticatedUrl=function(a,b){return a+("?access_token="+b.oAuthToken)},a.prototype.loadProjectEvents=function(){var a,b,c,d,e,f,g,h;for(d=[],g=this.projectEvents.eventCollection.eventItems,e=0,f=g.length;e<f;e++)a=g[e],b=angular.copy(a),this._setDateProperties(b),c=this._getEventIndex(b.id),c>=0?this.events[c]=b:this.events.push(b),d.push(b);return this.events.sort(this._sortByDate),(null!=(h=this.projectEvents.eventCollection.imageAssociations)?h.length:void 0)>0&&this._setImageAssociationProjectImageIds(this.projectEvents.eventCollection.imageAssociations),d},a.prototype._setImageAssociationProjectImageIds=function(a){var b,c,d,e,f,g,h,i,j;for(d={},e=0,g=a.length;e<g;e++)b=a[e],d[b.imageMediaId]=b;for(i=this.imageCollection.projectImages,j=[],f=0,h=i.length;f<h;f++)c=i[f],d[c.sflyId]&&j.push(d[c.sflyId].projectImageId=c.productImageID);return j},a.prototype._sortByDate=function(a,b){var c;return c=b.year-a.year,0!==c?c:b.month-a.month},a.prototype._setDateProperties=function(a){var b,c;if(0===a.year&&(a.year=(new Date).getFullYear()),c=""+this._zeroPad(a.year,4)+"-"+this._zeroPad(a.month)+"-"+this._zeroPad(a.day),b=new Date(c),!isNaN(b.getTime()))return a.date=new Date(b.getTime()+60*b.getTimezoneOffset()*1e3),a.displayDate=function(){return new Date(this.year,this.month-1,this.day)},a.dateMillis=a.date.getTime()},a.prototype._getEventIndex=function(a){var b,c,d,e,f;for(c=0,f=this.events,d=0,e=f.length;d<e;d++){if(b=f[d],b.id===a)return c;c++}return-1},a.prototype.getEvent=function(a){var b;return(b=this._getEventIndex(a))>=0?this.events[b]:null},a.prototype.updateEvent=function(a,b){var c,d,e;return null==b&&(b=!0),e=function(a){return function(b,c){return a._removeEvent(b),a._restoreNonServiceProperties(c,b),a.addEvents([c])}}(this),d=this._cleanupEvent(a),d.id=a.id,c=this.$q.defer(),b?this._requireAuthentication(c,function(b){return function(f){var g,h,i;return i=b._createAuthenticatedUrl(""+b.config.eventsService+"/user/"+f.id,f),g=b.logger.asyncMetric("updateEvent",i),h=b.$http.put(i,d),h.success(function(b){return g.success(),e(a,b),c.resolve(b)}),h.error(function(f,h){return b._isNotFoundError(f,h)?(e(a,d),c.resolve(d)):(g.failure({status:h,response:f}),b.logger.critical("Could not update event: "+h+" "+f)),c.reject()})}}(this)):(e(a,d),c.resolve(d)),c.promise},a.prototype.addEvent=function(a,b){var c;return null==b&&(b=!0),c=this.$q.defer(),b?(a=this._cleanupEvent(a),this._requireAuthentication(c,function(b){return function(d){var e,f,g;return g=b._createAuthenticatedUrl(""+b.config.eventsService+"/user/"+d.id,d),e=b.logger.asyncMetric("addEvent",g),f=b.$http.post(g,a),f.success(function(a){return e.success(),b.addEvents([a]),c.resolve(a)}),f.error(function(a,d){return e.failure({status:d,response:a}),b.logger.critical("Could not create event: "+d+" "+a),c.reject()})}}(this))):(this.addEvents([a]),c.resolve(a)),c.promise},a.prototype.deleteEvent=function(a,b){var c;return null==b&&(b=!0),c=this.$q.defer(),b?this._requireAuthentication(c,function(b){return function(d){var e,f,g;return g=b._createAuthenticatedUrl(""+b.config.eventsService+"/user/"+d.id+"/"+a.id,d),e=b.logger.asyncMetric("deleteEvent",g),f=b.$http.delete(g),f.success(function(){return e.success(),b._removeEvent(a),c.resolve(b.events)}),f.error(function(d,f){return b._isNotFoundError(d,f)?(b._removeEvent(a),c.resolve(b.events)):(e.failure({status:f,response:d}),b.logger.critical("Could not delete event: "+f+" "+d),c.reject(d))})}}(this)):(this._removeEvent(a),c.resolve(a)),c.promise},a.prototype._isNotFoundError=function(a,b){return 400===b&&/not found/.test(a)},a.prototype._removeEvent=function(a){var b,c,d,e,f,g;for(d=-1,g=this.events,c=e=0,f=g.length;e<f;c=++e)if(b=g[c],b.id===a.id){d=c;break}if(d!==-1)return this.events.splice(d,1)},a.prototype._requireAuthentication=function(a,b){return this._getUserService().userInfo().then(function(c){return function(d){return c.isLoggedIn=d.isLoggedIn,c.isLoggedIn?b(d):a.reject()}}(this))},a.prototype._getUserService=function(){return null==this.userService&&(this.userService=this.$injector.get("userService")),this.userService},a.prototype._restoreNonServiceProperties=function(a,b){return a.isSelected=b.isSelected,a.imageMediaId=b.imageMediaId,a.imageView=b.imageView,a.projectImageId=b.projectImageId},a.prototype._cleanupEvent=function(a){var b;return{name:a.name,year:null!=(b=a.year)?b:(new Date).getFullYear(),month:a.month,day:a.day,recurring:""+a.recurring=="true",type:this.occasions.indexOf(a.type)===-1&&"holiday"!==a.type?"other":a.type,relationship:this.relationships.indexOf(a.relationship)===-1?"other":a.relationship,visibility:a.visibility,imageMediaId:a.imageMediaId,imageView:a.imageView,migrated:!!a.migrated||void 0}},a.prototype._requestEventData=function(a,b,c,d,e){var f;return f=this.$http.get(b),f.success(function(b){return function(d){return null!=c&&c.success(),e===!0?a.resolve(b.addEvents(d.events)):a.resolve(d.events)}}(this)),f.error(function(b){return function(e,f){var g;return null!=c&&c.failure({status:f,response:e}),g=d(f),b.logger.warn(g),a.reject(e)}}(this))},a.prototype.addEvents=function(a){var b,c,d,e,f;for(e=0,f=a.length;e<f;e++)b=a[e],this._setDateProperties(b),d=this._getEventIndex(b.id),d>=0?this.events[d]=b:this.events.push(b),b.imageMediaId&&(c=this.projectEvents.getImageAssociation(b.id),c?c.imageMediaId||this.projectEvents.updateImageAssociation(b.id,{imageMediaId:b.imageMediaId,imageView:b.imageView,projectImageId:b.projectImageId}):this.addEventImageAssociation(b));return this.events.sort(this._sortByDate),this.events},a.prototype.addEventImageAssociation=function(a){var b;return b={imageMediaId:a.imageMediaId,imageView:a.imageView},this.projectEvents.addImageAssociation(a.id,b)},a.prototype._zeroPad=function(a,b){var c;for(null==b&&(b=2),c=""+a;c.length<b;)c="0"+c;return c},a.prototype.isEventPublic=function(a){return"holiday"===a.type},a.prototype.getEventImageInfo=function(a,b){var c,d,e;return c=this.$q.defer(),(e=this._getEventImageInfoUrl(a,b))?(d=this.$http.get(e),d.success(function(a){return c.resolve(a)}),d.error(function(a,b){return c.reject(a)}),c.promise):(c.reject(null),c.promise)},a.prototype._getEventImageInfoUrl=function(a,b){var c,d,e;return a&&b?(e=b.id,d=a.imageMediaId,c=b.oAuthToken,""+this.config.secureApiServer+"/user-media/"+e+"/images/"+d+"?access_token="+c):null},a.prototype.syncSelectedPublicEvents=function(a){var b,c,d,e;for(e=this.events,c=0,d=e.length;c<d;c++)b=e[c],"public"===b.visibility&&a[b.name]===!0&&(b.isSelected=!0,this.updateEvent(b,!1));return this.sort(),this._setImageAssociationProjectImageIds(this.projectEvents.eventCollection.imageAssociations)},a.prototype.restoreEvents=function(a){var b,c,d,e,f;for(this.events=a,e=this.events,f=[],c=0,d=e.length;c<d;c++)b=e[c],f.push(this._setDateProperties(b));return f},a.prototype._migrateEvents=function(a){var b,c;if(a.length>0)return b=a.pop(),(c=this._parseImageMediaIdFromImageVes(b.imageVes))?(b.imageMediaId=c,b.migrated=!0,this.updateEvent(b).then(function(c){return function(){return c._updateModel(b),c._migrateEvents(a)}}(this),function(c){return function(){return c.logger.warn("Error migrating event: "+JSON.stringify(b)),c._updateModel(b),c._migrateEvents(a)}}(this))):(this.logger.warn("Failed to parse imageVes on migration of event: "+JSON.stringify(b)),this._migrateEvents(a))},a.prototype._updateModel=function(a){return this.projectEvents.updateEvent(a),this.eventBus.publish(this.eventBus.events.CALENDAR_EVENT_UPDATED,a)},a.prototype._parseImageMediaIdFromImageVes=function(a){var b,c,d;return d=/sid=\[-([0-9]+)\]/.exec(a),2!==(null!=d?d.length:void 0)||(c=d[1],b=parseInt(c),"number"!=typeof b||isNaN(b))?null:c},a}(),a.$inject="$injector $q $http loggerFactory CONFIG projectEvents dateUtil imageCollection eventBus".split(" "),angular.module("galleon").service("eventsService",a)}.call(this),function(){"use strict";var a;a={},angular.module("galleon").value("productSpecificEvents",a)}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f){this.$rootScope=a,this.eventBus=c,this.config=d,this.deviceDetectionService=e,this.appState=f,this.onProjectLoaded=b(this.onProjectLoaded,this),this._selectedPageNumber=null,this.selectedPage=null,this.selectedSplitPage=null,this.lastDirectionForward=null,this.previousLeftPage=null,this.previousRightPage=null,this.leftPage=null,this.rightPage=null,this.nextLeftPage=null,this.nextRightPage=null,this.showingSummary=!1,this.eventBus.subscribe(this.eventBus.events.PROJECT_LOADED,this.onProjectLoaded,a),this.lastDirectionForward=!0,this.spinePage=null}return a.prototype.onProjectLoaded=function(a,b){var c,d;return this.project=b,null!=(null!=(d=this.project)?d.product:void 0)&&(null!=this.appState.defaultSurfaceNumber?this.setSelectedPage(this.project.product.pageBySurfaceNumber(this.appState.defaultSurfaceNumber),!0):this.config.startWithFrontCover?this.selectCoverSpread(this.project.product.cover.frontPage,!0):null==this.selectedPage?this.setSelectedPage(this.project.product.pages[0],!0):null!=this._selectedPageNumber&&(c=this.project.product.pageBySurfaceNumber(this._selectedPageNumber),this._fetchSpreadsForPage(c))),this.$rootScope.$digest()},a.prototype.currentlyPhotoSpready=function(){var a;return null!=(a=this.leftPage)?a.isPhotoSpready():void 0},a.prototype.isFrontOrBackCover=function(){return this.rightPage===this.project.product.cover.frontPage||this.leftPage===this.project.product.cover.backPage},a.prototype.isFirstSpread=function(){return this.leftPage===this.project.product.firstPage()||this.rightPage===this.project.product.firstPage()},a.prototype.isLastPage=function(a){return null==a&&(a=null),null==a?this.selectedPage===this.project.product.lastPage():a.surfaceNumber===this.project.product.lastPage().surfaceNumber},a.prototype.isLastSpread=function(){return this.leftPage===this.project.product.lastPage()||this.rightPage===this.project.product.lastPage()},a.prototype.isLastMonth=function(){return this.selectedPage===this.project.product.lastPage()||this.selectedPage.surfaceNumber===this.project.product.pages.length-1},a.prototype.next=function(){return this.lastDirectionForward=!0,this.spinePage=null,this._fetchSpreadsForPage(this.nextLeftPage)},a.prototype.previous=function(){return this.lastDirectionForward=!1,this.spinePage=null,2===this.selectedPage.uid?this.gotoPage(25,!0):this._fetchSpreadsForPage(this.previousRightPage)},a.prototype.nextMonth=function(){return this.lastDirectionForward=!1,this.spinePage=null,24===this.selectedPage.uid?this.gotoPage(3,!0):0===this.selectedPage.uid?this._fetchSpreadsForPage(this.nextLeftPage):this._fetchSpreadsForPage(this.nextRightPage)},a.prototype.previousMonth=function(){return this.lastDirectionForward=!1,this.spinePage=null,3===this.selectedPage.uid&&this.gotoPage(24,!0),0===this.selectedPage.uid?this._fetchSpreadsForPage(this.previousRightPage):this._fetchSpreadsForPage(this.previousLeftPage)},a.prototype.gotoPage=function(a,b){var c,d;return null==b&&(b=!1),a>this.project.product.pages.length&&(a=this.project.product.pages.length),c=this.project.product.pageBySurfaceNumber(a),d=this.project.product.pageTypeBySurfaceNumber(a),"page"===d?this.setSelectedPage(c,!0,b):"cover"===d?this.selectCoverSpread(c,b):"spine"===d?this.selectCoverSpread(c,b):this.setSelectedPage(this.project.product.pages[0])},a.prototype.setSelectedPage=function(a,b,c){if(null==c&&(c=!1),a&&a.surfaceNumber&&(!this._isPageAlreadySelected(a)||b))return this._isPageOnActiveSpread(a)&&b!==!0?void this._selectPage(a):(this._selectedPageNumber=a.surfaceNumber,this.lastDirectionForward=null==this.selectedPage||a.surfaceNumber>=this.selectedPage.surfaceNumber,this.spinePage=null,this._fetchSpreadsForPage(a),c?this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED):void 0)},a.prototype.selectCoverSpread=function(a,b){if(null==b&&(b=!1),(b||!this._isPageAlreadySelected(a))&&a&&a.surfaceNumber&&(!this._isPageOnActiveSpread(a)||(this._selectPage(a),b)))return this.lastDirectionForward=!(a.surfaceNumber===a.constructor.FRONT_COVER_PAGE_NUMBER),this._fetchSpreadsForPage(a),b?this.eventBus.publish(this.eventBus.events.SURFACE_INVALIDATED):void 0},a.prototype._isPageOnActiveSpread=function(a){var b,c,d;return(null!=(b=this.leftPage)?b.surfaceNumber:void 0)===(null!=a?a.surfaceNumber:void 0)||(null!=(c=this.rightPage)?c.surfaceNumber:void 0)===(null!=a?a.surfaceNumber:void 0)||(null!=a?a.isCover():void 0)&&(null!=(d=this.leftPage)?d.isCover():void 0)},a.prototype._isPageAlreadySelected=function(a){var b;return(null!=a?a.surfaceNumber:void 0)===(null!=(b=this.selectedPage)?b.surfaceNumber:void 0)},a.prototype._fetchSpreadsForPage=function(a){var b,c,d,e,f,g;return d=a.surfaceNumber,f=a.surfaceNumber,b=a.surfaceNumber,this.config.superSimple&&this.deviceDetectionService.isDeviceATablet()&&!this.appState.inSlideshow&&(a.isCover()?(a=this.project.product.firstPage(),d=a.constructor.TITLE_PAGE_NUMBER+1,f=this.project.product.lastPage().surfaceNumber,b=a.constructor.TITLE_PAGE_NUMBER):a.surfaceNumber===this.project.product.lastPage().surfaceNumber?d=a.constructor.TITLE_PAGE_NUMBER:a.surfaceNumber===a.constructor.TITLE_PAGE_NUMBER&&(f=this.project.product.lastPage().surfaceNumber)),g=this.project.product.spreadBeforeSurfaceNumber(f),this._clearSpreadForSpine(g),c=this.project.product.spreadForSurfaceNumber(b),this._clearSpreadForSpine(c),e=this.project.product.spreadAfterSurfaceNumber(d),this._clearSpreadForSpine(e),this._setSpreads(g,c,e),this._selectPage(a)},a.prototype._clearSpreadForSpine=function(a){if(a.length>2)return this.spinePage=a[1],a.splice(1,1)},a.prototype._setSpreads=function(a,b,c){if(null!=a&&a.length>1&&null!=b&&b.length>1&&null!=c&&c.length>1)return this.previousLeftPage=a[0],this.previousRightPage=a[1],this.leftPage=b[0],this.rightPage=b[1],this.nextLeftPage=c[0],this.nextRightPage=c[1]},a.prototype._selectPage=function(a){var b;if(null!=a)return this.deviceDetectionService.isDeviceATablet()&&this.config.superSimple&&this.showingSummary?this.selectedPage=this.project.product.cover.frontPage:a.isFrontFiller()?this.selectedPage=this.project.product.pages[0]:a.isBackFiller()?this.selectedPage=this.project.product.lastPage():this.selectedPage=a,this.selectedSplitPage=this.selectedPage,this.selectedPage=(null!=(b=this.leftPage)?b.isSpread():void 0)?this.leftPage:this.selectedPage,this.eventBus.publish(this.eventBus.events.SURFACE_SELECTED,this.selectedPage)},a}(),a.$inject=["$rootScope","eventBus","CONFIG","deviceDetectionService","appState"],angular.module("silverApp").service("navService",a)}.call(this),function(){!function(a,b){var c,d;return d=b.document,c=function(){function c(c){var d;try{d=b.localStorage}catch(a){d=!1}this._options=a.extend({name:"tour",steps:[],container:"body",keyboard:!0,storage:d,debug:!1,backdrop:!1,border:!1,redirect:!0,orphan:!1,noarrow:!1,duration:!1,nostart:!1,basePath:"",template:"<div class='popover'> <div class='arrow'></div> <h3 class='popover-title'></h3> <div class='popover-content'></div> <div class='popover-navigation'> <div class='btn-group'> <button class='btn btn-sm btn-default' data-role='prev'>&laquo; Prev</button> <button class='btn btn-sm btn-default' data-role='next'>Next &raquo;</button> <button class='btn btn-sm btn-default' data-role='pause-resume' data-pause-text='Pause' data-resume-text='Resume'>Pause</button> </div> <button class='btn btn-sm btn-default' data-role='end'>End tour</button> </div> </div>",afterSetState:function(a,b){},
afterGetState:function(a,b){},afterRemoveState:function(a){},onStart:function(a){},onEnd:function(a){},onShow:function(a){},onShown:function(a){},onHide:function(a){},onHidden:function(a){},onNext:function(a){},onPrev:function(a){},onPause:function(a,b){},onResume:function(a,b){}},c),this._force=!1,this._inited=!1,this.backdrop={overlay:null,$element:null,$element2:null,$background:null,backgroundShown:!1,overlayElementShown:!1,border:!0}}return c.prototype.addSteps=function(a){var b,c,d;for(c=0,d=a.length;c<d;c++)b=a[c],this.addStep(b);return this},c.prototype.addStep=function(a){return this._options.steps.push(a),this},c.prototype.getStep=function(b){if(null!=this._options.steps[b])return a.extend({id:"step-"+b,path:"",placement:"right",title:"",content:"<p></p>",next:b===this._options.steps.length-1?-1:b+1,prev:b-1,animation:!0,container:this._options.container,backdrop:this._options.backdrop,border:this._options.border,redirect:this._options.redirect,orphan:this._options.orphan,noarrow:this._options.noarrow,duration:this._options.duration,template:this._options.template,onShow:this._options.onShow,onShown:this._options.onShown,onHide:this._options.onHide,onHidden:this._options.onHidden,onNext:this._options.onNext,onPrev:this._options.onPrev,onPause:this._options.onPause,onResume:this._options.onResume},this._options.steps[b])},c.prototype.init=function(a){return this._force=a,this.ended()?(this._debug("Tour ended, init prevented."),this):(this.setCurrentStep(),this._initMouseNavigation(),this._initKeyboardNavigation(),this._onResize(function(a){return function(){return a.showStep(a._current)}}(this)),null!==this._current&&this.showStep(this._current),this._inited=!0,this)},c.prototype.start=function(a){var b;return null==a&&(a=!1),this._inited||this.init(a),null===this._current&&(b=this._makePromise(null!=this._options.onStart?this._options.onStart(this):void 0),this._callOnPromiseDone(b,this.showStep,0)),this},c.prototype.next=function(){var a;return a=this.hideStep(this._current),this._callOnPromiseDone(a,this._showNextStep)},c.prototype.prev=function(){var a;return a=this.hideStep(this._current),this._callOnPromiseDone(a,this._showPrevStep)},c.prototype.goTo=function(a){var b;return b=this.hideStep(this._current),this._callOnPromiseDone(b,this.showStep,a)},c.prototype.end=function(){var c,e;return c=function(c){return function(e){if(a(d).off("click.tour-"+c._options.name),a(d).off("keyup.tour-"+c._options.name),a(b).off("resize.tour-"+c._options.name),c._setState("end","yes"),c._inited=!1,c._force=!1,c._clearTimer(),null!=c._options.onEnd)return c._options.onEnd(c)}}(this),e=this.hideStep(this._current),this._callOnPromiseDone(e,c)},c.prototype.ended=function(){return!this._force&&!!this._getState("end")},c.prototype.restart=function(){return this._removeState("current_step"),this._removeState("end"),this.start()},c.prototype.pause=function(){var a;return a=this.getStep(this._current),a&&a.duration?(this._paused=!0,this._duration-=(new Date).getTime()-this._start,b.clearTimeout(this._timer),this._debug("Paused/Stopped step "+(this._current+1)+" timer ("+this._duration+" remaining)."),null!=a.onPause?a.onPause(this,this._duration):void 0):this},c.prototype.resume=function(){var a;return a=this.getStep(this._current),a&&a.duration?(this._paused=!1,this._start=(new Date).getTime(),this._duration=this._duration||a.duration,this._timer=b.setTimeout(function(a){return function(){return a._isLast()?a.next():a.end()}}(this),this._duration),this._debug("Started step "+(this._current+1)+" timer with duration "+this._duration),null!=a.onResume&&this._duration!==a.duration?a.onResume(this,this._duration):void 0):this},c.prototype.hideStep=function(b){var c,d,e;if(e=this.getStep(b))return this._clearTimer(),d=this._makePromise(null!=e.onHide?e.onHide(this,b):void 0),c=function(c){return function(d){var f;if(f=a(e.element),f.data("bs.popover")||f.data("popover")||(f=a("body")),f.popover("destroy").removeClass("tour-"+c._options.name+"-element tour-"+c._options.name+"-"+b+"-element"),e.reflex&&f.css("cursor","").off("click.tour-"+c._options.name),e.backdrop&&c._hideBackdrop(),null!=e.onHidden)return e.onHidden(c)}}(this),this._callOnPromiseDone(d,c),d},c.prototype.showStep=function(a){var b,c,e,f;return this.ended()?(this._debug("Tour ended, showStep prevented."),this):(f=this.getStep(a))?(e=a<this._current,b=this._makePromise(null!=f.onShow?f.onShow(this,a):void 0),c=function(b){return function(c){var g,h;if(b.setCurrentStep(a),h=function(){switch({}.toString.call(f.path)){case"[object Function]":return f.path();case"[object String]":return this._options.basePath+f.path;default:return f.path}}.call(b),g=[d.location.pathname,d.location.hash].join(""),b._isRedirect(h,g))return void b._redirect(f,h);if(b._isOrphan(f)){if(!f.orphan)return b._debug("Skip the orphan step "+(b._current+1)+". Orphan option is false and the element doesn't exist"),void(e?b._showPrevStep():b._showNextStep());b._debug("Show the orphan step "+(b._current+1)+". Orphans option is true.")}return f.backdrop&&b._showBackdrop(b._isOrphan(f)?void 0:f.element),b._scrollIntoView(f.element,function(){if(b.getCurrentStep()===a)return null!=f.element&&f.backdrop&&b._showOverlayElement(f.element,f.element2,f.border),b._showPopover(f,a),null!=f.onShown&&f.onShown(b),b._debug("Step "+(b._current+1)+" of "+b._options.steps.length)}),f.duration?b.resume():void 0}}(this),this._callOnPromiseDone(b,c),b):void 0},c.prototype.getCurrentStep=function(){return this._current},c.prototype.setCurrentStep=function(a){return null!=a?(this._current=a,this._setState("current_step",a)):(this._current=this._getState("current_step"),this._current=null===this._current?null:parseInt(this._current,10)),this},c.prototype._setState=function(a,b){var c,d;if(this._options.storage){d=""+this._options.name+"_"+a;try{this._options.storage.setItem(d,b)}catch(a){c=a,c.code===DOMException.QUOTA_EXCEEDED_ERR&&this.debug("LocalStorage quota exceeded. State storage failed.")}return this._options.afterSetState(d,b)}return null==this._state&&(this._state={}),this._state[a]=b},c.prototype._removeState=function(a){var b;return this._options.storage?(b=""+this._options.name+"_"+a,this._options.storage.removeItem(b),this._options.afterRemoveState(b)):null!=this._state?delete this._state[a]:void 0},c.prototype._getState=function(a){var b,c;return this._options.storage?(b=""+this._options.name+"_"+a,c=this._options.storage.getItem(b)):null!=this._state&&(c=this._state[a]),void 0!==c&&"null"!==c||(c=null),this._options.afterGetState(a,c),c},c.prototype._showNextStep=function(){var a,b,c;return c=this.getStep(this._current),b=function(a){return function(b){return a.showStep(c.next)}}(this),a=this._makePromise(null!=c.onNext?c.onNext(this):void 0),this._callOnPromiseDone(a,b)},c.prototype._showPrevStep=function(){var a,b,c;return c=this.getStep(this._current),b=function(a){return function(b){return a.showStep(c.prev)}}(this),a=this._makePromise(null!=c.onPrev?c.onPrev(this):void 0),this._callOnPromiseDone(a,b)},c.prototype._debug=function(a){if(this._options.debug)return b.console.log("Bootstrap Tour '"+this._options.name+"' | "+a)},c.prototype._isRedirect=function(a,b){return null!=a&&""!==a&&("[object RegExp]"==={}.toString.call(a)&&!a.test(b)||"[object String]"==={}.toString.call(a)&&a.replace(/\?.*$/,"").replace(/\/?$/,"")!==b.replace(/\/?$/,""))},c.prototype._redirect=function(b,c){return a.isFunction(b.redirect)?b.redirect.call(this,c):b.redirect===!0?(this._debug("Redirect to "+c),d.location.href=c):void 0},c.prototype._isOrphan=function(b){return null==b.element||!a(b.element).length||a(b.element).is(":hidden")&&"http://www.w3.org/2000/svg"!==a(b.element)[0].namespaceURI},c.prototype._isLast=function(){return this._current<this._options.steps.length-1},c.prototype._showPopover=function(b,c){var d,e,f,g,h,i;if(a(".tour-"+this._options.name).remove(),i=a.extend({},this._options),f=a(a.isFunction(b.template)?b.template(c,b):b.template),e=f.find(".popover-navigation"),h=this._isOrphan(b),h&&(b.element="body",b.placement="top",f=f.addClass("orphan")),b.noarrow&&(f=f.addClass("orphan")),d=a(b.element),f.addClass("tour-"+this._options.name+" tour-"+this._options.name+"-"+c),d.addClass("tour-"+this._options.name+"-element tour-"+this._options.name+"-"+c+"-element"),b.options&&a.extend(i,b.options),b.reflex&&!h&&d.css("cursor","pointer").on("click.tour-"+this._options.name,function(a){return function(){return a._isLast()?a.next():a.end()}}(this)),b.prev<0&&e.find("[data-role='prev']").addClass("disabled"),b.prev<0&&e.find("[data-role='prev']").addClass("hidden"),b.prev<0&&e.find("[data-role='end']").addClass("disabled"),b.prev<0&&!b.nostart&&e.find("[data-role='next']").text("Start"),b.next<0&&e.find("[data-role='next']").text("End"),b.next<0&&e.find("[data-role='end']").addClass("hidden"),b.duration||e.find("[data-role='pause-resume']").remove(),b.template=f.clone().wrap("<div>").parent().html(),d.popover({placement:b.placement,trigger:"manual",title:b.title,content:b.content,html:!0,animation:b.animation,container:b.container,template:b.template,selector:b.element}).popover("show"),g=d.data("bs.popover")?d.data("bs.popover").tip():d.data("popover").tip(),g.attr("id",b.id),this._reposition(g,b),h)return this._center(g)},c.prototype._reposition=function(b,c){var e,f,g,h,i,j,k;if(h=b[0].offsetWidth,f=b[0].offsetHeight,k=b.offset(),i=k.left,j=k.top,e=a(d).outerHeight()-k.top-b.outerHeight(),e<0&&(k.top=k.top+e),g=a("html").outerWidth()-k.left-b.outerWidth(),g<0&&(k.left=k.left+g),k.top<0&&(k.top=0),k.left<0&&(k.left=0),b.offset(k),"bottom"===c.placement||"top"===c.placement){if(i!==k.left)return this._replaceArrow(b,2*(k.left-i),h,"left")}else if(j!==k.top)return this._replaceArrow(b,2*(k.top-j),f,"top")},c.prototype._center=function(a){return a.css("top",150)},c.prototype._replaceArrow=function(a,b,c,d){return a.find(".arrow").css(d,b?50*(1-b/c)+"%":"")},c.prototype._scrollIntoView=function(c,d){var e,f,g,h,i,j;return e=a(c),e.length?(f=a(b),h=e.offset().top,j=f.height(),i=Math.max(0,h-j/2),this._debug("Scroll view. ScrollTop: "+i+". Element offset: "+h+". Window height: "+j+"."),g=0,a("body,html").stop(!0,!0).animate({scrollTop:Math.ceil(i)},function(a){return function(){if(2===++g)return d(),a._debug("Scroll, Animation end ele offset: "+e.offset().top+". Window height: "+f.height()+".")}}(this))):d()},c.prototype._onResize=function(c,d){return a(b).on("resize.tour-"+this._options.name,function(){return clearTimeout(d),d=setTimeout(c,100)})},c.prototype._initMouseNavigation=function(){var b;return b=this,a(d).off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='prev']:not(.disabled)").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='next']:not(.disabled)").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='end']").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='pause-resume']").on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='next']:not(.disabled)",function(a){return function(b){return b.preventDefault(),a._isLast()?a.next():a.end()}}(this)).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='prev']:not(.disabled)",function(a){return function(b){return b.preventDefault(),a.prev()}}(this)).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='end']",function(a){return function(b){return b.preventDefault(),a.end()}}(this)).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='pause-resume']",function(c){var d;return c.preventDefault(),d=a(this),d.text(b._paused?d.data("pause-text"):d.data("resume-text")),b._paused?b.resume():b.pause()})},c.prototype._initKeyboardNavigation=function(){if(this._options.keyboard)return a(d).on("keyup.tour-"+this._options.name,function(a){return function(b){if(b.which)switch(b.which){case 39:return b.preventDefault(),a._isLast()?a.next():a.end();case 37:if(b.preventDefault(),a._current>0)return a.prev();break;case 27:return b.preventDefault(),a.end()}}}(this))},c.prototype._makePromise=function(b){return b&&a.isFunction(b.then)?b:null},c.prototype._callOnPromiseDone=function(a,b,c){return a?a.then(function(a){return function(d){return b.call(a,c)}}(this)):b.call(this,c)},c.prototype._showBackdrop=function(b){if(!this.backdrop.backgroundShown)return this.backdrop=a("<div/>",{class:"tour-backdrop"}),this.backdrop.backgroundShown=!0,a("body").append(this.backdrop)},c.prototype._hideBackdrop=function(){return this._hideOverlayElement(),this._hideBackground()},c.prototype._hideBackground=function(){if(this.backdrop)return this.backdrop.remove(),this.backdrop.overlay=null,this.backdrop.backgroundShown=!1},c.prototype._showOverlayElement=function(b,c,d){var e,f,g,h;if(f=a(b),g=a(c),f&&0!==f.length&&!this.backdrop.overlayElementShown)return this.backdrop.overlayElementShown=!0,e=a("<div/>"),h=f.offset(),h.top=h.top,h.left=h.left,e.width(f.innerWidth()).height(f.innerHeight()).addClass("tour-step-background").offset(h),f.addClass("tourable-item--active"),g.addClass("tourable-item--active"),d===!0?(f.addClass("tour-step-border"),this.backdrop.border=!0):(f.addClass("tour-step-backdrop"),g.addClass("tour-step-backdrop")),a("body").append(e),this.backdrop.$element=f,this.backdrop.$element2=g,this.backdrop.$background=e},c.prototype._hideOverlayElement=function(){if(this.backdrop.overlayElementShown)return this.backdrop.$element.removeClass("tourable-item--active"),this.backdrop.$element2.removeClass("tourable-item--active"),this.backdrop.border===!0?this.backdrop.$element.removeClass("tour-step-border"):(this.backdrop.$element.removeClass("tour-step-backdrop"),this.backdrop.$element2.removeClass("tour-step-backdrop")),this.backdrop.$background.remove(),this.backdrop.$element=null,this.backdrop.$element2=null,this.backdrop.$background=null,this.backdrop.overlayElementShown=!1},c.prototype._clearTimer=function(){return b.clearTimeout(this._timer),this._timer=null,this._duration=null},c}(),b.MyTour=c}(jQuery,window)}.call(this),function(){var a;a=function(){function a(a,b){var c,d,e,f;this.config=a,this.enums=b,d={},d[this.enums.CoverColors.BLACK]=this.STOCK_LEATHER_BLACK,d[this.enums.CoverColors.CHOCOLATE]=this.STOCK_LEATHER_CHOCOLATE,c={},c[this.enums.CoverColors.BLACK]=this.STOCK_CLOTH_BLACK,c[this.enums.CoverColors.CAMEL]=this.STOCK_CLOTH_CAMEL,e={},e[this.enums.CoverColors.WHITE]=this.STOCK_LINEN_WHITE,f={},f[this.enums.CoverColors.IVORY]=this.PREMIUM_SILK_IVORY,this.stockOptionsByColor={leather:d,cloth:c,linen:e,silk:f},this.availableCoverCategories=[{type:"standard",description:"SilverApp.booktab.categories.standard"},{type:"upgraded",description:"SilverApp.booktab.categories.upgraded"},{type:"premium",description:"SilverApp.booktab.categories.premium"}]}return a.prototype.getAvailableCoverCategories=function(){return this.availableCoverCategories},a.prototype.getAvailableOptions=function(){var a;return a=[this.HARD_MATTE,this.HARD,this.SOFT],this._isTruthy(this.config.features.dustJacket)&&this._addDustJackets(a),this._isTruthy(this.config.features.stockCovers)&&this._addStockCovers(a),this._isTruthy(this.config.features.premiumCovers)&&this._addPremiumCovers(a),a},a.prototype._isTruthy=function(a){return a===!0||"true"===a},a.prototype._addDustJackets=function(a){return a.splice(1,0,this.HARD_MATTE_DUSTJACKET),a.splice(3,0,this.HARD_DUSTJACKET)},a.prototype._addStockCovers=function(a){return a.splice(0,0,this.STOCK_LINEN_WHITE,this.STOCK_LEATHER_BLACK,this.STOCK_LEATHER_CHOCOLATE,this.STOCK_CLOTH_BLACK,this.STOCK_CLOTH_CAMEL)},a.prototype._addPremiumCovers=function(a){return a.splice(0,0,this.PREMIUM_LEATHER,this.PREMIUM_SILK_IVORY)},a.prototype.getSelectedOption=function(a){var b;switch(b=a.cover.getCoverType()){case this.enums.CoverType.USER_CUSTOM:return this._getHardCoverVariant(a);case this.enums.CoverType.USER_CUSTOM_SOFT:return this._getSoftCoverVariant(a);case this.enums.CoverType.STOCK_PREMIUM:return this.PREMIUM_LEATHER.pageOptions.layflat;case this.enums.CoverType.STOCK_SILK:return this._getStockVariant(a,this.stockOptionsByColor.silk);case this.enums.CoverType.STOCK_LINEN:return this._getStockVariant(a,this.stockOptionsByColor.linen);case this.enums.CoverType.STOCK_CLOTH:return this._getStockVariant(a,this.stockOptionsByColor.cloth);case this.enums.CoverType.STOCK_LEATHER:return this._getStockVariant(a,this.stockOptionsByColor.leather)}},a.prototype._getSoftCoverVariant=function(a){return this._getPageVariant(this.SOFT,a)},a.prototype._getHardCoverVariant=function(a){var b;switch(b=null,!1){case!a.hasMatteFinish():b=a.hasDustJacket()?this.HARD_MATTE_DUSTJACKET:this.HARD_MATTE;break;case!a.hasPaddedFinish():b=this.HARD_PADDED;break;default:b=a.hasDustJacket()?this.HARD_DUSTJACKET:this.HARD}return this._getPageVariant(b,a)},a.prototype._getStockVariant=function(a,b){var c,d;return c=this._getStockColor(a),d=b[c],this._getPageVariant(d,a)},a.prototype._getStockColor=function(a){var b,c;return b=/_([^_]+)$/,c=b.exec(a.cover.stockCoverSpecID),null!=c?c[1]:void 0},a.prototype._getPageVariant=function(a,b){if(null!=a)return b.cover.hasLayflatBinding()?a.pageOptions.layflat:b.cover.hasHingedLayflatBinding()?a.pageOptions.hinged:b.hasGlossyPages()?a.pageOptions.glossy:a.pageOptions.standard},a.prototype.SOFT={description:"SilverApp.booktab.soft",coverType:"USER_CUSTOM_SOFT",category:"standard",categoryIndex:1,isBestSeller:!1,finish:"none",dustJacket:!1,omnitureLinkSuffix:"Soft",omnitureProductName:"Softcover",testKeyPrefix:"btn-soft",pageOptions:{standard:{asset:"soft-asset",text:"SilverApp.booktab.soft.standard.text"}}},a.prototype.HARD={description:"SilverApp.booktab.hard",coverType:"USER_CUSTOM",category:"standard",categoryIndex:2,isBestSeller:!1,finish:"none",dustJacket:!1,omnitureLinkSuffix:"Hard",omnitureProductName:"Hardcover",testKeyPrefix:"btn-hard",pageOptions:{hinged:{asset:"hard-hinged-layflat-asset",text:"SilverApp.booktab.hard.hinged.layflat.text"},layflat:{asset:"hard-layflat-asset",text:"SilverApp.booktab.hard.layflat.text"},glossy:{asset:"hard-glossy-asset",text:"SilverApp.booktab.hard.glossy.text"},standard:{asset:"hard-asset",text:"SilverApp.booktab.hard.standard.text"}}},a.prototype.HARD_DUSTJACKET={description:"SilverApp.booktab.hardJacket",coverType:"USER_CUSTOM",category:"upgraded",categoryIndex:2,isBestSeller:!1,finish:"none",dustJacket:!0,omnitureLinkSuffix:"Hard",omnitureProductName:"Dustjacket",testKeyPrefix:"btn-hardJacket",pageOptions:{hinged:{asset:"hard-dustjacket-hinged-layflat-asset",text:"SilverApp.booktab.hardJacket.hinged.layflat.text"},layflat:{asset:"hard-dustjacket-layflat-asset",text:"SilverApp.booktab.hardJacket.layflat.text"},glossy:{asset:"hard-dustjacket-glossy-asset",text:"SilverApp.booktab.hardJacket.glossy.text"},standard:{asset:"hard-dustjacket-asset",text:"SilverApp.booktab.hardJacket.standard.text"}}},a.prototype.HARD_MATTE={description:"SilverApp.booktab.hardMatte",coverType:"USER_CUSTOM",category:"upgraded",categoryIndex:1,isBestSeller:!0,finish:"matte",dustJacket:!1,omnitureLinkSuffix:"HardMatte",omnitureProductName:"HardMatte",testKeyPrefix:"btn-hardMatte",pageOptions:{hinged:{asset:"hard-matte-hinged-layflat-asset",text:"SilverApp.booktab.hardMatte.hinged.layflat.text"},layflat:{asset:"hard-matte-layflat-asset",text:"SilverApp.booktab.hardMatte.layflat.text"},glossy:{asset:"hard-matte-glossy-asset",text:"SilverApp.booktab.hardMatte.glossy.text"},standard:{asset:"hard-matte-asset",text:"SilverApp.booktab.hardMatte.standard.text"}}},a.prototype.HARD_MATTE_DUSTJACKET={description:"SilverApp.booktab.hardMatteJacket",coverType:"USER_CUSTOM",category:"upgraded",categoryIndex:3,isBestSeller:!1,finish:"matte",dustJacket:!0,omnitureLinkSuffix:"HardMatte",omnitureProductName:"DustjacketMatte",testKeyPrefix:"btn-hardMatteJacket",pageOptions:{hinged:{asset:"hard-matte-dustjacket-hinged-layflat-asset",text:"SilverApp.booktab.hardMatteJacket.hinged.layflat.text"},layflat:{asset:"hard-matte-dustjacket-layflat-asset",text:"SilverApp.booktab.hardMatteJacket.layflat.text"},glossy:{asset:"hard-matte-dustjacket-glossy-asset",text:"SilverApp.booktab.hardMatteJacket.glossy.text"},standard:{asset:"hard-matte-dustjacket-asset",text:"SilverApp.booktab.hardMatteJacket.standard.text"}}},a.prototype.HARD_PADDED={description:"SilverApp.booktab.hardPadded",coverType:"USER_CUSTOM",category:"upgraded",categoryIndex:4,isBestSeller:!1,finish:"padded",dustJacket:!1,omnitureLinkSuffix:"HardPadded",omnitureProductName:"HardPadded",testKeyPrefix:"btn-padded",pageOptions:{layflat:{asset:"hard-padded-layflat-asset",text:"SilverApp.booktab.hardPadded.layflat.text"},glossy:{asset:"hard-padded-glossy-asset",text:"SilverApp.booktab.hardPadded.glossy.text"},standard:{asset:"hard-padded-asset",text:"SilverApp.booktab.hardPadded.standard.text"}}},a.prototype.STOCK_LINEN_WHITE={description:"SilverApp.booktab.stockLinen.white",coverType:"STOCK_LINEN",category:"upgraded",categoryIndex:9,isBestSeller:!1,colorId:"id_white",finish:"none",dustJacket:!1,omnitureLinkSuffix:"",omnitureProductName:"WhiteLinen",testKeyPrefix:"btn-stockLinen-white",pageOptions:{glossy:{asset:"linen-white-glossy-asset",text:"SilverApp.booktab.stockLinen.white.glossy.text"},standard:{asset:"linen-white-asset",text:"SilverApp.booktab.stockLinen.white.standard.text"}}},a.prototype.STOCK_CLOTH_BLACK={description:"SilverApp.booktab.stockCloth.black",coverType:"STOCK_CLOTH",category:"upgraded",categoryIndex:5,isBestSeller:!1,colorId:"id_black",finish:"none",dustJacket:!1,omnitureLinkSuffix:"",omnitureProductName:"BlackCloth",testKeyPrefix:"btn-stockCloth-black",pageOptions:{glossy:{asset:"cloth-black-glossy-asset",text:"SilverApp.booktab.stockCloth.black.glossy.text"},standard:{asset:"cloth-black-asset",text:"SilverApp.booktab.stockCloth.black.standard.text"}}},a.prototype.STOCK_CLOTH_CAMEL={description:"SilverApp.booktab.stockCloth.camel",coverType:"STOCK_CLOTH",category:"upgraded",categoryIndex:6,isBestSeller:!1,colorId:"id_camel",finish:"none",dustJacket:!1,omnitureLinkSuffix:"",omnitureProductName:"CamelCloth",testKeyPrefix:"btn-stockCloth-camel",pageOptions:{glossy:{asset:"cloth-camel-glossy-asset",text:"SilverApp.booktab.stockCloth.camel.glossy.text"},standard:{asset:"cloth-camel-asset",text:"SilverApp.booktab.stockCloth.camel.standard.text"}}},a.prototype.STOCK_LEATHER_BLACK={description:"SilverApp.booktab.stockLeather.black",coverType:"STOCK_LEATHER",category:"upgraded",categoryIndex:7,isBestSeller:!1,colorId:"id_black",finish:"none",dustJacket:!1,omnitureLinkSuffix:"",omnitureProductName:"BlackLeather",testKeyPrefix:"btn-stockLeather-black",pageOptions:{glossy:{asset:"leather-black-glossy-asset",text:"SilverApp.booktab.stockLeather.black.glossy.text"},standard:{asset:"leather-black-asset",text:"SilverApp.booktab.stockLeather.black.standard.text"}}},a.prototype.STOCK_LEATHER_CHOCOLATE={description:"SilverApp.booktab.stockLeather.chocolate",coverType:"STOCK_LEATHER",category:"upgraded",categoryIndex:8,isBestSeller:!1,colorId:"id_chocolate",finish:"none",dustJacket:!1,omnitureLinkSuffix:"",omnitureProductName:"ChocolateLeather",testKeyPrefix:"btn-stockLeather-chocolate",pageOptions:{glossy:{asset:"leather-chocolate-glossy-asset",text:"SilverApp.booktab.stockLeather.chocolate.glossy.text"},standard:{asset:"leather-chocolate-asset",text:"SilverApp.booktab.stockLeather.chocolate.standard.text"}}},a.prototype.PREMIUM_LEATHER={description:"SilverApp.booktab.premiumLeather.black",coverType:"STOCK_PREMIUM",category:"premium",categoryIndex:2,isBestSeller:!1,binding:"layflat",finish:"none",dustJacket:!1,omnitureLinkSuffix:"",omnitureProductName:"PremiumLeather",testKeyPrefix:"btn-premiumLeather",pageOptions:{layflat:{asset:"premium-leather-asset",text:"SilverApp.booktab.premiumLeather.black.layflat.text"}}},a.prototype.PREMIUM_SILK_IVORY={description:"SilverApp.booktab.premiumSilk.ivory",coverType:"STOCK_SILK",category:"premium",categoryIndex:1,isBestSeller:!1,binding:"layflat",colorId:"id_ivory",finish:"none",dustJacket:!1,omnitureLinkSuffix:"",omnitureProductName:"PremiumSilk",testKeyPrefix:"btn-premiumSilk-ivory",pageOptions:{layflat:{asset:"silk-ivory-asset",text:"SilverApp.booktab.premiumSilk.ivory.layflat.text"}}},a}(),a.$inject=["CONFIG","enums"],angular.module("silverApp").service("bookOptionsService",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e){this.projectService=a,this.config=b,this.$http=c,this.$q=d,this.logger=e.newInstance("AnonymousImageService")}return a.prototype.hasAnonymousImages=function(){var a,b;return null!=(a=this.projectService.currentProject.imageCollection)&&null!=(b=a.projectImages)?b.some(function(a){return a.isAnonymous}):void 0},a.prototype.getAnonymousIds=function(){var a,b,c,d,e;for(a=[],e=this.projectService.currentProject.imageCollection.projectImages,c=0,d=e.length;c<d;c++)b=e[c],b.isAnonymous&&a.push(b.imageId);return a.join("&iIds=")},a.prototype.getImageURL=function(a){return this.config.convertImagesService+"?userId="+a+"&iIds="+this.getAnonymousIds()},a.prototype.getSflyImageUrls=function(a){var b,c,d,e;return b=this.$q.defer(),(null!=(e=this.projectService.currentProject)?e.imageCollection.currentUploadInProgress:void 0)>0?b.resolve():(c=this.logger.asyncMetric("getSflyImageUrls"),d=this.getImageURL(a),this.$http({method:"POST",headers:{"Content-Type":"application/json"},url:d}).success(function(a){return function(d,e,f,g){var h,i;c.success(),null!=(h=a.projectService.currentProject)&&null!=(i=h.imageCollection)&&i.updateAnonymousImages(d.convertedImages),a.projectService.validate({event:"AnonymousImageService called updateAnonymousImages"}),b.resolve(d)}}(this)).error(function(a,d,e,f){return c.failure({status:d,response:a}),b.reject(new Error("Could not convert anonymous images"))})),b.promise},a}(),a.$inject=["projectService","CONFIG","$http","$q","loggerFactory"],angular.module("silverApp").service("anonymousImageService",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f){this.$http=a,this.config=b,this.$q=d,this.loggerFactory=e,this.uppImageFactory=f,this.x2js=new c.X2JS,this.logger=e.newInstance("bookInitService")}var b;return b={0:0,1:90,2:180,3:270},a.prototype.request=function(a,b){var c,d;return null==b&&(b=""),c=this.$q.defer(),d=""+this.config.bookInitService+"?command="+a+"&bookInitID="+b,this.$http({method:"GET",withCredentials:!0,url:d}).success(function(a){return function(b,d,e,f){return c.resolve(a._parseResponse(b))}}(this)).error(function(a){return function(b,d,e,f){return a.logger.warn("Could not load book init"+d),c.reject("Could not load book init")}}(this)),c.promise},a.prototype._parseResponse=function(a){var b,c;return b={},b.images=[],c=this.x2js.xml_str2json(a),null!=c.initBookResponse.initBook.images.image&&(b.images=this._parseImages(c.initBookResponse.initBook.images.image)),b},a.prototype._parseImages=function(a){var b,c,d,e;if(Array.isArray(a)){for(e=[],c=0,d=a.length;c<d;c++)b=a[c],e.push(this.uppImageFactory.instanceFromBookInitImage(b.sflyImage));return e}return[this.uppImageFactory.instanceFromBookInitImage(a.sflyImage)]},a}(),a.$inject=["$http","CONFIG","$window","$q","loggerFactory","uppImageFactory"],angular.module("silverApp").service("bookInitService",a)}.call(this),function(){var a;a=function(){function a(a,b,c,d,e){this.$log=a,this.config=b,this.eventBus=c,this.$window=d,this.deviceDetectionService=e,this.deviceType=this.deviceDetectionService.getDeviceType(),this.eventBus.subscribe(this.eventBus.events.USER_INFO_AVAILABLE,function(a){return function(b,c){return a.user=c}}(this)),this.eventBus.subscribe(this.eventBus.events.PROJECT_LOADED,function(a){return function(b,c){return a.project=c}}(this))}var b,c;return a.prototype.newInstance=function(a){return new c(this.$log,this.config,this.eventBus,a,this.$window,this)},c=function(){function a(a,b,c,d,e,f){this.$log=a,this.config=b,this.eventBus=c,this.name=d,this.$window=e,this.appState=f}return a.LOG_LEVELS=["ALL","DEBUG","INFO","WARN","ERROR","METRIC"],a.BASE_LOGGING_URL="/silver.gif",a._currentErrorLogCount=0,a.prototype._shouldLog=function(b){var c,d;return d=a.LOG_LEVELS.indexOf(b),c=a.LOG_LEVELS.indexOf(this.config.defaults.logLevel),c!==-1&&d!==-1?d>=c&&!this.config.runningTests():!this.config.runningTests()},a.prototype._notTesting=function(){return null==this.$window.__karma__&&null==this.$window.jasmine},a.prototype._logMessage=function(b,c,d){if(this._shouldLog(b)){if(c&&(this.$log[b.toLowerCase()]?this.$log[b.toLowerCase()](c):this.$log.info(c)),"ERROR"===b&&a._currentErrorLogCount>=this.config.maxErrorLogs)return;if(this._logToServer(b,c,d),"ERROR"===b)return a._currentErrorLogCount++}},a.prototype._logToServer=function(a,b,c){var d,e;return e=this._buildServerURL(a,b,c),d=new XMLHttpRequest,d.open("GET",e,!0),d.onreadystatechange=function(a){return function(c){if(4===d.readyState&&200!==d.status&&304!==d.status)return a.$log.warn("Could not log to server: "+b)}}(this),d.send()},a.prototype._buildServerURL=function(b,c,d){var e,f;return f=""+(this.config.defaults.logUrl||a.BASE_LOGGING_URL)+"?",e=this._nameValuePairs(b,c,d),f+=e.join("&"),""+f+"&"},a.prototype._nameValuePairs=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o;e=["time="+(new Date).getTime(),"level="+encodeURIComponent(a),"uid="+(null!=(g=null!=(h=this.appState)&&null!=(i=h.user)?i.id:void 0)?g:"anon"),"pguid="+(null!=(j=null!=(k=this.appState)&&null!=(l=k.project)?l.projectGUID:void 0)?j:""),"browser="+(null!=(m=this.$window.bowser)?m.name:void 0)+(null!=(n=this.$window.bowser)?n.version:void 0),"device="+(null!=(o=this.appState)?o.deviceType:void 0),"uuid="+this.$window.galleon.uuid,"buildNumber="+this.$window.galleon.buildNumber,"ref="+this.$window.galleon.ref],null!=b&&e.push("msg="+encodeURIComponent(b)),null!=this.name&&e.push("name="+encodeURIComponent(this.name));for(d in c)f=c[d],e.push(""+d+"="+encodeURIComponent("string"==typeof f?f.substring(0,100):f));return e},a.prototype.debug=function(a,b){return this._logMessage("DEBUG",a,b)},a.prototype.info=function(a,b){return this._logMessage("INFO",a,b)},a.prototype.warn=function(a,b){return this._logMessage("WARN",a,b)},a.prototype.error=function(a,b){if(this._logMessage("ERROR",a,b),this.config.defaults.logErrorsAsCritical)return this.showUserError(a,b)},a.prototype.metric=function(a,b){return this._logMessage("METRIC",a,b)},a.prototype.asyncMetric=function(a,c){return new b(this,a,c)},a.prototype.critical=function(a,b){return this._logMessage("ERROR",a,b),this.showUserError(a,b)},a.prototype.showUserError=function(a,b){var c;if(a&&this.eventBus.publish(this.eventBus.events.SHOW_CRITICAL_ERROR_DIALOG,{message:a}),"undefined"!=typeof Bugsnag&&null!==Bugsnag&&a)return c=this._nameValuePairs("ERROR",a,b),Bugsnag.notify("Caught exception",a,{"special info":c,groupingHash:a})},a.prototype.setErrorCount=function(b){if(null!=b)return a._currentErrorLogCount=b},a}(),b=function(){function a(a,b,c){this.logger=a,this.message=b,this.url=c,this.startTime=Date.now(),this.resolved=!1}return a.prototype.log=function(a){return null==a&&(a={}),!this.resolved&&(a.clientStartTime=this.startTime,a.duration=Date.now()-this.startTime,null!=this.url&&(a.url=this.url),this.logger.metric(this.message,a),!0)},a.prototype.success=function(a){return null==a&&(a={}),a.success=!0,this.log(a),this.resolved=!0},a.prototype.failure=function(a){return null==a&&(a={}),a.success=!1,this.log(a),this.resolved=!0},a}(),a}(),a.$inject=["$log","CONFIG","eventBus","$window","deviceDetectionService"],angular.module("galleon").service("loggerFactory",a)}.call(this),function(){"use strict";var a;a=function(a){var b;return b=a.newInstance("uncaughtException"),function(a,c){return a&&(a.stack||a.message)?b.error(a.stack?a.stack:a.message):b.error("Unknown exception")}},a.$inject=["loggerFactory"],angular.module("silverApp").factory("$exceptionHandler",a);
}.call(this),function(){var a;a=function(a,b){var c,d,e;return e=2,d=24e4,c=6e4,{request:function(b){return null!=b&&null==(null!=b?b.timeout:void 0)&&(b.timeout=c),null!=b&&(null!=b?b.extendedTimeout:void 0)===!0&&(b.timeout=d),b||a.when(b)},responseError:function(c){var d,f;return null!=c.config.numFailures?c.config.numFailures++:c.config.numFailures=1,c.config.numFailures>=e?(0===c.status&&null==c.data&&(c.data="Request timed out."),a.reject(c)):401===(f=c.status)||409===f||412===f||422===f||429===f?a.reject(c):(d=b.get("$http"))(c.config)}}},a.$inject=["$q","$injector"],angular.module("silverApp").factory("myHttpInterceptor",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}},c=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l,m,n,o){this.commandService=a,this.adaptiveLayoutService=c,this.eventBus=d,this.projectService=e,this.$modal=f,this.layoutService=g,this.pageFactory=h,this.customizeService=i,this.appState=j,this.contentService=k,this.eventsService=m,this.$window=n,this.$timeout=o,this._addImageToPage=b(this._addImageToPage,this),this._addImageToStoryboardPage=b(this._addImageToStoryboardPage,this),this._attemptToFillEmptyWell=b(this._attemptToFillEmptyWell,this),this.droppingInProgress=!1,this.doNotShwoWarningAgain=!1,this.currentProject=this.projectService.currentProject,this.logger=l.newInstance("DragDropService"),this.lastProductImageIDLogged=void 0,this.eventBus.subscribe(this.eventBus.events.PROJECT_LOADED,function(a){return function(b,c){return a.currentProject=c}}(this)),this.dropActionsByType={image:{palette:{storyboard_background:this._addImageToStoryboardPage(),background:this._addImageToPage(),graphic:this._dropOnGraphic(),well:this._addPaletteImageToWell(),text:this._addImageToPage(),"back-filler-page":this._addImageToFillerPage(),event:this._applyEventPhoto()},well:{palette:this._removeImageFromPage(),well:this._swapWellImages(),background:this._moveImage(),graphic:this._moveImage(),text:this._moveImage(),"back-filler-page":this._moveImageToFillerPage()},storyboard_page:{storyboard_background:this._swapStoryBoardPageImages(),palette:this._removeImageFromPage()},event:{event:this._swapEventPhoto(),palette:this._removeEventPhoto()}},background:{palette:{background:this._applyBackground(),graphic:this._applyBackground(),well:this._applyBackground(),text:this._applyBackground()}},frame:{palette:{well:this._applyFrame()}},embellishment:{palette:{background:this._applyEmbellishment(),graphic:this._applyEmbellishment(),well:this._applyEmbellishment(),text:this._applyEmbellishment()}},layout:{palette:{background:this._applyLayout(),graphic:this._applyLayout(),well:this._applyLayout(),text:this._applyLayout()}},"idea-page":{palette:{background:this._applyIdeaPage(),graphic:this._applyIdeaPage(),well:this._applyIdeaPage(),text:this._applyIdeaPage()}}}}return a.prototype.IMAGE="image",a.prototype.BACKGROUND="background",a.prototype.LAYOUT="layout",a.prototype.IDEA_PAGE="idea-page",a.prototype.EMBELLISHMENT="embellishment",a.prototype.FRAME="frame",a.prototype.TEXT="text",a.prototype.FILLER="filler-asset",a.prototype.EMPTY_INDICATOR="empty",a.prototype.BACKCOVER_BARCODE="backcover-barcode",a.prototype.PAB_ASSET_ID="pab-asset-id",a.prototype._dragOnlyTargets={text:!0,embellishment:!0},a.prototype.shouldHighlightDropIndicator=function(a){return!this.isSameImageAsset(this.currentlyDraggedAsset,a)&&this._shouldHighlightImageWell(this._getType(this.currentlyDraggedAsset),a)},a.prototype.showDropIndicator=function(a,b,c){if(this.indicateDropSurface(c,!0),!this.isSameImageAsset(a,b)&&this._shouldHighlightImageWell(this._getType(a),b))return this._toggleDropIndicator(!0,a,b,c),!0},a.prototype.indicateDropSurface=function(a,b){var c;return null==b&&(b=!0),c=angular.element(a).closest(".page-content")[0],b?null!=c?c.classList.add("drag-drop-activated"):void 0:null!=c?c.classList.remove("drag-drop-activated"):void 0},a.prototype.isSameImageAsset=function(a,b){return null!=(null!=a?a.uniqueProjectRef:void 0)&&null!=(null!=b?b.uniqueProjectRef:void 0)&&a.uniqueProjectRef===b.uniqueProjectRef},a.prototype.targetPagesAreSame=function(){var a,b;return(null!=(a=this.dropOptions)?a.pageNumber:void 0)===(null!=(b=this.dragOptions)?b.pageNumber:void 0)},a.prototype.hideDropIndicator=function(a,b,c){if(this.indicateDropSurface(c,!1),this._shouldHighlightImageWell(this._getType(a),b))return this._toggleDropIndicator(!1,a,b,c),!0},a.prototype._toggleDropIndicator=function(a,b,c,d){var e,f,g,h,i,j;switch(i=this._getType(c),f=null,e=null,h=null,i){case this.EMBELLISHMENT:case this.EMPTY_INDICATOR:case this.BACKCOVER_BARCODE:case this.TEXT:case this.FRAME:g=angular.element(d).closest(".page-content"),e=angular.element(null!=(j=g[0])?j.querySelector(".background-asset"):void 0),f=e.closest(".graphic-asset");break;default:f=angular.element(d).parent().parent(),e=angular.element(d),h=e.closest(".asset-container")}return a?(f.addClass("drop-ready-stage"),e.addClass("active-dropable-region"),null!=h&&h.addClass("active-droppable-asset")):(f.removeClass("drop-ready-stage"),e.removeClass("active-dropable-region"),null!=h&&h.removeClass("active-droppable-asset")),!0},a.prototype._shouldHighlightImageWell=function(a,b){var c;return a===this.IMAGE||a===this.FRAME&&"image"===(null!=b&&null!=(c=b.asset)?c.assetType:void 0)},a.prototype.isDroppable=function(a,b){var c;return c=this._getAction(a,b),null!=c&&c.canApply(a,b,this.dragOptions,this.dropOptions)},a.prototype.isDragOnlyTarget=function(a){var b;return b=this._getType(a),this._dragOnlyTargets[b]},a.prototype.getDropAction=function(a,b){var c;return c=this._getAction(a,b),null!=c?c.command(a,b):void 0},a.prototype._getAction=function(a,b){var d,e,f,g,h,i,j,k,l;if(null!=this.dragOptions&&null!=(null!=(h=this.dragOptions)?h.location:void 0)&&null!=(null!=(i=this.dropOptions)?i.location:void 0)&&null!=a&&("palette"!==this.dragOptions.location||"palette"!==this.dropOptions.location))return d=this._getType(a),f=this.dragOptions.location,g=this.dropOptions.location,e=null!=(j=this.dropActionsByType[d])&&null!=(k=j[f])?k[g]:void 0,"graphic"===(null!=b&&null!=(l=b.values)?l.assetType:void 0)&&"image"===d&&c.call(this.appState.backgroundsWaitingForPicture,b)>=0&&(e=this._applyImageToBackground()),e},a.prototype._getType=function(a){if(null!=a){if(a.type===this.FILLER)return this.FILLER;if(null!=a.productImageID||"image"===a.assetType||null!=a.imageId)return this.IMAGE;if(a.assetType===this.TEXT)return this.TEXT;if(a.assetType===this.BACKGROUND||a.assetId===this.PAB_ASSET_ID)return this.BACKGROUND;if(a.assetType===this.LAYOUT)return a.isIdeaLayout()?this.IDEA_PAGE:this.LAYOUT;if(a.type===this.BACKGROUND)return this.EMPTY_INDICATOR;if(a.type===this.BACKCOVER_BARCODE)return this.BACKCOVER_BARCODE;if("embellishment"===a.assetType||"patternband"===a.assetType)return this.EMBELLISHMENT;if(a.assetType===this.FRAME)return this.FRAME;if(null!=a.asset)return"graphic"===a.asset.assetType&&a.asset.type===this.BACKGROUND?this.BACKGROUND:"graphic"===a.asset.assetType&&a.asset.type===this.EMBELLISHMENT?this.EMBELLISHMENT:a.asset.assetType===this.TEXT?this.TEXT:void 0}},a.prototype._moveImageToFillerPage=function(){return{command:function(a){return function(){return function(){var b,c;a.droppingInProgress=!0,c=a.dragOptions.pageNumber,a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_SHOW);try{return a._fetchNewPage().then(function(b){var d,e,f,g,h;return g=b.pages[0],e=a.pageFactory.newInstance(g),d=angular.copy(a.currentlyDraggedAsset.imageAssignment),h=a.adaptiveLayoutService.createProductSpec(a.projectService.currentProject.product,e),f=a._createAdaptOptions(),a.adaptiveLayoutService.getAdaptiveLayout(e,h,d,f).then(function(b){return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE),a._executeAddImageToFillerPage(b,g,null,a.currentlyDraggedAsset,c),a.droppingInProgress=!1},function(){return a.droppingInProgress=!1,a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)})},function(){return a.droppingInProgress=!1,a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)})}catch(a){return b=a,console.log(b)}finally{a.droppingInProgress=!1,a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)}}}}(this),canApply:function(a){return function(){return a.droppingInProgress===!1}}(this)}},a.prototype._createAdaptOptions=function(){var a;return a={pageCount:this.projectService.currentProject.product.pages.length,styleJson:this.contentService.currentStyle,projectType:this.projectService.currentProject.type}},a.prototype._moveImage=function(){return{command:function(a){return function(){return function(){var b,c,d,e,f,g;return a.droppingInProgress=!0,g=a.dropOptions.pageNumber,d=a.dragOptions.pageNumber,g&&d?(f=a.currentProject.product.pageBySurfaceNumber(a.dropOptions.pageNumber),b=angular.copy(a.currentlyDraggedAsset.imageAssignment),e=a.adaptiveLayoutService.createProductSpec(a.projectService.currentProject.product,f),c=a._createAdaptOptions(),a.adaptiveLayoutService.getAdaptiveLayout(f,e,b,c).then(function(b){return a.commandService.execute("MoveWellImageCommand",{activePageNumber:g,originPageNumber:d,targetPageNumber:g,imageAsset:a.currentlyDraggedAsset,layoutInfo:b}),a.currentlyDraggedAsset=null,a.droppingInProgress=!1},function(){return a.droppingInProgress=!1})):(a.currentlyDraggedAsset=null,void(a.droppingInProgress=!1))}}}(this),canApply:function(a){return function(){return a.droppingInProgress!==!0&&(!(!a.dropOptions.pageNumber||!a.dragOptions.pageNumber)&&a.dropOptions.pageNumber!==a.dragOptions.pageNumber)}}(this)}},a.prototype._addImageToFillerPage=function(){return{command:function(a){return function(){return function(){var b;a.droppingInProgress=!0,a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_SHOW);try{return a._fetchNewPage().then(function(b){var c,d,e,f;return e=b.pages[0],c=a.pageFactory.newInstance(e),f=a.adaptiveLayoutService.createProductSpec(a.projectService.currentProject.product,c),d=a._createAdaptOptions(),a.adaptiveLayoutService.getAdaptiveLayout(c,f,a.currentlyDraggedAsset,d).then(function(b){return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE),a._executeAddImageToFillerPage(b,e,a.currentlyDraggedAsset.imageId,null),a.droppingInProgress=!1},function(){return a.droppingInProgress=!1,a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)})},function(){return a.droppingInProgress=!1,a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)})}catch(a){return b=a,console.log(b)}finally{a.droppingInProgress=!1,a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)}}}}(this),canApply:function(a){return function(b,c){return(null!=b?b.hasError:void 0)===!0?(a._logDropImageWithErrorAttempt(b),!1):a.droppingInProgress===!1}}(this)}},a.prototype._fetchNewPage=function(){return this.projectService.innerPages([],this.currentProject.product.styleId,this.currentProject.product.styleContentVersion,this.currentProject.product.cover.coverSpecID,this.currentProject.product.cover.binding,null,1,1,this.currentProject.product.cover.stockCoverSpecID)},a.prototype._executeAddImageToFillerPage=function(a,b,c,d,e){return this.commandService.execute("AddImageToFillerPageCommand",{imageId:c,imageAsset:d,layoutInfo:a,newPage:b,sourcePageNumber:e})},a.prototype._dropOnGraphic=function(){return{command:this._addImageToPage().command,canApply:function(a){return function(b,c){var d;return(null!=b?b.hasError:void 0)===!0?(a._logDropImageWithErrorAttempt(b),!1):a.droppingInProgress!==!0&&(!!a._addImageToPage().canApply()&&(d=a.currentProject.product.pageBySurfaceNumber(a.dropOptions.pageNumber),!!d&&!(c.isHollow||d.isStockCover)))}}(this)}},a.prototype._isEmptyWellAvailable=function(a){var b;return b=a.getEmptyImageWells(),b&&b.length>0},a.prototype._attemptToFillEmptyWell=function(a,b){return null==b&&(b=!0),function(c){return function(){var d,e,f,g,h,i;return g=a.getEmptyImageWells(),!(!g||0===g.length)&&(e=c.currentlyDraggedAsset,f=g[0],c.droppingInProgress=!0,g.length>1&&b?(d=c.currentProject.product,i=c.adaptiveLayoutService.createProductSpec(d,a),h={pageCount:c.projectService.currentProject.product.pages.length,styleJson:c.contentService.currentStyle},c.adaptiveLayoutService.getAdaptiveLayoutLeavingSingleEmptyWell(a,i,h).then(function(b){return b.id!==a.layoutName?c.commandService.execute("AddWellImageAndEnsureNoEmptyWellCommand",{source:{imageId:e.imageId,uniqueProjectRef:f.uniqueProjectRef},pageNumber:a.surfaceNumber,layoutInfo:b}):c.commandService.execute("AddWellImageCommand",{source:{imageId:e.imageId,uniqueProjectRef:f.uniqueProjectRef},pageNumber:a.surfaceNumber,target:{imageId:f.imageId,uniqueProjectRef:f.uniqueProjectRef}})})):c.commandService.execute("AddWellImageCommand",{source:{imageId:e.imageId,uniqueProjectRef:f.uniqueProjectRef},pageNumber:a.surfaceNumber,target:{imageId:f.imageId,uniqueProjectRef:f.uniqueProjectRef}}),c.droppingInProgress=!1,!0)}}(this)},a.prototype._addImageToStoryboardPage=function(){return{command:function(a){return function(){var b;return b=a.currentProject.product.pageBySurfaceNumber(a.dropOptions.pageNumber),a._isEmptyWellAvailable(b)?a._attemptToFillEmptyWell(b,!b.ideaLayout):b.ideaLayout?a._noNewPhotoAllowedOnIdeaPageCommand(b):a._adaptPageCommand(b)}}(this),canApply:function(a){return function(b,c){var d;return(null!=b?b.hasError:void 0)===!0?(a._logDropImageWithErrorAttempt(b),!1):a.droppingInProgress!==!0&&(d=a.currentProject.product.pageBySurfaceNumber(a.dropOptions.pageNumber),!(!d||d.isStockCover||d.isSpine()&&d.ideaLayout))}}(this)}},a.prototype._addImageToPage=function(){return{command:function(a){return function(){var b,c;return b=a.currentProject.product.pageBySurfaceNumber(a.dropOptions.pageNumber),(null!=(c=a.appState.backgroundsWaitingForPicture)?c.length:void 0)>0?a._applyImageToBackgroundCommand():b.isGrid&&!a.appState.isCustomizing()?a._openDialog():(b.ideaLayout||b.isGrid)&&a.appState.canCustomize()||a.appState.isCustomizing()?a._addNewImageWellCommand(b):b.ideaLayout?void 0:a._adaptPageCommand(b)}}(this),canApply:function(a){return function(b,c){var d;return(null!=b?b.hasError:void 0)===!0?(a._logDropImageWithErrorAttempt(b),!1):a.droppingInProgress!==!0&&(d=a.currentProject.product.pageBySurfaceNumber(a.dropOptions.pageNumber),!(!d||d.isStockCover||!a.appState.canCustomize()&&d.ideaLayout||d.isSpine()&&d.ideaLayout))}}(this)}},a.prototype._noNewPhotoAllowedOnIdeaPageCommand=function(a){return function(b){return function(){var c;return c=a.getImages(),b.eventBus.publish(b.eventBus.events.NOMORE_PHOTOS_CANBE_ADDED,{maxAllowedPhotos:c.length})}}(this)},a.prototype._addNewImageWellCommand=function(a){return function(b){return function(c){return b.customizeService.prepareApplyNewWellCommand(a.surfaceNumber,c,b.currentlyDraggedAsset)()}}(this)},a.prototype._adaptPageCommand=function(a,b){return null==b&&(b=!1),function(c){return function(){var d,e,f,g,h,i;c.droppingInProgress=!0;try{return h=c.adaptiveLayoutService.createProductSpec(c.projectService.currentProject.product,a),g=c.dropOptions.pageNumber,f=c._createAdaptOptions(),i=!1,d=b,c.adaptiveLayoutService.getAdaptiveLayout(a,h,c.currentlyDraggedAsset,f,i,d).then(function(a){return c.commandService.execute("AdaptPageCommand",{pageNumber:g,imageId:c.currentlyDraggedAsset.imageId,layoutInfo:a}),c.currentlyDraggedAsset=null,c.droppingInProgress=!1,c.eventBus.publish(c.eventBus.events.PLEASE_WAIT_HIDE,function(){return c.droppingInProgress=!1})})}catch(a){e=a}finally{c.droppingInProgress=!1}}}(this)},a.prototype._removeImageFromPage=function(){return{command:function(a){return function(b){return function(){return a.droppingInProgress=!0,a.commandService.execute("RemoveWellImageCommand",{imageId:b.imageId,uniqueProjectRef:b.uniqueProjectRef,pageNumber:a.dragOptions.pageNumber}),a.droppingInProgress=!1}}}(this),canApply:function(a){return function(){return a.droppingInProgress===!1}}(this)}},a.prototype._addPaletteImageToWell=function(){return{command:function(a){return function(b,c){return function(){var d,e;return a.droppingInProgress=!0,d={source:{imageId:b.imageId,uniqueProjectRef:c.uniqueProjectRef},pageNumber:a.dropOptions.pageNumber,target:{imageId:c.imageId,uniqueProjectRef:c.uniqueProjectRef}},"virtual-image"===(null!=c&&null!=(e=c.asset)?e.assetType:void 0)&&(d.virtualTarget=c),a.commandService.execute("AddWellImageCommand",d),a.droppingInProgress=!1}}}(this),canApply:function(a){return function(b,c){var d;return(null!=b?b.hasError:void 0)===!0?(a._logDropImageWithErrorAttempt(b),!1):a.droppingInProgress!==!0&&(d=a.currentProject.product.pageBySurfaceNumber(a.dropOptions.pageNumber),!!d)}}(this)}},a.prototype._swapWellImages=function(){return{command:function(a){return function(b,c){return function(){return a.droppingInProgress=!0,a.commandService.execute("SwapWellImageCommand",{source:{imageId:b.imageId,uniqueProjectRef:b.uniqueProjectRef},target:{imageId:c.imageId,uniqueProjectRef:c.uniqueProjectRef},pageNumber:[a.dragOptions.pageNumber,a.dropOptions.pageNumber]}),a.droppingInProgress=!1,a.currentlyDraggedAsset=null}}}(this),canApply:function(a){return function(b,c,d,e){return a.droppingInProgress!==!0&&(!(!e.pageNumber||!d.pageNumber)&&((null!=b?b.hasAssignedImage():void 0)&&((null!=b?b.uniqueProjectRef:void 0)!==(null!=c?c.uniqueProjectRef:void 0)||d.pageNumber!==e.pageNumber)))}}(this)}},a.prototype._swapStoryBoardPageImages=function(){return{command:function(a){return function(){return function(){var b,c,d,e,f,g;return a.droppingInProgress=!0,g=a.dropOptions.pageNumber,d=a.dragOptions.pageNumber,g&&d?(f=a.currentProject.product.pageBySurfaceNumber(a.dropOptions.pageNumber),b=angular.copy(a.currentlyDraggedAsset.imageAssignment),e=a.adaptiveLayoutService.createProductSpec(a.projectService.currentProject.product,f),c=a._createAdaptOptions(),a.adaptiveLayoutService.getAdaptiveLayout(f,e,b,c).then(function(f){var h;return h=a.currentProject.product.pageBySurfaceNumber(d),e=a.adaptiveLayoutService.createProductSpec(a.projectService.currentProject.product,h),a.adaptiveLayoutService.getAdaptiveLayout(h,e,b,c,!1,!1,!0).then(function(b){return a.commandService.execute("MoveStoryBoardPageImageCommand",{targetPageNumber:g,originPageNumber:d,imageAsset:a.currentlyDraggedAsset,targetPageLayoutInfo:f,sourcePageLayoutInfo:b,activePageNumber:g}),a.currentlyDraggedAsset=null,a.droppingInProgress=!1})},function(){return a.droppingInProgress=!1})):(a.currentlyDraggedAsset=null,void(a.droppingInProgress=!1))}}}(this),canApply:function(a){return function(){return a.droppingInProgress!==!0&&(!(!a.dropOptions.pageNumber||!a.dragOptions.pageNumber)&&a.dropOptions.pageNumber!==a.dragOptions.pageNumber)}}(this)}},a.prototype._applyBackground=function(){return{command:function(a){return function(){return function(b){var c,d,e;return a.droppingInProgress=!0,e=a.currentProject.product.pageBySurfaceNumber(a.dropOptions.pageNumber),c=0,e.isSpread()&&(null!=b?b.xPercent:void 0)>.5&&(c=1),d=a.currentlyDraggedAsset.assetId===a.PAB_ASSET_ID?"AddPictureAsBackgroundCommand":"ApplyBackgroundCommand",a.commandService.execute(d,{contentGraphicAsset:a.currentlyDraggedAsset,pageNumber:a.dropOptions.pageNumber,backgroundIndex:c}),a.currentlyDraggedAsset=null,a.droppingInProgress=!1}}}(this),canApply:function(a){return function(b,c,d,e){var f;return a.droppingInProgress!==!0&&b.assetId!==(null!=c&&null!=(f=c.asset)?f.assetId:void 0)}}(this)}},a.prototype._applyImageToBackground=function(){return{command:function(a){return function(){return a._applyImageToBackgroundCommand()}}(this),canApply:function(a){return function(b,c,d,e){var f;return a.droppingInProgress!==!0&&b.assetId!==(null!=c&&null!=(f=c.asset)?f.assetId:void 0)}}(this)}},a.prototype._applyImageToBackgroundCommand=function(){return function(a){return function(b){var c,d,e;return a.droppingInProgress=!0,e=a.currentProject.product.pageBySurfaceNumber(a.dropOptions.pageNumber),c=0,e.isSpread()&&(null!=b?b.xPercent:void 0)>.5&&(c=1),d="AddRealPictureAsBackgroundCommand",a.commandService.execute(d,{contentGraphicAsset:a.currentlyDraggedAsset,pageNumber:a.dropOptions.pageNumber,backgroundIndex:c}),a.currentlyDraggedAsset=null,a.droppingInProgress=!1}}(this)},a.prototype._applyFrame=function(){return{command:function(a){return function(b,c){return function(){var b,d,e;return a.droppingInProgress=!0,e=a.currentProject.product.pageBySurfaceNumber(a.dropOptions.pageNumber),d=e.indexOfAsset(c),b={assetIndices:[d],pageNumber:a.dropOptions.pageNumber,frameWidth:a.currentlyDraggedAsset.thickness,frameColorId:a.currentlyDraggedAsset.colorId,frameColorHex:a.currentlyDraggedAsset.color,frameId:a.currentlyDraggedAsset.assetId},d>=0&&a.commandService.execute("ApplyFramesCommand",b),a.currentlyDraggedAsset=null,a.droppingInProgress=!1}}}(this),canApply:function(a){return function(b,c,d,e){var f;return a.droppingInProgress!==!0&&(f=a.currentProject.product.pageBySurfaceNumber(a.dropOptions.pageNumber),!f.isSpine())}}(this)}},a.prototype._applyEmbellishment=function(){return{command:function(a){return function(){return function(b){return a.droppingInProgress=!0,a.customizeService.prepareApplyEmbellishmentCommand(a.currentlyDraggedAsset,a.dropOptions.pageNumber,b)(),a.currentlyDraggedAsset=null,a.droppingInProgress=!1}}}(this),canApply:function(a){return function(b,c,d,e){var f;return a.droppingInProgress!==!0&&(f=a.currentProject.product.pageBySurfaceNumber(a.dropOptions.pageNumber),!f.isSpine())}}(this)}},a.prototype._applyLayout=function(){return{command:function(a){return function(){return function(b){return a.droppingInProgress=!0,a.layoutService.applyToSurfaceNumber(a.currentlyDraggedAsset,a.dropOptions.pageNumber,null,b),a.currentlyDraggedAsset=null,a.droppingInProgress=!1}}}(this),canApply:function(a){return function(b,c,d,e){var f;return a.droppingInProgress!==!0&&(f=a.currentProject.product.pageBySurfaceNumber(a.dropOptions.pageNumber),f.layoutName!==b.assetId&&(a.layoutService.canApplyLayoutAssetToPageNumber(b,e.pageNumber)||a.layoutService.canDropLayoutToSelectSurface(b,e.pageNumber)))}}(this)}},a.prototype._applyIdeaPage=function(){return{command:function(a){return function(){return function(b){return a.droppingInProgress=!0,a.layoutService.applyToSurfaceNumber(a.currentlyDraggedAsset,a.dropOptions.pageNumber,a.IDEA_PAGE,b),a.currentlyDraggedAsset=null,a.droppingInProgress=!1}}}(this),canApply:function(a){return function(b,c,d,e){var f;return a.droppingInProgress!==!0&&(f=a.currentProject.product.pageBySurfaceNumber(a.dropOptions.pageNumber),f.layoutName!==b.assetId&&(a.layoutService.canApplyLayoutAssetToPageNumber(b,e.pageNumber,a.IDEA_PAGE)||a.layoutService.canDropLayoutToSelectSurface(b,e.pageNumber,a.IDEA_PAGE)))}}(this)}},a.prototype._applyEventPhoto=function(){return{command:function(a){return function(b,c){return function(){var c;return a.droppingInProgress=!0,c=a.eventsService.getEvent(a.dropOptions.eventId),a.currentlyDraggedAsset=null,a.eventBus.publish(a.eventBus.events.CALENDAR_EVENT_IMAGE_DRAGGED,{event:c,sflyId:b.sflyId,productImageId:b.productImageID}),a.droppingInProgress=!1}}}(this),canApply:function(a){return function(b,c,d,e){var f;return a.droppingInProgress!==!0&&(f=a.eventsService.getEvent(a.dropOptions.eventId),!!f&&!a.eventsService.isEventPublic(f))}}(this)}},a.prototype._swapEventPhoto=function(){return{command:function(a){return function(){return function(){return a.droppingInProgress=!0,a.currentlyDraggedAsset=null,a.commandService.execute("SwapEventImageCommand",{sourceEvent:a.eventsService.getEvent(a.dragOptions.eventId),targetEvent:a.eventsService.getEvent(a.dropOptions.eventId)}),a.droppingInProgress=!1}}}(this),canApply:function(a){return function(b,c,d,e){var f,g,h,i;if(a.droppingInProgress===!0)return!1;for(i=a.eventsService.events,g=0,h=i.length;g<h;g++)if(f=i[g],f.id===e.eventId)return!a.eventsService.isEventPublic(f);return!0}}(this)}},a.prototype._removeEventPhoto=function(){return{command:function(a){return function(b){return function(){var b,c,d,e,f;for(a.droppingInProgress=!0,b=null,f=a.eventsService.events,d=0,e=f.length;d<e;d++)if(c=f[d],c.id===a.dragOptions.eventId){b=c;break}return b.projectImageId=void 0,a.currentlyDraggedAsset=null,a.droppingInProgress=!1,a.eventBus.publish(a.eventBus.events.CALENDAR_EVENT_UPDATED),a.eventBus.publish(a.eventBus.events.CALENDAR_REMOVE_ACTIVE_EVENT,b)}}}(this),canApply:function(a){return function(b,c,d,e){var f,g,h,i;if(a.droppingInProgress===!0)return!1;for(i=a.eventsService.events,g=0,h=i.length;g<h;g++)if(f=i[g],f.id===e.eventId)return!a.eventsService.isEventPublic(f);return!0}}(this)}},a.prototype._logDropImageWithErrorAttempt=function(a){if(this.lastProductImageIDLogged!==(null!=a?a.productImageID:void 0))return this.lastProductImageIDLogged=null!=a?a.productImageID:void 0,this.logger.warn("--DropAttemptAvertedUsingImageWithError--",{imageId:null!=a?a.imageId:void 0,productImageID:null!=a?a.productImageID:void 0})},a.prototype._openDialog=function(){if(this._dealWithHover(),!this.doNotShwoWarningAgain)return this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/gc/miss-day-target-warning.html",backdrop:"static",controller:"MissDayTargetWarningCtrl"}),this.eventBus.publish(this.eventBus.events.MODAL_OPENED)},a.prototype._dealWithHover=function(){return $(this.$window.document.getElementsByClassName("page-graphic-asset")).css("box-shadow","none"),this.$timeout(function(a){return function(){return $(a.$window.document.getElementsByClassName("page-graphic-asset")).hover(function(){$(this).css("box-shadow","inset 0px 0px 0px 3px #00f72c")},function(){$(this).css("box-shadow","none")})}}(this),0)},a}(),a.$inject=["commandService","adaptiveLayoutService","eventBus","projectService","$modal","layoutService","pageFactory","customizeService","appState","contentService","loggerFactory","eventsService","$window","$timeout"],angular.module("silverApp").service("dragDropService",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e){this.commandService=a,this.eventBus=c,this.$timeout=d,this.projectService=e,this.executeMove=b(this.executeMove,this),this.assignTarget=b(this.assignTarget,this),this.assignSource=b(this.assignSource,this),this.sourcePage=null,this.targetPage=null}return a.prototype.assignSource=function(a){return this.sourcePage=a},a.prototype.assignTarget=function(a){return this.targetPage=a},a.prototype.executeMove=function(){var a,b,c,d,e,f,g,h;return this.sourcePage===this.targetPage?(this.sourcePage=null,void(this.targetPage=null)):(this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),c=this.projectService.currentProject.product,b=c.pageBySurfaceNumber(this.targetPage),a=c.pageBySurfaceNumber(this.sourcePage),h=this._spreadLocations(),d=h[0],g=h[1],f=h[2],this._recalibrateTargetPage(a,b),e=this._moveOptions(d,g,f,a),this.$timeout(function(a){return function(){return a.commandService.execute("MovePageCommand",e),a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE),a.sourcePage=null,a.targetPage=null}}(this),100))},a.prototype._recalibrateTargetPage=function(a,b){var c;return this.sourcePage>this.targetPage?(c=(null!=b?b.isSpread():void 0)?2:1,this.targetPage=this.targetPage+c):(null!=b?b.isSpread():void 0)?this.targetPage++:void 0},a.prototype._moveOptions=function(a,b,c,d){var e,f,g,h,i,j,k;return k=[{currentPageNumber:this.sourcePage,finalPageNumber:this.targetPage}],f=this.sourcePage,e=this.targetPage,((null!=d?d.isSpread():void 0)||!(this._opBeforeFirstSpread(a,this.sourcePage,this.targetPage)||this._opAfterLastSpread(c,b,this.sourcePage,this.targetPage)||this._opWithinSpreads(c,b)))&&(h=this.targetPage>this.sourcePage,g=this.sourcePage%2===0,h?(i=g?this.sourcePage:this.sourcePage-1,j=g?this.targetPage:this.targetPage-1,e=g?this.targetPage-1:this.targetPage):(i=g?this.sourcePage+1:this.sourcePage,j=g?this.targetPage+1:this.targetPage,e=g?this.targetPage:this.targetPage+1),k.push({currentPageNumber:i,finalPageNumber:j,autoMoved:!0})),{move:k,beforeCommandPageNumber:f,activePageNumber:e}},a.prototype._opWithinSpreads=function(a,b){return a===b},a.prototype._opBeforeFirstSpread=function(a,b,c){return null==a||b<a&&c<a},a.prototype._opAfterLastSpread=function(a,b,c,d){return null==a&&null==b||c>b&&d>a},a.prototype._spreadLocations=function(){var a,b,c,d;return a=this.projectService.currentProject.product,d=a.spreadNumberAfterPageNumber(this.targetPage),c=a.spreadNumberAfterPageNumber(this.sourcePage),b=a.spreadNumberAfterPageNumber(1),[b,d,c]},a}(),a.$inject=["commandService","eventBus","$timeout","projectService"],angular.module("silverApp").service("movePageService",a)}.call(this),function(){var a;a=function(){function a(a,b,c,d,e,f,g,h,i,j){this.commandService=a,this.contentService=b,this.navService=c,this.adaptiveLayoutService=d,this.pageFactory=e,this.eventBus=f,this.projectService=h,this.config=i,this.contentLayoutFactory=j,this.logger=g.newInstance("LayoutService"),this.phoneCoverChanged=!1,this.imageRatio=1}return a.prototype.applyToPage=function(a,b,c){var d,e,f;return(null!=(f=this.navService.leftPage)&&"function"==typeof f.isSpread?f.isSpread():void 0)&&!a.isSpread()?((null!=c?c.xPercent:void 0)>.5&&(b=this.navService.rightPage),this._applyToSpread(a,b)):(d=b,e=b,a.isSpread()&&!b.isSpread()&&(d=[this.navService.leftPage,this.navService.rightPage],e=this.navService.leftPage),this.adaptiveLayoutService.applyLayout(a,d,this.contentService.currentStyle,this.projectService.currentProject.type).then(function(b){return function(c){return b._handleLayoutResult(e,c,a)}}(this)))},a.prototype._handleLayoutResult=function(a,b,c){return c.isSpread()&&a===this.projectService.currentProject.product.lastPage()?this._fetchNewPage().then(function(d){return function(e){var f;return f=e.pages[0],d.commandService.execute("ApplySpreadToLastPageCommand",{pageNumber:a.surfaceNumber,layoutInfo:b,backgroundContentGraphicAsset:d._extractBackgroundContentGraphicAsset(c),newPage:f})}}(this)):void this._executeAdaptPage(a.surfaceNumber,b,c)},a.prototype._executeAdaptPage=function(a,b,c){return this.eventBus.publishSync(this.eventBus.events.TRANSIENT_LAYOUT_STARTED,{surfaceNumber:a}),this.commandService.execute("AdaptPageCommand",{pageNumber:a,layoutInfo:b,backgroundContentGraphicAsset:this._extractBackgroundContentGraphicAsset(c)})},a.prototype._fetchNewPage=function(){var a;return a=this.projectService.currentProject,this.projectService.innerPages([],a.product.styleId,a.product.styleContentVersion,a.product.cover.coverSpecID,a.product.cover.binding,null,1,1,a.product.cover.stockCoverSpecID)},a.prototype._applyToSpread=function(a,b){var c,d,e,f;return c={leftLayout:null,rightLayout:null},f=this.contentService.currentStyle,d=this.adaptiveLayoutService.createProductSpec(this.projectService.currentProject.product,this.navService.leftPage),e=this.navService.leftPage.layout.values,b===this.navService.leftPage?c.leftLayout=a:c.rightLayout=a,this.adaptiveLayoutService.splitSpread(e,f,d,c).then(function(a){return function(c){return a.commandService.execute("SplitSpreadCommand",{left:{layoutValues:c.leftLayout,pageNumber:a.navService.leftPage.surfaceNumber,select:b===a.navService.leftPage},right:{layoutValues:c.rightLayout,pageNumber:a.navService.rightPage.surfaceNumber,select:b===a.navService.rightPage},unassignedImages:c.unassignedImages})}}(this))},a.prototype._extractBackgroundContentGraphicAsset=function(a){var b,c,d,e,f,g;if(d=null,a.isIdeaLayout()){for(c=null,g=a.layoutJson.assets,e=0,f=g.length;e<f;e++){b=g[e],"Background"===b.type,c=b;break}null!==c&&(d={assetId:c.assetReference.assetId,version:c.assetReference.version,mobileUrl:this.config.protocolRelativeUrl(c.assetReference.sourceUrl),assetType:c.assetReference.assetType})}return d},a.prototype.applyToSurfaceNumber=function(a,b,c,d){return this.canApplyLayoutAssetToPageNumber(a,b,c)?this.applyToPage(a,this.navService.project.product.pageBySurfaceNumber(b),d):this.canDropLayoutToSelectSurface(a,b,c)?void this.navService.setSelectedPage(this.projectService.currentProject.product.pageBySurfaceNumber(b)):void this.logger.warn("LayoutService.applyToSurfaceNumber called with incompatible layout asset");
},a.prototype.applyToSelectedPage=function(a){if(a.assetId!==this.navService.selectedPage.layoutName)return this.applyToPage(a,this.navService.selectedPage)},a.prototype._pageNumberToAssetListType=function(a,b,c){var d,e;switch(null==c&&(c=!1),e=b?"IdeaPages":"Layouts",d=c?"spreadCore":"core",a){case this.pageFactory.Page.TITLE_PAGE_NUMBER:return"title"+e;case this.pageFactory.Page.FRONT_COVER_PAGE_NUMBER:return"frontCover"+e;case this.pageFactory.Page.BACK_COVER_PAGE_NUMBER:return"backCover"+e;case this.pageFactory.Page.SPINE_PAGE_NUMBER:return"spine"+e;case this.pageFactory.Page.FRONT_FILLER_PAGE_NUMBER:case this.pageFactory.Page.BACK_FILLER_PAGE_NUMBER:return null;default:return""+d+e}},a.prototype.canApplyLayoutAssetToPageNumber=function(a,b,c){return a.assetListType===this._pageNumberToAssetListType(b,"idea-page"===c,a.isSpread())},a.prototype.canDropLayoutToSelectSurface=function(a,b,c){var d;return d=this._pageNumberToAssetListType(b,"idea-page"===c),/cover|spine/i.test(a.assetListType)&&/cover|spine/i.test(d)},a.prototype.summarizeLayout=function(a){var b,c,d,e,f,g,h;if(a){for(d=0,c=!1,g=a.assets,e=0,f=g.length;e<f;e++)switch(b=g[e],null!=b.values&&(b=b.values),b.assetType){case"image":d+=1;break;case"text":c="page_num_"!==(null!=(h=b.paraStyle)?h.substring(0,9):void 0)}return d>=1&&("function"==typeof a.hasPictureAsBackground?a.hasPictureAsBackground():void 0)===!0&&d--,{imageCount:d,hasTextAsset:c}}},a.prototype.filterLayoutsFromCurrentCoverType=function(a,b){var c,d;return null==b&&(b=!1),c=this.projectService.currentProject.product.cover,d=function(a){return function(b){return b.assetId.toLowerCase().indexOf(a.toLowerCase())>=0}},b&&this.projectService.currentProject.product.hasWideSpine()?a.filter(d("wide")):c.isHardCover()&&null!=a?a.filter(d("hard")):c.isSoftCover()&&null!=a?a.filter(d("soft")):[]},a.prototype.parseLayoutsFromStyle=function(a){var b,c,d,e,f,g,h,i,j,k;for(null==a&&(a=function(a){return!0}),d=[],c=[],g=[],h=[],e=[],f=[],k=this.contentService.currentStyle.assetLists.assetList,i=0,j=k.length;i<j;i++)b=k[i],"coreLayouts"===b.listType&&(e=this._getLayoutsList(b,a)),"spreadCoreLayouts"===b.listType&&this.config.spreads&&(f=this._getLayoutsList(b,a)),"titleLayouts"===b.listType&&(h=this._getLayoutsList(b,!1)),"frontCoverLayouts"===b.listType&&(d=this._getLayoutsList(b,a)),"backCoverLayouts"===b.listType&&(c=this._getLayoutsList(b,a)),"spineLayouts"===b.listType&&(g=this._getLayoutsList(b,a));return{frontCoverLayouts:d,backCoverLayouts:c,spineLayouts:g,titleLayouts:h,innerLayouts:e,innerSpreadLayouts:f}},a.prototype._getLayoutsList=function(a,b,c){var d,e,f,g,h,i,j,k;if(null==c&&(c=function(a,b){return a.imageCount-b.imageCount}),null==a.assetRef)return[];for(g=[],b="function"==typeof b?b:function(){return!0},j=a.assetRef,h=0,i=j.length;h<i;h++)d=j[h],"none"!==(null!=(k=d.layoutAttributes)?k.PaletteVisibility:void 0)&&(e=this.contentLayoutFactory.newInstance(d),!this.config.spreads&&e.isSpread()||!b(e)||(f=this.summarizeLayout(d.layout_JSON),"editor"===this.config.defaults.productMode&&f.hasTextAsset||("titleLayouts"!==a.listType||f.hasTextAsset)&&(this._annotateLayout(d,e,a),g.push(e))));return g.sort(c)},a.prototype._annotateLayout=function(a,b,c){var d;return d=this.summarizeLayout(a.layout_JSON),b.imageCount=d.imageCount,b.hasTextAsset=d.hasTextAsset,b.assetListType=c.listType},a.prototype.getId=function(a,b,c,d,e){var f,g,h,i,j;return e?(this.currentImage=c,void(this.phoneCoverChanged=!0)):((c.imageId!==(null!=(h=this.currentImage)?h.imageId:void 0)||this.phoneCoverChanged)&&(this.phoneCoverChanged?(this.phoneCoverChanged=!1,this.imageHeight=this.currentImage.Xheight,this.imageWidth=this.currentImage.Xwidth):(this.imageHeight=null!=c&&null!=(i=c.asset)?i.height:void 0,this.imageWidth=null!=c&&null!=(j=c.asset)?j.width:void 0,this.currentImage=c),this.imageRatio=this.imageWidth/this.imageHeight),f=.9<=this.imageRatio&&this.imageRatio<=1.1?a.square:this.imageWidth>this.imageHeight?a.landscape:a.portrait,f=f.replace("8x8",b),g=d?"soft":"hard",f.startsWith(b+g)?f:null)},a}(),a.$inject=["commandService","contentService","navService","adaptiveLayoutService","pageFactory","eventBus","loggerFactory","projectService","CONFIG","contentLayoutFactory"],angular.module("silverApp").service("layoutService",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.$window=a,this.deviceData=b,this.config=c,this.document=this.$window.document,this.bowser=this.$window.bowser}var b;return b="wellAvatarImage_id",a.prototype.produceAvatar=function(a,b){var c,d;if(this._hasValidDragData(a,b))return this.document.documentMode||(null!=(c=this.bowser)?c.msie:void 0)||(null!=(d=this.bowser)?d.msedge:void 0)?this._attachAvatarImageForIE(a):null!=this.$window.InstallTrigger||this.bowser.chrome&&this.bowser.version>=50?this._attachAvatarImageForCanvasDrag(a,b):this._attachAvatarImageForWebkit(a,b)},a.prototype._attachAvatarImageForIE=function(a){},a.prototype._attachAvatarImageForWebkit=function(a,b){var c;return c=this._createAvatarImage(a),this._setAvatarImageStyleWebkit(c,a),this._insertOnPage(c),b.setDragImage(c,c.offsetWidth/2,c.offsetHeight/2)},a.prototype._attachAvatarImageForCanvasDrag=function(a,b){var c,d,e,f,g,h,i;return h=this._imageURLFromDragElement(a),b.setData("text/uri-list",h),i=this.deviceData.pixelRatio(),d=this._createAvatarImage(a),this._setAvatarImageStyleFirefox(d,a),this._insertOnPage(d),e=d.offsetWidth*i,c=d.offsetHeight*i,f=this.document.createElement("canvas"),f.width=e,f.height=c,g=f.getContext("2d"),g.drawImage(d,0,0,e,c),b.setDragImage(f,e/2,c/2)},a.prototype._imageURLFromDragElement=function(a){var b;return null!=a.getAttribute("src")&&this._isNotTransparentSrc(a)?a.getAttribute("src"):(b=a.style.backgroundImage,b.replace("url(","").replace(")","").replace(new RegExp('"',"g"),""))},a.prototype._isNotTransparentSrc=function(a){var b;return b=a.getAttribute("src"),b!==this.config.TRANSPARENT_IMAGE},a.prototype._createAvatarImage=function(a){var c,d,e;return null!=(e=this.document.getElementById(b))&&e.remove(),c=this.document.createElement("img"),c.setAttribute("id",b),d=this._imageURLFromDragElement(a),c.src=d,c},a.prototype._tryGetComputedStyle=function(a){try{return getComputedStyle(a)}catch(a){}return{}},a.prototype._setAvatarImageStyleWebkit=function(a,b){var c,d,e,f,g,h,i;g=b.getBoundingClientRect(),c=this._tryGetComputedStyle(b),h="width: "+g.width/2+"px; height: "+g.height/2+"px; position: absolute; ",d={webkitFilter:"-webkit-filter",filter:"filter"};for(f in d)e=d[f],i=null!=c?c[f]:void 0,null!=i&&""!==i&&(h+=""+e+": "+i+"; ");return a.setAttribute("style",h)},a.prototype._setAvatarImageStyleFirefox=function(a,b){var c;return c=b.getBoundingClientRect(),a.style.width=""+c.width/2+"px",a.style.height=""+c.height/2+"px",a.style.position="absolute"},a.prototype._insertOnPage=function(a){return this.document.body.insertBefore(a,this.document.body.children[0])},a.prototype._hasValidDragData=function(a,b){var c,d;return null!=b&&((null!=a&&null!=(c=a.style)&&null!=(d=c.backgroundImage)?d.length:void 0)>1||null!=(null!=a&&"function"==typeof a.getAttribute?a.getAttribute("src"):void 0))},a}(),a.$inject=["$window","deviceData","CONFIG"],angular.module("galleon").service("dragAvatarProducer",a)}.call(this),function(){angular.module("galleon-pb").value("productTrackingStrategy",{productizePageName:function(a){return null!=a?a.replace(new RegExp("@@p","g"),"pbPath"):void 0},productizeTemplateDirectory:function(a){return"pb"},displayMode:function(a){switch(a){case"customPath":return"Galleon Custom Path";case"simplePath":return"Galleon Simple Path";case"superSimple":return"Galleon Super Simple";default:return"Galleon"}}})}.call(this),function(){angular.module("galleon-gc").value("productTrackingStrategy",{productizePageName:function(a){return null!=a?a.replace(new RegExp("@@p","g"),"calPath"):void 0},productizeTemplateDirectory:function(a){return"gc"},displayMode:function(a){return"cal-Galleon"}})}.call(this),function(){angular.module("galleon-ss").value("productTrackingStrategy",{productizePageName:function(a){return null!=a?a.replace(new RegExp("@@p","g"),"pbPath"):void 0},productizeTemplateDirectory:function(a){return"ss"},displayMode:function(a){switch(a){case"customPath":return"Galleon Custom Path";case"simplePath":return"Galleon Simple Path";case"superSimple":return"Galleon Super Simple";default:return"Galleon"}}})}.call(this),function(){var a;a=function(){function a(a,b){this.enums=a,this.projectService=b}return a.prototype.canAssetServeAsDropProxy=function(a,b){return!1},a.prototype.canAssetHaveDropProxy=function(a,b){return!1},a.prototype.relatedDropProxyClass=function(a,b){return""},a.prototype.getDropProxyAsset=function(a,b){return null},a}(),a.$inject=["enums","projectService"],angular.module("galleon-pb").service("dropProxyHelper",a)}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c){this.enums=a,this.projectService=c,this.getDropProxyAsset=b(this.getDropProxyAsset,this),this.relatedDropProxyClass=b(this.relatedDropProxyClass,this),this.canAssetHaveDropProxy=b(this.canAssetHaveDropProxy,this),this.canAssetServeAsDropProxy=b(this.canAssetServeAsDropProxy,this)}return a.prototype.canAssetServeAsDropProxy=function(a,b){return!(!this.projectService.currentProject.product.isGridPage(b.surfaceNumber)||a.asset.assetType!==this.enums.AssetType.IMAGE_TYPE)},a.prototype.canAssetHaveDropProxy=function(a,b){return!(!this.projectService.currentProject.product.isGridPage(b.surfaceNumber)||a.asset.assetType!==this.enums.AssetType.TEXT_TYPE||!a.isEventTextAsset)},a.prototype.relatedDropProxyClass=function(a,b){var c,d;try{return this.canAssetHaveDropProxy(a,b)?d="image-proxy-class--"+a.associatedImage:""}catch(a){return c=a,""}},a.prototype.getDropProxyAsset=function(a,b){var c,d,e;return d=this.projectService.currentProject.product,c=d.pageBySurfaceNumber(b),e=null,this.canAssetHaveDropProxy(a,c)&&(e=d.getImageAssetByUniqueProjectRef(a.associatedImage,c)),e},a}(),a.$inject=["enums","projectService"],angular.module("galleon-gc").service("dropProxyHelper",a)}.call(this),function(){var a;a=function(){function a(a,b){this.enums=a,this.projectService=b}return a.prototype.canAssetServeAsDropProxy=function(a,b){return!1},a.prototype.canAssetHaveDropProxy=function(a,b){return!1},a.prototype.relatedDropProxyClass=function(a,b){return""},a.prototype.getDropProxyAsset=function(a,b){return null},a}(),a.$inject=["enums","projectService"],angular.module("galleon-ss").service("dropProxyHelper",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f){this.$window=a,this.projectService=c,this.deviceDetectionService=d,this.productTrackingStrategy=e,this.userService=f,this.defaultPageName="@@p",this.currentAppMode="",this.firstTimeLoadPage=!0,this.logger=b.newInstance("OmnitureService"),this.addPagesTrackedOnce=[],this.cachedReportingStage={},this.hasCachedReportingStage=!1,this.deviceDetectionService.isDeviceAPhone()?(this.devicePrefixForName="m:",this.defaultPageName=this.devicePrefixForName+"/"+this.defaultPageName):this.deviceDetectionService.isDeviceATablet()?(this.devicePrefixForName="t:",this.defaultPageName=this.devicePrefixForName+"/"+this.defaultPageName):this.devicePrefixForName="",this.CHANGE_STYLE_LINK_NAME="Change Style",this.COVER_TYPE_LINK_NAME_PREFIX="CoverType:",this.EDIT_PAGE_NAME="/@@p/edit",this.BOOK_PAGE_NAME="/@@p/book",this.CHANGE_STYLE_PAGE_NAME="/@@p/styleChanger",this.UPSELL_PAGE_NAME_PREFIX="/@@p/Upsell - ",this.INITIAL_ADD_PHOTO_PROMPT_PAGE_NAME="/@@p/Add Photos - Dialog",this.EDIT_TEXT_BOX_PAGE_NAME=this.devicePrefixForName+"/@@p/Edit text",this.PB_PREVIEW_PAGE_NAME=this.devicePrefixForName+"/@@p/Preview",this.SELECT_COVER_PAGE_NAME=this.devicePrefixForName+"/@@p/Select cover",this.ARRANGE_PAGE_NAME=this.devicePrefixForName+"/@@p/arrange",this.UPP_PAGE_NAME=this.devicePrefixForName+"/picturepicker/",this.ADVANCED_EDIT_PAGE_NAME="/@@p/AdvancedEdit",this.EXT_PALETTE_PAGE_NAME=this.devicePrefixForName+"/@@p/Extended Palette",this.STORYBOARD_PAGE_NAME=this.devicePrefixForName+"/@@p/Storyboard",this.SHARE_DIALOG_PAGE_NAME=this.devicePrefixForName+"/@@p/Share",this.KEEP_AUTOFILL_DIALOG_PAGE_NAME=this.devicePrefixForName+"/@@p/KeepAutofill",this.INTRO_TOUR_START_PAGE_NAME="/@@p/tour-start",this.INTRO_TOUR_LAYOUTS_PAGE_NAME="/@@p/tour-layouts",this.INTRO_TOUR_EMBELLISHMENTS_PAGE_NAME="/@@p/tour-embellishments",this.INTRO_TOUR_UNDO_PAGE_NAME="/@@p/tour-undo",this.INTRO_TOUR_EDIT_PAGE_NAME="/@@p/tour-edit",this.INTRO_TOUR_STORYBOARD_PAGE_NAME="/@@p/tour-storyboard",this.INTRO_TOUR_NAME_PAGE_NAME="/@@p/tour-name",this.INTRO_TOUR_HIGHLIGHTS_PAGE_NAME="/@@p/tour-highlights",this.INTRO_TOUR_PHOTOS_PAGE_NAME="/@@p/tour-photos",this.INTRO_TOUR_BOOK_PAGE_NAME="/@@p/tour-book",this.INTRO_TOUR_ORDER_PAGE_NAME="/@@p/tour-order",this.TAB_LINK_NAMES={images:"Tab:Photos",pages:"Tab:Pages",layouts:"Tab:Layouts",backgrounds:"Tab:Backgrounds",ideaPages:"Tab:IdeaPages",embellishments:"Tab:Embellishments"}}var b,c,d,e,f,g,h;return a.GALLEON_CUSTOM_PATH="customPath",a.GALLEON_SIMPLE_PATH="simplePath",a.GALLEON_SUPER_SIMPLE="superSimple",g={key:"event11",name:"projStart"},f={key:"event13",name:"projOpen"},e={key:"event2",name:"login"},h={key:"event3",name:"register"},c={key:"event25",name:"event25"},d={key:"event24",name:"event24"},b="Add Pages",a.prototype.pageOptionToSku={layflat:"Layflat",hinged:"Hinged",glossy:"Glossy",looseleaf:"Standard"},a.prototype.bookOptionCoverSku=function(a,b){var c;return c=this.pageOptionToSku[b],"BookOption_Cover_PB_"+a.omnitureProductName+"_"+c},a.prototype.backupReportingPageName=function(){var a;return this.hasCachedReportingStage=!0,this.$window.s?(a=this.$window.s,this.cachedReportingStage.pageName=this.productTrackingStrategy.productizePageName(a.pageName)):void this.logger.warn("window.s not defined")},a.prototype.getSavedReportingPageName=function(){var a;return this.hasCachedReportingStage?(this.hasCachedReportingStage=!1,this.$window.s?(a=this.$window.s,this.cachedReportingStage.pageName):(this.logger.warn("window.s not defined"),this.defaultPageName)):null},a.prototype.getPathName=function(){return this.productTrackingStrategy.displayMode(this.currentAppMode)},a.prototype.trackPageName=function(a){var b,c,d,e,f,g,h;if(h=null!=a?a:{},e=h.pageName,f=h.product,c=h.event,!this.$window.s)return void this.logger.warn("window.s not defined");g=this.$window.s,this._reset(g),e||(e=this.defaultPageName),e=this.productTrackingStrategy.productizePageName(e),g.prop42=this.getPathName(),g.pageName=e,g.prop8=e,null!=(d=this.userService.isUserMigrated())&&(g.prop44=this._migratedTrackingValue(e,d)),null!=f&&(g.product=";"+f+";;;"),null!=c&&(g.events=c.key);try{if(g.tl(),this.$window.scw)return this.$window.scw.pageName=e}catch(a){return b=a,this.logger.warn("Could not track page change to "+e)}},a.prototype.trackLink=function(a){var b,c,d,e,f,g,h,i,j,k;if(j=null!=a?a:{},d=j.linkName,g=j.pageName,h=j.product,c=j.event,!this.$window.s)return void this.logger.warn("window.s not defined");if(i=this.$window.s,this._reset(i),null!=d&&this.shouldTrackLink(d)){g=null!=(k=null!=g?g:i.pageName)?k:this.defaultPageName,g=this.productTrackingStrategy.productizePageName(g),e=g+" | "+d,i.pageName=g,i.prop12=g,i.prop13=d,i.prop14=e,i.eVar39=g,i.eVar40=d,i.eVar41=e,null!=(f=this.userService.isUserMigrated())&&(i.eVar67=this._migratedTrackingValue(g,f)),null!=h&&(i.product=";"+h+";;;"),null!=c&&(i.events=c.key);try{return i.tl()}catch(a){return b=a,this.logger.warn("Could not track omniture link "+e)}}},a.prototype._migratedTrackingValue=function(a,b){return b===!0?""+a+" | migrated":""+a+" | nonmigrated"},a.prototype.trackProjectSave=function(){var a;if(a=this._getProductSku(),a&&"function"==typeof this.$window.trackProjectSaveEvent)return this.$window.trackProjectSaveEvent(";"+a+";;;;")},a.prototype.trackProjectStart=function(){var a;if(a=this._getProductSku())return this._trackEvent(g,a)},a.prototype.trackProjectOpen=function(){var a;if(a=this._getProductSku())return this._trackEvent(f,a)},a.prototype.trackLogin=function(){return this._trackEvent(e)},a.prototype.trackSignUp=function(){return this._trackEvent(h)},a.prototype.trackBookOptionsSelection=function(a,b){var d;return d=this.bookOptionCoverSku(a,b),this.trackLink({linkName:d,product:d,pageName:this.BOOK_PAGE_NAME,event:c})},a.prototype.trackUpsellImpression=function(a){return this.trackPageName({pageName:this.UPSELL_PAGE_NAME_PREFIX+a.omnitureName,product:a.omnitureSku,event:d})},a.prototype.trackUpsellOptionResponse=function(a,b){return this.trackLink({pageName:this.UPSELL_PAGE_NAME_PREFIX+b.omnitureName,product:b.omnitureSku,linkName:a,event:c})},a.prototype._getProductSku=function(){var a,b;return null!=(a=this.projectService.currentProject)&&null!=(b=a.product)?b.sku:void 0},a.prototype._trackEvent=function(a,b){var c,d,e,f;if(!this.$window.s)return void this.logger.warn("window.s not defined");f=this.$window.s,e=f.pageName||this.defaultPageName,e=this.productTrackingStrategy.productizePageName(e),this._reset(f),null!=(null!=a?a.key:void 0)&&(f.events=a.key),null!=(null!=a?a.name:void 0)&&(f.prop8=e+":"+a.name),null!=b&&(f.products=";"+b+";;;;"),null!=(d=this.userService.isUserMigrated())&&(f.prop44=this._migratedTrackingValue(e,d));try{return f.t()}catch(b){return c=b,this.logger.warn("Could not track project event "+a)}},a.prototype.shouldTrackLink=function(a){return a.indexOf(b)===-1||!this.addPagesTrackedOnce[a]&&(this.addPagesTrackedOnce[a]=!0,!0)},a.prototype._reset=function(a){return delete a.prop12,delete a.prop13,delete a.prop14,delete a.eVar39,delete a.eVar40,delete a.eVar41,delete a.eVar67,delete a.prop42,delete a.prop44,delete a.prop8,delete a.product,a.events="",a.products=""},a}(),a.$inject=["$window","loggerFactory","projectService","deviceDetectionService","productTrackingStrategy","userService"],angular.module("silverApp").service("omnitureService",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e){this.config=a,this.projectService=c,this.$modal=d,this.removePageOperation=e,this.removePage=b(this.removePage,this)}return a.prototype.removePage=function(a){return this.project=this.projectService.currentProject,this.numOfPagesToRemove=a.isSpread()?2:1,this.project.product.pages.length<=parseInt(this.config.defaults.minPages,10)?(this.modalInstance=this._openRemovePageModal(a),this.modalInstance.result.then(function(b){return function(){return b.removePageOperation.remove(a.surfaceNumber,b.numOfPagesToRemove)}}(this))):this.removePageOperation.remove(a.surfaceNumber,this.numOfPagesToRemove)},a.prototype._openRemovePageModal=function(a){return this.$modal.open({templateUrl:"SilverApp/views/remove-page-modal.html",backdrop:"static",controller:"RemovePageModalCtrl",resolve:{data:function(b){return function(){return{pageToRemove:a.surfaceNumber,limit:b.config.defaults.minPages,numOfPagesToRemove:b.numOfPagesToRemove}}}(this)}})},a.prototype.dismiss=function(){return this.modalInstance.dismiss()},a.prototype.done=function(){return this.modalInstance.dismiss()},a}(),a.$inject=["CONFIG","projectService","$modal","removePageOperation"],angular.module("silverApp").service("removePageService",a)}.call(this),function(){var a;a=function(){function a(a,b,c){this.$routeParams=a,this.projectService=b,this.docsmithConversionService=c,this.COVERMAP={USER_CUSTOM_SOFT:"_bk_soft",USER_CUSTOM:"_bk_hard",STOCK_LEATHER:"_bk_leather",STOCK_CLOTH:"_bk_cloth",STOCK_CROCODILE:"_bk_crocodile",STOCK_PREMIUM:"_bk_premiumleather"}}var b,c,d;return c="sourceSku",d="targetSku",b="rule",a.prototype._hasSizeChanged=function(){return this.$routeParams.toSize&&this.$routeParams.toSize!==this.projectService.currentProject.product.sizeId},a.prototype._hasCoverChanged=function(){var a,b,c,d,e,f;return f=this.$routeParams.toFinish||"none",c=this.projectService.currentProject.product.finish||"none",a=this.$routeParams.toCover,b=this.projectService.currentProject.product.cover.coverSpecID,d=a&&this.COVERMAP[a]&&b.indexOf(this.COVERMAP[a])===-1,e=f.toLowerCase()!==c.toLowerCase(),d||e},a.prototype.changeProject=function(){var a,b,c,d,e;if(this._resetProjectGuid(),this._setCrossSellReportingData(),this._hasSizeChanged()||this._hasCoverChanged())return d=(this.$routeParams.toFinish||"none").toLowerCase(),e=this.$routeParams.toSize,c=this.$routeParams.toCover,b={},a={},this._hasSizeChanged()&&(b.bookSize=e),this._hasCoverChanged()&&(b.coverType=c,b.finish=d),this._hasSizeChanged()&&this._hasCoverChanged()&&(a.postConversion={warning:{id:"postChangeSize"}}),this.docsmithConversionService.start(this.projectService.currentProject,b,a)},a.prototype._setCrossSellReportingData=function(){return this.projectService.currentProject.setInitalReportingValue(c,this.$routeParams.sourceSku),this.projectService.currentProject.setInitalReportingValue(d,this.$routeParams.targetSku),this.projectService.currentProject.setInitalReportingValue(b,this.$routeParams.rule)},a.prototype._resetProjectGuid=function(){return this.projectService.currentProject.projectGUID=null,this.projectService.currentProject.product.guid=null},a}(),a.$inject=["$routeParams","projectService","docsmithConversionService"],angular.module("galleon").service("crossSellService",a)}.call(this),function(){var a;a=function(){function a(a){this.enums=a,this.OPTION_HARD_COVER=this.enums.ProductFeature.HARD_PHOTO_COVER,this.OPTION_MATTE_FINISH=this.enums.ProductFeature.MATTE_COVER,this.OPTION_DUST_JACKET=this.enums.ProductFeature.DUST_JACKET,this.OPTION_LAYFLAT_BINDING=this.enums.ProductFeature.LAYFLAT,this.OPTION_HINGED_LAYFLAT_BINDING=this.enums.ProductFeature.HINGED_LAYFLAT,this.OPTION_GLOSSY_PAPER=this.enums.ProductFeature.GLOSSY_PAGES,this.OPTION_KEEPSAKE_POCKET=this.enums.ProductFeature.KEEPSAKE_POCKET,this.OPTIONS=[this.OPTION_HARD_COVER,this.OPTION_MATTE_FINISH,this.OPTION_DUST_JACKET,this.OPTION_LAYFLAT_BINDING,this.OPTION_HINGED_LAYFLAT_BINDING,this.OPTION_GLOSSY_PAPER,this.OPTION_KEEPSAKE_POCKET]}return a.prototype.hardCover={omnitureName:"Hard Photo Cover",omnitureSku:"Upsell_PB_Cover_Hard"},a.prototype.matteFinish={omnitureName:"Matte Photo Cover",omnitureSku:"Upsell_PB_Cover_Matte"},a.prototype.dustJacket={omnitureName:"Dust Jacket",omnitureSku:"Upsell_PB_Cover_DustJacket"},a.prototype.layflat={omnitureName:"Layflat Pages",omnitureSku:"Upsell_PB_Page_Layflat"},a.prototype.hinged={omnitureName:"HingedLayflat Pages",omnitureSku:"Upsell_PB_Page_HingedLayflat"},a.prototype.glossyPaper={omnitureName:"Glossy Pages",omnitureSku:"Upsell_PB_Page_Glossy"},a.prototype.keepsakePocket={omnitureName:"Keepsake Pocket",omnitureSku:"Upsell_PB_Accesory_MemorabiliaPocket"},a}(),a.$inject=["enums"],angular.module("silverApp").service("upsellOptions",a)}.call(this),function(){"use strict";var a,b=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};a=function(){function a(a,b){this.config=a,this.upsellOptions=b}return a.UPSELL_APPLICABLE_SIZES=["8x8","8x11","10x10","11x14","12x12"],a.prototype.isUpsellApplicable=function(c){var d;return d=c.sizeId,b.call(a.UPSELL_APPLICABLE_SIZES,d)>=0},a.prototype.isHardCoverApplicable=function(a,b){return!this._isHardCoverAppliedOrPending(a,b)&&a.cover.isSoftCover()},a.prototype._isHardCoverAppliedOrPending=function(a,c){var d;return a.cover.isHardCover()||(d=this.upsellOptions.OPTION_HARD_COVER,b.call(c,d)>=0)},a.prototype._isHardCoverChangePending=function(a){var c;return c=this.upsellOptions.OPTION_HARD_COVER,b.call(a,c)>=0},a.prototype._isLayflatChangePending=function(a){var c;return c=this.upsellOptions.OPTION_LAYFLAT_BINDING,b.call(a,c)>=0},a.prototype._isHingedLayflatChangePending=function(a){var c;return c=this.upsellOptions.OPTION_HINGED_LAYFLAT_BINDING,b.call(a,c)>=0},a.prototype.isMatteFinishApplicable=function(a,b){return(a.isMatteFinishApplicable()||this._isHardCoverChangePending(b))&&!a.hasPaddedFinish()},a.prototype.isDustjacketApplicable=function(a,b){return a.isDustJacketApplicable()||this._isHardCoverChangePending(b)},a.prototype.isLayflatApplicable=function(a,b){var c;return c=a.cover.isHardCover()||this._isHardCoverChangePending(b),c&&!a.cover.hasLayflatBinding()},a.prototype.isHignedLayflatApplicable=function(a,b){var c,d;return c=a.cover.isHardCover()||this._isHardCoverChangePending(b),d="11x14"!==a.sizeId,c&&!(a.cover.hasHingedLayflatBinding()||a.cover.hasLayflatBinding()||this._isLayflatChangePending(b))&&this.config.features.upsell_hingedLayflat&&d},a.prototype.isGlossyPaperApplicable=function(a,b){return(a.isGlossyPageFinishApplicable()||this._isHardCoverChangePending(b))&&!(this._isLayflatChangePending(b)||this._isHingedLayflatChangePending(b)||a.hasGlossyPages())},a.prototype.isKeepsakePocketApplicable=function(a,b){return a.isKeepsakePocketApplicable()||this._isHardCoverChangePending(b)},a}(),a.$inject=["CONFIG","upsellOptions"],angular.module("silverApp").service("upsellRules",a)}.call(this),function(){"use strict";var a,b,c,d=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};b=function(){function a(){this.evaluated=[],this.chosen=[],this.dismissed=[]}return a.prototype.wasOptionEvaluated=function(a){return d.call(this.evaluated,a)>=0},a.prototype.wasOptionChosenOrDismissed=function(a){return d.call(this.chosen,a)>=0||d.call(this.dismissed,a)>=0},a.prototype.setEvaluated=function(a){return this.evaluated.push(a)},a.prototype.setChosen=function(a){return this.chosen.push(a)},a.prototype.anyChosen=function(){return this.chosen.length>0},a.prototype.setDismissed=function(a){return this.dismissed.push(a)},a.prototype.hasEvaluatedDependencies=function(a){var b,c,d;for(c=0,d=a.length;c<d;c++)if(b=a[c],!this.wasOptionEvaluated(b))return!1;return!0},a}(),c=function(){function c(a,b,c,d,e,f){var g,h,i,j,k,l;for(this.config=a,this.projectService=b,this.enums=c,this.upsellRules=d,this.upsellOptions=e,this.conversionService=f,this.optionEnabled={},k=this.upsellOptions.OPTIONS,i=0,j=k.length;i<j;i++)h=k[i],g=this.config.features[h]===!0&&(null==(l=this.config.features["upsell_"+h])||l)===!0,this.optionEnabled[h]=g}return c.prototype._getBook=function(){return this.projectService.currentProject.product},c.prototype.hasUpsell=function(){return null!=this.nextAvailableOption(this.startProgress())},c.prototype.isUpsellEnabled=function(){return this.config.features.upsell===!0},c.prototype.isOptionEnabled=function(a){var b;return b=function(a){return function(b){return null==a.config.features[b]||a.config.features[b]===!0}}(this),b(a)&&b("upsell_"+a)},c.prototype.startProgress=function(){return new b},c.prototype.nextAvailableOption=function(a){var b,c,d,e;if(!this.isUpsellEnabled()||!this.upsellRules.isUpsellApplicable(this._getBook()))return null;for(e=this.upsellOptions.OPTIONS,c=0,d=e.length;c<d;c++)if(b=e[c],!a.wasOptionEvaluated(b)){if(this.isOptionEnabled(b)&&!a.wasOptionChosenOrDismissed(b)&&this._isOptionApplicable(b,a))return a.setEvaluated(b),b;a.setEvaluated(b)}return null},c.prototype._isOptionApplicable=function(a,b){switch(a){case this.upsellOptions.OPTION_HARD_COVER:return this.upsellRules.isHardCoverApplicable(this._getBook(),b.chosen);case this.upsellOptions.OPTION_MATTE_FINISH:return this.upsellRules.isMatteFinishApplicable(this._getBook(),b.chosen);case this.upsellOptions.OPTION_DUST_JACKET:return this._isDustjacketApplicable(b);case this.upsellOptions.OPTION_LAYFLAT_BINDING:return this._isLayflatApplicable(b);case this.upsellOptions.OPTION_HINGED_LAYFLAT_BINDING:return this._isHingedlayflatApplicable(b);case this.upsellOptions.OPTION_GLOSSY_PAPER:return this._isGlossyPaperApplicable(b);case this.upsellOptions.OPTION_KEEPSAKE_POCKET:return this._isKeepsakePocketApplicable(b)}return!1},c.prototype._isDustjacketApplicable=function(a){var b;return b=[this.upsellOptions.OPTION_MATTE_FINISH],a.hasEvaluatedDependencies(b)&&this.upsellRules.isDustjacketApplicable(this._getBook(),a.chosen)},c.prototype._isLayflatApplicable=function(a){var b;return b=[this.upsellOptions.OPTION_DUST_JACKET],a.hasEvaluatedDependencies(b)&&this.upsellRules.isLayflatApplicable(this._getBook(),a.chosen)},c.prototype._isHingedlayflatApplicable=function(a){var b;return b=[this.upsellOptions.OPTION_LAYFLAT_BINDING],a.hasEvaluatedDependencies(b)&&this.upsellRules.isHignedLayflatApplicable(this._getBook(),a.chosen)},c.prototype._isGlossyPaperApplicable=function(a){var b;return b=this.config.features.upsell_hingedLayflat?[this.upsellOptions.OPTION_HINGED_LAYFLAT_BINDING]:[this.upsellOptions.OPTION_LAYFLAT_BINDING],a.hasEvaluatedDependencies(b)&&this.upsellRules.isGlossyPaperApplicable(this._getBook(),a.chosen)},c.prototype._isKeepsakePocketApplicable=function(a){var b;return b=[this.upsellOptions.OPTION_MATTE_FINISH,this.upsellOptions.OPTION_DUST_JACKET,this.upsellOptions.OPTION_LAYFLAT_BINDING,this.upsellOptions.OPTION_HINGED_LAYFLAT_BINDING,this.upsellOptions.OPTION_GLOSSY_PAPER],a.hasEvaluatedDependencies(b)&&this.upsellRules.isKeepsakePocketApplicable(this._getBook(),a.chosen)},c.prototype.applyOptions=function(b){var c;return c=a.create(b,this._getBook(),this.upsellOptions,this.enums),this.conversionService.start(this.projectService.currentProject,c)},c.prototype.getUpsellPriceFromResponse=function(a,b){var c,d;return d=function(a){var c,d,e,f;for(f=b.pricing.component,d=0,e=f.length;d<e;d++)if(c=f[d],a(c))return c;return null},c=function(){switch(a){case this.upsellOptions.OPTION_HARD_COVER:return d(function(a){return/_COVER/.test(a.productType)});case this.upsellOptions.OPTION_MATTE_FINISH:return d(function(a){return/MATTE_FINISH/.test(a.sku)});case this.upsellOptions.OPTION_DUST_JACKET:return d(function(a){return/_DUSTJACKET/.test(a.productType)});case this.upsellOptions.OPTION_LAYFLAT_BINDING:return d(function(a){return/_LF$/.test(a.sku)});case this.upsellOptions.OPTION_HINGED_LAYFLAT_BINDING:return d(function(a){return/_HINGED$/.test(a.sku)});case this.upsellOptions.OPTION_KEEPSAKE_POCKET:return d(function(a){return/MEMPOCKET/.test(a.productType)});case this.upsellOptions.OPTION_GLOSSY_PAPER:return d(function(a){return/GLOSSY_FINISH/.test(a.sku)})}}.call(this)},c}(),a=function(){function a(){}return a.create=function(b,c,d,e){var f,g,h,i;for(g={coverType:c.cover.getCoverType()},h=0,i=b.length;h<i;h++)f=b[h],a.addOption(f,g,c,d,e);return g},a.addOption=function(a,b,c,d,e){switch(a){case d.OPTION_HARD_COVER:b.coverType=c.cover.constructor.COVER_TYPE_USER_CUSTOM;break;case d.OPTION_MATTE_FINISH:b.finish=e.Finish.MATTE;break;case d.OPTION_DUST_JACKET:b.dustJacket=!0;break;case d.OPTION_KEEPSAKE_POCKET:b.keepsakePocket=!0;break;case d.OPTION_GLOSSY_PAPER:b.glossyPages=!0;break;case d.OPTION_LAYFLAT_BINDING:b.binding="layflat";break;case d.OPTION_HINGED_LAYFLAT_BINDING:b.binding="hinged"}return b},a}(),c.$inject=["CONFIG","projectService","enums","upsellRules","upsellOptions","docsmithConversionService"],angular.module("silverApp").service("upsellService",c)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f){this.$http=a,this.userService=b,this.projectService=c,this.config=d,this.$q=e,this.logger=f.newInstance("ShareService")}return a.prototype.emailShare=function(a,b,c){var d;return d=this.$q.defer(),c=encodeURIComponent(c),b=encodeURIComponent(b),this.userService.userInfo().then(function(e){return function(f){return a+=","+f.email,a=encodeURIComponent(a),e.$http({method:"POST",url:""+e.config.shareService+"/project/"+f.id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"emails="+a+"&projectGUID="+e.projectService.currentProject.projectGUID+"&subject="+b+"&message="+c+"&source=Galleon",transformResponse:function(a){return a}}).success(function(a,b,c,e){return d.resolve(a)}).error(function(a,b,c,f){return e.logger.warn("email share failed|"+a),d.reject(a)})}}(this)),d.promise},a.prototype.webLinkShare=function(a,b){
var c;return c=this.$q.defer(),b=encodeURIComponent(b),a=encodeURIComponent(a),this.userService.userInfo().then(function(d){return function(e){return d.$http({method:"POST",url:""+d.config.shareService+"/project/"+e.id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"emails=&projectGUID="+d.projectService.currentProject.projectGUID+"&subject="+a+"&message="+b+"&source=Galleon&destination=other",transformResponse:function(a){return a}}).success(function(a,b,d,e){return c.resolve(a)}).error(function(a,b,e,f){return d.logger.warn("web share failed|"+a),c.reject(b)})}}(this)),c.promise},a}(),a.$inject=["$http","userService","projectService","CONFIG","$q","loggerFactory"],angular.module("silverApp").service("shareService",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.$modal=a,this.localStorageService=b}return a.prototype.open=function(a,b,c){var d;if(!this.modalInstance&&!this.localStorageService.get(b))return d=a.$new(!0),d.state=c,null==c.showLink&&(c.showLink=!1),null==c.btnKey&&(c.btnKey="SilverApp.getStarted"),this.modalInstance=this.$modal.open({scope:d,backdrop:"static",templateUrl:"SilverApp/views/tab-intro-modal.html"}),this.modalInstance.result.finally(function(a){return function(){return a.modalInstance=null,d.state.doNotShowAgain&&a.localStorageService.set(b,!0),d.$destroy()}}(this)),this.modalInstance.result},a}(),a.$inject="$modal localStorageService".split(" "),angular.module("galleon").service("tabIntroModalService",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g){this.$http=a,this.config=c,this.userService=d,this.$q=g,this._handleProjectLoad=b(this._handleProjectLoad,this),this.logger=f.newInstance("ProjectEventService"),e.subscribe(e.events.PROJECT_LOADED,this._handleProjectLoad)}return a.prototype._handleProjectLoad=function(a,b){return this.project=b},a.prototype.reportEmailShare=function(){return this._reportShare("Project shared in Galleon via email","Email")},a.prototype.reportFacebookShare=function(){return this._reportShare("Project shared in Galleon to Facebook","Post","Facebook")},a.prototype.reportPinterestShare=function(){return this._reportShare("Project shared in Galleon to Pinterest","Pin","Pinterest")},a.prototype._reportShare=function(a,b,c){var d;return d=this.$q.defer(),this.userService.userInfo().then(function(e){return function(f){var g;return g=e._baseEventData("SHARE",a,f),g.ProjectEvent.shareType=b,null!=c&&(g.ProjectEvent.shareDestination=c),e._sendReport(f,g,d)}}(this)),d.promise},a.prototype.reportOrder=function(){var a;return a=this.$q.defer(),this.userService.userInfo().then(function(b){return function(c){var d;return d="Project ordered in Galleon",b._sendReport(c,b._baseEventData("ORDER",d,c),a)}}(this)),a.promise},a.prototype.reportCreate=function(){var a;return a=this.$q.defer(),this.userService.userInfo().then(function(b){return function(c){var d;return d="Project created in Galleon",b._sendReport(c,b._baseEventData("CREATE",d,c),a)}}(this)),a.promise},a.prototype._sendReport=function(a,b,c){return a.isLoggedIn?this.$http({method:"POST",headers:{Accept:"text/plain","Content-Type":"text/plain;charset=UTF-8"},data:b,url:this._reportURL(a)}).success(function(a,b,d,e){return c.resolve({})}).error(function(a){return function(b,d,e,f){return c.resolve({}),a.logger.warn("Couldn't log project event data: "+d)}}(this)):void c.resolve({})},a.prototype._reportURL=function(a){return""+this.config.projectEventService+"/"+a.id+"/event?access_token="+a.oAuthToken},a.prototype._baseEventData=function(a,b,c){var d,e,f,g,h,i;return{ProjectEvent:{action:b,eventType:a,projectType:null!=(d=null!=(e=this.project)?e.type:void 0)?d:"PHOTOBOOK_30",appID:"GALLEON",userAgent:navigator.userAgent,projectSubType:null!=(f=null!=(g=this.project)&&null!=(h=g.product)?h.subtype:void 0)?f:"BOOKFORGE",projectGUID:null!=(i=this.project)?i.projectGUID:void 0,userID:null!=c?c.id:void 0,generated:""+Math.round((new Date).getTime()/1e3)}}},a}(),a.$inject=["$http","CONFIG","userService","eventBus","loggerFactory","$q"],angular.module("galleon").service("projectEventService",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h){this.eventBus=a,this.userService=c,this.imageCollection=d,this.config=f,this.$timeout=h,this._handleUppImageUploaded=b(this._handleUppImageUploaded,this),this._handleUppImageAdded=b(this._handleUppImageAdded,this),this.pcClient=new e.photoccino.PhotoccinoClient(this.config.photoccinoHost,this.config.photoccinoAPIKey),this.logger=g.newInstance("PhotoccinoService")}return a.RANKS={Best:1,Good:2,Other:3},a.prototype.subscribe=function(){return this.eventBus.subscribe(this.eventBus.events.UPP_IMAGE_FINISH,this._handleUppImageAdded),this.eventBus.subscribe(this.eventBus.events.SURFACE_IMAGE_UPDATED,this._handleUppImageUploaded),this.eventBus.subscribe(this.eventBus.events.UPP_UPLOAD_COMPLETED,this._handleUppImageUploaded)},a.prototype._handleUppImageAdded=function(a,b){var c,d;if(d=this._sflyImageData(b),d.length>0)return c=this._mapIdsToMspPathsFromUpp(b.detail.done),this._getPhotoRank(d,c)},a.prototype._handleUppImageUploaded=function(a,b){var c,d;if(d=this._uploadImageData(this.imageCollection.projectImages),a===this.eventBus.events.UPP_UPLOAD_COMPLETED&&d.length>0||a===this.eventBus.events.SURFACE_IMAGE_UPDATED&&d.length>=this.config.photoccinoGetRankBatchSize)return c=this._mapIdsToMspPathsFromUpload(this.imageCollection.projectImages),this._setPhotoRankInProgress(d,c),this._getPhotoRank(d,c)},a.prototype._setPhotoRankInProgress=function(a,b){var c,d,e,f,g;for(g=[],e=0,f=a.length;e<f;e++)c=a[e],d=this.imageCollection.getImageByImageId(b[c.id]),null==d&&this.logger.error("PhotoccinoService._setPhotoRankInProgress: oops got null image"),g.push(d.rankInProgress=!0);return g},a.prototype._filterRemainingImages=function(a,b){return a.filter(function(a){return b.indexOf(a.id)!==-1})},a.prototype._getPhotoRank=function(b,c){var d;return 0===Object.keys(c).length?void this.eventBus.publish(this.eventBus.events.PALETTE_THUMBNAILS_REFRESH):(this.eventBus.publish(this.eventBus.events.IMAGE_GETRANK_START),d=function(b){return function(d){var e,f,g,h,i,j,k,l,m;if(d.id=parseInt(d.id),f=c[d.id],null==f&&b.logger.error("PhotoccinoService._getPhotoRank: oops got null encodedMspId"),k=b.imageCollection.getImageByImageId(f),k&&(k.ranking=a.RANKS[d.type]||a.RANKS.Other,k.pHash=d.pHash,b.imageCollection.updateProjectImages(k.projectData),b.eventBus.publish(b.eventBus.events.PALETTE_IMAGE_RATED,k),b._hasDefaultCrop(k)&&Array.isArray(d.areaOfInterest)))return Array.isArray(d.facesAreaOfInterest)?(g=d.facesAreaOfInterest,h={llx:g[0],lly:1-g[1],urx:g[2],ury:1-g[3]},e=d.areaOfInterest,i=Math.max(h.llx,e[0]),j=Math.min(h.lly,e[1]),l=Math.min(h.urx,e[2]),m=Math.max(h.ury,e[3]),k.setSourceCrop(i,j,l,m)):void k.setSourceCrop.apply(k,d.areaOfInterest)}}(this),void this.userService.userInfo().then(function(a){return function(e){if(null!=e.id)return a.pcClient.getRank(e.id,b,e.oAuthToken).then(function(e,f){return null!=f?a.logger.warn(f.toError()):e.photos&&e.photos.forEach(d),a.eventBus.publish(a.eventBus.events.PALETTE_THUMBNAILS_REFRESH),(null!=e?e.inProcess:void 0)&&null!=e.inProcess.remainingTime&&e.inProcess.remainingTime!==-1?(b=a._filterRemainingImages(b,e.inProcess.photoIds),a.$timeout(function(){return a._getPhotoRank(b,c)},1e3*e.inProcess.remainingTime)):a.eventBus.publish(a.eventBus.events.IMAGE_GETRANK_DONE)})}}(this)))},a.prototype._sflyImageData=function(a){var b,c,d;return b=function(a){return"sfly"===a.source.id&&null!=a.data.id?{id:parseInt(a.data.id),url:a.data.url,origWidth:a.width,origHeight:a.height,dateTaken:a.date/1e3}:null},(null!=a&&null!=(c=a.detail)&&null!=(d=c.done)?d.length:void 0)>0?a.detail.done.map(b).filter(function(a){return null!=a}):[]},a.prototype._uploadImageData=function(a){var b;return b=function(a){return"SFLY_LIGHTBOX"===a.Xorigin||a.rankInProgress||0!==a.ranking||null==a.sflyId?null:{id:parseInt(a.sflyId),url:a.photoccinoImageURL,origWidth:a.Xwidth,origHeight:a.Xheight,dateTaken:a.captureDate/1e3}},a.length>0?a.map(b).filter(function(a){return null!=a}):[]},a.prototype._mapIdsToMspPathsFromUpp=function(a){var b,c,d,e,f,g;for(c={},d=0,e=a.length;d<e;d++)b=a[d],"sfly"===b.source.id&&null!=(null!=(f=b.data)&&null!=(g=f.view_efx)?g.encodedMspPath:void 0)&&(c[b.data.id]=b.data.view_efx.encodedMspPath);return c},a.prototype._mapIdsToMspPathsFromUpload=function(a){var b,c,d,e;for(c={},d=0,e=a.length;d<e;d++)b=a[d],c[b.sflyId]=b.imageId;return c},a.prototype._hasDefaultCrop=function(a){return 0===a.cropllx&&0===a.croplly&&1===a.cropurx&&1===a.cropury},a}(),a.$inject=["eventBus","userService","imageCollection","autofill","CONFIG","loggerFactory","$timeout"],angular.module("galleon").service("photoccinoService",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.config=a,this.$location=b}return a.prototype.redirect=function(a,b){var c;if(null==b&&(b=!1),a)return b?(c=this._getUrlParams(),this.$location.url(""+a+c)):this.$location.url(""+a)},a.prototype._getUrlParams=function(){var a,b,c;return(c=this.$location.url())&&c.match(/[\?]/i)?(a=new RegExp("[^?]+$"),b=a.exec(c),(null!=b?b.length:void 0)>0?"?"+b[0]:null):null},a}(),a.$inject=["CONFIG","$location"],angular.module("silverApp").service("redirectionService",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c){this.projectService=a,this.$timeout=c,this.touchCancelTimer=b(this.touchCancelTimer,this),this.touchEndElement=b(this.touchEndElement,this),this.touchEnd=b(this.touchEnd,this),this.touchMove=b(this.touchMove,this),this.startMove=b(this.startMove,this),this.hasTouch=!1,this.el=null,this.cloneModel={page:null,top:0,left:0,width:0,height:0,url:null},this.touchPos={top:0,left:0,x:0,y:0}}return a.prototype.isSameTarget=function(a){return a===this.cloneModel.surfaceNumber},a.prototype.isSameImage=function(a){return a===this.cloneModel.url},a.prototype.createPageClone=function(a,b){var c,d,e;return e=a.changedTouches[0],this.el=angular.element(e.target),d=this._getElementOffset(this.el),c=this.projectService.currentProject.product.pageBySurfaceNumber(b),this.cloneModel.page=c,this.cloneModel.top=d.top,this.cloneModel.left=d.left,this.cloneModel.surfaceNumber=b},a.prototype.createAssetClone=function(a,b){var c,d,e;if("image"===(null!=b&&null!=(e=b.asset)?e.assetType:void 0))return d=a.changedTouches[0],this.el=d.target,c=this.el.getBoundingClientRect(),this.cloneModel.url=this.el.src,this.cloneModel.width=.6*c.width,this.cloneModel.height=.6*c.height,this.cloneModel.top=d.clientY-this.cloneModel.height/2,this.cloneModel.left=d.clientX-this.cloneModel.width/2},a.prototype.startMove=function(a){var b;return a.preventDefault(),b=a.changedTouches[0],this.touchPos.top=this.cloneModel.top,this.touchPos.left=this.cloneModel.left,this.touchPos.x=b.clientX,this.touchPos.y=b.clientY},a.prototype.touchMove=function(a){var b;if(a.preventDefault(),this.el)return b=a.changedTouches[0],this.cloneModel.top=this.touchPos.top+b.clientY-this.touchPos.y,this.cloneModel.left=this.touchPos.left+b.clientX-this.touchPos.x,this.getTouchEventObject(a)},a.prototype.touchEnd=function(a){if(this.el)return this.cloneModel.page=null,this.cloneModel.top=0,this.cloneModel.left=0,this.cloneModel.width=0,this.cloneModel.height=0,this.cloneModel.url=null,this.getTouchEventObject(a)},a.prototype.touchEndElement=function(){return this.el.style.opacity="1.0"},a.prototype.touchCancelTimer=function(){if(null!=this.pressTimer)return this.$timeout.cancel(this.pressTimer),this.pressTimer=null},a.prototype.getTouchEventObject=function(a){var b;return b=a.changedTouches[0],{clientY:b.clientY,clientX:b.clientX,event:a}},a.prototype.isTouching=function(a,b){return a.clientX>=(null!=b?b.left:void 0)&&a.clientX<=(null!=b?b.right:void 0)&&a.clientY<=(null!=b?b.bottom:void 0)&&a.clientY>=(null!=b?b.top:void 0)},a.prototype._getElementOffset=function(a){return a.offset()},a}(),a.$inject=["projectService","$timeout"],angular.module("silverApp").service("touchService",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.web2PrintService=a,this.$q=b,this.commandService=c}return a.prototype.getUpdateableSettings=function(a){return angular.merge({},a.styles,{verticalAlign:a.verticalAlign})},a.prototype.cloneAssetWithNewStyles=function(a,b,c){var d;if(a)return null==c&&(c=a.editorContent),d=angular.copy(a),d.updateTextWithWrapsAndStyle(c,[],!1,b),d},a.prototype.commitTextChanges=function(a,b,c,d,e){var f,g,h,i,j;return c=angular.merge(this.getUpdateableSettings(b),c),f=this.$q.defer(),i=a.surfaceNumber,j=this._findPageAsset(a,b),g=j.pageAsset,h=j.pageAssetIndex,null==g||this._assetHasChanged(g,c,d)||null!=e?null==d||""+d.trim()==""?(this._executeUpdateText(i,h,[],!1,"",c,e),f.resolve()):this.web2PrintService.textMetadataForAsset(this.cloneAssetWithNewStyles(b,c,d),d).then(function(a){return function(b){return a._executeUpdateText(i,h,b.wraps,b.overflow,d,c,e),f.resolve()}}(this),function(a){return function(){return a._executeUpdateText(i,h,[],!1,d,c),f.resolve()}}(this)):f.resolve(),f.promise},a.prototype._findPageAsset=function(a,b){var c,d,e,f,g;for(g=a.layout.assets,c=e=0,f=g.length;e<f;c=++e)if(d=g[c],d.asset.containerId===b.asset.containerId)return{pageAsset:d,pageAssetIndex:c};return{pageAsset:null,pageAssetIndex:-1}},a.prototype._executeUpdateText=function(a,b,c,d,e,f,g){var h;return h={pageNumber:a,text:e,wraps:c,hasOverflow:d,style:f,assetIndex:b,toggleEventTextBackgroundFn:g},this.commandService.execute("UpdateTextCommand",h)},a.prototype._assetHasChanged=function(a,b,c){return a.editorContent!==c||!angular.equals(b,this.getUpdateableSettings(a))},a}(),a.$inject=["web2PrintService","$q","commandService"],angular.module("galleon").service("textUpdateService",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m){this.eventsService=a,this.calendar=b,this.calendarGrid=c,this.projectEvents=d,this.imageURLService=e,this.imageCollection=f,this.config=g,this.commandFactory=h,this.$q=i,this.userService=j,this.imageFactory=k,this.commandService=l,this.eventBus=m,this._nonImportedEventImages={},this.eventBus.subscribe(this.eventBus.events.CALENDAR_EVENT_IMAGE_DRAGGED,function(a){return function(b,c){return a._handleEventImageDrag(c.event,c.sflyId,c.productImageId)}}(this))}return a.prototype.maxNumberOfSelectedEventsPerDay=3,a.prototype._nonImportedEventImages={},a.prototype.getEventImageAsset=function(a){var b;return a?(b=this.getImageById(a.id),null!=b?b:this._nonImportedEventImages[a.id]||null):null},a.prototype.clearImportedEventCacheForEvent=function(a){if(this._nonImportedEventImages[a.id])return delete this._nonImportedEventImages[a.id]},a.prototype.removeEventPhotoAssignment=function(a){var b;return b=this.calendar.findSurfaceForDate(a.date),this.commandService.execute("ApplyEventImageCommand",{event:a,pageNumber:null!=b?b.surfaceNumber:void 0})},a.prototype.reassignUpdatedEventPhoto=function(a){var b,c;if(null!=a)return c=this.projectEvents.getImageAssociation(a.id),b=this.getActiveImageAssociationOnDate(a.year,a.month,a.day),(null!=c?c.active:void 0)?a.isSelected?this.setGridCellImage(a):this.reassignSelectedEventPhoto(a):c&&!b&&a.isSelected?(c.active=!0,this.reassignSelectedEventPhoto(a)):void 0},a.prototype.reassignSelectedEventPhoto=function(a){var b,c,d;d=this.eventsService.getSelectedEventsOnSameDay(a,!0),b=this.projectEvents.getImageAssociation(a.id),a.isSelected||(null!=b?b.active:void 0)&&!a.isSelected?(b&&(delete b.active,this.removeGridCellImage(a)),d.length>0&&d[0].isSelected&&(c=this.projectEvents.getImageAssociation(d[0].id),null!=c&&(c.active=!0),this.setGridCellImage(d[0]))):d.length<=0&&(null!=b&&(b.active=!0),this.setGridCellImage(a))},a.prototype.updateImageAssociationForEvent=function(a){var b;b=this.calendar.findSurfaceForDate(a.date),this.commandService.execute("UpdateEventImageCommand",{event:a,pageNumber:b.surfaceNumber})},a.prototype.getImageById=function(a){var b,c;return(c=this.projectEvents.getImageAssociation(a))&&(b=this.imageCollection.getImageByProductImageId(c.projectImageId),null!=b)?b:null},a.prototype.getEventImagesInformation=function(){var a,b;return this._eventImageInfo={},b=[],a=this.$q.defer(),this.userService.userInfo().then(function(c){return function(d){var e,f,g,h,i;for(i=c.eventsService.events,g=0,h=i.length;g<h;g++)e=i[g],c.eventsService.isEventPublic(e)||null==e.imageMediaId||(f=c._requestEventImageInfo(e,d),b.push(f));c.$q.all(b).then(function(b){return a.resolve(b)})}}(this)),a.promise},a.prototype.getActiveImageAssociationOnDate=function(a,b,c){var d,e,f,g,h,i;for(h=this.eventsService.events,f=0,g=h.length;f<g;f++)if(d=h[f],"custom"===d.visibility&&d.day===c&&d.month===b&&d.year===a&&(null!=(i=e=this.projectEvents.getImageAssociation(d.id))?i.active:void 0))return e;return null},a.prototype._requestEventImageInfo=function(a,b){var c;return c=this.eventsService.getEventImageInfo(a,b),c.then(function(b){return function(c){var d,e;return b._eventImageInfo[c.id]=c,e=b.imageURLService.getEventImageURL(c),d=b.imageFactory.newInstance({view:e}),b._nonImportedEventImages[a.id]=d}}(this)),c},a.prototype._getEventImageInfo=function(a){return(null!=a?a.imageMediaId:void 0)&&this._eventImageInfo[a.imageMediaId]?this._eventImageInfo[a.imageMediaId]:null},a.prototype.getDefaultEventImageThumb=function(a){var b,c;return a?(b=this.getImageById(a.id),(null!=b?b.thumbSrc:void 0)?b.thumbSrc:(c=this._getEventImageInfo(a),(null!=c?c.thumbnail:void 0)?c.thumbnail:null)):null},a.prototype._hasEventImageInProject=function(a){var b,c;return b=this.projectEvents.getImageAssociation(a.id),!!((null!=b?b.imageMediaId:void 0)&&(c=this.imageURLService.getParameterByName("imageId",this.getDefaultEventImageThumb(a)),this.imageCollection.getImageByImageId(c)))},a.prototype._importEventImage=function(a){var b,c,d;if(a&&(d=this._getEventImageInfo(a)))return c=this.imageURLService.getParameterByName("imageId",this.getDefaultEventImageThumb(a)),b={view:this.imageURLService.getEventImageURL(d)},this.imageCollection.addImage(b),this.imageCollection.getImageByImageId(c)},a.prototype.importDefaultEventImage=function(a){var b,c;if(a)return c=this.projectEvents.getImageAssociation(a.id),c&&!this._hasEventImageInProject(a)&&(b=this._importEventImage(a),null!=b)?(c.projectImageId=b.productImageID,this.projectEvents.updateImageAssociation(a.id,c),delete this._nonImportedEventImages[a.id]):void 0},a.prototype.setGridCellImage=function(a){var b,c,d,e,f,g,h;if(a&&(d=this.projectEvents.getImageAssociation(a.id),null!=d))return c=this.imageCollection.getImageByProductImageId(d.projectImageId),null!=c?(f=this.calendar.findSurfaceForDate(a.date),e=this.calendarGrid.findImageAreaForDate(a.date,f),g={source:{imageId:c.imageId,uniqueProjectRef:null!=e?e.uniqueProjectRef:void 0},pageNumber:f.surfaceNumber,target:{imageId:null!=e?e.imageId:void 0,uniqueProjectRef:null!=e?e.uniqueProjectRef:void 0}},this.config.virtualAssets&&null==e&&(h=this.calendarGrid.findVirtualImageAreaForDate(a.date,f),h&&(g.virtualTarget=h)),g.skipEventImageExecution=!0,b=this.commandFactory.getInstance("AddWellImageCommand",g),b.canUndo=!1,b.execute(f,g)):void 0},a.prototype.removeGridCellImage=function(a){var b,c,d,e;d=this.calendar.findSurfaceForDate(a.date),c=this.calendarGrid.findImageAreaForDate(a.date,d),d&&c&&c.imageId&&(e={imageId:c.imageId,uniqueProjectRef:c.uniqueProjectRef,pageNumber:d.surfaceNumber},b=this.commandFactory.getInstance("RemoveWellImageCommand",e),b.canUndo=!1,b.execute(d,e))},a.prototype._handleEventImageDrag=function(a,b,c){var d;return this.projectEvents.eventsMatchingEventDate(a).length>0?(d=this.calendar.findSurfaceForDate(a.date),this.commandService.execute("ApplyEventImageCommand",{event:a,imageMediaId:b,projectImageId:c,pageNumber:d.surfaceNumber})):this._updateEventImageAssociation(a,b,c)},a.prototype._updateEventImageAssociation=function(a,b,c){return a=angular.copy(a),a.imageMediaId=b,a.projectImageId=c,this.projectEvents.getImageAssociation(a.id)?this.projectEvents.updateImageAssociation(a.id,{imageMediaId:a.imageMediaId,imageView:a.imageView,projectImageId:a.projectImageId}):this.projectEvents.addImageAssociation(a.id,{imageMediaId:a.imageMediaId,imageView:a.imageView,projectImageId:a.projectImageId}),this.eventsService.updateEvent(a),this.eventBus.publish(this.eventBus.events.CALENDAR_EVENT_UPDATED,a)},a}(),a.$inject=["eventsService","calendar","calendarGrid","projectEvents","imageURLService","imageCollection","CONFIG","commandFactory","$q","userService","imageFactory","commandService","eventBus"],angular.module("galleon").service("calendarEventsImageService",a)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b,d,e,f,g,h,i,j,k,l,m,n,o,p){var q;this.eventsService=a,this.userService=b,this.eventBus=d,this.$modal=e,this.projectContentValidator=f,this.projectEvents=g,this.projectService=h,this.imageCollection=i,this.$timeout=j,this.commandService=k,this.calendar=l,this.$q=m,this.imageFactory=n,this.calendarEventsImageService=o,this.config=p,this._handleCalendarEventUpdated=c(this._handleCalendarEventUpdated,this),q=this.eventsService,this.occasions=q.occasions,this.occurrences=q.occurrences,this.relationships=q.relationships,this.months=q.months,this.days=q.days,this.maxNumberOfSelectedEventsPerDay=this.calendarEventsImageService.maxNumberOfSelectedEventsPerDay,this.newEventModel={},this.newEventDate={},this.editEventModel={},this.isCreatingNewEvent=!1,this._listenerTokens=[],this.active=!1,this.eventBus.subscribe(this.eventBus.events.CALENDAR_EVENT_UPDATED,function(a){return function(b,c){return a._handleCalendarEventUpdated(c)}}(this))}return a.prototype.maxEventNameLength=28,a.prototype.isCreatingNewEvent=!1,a.prototype.isEditingEvent=!1,a.prototype.invalidCharsWarning="hidden",a.prototype.newEventModel={},a.prototype.newEventDate={},a.prototype.editEventModel={},a.prototype.originalEventBeingEdited=null,a.prototype.isLoggedIn=!1,a.prototype.hasTooManySelectedEvents=!1,a.prototype.publicEventsLoaded=!1,a.prototype.myEventsLoaded=!1,a.prototype.modalInstance=null,a.$modalScope=null,a.$scope=null,a.prototype.active=!1,a._sfgetter("events",function(){return this.eventsService.events}),a.prototype.activate=function(){var a;if(!this.active)return a=[],a.push(this.eventBus.subscribe(this.eventBus.events.LOAD_MY_EVENTS,function(a){return function(){return a.loadMyEvents()}}(this))),a.push(this.eventBus.subscribe(this.eventBus.events.LOGIN_SUCCEEDED,function(a){return function(){return a._handleLoginSucceeded()}}(this))),a.push(this.eventBus.subscribe(this.eventBus.events.CALENDAR_REMOVE_ACTIVE_EVENT,function(a){return function(b,c){return a.calendarEventsImageService.removeGridCellImage(c)}}(this))),a.push(this.eventBus.subscribe(this.eventBus.events.CREATE_NEW_EVENT,function(a){return function(){return a._startCreatingNewEvent(a.newEventDate)}}(this))),this._listenerTokens=a,this.active=!0},a.prototype.deactivate=function(){var a,b,c,d;for(d=this._listenerTokens,b=0,c=d.length;b<c;b++)a=d[b],this.eventBus.unsubscribe(a);return this.active=!1},a.prototype._handleLoginSucceeded=function(){if(null!=this.projectService.currentProject.values)return this.loadMyEvents()},a.prototype.getDayFromAsset=function(a){var b,c;return a.isEventTextAsset?"date"===a.asset.guidanceText?a.editorContent:(b=null!=(c=a.asset.guidanceText)?c.split("-"):void 0,b[1]?b[1]:null):null},a.prototype.startEditingEvent=function(a,b){if(a.stopPropagation(),"holiday"!==b.type)return this._openEventEditorForEvent(b)},a.prototype._openEventEditorForEvent=function(a){return this.isEditingEvent?void this.finishEditingEvent():(this.cancelCreatingNewEvent(),this._resetWarning(),this.hasTooManySelectedEvents=!1,this.isEditingEvent=!0,this.originalEventBeingEdited=a,this.editEventModel=angular.fromJson(angular.toJson(a)),this._checkNumberOfSelectedDays(a),a.isBeingEdited=!0)},a.prototype.cancelEditingEvent=function(){var a;return null!=(a=this.originalEventBeingEdited)&&(a.isBeingEdited=!1),this.editEventModel={},this.originalEventBeingEdited=null,this.isEditingEvent=!1},a.prototype.finishEditingEvent=function(){var a,b,c,d;return d=this.editEventModel.isSelected,c=this.hasTooManySelectedEvents,this.editEventModel.year=this._inferYear(this.editEventModel.month),a=new Date(this.editEventModel.year,this.editEventModel.month-1,this.editEventModel.day),this.commandService.execute("UpdateCalendarEventCommand",{originalEvent:this.originalEventBeingEdited,editedEvent:this.editEventModel,gridPage:this.calendar.findSurfaceForDate(a)}),b=this.eventsService.getEvent(this.editEventModel.id),b.isSelected=d&&!c,this.cancelEditingEvent(),b},a.prototype.delete=function(a,b){var c;if(a.stopPropagation(),null==this.modalInstance&&"holiday"!==b.type)return c=this._openModal("SilverApp/views/gc/events/delete-event-modal.html"),c.then(function(a){return function(){return a.deleteWithoutWarning(b)}}(this))},a.prototype.deleteWithoutWarning=function(a){var b;return b=this.calendar.findSurfaceForDate(a.date),this.commandService.execute("ShowCalendarEventCommand",{event:a,pageNumber:null!=b?b.surfaceNumber:void 0,deleteEvent:!0})},a.prototype.selectEvent=function(a){var b,c;return b=this.eventsService.getSelectedEventsOnSameDay(a),a.isSelected||b.length<this.maxNumberOfSelectedEventsPerDay?(null==a.isSelected&&(a.isSelected=!1),c=this.calendar.findSurfaceForDate(a.date),this.commandService.execute("ShowCalendarEventCommand",{event:a,pageNumber:null!=c?c.surfaceNumber:void 0})):this._displayTooManySelectedEventsModal(),this.isCreatingNewEvent?this._checkNumberOfSelectedDays(this.newEventModel):this.isEditingEvent?this._checkNumberOfSelectedDays(this.editEventModel):this._checkNumberOfSelectedDays(a)},a.prototype.applyEventNameValidation=function(a){var b;return null==a||a.length<1?void this._resetWarning():(b=this.projectContentValidator.cleanNonPrintableCharactersInContent(a),b.invalidCharacters.length>0&&(this.invalidCharsWarning="visible"),this.isEditingEvent&&(this.editEventModel.name=b.cleanContent),this.isCreatingNewEvent&&(this.newEventModel.name=b.cleanContent),0===b.invalidCharacters.length?this.validResultsCounter++:this.validResultsCounter=0,this.validResultsCounter>=5?this._resetWarning():void 0)},a.prototype._displayTooManySelectedEventsModal=function(){if(null==this.modalInstance)return this._openModal("SilverApp/views/gc/events/too-many-selected-events-modal.html")},a.prototype._resetWarning=function(){return this.invalidCharsWarning="hidden"},a.prototype._openModal=function(a){return this.$modalScope=this.$scope.$new(!0),this.modalInstance=this.$modal.open({templateUrl:a,backdrop:"static",scope:this.$modalScope}),this.modalInstance.result.finally(function(a){return function(){return a.modalInstance=null,a.$modalScope.$destroy(),a.$modalScope=null}}(this)),this.modalInstance.result},a.prototype.login=function(){return this.eventBus.publish(this.eventBus.events.LOGIN_PROMPT)},a.prototype.startCreatingNewEvent=function(){return this.isLoggedIn?this._startCreatingNewEvent(this.newEventDate):this.eventBus.publish(this.eventBus.events.LOGIN_PROMPT,this.eventBus.events.CREATE_NEW_EVENT)},a.prototype.cancelCreatingNewEvent=function(){return this.isCreatingNewEvent=!1,this.newEventModel={}},a.prototype.setNewEventProperty=function(a,b){return this._setEventProperty(this.newEventModel,a,b)},a.prototype.setEditEventProperty=function(a,b){return this._setEventProperty(this.editEventModel,a,b)},a.prototype._setEventProperty=function(a,b,c){return a[b]=c,"month"===b?(this._recalculateDays(a,c),this._checkNumberOfSelectedDays(a)):"name"===b?a.name=c.trim():"day"===b?this._checkNumberOfSelectedDays(a):void 0},a.prototype._checkNumberOfSelectedDays=function(a){var b;if(this.isCreatingNewEvent||this.isEditingEvent)return b=this.eventsService.getSelectedEventsOnSameDay(a),this.hasTooManySelectedEvents=b.length>=this.maxNumberOfSelectedEventsPerDay},a.prototype._recalculateDays=function(a,b){var c,d,e,f;return e=this._inferYear(b),d=new Date(e,b,0),c=d.getDate(),a.day>c&&(a.day=c),this.days=function(){f=[];for(var a=1;1<=c?a<=c:a>=c;1<=c?a++:a--)f.push(a);return f}.apply(this)},a.prototype.saveNewEvent=function(){var a,b;return a=this.$q.defer(),this.newEventModel.name?(b=this.hasTooManySelectedEvents,this.newEventModel.year=this._inferYear(this.newEventModel.month),this.eventsService.addEvent(this.newEventModel).then(function(c){return function(d){var e;return d.isSelected=!1,b||(e=c.calendar.findSurfaceForDate(d.date),c.commandService.execute("ShowCalendarEventCommand",{event:d,pageNumber:null!=e?e.surfaceNumber:void 0})),c.cancelCreatingNewEvent(),a.resolve(d)}}(this)),a.promise):(a.resolve(),a.promise)},a.prototype._startCreatingNewEvent=function(a){var b,c;return c=a.month,b=a.day,null!=c&&null!=b||(c=this.projectService.currentProject.product.getCalendarStartDate().month,b=1),this.userService.isUserSignedIn().then(function(a){return function(d){if(a.isLoggedIn=d,a.isLoggedIn)return a.newEventModel={name:"",month:c,day:b,type:"default",recurring:!0,relationship:"default"},a._resetWarning(),a._recalculateDays(a.newEventModel,a.newEventModel.month),a.cancelEditingEvent(),a.isCreatingNewEvent=!0,a._checkNumberOfSelectedDays(a.newEventModel)}}(this))},a.prototype._inferYear=function(a){var b,c;return b=this.projectService.currentProject.product.getCalendarStartDate(),c=b.year,a<b.month&&(c+=1),c},a.prototype.loadEvents=function(){return this.$q.all([this.loadPublicEvents(),this.loadMyEvents()])},a.prototype.loadPublicEvents=function(){var a,b,c;return c=this.projectService.currentProject.product.getCalendarStartDate(),a=this.projectService.currentProject.product.getCalendarEndDate(),b=this.eventsService.loadPublicEvents(c,a),b.then(function(a){return function(){return a.publicEventsLoaded=!0,a._loadProjectEvents()}}(this)),b},a.prototype.loadMyEvents=function(){var a,b,c;return c=this.projectService.currentProject.product.getCalendarStartDate(),a=this.projectService.currentProject.product.getCalendarEndDate(),b=this.eventsService.loadMyEvents(c,a),b.then(function(a){return function(){return a.updateIsLoggedIn(),a.myEventsLoaded=!0,a.calendarEventsImageService.getEventImagesInformation(),a._loadProjectEvents()}}(this)),b},a.prototype._loadProjectEvents=function(){var a;return this.eventsService.loadProjectEvents().forEach(function(a){return a.isSelected=!0}),(null!=(a=this.projectEvents.eventCollection)?a.imageAssociations:void 0)&&this.projectEvents.eventCollection.imageAssociations.forEach(function(a){return function(b){var c;if(b.active&&(c=a.eventsService.getEvent(b.eventId)))return a.projectEvents.updateImageAssociation(c.id,b)}}(this)),this.projectEventsLoaded=!0},a.prototype.updateIsLoggedIn=function(){var a;return a=this.$q.defer(),this.userService.isUserSignedIn().then(function(b){return function(c){b.isLoggedIn=c,a.resolve(b.isLoggedIn)}}(this)),a.promise},a.prototype._addEventToProject=function(a){return this.projectEvents.addEvent(a),this._modifyGridEventsMatchingEvent(a)},a.prototype._eventDatesMatch=function(a){var b,c,d,e;if(!Array.isArray(a)||0===a.length)return!1;for(c=a[0],d=0,e=a.length;d<e;d++)if(b=a[d],c.year!==b.year||c.month!==b.month||c.day!==b.day)return!1;return!0},a.prototype._modifyGridEventsMatchingEvent=function(a){var b,c;return c=this.projectEvents.eventsMatchingEventDate(a),b=new Date(a.year,a.month-1,a.day),this.projectService.currentProject.product.setEventsOnDate(c,b)},a.prototype.returnToEdit=function(){return this.eventBus.publish(this.eventBus.events.SELECT_EDIT_TAB)},a.prototype._removeImageAssociation=function(a){return this.projectEvents.removeImageAssociation(a.id)},a.prototype.removeEventPhotoAssignment=function(a){
return this.calendarEventsImageService.removeEventPhotoAssignment(a)},a.prototype._handleCalendarEventUpdated=function(a){a&&(this._loadProjectEvents(),this.$timeout(function(a){return function(){return a.$scope.$digest()}}(this)))},a.prototype._getImageAssociationsOnDate=function(a,b,c){var d,e,f,g,h,i;for(f=[],i=this.events,g=0,h=i.length;g<h;g++)d=i[g],"custom"===d.visibility&&d.day===c&&d.month===b&&d.year===a&&(e=this.projectEvents.getImageAssociation(d.id))&&f.push(e);return f},a.prototype.getImageAssociation=function(a){return this.projectEvents.getImageAssociation(a)},a.prototype.onChangeEventImage=function(a,b){a.preventDefault(),this.calendarEventsImageService.updateImageAssociationForEvent(b)},a.prototype.getImageById=function(a){return this.calendarEventsImageService.getImageById(a)},a.prototype.getEventImageAsset=function(a){return this.calendarEventsImageService.getEventImageAsset(a)},a}(),b=function(){function b(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){this.eventsService=a,this.userService=b,this.eventBus=c,this.$modal=d,this.projectContentValidator=e,this.projectEvents=f,this.projectService=g,this.imageCollection=h,this.$timeout=i,this.commandService=j,this.calendar=k,this.$q=l,this.imageFactory=m,this.calendarEventsImageService=n,this.config=o}return b.prototype.newInstance=function(){return new a(this.eventsService,this.userService,this.eventBus,this.$modal,this.projectContentValidator,this.projectEvents,this.projectService,this.imageCollection,this.$timeout,this.commandService,this.calendar,this.$q,this.imageFactory,this.calendarEventsImageService,this.config)},b}(),b.$inject=["eventsService","userService","eventBus","$modal","projectContentValidator","projectEvents","projectService","imageCollection","$timeout","commandService","calendar","$q","imageFactory","calendarEventsImageService","CONFIG"],angular.module("galleon-gc").service("eventsEditingServiceFactory",b)}.call(this),function(){angular.module("galleon-pb").value("sliderKeyProvider",{topLeftKey:"left",bottomRightKey:"right"})}.call(this),function(){angular.module("galleon-gc").value("sliderKeyProvider",{topLeftKey:"top",bottomRightKey:"bottom"})}.call(this),function(){angular.module("galleon-ss").value("sliderKeyProvider",{topLeftKey:"left",bottomRightKey:"right"})}.call(this),function(){var a,b;a=function(){function a(a){this.$document=a}return a.prototype.link=function(a,b,c){var d;return d=this.$document[0].body,d.addEventListener("click",function(b){return a.onClick({$event:b})},!0),a.$on("$destroy",function(){return d.removeEventListener("click",a.onClick,!0)})},a}(),b=function(b){return{restrict:"E",template:"<div></div>",scope:{onClick:"&"},link:function(c,d,e){return new a(b).link(c,d,e)}}},b.$inject=["$document"],angular.module("galleon-pb").directive("captureClickEvents",b)}.call(this),function(){"use strict";var a,b;b=function(){function a(a,b,c){this.globalContentService=a,this.projectService=b,this.contentService=c}return a.prototype._init=function(){var a,b;return this.allColors=[],this.allFontFamilies=[],this.colors=[],this.fontFamilies=[],this.fontIndices={},this.fontSizes=[],this.isDropdownOpen=!1,this.selectedColor={},this.selectedFont={},this.selectedFontFamily={},this.selectedFontSize=null,this.selectedSizeIndex=0,this.textStyles={},this.usedContent=null!=(a=this.projectService)&&null!=(b=a.currentProject)?b.usedContent:void 0,this.userSelectedColors=[],this.userSelectedFontFamilies=[]},a.prototype._initFontSizes=function(){var a,b,c,d,e;if(!(this.fontSizes.length>0)){for(this.fontSizes=this.globalContentService.getFontSizes(),e=this.fontSizes,a=c=0,d=e.length;c<d;a=++c)b=e[a],this.fontIndices[""+b]=a;return this.selectedSizeIndex=0,this.selectedFontSize=this.fontSizes[this.selectedSizeIndex]}},a.prototype._initFonts=function(){var a,b,c,d,e;if(this.fontFamilies=this.contentService.currentFontFamilies(),this.allFontFamilies=this.globalContentService.getFontFamilies(),this.userSelectedFontFamilies=this._initUserSelectedFonts(),this.selectedFontFamily=this.globalContentService.getFontFamilyForFontId(this.textStyles.fontId),this.selectedFont=void 0,null!=this.selectedFontFamily){for(d=this.selectedFontFamily.fonts,e=[],b=0,c=d.length;b<c;b++)a=d[b],a.fontId===this.textStyles.fontId&&e.push(this.selectedFont=a);return e}},a.prototype._initEditor=function(){var a,b,c,d,e,f,g,h,i;for(this.colors=this.contentService.currentStyleColors(),this.allColors=this.contentService.allColors(),this.userSelectedColors=this._userSelectedColors(),this.selectedColor=null,this.textStyles=this._ogTextAssetStyles(),h=this.allColors,d=0,f=h.length;d<f;d++)a=h[d],a.color===this.textStyles.color&&(this.selectedColor=a);for(i=this.fontSizes,b=e=0,g=i.length;e<g;b=++e)if(c=i[b],c===this.textStyles.fontSize){this.selectedFontSize=c,this.selectedSizeIndex=b;break}if(null==this.selectedColor)return this.selectedColor=this.colors[0]},a.prototype._userSelectedColors=function(){var a,b,c,d,e,f,g,h;for(d=this.usedContent.fontColors,c={},g=this.colors,e=0,f=g.length;e<f;e++)a=g[e],c[a.color]=!0;h=[];for(a in d)b=d[a],null==c[b]&&h.push(this.contentService.colorForHex(b));return h},a.prototype._initUserSelectedFonts=function(){var a,b,c,d,e,f;for(b=this._usedFontFamilies(),e=this.allFontFamilies,f=[],c=0,d=e.length;c<d;c++)a=e[c],this._isUsedNonStyleFont(b,a)&&f.push(a);return f},a.prototype._isUsedNonStyleFont=function(a,b){return null!=a[b.fontFamilyId]&&this.fontFamilies.indexOf(a[b.fontFamilyId])===-1},a.prototype._usedFontFamilies=function(){var a,b,c,d;d=this.usedContent.fontIds,a={};for(c in d)b=this.globalContentService.getFontFamilyForFontId(c),null!=b&&(a[b.fontFamilyId]=b);return a},a.prototype.$onChanges=function(){return this._init(),this._initFontSizes(),this._initEditor(),this._initFonts()},a.prototype._ogTextAssetStyles=function(){return{color:this.asset.styles.color,fontFamily:this.asset.styles.fontFamily,fontId:this.asset.styles.fontId,fontName:this.asset.styles.fontName,fontSize:this.asset.styles.fontSize,fontStyle:this.asset.styles.fontStyle,fontWeight:this.asset.styles.fontWeight,lineHeight:this.asset.styles.lineHeight,textAlign:this.asset.styles.textAlign,textSpacing:this._calculateSpacingFactor(this.asset.styles.lineHeight,this.asset.styles.fontSize),verticalAlign:this.asset.verticalAlign}},a.prototype._calculateSpacingFactor=function(a,b){return parseFloat((a/b).toFixed(1))},a.prototype.incrementFontSize=function(){var a;return a=this.fontSizes.length-1,this.selectedSizeIndex=this.selectedSizeIndex>=a?a:this.selectedSizeIndex+1,this.selectedFontSize=this.fontSizes[this.selectedSizeIndex],this._updateFontSize(this.selectedFontSize)},a.prototype.decrementFontSize=function(){return this.selectedSizeIndex=this.selectedSizeIndex<=0?0:this.selectedSizeIndex-1,this.selectedFontSize=this.fontSizes[this.selectedSizeIndex],this._updateFontSize(this.selectedFontSize)},a.prototype.selectFontSize=function(a){return this.selectedFontSize=a,this.selectedSizeIndex=this.fontIndices[""+this.selectedFontSize],this._updateFontSize(this.selectedFontSize)},a.prototype._updateFontSize=function(a){return this.textStyles.fontSize=a,this._update()},a.prototype.selectColor=function(a){return this.textStyles.color=a.color,this.selectedColor=a,this._update()},a.prototype.selectFontFamily=function(a){return this.selectedFontFamily=a,this.selectedFont=this.selectedFontFamily.fonts[0],this._updateFont(this.selectedFont)},a.prototype.updateVerticalAlignment=function(a){return this.textStyles.verticalAlign=a,this._update()},a.prototype.updateHorizontalAlignment=function(a){return this.textStyles.textAlign=a,this._update()},a.prototype.updateSpacing=function(a){return this.textStyles.textSpacing=a,this._update()},a.prototype._updateFont=function(a){return this.textStyles.fontId=a.fontId,this.textStyles.fontFamily=a.fontFamily,this.textStyles.fontName=a.fontName,this.textStyles.fontStyle=a.fontStyle,this.textStyles.fontWeight=a.fontWeight,this._update()},a.prototype.selectFont=function(a){return this.selectedFont=a,this.selectedFontFamily=this.globalContentService.getFontFamilyForFontId(a.fontId),this._updateFont(this.selectedFont)},a.prototype._update=function(){return this.textStyles.lineHeight=this._calculateLineHeight(this.textStyles.textSpacing,this.textStyles.fontSize),this.onTextStyleChanged({data:{textStyles:this.textStyles}})},a.prototype._calculateLineHeight=function(a,b){return parseFloat((b*a).toFixed(1))},a}(),b.$inject=["globalContentService","projectService","contentService"],a={bindings:{asset:"<",isAdvancedText:"<",onTextStyleChanged:"&"},controller:b,templateUrl:"SilverApp/views/font-settings.html"},angular.module("galleon").component("fontSettings",a)}.call(this),function(){"use strict";var a,b,c,d,e,f,g;a=110,b=41,g=16,f=15,e=420,d=function(){function c(c,d,e,h,i,j,k,l,m,n,o,p,q,r){var s,t;this.projectService=c,this.imageCollection=d,this.navService=e,this.imageURLService=h,this.$filter=i,this.modelAdapter=j,this.imageAssetFactory=k,this.commandService=l,this.redEyeHelper=m,this.$timeout=n,this.config=o,this.warningUtil=p,this.mediaPreferenceService=r,this.filtersDisabled=!1,this.editingRedEye=!1,this.jcropDone=!1,this.resetCount=0,this.productMode=this.config.defaults.productMode,s=Math.min(q.innerHeight-a-b-g,q.innerWidth),t=parseInt(this.maxSize,10),this.maxImageEditorSize=Math.min(s-2*f,t),this.supportedAfsFilters=["None","Auto","Sunshine","BlackWhite","Sepia","Vibrant","Vintage"],this.config.fade&&this.supportedAfsFilters.push("Fade")}return c.prototype.$onChanges=function(a){if(null!=a.page)return this._pickNewAsset(a.page.currentValue,a.originalAsset.currentValue),this.onCommitChanges({tabChangedCallback:function(a){return function(){if(a._hasChanged(a.originalAsset,a.asset))return a._executeCommand(a.page,a.model,a.originalAsset,a.asset)}}(this)})},c.prototype.handleRedEyeRectangleAddition=function(a,b){var c;return this.hasPotentiallyChanged=!0,c=this.redEyeHelper.generateRedEyeData(b,a,this.startingRedeye),this.asset.redeye=c,this.filteredImageUrl=this.generateImageURL(this.asset)},c.prototype.toggleRedEye=function(){if(this.editingRedEye=!this.editingRedEye,this.editingRedEye===!1)return this.startingRedeye=this.asset.redeye},c.prototype.previousImage=function(){if(!this.editingRedEye&&this.jcropDone)return this._nextPreviousImage(function(a){return a-1})},c.prototype.tryCloseRedEyeControl=function(){return this.editingRedEye&&(this.toggleRedEye(),this.$timeout(function(){})),!0},c.prototype.nextImage=function(){if(!this.editingRedEye&&this.jcropDone)return this._nextPreviousImage(function(a){return a+1})},c.prototype._nextPreviousImage=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;for(this._hasChanged(this.originalAsset,this.asset)&&this._executeCommand(this.page,this.model,this.originalAsset,this.asset),c=this.projectService.currentProject.product,m=[],r=c.pages,e=n=0,p=r.length;n<p;e=++n)j=r[e],e>0&&c.pages[e-1].isSpread()||m.push(j);for(d=[],(null!=(s=c.cover)?s.backPage:void 0)&&d.push(c.cover.backPage),(null!=(t=c.cover)?t.spinePage:void 0)&&d.push(c.cover.spinePage),(null!=(u=c.cover)?u.frontPage:void 0)&&d.push(c.cover.frontPage),k=[].concat.apply([],[d,m]).filter(function(a){return 0!==a.getImages().length}).map(function(a){return[a.surfaceNumber,a.getImages()]}).map(function(a){return a[1].map(function(b){return[b.uniqueProjectRef,a[0]]})}),b=[].concat.apply([],k),f=-1,e=o=0,q=b.length;o<q;e=++o)if(l=b[e],l[0]===this.asset.uniqueProjectRef&&l[1]===this.page.surfaceNumber){f=e;break}return g=a(f),g===-1?g=b.length-1:g===b.length&&(g=0),i=c.pageBySurfaceNumber(b[g][1]),h=i.getImageById(b[g][0]),this._pickNewAsset(i,h)},c.prototype._pickNewAsset=function(a,b){var c,d,e;return this.page=a,this.model=this.imageCollection.getImageByProductImageId(b.projectImageId),this.originalAsset=b,c="AFS-MercuryFRC",e=this.originalAsset.hasActualFineRotation(),this.startingRedeye=this.originalAsset.redeye,this.asset=this._createAssetFromModel(this.model,b.uniqueProjectRef),this.asset.imageAssignmentRotation=this.originalAsset.imageAssignmentRotation,this.asset.redeye=this.originalAsset.redeye,this.asset.effect=this.originalAsset.effect,this.asset.fadeValue=this.originalAsset.fadeValue,e&&(this.asset.imageAssignmentRotation=0,this.asset.effect=function(){var a,b,e,f;for(e=this.originalAsset.effectsAsCollection,f=[],a=0,b=e.length;a<b;a++)d=e[a],d!==c&&f.push(d);return f}.call(this).join("; ")),this.filtersDisabled=this.hasFilterApplied("None"),this.filteredImageUrl=this.generateImageURL(this.asset),this.navService.gotoPage(a.surfaceNumber),this.hasPotentiallyChanged=!1,this.jcropDone=!1,this.newCropValues=[this.originalAsset.imageAssignmentLlx,this.originalAsset.imageAssignmentLly,this.originalAsset.imageAssignmentUrx,this.originalAsset.imageAssignmentUry]},c.prototype._createAssetFromModel=function(a,b){var c,d;return c=this.modelAdapter.galleonImageModelToGalleonImageReference(a),c.llx=0,c.lly=0,c.urx=1,c.ury=1,d={container:{width:401,height:401,id:b},imageAssignment:{imageReference:c}},this.imageAssetFactory.newInstance(d)},c.prototype.generateEditImageTitle=function(){return this.model.createTimestampedDescription()},c.prototype.generateImageURL=function(a,b){return null==b&&(b=1.5),this.imageURLService.imageURLForImageAsset(a,b)},c.prototype.afsFilteredImageUrl=function(a){var b,c,d;return c=this.asset.hasActualFineRotation(),b={imageAssignmentRotation:this.asset.imageAssignmentRotation,imageAssignmentLlx:0,imageAssignmentLly:0,imageAssignmentUrx:1,imageAssignmentUry:1,imageAssignmentWidth:this.asset.imageAssignmentWidth,imageAssignmentHeight:this.asset.imageAssignmentHeight,data:this.asset.data,imageId:this.asset.imageId,effectsAsCollection:["AFS-"+a],filterEffect:a,asset:{containerWidth:60,containerHeight:60},hasEffect:this.asset.hasEffect,hasActualFineRotation:function(){return c}},(d=function(a){return function(c){var d;return"Fade"===c&&(c="Auto"),d=angular.extend({},b,{effect:c}),a.generateImageURL(d,1)}}(this))(this._toEffectName(a))},c.prototype.rotateCC=function(){var a;if(this.canAlterImage())return this._rotate(270),a=[1-this.asset.imageAssignmentUry,this.asset.imageAssignmentLlx,1-this.asset.imageAssignmentLly,this.asset.imageAssignmentUrx],this.asset.imageAssignmentLlx=a[0],this.asset.imageAssignmentLly=a[1],this.asset.imageAssignmentUrx=a[2],this.asset.imageAssignmentUry=a[3],this.filteredImageUrl=this.generateImageURL(this.asset)},c.prototype.rotate=function(){var a;if(this.canAlterImage())return this._rotate(90),a=[this.asset.imageAssignmentLly,1-this.asset.imageAssignmentUrx,this.asset.imageAssignmentUry,1-this.asset.imageAssignmentLlx],this.asset.imageAssignmentLlx=a[0],this.asset.imageAssignmentLly=a[1],this.asset.imageAssignmentUrx=a[2],this.asset.imageAssignmentUry=a[3],this.filteredImageUrl=this.generateImageURL(this.asset)},c.prototype._rotate=function(a){return this.hasPotentiallyChanged=!0,this.jcropDone=!1,this.asset.imageAssignmentRotation=(this.asset.imageAssignmentRotation+a)%360},c.prototype.onCrop=function(a){return this.hasPotentiallyChanged=!0,this.newCropValues=this._cleanCropRoundingIssues(a)},c.prototype.applyFilter=function(a){var b;if(this.canAlterImage()&&(b=this._toEffectName(a),this.asset.effect!==b||"Auto"===b))return this.jcropDone=!1,this.hasPotentiallyChanged=!0,"Fade"===a?(this.asset.fadeValue=.5,this.asset.fadeColor="#FFFFFF",this.asset.effect="Auto"):(this.asset.effect=b,this.asset.fadeValue=1),this.filtersDisabled=this.hasFilterApplied("None"),this.filteredImageUrl=this.generateImageURL(this.asset)},c.prototype.hasFilterApplied=function(a){return.5===this.asset.fadeValue&&"Fade"===a||.5!==this.asset.fadeValue&&this.asset.hasEffect(this._toEffectName(a))},c.prototype._toEffectName=function(a){switch(a){case"Auto":return a;case"None":return a;case"Fade":return a;default:return"AFS-"+a}},c.prototype.onInit=function(){return this.jcropDone=!0},c.prototype.canAlterImage=function(){return!this.editingRedEye&&this.jcropDone},c.prototype._cleanCropRoundingIssues=function(a){return a.map(function(a){switch(!1){case!(a<0):return 0;case!(a>1):return 1;default:return a}})},c.prototype.canReset=function(){return this._hasChanged(this.originalAsset,this.asset)},c.prototype.reset=function(){return this.resetCount++,this._pickNewAsset(this.page,this.originalAsset)},c.prototype.remove=function(){return this.commandService.execute("RemoveWellImageCommand",{imageId:this.asset.imageId,uniqueProjectRef:this.asset.uniqueProjectRef,pageNumber:this.page.surfaceNumber}),this.onRemove()},c.prototype._executeCommand=function(a,b,c,d){var e;return d.imageAssignmentLlx=this.newCropValues[0],d.imageAssignmentLly=this.newCropValues[1],d.imageAssignmentUrx=this.newCropValues[2],d.imageAssignmentUry=this.newCropValues[3],e=angular.toJson(d.values),this.commandService.execute("ApplyImageEditsCommand",{source:{serializedImageAsset:e,imageId:d.imageId,pageNumber:a.surfaceNumber,redeyeData:this._redeyeValuesHaveChanged(c,d)?d.redeye:void 0},pageNumber:a.surfaceNumber,activePageNumber:a.surfaceNumber,target:{imageId:c.imageId,uniqueProjectRef:c.uniqueProjectRef,redeyeData:c.redeye}})},c.prototype._hasChanged=function(a,b){return this.hasPotentiallyChanged&&(this._rotationHasChanged(a,b)||this._cropValuesHaveChanged()||this._redeyeValuesHaveChanged(a,b)||this._filterValueHasChanged(a,b)||this._fadeValueHasChanged(a,b))},c.prototype.fadeValueForPage=function(){return.5===this.asset.fadeValue?.3:1},c.prototype._rotationHasChanged=function(a,b){return a.imageAssignmentRotation!==b.imageAssignmentRotation},c.prototype._cropValuesHaveChanged=function(){return this.newCropValues[0]!==this.originalAsset.imageAssignmentLlx||this.newCropValues[1]!==this.originalAsset.imageAssignmentLly||this.newCropValues[2]!==this.originalAsset.imageAssignmentUrx||this.newCropValues[3]!==this.originalAsset.imageAssignmentUry},c.prototype._redeyeValuesHaveChanged=function(a,b){return(null!=a.redeye||null!=b.redeye)&&a.redeye!==b.redeye},c.prototype._filterValueHasChanged=function(a,b){return a.effect!==b.effect},c.prototype._fadeValueHasChanged=function(a,b){return a.fadeValue!==b.fadeValue},c.prototype.isLowResolution=function(){return this.warningUtil.isLowResolutionImage(this.asset,this.originalAsset.asset,{urx:this.newCropValues[2],llx:this.newCropValues[0],ury:this.newCropValues[3],lly:this.newCropValues[1]})},c}(),d.$inject=["projectService","imageCollection","navService","imageURLService","$filter","modelAdapter","imageAssetFactory","commandService","redEyeHelper","$timeout","CONFIG","warningUtil","$window","mediaPreferenceService"],c={bindings:{maxSize:"@",onCommitChanges:"&",onRemove:"&",originalAsset:"<",page:"<"},controller:d,templateUrl:"SilverApp/views/image-editor.html"},angular.module("galleon").component("imageEditor",c)}.call(this),function(){"use strict";var a;a={bindings:{dtk:"@",iconClass:"@",isActive:"<",onClick:"&",tooltipKey:"@"},templateUrl:"SilverApp/views/text-controls-widget.html"},angular.module("galleon").component("textControlsWidget",a)}.call(this),function(){"use strict";var a;a={bindings:{onApply:"&",textStyles:"<"},templateUrl:"SilverApp/views/text-horizontal-alignment.html"},angular.module("galleon").component("textHorizontalAlignment",a)}.call(this),function(){"use strict";var a;a={bindings:{onApply:"&",textSpacing:"<"},templateUrl:"SilverApp/views/text-spacing.html"},angular.module("galleon").component("textSpacing",a)}.call(this),function(){"use strict";var a;a={bindings:{onApply:"&",textStyles:"<"},templateUrl:"SilverApp/views/text-vertical-alignment.html"},angular.module("galleon").component("textVerticalAlignment",a)}.call(this),function(){"use strict";var a,b;b=function(){function a(a){this.$scope=a,this.$scope.ctrls=this.$scope.ctrls||{},this.$scope.ctrls.OrderAddressingCtrl=this,this.ECONOMY="economy",this.STANDARD="standard",this.EXPEDITED="expedited",this.selectedShipping=this.ECONOMY}return a}(),b.$inject=["$scope"],a={bindings:{asset:"<"},controller:b,templateUrl:"SilverApp/views/inline-order-dialog-addressing.html"},angular.module("galleon").component("orderAddressing",a)}.call(this),function(){"use strict";var a,b,c,d=function(a,b){return function(){return a.apply(b,arguments)}};b=function(){function a(){this._validatePricing=d(this._validatePricing,this),this._handleClick=d(this._handleClick,this)}return a.prototype.link=function(a,b,c,d){var e;return this.scope=a,this.element=b,this.attrs=c,this.$timeout=d,this.scope.hasValidPrice=!1,this.scope.isReceiptVisible=!1,this.scope.dataTestKeySuffix=["","","_Cover_FINISH","","","","","","",""],this.scope.pricingLink=this._generateLinkName(),this.scope.$watch("bookPricing",this._validatePricing),e=this._handleClick.bind(this),$(document).off("click",e),$(document).on("click",e),this},a.prototype._handleClick=function(a){var b;if(this.scope.isEnabled)return b=angular.element(a.target),this.scope.$evalAsync(function(a){return function(){return b.closest(".navbar-price").hasClass("navbar-price")?a.scope.isReceiptVisible=!0:a.scope.isReceiptVisible=!1}}(this))},a.prototype._generateLinkName=function(){var a,b,c,d;for(c="",b=d=0;d<8;b=++d)a=Math.floor(26*Math.random())+65,c+=String.fromCharCode(a);return"pricingLink-"+c},a.prototype._validatePricing=function(){var a,b;return a=null!=(b=this.scope.bookPricing)?b.totalOrigPrice:void 0,this.scope.hasValidPrice=!isNaN(parseFloat(a))},a}(),c=function(a){return{restrict:"E",templateUrl:"SilverApp/views/pricing-receipt.html",scope:{descriptionId:"=",pageCount:"=",bookPricing:"=",bindingType:"=",isEnabled:"="},transclude:!1,link:function(b,c,d){return(new PricingReceipt).link(b,c,d,a)}}},c.$inject=["$timeout"],b.$inject=[],a={bindings:{asset:"<"},controller:b,templateUrl:"SilverApp/views/inline-order-dialog-billing.html"},angular.module("galleon").component("orderBilling",a)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};b=function(){function a(a,b,d,e,f){this.$scope=a,this.eventBus=d,this.eventsService=e,this.userService=f,this._handleEventUpdated=c(this._handleEventUpdated,this),this._handleLoginSucceeded=c(this._handleLoginSucceeded,this),this._flushActiveEvent=c(this._flushActiveEvent,this),this.eventBus.subscribe(this.eventBus.events.LOGIN_SUCCEEDED,this._handleLoginSucceeded,this.$scope),this.eventBus.subscribe(this.eventBus.events.CALENDAR_EVENT_UPDATED,this._handleEventUpdated,this.$scope),this._hasInitd=!1,this.eventToDelete=void 0,this.eventsForDay=[],this.editor=b.newInstance(),this.editor.$scope=this.$scope,this._signIn()}return a.prototype.$onChanges=function(){return this.editor.activate(),this.onTabChanged({tabChangedCallback:this._flushActiveEvent})},a.prototype.$onDestroy=function(){return this.editor.deactivate()},a.prototype.requestEventDeletion=function(a,b){return a.stopPropagation(),this.eventToDelete=b},a.prototype.deleteEvent=function(){if(null!=this.eventToDelete)return this.editor.deleteWithoutWarning(this.eventToDelete),this.eventToDelete=void 0},a.prototype.saveNewEvent=function(){return this.editor.saveNewEvent().then(function(a){return function(){return a._refreshEvents()}}(this))},a.prototype.startCreatingNewEvent=function(){return this.editor.newEventDate=this.date,this.editor.startCreatingNewEvent()},a.prototype.cancelCreatingNewEvent=function(){return 0===this.eventsForDay.length?this.startCreatingNewEvent():this.editor.cancelCreatingNewEvent()},a.prototype._flushActiveEvent=function(){return this.editor.isEditingEvent?this.editor.finishEditingEvent():this.editor.isCreatingNewEvent?this.editor.saveNewEvent():void 0},a.prototype._signIn=function(){return this.userService.isUserSignedIn().then(function(a){return function(b){return a.editor.isLoggedIn=b,b?a._init():a.editor.login()}}(this))},a.prototype._init=function(){if(this._hasInitd===!1)return this._hasInitd=!0,this.editor.loadEvents().then(function(a){return function(){if(a._refreshEvents(),a.eventsForDay.length<=0)return a.editor.newEventDate=a.date,a.editor.startCreatingNewEvent()}}(this))},a.prototype._handleLoginSucceeded=function(){if(this._hasInitd===!1)return this._signIn()},a.prototype._handleEventUpdated=function(){return this._refreshEvents()},a.prototype._refreshEvents=function(){return this.eventsForDay=this.eventsService.getEventsOnSameDay(this.date)},a}(),b.$inject=["$scope","eventsEditingServiceFactory","eventBus","eventsService","userService"],a={bindings:{date:"<",gridCellAssets:"<",hoverDelay:"<",onTabChanged:"&"},controller:b,templateUrl:"SilverApp/views/gc/dialog-events-editor.html"},angular.module("galleon-gc").component("sfDialogEventsEditor",a)}.call(this),function(){"use strict";var a,b;b=function(){function a(){}return a.prototype.$onInit=function(){return this.tabs={date:"SilverApp.dateText",event:"SilverApp.eventText"},this._setActiveAsset()},a.prototype.toggleTab=function(a){return this.activeTab=a,this._setActiveAsset()},a.prototype.refreshCellAssetsPreview=function(a){this.gridCellAssets=a},a.prototype._setActiveAsset=function(){return this.activeAsset=function(){switch(this.activeTab){case"date":return this.dateTextAsset;case"event":return this.eventTextAsset;default:throw new Error("Unknown asset type: "+this.activeTab)}}.call(this)},a.prototype.setTabChangedCallback=function(a){return this.onTabChanged({tabChangedCallback:a})},a}(),a={bindings:{activeTab:"<",dateTextAsset:"<",eventTextAsset:"<",gridCellAssets:"<",isAdvancedText:"<",onTabChanged:"&",onCellAssetsPreviewUpdate:"&",page:"<"},controller:b,templateUrl:"SilverApp/views/gc/event-dialog-text-style.html"},angular.module("galleon-gc").component("textStyle",a)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};b=function(){function a(a,b,d,e,f,g,h){var i,j,k;this.textUpdateService=a,this.web2PrintService=b,this.adaptiveLayoutService=d,this.layoutFactory=e,this.calendarGrid=g,this.textAssetFactory=h,this._commitTextChanges=c(this._commitTextChanges,this),i=this.adaptiveLayoutService.adaptiveLib,this.textStyles={},this.styleSupportsEventTextBackground=!1,this.splitCellTemplate=null!=(j=i.getSplitGridCellTemplate(f.currentStyle))?j.layout_JSON:void 0,this.singleCellTemplate=null!=(k=i.getSingleGridCellTemplate(f.currentStyle))?k.layout_JSON:void 0,this._searchTemplatesForEventTextBackground()}return a.prototype._searchTemplatesForEventTextBackground=function(){var a,b,c,d;return b=null!=(c=this.splitCellTemplate)?c.assets:void 0,a=null!=(d=this.singleCellTemplate)?d.assets:void 0,this.styleSupportsEventTextBackground=[b,a].every(this._containsEventTextBackground)},a.prototype._containsEventTextBackground=function(a){return!!Array.isArray(a)&&a.some(function(a){var b,c,d,e;return b=null!=(c=null!=(d=a.assetReference)?d.assetId:void 0)?c:null!=(e=a.asset)?e.assetId:void 0,/-event-text-bg$/.test(b)})},a.prototype.$onChanges=function(a){if(this._handleGridCellAssetChanges(a),this.waitingForPreview=!1,null!=a.asset)return a.asset.currentValue===a.asset.previousValue||a.asset.isFirstChange()||this._commitTextChanges(a.asset.previousValue,this.textStyles),this.asset=a.asset.currentValue,this.textStyles=this.textUpdateService.getUpdateableSettings(a.asset.currentValue),this.originalAsset=this.textAssetFactory.newInstance(angular.copy(this.asset.values)),this.originalAlign=this.asset.verticalAlign,this.originallyUsesEventTextBackground=this._containsEventTextBackground(this.gridCellAssets),this.useEventTextBackground=this.originallyUsesEventTextBackground,this.previewingEventTextBackground=!1,this.waitingForPreview=!1,this.onTabChanged({tabChangedCallback:function(a){return function(){return a._commitTextChanges(a.asset,a.textStyles)}}(this)}),this.title=function(){switch(this.asset.isDateTextAsset){case!0:return"SilverApp.dateTextStyle";default:return"SilverApp.eventTextStyle"}}.call(this)},a.prototype.toggleEventTextBackground=function(){var a;return this.previewingEventTextBackground=!0,a=this.useEventTextBackground?{verticalAlign:"middle"}:{verticalAlign:this.originalAlign},this.onTextStyleChanged({textStyles:angular.merge(this.textStyles,a)}),this._toggleEventTextBackground()},a.prototype._handleGridCellAssetChanges=function(a){var b,c,d,e,f,g;if(null!=(null!=(f=a.gridCellAssets)?f.currentValue:void 0)&&this.waitingForPreview===!1){for(this.gridCellAssets=a.gridCellAssets.currentValue,g=this.gridCellAssets,d=0,e=g.length;d<e;d++)if(b=g[d],this.asset.asset.containerId===b.asset.containerId){this.asset=b;break}if(this.styleSupportsEventTextBackground===!0)return c=this._containsEventTextBackground(this.gridCellAssets),this.useEventTextBackground!==c&&this.previewingEventTextBackground?this._toggleEventTextBackground():this.useEventTextBackground=c}},a.prototype._toggleEventTextBackground=function(){var a,b,c,d,e,f,g,h,i;for(i=this.gridCellAssets,g=0,h=i.length;g<h;g++)d=i[g],d.asset.assetType===d.asset.constructor.IMAGE_TYPE&&(e=d);return b=this.gridCellAssets[0],c=this.asset.asset.containerId,a=this.gridCellAssets.map(function(a){return a.values}),f=this._createToggleEventTextBackgroundFn()(a,c,e,b),this._reconstituteAssetsValues(f.gridCellAssets)},a.prototype._createToggleEventTextBackgroundFn=function(){var a,b,c;return a=this.adaptiveLayoutService.addGridCellEventBackground,b=this.adaptiveLayoutService.removeGridCellEventBackground,c=this.useEventTextBackground===!0?a:b,function(a){return function(b,d,e,f){var g,h;return g=e.asset.isSplitComparedToImageAsset(f.asset),h=g?a.splitCellTemplate:a.singleCellTemplate,c.apply(a.adaptiveLayoutService,[g,h,b,d])}}(this)},a.prototype._reconstituteAssetsValues=function(a){var b;return b=this.layoutFactory.newInstance({assets:a}),this.gridCellAssets=b.assets,this.waitingForPreview=!0,this.onCellAssetsPreviewUpdate({gridCellAssets:this.gridCellAssets})},a.prototype._commitTextChanges=function(a,b){var c,d,e;return this._eventTextBackgroundHasChanged()?(c=this.textAssetFactory.newInstance(angular.copy(this.originalAsset.values)),d=this._createToggleEventTextBackgroundFn(),e=function(a){return function(){var b,e,f,g,h,i,j;return j=a.calendarGrid.getEditableAssetsByClickedGridCellAsset(a.page,c),e=j.eventAsset,g=j.imageAsset,f=j.gridCellAssets,b=f.map(function(a){return a.values}),h=f.length,i=d(b,e.asset.containerId,g,f[0]),i.removed=h>i.gridCellAssets.length,i}}(this),this.textUpdateService.commitTextChanges(this.page,this.originalAsset,b,a.editorContent,e)):void this.textUpdateService.commitTextChanges(this.page,a,b,a.editorContent)},a.prototype._eventTextBackgroundHasChanged=function(){return this.styleSupportsEventTextBackground===!0&&this.originallyUsesEventTextBackground!==this.useEventTextBackground},a.prototype.onTextStyleChanged=function(a){var b,c,d;return this.textStyles=a.textStyles,d=this.asset,this.originalAlign=this.textStyles.verticalAlign,b=angular.merge(this.getUpdateableSettings(d),this.textStyles),c=d.editorContent,this.web2PrintService.textMetadataForAsset(d,c).then(function(a){return d.updateTextWithWrapsAndStyle(c,a.wraps,a.hasOverflow,b)})},a.prototype.getUpdateableSettings=function(a){return angular.merge({},a.styles,{verticalAlign:a.verticalAlign})},a}(),b.$inject=["textUpdateService","web2PrintService","adaptiveLayoutService","layoutFactory","contentService","calendarGrid","textAssetFactory"],a={bindings:{asset:"<",isAdvancedText:"<",onTabChanged:"&",onCellAssetsPreviewUpdate:"&",page:"<",gridCellAssets:"<"},controller:b,templateUrl:"SilverApp/views/gc/event-dialog-text-style-editor.html"},angular.module("galleon-gc").component("textStyleEditor",a)}.call(this),function(){"use strict";var a,b;b=function(){function a(){}return a.prototype.toggleTab=function(a){return this.onTabSelected({tab:a})},a}(),a={bindings:{activeTab:"<",onTabSelected:"&",tabs:"<",gridCellAssets:"<"},controller:b,templateUrl:"SilverApp/views/gc/event-dialog-text-style-preview.html"},angular.module("galleon-gc").component("textStylePreview",a)}.call(this),function(){var a;a={bindings:{event:"<",inAdvancedEditTab:"<",editor:"<",hoverDelay:"<"},templateUrl:"SilverApp/views/gc/event-photo-well.html"
},angular.module("galleon-gc").component("sfEventPhotoWell",a)}.call(this),function(){var a;a={bindings:{event:"<",active:"<",editor:"<",activeLabel:"<",inactiveLabel:"<"},templateUrl:"SilverApp/views/gc/event-photo-radio.html"},angular.module("galleon-gc").component("sfEventPhotoRadio",a)}.call(this),function(){var a;a={bindings:{editor:"<",event:"<",showEventsMaxWarning:"<",onNewProperty:"&",onRequestSave:"&",onRequestCancel:"&"},templateUrl:"SilverApp/views/gc/inline-event-drawer.html"},angular.module("galleon-gc").component("sfInlineEventDrawer",a)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};b=function(){function a(a,b,d,e,f){this.styleProvider=a,this.imageURLService=b,this.contentService=e,this.config=f,this.imageAssetURL=c(this.imageAssetURL,this),this.styleForFadeUnderlay=c(this.styleForFadeUnderlay,this),this.styleForImage=c(this.styleForImage,this),this.styleForImageWrapper=c(this.styleForImageWrapper,this),this.textAssetImageURL=c(this.textAssetImageURL,this),this.adaptiveLib=d.adaptiveLib,this.gridCellAssets&&this._repositionCellAssets(this.gridCellAssets)}return a.prototype.$onChanges=function(a){var b;if(null!=(null!=(b=a.gridCellAssets)?b.currentValue:void 0))return this.gridCellAssets=a.gridCellAssets.currentValue,this._repositionCellAssets(this.gridCellAssets)},a.prototype._repositionCellAssets=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;for(e=this._getImageAsset(a),f=e.asset.isSplitBottom(),g=f||e.asset.isSplitComparedToImageAsset(a[0].asset),h=this.contentService.currentStyle,i=g?this.adaptiveLib.getSplitGridCellTemplate(h):this.adaptiveLib.getSingleGridCellTemplate(h),k=this._mapTemplateCellAssets(i),d={},q=[],n=0,o=a.length;n<o;n++)b=a[n],d[b.asset.assetId]=null!=(p=d[b.asset.assetId])?p:0,c=d[b.asset.assetId]++,j=this._identifyAssociatedTemplateAsset(b,c,k,f),null!=j&&(l=parseFloat(j.container.xOffset),m=parseFloat(j.container.yOffset),b.asset.xOffset=l,b.asset.yOffset=m,null!=j.imageRectangle?(b.asset.imageXOffset=l,q.push(b.asset.imageYOffset=m)):q.push(void 0));return q},a.prototype._getImageAsset=function(a){var b,c,d;for(c=0,d=a.length;c<d;c++)if(b=a[c],b.asset.assetType===b.asset.constructor.IMAGE_TYPE)return b;return null},a.prototype._identifyAssociatedTemplateAsset=function(a,b,c,d){var e,f;return e=d?"-2":"",a.asset.assetType===a.asset.constructor.GRAPHIC_TYPE?f=c[""+a.asset.assetId+b]:a.asset.assetType===a.asset.constructor.TEXT_TYPE?f=/event-[0-9]+$/.test(a.asset.guidanceText)?c["event"+e]:c["date"+e]:a.asset.assetType===a.asset.constructor.IMAGE_TYPE&&(e=""===e?"-1":e,f=c["image"+e]),f},a.prototype._mapTemplateCellAssets=function(a){var b,c,d,e,f,g,h,i;for(e={},d={},h=a.layout_JSON.assets,f=0,g=h.length;f<g;f++)b=h[f],"graphic"===b.assetType?(d[b.container.id]=null!=(i=d[b.container.id])?i:0,c=d[b.container.id]++,e[""+b.container.id+c]=b):"text"===b.assetType?e[b.guidanceText]=b:"image"===b.assetType&&(e["image-"+b.seqNum]=b);return e},a.prototype.toggleTab=function(a){return this.onTabSelected({tab:a})},a.prototype.styleForAsset=function(a){var b,c,d,e;return c=1.5,b=" scale("+c+", "+c+")",e=0!==a.rotation?"rotate("+a.rotation+"deg)"+b:""+b,d={position:"absolute",left:""+a.xOffset*c+"px",top:""+a.yOffset*c+"px",width:""+a.width+"px",height:""+a.height+"px","-moz-transform-origin":"0% 0%","-webkit-transform-origin":"0% 0%","-ms-transform-origin":"0% 0%","transform-origin":"0% 0%"},""!==e&&(d["-moz-transform"]=e,d["-webkit-transform"]=e,d["-ms-transform"]=e,d.transform=e),null!=a.fadeValue&&(d.opacity=""+a.fadeValue),d},a.prototype.classForAsset=function(a){return this.styleProvider.classForAsset(a)},a.prototype.classForGraphicAsset=function(a){var b;return null!=(null!=a&&null!=(b=a.asset)?b.type:void 0)?a.asset.type+"-asset":""},a.prototype.backgroundSourceURL=function(a){return a.sourceUrl},a.prototype.textAssetImageURL=function(a){return this._escapeQuotes(this.imageURLService.imageURLForTextAsset(a))},a.prototype._escapeQuotes=function(a){var b;return this.stylesAsString?(b=null!=a?a.replace(/"/g,"&quot;"):void 0,b=null!=b?b.replace(/'/g,"\\'"):void 0,"'"+b+"'"):a},a.prototype.styleForImageWrapper=function(a){return this._prepareStyles(this.styleProvider.styleForImageAssetWrapper(a))},a.prototype._prepareStyles=function(a){var b,c,d;if(!this.stylesAsString)return a;b="";for(c in a)d=a[c],b+=""+c+": "+d+"; ";return b},a.prototype.styleForImage=function(a){return this._prepareStyles(this.styleProvider.styleForImageAsset(a))},a.prototype.styleForFadeUnderlay=function(a){return this._prepareStyles(this.styleProvider.styleForFadeUnderlay(a))},a.prototype.imageAssetURL=function(a){return"uppTemp"===a.data?this._escapeQuotes(this.imageURLService.thumbURLForImageAsset(a)):this._escapeQuotes(this.imageURLService.imageURLForImageAsset(a,1))},a}(),b.$inject=["pageStyleProvider","imageURLService","adaptiveLayoutService","contentService","CONFIG"],a={bindings:{activeTab:"<",onTabSelected:"&",tabs:"<",gridCellAssets:"<"},controller:b,templateUrl:"SilverApp/views/gc/event-dialog-grid-cell-preview.html"},angular.module("galleon-gc").component("gridCellPreview",a)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b,d,e,f){this.eventBus=a,this.$timeout=b,this.element=e,this.attrs=f,this.onLayoutApplied=c(this.onLayoutApplied,this),a.subscribe(a.events.TRANSIENT_LAYOUT_STARTED,this.onLayoutApplied,d)}return a.prototype.onLayoutApplied=function(a,b){if(this.attrs.transientPageNumber===""+b.surfaceNumber)return this.element.addClass("transient-layout-active"),this.$timeout(function(a){return function(){return a.element.removeClass("transient-layout-active")}}(this),3e3)},a}(),b=function(b,c){return{restrict:"A",link:function(d,e,f){return new a(b,c,d,e,f)}}},b.$inject=["eventBus","$timeout"],angular.module("silverApp").directive("sfTransientLayoutActivator",b)}.call(this),function(){"use strict";var a,b;a=function(){function a(a,b,c){this.$window=a,this.config=b,this.deviceDetectionService=c,this.bowser=this.$window.bowser,this.dds=this.deviceDetectionService}return a.prototype.link=function(){var a,b,c,d;return a=angular.element(this.$window.document.documentElement),c=function(a){return a.toLowerCase().replace(/[^a-z0-9_-]+/g,"-")},b=c(this.bowser.version),(d=function(a){var b;b=new Image,b.onload=b.onerror=function(){return a(2===b.height)},b.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"})(function(c){return function(d){var e,f;return(c.bowser.msedge||!d&&!(c.bowser.safari||c.dds.isDeviceAPhone()||c.dds.isDeviceATablet()||c.bowser.firefox||c.bowser.mobile||c.bowser.msie&&c.bowser.version<=11))&&(c.bowser.chrome&&(c.bowser.chrome=!1),b="11-0",c.bowser.msedge=!1,c.bowser.msie=!0,c.edgeIsIe=!0),f="msie firefox chrome safari ipad",c.dds.isDeviceATablet()&&!c.bowser.msie&&(c.bowser.tablet=!0,f+=" tablet"),c.dds.isDeviceAPhone()&&(c.bowser.mobile=!0,f+=" mobile"),"iPhone"===c.bowser.name&&(f+=" iphone"),c.bowser.android&&(f+=" android"),e=f.split(" ").map(function(a){return c.bowser[a]?"bda-"+a+" bda-"+a+"-"+b:"bda-not-"+a}).join(" "),c.edgeIsIe&&(c.bowser.msedge=!0,c.bowser.msie=!1),a.addClass(e)}}(this))},a}(),b=function(b,c,d){return{restrict:"E",link:function(e,f,g){var h;return h=new a(b,c,d),h.link()}}},b.$inject=["$window","CONFIG","deviceDetectionService"],angular.module("silverApp").directive("browserDetailAppender",b)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b,d){var e,f;this.scope=a,this.element=b,this.attrs=d,this._initJcrop=c(this._initJcrop,this),this.ignoreNextCrop=!1,f=function(a){return function(b){var c;return a.ignoreNextCrop?void(a.ignoreNextCrop=!1):(c=[b.x,b.y,b.x2,b.y2],angular.equals(c,a.lastCropValues)?void 0:a._onSelect(c))}}(this),e=function(a){return function(){var b;if(a.ignoreNextCrop=!0,null!=a.lastCropValues)return null!=(b=a.jcrop)?b.setSelect(a.lastCropValues):void 0}}(this),this.options={keySupport:!1,allowSelect:!1,onSelect:f,onRelease:e,minSize:[1,1]}}return a.prototype.link=function(){return this._cleanup(),this.scope.$watch(function(a){return function(){return[a.scope.asset.imageAssignmentRotation,a.scope.well.uniqueProjectRef,a.scope.resetCount,a.scope.asset.effect,a.scope.asset.fadeValue]}}(this),function(a){return function(b,c){var d,e,f,g,h;return g=c[1]!==b[1],h=c[2]!==b[2],d=angular.equals(b,c),e=c[3]!==b[3],f=c[4]!==b[4],a.ignoreNextCrop=h||g||d||e||f,a.lastCropValues=h||g?null:a.lastCropValues,a._initJcrop()}}(this),!0),this.scope.$watch("cropping",function(a){return function(b,c){if(b!==c)return b&&null!=a.lastCropValues?(a.ignoreNextCrop=!0,a._initJcrop()):b===!1?a._cleanup():void 0}}(this)),this.scope.$on("$destroy",function(a){return function(){return a._cleanup()}}(this))},a.prototype._cleanup=function(){var a,b,c,d,e,f;for(null!=(d=this.jcrop)&&"function"==typeof d.release&&d.release(),null!=(e=this.jcrop)&&"function"==typeof e.destroy&&e.destroy(),this.jcrop=null,f=["visibility","height","width","display"],b=0,c=f.length;b<c;b++)a=f[b],this.element.css(a,"");return this.element.removeAttr("width height"),angular.element(".jcrop-holder").remove()},a.prototype._initJcrop=function(){var a,b,c,d,e;if(this.attrs.src)return c=this.ignoreNextCrop,this._cleanup(),this.ignoreNextCrop=c,e=this._calculateImageWidthAndHeight(this.attrs.maxWidth),d=e[0],a=e[1],this.element.attr("width",d),this.element.attr("height",a),this.options.aspectRatio=this.scope.well.asset.containerWidth/this.scope.well.asset.containerHeight,this.lastCropValues=null!=this.lastCropValues?this.lastCropValues:this._calculateScaledCrop(a,d,this.scope.well),this.options.setSelect=this.lastCropValues,b=this,this.element.Jcrop(this.options,function(){return b.jcrop=this,b.scope.onInit()})},a.prototype._calculateScaledCrop=function(a,b,c){return[b*c.imageAssignmentLlx,a-a*c.imageAssignmentUry,b*c.imageAssignmentUrx,a-a*c.imageAssignmentLly].map(Math.ceil)},a.prototype._calculateImageWidthAndHeight=function(a){var b,c,d;return d=this._getRotatedWidthAndHeight(this.scope.asset),c=d[0],b=d[1],c>b?[a,b*a/c].map(function(a){return parseFloat(a)}):[c*a/b,a].map(function(a){return parseFloat(a)})},a.prototype._getRotatedWidthAndHeight=function(a){var b,c,d;switch(d=[a.imageAssignmentWidth,a.imageAssignmentHeight],c=d[0],b=d[1],[90,270].indexOf(a.imageAssignmentRotation)){case-1:return[c,b];default:return[b,c]}},a.prototype._onSelect=function(a){var b;return this.lastCropValues=a,b=this._translateCropValues(a,this._calculateImageWidthAndHeight(this.attrs.maxWidth)),this.scope.onCrop({crop:b})},a.prototype._translateCropValues=function(a,b){return[a[0]/b[0],1-a[3]/b[1],a[2]/b[0],1-a[1]/b[1]]},a}(),b=function(){return{restrict:"A",scope:{model:"=",asset:"=",well:"=",cropping:"=",resetCount:"=",onCrop:"&",onInit:"&"},link:function(b,c,d){return new a(b,c,d).link()}}},a.$inject=[],angular.module("silverApp").directive("croppable",b)}.call(this),function(){"use strict";var a;a=function(a){return{priority:2,restrict:"A",link:function(b,c,d){if(d.linkname)return c.bind("click",function(){var b;return b={linkName:d.linkname},d.pagename&&(b.pageName=a.devicePrefixForName+d.pagename),a.trackLink(b)})}}},a.$inject=["omnitureService"],angular.module("silverApp").directive("omniture",a)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b,d,e,f,g,h,i){this.dragDropService=a,this.$parse=b,this.dragAvatarProducer=d,this.$rootScope=e,this.projectService=f,this.touchService=g,this.$timeout=h,this.deviceDetectionService=i,this._touchend=c(this._touchend,this),this._touchmove=c(this._touchmove,this),this._cancelPressTimer=c(this._cancelPressTimer,this),this._touchstart=c(this._touchstart,this),this._processPressTimer=c(this._processPressTimer,this),this._isScrollingEnabled=c(this._isScrollingEnabled,this),this._enableScrolling=c(this._enableScrolling,this),this._disableScrolling=c(this._disableScrolling,this),this._drag=c(this._drag,this),this._dragend=c(this._dragend,this),this._dragstart=c(this._dragstart,this),this._tendToEndDrag=c(this._tendToEndDrag,this),this._tendToDrag=c(this._tendToDrag,this)}return a.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.el=this.element[0],this.el.draggable=!0,this.el.addEventListener("dragstart",this._dragstart,!1),this.el.addEventListener("touchstart",this._touchstart,!1),this.el.addEventListener("dragend",this._dragend,!1),this.el.addEventListener("drag",this._drag,!1),this.el.addEventListener("mousedown",this._tendToDrag,!1),this.el.addEventListener("mouseup",this._tendToEndDrag,!1),this.updateStage=this.scope.$eval(this.attrs.updateStage),this.scope.$on("$destroy",function(a){return function(){return a.el.removeEventListener("dragstart",a._dragstart,!1),a.el.removeEventListener("touchstart",a._touchstart,!1),a.el.removeEventListener("dragend",a._dragend,!1),a.el.removeEventListener("drag",a._drag,!1),a.el.removeEventListener("mousedown",a._tendToDrag,!1),a.el.removeEventListener("mouseup",a._tendToEndDrag,!1)}}(this)),this.scope.directive=this,this},a.prototype._tendToDrag=function(a){if(this.updateStage===!0)return this.$rootScope.dragStage="draginit"},a.prototype._tendToEndDrag=function(a){if(this.updateStage===!0)return this.$rootScope.dragStage="dragend"},a.prototype._dragstart=function(a){var b,c,d,e,f,g,h,i;return this.updateStage===!0&&(this.$rootScope.dragStage="dragstart"),b=this.$parse(this.attrs.dragAsset)(this.scope),c=parseInt(this.attrs.assetindex,10),f=null!=(null!=(h=this.attrs)?h.dragOptions:void 0)?this.scope.$eval(this.attrs.dragOptions):{},null==b&&null!=(null!=f?f.pageNumber:void 0)&&(d=this.projectService.currentProject.product,g=d.pageBySurfaceNumber(f.pageNumber),b=g.layout.assets[c]),e=a.dataTransfer||(null!=(i=a.detail)?i.dataTransfer:void 0),(null!=b?b.isDragDisabled:void 0)?(a.preventDefault(),void(this.el.draggable=!1)):(null!=(null!=e?e.effectAllowed:void 0)&&(e.effectAllowed="move"),f.useCustomAvatar&&this.dragAvatarProducer.produceAvatar(this.el,e),null!=e&&e.setData("text",this.el.id),this.dragDropService.currentlyDraggedAsset=b,this.dragDropService.dragOptions=f,this.dragDropService.dragOptions.location=this.attrs.location,this._disableScrolling(),!1)},a.prototype._dragend=function(a){return this.updateStage===!0&&(this.$rootScope.dragStage="dragend"),this.dragDropService.dragOptions=null,this.dragDropService.dropOptions=null,!1},a.prototype._drag=function(a){if(this.updateStage===!0&&"dragging"!==this.$rootScope.dragStage&&(this.$rootScope.dragStage="dragging"),!this._isScrollingEnabled())return this._enableScrolling()},a.prototype._disableScrolling=function(){return this.scope.scrollDisabledOnDrag=!0,angular.element(".palette-tabs .palette-body").css("overflow-x","hidden"),angular.element(".secondary-palette .palette-body").css("overflow-y","hidden")},a.prototype._enableScrolling=function(){return this.scope.scrollDisabledOnDrag=!1,angular.element(".palette-tabs .palette-body").css("overflow-x","auto"),angular.element(".secondary-palette .palette-body").css("overflow-y","auto")},a.prototype._isScrollingEnabled=function(){return!this.scope.scrollDisabledOnDrag},a.prototype._draggedAsset=function(){return this.dragDropService.currentlyDraggedAsset},a.prototype._processPressTimer=function(a){var b;return this._cancelPressTimer(a),this._dragstart(a),b=this._draggedAsset(),"image"!==(null!=b?b.asset.assetType:void 0)?void this._dragend():this.scope.$apply(function(c){return function(){return c.touchService.createAssetClone(a,b),c.el.style.opacity="0.5",c.touchService.startMove(a),c.el.addEventListener("touchmove",c._touchmove,!1),c.el.addEventListener("touchend",c._touchend,!1)}}(this))},a.prototype._touchstart=function(a){return null!=a&&"function"==typeof a.preventDefault&&a.preventDefault(),this._dispatchAssetTapEvent(a,a.target),this.touchService.pressTimer=this.$timeout(function(b){return function(){return b._processPressTimer(a)}}(this),500),this.deviceDetectionService.isAndroidTablet()||this.el.addEventListener("touchmove",this._cancelPressTimer,!1),this.el.addEventListener("touchend",this._cancelPressTimer,!1),!1},a.prototype._cancelPressTimer=function(a){return this.touchService.touchCancelTimer(),this.deviceDetectionService.isAndroidTablet()||this.el.removeEventListener("touchmove",this._cancelPressTimer,!1),this.el.removeEventListener("touchend",this._cancelPressTimer,!1)},a.prototype._touchmove=function(a){return this.scope.$apply(function(b){return function(){var c;return c=b.touchService.touchMove(a),b.$rootScope.$broadcast("assetdrag:move",c)}}(this))},a.prototype._touchend=function(a){return this.el.removeEventListener("touchmove",this._touchmove,!1),this.el.removeEventListener("touchend",this._touchend,!1),this.scope.$apply(function(b){return function(){var c;return b.el.style.opacity="1.0",c=b.touchService.touchEnd(a),b.$rootScope.$broadcast("assetdrag:end",c)}}(this))},a.prototype._dispatchAssetTapEvent=function(a,b){var c;if(null!=b)return c={dataTransfer:a.dataTransfer,clientX:a.clientX,clientY:a.clientY},b.dispatchEvent(new CustomEvent("assettap",{detail:c}))},a}(),b=function(b,c,d,e,f,g,h,i){return{restrict:"A",link:function(j,k,l){var m;return m=new a(b,c,d,e,f,g,h,i),m.link(j,k,l)}}},b.$inject=["dragDropService","$parse","dragAvatarProducer","$rootScope","projectService","touchService","$timeout","deviceDetectionService"],angular.module("silverApp").directive("sfDraggable",b)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b,d,e,f,g,h){this.dragDropService=a,this.$parse=b,this.customizePageCtrl=d,this.projectService=e,this.appState=f,this.dropProxyHelper=g,this.touchService=h,this._getDragDropAssets=c(this._getDragDropAssets,this),this._updateDragDropState=c(this._updateDragDropState,this),this._drop=c(this._drop,this),this._dragleave=c(this._dragleave,this),this._dragenter=c(this._dragenter,this),this._dragover=c(this._dragover,this),this._touchend=c(this._touchend,this),this._touchmove=c(this._touchmove,this)}return a.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.indicateDroppable=this.scope.$eval(this.attrs.indicateDroppable)!==!1,this.el=this.element[0],this.el.addEventListener("dragover",this._dragover,!1),this.el.addEventListener("dragenter",this._dragenter,!1),this.el.addEventListener("dragleave",this._dragleave,!1),this.el.addEventListener("drop",this._drop,!1),this.scope.$on("assetdrag:move",this._touchmove),this.scope.$on("assetdrag:end",this._touchend),this.scope.$on("$destroy",function(a){return function(){return a.el.removeEventListener("dragover",a._dragover,!1),a.el.removeEventListener("dragenter",a._dragenter,!1),a.el.removeEventListener("dragleave",a._dragleave,!1),a.el.removeEventListener("drop",a._drop,!1)}}(this)),this.scope.directive=this,this},a.prototype._touchmove=function(a,b){var c;if(!this.touchService.isSameImage(this.el.src||"image"!==(null!=(c=this.dragDropService.currentlyDraggedAsset)?c.asset.assetType:void 0)))return null==this.boundingClientRect&&(this.boundingClientRect=this.el.getBoundingClientRect()),this.touchService.isTouching(b,this.boundingClientRect)?this._dragover(b.event):this._dragleave(b.event)},a.prototype._touchend=function(a,b){var c;if(!this.touchService.isSameImage(this.el.src||"image"!==(null!=(c=this.dragDropService.currentlyDraggedAsset)?c.asset.assetType:void 0)))return null==this.boundingClientRect&&(this.boundingClientRect=this.el.getBoundingClientRect()),this.touchService.isTouching(b,this.boundingClientRect)?this._drop(b.event):this._dragleave(b.event),this.boundingClientRect=null},a.prototype._dragover=function(a){var b,c,d,e,f,g;return f=this._updateDragDropState(a),c=f[0],d=f[1],this.dragDropService.isDroppable(c,d)?(b=a.dataTransfer||(null!=(g=a.detail)?g.dataTransfer:void 0)||{},"string"==typeof b.dropEffect&&(b.dropEffect="move"),e=this.scope.$eval(this.attrs.dropProxyClass),""!==e&&($(".active-dropable-proxy").removeClass("active-dropable-proxy"),$("."+e).addClass("active-dropable-proxy")),"function"==typeof a.preventDefault&&a.preventDefault(),this.indicateDroppable&&this.dragDropService.showDropIndicator(c,d,this.el)):this.dragDropService.isDragOnlyTarget(d)&&!this.dragDropService.targetPagesAreSame()&&this.indicateDroppable&&this.dragDropService.showDropIndicator(c,d,this.el),!1},a.prototype._dragenter=function(a){var b,c,d;return d=this._updateDragDropState(a),b=d[0],c=d[1],(this.dragDropService.isDroppable(b,c)||this.dragDropService.isDragOnlyTarget(c)&&!this.dragDropService.targetPagesAreSame())&&this.indicateDroppable&&this.dragDropService.showDropIndicator(b,c,this.el),!1},a.prototype._dragleave=function(a){var b,c,d,e;return d=this._getDragDropAssets(a),b=d[0],c=d[1],this.indicateDroppable&&this.dragDropService.hideDropIndicator(b,c,this.el),null!=(e=this.customizePageCtrl)&&e.finishDrop(),!1},a.prototype._drop=function(a){var b,c,d,e,f,g,h;return 0!==(null!=a&&null!=(f=a.type)?f.indexOf("touch"):void 0)&&this.appState.hideTooltips(a.target),g=this._updateDragDropState(a),c=g[0],d=g[1],this.indicateDroppable&&this.dragDropService.hideDropIndicator(c,d,this.el),this.dragDropService.isDroppable(c,d)&&("function"==typeof a.stopPropagation&&a.stopPropagation(),"function"==typeof a.preventDefault&&a.preventDefault(),b=this.dragDropService.getDropAction(c,d),e=this._getDropOffsetFromPage(a),b&&b(e)),null!=(h=this.customizePageCtrl)&&h.finishDrop(),!1},a.prototype._getDropOffsetFromPage=function(a){var b,c,d,e,f;if(c=angular.element(a.target).closest("sf-page, sf-customize-page, sf-simple-page, .storyboard-pages"),d=c.offset(),e=a.pageX||a.x,f=a.pageY||a.y,b={xPercent:0,yPercent:0},null!=d)return d={xPercent:(e-d.left)/c.width(),yPercent:(f-d.top)/c.height()}},a.prototype._updateDragDropState=function(a){var b,c;return b=this._dropOptions(a),this.dragDropService.dropOptions=b,c=this._getDropProxyLocation(),null!=this.attrs.dropProxyClass&&c?this.dragDropService.dropOptions.location=c:null==this.customizePageCtrl&&(this.dragDropService.dropOptions.location=this.attrs.location),this._getDragDropAssets(a)},a.prototype._dropOptions=function(a){var b;return null!=this.customizePageCtrl?this.customizePageCtrl.updateDropState(a):null!=(null!=(b=this.attrs)?b.dropOptions:void 0)?this.scope.$eval(this.attrs.dropOptions):{}},a.prototype._getDropProxyAsset=function(a){var b;return this.dropProxyHelper.getDropProxyAsset(a,null!=(b=this.dragDropService.dropOptions)?b.pageNumber:void 0)},a.prototype._getDropProxyLocation=function(){var a,b,c,d,e;if(null==this.attrs.dropProxyClass)return null;try{return b=this.scope.$eval(this.attrs.dropProxyClass),e=this.el.closest("sf-page, sf-customize-page, sf-simple-page, .storyboard-pages"),d=$(e).find("."+b+" img"),a=$(d).attr("location")}catch(a){return c=a,null}},a.prototype._getDragDropAssets=function(a){var b,c;return b=null!=this.customizePageCtrl?this.customizePageCtrl.dropAsset(a):this._fetchDropAsset(),null!=this.attrs.dropProxyClass&&(c=this._getDropProxyAsset(b),null!=c&&(b=c)),[this.dragDropService.currentlyDraggedAsset,b]},a.prototype._fetchDropAsset=function(){var a,b,c;if(null!=this.attrs.dropAsset)return this.$parse(this.attrs.dropAsset)(this.scope);if(null!=this.attrs.assetindex)return a=parseInt(this.attrs.assetindex,10),b=this.projectService.currentProject.product,c=b.pageBySurfaceNumber(this.dragDropService.dropOptions.pageNumber),c.layout.assets[a]},a}(),b=function(b,c,d,e,f,g){return{restrict:"A",require:"?sfCustomizePage",link:function(h,i,j,k){var l;return l=new a(b,c,k,d,e,f,g),l.link(h,i,j)}}},b.$inject="dragDropService $parse projectService appState dropProxyHelper touchService".split(" "),angular.module("silverApp").directive("sfDroppable",b)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b,d,e,f,g){this.$rootScope=a,this.$parse=b,this.movePageService=d,this.touchService=e,this.$timeout=f,this.appState=g,this._touchend=c(this._touchend,this),this._touchmove=c(this._touchmove,this),this._cancelPressTimer=c(this._cancelPressTimer,this),this._touchstart=c(this._touchstart,this),this._dragstart=c(this._dragstart,this)}return a.prototype.link=function(a,b,c){if(this.scope=a,this.element=b,this.attrs=c,!this.attrs.isPageMoveDisabled&&!this.appState.inPreviewMode)return this.el=this.element[0],this.scope.directive=this,this.el.draggable=!0,this.el.addEventListener("touchstart",this._touchstart,!1),this.el.addEventListener("dragstart",this._dragstart,!1),this.scope.$on("$destroy",function(a){return function(){return a.el.removeEventListener("dragstart",a._dragstart,!1),a.el.removeEventListener("touchstart",a._touchstart,!1)}}(this)),this},a.prototype._dragstart=function(a){var b,c,d,e,f;return d=null,c=null!=a&&null!=(e=a.target)?e.getAttribute("location"):void 0,(this.touchService.hasTouch||"well"!==c&&"graphic"!==c)&&(d=this.$parse(this.attrs.movePageNumber)(this.scope)),b=a.dataTransfer||(null!=(f=a.detail)?f.dataTransfer:void 0),b&&(b.effectAllowed="move",b.setData("text",""+d)),this.movePageService.assignSource(d),!1},a.prototype._touchstart=function(a){return this.pressTimer=this.$timeout(function(b){return function(){var c;if(b._cancelPressTimer(a),b._dragstart(a),c=b.$parse(b.attrs.movePageNumber)(b.scope))return b.scope.$apply(function(){return b.touchService.createPageClone(a,c),b.touchService.startMove(a),b.el.addEventListener("touchmove",b._touchmove,!1),b.el.addEventListener("touchend",b._touchend,!1)})}}(this),200),this.el.addEventListener("touchmove",this._cancelPressTimer,!1),this.el.addEventListener("touchend",this._cancelPressTimer,!1)},a.prototype._cancelPressTimer=function(a){return this.$timeout.cancel(this.pressTimer),this.el.removeEventListener("touchmove",this._cancelPressTimer,!1),this.el.removeEventListener("touchend",this._cancelPressTimer,!1)},a.prototype._touchmove=function(a){return this.scope.$apply(function(b){return function(){var c;return c=b.touchService.touchMove(a),b.$rootScope.$broadcast("pagedrag:move",c)}}(this))},a.prototype._touchend=function(a){return this.el.removeEventListener("touchmove",this._touchmove,!1),this.el.removeEventListener("touchend",this._touchend,!1),this.scope.$apply(function(b){return function(){var c;return c=b.touchService.touchEnd(a),b.$rootScope.$broadcast("pagedrag:end",c)}}(this))},a}(),b=function(b,c,d,e,f,g){return{restrict:"A",link:function(h,i,j){var k;return k=new a(b,c,d,e,f,g),k.link(h,i,j)}}},b.$inject="$rootScope $parse movePageService touchService $timeout appState".split(" "),angular.module("silverApp").directive("sfPageMoveableSource",b)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b,d,e,f){this.$parse=a,this.movePageService=b,this.appState=d,this.projectService=e,this.touchService=f,this._isDropAllowed=c(this._isDropAllowed,this),this._touchend=c(this._touchend,this),this._touchmove=c(this._touchmove,this),this._drop=c(this._drop,this),this._dragleave=c(this._dragleave,this),this._dragenter=c(this._dragenter,this),this._dragover=c(this._dragover,this)}return a.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.el=this.element[0],this.scope.directive=this,this.scope.$on("pagedrag:move",this._touchmove),this.scope.$on("pagedrag:end",this._touchend),this.el.addEventListener("dragover",this._dragover,!1),this.el.addEventListener("dragenter",this._dragenter,!1),this.el.addEventListener("dragleave",this._dragleave,!1),this.el.addEventListener("drop",this._drop,!1),this.scope.$on("$destroy",function(a){return function(){return a.el.removeEventListener("dragover",a._dragover,!1),a.el.removeEventListener("dragenter",a._dragenter,!1),a.el.removeEventListener("dragleave",a._dragleave,!1),a.el.removeEventListener("drop",a._drop,!1)}}(this))},a.prototype._dragover=function(a){var b,c;return this._isDropAllowed()&&(b=a.dataTransfer||(null!=(c=a.detail)?c.dataTransfer:void 0)||{},"string"==typeof b.dropEffect&&(b.dropEffect="move"),"function"==typeof a.preventDefault&&a.preventDefault(),this.el.classList.add("move-target-active")),!1},a.prototype._dragenter=function(a){return this._isDropAllowed()&&this.el.classList.add("move-target-active"),!1},a.prototype._dragleave=function(a){return this.el.classList.remove("move-target-active"),!1},a.prototype._drop=function(a){return this.appState.hideTooltips(a.target),this._isDropAllowed()&&("function"==typeof a.stopPropagation&&a.stopPropagation(),"function"==typeof a.preventDefault&&a.preventDefault(),this.el.classList.remove("move-target-active"),this.movePageService.assignTarget(this.targetPageNumber),this.movePageService.executeMove()),!1},a.prototype._touchmove=function(a,b){var c;if(c=this.$parse(this.attrs.movePageNumber)(this.scope),!this.touchService.isSameTarget(c))return null==this.boundingClientRect&&(this.boundingClientRect=this.el.getBoundingClientRect()),this.touchService.isTouching(b,this.boundingClientRect)?this._dragover(a):this._dragleave(a)},a.prototype._touchend=function(a,b){return this.touchService.isTouching(b,this.boundingClientRect)?this._drop(a):this._dragleave(a),this.boundingClientRect=null},a.prototype._isDropAllowed=function(){var a,b,c,d;return null!=this.movePageService.sourcePage&&(this.targetPageNumber=this.$parse(this.attrs.movePageNumber)(this.scope),c=this.projectService.currentProject.product,a=c.pageBySurfaceNumber(this.movePageService.sourcePage),b=c.pageBySurfaceNumber(this.targetPageNumber),!(a.isSpread()&&this.targetPageNumber%2===0&&!b.isSpread())&&(d=c.spreadNumberAfterPageNumber(this.targetPageNumber),a!==c.lastPage()||!c.lastPageIsEven()||null==d))},a}(),b=function(b,c,d,e,f){return{restrict:"A",link:function(g,h,i){var j;return j=new a(b,c,d,e,f),j.link(g,h,i)}}},b.$inject="$parse movePageService appState projectService touchService".split(" "),angular.module("silverApp").directive("sfPageMoveableTarget",b)}.call(this),function(){var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(){this._validatePricing=c(this._validatePricing,this),this._handleClick=c(this._handleClick,this)}return a.prototype.link=function(a,b,c,d){var e;return this.scope=a,this.element=b,this.attrs=c,this.$timeout=d,this.scope.hasValidPrice=!1,this.scope.isReceiptVisible=!1,this.scope.dataTestKeySuffix=["","","_Cover_FINISH","","","","","","",""],this.scope.pricingLink=this._generateLinkName(),this.scope.$watch("bookPricing",this._validatePricing),e=this._handleClick.bind(this),$(document).off("click",e),$(document).on("click",e),this},a.prototype._handleClick=function(a){var b;if(this.scope.isEnabled)return b=angular.element(a.target),this.scope.$evalAsync(function(a){return function(){return b.closest(".navbar-price").hasClass("navbar-price")?a.scope.isReceiptVisible=!0:a.scope.isReceiptVisible=!1}}(this))},a.prototype._generateLinkName=function(){var a,b,c,d;for(c="",b=d=0;d<8;b=++d)a=Math.floor(26*Math.random())+65,c+=String.fromCharCode(a);return"pricingLink-"+c},a.prototype._validatePricing=function(){var a,b;return a=null!=(b=this.scope.bookPricing)?b.totalOrigPrice:void 0,this.scope.hasValidPrice=!isNaN(parseFloat(a))},a}(),b=function(b){return{restrict:"E",templateUrl:"SilverApp/views/pricing-receipt.html",scope:{descriptionId:"=",pageCount:"=",bookPricing:"=",bindingType:"=",isEnabled:"="},transclude:!1,link:function(c,d,e){return(new a).link(c,d,e,b)}}},b.$inject=["$timeout"],angular.module("galleon").directive("sfPricingReceipt",b)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b){this.document=a,this.$window=b,this.tryClose=c(this.tryClose,this),this.bowser=this.$window.bowser;
}var b,d,e,f,g,h,i,j;return b="80,4,80,35,102,42,120,59,125,79,155,79,147,48,129,25,105,11",i="79,4,80,34,60,44,45,60,34,79,5,79,14,41,41,15",d=6,g=2,e=5,f=4,j=2,h=.06,a.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.scope.directive=this,this.scope.history=[],this._setUpScope(),this.nativeElement=this.element[0],this.redEyeGlass=this.nativeElement.querySelector(".red-eye-glass"),this.zoomedImage=this.nativeElement.querySelector("#redEyeZoomedImage"),this.preloader=this.nativeElement.querySelector("#redeyeImgPreloader"),this.preloader.onload=function(a){return function(){return a._initImage()}}(this),this.parentNode=this.nativeElement.parentNode,this._sizeToParent(),this._centerGlass(),this._initImage(),this._handleGlassDrag(),this._initDraggable(),this._setUpWatchAndListeners()},a.prototype.registerEventOnce=function(){return this.document.off("click",this.tryClose),this.document.on("click",this.tryClose)},a.prototype._initDraggable=function(){var a;return a={cursor:"move",containment:this._containmentForDragging(),drag:function(a){return function(){return a._handleGlassDrag()}}(this)},angular.element(this.zoomedImage).draggable(a)},a.prototype._handleGlassDrag=function(){var a,b,c,d;return d=this.zoomedImage.getBoundingClientRect(),a=this.nativeElement.getBoundingClientRect(),this.lastPickedX=Math.floor(d.left-a.left+d.width/2),this.lastPickedY=Math.floor(d.top-a.top+d.height/2),b=(this.lastPickedX*j-d.width/2)*-1,c=(this.lastPickedY*j-d.height/2)*-1,this.zoomedImage.style.backgroundPosition=""+Math.floor(b)+"px "+Math.floor(c)+"px"},a.prototype._containmentForDragging=function(){var a,b,c,h;return a=this.zoomedImage.offsetWidth/2,c=this.parentNode.getBoundingClientRect(),b=c.left,h=c.top,[b-(a-(e-f)-.5),h-(a-(d-g)+3),b+c.width-a+.5,h+c.height-a+(d-g)-3]},a.prototype._sizeToParent=function(){var a,b;return this.nativeElement.style.width=""+this.parentNode.offsetWidth+"px",this.nativeElement.style.height=""+this.parentNode.offsetHeight+"px",null!=this.document[0].documentMode||this.bowser.msie||this.bowser.msedge?(b=this.nativeElement.offsetParent.getBoundingClientRect(),a=(b.width-this.parentNode.offsetWidth)/2,this.nativeElement.style.left=""+a+"px"):(this.nativeElement.style.top=""+this.parentNode.offsetTop+"px",this.nativeElement.style.left=""+this.parentNode.offsetLeft+"px")},a.prototype._centerGlass=function(){var a,b,c,d;return a=this.nativeElement.offsetWidth/2,b=this.nativeElement.offsetHeight/2,d=b-this.zoomedImage.offsetHeight/2,c=a-this.zoomedImage.offsetWidth/2,this.zoomedImage.style.top=""+d+"px",this.zoomedImage.style.left=""+c+"px"},a.prototype._initImage=function(){if(null!=this.scope.imageUrl)return this.zoomedImage.style.backgroundImage="url("+this.scope.imageUrl+")",this.zoomedImage.style.backgroundSize=""+this.nativeElement.offsetWidth*j+"px "+this.nativeElement.offsetHeight*j+"px"},a.prototype._setUpWatchAndListeners=function(){return this.scope.$watch("imageUrl",function(a){return function(b){return a.preloader.src=b}}(this))},a.prototype.tryClose=function(a){var b;if(b=angular.element(a.target),!b.closest("#redEyeGlass").length&&"redEyeUndo"!==("function"==typeof b.attr?b.attr("id"):void 0)&&"redEyeApply"!==("function"==typeof b.attr?b.attr("id"):void 0))return this.scope.onCloseReady&&!b.hasClass(this.scope.handlerClass)&&this.scope.onCloseReady(),!0},a.prototype._setUpScope=function(){return this.scope.$on("$destroy",function(a){return function(){return a.preloader.onload=void 0}}(this)),this.scope.applyImageMapCoords=b,this.scope.undoImageMapCoords=i,this.scope.undo=function(a){return function(){var b;return a.scope.history.pop(),"function"==typeof(b=a.scope).onStackChange?b.onStackChange(a._stackChangeParams()):void 0}}(this),this.scope.apply=function(a){return function(){var b,c;if(b=a._createRedEyeRect(),null!=b)return a.scope.history.push(b),"function"==typeof(c=a.scope).onStackChange?c.onStackChange(a._stackChangeParams()):void 0}}(this)},a.prototype._createRedEyeRect=function(){var a,b,c,d;if(a=this._rotationCorrectedSize(),d=this._rectInsetSize(a.width,a.height),b=this._rotationCorrectedPickedPoint(a,d),c={x:b.x-d/2,y:b.y+d/2,width:d,height:d},c.x+c.width>a.width&&(c.width=a.width-c.x),c.y+c.height>a.height&&(c.height=a.height-c.y),!(c.width<1||c.height<1||c.x<0||c.y<0))return c},a.prototype._rotationCorrectedPickedPoint=function(a,b){return 0===this.scope.imageRotation||null==this.scope.imageRotation?{x:this.lastPickedX,y:this.lastPickedY}:180===this.scope.imageRotation?{x:a.width-this.lastPickedX,y:a.height-this.lastPickedY}:90===this.scope.imageRotation?{x:this.lastPickedY,y:a.height-this.lastPickedX}:270===this.scope.imageRotation?{x:a.width-this.lastPickedY,y:this.lastPickedX}:void 0},a.prototype._rotationCorrectedSize=function(){var a;return a=null!=this.scope.imageRotation&&(90===this.scope.imageRotation||270===this.scope.imageRotation),{width:a===!0?this.nativeElement.offsetHeight:this.nativeElement.offsetWidth,height:a===!0?this.nativeElement.offsetWidth:this.nativeElement.offsetHeight}},a.prototype._stackChangeParams=function(){return{dimension:this._rotationCorrectedSize(),rects:this.scope.history}},a.prototype._rectInsetSize=function(a,b){var c,d,e;return d=a<b?a:b,c=d*h,e=this.zoomedImage.offsetWidth/2,c>e?e:c},a}(),b=function(c,d){return{restrict:"E",templateUrl:"SilverApp/views/red-eye-glass.html",scope:{imageUrl:"=",imageRotation:"=",handlerClass:"@",onStackChange:"&",onCloseReady:"&"},transclude:!0,registeredDomEvents:!1,link:function(e,f,g){var h;if(h=new a(c,d),h.link(e,f,g),!b.registeredDomEvents)return b.registeredDomEvents=!0,h.registerEventOnce()}}},b.$inject=["$document","$window"],angular.module("silverApp").directive("sfRedEyeGlass",b)}.call(this),function(){"use strict";var a,b,c;a=250,b=function(){function b(a,b,c){this.$document=a,this.navService=b,this._currentSpread=void 0,this._nextSpread=void 0,this._prevSpread=void 0,this._activeSpreadIndex=-1,this._spreads=[],this.document=this.$document[0],this.topLeft=c.topLeftKey,this.bottomRight=c.bottomRightKey,this.pageHeightOffset=0,this.movingSpread=!1}return b.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.scope.directive=this,this.scope.$watch("activeSpreadIndex",function(a){return function(b){if(a._updatePageHeightOffset(a.scope.pageHeight,a.scope.focusedSide),null==a._currentSpread&&a._fetchSpreadElements(),null!=a._currentSpread&&b!==a._activeSpreadIndex)return a._updateSpreadPosition(b)}}(this)),this.scope.$watch("focusedSide",function(a){return function(b){return a._updatePageHeightOffset(a.scope.pageHeight,b),a._moveFocusedSide()}}(this)),this.scope.$watch("pageHeight",function(a){return function(b){return a._updatePageHeightOffset(b,a.scope.focusedSide),a._setFocusedSide()}}(this))},b.prototype._updatePageHeightOffset=function(a,b){return"bottom"!==b?void(this.pageHeightOffset=0):this.pageHeightOffset=1.01*a*-1},b.prototype._fetchSpreadElements=function(){if(null!=this.document.getElementById(this.attrs.leftSpreadId))return this._currentSpread=angular.element(this.document.getElementById(this.attrs.leftSpreadId)),this._nextSpread=angular.element(this.document.getElementById(this.attrs.middleSpreadId)),this._prevSpread=angular.element(this.document.getElementById(this.attrs.rightSpreadId)),this._spreads[-1]=this._currentSpread,this._spreads[0]=this._nextSpread,this._spreads[1]=this._prevSpread,this._nextSpread[0].style[this.bottomRight]="-2000px",this._nextSpread[0].style[this.topLeft]="2000px",this._prevSpread[0].style[this.bottomRight]="-2000px",this._prevSpread[0].style[this.topLeft]="2000px"},b.prototype._positionNext=function(a,b){return b?(a[0].style[this.bottomRight]="-2000px",a[0].style[this.topLeft]="2000px"):(a[0].style[this.bottomRight]="2000px",a[0].style[this.topLeft]="-2000px")},b.prototype._updateSpreadPosition=function(a){var b,c;return"function"==typeof(c=this.scope).onStartTransition&&c.onStartTransition(),b=this.navService.lastDirectionForward,this._moveSpreadOffstage(this._currentSpread,b),this._updateSpreadState(b,a),this._positionNext(this._currentSpread,b),this._moveSpreadOnstage(this._currentSpread,b),this._activeSpreadIndex=a},b.prototype._updateSpreadState=function(a,b){return this._currentSpread=this._spreads[b],b===-1?(this._nextSpread=a?this._spreads[0]:this._spreads[1],this._prevSpread=a?this._spreads[1]:this._spreads[0]):0===b?(this._nextSpread=a?this._spreads[1]:this._spreads[-1],this._prevSpread=a?this._spreads[-1]:this._spreads[1]):1===b?(this._nextSpread=a?this._spreads[-1]:this._spreads[0],this._prevSpread=a?this._spreads[0]:this._spreads[-1]):void 0},b.prototype._moveSpreadOffstage=function(b,c){var d;return this.movingSpread=!0,d={opacity:0},d[this.bottomRight]=c?"2000px":"-2000px",d[this.topLeft]=c?"-2000px":"2000px",b.velocity({properties:d,options:{duration:a}})},b.prototype._moveSpreadOnstage=function(b,c){var d;return d={opacity:1},d[this.bottomRight]="0px",d[this.topLeft]=""+this.pageHeightOffset+"px",b.velocity({properties:d,options:{duration:a,complete:function(a){return function(){var b;return a.movingSpread=!1,"function"==typeof(b=a.scope).onStopTransition?b.onStopTransition():void 0}}(this)}})},b.prototype._moveFocusedSide=function(){if(null!=this._currentSpread&&this.movingSpread===!1)return this._currentSpread.velocity({properties:this._focusProps(),options:{duration:a/1.25}})},b.prototype._setFocusedSide=function(){if(null!=this._currentSpread&&this.movingSpread===!1)return this._currentSpread.css(this._focusProps())},b.prototype._focusProps=function(){var a;return a={},a[this.bottomRight]="0px",a[this.topLeft]=""+this.pageHeightOffset+"px",a},b}(),c=function(a,c,d){return{restrict:"E",template:"",scope:{onStartTransition:"&",onStopTransition:"&",activeSpreadIndex:"=",pageHeight:"=",focusedSide:"="},transclude:!0,link:function(e,f,g){var h;return h=new b(a,c,d).link(e,f,g)}}},c.$inject=["$document","navService","sliderKeyProvider"],angular.module("galleon").directive("sfSpreadSlider",c)}.call(this),function(){"use strict";var a,b;a=function(){function a(a,b,c,d,e,f){this.pageResizer=a,this.translate=b,this.$window=c,this.appState=d,this.$timeout=e,this.config=f}return a.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this._setup(),this._updateDimensions(),angular.element(this.$window).on("keydown",function(a){return function(b){if(a.appState.cancelBackgroundWaitingForPicture(),!a.appState.activelyEditingText()&&!a.appState.modalIsOpen())switch(b.keyCode){case 37:a.appState.isCustomizing()||a.scope.onPreviousTapped();break;case 39:a.appState.isCustomizing()||a.scope.onNextTapped()}}}(this))},a.prototype._updateDimensions=function(){var a,b;if(null!=this.scope.activeLeftPage&&null!=this.scope.pageWidth)return b={width:this.scope.pageWidth/this.appState.zoomFactor,height:this.scope.pageHeight/this.appState.zoomFactor},a=this.pageResizer.sizeForPageAndSize(this.scope.activeLeftPage,b),this.scope.scaledWidth=a.width,this._updateLabel("left",this.scope.activeLeftPage),this._updateLabel("right",this.scope.activeRightPage),this._updateNavButton("left"),this._updateNavButton("play"),this._updateNavButton("pause"),this._updateNavButton("right")},a.prototype._setup=function(){return this.scope.pageLabelContainerStyle={left:{display:"none"},right:{display:"none"}},this.scope.pageLabelClass={},this.scope.navButtonStyle={left:{display:"none"},play:{display:"none"},pause:{display:"none"},right:{display:"none"}},this.scope.labelContent={},this.scope.$watch("pageWidth",function(a){return function(){return a._updateDimensions()}}(this)),this.scope.$watch("pageHeight",function(a){return function(){return a._updateDimensions()}}(this)),this.scope.$watch("spineWidth",function(a){return function(){return a._updateDimensions()}}(this)),this.scope.$watch("activeLeftPage",function(a){return function(){return a._updateDimensions()}}(this)),this.scope.$watch("activeRightPage",function(a){return function(){return a._updateDimensions()}}(this)),this.scope.$watch("selectedPage",function(a){return function(){return a._updateDimensions()}}(this)),this.scope.$watch("playing",function(a){return function(){return a._updateDimensions()}}(this))},a.prototype._updateLabel=function(a,b){var c,d,e,f,g,h,i,j;return null==b||b.isFiller()||!this._initialPageSizesRendered()?void(this.scope.pageLabelContainerStyle[a]={display:"none"}):(h=this.scope.scaledWidth+this.scope.spineWidth/2,d=this.element.parent().prop("offsetWidth")/2,e={position:"absolute",display:"block",top:Math.min(this.scope.pageHeight,this.element.parent().height())+15},i=this.scope.activeLeftPage.isSpread()?d-h/2:d-h,e[a]=""+i+"px",this.scope.pageLabelContainerStyle[a]=e,f=b.displayPageNumber,c=b.isCover()?this.translate(f):f,this.scope.labelContent[a]=c,g=b===this.scope.selectedPage||(null!=(j=this.scope.selectedPage)?j.isSpread():void 0),this.scope.pageLabelClass[a]=g?"page-label-selected":"")},a.prototype._updateNavButton=function(a){var b,c,d,e,f,g;if(!this._initialPageSizesRendered())return void(this.scope.navButtonStyle[a]={display:"none"});switch(f=Math.min(this.scope.pageHeight,this.element.parent().height())+12,g=""+f+"px",c=this.element.parent().prop("offsetWidth")/2,b=""+(c+19)+"px",this.config.playButton||(b=""+(c+4)+"px"),d=""+(c-12)+"px",e={display:"block",top:g},a){case"left":e.right=b;break;case"right":e.left=b;break;case"play":e.left=d,!this.scope.playing&&this.config.playButton||(e.display="none");break;case"pause":e.left=d,this.scope.playing&&this.config.playButton||(e.display="none")}return this.scope.navButtonStyle[a]=e},a.prototype._initialPageSizesRendered=function(){return this.scope.pageWidth>2},a}(),b=function(b,c,d,e,f,g){return{restrict:"E",template:"<div class='page-label-container'\n     ng-style='pageLabelContainerStyle.left'\n     ng-controller=\"IdeaPageLabelCtrl\">\n  <span class='page-label'\n        data-test-key='label_page_number_left'\n        ng-click='onLeftLabelTapped()'\n        ng-class='pageLabelClass.left'\n        ng-bind='labelContent.left'>\n  </span>\n  <span ng-if=\"activeLeftPage.isSpread() && !activeLeftPage.ideaLayout\"\n        class='aux-page-label-left aux-page-label'\n        data-test-key=\"label_spread_page_left\"\n        translate>SilverApp.spread\n  </span>\n  <span ng-if=\"activeLeftPage.isSpread() && activeLeftPage.ideaLayout\"\n        class='aux-page-label-left aux-page-label'\n        data-test-key=\"label_ideaspread_page_left\"\n        translate>SilverApp.spreadIdeaPage\n  </span>\n\n  <i ng-if=\"activeLeftPage.hasAudio()\"\n        class='page-audio page-audio-left'\n        data-test-key=\"label_audio_left_page\">\n  </i>\n  <span ng-if=\"!activeLeftPage.isSpread() && !isPhone\"\n        class='aux-page-label-left'\n        ng-controller=\"IdeaPageLabelCtrl\"\n        ng-include=\"'SilverApp/views/idea-page-label.html'\"\n        data-test-key=\"label_idea_page_left\"\n        data-page-field-name=\"activeLeftPage\">\n  </span>\n</div>\n\n<div class='page-label-container page-label-container--right'\n     ng-style='pageLabelContainerStyle.right'\n     ng-controller=\"IdeaPageLabelCtrl\">\n  <span ng-if=\"activeLeftPage.isSpread() && !activeLeftPage.ideaLayout\"\n        class='aux-page-label-right aux-page-label'\n        data-test-key=\"label_spread_page_right\"\n        translate>SilverApp.spread\n  </span>\n  <span ng-if=\"activeLeftPage.isSpread() && activeLeftPage.ideaLayout\"\n        class='aux-page-label-right aux-page-label'\n        data-test-key=\"label_ideaspread_page_right\"\n        translate>SilverApp.spreadIdeaPage\n  </span>\n\n  <span ng-if=\"!activeLeftPage.isSpread() && !isPhone\"\n        class='aux-page-label-right'\n        ng-controller=\"IdeaPageLabelCtrl\"\n        ng-include=\"'SilverApp/views/idea-page-label.html'\"\n        data-test-key=\"label_idea_page_right\"\n        data-page-field-name=\"activeRightPage\">\n  </span>\n  <i ng-if=\"!activeLeftPage.isSpread() && activeRightPage.hasAudio()\"\n        class='page-audio page-audio-right'\n        data-test-key=\"label_audio_right_page\">\n  </i>\n  <span class='page-label'\n        data-test-key='label_page_number_right'\n        ng-click='onRightLabelTapped()'\n        ng-class='pageLabelClass.right'\n        ng-bind='labelContent.right'>\n  </span>\n</div>\n\n<i class=\"icon-previous-page icon-prev-next-page\"\n  ng-style='navButtonStyle.left'\n  ng-class=\"{'icon-previous-page-press' : customizing}\"\n  data-test-key='button_nav_previous'\n  ng-click='onPreviousTapped()'>\n</i>\n\n<i class='icon-play icon-prev-next-page'\n  ng-style='navButtonStyle.play'\n  data-test-key='button_nav_play'\n  ng-click='onPlayTapped()'>\n</i>\n\n<i class='icon-pause icon-prev-next-page'\n  ng-style='navButtonStyle.pause'\n  data-test-key='button_nav_play'\n  ng-click='onPlayTapped()'>\n</i>\n\n<i class='icon-next-page icon-prev-next-page'\n  ng-class=\"{'icon-next-page-press' : customizing}\"\n  ng-style='navButtonStyle.right'\n  data-test-key='button_nav_next'\n  ng-click='onNextTapped()'>\n</i>",scope:{activeLeftPage:"=",activeRightPage:"=",selectedPage:"=",activeSpreadIndex:"=",spineWidth:"=",pageWidth:"=",pageHeight:"=",onLeftLabelTapped:"&",onRightLabelTapped:"&",onPreviousTapped:"&",onNextTapped:"&",onPlayTapped:"&",playing:"=",isPhone:"=",customizing:"="},transclude:!0,link:function(h,i,j){var k;return k=new a(b,c,d,e,f,g),k.link(h,i,j)}}},b.$inject=["pageResizer","$translate","$window","appState","$timeout","CONFIG"],angular.module("galleon").directive("sfTwoPageViewControls",b)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b){this.$parse=a,this.$timeout=b,this._clickHandler=c(this._clickHandler,this)}return a.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.rootEl=this.element[0],this.rootEl.addEventListener("click",this._clickHandler,!1),this.scope.$on("$destroy",function(a){return function(){return a.rootEl.removeEventListener("click",a._clickHandler,!1)}}(this)),this},a.prototype._clickHandler=function(){return this.$timeout(function(){return angular.element("html").trigger("click")},0)},a}(),b=function(b,c){return{restrict:"A",link:function(d,e,f){var g;return g=new a(b,c),g.link(d,e,f)}}},b.$inject=["$parse","$timeout"],angular.module("silverApp").directive("sfDropdownClose",b)}.call(this),function(){"use strict";var a,b;a=function(){function a(a){this.touchService=a}return a.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.scope.directive=this,this.scope.cloneModel=this.touchService.cloneModel},a}(),b=function(b){return{restrict:"E",link:function(c,d,e){var f;return f=new a(b),f.link(c,d,e)}}},b.$inject=["touchService"],angular.module("galleon").directive("sfPageClone",b)}.call(this),function(){"use strict";var a;a=function(a){return{restrict:"E",templateUrl:"SilverApp/views/gc/calendar-nav-control.html",link:function(b,c,d){var e;return e=function(){switch(b.$eval(d.activeSpreadIndex)){case-1:return"first";case 0:return"middle";case 1:return"last";default:return"middle"}},b.controlWidth=function(b,c){var d,f,g,h;return g=-20,h=0,f=a.document.getElementById(""+e()+"LeftPage"),f?h=f.offsetLeft+f.offsetWidth:(d=a.document.getElementById("customize-pages-surface"),d&&(h=d.offsetLeft+d.offsetWidth)),c&&"play/pause"===b&&(g=102),""+(h-g)+"px"}}}},a.$inject=["$window"],angular.module("galleon").directive("sfNavControlButtons",a)}.call(this),function(){var a;a=function(){return{restrict:"E",replace:!0,scope:{selectedPage:"="},controller:"TabletToolsCtrl",controllerAs:"ctrl",bindToController:!0,templateUrl:"SilverApp/views/tablet-tools.html"}},angular.module("galleon").directive("sfTabletTools",a)}.call(this),function(){var a;a=function(){return{restrict:"E",replace:!0,scope:{selectedPage:"=",onDismiss:"&",onRemovePageRequest:"&"},controller:"TabletToolsCtrl",controllerAs:"ctrl",bindToController:!0,templateUrl:"SilverApp/views/tablet-empty-page-options.html"}},angular.module("galleon").directive("sfTabletEmptyPageOptions",a)}.call(this),function(){var a;a=function(){return{restrict:"E",replace:!0,controller:"TabletChangeSizeCtrl",controllerAs:"ctrl",bindToController:!0,templateUrl:"SilverApp/views/tablet-size-options.html",link:function(a,b,c,d){return d.link()}}},angular.module("galleon").directive("sfTabletSizeOptions",a)}.call(this),function(){var a;a=function(a){return{restrict:"E",replace:!0,template:"<img ng-src=\"{{cloneModel.url}}\"\n     ng-style=\"{\n      'z-index': '9999',\n      'position': 'absolute',\n      'top': cloneModel.top + 'px',\n      'left': cloneModel.left + 'px',\n      'max-width': cloneModel.width + 'px',\n      'max-height': cloneModel.height + 'px'\n     }\"\n     width=\"{{cloneModel.width}}\" height=\"{{cloneModel.height}}\">",link:function(b,c,d){return b.cloneModel=a.cloneModel}}},a.$inject=["touchService"],angular.module("galleon").directive("sfImageClone",a)}.call(this),function(){"use strict";var a;a=function(){return{restrict:"A",link:function(a,b,c){var d,e,f,g,h,i;return e=b[0],d=null!=b&&null!=(h=b.parent())?h.find(".icon"):void 0,a.$watch(function(){return b.attr("class")},function(){return i()}),a.$watch(function(){return e.childNodes.length},function(){if(!f()&&!g())return d.addClass("ng-hide")}),b.bind("scroll",function(){return i()}),i=function(){return f()||g()?d.removeClass("ng-hide"):d.addClass("ng-hide")},f=function(){return e.classList.contains("expanded")},g=function(){return e.scrollHeight>e.clientHeight}}}},a.$inject=[],angular.module("galleon").directive("sfVerticalScroll",a)}.call(this),function(){var a;a=function(){return{restrict:"E",replace:!0,scope:{editor:"=",allowDateEdit:"=",onNewProperty:"&",onRequestSave:"&",onRequestCancel:"&"},templateUrl:"SilverApp/views/gc/event-drawer.html"}},angular.module("galleon-gc").directive("sfEventDrawer",a)}.call(this),function(){"use strict";var a,b;b=18e4,a=function(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){var z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P;return this.config=d,this.$modal=e,this.uppService=f,this.projectService=g,this.commandService=i,this.navService=j,this.autofillService=k,this.localStorageService=l,this.omnitureService=m,this.appState=n,this.$timeout=p,this.epService=q,this.adaptiveLayoutService=r,this.layoutFactory=s,this.hotkeys=t,this.$filter=u,this.uppObjectCollection=v,this.deviceDetectionService=w,this.userService=x,this.logger=o.newInstance("PaletteCtrl"),this.product=this.projectService.currentProject.product,this.hideUsed=this.config.hideUsed,this.highlights=this.config.highlights,this.hidePages=this.config.hidePages,this.groupDuplicates=this.config.groupDuplicates,this.clusterStoryboard=this.config.clusterStoryboard,this.OPTION_YEAR="year",this.OPTION_MONTH="month",this.OPTION_WEEK="week",this.OPTION_DAY="day",this.OPTION_HOUR="hour",this.clusterKey=this.OPTION_MONTH,this.getRankInProgress=!1,this.modalInstance=null,this.canShowImagePlacementModal=!1,this.calendarPaletteMode=this.config.calendarSinglePalette,this.sortOptions=["SilverApp.date.taken.ascending","SilverApp.date.taken.descending","SilverApp.sort.by.added.ascending","SilverApp.sort.by.added.descending","SilverApp.sort.by.title.ascending","SilverApp.sort.by.title.descending"],this.clusterOptions=["Palette.clusterPhotosByHour","Palette.clusterPhotosByDay","Palette.clusterPhotosByWeek","Palette.clusterPhotosByMonth","Palette.clusterPhotosByYear"],this.lowerPaletteIsExpanded=!1,this.lowerPaletteIsCollapsed=!1,this.searchKeywords="",this.disableFilters=!1,this.search=function(a){return this.showExtendedPalette(a,this.searchKeywords),this.disableFilters=!0},this.clearSearch=function(){return this.searchKeywords="",this.disableFilters=!1},this.changeSortOrder=function(){switch(this.selectedOption){case"SilverApp.date.taken.descending":return this.sortByField="captureDate",this.reverseSort=!0,this.appendEmptyField=!1;case"SilverApp.date.taken.ascending":return this.sortByField="captureDate",this.reverseSort=!1,this.appendEmptyField=!1;case"SilverApp.sort.by.added.descending":return this.sortByField="productImageID",this.reverseSort=!0,this.appendEmptyField=!1;case"SilverApp.sort.by.added.ascending":return this.sortByField="productImageID",this.reverseSort=!1,this.appendEmptyField=!1;case"SilverApp.sort.by.title.descending":return this.sortByField="title",this.reverseSort=!0,this.appendEmptyField=!0;case"SilverApp.sort.by.title.ascending":return this.sortByField="title",this.reverseSort=!1,this.appendEmptyField=!0}},this.selectedOption=this.sortOptions[0],this.changeSortOrder(),this.changeClusterOrder=function(){switch(this.selectedClusterOption){case"Palette.clusterPhotosByHour":this.clusterKey=this.OPTION_HOUR;break;case"Palette.clusterPhotosByDay":this.clusterKey=this.OPTION_DAY;break;case"Palette.clusterPhotosByWeek":this.clusterKey=this.OPTION_WEEK;break;case"Palette.clusterPhotosByMonth":this.clusterKey=this.OPTION_MONTH;break;case"Palette.clusterPhotosByYear":this.clusterKey=this.OPTION_YEAR}c.publish(c.events.RECLUSTER_REQUIRED)},this.selectedClusterOption=this.clusterOptions[3],this.changeClusterOrder(),this.hotkeys.add({combo:"mod+i",description:"Toggle Palette Mode",callback:function(a){return function(b,c){a.switchPaletteMode(),b.preventDefault()}}(this)}),this.priorities={images:"low",pages:"medium",storyboard:"low"},this.imagesUploaded=[],this.isDualPaletteMode="single"!==this.config.paletteMode,this.secondaryPalette={isExpanded:"collapsed"!==this.config.paletteMode},this.embellishmentsFeatureAllowed=this.config.features.embellishments,this.uploadReporters={},this.mainUploadMetric={},this.longUploadTimeout={},this.lastUpdatedUpload={},this.imageFinishDetail={},this.timerMap={},this.PaletteTabFirstRun={images:!0,pages:!1,backgrounds:!0,layouts:!0,ideaPages:!0,embellishments:!0,events:!1},this.PaletteTabSelection={images:!0,pages:!1,backgrounds:!1,layouts:!!this.isDualPaletteMode,ideaPages:!1,embellishments:!1,styles:!1,events:!1},D=this.logger,E=function(a){return D.warn("UPP_IMAGE_UPDATE event time exceeded, {source: "+a+"}")},this._dedupeImages=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(b=y.defer(),g=[],e=null!=(k=this.projectService.currentProject)&&null!=(l=k.imageCollection)&&null!=(m=l.projectImages)?m.length:void 0,this.userService.isUserMigrated()&&!this.config.superSimple&&e>0){for(c={},p=null!=(n=this.projectService.currentProject)&&null!=(o=n.imageCollection)?o.projectImages:void 0,i=0,j=p.length;i<j;i++)d=p[i],c[d.imageId]=!0;f=function(){var b,d,e,f;for(f=[],b=0,d=a.length;b<d;b++)h=a[b],"sfly"===(null!=(e=h.source)?e.id:void 0)?f.push(this.uppService.getLocalImageData(h).then(function(a){var b,d,e;if(b=null!=(d=a.umsData)&&null!=(e=d.view_efx)?e.encodedMspPath:void 0,!b||!c[b])return g.push(a)})):f.push(g.push(h));return f}.call(this),y.all(f).then(function(){return b.resolve(g)})}else b.resolve(a);return b.promise},L=function(b){return function(d,e){var f;return f=e.detail.wait.concat(e.detail.done,e.detail.xfer),b._dedupeImages(f).then(function(a){var d,f,g,i,j,k;if(0!==a.length){if(null!=e&&null!=(i=e.detail)?i.wait:void 0)for(j=e.detail.wait,f=0,g=j.length;f<g;f++)d=j[f],"thisLife"!==(null!=(k=d.source)?k.id:void 0)&&(b.timerMap[d.id]=d.id);return b.mainUploadMetric=b.logger.asyncMetric("overallUploads"),J(e.detail.wait.concat(e.detail.xfer)),b.uppImagePlacement?(b.uppService.deferUppEvents(),b.uppService.gatherUppImagesData().then(function(){var d,e,f;switch(b.uppImagePlacement){case"ADD_TO_PALETTE":b.selectPaletteTab("images"),c.publish(c.events.PALETTE_THUMBNAILS_ADDED,a),b.uppService.processDeferredUppEvents(),c.publish(c.events.UPP_IMAGE_PROCESSING_COMPLETE),c.publish(c.events.RECLUSTER_REQUIRED),b.uppService.resumeUpload();break;case"ADD_TO_NEW_PAGES":if(b.selectPaletteTab("pages"),b.config.superSimple&&b.selectPaletteTab("images"),e=(a||[]).map(function(a){var b;return b=h.newInstance(a),"object"==typeof b.data&&(b.data="uppTemp"),b}).filter(function(a){return null!=a.width}),d="",f={},b.projectService.currentProject.product.hasFilledPages()?(b._captureSurfaceRequiringJoining(),d="AutofillFilledBookCommand",f=b.autofillService.prepareAutofillFilledBookCommand(e),c.publish(c.events.PALETTE_THUMBNAILS_ADDED,a)):(b.surfaceNumberRequiringJoining=void 0,d="AutofillBlankBookCommand",f=b.autofillService.prepareAutofillBlankBookCommand(e)),c.publish(c.events.RECLUSTER_REQUIRED),f.cannotAutofill)return;f.then(function(a){if(a.images=e,a.beforeCommandPageNumber=b.navService.selectedPage.surfaceNumber,a.activePageNumber=b.navService.selectedPage.surfaceNumber,b.commandService.execute(d,a),c.publish(c.events.UPP_IMAGE_PROCESSING_COMPLETE),b.uppService.resumeUpload(),"AutofillFilledBookCommand"===d)return b._makeSpreadFromLastSinglePage()});break;default:throw new Error("Unknown option: "+b.uppImagePlacement)}return b.uppImagePlacement=null})):void 0}}),a.$digest()}}(this),this._captureSurfaceRequiringJoining=function(a){return function(){if(a.surfaceNumberRequiringJoining=void 0,a.config.superSimple&&a.deviceDetectionService.isDeviceATablet()&&!a.projectService.currentProject.product.lastPageIsSpread())return a.surfaceNumberRequiringJoining=a.projectService.currentProject.product.lastPage().surfaceNumber}}(this),this._makeSpreadFromLastSinglePage=function(a){return function(){var b,c,d,e,f,g;if(null!=a.surfaceNumberRequiringJoining&&(e=a.projectService.currentProject.product,c=e.pageBySurfaceNumber(a.surfaceNumberRequiringJoining),f=e.pageBySurfaceNumber(a.surfaceNumberRequiringJoining+1),null!=c&&null!=f&&!c.isSpread()&&!f.isSpread()))return d=c.surfaceNumber,g=f.surfaceNumber,b=a.layoutFactory.newInstance(angular.copy(f.layout.values)),b.clearAboveBackground(),a.adaptiveLayoutService.joinLayouts(c.layout.values,f.layout.values).then(function(c){return a._executeMakeSpreadCommand(d,c,g,{content:b.values})})}}(this),this._executeMakeSpreadCommand=function(a){return function(b,d,e,f){var g;return g={left:{layoutValues:d,pageNumber:b},right:{layoutValues:f,pageNumber:e}},a.commandService.execute("MakeSpreadCommand",g),c.publish(c.events.SURFACE_INVALIDATED,{pageNumber:a.surfaceNumberRequiringJoining}),a.surfaceNumberRequiringJoining=void 0}}(this),J=function(a){return function(b){var c,d,e,f;for(I(),f=[],d=0,e=b.length;d<e;d++)c=b[d],f.push(a.uploadReporters[c.id]=a.logger.asyncMetric("uploadItem_"+c.id,location));return f}}(this),I=function(a){return function(){var c,d;if(a.$timeout.cancel(a.longUploadTimeout),null!=a.lastUpdatedUpload)return d="singleUploadExceeded",c=O(a.lastUpdatedUpload),c.exceededTimeout=""+b+"ms",a.longUploadTimeout=a.$timeout(function(){return a.logger.metric(d,c)},b)}}(this),M=function(a){return function(b,d){var e,f,g,h,i,j,k,l,m,n,o;if(void 0!==a.timerMap[null!=d&&null!=(g=d.detail)?g.id:void 0]&&(clearTimeout(a.timerMap[d.detail.id]),a.timerMap[d.detail.id]=window.setTimeout(E,a.config.defaults.uppImageUpdatedExceededTimer,null!=(h=d.detail.source)?h.id:void 0)),null==d.detail.productImageID&&(d.detail.productImageID=a.uppObjectCollection.getProductImageId(d.detail.id)),300!==(i=d.detail.state)&&100!==i&&(e=null!=(j=a.projectService.currentProject)&&null!=(k=j.imageCollection)&&"function"==typeof k.getImageByProductImageId?k.getImageByProductImageId(d.detail.productImageID):void 0,null!=e&&(e.progress=Math.round(100*d.detail.progress))),f=a.uppObjectCollection.getUppObject(null!=(l=d.detail)?l.imageId:void 0),a.lastUpdatedUpload=d.detail,300===(m=d.detail.state)||100===m||(null!=e&&"function"==typeof e.isRawSuperfly?e.isRawSuperfly():void 0)===!0)return 300!==d.detail.state&&null!=d.detail.productImageID||(null!=e&&"function"==typeof e.isRawSuperfly?e.isRawSuperfly():void 0)===!0?100===d.detail.state||(null!=e&&"function"==typeof e.isRawSuperfly?e.isRawSuperfly():void 0)===!0&&a.uppService.hasSuperflyMPath(f)?"myComputer"!==(null!=(n=d.detail.source)?n.id:void 0)&&"device"!==(null!=(o=d.detail.source)?o.id:void 0)?a.uppService.getLocalImageData(d.detail).then(function(a){
return C(a),G(c.events.PALETTE_IMAGES_UPLOADED,a)},function(){return B(d.detail),G(c.events.PALETTE_IMAGES_UPLOAD_ERROR,d.detail)}):(C(d.detail),G(c.events.PALETTE_IMAGES_UPLOADED,d.detail)):void 0:(B(d.detail),G(c.events.PALETTE_IMAGES_UPLOAD_ERROR,d.detail))}}(this),B=function(a){return function(b){if(I(),null!=a.uploadReporters[null!=b?b.id:void 0])return a.uploadReporters[b.id].failure(O(b)),a.uploadReporters[b.id]=null,delete a.uploadReporters[b.id]}}(this),O=function(a){return function(b){return{id:b.id,date:b.date,location:b.location,parentTitle:b.parentTitle,productImageID:b.productImageID,state:b.state,width:b.width,height:b.height,size:b.size,origId:b.origId,progress:b.progress,migrated:a.userService.isUserMigrated()}}}(this),C=function(a){return function(b){if(I(),null!=a.uploadReporters[null!=b?b.id:void 0])return a.uploadReporters[b.id].success(O(b)),a.uploadReporters[b.id]=null,delete a.uploadReporters[b.id]}}(this),H=function(a){return function(b,c){var d,e,f,g,h,i,j,k,l,m;return a.projectService.validate(a.projectService.currentProject,{intensity:"partial"}),a.$timeout.cancel(a.longUploadTimeout),d=null!=(e=a.projectService.currentProject)&&null!=(f=e.imageCollection)&&null!=(g=f.uploadErrors())?g.length:void 0,a.mainUploadMetric.success({doneAmount:null!=(h=a.imageFinishDetail)&&null!=(i=h.done)?i.length:void 0,errorAmount:d,waitAmount:null!=(j=a.imageFinishDetail)&&null!=(k=j.wait)?k.length:void 0,xferAmount:null!=(l=a.imageFinishDetail)&&null!=(m=l.xfer)?m.length:void 0}),a.uploadReporters={},a.lastUpdatedUpload=null,a.imageFinishDetail={},a.projectService.validate(a.projectService.currentProject,{event:"PaletteCtrl.reportUploadsFinished",intensity:"partial"})}}(this),G=function(a){return function(b,d){if(!a.imagesUploaded[d.productImageID])return b===c.events.PALETTE_IMAGES_UPLOADED&&(a.imagesUploaded[d.productImageID]=!0),a.uppService.shouldDeferUppEvents()?a.uppService.addToDeferedEventsList(b,d):c.publish(b,d)}}(this),F=function(a){return function(b,c){return a.product=c.product,a.canShowImagePlacementModal=!0}}(this),P=function(a){return function(b,d){var e,f,g,h;return a.config.features.promptForStoryboard=!1,h="SilverApp/views/gc/prompt-for-storyboard.html",f=a.$modal.open({templateUrl:h,backdrop:"static",controller:"SimpleModalCtrl",resolve:{data:function(){return d}}}),g=function(){return c.publish(c.events.SELECT_STORYBOARD_TAB)},e=function(){},f.result.then(g,e)}}(this),K=function(a){return function(b,c){return a.config.features.promptForStoryboard&&!a.appState.simpleMode&&"edit"===n.activeTab&&P(),a.uppImagePlacement=c}}(this),A=function(a){return function(){return a.highlights&&(a.highlights=!1,a.toggleHighlights()),a.getRankInProgress=!0}}(this),z=function(a){return function(){return a.getRankInProgress=!1}}(this),N=function(a){return function(b,c){var d,e,f,g,h;if(null!=c&&null!=(g=c.detail)?g.done:void 0)for(h=c.detail.done,e=0,f=h.length;e<f;e++)d=h[e],a.timerMap[d.id]&&clearTimeout(a.timerMap[d.id]);return a.imageFinishDetail=null!=c?c.detail:void 0}}(this),c.subscribe(c.events.UPP_IMAGE_START,L,a),c.subscribe(c.events.UPP_IMAGE_UPDATE,M,a),c.subscribe(c.events.UPP_IMAGE_FINISH,N,a),c.subscribe(c.events.UPP_UPLOAD_COMPLETED,H,a),c.subscribe(c.events.PROJECT_LOADED,F,a),c.subscribe(c.events.UPP_IMAGE_PLACEMENT_SELECTED,K,a),c.subscribe(c.events.PALETTE_SELECTION_REQUIRED,function(a){return function(b,c){return a.selectPaletteTab(c.select)}}(this),a),c.subscribe(c.events.IMAGE_GETRANK_START,A,a),c.subscribe(c.events.IMAGE_GETRANK_DONE,z,a),this.forceDualPaletteMode=function(a){if(this.isDualPaletteMode=a,this.lowerPaletteIsExpanded)return this.toggleExpandLowerPalette()},this.switchPaletteMode=function(){return this.isDualPaletteMode=!this.isDualPaletteMode,this.savePaletteToLocalStorage()},this.setCalendarSinglePalette=function(a){return this.calendarPaletteMode=a},this.toggleHideUsed=function(){return this.localStorageService.add("hideUsed",this.hideUsed)},this.toggleHighlights=function(){return this.localStorageService.add("highlights",this.highlights)},this.toggleGroupDuplicates=function(){return this.localStorageService.add("groupDuplicates",this.groupDuplicates)},this.toggleClusterStoryboard=function(){this.localStorageService.add("clusterStoryboard",this.clusterStoryboard),c.publish(c.events.RECLUSTER_REQUIRED)},this.savePaletteToLocalStorage=function(){return this.isDualPaletteMode?this.secondaryPalette.isExpanded?this.localStorageService.add("paletteMode","dual"):this.localStorageService.add("paletteMode","collapsed"):this.localStorageService.add("paletteMode","single")},this.ensureSecondaryPaletteExpanded=function(){return this.secondaryPalette.isExpanded=!0},this.toggleSecondaryPalette=function(){return this.secondaryPalette.isExpanded=!this.secondaryPalette.isExpanded,this.savePaletteToLocalStorage()},this._updatePalettePriorities=function(a){if(this.priorities={pages:"low",images:"low"},a)return this.priorities[a]="medium"},this.selectPaletteTab=function(a){var b,c,d;if(this.appState.cancelBackgroundWaitingForPicture(),!this.isDualPaletteMode){d=this.PaletteTabSelection;for(c in d)b=d[c],this.PaletteTabSelection[c]=!1}return this.PaletteTabSelection[a]=!0,this.PaletteTabFirstRun[a]=!1,this._updatePalettePriorities(a),this.omnitureService.trackLink({linkName:this.omnitureService.TAB_LINK_NAMES[a]}),this.appState.paletteTabSelections=this.PaletteTabSelection},this.showExtendedPalette=function(b,c){var d,e;if(null==c&&(c=null),this.omnitureService.backupReportingPageName(),this.omnitureService.trackPageName({pageName:this.omnitureService.EXT_PALETTE_PAGE_NAME}),null!=b&&(this.epService.corePaletteSelectedTabName=b),this.epService.initialSearch=c,e=this.$modal.open({templateUrl:"Palette/views/extended-palette-modal.html",backdrop:"static",controller:"ExtendedPaletteCtrl",scope:a}),d=function(a){return function(){var b;if(b=a.omnitureService.getSavedReportingPageName())return a.omnitureService.trackPageName({pageName:b})}}(this),e)return e.result.then(d,d)},this.convertToPhotoSpread=function(a){var b,c,d;if(null!=a&&(a%2===1&&(a-=1),c=this.projectService.currentProject.product.pageBySurfaceNumber(a),!c.isSpread()))return b=this.layoutFactory.newInstance(angular.copy(this.navService.leftPage.layout.values)),b.clearAboveBackground(),d=this.layoutFactory.newInstance(angular.copy(this.navService.rightPage.layout.values)),d.clearAboveBackground(),this.adaptiveLayoutService.joinLayouts(b.values,d.values).then(function(b){return function(c){return b.commandService.execute("ConvertToPhotoSpreadCommand",{pageNumber:a,overlappedPage:b.navService.rightPage,emptySpreadLayout:c})}}(this))},this.toggleExpandLowerPalette=function(){return this.lowerPaletteIsExpanded=!this.lowerPaletteIsExpanded,c.publish(c.events.SURFACE_INVALIDATED)},this.toggleCollapseLowerPalette=function(){return this.lowerPaletteIsCollapsed=!this.lowerPaletteIsCollapsed,c.publish(c.events.SURFACE_INVALIDATED)},this.canAddMorePhotos=function(a){return function(){return!!a.projectService.currentProject.product&&(a.projectService.currentProject.imageCollection.projectImages.length<a.deviceDetectionService.getSuperSimpleDefaults().photoSelection.max&&a.projectService.currentProject.product.pages.length<a.deviceDetectionService.getSuperSimpleDefaults().constraints.GroupCountConstraint.max)}}(this),this.addMorePhotos=function(a){return function(){var b;return b={currentCount:a.projectService.currentProject.imageCollection.projectImages.length,backgroundImport:!0,forceAutofill:!0,selectionLimit:{maxPhotos:a.deviceDetectionService.getSuperSimpleDefaults().photoSelection.max,minPhotos:0}},a.uppService.show("UniversalPicker",b,!1)}}(this),a.ctrls.PaletteCtrl=this},a.$inject=["$scope","eventBus","CONFIG","$modal","uppService","projectService","uppImageFactory","commandService","navService","autofillService","localStorageService","omnitureService","appState","loggerFactory","$timeout","extendedPaletteService","adaptiveLayoutService","layoutFactory","hotkeys","$filter","uppObjectCollection","deviceDetectionService","userService","$q"],angular.module("galleon").controller("PaletteCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q;this.$scope=a,this.$modalInstance=b,this.epService=c,this.translate=d,this.navService=e,this.pageFactory=f,this.itemPricingService=g,this.$modal=h,this.localStorageService=i,this.paletteService=j,this.pricingService=k,this.favoritesService=l,this.config=m,this.omnitureService=n,this.$timeout=o,this.appState=p,this.$scope.ctrls=this.$scope.ctrls||{},this.$scope.ctrls.ExtendedPaletteCtrl=this,this.attributeGroups=null,this.radioGroup=null,this.content=[],this.totalCount=0,this.currentAssetType=null,this.waiting=!1,this.searchKeywords="",this.itemHover=null,this.disableFilters=!1,this.isIdeaCovers=!1,this.selectedItems={},this.favorites={},this.showFavorites=!1,this.filterByFavorites={},q=this.pageFactory.Page,this.assetTypes=[{name:this.translate("Palette.extended.layouts"),value:"layouts-interior",coreContext:"layouts"},{name:this.translate("Palette.extended.backgrounds"),coreContext:"backgrounds",radioGroup:{header:this.translate("Palette.extended.pages"),buttons:[{name:this.translate("Palette.extended.interior"),value:"backgrounds",allowedContexts:["other"]},{name:this.translate("Palette.extended.cover"),value:"backgrounds-cover",allowedContexts:[q.FRONT_COVER_PAGE_NUMBER.toString(),q.BACK_COVER_PAGE_NUMBER.toString(),q.SPINE_PAGE_NUMBER.toString()]}],expanded:!0}},{name:this.translate("Palette.extended.embellishments"),coreContext:"embellishments",radioGroup:{header:this.translate("Palette.extended.type"),buttons:[{name:this.translate("Palette.extended.stickers"),value:"stickers",allowedContexts:["embellishment","other"]},{name:this.translate("Palette.extended.ribbons"),value:"patternbands",allowedContexts:["ribbon"]},{name:this.translate("Palette.extended.frames"),value:"frames",allowedContexts:["frame"]}],expanded:!0}},{name:this.translate("Palette.extended.ideapages"),radioGroup:{header:this.translate("Palette.extended.pages"),buttons:[{name:this.translate("Palette.extended.interior"),value:"ideapages-interior",allowedContexts:["other"]},{name:this.translate("Palette.extended.cover"),value:"ideapages-cover",allowedContexts:[q.FRONT_COVER_PAGE_NUMBER.toString(),q.BACK_COVER_PAGE_NUMBER.toString(),q.SPINE_PAGE_NUMBER.toString()]}],expanded:!0},coreContext:"ideaPages"}],this.config.spreads&&(this.assetTypes[0].radioGroup={header:this.translate("Palette.extended.pages"),buttons:[{name:this.translate("Palette.extended.interior"),value:"layouts-interior",allowedContexts:["other"]},{name:this.translate("Palette.extended.spread"),value:"spread-layouts-interior",allowedContexts:["spread"],omniture:"Select design elements - Layout: Spread"}],expanded:!0},this.assetTypes[3].radioGroup.buttons.push({name:this.translate("Palette.extended.spread"),value:"spread-ideapages-interior",allowedContexts:["spread"],omniture:"Select design elements - Layout: Idea Spread"})),this.initPaletteState(),this.$timeout(function(a){return function(){return a.omnitureService.trackPageName({pageName:"/@@p/Select design elements"})}}(this),0,!1)}return a.prototype.initPaletteState=function(){var a;if(this.appState.cancelBackgroundWaitingForPicture(),this.showFavoritesDialogIfNecessary(),a=this._getAssetTypeForContext(),a||(a=this.assetTypes[0]),this._initRadioSelection(a),this.changeAssetType(a),this.paletteService.gatherExistingContent(),this._fetchFavorites(),null!=this.epService.initialSearch)return this.$timeout(function(a){return function(){return a.searchKeywords=a.epService.initialSearch,a.search()}}(this),500)},a.prototype.showFavoritesDialogIfNecessary=function(){if("true"!==this.localStorageService.get("hasSeenFavoritesDialog"))return this.localStorageService.add("hasSeenFavoritesDialog","true"),this.$modal.open({templateUrl:"Palette/views/favorites-modal.html",backdrop:"static",controller:"FavoritesModalCtrl"})},a.prototype.changeAssetType=function(a){var b,c;return this.waiting=!0,this.currentAssetType=a,this.searchKeywords="",this.disableFilters=!1,b=this._getDisplayObjectContext(a),c=this.epService.resolveAttributesForType(b.type),c.promise.then(function(c){return function(){return c.attributeGroups=c.epService.paletteTypeData[b.type],c.radioGroup=c.currentAssetType.radioGroup,c.filterByFavorites[a.name]?c._fetchFavoritesContent(b):c._fetchContent(b),c.isIdeaCovers="ideapages-cover"===b.type}}(this))},a.prototype.attributeClicked=function(a){var b;if(!a.disabled)return b=this._getDisplayObjectContext(this.currentAssetType),this._fetchContent(b)},a.prototype.radioClicked=function(a,b){var c,d,e,f;if(null==b&&(b=null),b=null!=b?b:this.currentAssetType,!a.selected){for(f=b.radioGroup.buttons,d=0,e=f.length;d<e;d++)c=f[d],delete c.selected;return a.selected=!0,this.changeAssetType(b)}},a.prototype.favoriteItemClicked=function(a){return this.favorites[a.objectId]?delete this.favorites[a.objectId]:this.favorites[a.objectId]=this._getAssetType(a)},a.prototype.favoriteFilterClicked=function(){return this.filterByFavorites[this.currentAssetType.name]?delete this.filterByFavorites[this.currentAssetType.name]:this.filterByFavorites[this.currentAssetType.name]=!0,this.changeAssetType(this.currentAssetType)},a.prototype.cancel=function(){return this.$modalInstance.dismiss("cancel"),this._saveFavorites(),this.omnitureService.trackPageName({pageName:"/@@p/edit"})},a.prototype.getThumbUrlFromAsset=function(a){var b,c,d,e;for(e=a.url,c=0,d=e.length;c<d;c++)if(b=e[c],"thumb"===b.repType)return this.config.protocolRelativeUrl(b.value);return""},a.prototype.getPreviewUrlFromAsset=function(a){var b,c,d,e;if(!a)return"";for(e=a.url,c=0,d=e.length;c<d;c++)if(b=e[c],"preview"===b.repType)return this.config.protocolRelativeUrl(b.value);return""},a.prototype.itemHasPrice=function(a){return null!=a.sku&&""!==a.sku&&""!==this.getItemPrice(a)},a.prototype.getItemPrice=function(a){var b,c,d;return b=null!=(c=null!=(d=this.itemPricingService.getSkuPrice(a.sku))?d.saleTotalPrice:void 0)?c:"",""===b?"":"$"+b},a.prototype.isObjectSelected=function(a){var b,c;return b=this._getDisplayObjectContext(this.currentAssetType).type,null!=(null!=(c=this.selectedItems[b])?c[a]:void 0)},a.prototype.requestNextPage=function(){var a,b;return b=this._getDisplayObjectContext(this.currentAssetType),a=null,a=null!=this.searchKeywords&&""!==this.searchKeywords?this.epService.requestNextSearchContentPage(b.type,this.searchKeywords):this.filterByFavorites[this.currentAssetType.name]?this.epService.requestNextFavoritesContentPage(this.favorites,b.type,b.options):this.epService.requestNextContentPage(b.type,b.options),a.promise.then(function(a){return function(){return a.content=a.epService.paletteContent}}(this))},a.prototype._initRadioSelection=function(a){var b,c,d,e,f,g,h;if(null!=a?a.radioGroup:void 0){for(d=this._getRadioContextForAssetType(a),g=a.radioGroup.buttons,h=[],e=0,f=g.length;e<f;e++)b=g[e],h.push(function(){var e,f,g,h;for(g=b.allowedContexts,h=[],e=0,f=g.length;e<f;e++){if(c=g[e],c===d){this.radioClicked(b,a);break}h.push(void 0)}return h}.call(this));return h}},a.prototype._getRadioContextForAssetType=function(a){var b,c,d;return b=this.pageFactory.Page,"embellishments"===a.coreContext?null!=(d=this.epService.currentRadioContext)?d:"other":(c=this.navService.selectedPage.surfaceNumber.toString(),c===b.FRONT_COVER_PAGE_NUMBER.toString()||c===b.SPINE_PAGE_NUMBER.toString()||c===b.BACK_COVER_PAGE_NUMBER.toString()?c:"other")},a.prototype._getAssetTypeForContext=function(){var a,b,c,d;for(d=this.assetTypes,b=0,c=d.length;b<c;b++)if(a=d[b],a.coreContext===this.epService.corePaletteSelectedTabName)return a;return null},a.prototype._fetchContent=function(a){var b;return this.waiting=!0,this.content=[],b=this.epService.requestInitialContent(a.type,a.options),function(a){return function(c){return b.promise.then(function(){var b;return b=a._getDisplayObjectContext(a.currentAssetType),b.type===c&&(a.content=a.epService.paletteContent,a.totalCount=a.epService.contentCount),a.waiting=!1})}}(this)(a.type)},a.prototype._fetchFavorites=function(){var a;return this.waiting=!0,a=this.favoritesService.fetchFavorites(),a.then(function(a){return function(){return a.favorites=a.favoritesService.favoritesContent,a.showFavorites=a.favoritesService.showFavorites,a.waiting=!1}}(this))},a.prototype._saveFavorites=function(){var a;return this.waiting=!0,a=this.favoritesService.updateFavorites(this.favorites),a.then(function(a){return function(){return a.waiting=!1}}(this))},a.prototype._fetchFavoritesContent=function(a){var b;return this.waiting=!0,b=this.epService.requestInitialFavoritesContent(this.favorites,a.type,a.options),function(a){return function(c){return b.promise.then(function(){var b;return b=a._getDisplayObjectContext(a.currentAssetType),b.type===c&&(a.content=a.epService.paletteContent,a.totalCount=a.epService.contentCount),a.waiting=!1})}}(this)(a.type)},a.prototype._getAssetType=function(a){return"embellishment"===a.objectType&&null!=a.embellishmentAttributes?a.embellishmentAttributes.EmbellishmentType:a.objectType},a.prototype._getDisplayObjectContext=function(a){var b,c,d,e;if(!a.radioGroup)return{type:a.value};for(e=a.radioGroup.buttons,c=0,d=e.length;c<d;c++)if(b=e[c],b.selected)return{type:b.value,options:b.options};return a.radioGroup.buttons[0].selected=!0,{type:a.radioGroup.buttons[0].value,options:a.radioGroup.buttons[0].options}},a.prototype.search=function(){var a,b;if(this.searchKeywords&&""!==this.searchKeywords)return this.waiting=!0,a=this._getDisplayObjectContext(this.currentAssetType).type,b=this.epService.requestInitialSearchContent(a,this.searchKeywords),function(a){return function(c){return b.promise.then(function(){var b;return b=a._getDisplayObjectContext(a.currentAssetType),b.type===c&&(a.content=a.epService.paletteContent,a.totalCount=a.epService.contentCount,a.disableFilters=!0),a.waiting=!1})}}(this)(a)},a.prototype.clearSearch=function(){return this.changeAssetType(this.currentAssetType)},a.prototype.onContentClick=function(a){var b;if(!a.isCorePaletteItem)return b=this._getDisplayObjectContext(this.currentAssetType).type,this.selectedItems[b]||(this.selectedItems[b]={}),this.selectedItems[b][a.objectId]?delete this.selectedItems[b][a.objectId]:this.selectedItems[b][a.objectId]=a},a.prototype.getSelectedItemsCount=function(){var a,b,c,d,e,f,g,h,i;for(a=0,h=Object.keys(this.selectedItems),d=0,f=h.length;d<f;d++)for(b=h[d],i=Object.keys(this.selectedItems[b]),e=0,g=i.length;e<g;e++)c=i[e],a+=1;return a},a.prototype.onAddToProject=function(){return this.cancel(),this.paletteService.addItems(this.selectedItems)},a}(),a.$inject=["$scope","$modalInstance","extendedPaletteService","$translate","navService","pageFactory","itemPricingService","$modal","localStorageService","paletteService","pricingService","favoritesService","CONFIG","omnitureService","$timeout","appState"],angular.module("galleon").controller("ExtendedPaletteCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.$scope=a,this.$modalInstance=b,this.$scope.ctrls=this.$scope.ctrls||{},this.$scope.ctrls.FavoritesModalCtrl=this}return a.prototype.close=function(){return this.$modalInstance.dismiss("cancel")},a}(),a.$inject=["$scope","$modalInstance"],angular.module("galleon").controller("FavoritesModalCtrl",a)}.call(this),function(){angular.module("galleon-pb").value("productPagesStrategy",function(a){var b;return null!=(b=null!=a?a.pages:void 0)?b:[]})}.call(this),function(){angular.module("galleon-gc").value("productPagesStrategy",function(a){var b;return null!=(b=null!=a?a.nonGridPages:void 0)?b:[]})}.call(this),function(){angular.module("galleon-ss").value("productPagesStrategy",function(a){var b;return null!=(b=null!=a?a.pages:void 0)?b:[]})}.call(this),function(){"use strict";var a;a=function(a,b,c,d,e,f,g,h){return this.productPagesStrategy=f,this.deviceDetectionService=g,this.project=d.currentProject,this.productSpecificPages=this.productPagesStrategy(this.project.product),this.counter=0,this.currentPaletteItemIndex=1,this.evalAllPages=!1,this.surfaceNumbersInvalidated={},this.autoMoveNumber=void 0,b.subscribe(b.events.SURFACE_SELECTED,function(a){return function(b,c){return a.selectedPage=c,e(function(){return a.currentPaletteItemIndex=!a.currentPaletteItemIndex})}}(this),a),b.subscribe(b.events.SURFACE_INVALIDATED,function(a){return function(b,c){return null==c?(a.evalAllPages=!0,void e(function(){return a.evalAllPages=!1})):(a.autoMoveNumber=c.autoMoved===!0?c.pageNumber:void 0,a.surfaceNumbersInvalidated[c.pageNumber]=!0,e(function(){return a.surfaceNumbersInvalidated[c.pageNumber]=void 0}))}}(this),a),b.subscribe(b.events.PROJECT_LOADED,function(a){return function(b,c){var d,f;return a.project=c,a.productSpecificPages=a.productPagesStrategy(a.project.product),f=a.project.product.lastPage().surfaceNumber,d=a.project.product.pages[0].surfaceNumber,a.surfaceNumbersInvalidated[d]=!0,a.surfaceNumbersInvalidated[f]=!0,e(function(){return a.surfaceNumbersInvalidated[d]=void 0,a.surfaceNumbersInvalidated[f]=void 0})}}(this),a),b.subscribe(b.events.PROJECT_MODIFIED,function(a){return function(b,c){return a.project=c,a.productSpecificPages=a.productPagesStrategy(a.project.product),a.selectedMobilePage=null}}(this),a),this.selectLastPage=function(){return c.setSelectedPage(this.project.product.pages[this.project.product.pages.length-1])},this.selectPage=function(b,d){return null==d&&(d=!1),a.ctrls.NavCtrl.cancelPlay(),c.showingSummary?(a.ctrls.NavCtrl.hideSummary(),e(function(){return c.setSelectedPage(b)},100)):d&&a.ctrls.NavCtrl.bottomRightPageSelected&&1!==b.surfaceNumber?c.gotoPage(b.surfaceNumber+1):c.setSelectedPage(b)},this.selectFrontFiller=function(){return a.ctrls.NavCtrl.cancelPlay(),c.setSelectedPage(this.project.product.frontFillerPage)},this.selectBackFiller=function(){return a.ctrls.NavCtrl.cancelPlay(),c.setSelectedPage(this.project.product.backFillerPage)},this.selectFrontCover=function(){return a.ctrls.NavCtrl.cancelPlay(),this.deviceDetectionService.isDeviceATablet()?c.showingSummary=!0:c.selectCoverSpread(this.getFrontCover())},this.selectBackCover=function(){return a.ctrls.NavCtrl.cancelPlay(),c.selectCoverSpread(this.project.product.cover.backPage)},this.getFrontCover=function(){var a;return(null!=(a=this.project.product.cover)?a.frontPage:void 0)||this.project.product.pages[0]},this.tabActivated=function(a){return function(){return e(function(){return a.currentPaletteItemIndex=!a.currentPaletteItemIndex})}}(this),this.pageRenderStagger=function(a){return function(b,d){var e,f;return null==(null!=(e=a.project)&&null!=(f=e.product)?f.pages:void 0)||b<=0||a.project.product.pages.length<=20||d===c.leftPage||d===c.rightPage?0:b*(5*a.project.product.pages.length)}}(this),this.editImage=function(b,c){return h.open({templateUrl:"SilverApp/views/edit-image-simple.html",backdrop:"static",controller:"EditImageCtrl",windowClass:"image-editor-modal",scope:a,resolve:{data:function(){return{page:b,asset:c}}}})},this.selectMobilePage=function(a){return function(b,c){if(a.selectedMobilePage=b,null!=b&&null!=c)return c.stopPropagation()}}(this),a.ctrls.PagesCtrl=this},a.$inject=["$scope","eventBus","navService","projectService","$timeout","productPagesStrategy","deviceDetectionService","$modal"],angular.module("galleon").controller("PagesCtrl",a)}.call(this),function(){"use strict";var a;a=function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o,p;return this.projectService=g,this.$timeout=h,this.$filter=i,this.localStorageService=k,this.imageCollection=null,this.projectImages=[],this.clusters=[],this.thumbnailImages=[],this.deferAddThumbnail=[],this.modalInstance=null,this.usedImagesWithError=[],this.hasUsedImagesWithError=!1,this.logger=j.newInstance("ImageCtrl"),this.uploadErrorDialogOpen=!1,this.subsequentUploadProgressViewing=!1,this._pHashMap={},b.subscribe(b.events.PROJECT_SAVE_COMPLETED,function(a){return function(){return a.subsequentUploadProgressViewing=!1}}(this),a),this.ensureUsedImagesWithError=function(a){return function(){return a.usedImagesWithError=a.imageCollection.getUsedImagesWithError(),a.hasUsedImagesWithError=a.usedImagesWithError.length>0}}(this),this.ensure3rdPartyImagesError=function(a){return function(){var b;return b=a.projectService.currentProject.imageCollection,a.All3rdPartyImagesWithError=b.get3rdPartyImagesWithError(),a.has3rdPartyImagesWithError=a.All3rdPartyImagesWithError.length>0}}(this),this.clearUsedImagesWithErrorFromSurface=function(a){return function(){if(a.hasUsedImagesWithError)return a.project.clearProductImages(a.usedImagesWithError),a.imageCollection.invalidateImageUseCounts(),a.findAllUsedImages(),a.projectService.validate({event:"ImageCtrl finished clearUsedImagesWithErrorFromSurface",intensity:"partial"})}}(this),l=function(a){return function(b){var c,d,e,f,g;if(!b||!b.layout)return null;for(g=b.layout.assets,e=0,f=g.length;e<f;e++)c=g[e],((null!=c?c.projectImageId:void 0)>=0||(null!=c?c.imageId:void 0))&&(d=(null!=c?c.projectImageId:void 0)>=0?a.imageCollection.getImageByProductImageId(parseInt(c.projectImageId)):a.imageCollection.getImageByImageId(c.imageId),d&&(0===d.useCount&&a.imageCollection.usedImagesAdd(),d.useCountAdd()))}}(this),o=function(a){return function(b){var c,d,e,f,g;if(!b||!b.layout)return null;for(g=b.layout.assets,e=0,f=g.length;e<f;e++)c=g[e],((null!=c?c.projectImageId:void 0)>=0||(null!=c?c.imageId:void 0))&&(d=(null!=c?c.projectImageId:void 0)>=0?a.imageCollection.getImageByProductImageId(parseInt(c.projectImageId)):a.imageCollection.getImageByImageId(c.imageId),d&&(1===d.useCount&&a.imageCollection.usedImagesSubtract(),d.useCountSubtract()))}}(this),this.getImageFooter=function(a){var b;return null!=(b=null!=a&&"function"==typeof a.createTimestampedDescription?a.createTimestampedDescription():void 0)?b:""},n=function(a){return function(){var b,c,e,f,g;for(f=a.deferAddThumbnail,g=[],c=0,e=f.length;c<e;c++)b=f[c],g.push(a.imageCollection.addThumbnail(d.newInstance(b)));return g}}(this),m=function(a){return function(b){var c,d;if(a.project=b,a.imageCollection=a.project.imageCollection,null!=(null!=(c=a.project)&&null!=(d=c.imageCollection)?d.projectImages:void 0))return a.projectImages=a.project.imageCollection.projectImages,a.clusterImagesBy("all"),a.imageCollection.invalidateImageUseCounts(),a.findAllUsedImages(),n()}}(this),this.findAllUsedImages=function(a){return function(){var b,c,d,e,f,g;for(null!=(b=a.project.product.cover)&&(l(b.spinePage),l(b.backPage),l(b.frontPage)),f=a.project.product.pages,g=[],d=0,e=f.length;d<e;d++)c=f[d],g.push(l(c));return g}}(this),this.showUploadInProgressModal=function(c){return function(d){return c.hideModal(),c.checkForMissingImage()?(c.signalUploadingComplete(),"save"===(null!=d?d.source:void 0)?b.publish(b.events.PROJECT_SAVE):void 0):(c.uploadInProgressDisableClose=null!=d?d.disableClose:void 0,c.modalInstance=f.open({templateUrl:"Palette/views/upload-in-progress.html",scope:a,backdrop:"static"}))}}(this),this.cancelUpload=function(a){return b.publish(b.events.PALETTE_IMAGES_UPLOAD_CANCEL,a),this.imageCollection.cancelUpload(a.productImageID)},this.cancelUploadsInProgress=function(a){return function(){var c,d,e,f,g,h;for(a.hideModal(),b.publish(b.events.CANCEL_UPLOADS),d=a.imageCollection.currentProductImageIDsUploading,h=[],f=0,g=d.length;f<g;f++)e=d[f],c=a.imageCollection.getImageByProductImageId(e),a.imageCollection.cancelUpload(e),h.push(b.publish(b.events.PALETTE_IMAGES_UPLOADED,c));return h}}(this),this.clusterImagesBy=function(b){return function(c){var d,e,f,g,h,i,j;for(g={},j=b.projectImages,h=0,i=j.length;h<i;h++)f=j[h],d="null"===f.captureTime||null==f.captureTime?null:new Date(f.captureTime),e=null!=d?b.getClusterKeyByKeyName(d,c):"zzz",null==g[e]&&(g[e]=[]),g[e].push(f);b.clusters=[],Object.keys(g).sort().forEach(function(a){b.clusters.push(g[a])}),b.$timeout(function(){return a.$digest()},0)}}(this),this.getClusterKeyByKeyName=function(a,b){var c,d,e;switch(b){case"all":return"all";case"year":return a.getFullYear()+"";case"month":return d=a.getFullYear()+""+("0"+(a.getMonth()+1)).slice(-2);case"week":return e=Math.floor((a-new Date(1905,0,1))/6048e5),d=("00000"+e).slice(-5);case"day":return c=Math.ceil((a-new Date(a.getFullYear(),0,1))/864e5)+1,d=a.getFullYear()+("00"+c).slice(-3);case"hour":return d=i("date")(new Date(a),"yyyyMMddHH")}return null},this.getClusterTitle=function(b,c){var d;if(!a.ctrls.PaletteCtrl.clusterStoryboard||!a.ctrls.PaletteCtrl.clusterKey)return"";if(0<b.length){if("null"===b[0].captureTime||null==b[0].captureTime)return null;switch(c){case"year":return i("date")(new Date(b[0].captureTime),"yyyy");case"month":return i("date")(new Date(b[0].captureTime),"MMMM, yyyy");case"week":return d=new Date(b[0].captureTime),"Week of "+i("date")(new Date(d.getFullYear(),d.getMonth(),d.getDate()-d.getDay(),0,0,0,0));case"day":return i("date")(new Date(b[0].captureTime),"MMMM dd, yyyy");case"hour":return i("date")(new Date(b[0].captureTime),"h:00 a, MMMM dd, yyyy")}if("undefined"!=typeof captureTime&&null!==captureTime)return captureTime}return"No date taken information"},this.isClusterEmpty=function(a,b,c){var d,e,f;if(0===a.length)return!0;if(!b&&!c)return!1;for(e=0,f=a.length;e<f;e++)if(d=a[e],!(b&&0!==d.useCount||c&&1!==d.ranking))return!1;return!0},this.dismissUploadInProgressModal=function(a){return function(){return a.subsequentUploadProgressViewing=!0,b.publish(b.events.MODAL_UPLOAD_PROGRESS_DISMISS),a.hideModal()}}(this),this.cancelUploadErrorModal=function(a){return function(){return a.clearUsedImagesWithErrorFromSurface(),a.hideModal(),a.imageCollection.resetUploadErrors(),a.imageCollection.completeUpload()}}(this),this.hideModal=function(a){return function(){var b;return a.uploadErrorDialogOpen=!1,null!=(b=a.modalInstance)&&"function"==typeof b.dismiss&&b.dismiss(),a.modalInstance=null}}(this),this.showUploadErrorModal=function(b){return function(c){if(!(b.uploadErrorDialogOpen===!0||b.imageCollection.currentUploadErrors<1))return b.projectService.validate({event:"ImageCtrl showing upload error dialog"}),b.hideModal(),b.uploadErrorDialogOpen=!0,b.ensureUsedImagesWithError(),b.ensure3rdPartyImagesError(),b.modalInstance=f.open({templateUrl:"Palette/views/upload-error.html",scope:a,backdrop:"static"})}}(this),this.retryUpload=function(a){return function(){return a.hideModal(),a.imageCollection.resetUploadErrors(),a.imageCollection.retryFailedUploads()}}(this),this._addPHashEntry=function(a){return function(b){return null==a._pHashMap[b.pHash]&&(a._pHashMap[b.pHash]=[]),a._pHashMap[b.pHash].push(b)}}(this),this._removePHashEntry=function(a){return function(b){var c,d,e,f,g;for(c in a._pHashMap)for(g=a._pHashMap[c],d=f=g.length-1;f>=0;d=f+=-1)if(e=g[d],e.productImageID===b.productImageID)return a._pHashMap[c].splice(d,1),void(0===a._pHashMap[c].length&&delete a._pHashMap[c])}}(this),this._updatePHashEntry=function(a){return function(b){return a._removePHashEntry(b),a._addPHashEntry(b)}}(this),this.getDuplicateImages=function(a){return function(b,c){var d,e,f,g,h;if(null==c&&(c=!1),null==a._pHashMap[b])return[];for(d=[],h=a._pHashMap[b],f=0,g=h.length;f<g;f++)e=h[f],c&&0!==e.useCount||d.push(e);return d}}(this),this.imageHasDuplicate=function(a,b){var c,d,e,f;if(null==b&&(b=!1),!this._pHashMap.hasOwnProperty(a.pHash))return!1;for(f=this._pHashMap[a.pHash],d=0,e=f.length;d<e;d++)if(c=f[d],c.productImageID!==a.productImageID&&(!b||0===c.useCount))return!0;return!1},b.subscribe(b.events.PALETTE_IMAGES_REMOVED,function(a){return function(b,c){return a._removePHashEntry(c)}}(this),a),b.subscribe(b.events.PALETTE_IMAGES_ADDED,function(a){return function(b,c){return a._addPHashEntry(c)}}(this),a),b.subscribe(b.events.PALETTE_IMAGE_RATED,function(a){return function(b,c){return a._updatePHashEntry(c)}}(this),a),b.subscribe(b.events.PROJECT_LOADED,function(a,b){return m(b)},a),b.subscribe(b.events.SURFACE_IMAGE_ADDED,function(b){return function(c,d){
var e;if(e=b.imageCollection.getImageByImageId(d.imageId))return 0===e.useCount&&b.imageCollection.usedImagesAdd(),e.useCountAdd(),a.$digest()}}(this),a),b.subscribe(b.events.SURFACE_IMAGE_REMOVED,function(b){return function(c,d){var e;if(e=b.imageCollection.getImageByImageId(d.imageId))return 1===e.useCount&&b.imageCollection.usedImagesSubtract(),e.useCountSubtract(),a.$digest()}}(this),a),b.subscribe(b.events.PALETTE_THUMBNAILS_ADDED,function(e){return function(f,g){var h,i,j,k,l,m,n,o,p;b.publish(b.events.UPP_IMAGE_FINISH);{if(null!=(null!=(o=e.imageCollection)?o.addThumbnail:void 0)){for(l=0,n=g.length;l<n;l++)i=g[l],i.localImageDataPromise?!function(b){return b.localImageDataPromise.then(function(){return e.imageCollection.addThumbnail(d.newInstance(b)),e.$timeout(function(){return a.$digest()},0)})}(i):e.imageCollection.addThumbnail(d.newInstance(i));return e.$timeout(function(){return a.$digest()},0)}for(j=g.filter(function(a){var b;return"sfly"===(null!=(b=a.source)?b.id:void 0)}).length,h=j<c.defaults.autofillMinImages||j>c.defaults.autofillMaxImages,k=0,m=g.length;k<m;k++)i=g[k],(h||"sfly"!==(null!=(p=i.source)?p.id:void 0))&&e.deferAddThumbnail.push(i)}}}(this),a),b.subscribe(b.events.PALETTE_IMAGES_UPLOADED,function(c){return function(e,f){var g,h;return g=c.imageCollection.updateThumbnail(f.productImageID,d.newInstance(f)),g&&(null!=(h=c.project)&&h.updateProductImageAsset(g,!0),g.progress=("function"==typeof g.hasUnencodedImageId?g.hasUnencodedImageId():void 0)?0:100,b.publish(b.events.SURFACE_IMAGE_UPDATED,g.productImageID),c._updatePHashEntry(g)),c.$timeout(function(){return a.$digest()},0)}}(this),a),b.subscribe(b.events.PALETTE_IMAGES_UPLOAD_ERROR,function(b){return function(c,d){return b.imageCollection.setUploadError(null!=d?d.productImageID:void 0,null!=d?d.id:void 0),b.uploadErrorDialogOpen&&b.logger.warn("--UploadErrorAfterUploadErrorDialogShown--"),a.$digest()}}(this),a),b.subscribe(b.events.PALETTE_THUMBNAILS_REMOVED,function(a,b){},a),b.subscribe(b.events.PALETTE_THUMBNAILS_REFRESH,function(b){return function(c,d){return b.$timeout(function(){return a.$digest()},0)}}(this),a),b.subscribe(b.events.MODAL_UPLOAD_PROGRESS_SHOW,function(a){return function(b,c){return a.showUploadInProgressModal(c)}}(this),a),b.subscribe(b.events.MODAL_UPLOAD_PROGRESS_HIDE,function(a){return function(b){return a.hideModal()}}(this),a),b.subscribe(b.events.MODAL_UPLOAD_ERROR_SHOW,function(a){return function(b,c){return a.showUploadErrorModal(c)}}(this),a),b.subscribe(b.events.MODAL_UPLOAD_ERROR_HIDE,function(a){return function(b){return a.hideModal()}}(this),a),b.subscribe(b.events.SURFACE_REMOVED,function(a,b){return o(b)},a),b.subscribe(b.events.SURFACE_ADDED,function(a,b){return l(b)},a),b.subscribe(b.events.RECLUSTER_REQUIRED,function(a){return function(){return a.recluster()}}(this),a),this.recluster=function(b){return function(){return a.ctrls.PaletteCtrl.clusterStoryboard?b.clusterImagesBy(a.ctrls.PaletteCtrl.clusterKey):b.clusterImagesBy("all")}}(this),p=function(a){return function(b){return a.logger.warn("--GalleonPresentedUsedImageAsRemovable--",{imageId:b,hasUsedImagesWithError:a.hasUsedImagesWithError}),a.imageCollection.invalidateImageUseCounts(),a.findAllUsedImages(),f.open({templateUrl:"Palette/views/image-used-cant-delete.html",backdrop:"static",controller:"SimpleModalCtrl",resolve:{data:function(){return{}}}})}}(this),this.removeImage=function(a){return function(c){var d;return d=a.imageCollection.getImageByProductImageId(c),a.projectService.currentProject.productContainsImageId(null!=d?d.imageId:void 0)?void a.$timeout(function(){return p(null!=d?d.imageId:void 0)}):(d.hasError?a.imageCollection.removeImage(a.imageCollection.getImageIndex(c)):e.execute("RemovePaletteImageCommand",{productImageId:c}),b.publish(b.events.PALETTE_IMAGES_REMOVED,d),a.recluster())}}(this),this.checkForMissingImage=function(){var a,b,c,d,e,f;for(c=this.imageCollection.currentProductImageIDsUploading,e=0,f=c.length;e<f;e++)d=c[e],a=this.imageCollection.getImageByProductImageId(d),a||(b=c.indexOf(d),this.imageCollection._currentUploadInProgressList.splice(b,1));return 0===this.imageCollection.currentProductImageIDsUploading.length},this.signalUploadingComplete=function(){return this.imageCollection.resetUploadErrors(),this.imageCollection.resetUploadTotalList()},m(g.currentProject),a.ctrls.ImageCtrl=this},a.$inject=["$scope","eventBus","CONFIG","uppImageFactory","commandService","$modal","projectService","$timeout","$filter","loggerFactory","localStorageService"],angular.module("galleon").controller("ImageCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l,m){var n;this.$scope=a,this.contentService=c,this.commandService=d,this.navService=e,this.eventBus=f,this.contentGraphicAssetFactory=g,this.projectService=h,this.paletteService=i,this.config=j,this.utilsService=k,this.tabIntroModalService=l,this.appState=m,this.refreshPaletteBackgrounds=b(this.refreshPaletteBackgrounds,this),this.onSurfaceSelected=b(this.onSurfaceSelected,this),this.onBackgroundChanged=b(this.onBackgroundChanged,this),this.parseBackgroundsFromStyle=b(this.parseBackgroundsFromStyle,this),this.$scope.ctrls.BackgroundsCtrl=this,this.eventBus.subscribe(this.eventBus.events.STYLE_LOADED,this.parseBackgroundsFromStyle,this.$scope),this.eventBus.subscribe(this.eventBus.events.SURFACE_SELECTED,this.onSurfaceSelected,this.$scope),this.eventBus.subscribe(this.eventBus.events.SURFACE_INVALIDATED,this.onBackgroundChanged,this.$scope),this.eventBus.subscribe(this.eventBus.events.SURFACE_BACKGROUND_UPDATED,this.onBackgroundChanged,this.$scope),this.eventBus.subscribe(this.eventBus.events.EXT_PALETTE_ITEMS_UPDATED,this.refreshPaletteBackgrounds,this.$scope),this.selectedBackgroundId=null,this.forceScroll=!1,this.shouldScroll=!0,this.isActiveTab=!0,this.isOpen=!1,this.extPaletteItems=[],this.shownPABIntro=!1,this.markedAsRemoveItemId=null,this.pabAsset={assetId:"pab-asset-id",isPABItem:!0,previewWidth:250,previewHeight:200},null!=this.contentService.currentStyle&&this.parseBackgroundsFromStyle(),null!=(null!=(n=this.navService)?n.selectedPage:void 0)&&(this.onBackgroundChanged(null,null),this.refreshPaletteBackgrounds())}return a.prototype.tabActivated=function(){return this.isActiveTab=!0,this.onBackgroundChanged(null,null),this.refreshPaletteBackgrounds()},a.prototype.tabDeactivated=function(){return this.isActiveTab=!1},a.prototype.parseBackgroundsFromStyle=function(){var a,b,c,d,e,f,g,h,i,j;for(d=function(a){var b,c;return"hidden"===(null!=(b=a.backgroundAttributes)?b.State:void 0)||"none"===(null!=(c=a.backgroundAttributes)?c.PaletteVisibility:void 0)},this.backgrounds=[],this._cachedBackgrounds=[],i=this.contentService.currentStyle.assetLists.assetList,e=0,g=i.length;e<g;e++)if(a=i[e],"coreBackgrounds"===a.listType){for(j=a.assetRef,f=0,h=j.length;f<h;f++)b=j[f],d(b)||(c=this.contentGraphicAssetFactory.newInstance(a.assetType,b),!this.config.spreads&&c.isSpread()||this._cachedBackgrounds.push(c));return this.backgrounds=this._cachedBackgrounds,this.backgrounds}return this._refreshSelectedBackground(),this.refreshPaletteBackgrounds(),this.backgrounds},a.prototype._findIndexOfBackground=function(a){var b,c,d,e,f;if(null==a)return-1;if(b=null!=a&&null!=(d=a.values)&&null!=(e=d.assetReference)?e.assetId:void 0,!b)return-1;f=this.backgrounds;for(c in f)if(a=f[c],a.assetId===b)return parseInt(c);return-1},a.prototype._refreshSelectedBackground=function(){var a,b,c;return a=this.navService.selectedPage.getFirstBackground(),this.selectedBackgroundId=null!=a&&null!=(b=a.values)&&null!=(c=b.assetReference)?c.assetId:void 0,this.shouldScroll&&this.triggerScrollToSelectedItem(),setTimeout(function(a){return function(){return a.$scope.$digest()}}(this),0)},a.prototype.triggerScrollToSelectedItem=function(){if(this.isActiveTab)return this.forceScroll=!this.forceScroll},a.prototype.onBackgroundChanged=function(a,b){if(this.isActiveTab)return this._refreshSelectedBackground()},a.prototype.onSurfaceSelected=function(a,b){return this.onBackgroundChanged(a,b),this.refreshPaletteBackgrounds(),this.shouldScroll=!0,setTimeout(function(a){return function(){return a.$scope.$digest()}}(this),0)},a.prototype.onRemoveFromProject=function(a){var b,c;return b="backgrounds",(null!=(c=this.navService.selectedPage)?c.isCover():void 0)&&(b="backgrounds-cover"),this.paletteService.removeItemByDispObjType(b,a)},a.prototype.refreshPaletteBackgrounds=function(){var a,b,c;return this.markedAsRemoveItemId=null,a=!(null!=(b=this.projectService.currentProject.product.cover)?b.isStockCover:void 0),this.backgrounds=this._cachedBackgrounds,(null!=(c=this.navService.selectedPage)?c.isCover():void 0)&&!a?(this.backgrounds=[],void(this.extPaletteItems=[])):this.extPaletteItems=this.paletteService.getBackgrounds()},a.prototype.applyWithoutScroll=function(a,b){return this.shouldScroll=!1,this.apply(a,b)},a.prototype.apply=function(a,b){var c,d,e,f;if((null!=(e=this.navService.selectedPage.layout)?e.hasPictureAsBackground():void 0)&&(d=this.navService.selectedPage.layout.getBackgroundImageAssignment().imageReference,this.eventBus.publish(this.eventBus.events.SURFACE_IMAGE_REMOVED,{pageNumber:this.navService.selectedPage.surfaceNumber,imageId:d.imageId})),c=b[a],(null!=(f=this.navService.selectedPage.getFirstBackground())?f.asset.assetId:void 0)!==c.assetId)return this.commandService.execute("ApplyBackgroundCommand",{contentGraphicAsset:c,pageNumber:this.navService.selectedPage.surfaceNumber})},a.prototype.isPremium=function(a){return this.storytellingAssetRegistry.hasAsset(a)},a.prototype.itemHasPrice=function(a){return null!=a&&""!==a&&!(""===this.getItemPrice(a))},a.prototype.getItemPrice=function(a){var b,c,d,e;return c=this.storytellingAssetRegistry.getAsset(a),null==c?"":(b=null!=(d=null!=(e=this.itemPricingService.getSkuPrice(c))?e.saleTotalPrice:void 0)?d:"",""===b?"":"$"+b)},a.prototype.addPictureAsBackground=function(){return this.commandService.execute("AddPictureAsBackgroundCommand",{pageNumber:this.navService.selectedPage.surfaceNumber})},a.prototype.addRealPictureAsBackground=function(){if(this.appState.backgroundsWaitingForPicture=[this.navService.selectedPage.layout.assets[0]],this.navService.selectedPage.isSpread()&&this.appState.backgroundsWaitingForPicture.push(this.navService.selectedPage.layout.assets[1]),!this.shownPABIntro)return this.shownPABIntro=!0,this.tabIntroModalService.open(this.$scope,"hidePABIntro",{titleKey:"SilverApp.pab.popover.title",bodyKey:"SilverApp.pab.popover.message.active",buttonDtk:"button_pabIntro_ok",inputDtk:"button_pabIntro_disable"})},a.prototype.cancelWaitingForPicture=function(){return this.appState.backgroundsWaitingForPicture=[]},a}(),a.$inject=["$scope","contentService","commandService","navService","eventBus","contentGraphicAssetFactory","projectService","paletteService","CONFIG","utilsService","tabIntroModalService","appState"],angular.module("galleon").controller("BackgroundsCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l,m){this.$scope=a,this.$timeout=c,this.contentService=d,this.contentLayoutFactory=f,this.pageFactory=g,this.navService=h,this.projectService=i,this.layoutService=j,this.paletteService=k,this.config=l,this.appState=m,this.refreshPaletteLayouts=b(this.refreshPaletteLayouts,this),this.onFilterSelectionChanged=b(this.onFilterSelectionChanged,this),this.onSurfaceModified=b(this.onSurfaceModified,this),this.onSurfaceSelected=b(this.onSurfaceSelected,this),this.ensureLayoutsForAdjustedCover=b(this.ensureLayoutsForAdjustedCover,this),this.onStyleLoaded=b(this.onStyleLoaded,this),a.ctrls.LayoutsCtrl=this,this.coverIndex=0,this.innerIndex=0,this.titleIndex=0,null!=d.currentStyle&&(this.parseLayoutsFromStyle(),this.$timeout(function(a){return function(){return a.$scope.$digest()}}(this),0)),e.subscribe(e.events.STYLE_LOADED,this.onStyleLoaded,this.$scope),e.subscribe(e.events.SURFACE_SELECTED,this.onSurfaceSelected,this.$scope),e.subscribe(e.events.SURFACE_IMAGE_ADDED,this.onSurfaceModified,this.$scope),e.subscribe(e.events.SURFACE_IMAGE_REMOVED,this.onSurfaceModified,this.$scope),e.subscribe(e.events.SURFACE_LAYOUT_UPDATED,this.onSurfaceModified,this.$scope),e.subscribe(e.events.PROJECT_CONVERSION_COMPLETE,this.ensureLayoutsForAdjustedCover,this.$scope),e.subscribe(e.events.PROJECT_UNDO_CONVERSION_COMPLETE,this.ensureLayoutsForAdjustedCover,this.$scope),e.subscribe(e.events.EXT_PALETTE_ITEMS_UPDATED,this.refreshPaletteLayouts,this.$scope),this.refreshSelectionRequired=!0,this.selectedLayoutId=null,this.forceScroll=!1,this.shouldScroll=!0,this.showFilters=!this.shouldHideFilters(this.navService.selectedPage),this.isActiveTab=!0,this.showEPLink=!this.shouldHideExtendedPaletteLink(this.navService.selectedPage),this.extPaletteItems=[],this.extPaletteSpreadItems=[],this.markedAsRemoveItemId=null,this.isSpreadFilterSelected=!1,this.filterOptions=[{id:"1",dataTestKey:"palette_layouts_1",text:"Palette.layouts.1",count:1,operator:"equal"},{id:"2",dataTestKey:"palette_layouts_2",text:"Palette.layouts.2",count:2,operator:"equal"},{id:"3",dataTestKey:"palette_layouts_3",text:"Palette.layouts.3",count:3,operator:"equal"},{id:"4",dataTestKey:"palette_layouts_4",text:"Palette.layouts.4",count:4,operator:"equal"},{id:"5+",dataTestKey:"palette_layouts_5",text:"Palette.layouts.5",count:5,operator:"equal_or_greater"}],"book"===this.config.defaults.productMode&&this.filterOptions.push({id:"Text",dataTestKey:"palette_layouts_text",text:"Palette.layouts.text",count:0,operator:"equal"}),this.config.spreads&&this.filterOptions.push({id:"Spreads",dataTestKey:"palette_layouts_spreads",text:"Palette.layouts.spreads"}),this.onSurfaceModified(),this.$scope.$watch("ctrls.LayoutsCtrl.selectedFilterIndex",function(a){return function(b){return a.$timeout(a.onFilterSelectionChanged,0)}}(this))}return a.prototype.getSelectedFilter=function(){return null==this.selectedFilterIndex?null:this.filterOptions[this.selectedFilterIndex]},a.prototype.onStyleLoaded=function(a,b){return this.parseLayoutsFromStyle(a,b),this.$scope.$digest()},a.prototype.ensureLayoutsForAdjustedCover=function(a,b){var c,d;if(c=null!=(d=this.navService.selectedPage)?d.surfaceNumber:void 0,c===this.pageFactory.Page.FRONT_COVER_PAGE_NUMBER||c===this.pageFactory.Page.BACK_COVER_PAGE_NUMBER||c===this.pageFactory.Page.SPINE_PAGE_NUMBER)return this.refreshPaletteLayouts(),this.triggerScrollToSelectedItem()},a.prototype.parseLayoutsFromStyle=function(){var a;return a=this.layoutService.parseLayoutsFromStyle(),this.frontCoverLayouts=a.frontCoverLayouts,this.backCoverLayouts=a.backCoverLayouts,this.spineLayouts=a.spineLayouts,this.titleLayouts=a.titleLayouts,this.innerLayouts=a.innerLayouts,this.innerSpreadLayouts=a.innerSpreadLayouts,this.paletteSpreadLayouts=[],this.paletteLayouts=[],this.refreshPaletteLayouts(),this.triggerScrollToSelectedItem()},a.prototype.shouldHideFilters=function(a){var b;return(b=a.surfaceNumber)===this.pageFactory.Page.TITLE_PAGE_NUMBER||b===this.pageFactory.Page.FRONT_COVER_PAGE_NUMBER||b===this.pageFactory.Page.BACK_COVER_PAGE_NUMBER||b===this.pageFactory.Page.SPINE_PAGE_NUMBER},a.prototype.shouldHideExtendedPaletteLink=function(a){var b;return(b=a.surfaceNumber)===this.pageFactory.Page.FRONT_COVER_PAGE_NUMBER||b===this.pageFactory.Page.BACK_COVER_PAGE_NUMBER||b===this.pageFactory.Page.SPINE_PAGE_NUMBER},a.prototype.triggerScrollToSelectedItem=function(){if(this.isActiveTab)return this.forceScroll=!this.forceScroll},a.prototype.findFilterIndexForPage=function(a){var b,c,d,e;if(this.showEPLink=!0,this.shouldHideExtendedPaletteLink(a)&&(this.showEPLink=!1),this.shouldHideFilters(a))return this.showFilters=!1,null;if(this.showFilters=!0,d=this.summarizeLayout(a.layout),this.blankLayout(d))return 0;e=this.filterOptions;for(c in e)if(b=e[c],this.filterOptionMatches(b,d))return parseInt(c);return null},a.prototype.onSurfaceSelected=function(a,b){if(this.isActiveTab)return this.$scope.$evalAsync(function(a){return function(){return a.selectedFilterIndex=a.findFilterIndexForPage(b),a.refreshPaletteLayouts(),a.shouldScroll?a.triggerScrollToSelectedItem():a.shouldScroll=!0}}(this))},a.prototype.onSurfaceModified=function(){var a;return this.refreshSelectionRequired===!1?(this.refreshSelectionRequired=!0,void this.refreshSelectedLayout()):(a=this.navService.selectedPage,this.onSurfaceSelected(null,a))},a.prototype.onRemoveFromProject=function(a){return this.paletteService.removeItem(a)},a.prototype.tabActivated=function(){return this.appState.cancelBackgroundWaitingForPicture(),this.isActiveTab=!0,this.onSurfaceModified()},a.prototype.tabDeactivated=function(){return this.isActiveTab=!1},a.prototype.onFilterSelectionChanged=function(){return this.refreshPaletteLayouts(),this.$scope.$digest()},a.prototype.refreshSelectedLayout=function(){return this.selectedLayoutId=this.navService.selectedPage.layoutName},a.prototype.refreshPaletteLayouts=function(){var a,b,c,d,e;switch(this.markedAsRemoveItemId=null,a=this.projectService.currentProject.product,b=null!=a.cover&&!a.cover.isStockCover,c=null!=(e=this.navService.selectedPage)?e.surfaceNumber:void 0){case this.pageFactory.Page.TITLE_PAGE_NUMBER:this.paletteLayouts=this.titleLayouts,this.paletteSpreadLayouts=[];break;case this.pageFactory.Page.FRONT_COVER_PAGE_NUMBER:this.paletteSpreadLayouts=[],b?this.paletteLayouts=this.filterLayoutsFromCurrentCoverType(this.frontCoverLayouts):this.paletteLayouts=[];break;case this.pageFactory.Page.BACK_COVER_PAGE_NUMBER:this.paletteSpreadLayouts=[],b?this.paletteLayouts=this.filterLayoutsFromCurrentCoverType(this.backCoverLayouts):this.paletteLayouts=[];break;case this.pageFactory.Page.SPINE_PAGE_NUMBER:this.paletteSpreadLayouts=[],b?this.paletteLayouts=this.filterLayoutsFromCurrentCoverType(this.spineLayouts,!0):this.paletteLayouts=[];break;case this.pageFactory.Page.FRONT_FILLER_PAGE_NUMBER:case this.pageFactory.Page.BACK_FILLER_PAGE_NUMBER:this.paletteSpreadLayouts=[],this.paletteLayouts=[];break;default:this.paletteLayouts=this.innerLayouts,this.paletteSpreadLayouts=this.innerSpreadLayouts}return this._sortAndSplitExtPaletteItems(this.paletteService.getLayouts()),d=this.getSelectedFilter(),null!=d&&"Spreads"===d.id?(this.isSpreadFilterSelected=!0,this.paletteSpreadLayouts=[],this.paletteLayouts=this.innerSpreadLayouts):(this.isSpreadFilterSelected=!1,this.paletteLayouts=this.filterLayoutsFromCurrentFilterOption(this.paletteLayouts),this.paletteSpreadLayouts=this.filterLayoutsFromCurrentFilterOption(this.paletteSpreadLayouts)),this.extPaletteItems=this.filterLayoutsFromCurrentFilterOption(this.extPaletteItems),this.extPaletteSpreadItems=this.filterLayoutsFromCurrentFilterOption(this.extPaletteSpreadItems),this.refreshSelectedLayout()},a.prototype._sortAndSplitExtPaletteItems=function(a){var b,c,d,e,f;for(d=[],b=[],e=0,f=a.length;e<f;e++)c=a[e],this.config.spreads&&(null!=c&&"function"==typeof c.isSpread?c.isSpread():void 0)?d.push(c):b.push(c);return this.extPaletteItems=b,this.extPaletteSpreadItems=d},a.prototype.filterLayoutsFromCurrentCoverType=function(a,b){return null==b&&(b=!1),this.layoutService.filterLayoutsFromCurrentCoverType(a,b)},a.prototype.filterLayoutsFromCurrentFilterOption=function(a){var b;return null==a?null:(b=this.getSelectedFilter(),null==b?a:a.filter(function(a){return function(c){return"Spreads"===b.id?c.isSpread():a.filterOptionMatches(b,c)}}(this)))},a.prototype.summarizeLayout=function(a){return this.layoutService.summarizeLayout(a)},a.prototype.filterOptionMatches=function(a,b){switch(a.operator){case"equal":return b.imageCount===a.count;case"equal_or_greater":return b.imageCount>=a.count}throw new Error("LayoutsCtrl internal error: unexpected filterOption: "+JSON.stringify(a))},a.prototype.getNextLayout=function(a,b,c){var d;for(d=a,a+=1;b[a].imageCount!==c&&a!==d;)a+=1,a>=b.length&&(a=0);return a},a.prototype.applyNextWithoutScrollInner=function(a){return this.navService.setSelectedPage(this.projectService.currentProject.product.pageBySurfaceNumber(a),!0),this.$timeout(function(a){return function(){var b;return b=a.getNextLayout(a.innerIndex,a.innerLayouts,1),a.innerIndex=b,a.applyWithoutScroll(b,a.innerLayouts)}}(this),100)},a.prototype.applyNextWithoutScrollTitle=function(){return this.navService.setSelectedPage(this.projectService.currentProject.product.pageBySurfaceNumber(1),!0),this.$timeout(function(a){return function(){var b;return b=a.getNextLayout(a.titleIndex,a.titleLayouts,1),a.titleIndex=b,a.applyWithoutScroll(b,a.titleLayouts)}}(this),100)},a.prototype.applyNextWithoutScrollCover=function(){return this.navService.selectCoverSpread(this.projectService.currentProject.product.cover.frontPage),this.coverLayouts=this.filterLayoutsFromCurrentCoverType(this.frontCoverLayouts),this.$timeout(function(a){return function(){var b;return b=a.getNextLayout(a.coverIndex,a.coverLayouts,1),a.coverIndex=b,a.applyWithoutScroll(b,a.coverLayouts)}}(this),100)},a.prototype.applyWithoutScroll=function(a,b){return this.shouldScroll=!1,this.apply(a,b)},a.prototype.apply=function(a,b){var c;return c=b[a],this.layoutService.applyToSelectedPage(c),this.refreshSelectionRequired=!1},a.prototype.layoutThumbnailClass=function(a){var b;return b=/[^_]_([a-zA-Z-]*)/.exec(a.assetId),null!=b?"layouts-"+b[1]:""},a.prototype.blankLayout=function(a){return 0===a.imageCount&&a.hasTextAsset===!1},a}(),a.$inject=["$scope","$timeout","contentService","eventBus","contentLayoutFactory","pageFactory","navService","projectService","layoutService","paletteService","CONFIG","appState"],angular.module("galleon").controller("LayoutsCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h){var i;this.$scope=a,this.eventBus=c,this.navService=d,this.projectService=e,this.userService=f,this.appState=g,this.onSurfaceSelected=b(this.onSurfaceSelected,this),this.editor=h.newInstance(),this.editor.$scope=this.$scope,this.editor.updateIsLoggedIn(),this.eventBus.subscribe(this.eventBus.events.SURFACE_SELECTED,this.onSurfaceSelected,this.$scope),null==(i=this.$scope).ctrls&&(i.ctrls={}),a.ctrls.EventsPaletteCtrl=this,this.activatedEvent=0,this.eventsDate={month:0,day:1,year:2016}}return a.prototype.editEvent=function(a,b){var c,d,e,f,g,h,i,j;return this.editor.startEditingEvent(a,b),this.calendarGrid=this.projectService.currentProject.product.calendarGrid,i=this.calendarGrid.findEventTextAreaForDate(b.date,this.currentPage),f=i.gridCellIterator,h=i.matchingAsset,j=this.calendarGrid.getEditableAssetsByClickedGridCellAsset(this.currentPage,h),c=j.dateAsset,d=j.eventAsset,g=j.imageAsset,e=j.gridCellAssets,this.eventBus.publish(this.eventBus.events.SELECT_EVENTS_TAB,{asset:h,eventAsset:d,gridCellAssets:e,imageAsset:g,page:this.currentPage})},a.prototype.manageEvents=function(){return this.eventBus.publish(this.eventBus.events.SELECT_EVENTS_TAB_FROM_PALETTE)},a.prototype.onSurfaceSelected=function(){var a;return this.currentPage=this.navService.selectedPage,this.date=this.projectService.currentProject.product.getCalendarDate(this.currentPage),this.eventsDate.month=this.date.month,a=this.projectService.currentProject.product.isGridPage(this.currentPage.surfaceNumber),a&&this.appState.paletteTabSelections.layouts?this.eventBus.publishSync(this.eventBus.events.PALETTE_SELECTION_REQUIRED,{select:"events"}):!a&&this.appState.paletteTabSelections.events?this.eventBus.publishSync(this.eventBus.events.PALETTE_SELECTION_REQUIRED,{select:"layouts"}):void 0},a.prototype.tabActivated=function(){return this.isActiveTab=!0,this.editor.activate(),this.userService.isUserSignedIn().then(function(a){return function(b){if(a.editor.isLoggedIn=b,a.editor.publicEventsLoaded||a.editor.loadPublicEvents(),a.editor.myEventsLoaded||a.editor.loadMyEvents(),!a.editor.isLoggedIn)return a.editor.login()}}(this))},a.prototype.tabDeactivated=function(){return this.isActiveTab=!1,this.editor.deactivate()},a}(),a.$inject=["$scope","eventBus","navService","projectService","userService","appState","eventsEditingServiceFactory"],angular.module("galleon").controller("EventsPaletteCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l,m){this.$scope=a,this.$timeout=c,this.contentService=d,this.contentLayoutFactory=f,this.pageFactory=g,this.navService=h,this.projectService=i,this.layoutService=j,this.config=k,this.paletteService=l,this.utilsService=m,this.refreshPaletteIdeaPages=b(this.refreshPaletteIdeaPages,this),this.onSurfaceModified=b(this.onSurfaceModified,this),this.onSurfaceSelected=b(this.onSurfaceSelected,this),this.parseIdeaPagesFromStyle=b(this.parseIdeaPagesFromStyle,this),this.ensureIdeaPagesForAdjustedCover=b(this.ensureIdeaPagesForAdjustedCover,this),this.onStyleLoaded=b(this.onStyleLoaded,this),a.ctrls.IdeaPagesCtrl=this,null!=d.currentStyle&&this.parseIdeaPagesFromStyle(),e.subscribe(e.events.STYLE_LOADED,this.onStyleLoaded,this.$scope),e.subscribe(e.events.SURFACE_SELECTED,this.onSurfaceSelected,this.$scope),e.subscribe(e.events.SURFACE_IMAGE_ADDED,this.onSurfaceModified,this.$scope),e.subscribe(e.events.SURFACE_IMAGE_REMOVED,this.onSurfaceModified,this.$scope),e.subscribe(e.events.SURFACE_LAYOUT_UPDATED,this.onSurfaceModified,this.$scope),e.subscribe(e.events.PROJECT_CONVERSION_COMPLETE,this.ensureIdeaPagesForAdjustedCover,this.$scope),e.subscribe(e.events.PROJECT_UNDO_CONVERSION_COMPLETE,this.ensureIdeaPagesForAdjustedCover,this.$scope),e.subscribe(e.events.EXT_PALETTE_ITEMS_UPDATED,this.refreshPaletteIdeaPages,this.$scope),this.selectedIdeaPageId=null,this.forceScroll=!1,this.shouldScroll=!0,this.isActiveTab=!0,this.extPaletteItems=[],this.extPaletteSpreadItems=[],this.markedAsRemoveItemId=null,this.onSurfaceModified()}return a.prototype.onStyleLoaded=function(a,b){return this.parseIdeaPagesFromStyle(a,b),this.$timeout(function(a){return function(){return a.$scope.$digest()}}(this),0)},a.prototype.ensureIdeaPagesForAdjustedCover=function(a,b){var c,d;if(c=null!=(d=this.navService.selectedPage)?d.surfaceNumber:void 0,c===this.pageFactory.Page.FRONT_COVER_PAGE_NUMBER||c===this.pageFactory.Page.BACK_COVER_PAGE_NUMBER||c===this.pageFactory.Page.SPINE_PAGE_NUMBER)return this.refreshPaletteIdeaPages(),this.triggerScrollToSelectedItem()},a.prototype.parseIdeaPagesFromStyle=function(a,b){var c,d,e,f;for(this.frontCoverIdeaPages=[],this.backCoverIdeaPages=[],this.spineIdeaPages=[],this.titleIdeaPages=[],this.innerIdeaPages=[],this.paletteIdeaPages=[],this.paletteSpreadIdeaPages=[],this.innerSpreadIdeaPages=[],f=this.contentService.currentStyle.assetLists.assetList,d=0,e=f.length;d<e;d++)c=f[d],"coreIdeaPages"===c.listType&&this.populateIdeaPagesList(c,this.innerIdeaPages),this.config.spreads&&"spreadCoreIdeaPages"===c.listType&&this.populateIdeaPagesList(c,this.innerSpreadIdeaPages),"titleIdeaPages"===c.listType&&this.populateIdeaPagesList(c,this.titleIdeaPages),"frontCoverIdeaPages"===c.listType&&this.populateIdeaPagesList(c,this.frontCoverIdeaPages),"backCoverIdeaPages"===c.listType&&this.populateIdeaPagesList(c,this.backCoverIdeaPages),"spineIdeaPages"===c.listType&&this.populateIdeaPagesList(c,this.spineIdeaPages);return this.refreshPaletteIdeaPages(),this.triggerScrollToSelectedItem()},a.prototype.triggerScrollToSelectedItem=function(){if(this.isActiveTab)return this.forceScroll=!this.forceScroll},a.prototype.onSurfaceSelected=function(a,b){if(this.isActiveTab)return this.shouldScroll?(this.refreshPaletteIdeaPages(),this.triggerScrollToSelectedItem()):(this.shouldScroll=!0,this.refreshSelectedIdeaPage()),setTimeout(function(a){return function(){return a.$scope.$digest()}}(this),0)},a.prototype.onSurfaceModified=function(){var a;return a=this.navService.selectedPage,this.onSurfaceSelected(null,a)},a.prototype.onRemoveFromProject=function(a){return this.paletteService.removeItem(a)},a.prototype.tabActivated=function(){return this.isActiveTab=!0,this.onSurfaceModified()},a.prototype.tabDeactivated=function(){return this.isActiveTab=!1},a.prototype.refreshSelectedIdeaPage=function(){var a;return a=this.navService.selectedPage,this.selectedIdeaPageId=a.layoutName},a.prototype.refreshPaletteIdeaPages=function(){var a,b,c,d,e,f;switch(this.markedAsRemoveItemId=null,a=!(null!=(e=this.projectService.currentProject.product.cover)?e.isStockCover:void 0),c=null!=(f=this.navService.selectedPage)?f.surfaceNumber:void 0,this.paletteSpreadIdeaPages=[],c){case this.pageFactory.Page.TITLE_PAGE_NUMBER:this.paletteIdeaPages=this.titleIdeaPages;break;case this.pageFactory.Page.FRONT_COVER_PAGE_NUMBER:a?this.paletteIdeaPages=this.filterIdeaPagesFromCurrentCoverType(this.frontCoverIdeaPages):this.paletteIdeaPages=[];break;case this.pageFactory.Page.BACK_COVER_PAGE_NUMBER:a?this.paletteIdeaPages=this.filterIdeaPagesFromCurrentCoverType(this.backCoverIdeaPages):this.paletteIdeaPages=[];break;case this.pageFactory.Page.SPINE_PAGE_NUMBER:a?this.paletteIdeaPages=this.filterIdeaPagesFromCurrentCoverType(this.spineIdeaPages,!0):this.paletteIdeaPages=[];break;case this.pageFactory.Page.FRONT_FILLER_PAGE_NUMBER:case this.pageFactory.Page.BACK_FILLER_PAGE_NUMBER:this.paletteIdeaPages=[];break;default:this.paletteIdeaPages=this.innerIdeaPages,this.paletteSpreadIdeaPages=this.innerSpreadIdeaPages}return d=function(){var a,c,d,e;for(d=this.paletteService.getIdeaPages(),e=[],a=0,c=d.length;a<c;a++)b=d[a],e.push(this.wrapExtendedPalettePage(b));return e}.call(this),this._sortAndSplitExtPaletteItems(d),this.refreshSelectedIdeaPage()},a.prototype._sortAndSplitExtPaletteItems=function(a){var b,c,d,e,f;for(d=[],b=[],e=0,f=a.length;e<f;e++)c=a[e],this.config.spreads&&(null!=c&&"function"==typeof c.isSpread?c.isSpread():void 0)?d.push(c):b.push(c);return this.extPaletteItems=b,this.extPaletteSpreadItems=d},a.prototype.wrapExtendedPalettePage=function(a){var b;return b=Object.create(a),b.elementStyle={background:"url("+this.config.protocolRelativeUrl(a.thumbUrl)+") no-repeat top center","background-size":"auto 100%",width:a.previewWidth+"px",height:a.previewHeight+"px"},b},a.prototype.filterIdeaPagesFromCurrentCoverType=function(a,b){var c,d;return c=this.projectService.currentProject.product.cover,d=function(a){return function(b){return b.assetId.toLowerCase().indexOf(a.toLowerCase())>=0}},b&&this.projectService.currentProject.product.hasWideSpine()?a.filter(d("wide")):c.isHardCover()?a.filter(d("hard")):c.isSoftCover()?a.filter(d("soft")):[]},a.prototype.summarizeIdeaPage=function(a){var b,c,d,e,f,g;for(d=0,c=!1,g=a.assets,e=0,f=g.length;e<f;e++)switch(b=g[e],null!=b.values&&(b=b.values),b.assetType){case"image":d+=1;break;case"text":c=!0}return{imageCount:d,hasTextAsset:c}},a.prototype.annotateIdeaPage=function(a,b,c){var d;return d=this.summarizeIdeaPage(a.layout_JSON),b.imageCount=d.imageCount,b.hasTextAsset=d.hasTextAsset,b.assetListType=c.listType},a.prototype.populateIdeaPagesList=function(a,b){var c,d,e,f,g,h,i;if(null!=a.assetRef){for(e=function(a){var b,c;return"hidden"!==(null!=(b=a.layoutAttributes)?b.State:void 0)&&"none"!==(null!=(c=a.layoutAttributes)?c.PaletteVisibility:void 0)},h=a.assetRef,i=[],f=0,g=h.length;f<g;f++)c=h[f],e(c)&&(d=this.contentLayoutFactory.newInstance(c),!this.config.spreads&&d.isSpread()||(this.annotateIdeaPage(c,d,a),i.push(b.push(d))));return i}},a.prototype.applyWithoutScroll=function(a){return this.shouldScroll=!1,this.applyIdeaPage(a)},a.prototype.applyIdeaPage=function(a){return this.layoutService.applyToSelectedPage(a)},a.prototype.isPremium=function(a){return this.storytellingAssetRegistry.hasAsset(a)},a.prototype.itemHasPrice=function(a){return null!=a&&""!==a&&!(""===this.getItemPrice(a))},a.prototype.getItemPrice=function(a){var b,c,d,e;return c=this.storytellingAssetRegistry.getAsset(a),null==c?"":(b=null!=(d=null!=(e=this.itemPricingService.getSkuPrice(c))?e.saleTotalPrice:void 0)?d:"",
""===b?"":"$"+b)},a.prototype.thumbnailCssClass=function(a){var b;return b=/[^_]_([a-zA-Z-]*)/.exec(a.assetId),null!=b?"layouts-"+b[1]:""},a}(),a.$inject=["$scope","$timeout","contentService","eventBus","contentLayoutFactory","pageFactory","navService","projectService","layoutService","CONFIG","paletteService","utilsService"],angular.module("galleon").controller("IdeaPagesCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l,m,n){this.$scope=a,this.contentService=c,this.eventBus=d,this.contentGraphicAssetFactory=e,this.customizeService=f,this.navService=g,this.$timeout=h,this.commandService=i,this.projectService=j,this.epService=k,this.paletteService=l,this.globalContentService=m,this.utilsService=n,this.selectNonEmptyFilter=b(this.selectNonEmptyFilter,this),this.refreshPaletteEmbellishments=b(this.refreshPaletteEmbellishments,this),this.onSurfaceSelected=b(this.onSurfaceSelected,this),this._handleStyleChange=b(this._handleStyleChange,this),this.$scope.ctrls.EmbellishmentsCtrl=this,d.subscribe(d.events.STYLE_LOADED,this._handleStyleChange,this.$scope),d.subscribe(d.events.SURFACE_SELECTED,this.onSurfaceSelected,this.$scope),d.subscribe(d.events.EXT_PALETTE_ITEMS_UPDATED,this.refreshPaletteEmbellishments,this.$scope),this.isActiveTab=!0,this.showFilters=!0,this.selectedFilterIndex=0,this.extPalItems=[],this.markedAsRemoveItemId=null,this.parseEmbellishmentsFromStyle(),this._setUpFilterOptions(),this.selectNonEmptyFilter(),this.$scope.$watch("ctrls.EmbellishmentsCtrl.selectedFilterIndex",function(a){return function(){return a._refreshFilters()}}(this))}var c;return a.prototype.tabActivated=function(){return this.isActiveTab=!0,this.refreshPaletteEmbellishments()},a.prototype.tabDeactivated=function(){return this.isActiveTab=!1},a.prototype._handleStyleChange=function(){return this.parseEmbellishmentsFromStyle(),this._setUpFilterOptions(),this.$timeout(function(a){return function(){return a.$scope.$digest()}}(this))},a.prototype._setUpFilterOptions=function(){return this.filterOptions=[{id:"sticker",dataTestKey:"palette_stickers",text:"Palette.stickers",textMore:"Palette.stickers.lowercase",objects:this.embellishments},{id:"ribbon",dataTestKey:"palette_ribbons",text:"Palette.ribbons",textMore:"Palette.ribbons.lowercase",objects:this.ribbons},{id:"frame",dataTestKey:"palette_frames",text:"Palette.frames",textMore:"Palette.frames.lowercase",objects:this.frames}],this.activeFilter=this.filterOptions[this.selectedFilterIndex],this.epService.currentRadioContext=this.activeFilter.id,this.refreshPaletteEmbellishments()},a.prototype.parseEmbellishmentsFromStyle=function(){var a,b,c,d,e;if(null!=this.contentService.currentStyle)return d=function(a){return function(b,c){return b[c[a]]=b[c[a]]||[],b[c[a]].push(c),b}},b=this.contentService.currentStyle.assetLists.assetList.reduce(d("listType"),{}),a=function(a){return function(b,c){return null!=c.assetRef?b.concat(c.assetRef.filter(function(a){var b,c;return"hidden"!==(null!=(b=a.embellishmentAttributes)?b.State:void 0)&&!("none"===(null!=(c=a.embellishmentAttributes)?c.PaletteVisibility:void 0))}).map(function(b){return a.contentGraphicAssetFactory.newInstance(c.assetType,b)})):b}}(this),this.embellishments=b.coreEmbellishments.reduce(a,[]),this.ribbons=b.corePatternBands.reduce(a,[]),e=this.contentService.currentStyle.styleFrames.styleFrame,this.frames=function(){var a,b,d;for(d=[],a=0,b=e.length;a<b;a++)c=e[a],d.push(this.globalContentService.getFrameForFrameId(c.frameId));return d}.call(this)},a.prototype._refreshFilters=function(){var a;return this.activeFilter=null!=(a=this.filterOptions[this.selectedFilterIndex])?a:this.filterOptions[0],this.epService.currentRadioContext=this.activeFilter.id,this.$timeout(function(a){return function(){return a.$scope.$digest()}}(this))},a.prototype.apply=function(a,b){if(!this.navService.selectedPage.isSpine())switch(this.activeFilter.id){case"sticker":return this._applyEmbellishment(a,b);case"ribbon":return this._applyEmbellishment(a,b);case"frame":return this._applyFrame(a,b)}},a.prototype._applyFrame=function(a,b){var c,d;return c=b[a],d={pageNumber:this.navService.selectedPage.surfaceNumber,frameWidth:c.thickness,frameColorId:c.colorId,frameColorHex:c.color,frameId:c.assetId},this.commandService.execute("ApplyFramesCommand",d)},a.prototype._applyEmbellishment=function(a,b){var c;return c=b[a],this.customizeService.prepareApplyEmbellishmentCommand(c,this.navService.selectedPage.surfaceNumber)()},a.prototype.onSurfaceSelected=function(a,b){if(this.isActiveTab)return this.refreshPaletteEmbellishments(),setTimeout(function(a){return function(){return a.$scope.$digest()}}(this),0)},a.prototype.onRemoveFromProject=function(a){return this.paletteService.removeItem(a)},a.prototype.refreshPaletteEmbellishments=function(){var a,b,c;if(this.embellishmentListModified=!this.embellishmentListModified,this.markedAsRemoveItemId=null,a=!(null!=(b=this.projectService.currentProject.product.cover)?b.isStockCover:void 0),this.filterOptions[0].objects=this.embellishments,this.filterOptions[1].objects=this.ribbons,this.filterOptions[2].objects=this.frames,this.filterOptions[0].extPaletteItems=this.paletteService.getStickers(),this.filterOptions[1].extPaletteItems=this.paletteService.getRibbons(),this.filterOptions[2].extPaletteItems=this.paletteService.getFrames(),(null!=(c=this.navService.selectedPage)&&"function"==typeof c.isCover?c.isCover():void 0)&&!a)return this.filterOptions[0].objects=[],this.filterOptions[1].objects=[],this.filterOptions[2].objects=[],this.filterOptions[0].extPaletteItems=[],this.filterOptions[1].extPaletteItems=[],this.filterOptions[2].extPaletteItems=[]},c=function(a){var b,c;return!(null!=(b=a.extPaletteItems)?b.length:void 0)&&!(null!=(c=a.objects)?c.length:void 0)},a.prototype.selectNonEmptyFilter=function(){var a,b,d,e,f;if(c(this.activeFilter))for(f=this.filterOptions,b=d=0,e=f.length;d<e;b=++d)if(a=f[b],a.id!==this.activeFilter.id&&!c(a))return void(this.selectedFilterIndex=b)},a}(),a.$inject=["$scope","contentService","eventBus","contentGraphicAssetFactory","customizeService","navService","$timeout","commandService","projectService","extendedPaletteService","paletteService","globalContentService","utilsService"],angular.module("galleon").controller("EmbellishmentsCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){return this.$scope=a,this.eventBus=b,this.$scope.ctrls.StylesCtrl?this.$scope.ctrls.StylesCtrl:(this.$scope.ctrls.StylesCtrl=this,void this.eventBus.subscribe(b.events.STYLE_LOADED,function(a){return function(){return a._styleLoaded()}}(this),this.$scope))}var b;return b=!1,a.prototype._styleLoaded=function(){return this.isStyleLoaded=!0},a}(),a.$inject=["$scope","eventBus"],angular.module("galleon").controller("StylesCtrl",a)}.call(this),function(){"use strict";var a;a=function(a,b){return{restrict:"A",template:"",link:function(c,d,e){var f,g;return f=angular.element("body"),g=function(){var a,b,c,d;return b=f.find(e.sizeElement),a=f.find(e.target),c=b.innerHeight(),d=""+c/2+"px "+c/2+"px",a.css({width:c,"-webkit-transform-origin":d,"-o-transform-origin":d,"-moz-transform-origin":d,"-ms-transform-origin":d,"transform-origin":d})},angular.element(a).bind("resize",g),b.subscribe(b.events.ENSURE_SECONDARY_PALETTE_REDRAW,function(){return g()},c),g()}}},a.$inject=["$window","eventBus"],angular.module("galleon").directive("secondaryPaletteTabsResizer",a)}.call(this),function(){"use strict";var a,b,c,d,e;a="both",c="vertical",b="horizontal",e=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},d=function(d,f,g,h){return{restrict:"E",transclude:!0,template:"<div ng-transclude></div>",replace:!0,scope:{watchOn:"=",actionWhen:"="},link:function(i,j,k){var l,m,n,o,p,q,r,s;return s=j,r=k.targetElementsClassifier,m=f(k.padLeft)(),n=f(k.padTop)(),l=f(k.scrollDirection)()||a,m=e(m)?parseInt(m,10):0,n=e(n)?parseInt(n,10):0,q=null,p=null,angular.element(d).bind("resize",function(){return null!==p&&h.cancel(p),p=h(function(){return q=s.find(r),o()},150)}),i.$watch("watchOn",function(){return h(function(){return q=s.find(r),o()},0)}),(o=function(){var a,d,e,f;if(i.actionWhen!==!1&&q&&q.length>0)switch(q=angular.element(q[0]),a=g.offset(q),f=g.offset(s),d=s.scrollLeft()+(a.left-f.left)-m,e=s.scrollTop()+a.top-f.top-n,l){case c:return s.animate({scrollTop:e});case b:return s.animate({scrollLeft:d});default:return s.animate({scrollLeft:d,scrollTop:e})}})()}}},d.$inject=["$window","$parse","$position","$timeout"],angular.module("galleon").directive("scrollSynchronizer",d)}.call(this),function(){"use strict";var a;a=function(a){return{restrict:"A",link:function(a,b,c){var d;return d=function(){var d,e,f,g;if(d=angular.element(b),e=angular.element(d.children()[0]),g=d.height(),f=e.height(),b[0].scrollTop>f-g)return a.$apply(c.infiniteScroll)},angular.element(b).bind("scroll",d)}}},a.$inject=["$window"],angular.module("galleon").directive("infiniteScroll",a)}.call(this),function(){"use strict";var a;a=function(a){var b,c,d,e;return c=function(a,b,c){var d;return d=parseInt(c.css("max-height"),10),e(a)&&b.previewWidth!==b.previewHeight?d/b.previewWidth:d/b.previewHeight},e=function(a){return a.ctrls.PaletteCtrl.isDualPaletteMode},d=function(a,b,c){var d;return d=0,d=e(a)||b.previewWidth===b.previewHeight?parseInt(c.css("max-height"),10):parseInt(c.css("max-width"),10),("function"==typeof b.isSpread?b.isSpread():void 0)&&(d*=2),d},b=function(a,b,c){var d;return d=b.previewHeight*c,("function"==typeof b.isSpread?b.isSpread():void 0)&&!("function"==typeof b.isIdeaSpread?b.isIdeaSpread():void 0)&&(d=b.previewHeight*c*2),d},{link:function(f,g,h){var i,j,k,l,m;return j=f.$eval(h.paletteRenderer),k=1,m=1,i=1,l="scale(1)",a.fastdom.read(function(){return k=c(f,j,g),l="scale("+k+")",e(f)&&("function"==typeof j.isSpread?j.isSpread():void 0)&&!("function"==typeof j.isIdeaSpread?j.isIdeaSpread():void 0)&&(l="scale("+2*k+")"),m=d(f,j,g),i=b(f,j,k)}),a.fastdom.write(function(){var a;return g.css({width:m,height:i}),a=g.find(".palette-item"),a.css({"-webkit-transform":l,transform:l,"-moz-transform":l,"-o-transform":l,"-ms-transform":l})})}}},a.$inject=["$window"],angular.module("galleon").directive("paletteRenderer",a)}.call(this),function(){"use strict";var a;a=function(){return function(a,b,c){var d,e,f,g,h;if(null==c&&(c=!1),!b)return a;for(e=[],d=function(a){var b,c,d;for(c=0,d=e.length;c<d;c++)if(b=e[c],b.pHash===a)return!0;return!1},g=0,h=a.length;g<h;g++)f=a[g],(!d(f.pHash)||c&&f.useCount>0)&&e.push(f);return e}},a.$inject=[],angular.module("galleon").filter("hideDuplicates",a)}.call(this),function(){"use strict";var a;a=function(){return function(a,b){return b?a.filter(function(a){return 0===a.useCount}):a}},a.$inject=[],angular.module("galleon").filter("hideUsed",a)}.call(this),function(){"use strict";var a;a=function(){return function(a,b){return b?a.filter(function(a){return 1===a.ranking}):a}},a.$inject=[],angular.module("galleon").filter("highlights",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i){this.projectService=a,this.eventBus=c,this.imageCollection=d,this.$modal=e,this.commandService=f,this.uppService=g,this.config=h,this.deviceDetectionService=i,this._unplacedImages=b(this._unplacedImages,this),this._performUndoAutofillCommand=b(this._performUndoAutofillCommand,this),this.eventBus.subscribe(this.eventBus.events.AUTOFILL_UNPLACED_IMAGES,this._unplacedImages),this.eventBus.subscribe(this.eventBus.events.PROJECT_CREATED,this._performUndoAutofillCommand),this.IGNORE_BLANK_BOOK_AUTOFILL_GROUP_SIZE_CONSTRAINT_THRESHOLD=400}return a.prototype._performUndoAutofillCommand=function(a,b){return this.commandService.execute("UndoAutofillCommand",{source:{project:b.oldProjectJson}})},a.prototype._unplacedImages=function(a,b){if(!this.config.superSimple||!this.deviceDetectionService.isDeviceATablet())return this.$modal.open({templateUrl:"SilverApp/views/autofill-unplaced-photos-modal.html",backdrop:"static",controller:"SimpleModalCtrl",resolve:{data:function(){return b}}})},a.prototype.prepareAutofillBlankBookCommand=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o;return this.uppService.pauseUpload(),e=this.projectService.currentProject,g=angular.toJson(e.values),f=e.imageCollection.projectImages,n=e.title,j=e.projectID,i=e.projectGUID,c=e.product.guid,this._setProductImageIds(a,this.imageCollection.lastProductImageID),d=this.config.constraints,a.length<d.GroupCountConstraint.min&&(d.GroupCountConstraint.max=d.GroupCountConstraint.min),a.length>=this.IGNORE_BLANK_BOOK_AUTOFILL_GROUP_SIZE_CONSTRAINT_THRESHOLD&&(d.GroupSizeConstraint.max=9),this.config.superSimple&&null!=(null!=(o=(m=this.deviceDetectionService.getSuperSimpleDefaults()).constraints)?o.layoutCategory:void 0)&&(d.LayoutCategoryConstraint={category:m.constraints.layoutCategory}),this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),l=e.reportingData,b={styleId:e.product.styleId,styleVersion:e.product.styleContentVersion,coverSpecId:e.product.cover.coverSpecID,binding:e.product.cover.binding,finish:e.product.finish,glossyPages:e.product.hasGlossyPages(),images:a,constraints:d,stockCoverSpecId:e.product.cover.stockCoverSpecID},this.deviceDetectionService.isDeviceAPhone()&&(h=this.config.getCoverOptions(this.config.coverSpecId.toLowerCase().indexOf("soft")>=0)[0].phoneCoverLayouts,b.cover=h,b.coverSpecId=this.config.coverSpecId),k=this.projectService.createDocsmithProject(b).then(function(a){return function(b){return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE),{source:{project:g},bookProperties:{title:n,projectId:j,projectGuid:i,bookGuid:c},reportingData:l,imageCollection:{projectImages:f},target:{project:b}}}}(this))},a.prototype.prepareAutofillFilledBookCommand=function(a){var b,c,d,e;return b=this.projectService.currentProject.product,d=this._getNumberOfAutofillablePages(b),0===d?{cannotAutofill:!0}:(this.uppService.pauseUpload(),c=this._calculateDensity(b),this._setProductImageIds(a,this.imageCollection.lastProductImageID),this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),e=this.projectService.innerPages(a,b.styleId,b.styleContentVersion,b.cover.coverSpecID,b.cover.binding,c,1,d,b.cover.stockCoverSpecID).then(function(a){return function(b){return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE),{source:{project:angular.toJson(a.projectService.currentProject.values)},data:b}}}(this)))},a.prototype._calculateDensity=function(a){var b,c;return c=0,b=0,a.pages.forEach(function(a){var d;if(d=a.getImages(),d.length>0)return b++,c+=d.length}),0===b?1:c/b},a.prototype._getNumberOfAutofillablePages=function(a){var b,c,d,e,f;for(c=111-a.pages.length,d=0,b=e=f=a.pages.length-1;e>=1;b=e+=-1)(a.pages[b-1].isSpread()&&a.pages[b-1].isAutofillable()||!a.pages[b-1].isSpread()&&a.pages[b].isAutofillable())&&d++;return c+d},a.prototype._setProductImageIds=function(a,b){return a.forEach(function(a){if(null==a.projectImageId)return a.projectImageId=++b})},a}(),a.$inject="projectService eventBus imageCollection $modal commandService uppService CONFIG deviceDetectionService".split(" "),angular.module("galleon").service("autofillService",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p){this.contentGraphicAssetFactory=a,this.eventBus=c,this.contentService=d,this.navService=e,this.contentLayoutFactory=f,this.pageFactory=g,this.storytellingAssetRegistry=h,this.projectService=i,this.$http=j,this.$q=k,this.$rootScope=l,this.config=m,this.globalContentService=o,this.itemPricingService=p,this.scrapePaletteFromProject=b(this.scrapePaletteFromProject,this),this.initializeFromProject=b(this.initializeFromProject,this),this.CORE_PALETTE_ITEM="corePaletteItem",this.logger=n.newInstance("PaletteService"),this.existingAssetsMap={},this.currentExtendedPaletteItems={},this.assetListTypeToDisplayObjectType={},this.assetListTypeToDisplayObjectType.coreBackgrounds="backgrounds",this.assetListTypeToDisplayObjectType.coverBackgrounds="backgrounds-cover",this.assetListTypeToDisplayObjectType.coreEmbellishments="stickers",this.assetListTypeToDisplayObjectType.corePatternBars="patternbands",this.assetListTypeToDisplayObjectType.frames="frames",this.assetListTypeToDisplayObjectType.ideaPages="ideapages-interior",this.assetListTypeToDisplayObjectType.spreadCoreIdeaPages="spread-ideapages-interior",this.assetListTypeToDisplayObjectType.ideaFrontCovers="ideapages-cover",this.assetListTypeToDisplayObjectType.ideaBackCovers="ideapages-cover",this.assetListTypeToDisplayObjectType.ideaSpines="ideapages-cover",this.assetListTypeToDisplayObjectType.coreLayouts="layouts-interior",this.assetListTypeToDisplayObjectType.spreadCoreLayouts="spread-layouts-interior",this.eventBus.subscribe(this.eventBus.events.PROJECT_LOADED,this.initializeFromProject,this.$rootScope),this.eventBus.subscribe(this.eventBus.events.PROJECT_CONVERSION_COMPLETE,this.scrapePaletteFromProject,this.$rootScope),this._isProjectLoaded=!1,this.skuCache=[]}return a.prototype.initializeFromProject=function(){var a,b,c,d,e,f;if(this._isProjectLoaded=!0,this.currentExtendedPaletteItems={},null!=(null!=(d=this.projectService.currentProject.extendedPaletteContent)?d.assetListTypes:void 0)){for(e=this.projectService.currentProject.extendedPaletteContent.assetListTypes,f=[],b=0,c=e.length;b<c;b++)a=e[b],f.push(this._extractElementsFromAssetList(a));return f}},a.prototype.scrapePaletteFromProject=function(){var a,b,c,d,e;if(null!=this.projectService.currentProject.product.pages){for(d=this.projectService.currentProject.product.pages,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(this.scrapePage(a));return e}},a.prototype.scrapePage=function(a){var b,c,d,e,f;if(this.gatherExistingContent(),f=a.getStickers(),f=f.filter(function(a){return function(b){return!(null!=a.existingAssetsMap[b.values.assetReference.assetId])}}(this)),0!==f.length&&this.addPaletteItems("coreEmbellishments","sticker",f),e=[a.layoutName].filter(function(a){return function(b){return!(null!=a.existingAssetsMap[b])}}(this)),b=a.ideaLayout?a.isSpread()?"spreadCoreIdeaPages":"ideaPages":a.isSpread()?"spreadCoreLayouts":"coreLayouts",0!==e.length&&this._extractElementsFromObjectIds(b,"layout",e),c=a.getBackgrounds().filter(function(a){return function(b){return!(null!=a.existingAssetsMap[b.values.assetReference.assetId])}}(this)),0!==c.length&&this.addPaletteItems("coreBackgrounds","background",c),d=a.getFrames(),d=d.filter(function(a){return function(b){return!(null!=a.existingAssetsMap[b])}}(this)),0!==d.length)return this._extractElementsFromObjectIds("frames","frame",d)},a.prototype.getDispObjType=function(a){var b,c,d,e;for(e=Object.keys(this.currentExtendedPaletteItems),c=0,d=e.length;c<d;c++)if(b=e[c],this.currentExtendedPaletteItems[b][a])return b;return!1},a.prototype.addItems=function(a){var b,c,d,e,f,g,h,i,j;for(c=!1,i=Object.keys(a),e=0,g=i.length;e<g;e++)for(b=i[e],j=Object.keys(a[b]),f=0,h=j.length;f<h;f++)d=j[f],this.currentExtendedPaletteItems[b]||(this.currentExtendedPaletteItems[b]={}),this.currentExtendedPaletteItems[b][d]=a[b][d],c=!0;if(c)return this.eventBus.publish(this.eventBus.events.EXT_PALETTE_ITEMS_UPDATED),this.projectService.currentProject.setExtendedPaletteContent(this._addExtPalItemsToProject())},a.prototype.addPaletteItems=function(a,b,c){var d,e,f;return d=this.assetListTypeToDisplayObjectType[a],this.currentExtendedPaletteItems[d]||(this.currentExtendedPaletteItems[d]={}),f=function(){var a,b,d;for(d=[],a=0,b=c.length;a<b;a++)e=c[a],d.push(e.values.assetReference.assetId);return d}(),this._extractElementsFromObjectIds(a,b,f)},a.prototype.removeItemByDispObjType=function(a,b){var c;if(null!=(null!=(c=this.currentExtendedPaletteItems[a])?c[b]:void 0))return delete this.currentExtendedPaletteItems[a][b],this.eventBus.publish(this.eventBus.events.EXT_PALETTE_ITEMS_UPDATED),this.projectService.currentProject.setExtendedPaletteContent(this._addExtPalItemsToProject())},a.prototype.removeItem=function(a){var b;if(b=this.getDispObjType(a))return this.removeItemByDispObjType(b,a)},a.prototype.getBackgrounds=function(){var a,b;switch(a=null!=(b=this.navService.selectedPage)?b.surfaceNumber:void 0){case this.pageFactory.Page.FRONT_COVER_PAGE_NUMBER:case this.pageFactory.Page.BACK_COVER_PAGE_NUMBER:case this.pageFactory.Page.SPINE_PAGE_NUMBER:return this._generateAssetsForBackgrounds(this.currentExtendedPaletteItems["backgrounds-cover"]);default:return this._generateAssetsForBackgrounds(this.currentExtendedPaletteItems.backgrounds)}},a.prototype.getStickers=function(){var a,b,c,d,e;c=[],d=this.currentExtendedPaletteItems.stickers;for(b in d)a=d[b],null!=(e=a.assetRef)&&(e.embellishmentAttributes=a.embellishmentAttributes),c.push(this._createContentGraphicAssetFromPaletteItem(a));return this.itemPricingService.cacheSkus(this.skuCache),c},a.prototype.getRibbons=function(){var a,b,c,d,e;c=[],d=this.currentExtendedPaletteItems.patternbands;for(b in d)a=d[b],null!=(e=a.assetRef)&&(e.embellishmentAttributes=a.embellishmentAttributes),c.push(this._createContentGraphicAssetFromPaletteItem(a));return this.itemPricingService.cacheSkus(this.skuCache),c},a.prototype._createContentGraphicAssetFromPaletteItem=function(a){var b;return b=this.contentGraphicAssetFactory.newInstance(a.objectType,a.assetRef,!0),"premium"===a.contentType&&(this.storytellingAssetRegistry.addAsset(a.objectId,a.sku),a.sku&&this.skuCache.push(a.sku)),b},a.prototype.getFrames=function(){var a,b,c,d;c=[],d=this.currentExtendedPaletteItems.frames;for(b in d)a=d[b],c.push(this._getFrameFromExtPalItem(a));return c},a.prototype.getIdeaPages=function(){var a,b,c,d,e,f,g,h;switch(c=null!=(e=this.navService.selectedPage)?e.surfaceNumber:void 0,d=[],c){case this.pageFactory.Page.FRONT_COVER_PAGE_NUMBER:return this._getIdeaCoversByPageType("ideafrontcover","frontCoverIdeaPages");case this.pageFactory.Page.BACK_COVER_PAGE_NUMBER:return this._getIdeaCoversByPageType("ideabackcover","backCoverIdeaPages");case this.pageFactory.Page.SPINE_PAGE_NUMBER:return this._getIdeaCoversByPageType("ideaspine","spineIdeaPages");case this.pageFactory.Page.TITLE_PAGE_NUMBER:f=this.currentExtendedPaletteItems["ideapages-interior"];for(b in f)a=f[b],d.push(this._getContentLayoutFromExtPalItem(a,"titleIdeaPages"));return this.itemPricingService.cacheSkus(this.skuCache),d;default:g=this.currentExtendedPaletteItems["ideapages-interior"];for(b in g)a=g[b],d.push(this._getContentLayoutFromExtPalItem(a,"coreIdeaPages"));h=this.currentExtendedPaletteItems["spread-ideapages-interior"];for(b in h)a=h[b],d.push(this._getContentLayoutFromExtPalItem(a,"spreadCoreIdeaPages"));return this.itemPricingService.cacheSkus(this.skuCache),d}},a.prototype.getLayouts=function(){var a,b,c,d,e,f,g,h;switch(c=null!=(e=this.navService.selectedPage)?e.surfaceNumber:void 0,d=[],c){case this.pageFactory.Page.FRONT_COVER_PAGE_NUMBER:case this.pageFactory.Page.BACK_COVER_PAGE_NUMBER:return[];case this.pageFactory.Page.SPINE_PAGE_NUMBER:return[];case this.pageFactory.Page.TITLE_PAGE_NUMBER:f=this.currentExtendedPaletteItems["layouts-interior"];for(b in f)a=f[b],d.push(this._getContentLayoutFromExtPalItem(a,"titleLayouts"));return d;default:g=this.currentExtendedPaletteItems["layouts-interior"];for(b in g)a=g[b],d.push(this._getContentLayoutFromExtPalItem(a,"coreLayouts"));h=this.currentExtendedPaletteItems["spread-layouts-interior"];for(b in h)a=h[b],d.push(this._getContentLayoutFromExtPalItem(a,"spreadCoreLayouts"));return d}},a.prototype._generateAssetsForBackgrounds=function(a){var b,c,d,e;d=[];for(c in a)b=a[c],null!=(e=b.assetRef)&&(e.backgroundAttributes=b.backgroundAttributes),d.push(this._createContentGraphicAssetFromPaletteItem(b));return this.itemPricingService.cacheSkus(this.skuCache),d},a.prototype._getFrameFromExtPalItem=function(a){var b,c,d,e,f,g;for(b=this.globalContentService.getFrameForFrameId(a.objectId),b.isExtPalItem=!0,d={},g=a.assetRef.url,e=0,f=g.length;e<f;e++)c=g[e],d[c.repType]=c.value;return b.mobileUrl=d.mobile,b.thumbUrl=d.thumb,b.previewUrl=d.preview,b.swfUrl=d.swf,b},a.prototype._getIdeaCoversByPageType=function(a,b){var c,d,e,f;e=[],f=this.currentExtendedPaletteItems["ideapages-cover"];for(d in f)c=f[d],this._layoutMatchesPageType(c,a)&&e.push(this._getContentLayoutFromExtPalItem(c,b));return this.itemPricingService.cacheSkus(this.skuCache),e},a.prototype._getContentLayoutFromExtPalItem=function(a,b){var c,d;return null!=(d=a.assetRef)&&(d.layoutAttributes=a.layoutAttributes),c=this._createContentLayoutFromPaletteItem(a),c.imageCount=a.layoutAttributes.numPics,c.hasTextAsset=a.layoutAttributes.numTextAreas>0,c.assetListType=b,c.isExtPalItem=!0,"spineIdeaPages"===b&&this._fixContentLayoutForSpinePage(c),"premium"===a.contentType&&this.storytellingAssetRegistry.addAsset(a.objectId,a.sku),c},a.prototype._createContentLayoutFromPaletteItem=function(a){var b;return b=this.contentLayoutFactory.newInstance(a.assetRef),"premium"===a.contentType&&(this.storytellingAssetRegistry.addAsset(a.objectId,a.sku),a.sku&&this.skuCache.push(a.sku)),b},a.prototype._fixContentLayoutForSpinePage=function(a){if(null!=a.thumbUrl)return this.projectService.currentProject.product.hasWideSpine()?a.thumbUrl=a.thumbUrl.replace("hard","wide"):a.thumbUrl=a.thumbUrl.replace("wide","hard")},a.prototype._layoutMatchesPageType=function(a,b){var c;return c=a.layoutAttributes.pageType||a.layoutAttributes.PageType,c===b},a.prototype._getAssetRefServiceUrl=function(a,b){var c,d;return c=a,"sticker"!==a&&"patternband"!==a||(c="embellishment"),d=this.config.extendedPaletteAssetRefService+"&objectType="+c+"&objectIds="+b},a.prototype.gatherExistingContent=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;for(this.existingAssetsMap={},k=this.contentService.currentStyle.assetLists.assetList,g=0,i=k.length;g<i;g++)if(a=k[g],null!=a.assetRef)for(l=a.assetRef,h=0,j=l.length;h<j;h++)b=l[h],this.existingAssetsMap[b.assetId]=[this.CORE_PALETTE_ITEM];m=this.currentExtendedPaletteItems;for(e in m){f=m[e];for(d in f)c=f[d],this.existingAssetsMap[d]||(this.existingAssetsMap[d]=[]),this.existingAssetsMap[d].push(e)}},a.prototype._extractElementsFromAssetList=function(a){var b,c;return c=function(){var c,d,e,f;for(e=a.elements,f=[],c=0,d=e.length;c<d;c++)b=e[c],f.push(b.id);return f}(),this._extractElementsFromObjectIds(a.assetListType,a.assetType,c)},a.prototype._extractElementsFromObjectIds=function(a,b,c){var d;return c=this._unique(c),d=this._getAssetRefServiceUrl(b,c.join()),this._requestAssetRefContent(d,a)},a.prototype._unique=function(a){var b,c,d,e,f,g;for(c={},b=e=0,f=a.length;0<=f?e<f:e>f;b=0<=f?++e:--e)c[a[b]]=a[b];g=[];for(b in c)d=c[b],g.push(d);return g},a.prototype._requestAssetRefContent=function(a,b){var c,d,e;return(d=this.assetListTypeToDisplayObjectType[b])?(e=this.logger.asyncMetric("extendedPaletteAssetRefServiceContent",a),c=this.$q.defer(),this.$http({method:"POST",url:a,headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"}}).success(function(a){return function(d,f,g,h){var i,j;return e.success(),a._addToMap(null!=d&&null!=(i=d.ObjectAttributesList)&&null!=(j=i.objects)?j.object:void 0,b),c.resolve()}}(this)).error(function(a){return function(b,d,f,g){return e.failure({status:d,response:b}),c.reject(b),a.logger.critical("Could not get assetRef for extended palette items: "+b)}}(this)),c):void this.logger.warn("Unknown assetListType "+b)},a.prototype._addToMap=function(a,b){var c,d,e,f,g;if(c=!1,e=this.assetListTypeToDisplayObjectType[b],e&&a){for(this.currentExtendedPaletteItems[e]||(this.currentExtendedPaletteItems[e]={}),f=0,g=a.length;f<g;f++)d=a[f],this.currentExtendedPaletteItems[e][d.objectId]||(this.currentExtendedPaletteItems[e][d.objectId]=d,c=!0);return c?(this.eventBus.publish(this.eventBus.events.EXT_PALETTE_ITEMS_UPDATED),this.projectService.currentProject.setExtendedPaletteContent(this._addExtPalItemsToProject())):void 0}},a.prototype._addExtPalItemsToProject=function(){var a,b,c,d,e;for(a=[],e=Object.keys(this.currentExtendedPaletteItems),c=0,d=e.length;c<d;c++)switch(b=e[c]){case"backgrounds":this._addAssetList(a,b,"background","coreBackgrounds");break;case"backgrounds-cover":this._addAssetList(a,b,"background","coverBackgrounds");break;case"stickers":this._addAssetList(a,b,"sticker","coreEmbellishments");break;case"patternbands":this._addAssetList(a,b,"patternband","corePatternBars");break;case"frames":this._addAssetList(a,b,"frame","frames");break;case"layouts-interior":this._addAssetList(a,b,"layout","coreLayouts");break;case"spread-layouts-interior":this._addAssetList(a,b,"layout","spreadCoreLayouts");break;case"ideapages-interior":this._addAssetList(a,b,"layout","ideaPages");break;case"spread-ideapages-interior":this._addAssetList(a,b,"layout","spreadCoreIdeaPages");break;case"ideapages-cover":this._addIdeaCoverAssetList(a,"ideaFrontCovers","ideafrontcover"),this._addIdeaCoverAssetList(a,"ideaBackCovers","ideabackcover"),this._addIdeaCoverAssetList(a,"ideaSpines","ideaspine");break;default:this.logger.critical("_addExtPalItemsToProject: bogus dispObjType "+b)}return{assetListTypes:a}},a.prototype._addAssetList=function(a,b,c,d){var e,f,g,h;e=[],h=this.currentExtendedPaletteItems[b];for(g in h)f=h[g],e.push(this._createElement(f));if(e.length>0)return a.push({assetType:c,assetListType:d,elements:e})},a.prototype._addIdeaCoverAssetList=function(a,b,c){var d,e,f,g;d=[],g=this.currentExtendedPaletteItems["ideapages-cover"];for(f in g)e=g[f],this._layoutMatchesPageType(e,c)&&d.push(this._createElement(e));if(d.length>0)return a.push({assetType:"layout",assetListType:b,elements:d})},a.prototype._createElement=function(a){var b;return b={id:a.objectId,version:""+a.currentVersion,isFlipped:"false",selectionType:"solid",defaultWidth:null,defaultHeight:null,sortDate:(new Date).toGMTString()}},a}(),a.$inject=["contentGraphicAssetFactory","eventBus","contentService","navService","contentLayoutFactory","pageFactory","storytellingAssetRegistry","projectService","$http","$q","$rootScope","CONFIG","loggerFactory","globalContentService","itemPricingService"],angular.module("galleon").service("paletteService",a)}.call(this),function(){"use strict";var a,b=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};a=function(){function a(a,b,c,d,e,f,g,h,i){this.$http=a,this.config=b,this.$q=d,this.projectService=e,this.UrlUtil=f,this.itemPricingService=g,this.contentService=h,this.paletteService=i,this.logger=c.newInstance("ExtendedPaletteService"),this.paletteTypeData={},this.paletteContent=[],this.contentCount=0,this.corePaletteSelectedTabName=null,this.initialSearch=null,this.currentRadioContext=null,this.contentPageIndex=0,this.searchContentPageIndex=0,this.favoritesContentPageIndex=0,this.CORE_PALETTE_ITEM="corePaletteItem"}return a.CONTENT_PAGE_SIZE=100,a.prototype.resolveAttributesForType=function(a){var b;return this.paletteTypeData[a]?(b=this.$q.defer(),b.resolve(),b):(this.paletteTypeData[a]=[],this._requestAttributeDataForType(a))},a.prototype.requestInitialContent=function(a){return this.contentPageIndex=0,this._requestContent(a)},a.prototype.requestNextContentPage=function(a){return this.contentPageIndex+=1,this._requestContent(a)},a.prototype._requestContent=function(a){var b,c,d;return d=this._generateContentUrl(a),c=this.logger.asyncMetric("extendedPaletteContent",d),b=this.$q.defer(),function(e){return function(f){return e.$http({method:"GET",url:d}).success(function(d,g,h,i){var j,k,l,m;return c.success(),null!=(null!=d&&null!=(j=d.objects)?j.object:void 0)&&e.setPaletteContent(null!=d&&null!=(k=d.objects)?k.object:void 0,0!==f,a),e.contentCount=null!=d&&null!=(l=d.summary)?l.totalCount:void 0,0===e.contentPageIndex&&e._updateAttributeStates(a,null!=d&&null!=(m=d.summary)?m.attribute:void 0),b.resolve()}).error(function(a,d,f,g){
return c.failure({status:d,response:a}),b.reject(a),e.logger.critical("Could not get extended palette content: "+a)})}}(this)(this.contentPageIndex),b},a.prototype._buildContentRequestData=function(a){var b,c,d,e,f,g,h,i,j;if(!this.paletteTypeData[a])return null;for(d={},i=this.paletteTypeData[a],e=0,g=i.length;e<g;e++)for(c=i[e],j=c.value,f=0,h=j.length;f<h;f++)b=j[f],b.selected&&(d[c.param]||(d[c.param]=""),0===d[c.param].length?d[c.param]+=encodeURIComponent(b.value):d[c.param]+=","+encodeURIComponent(b.value));return this.UrlUtil.convertObjectToUrlParams(d)},a.prototype._updateAttributeStates=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(this.paletteTypeData[a]){for(g={},h=0,l=b.length;h<l;h++)if(f=b[h],null!=(null!=f?f.value:void 0))for(p=f.value,i=0,m=p.length;i<m;i++)e=p[i],g[f.param]||(g[f.param]={}),g[f.param][e.value]=!0;if(!angular.equals(g,{})){for(q=this.paletteTypeData[a],j=0,n=q.length;j<n;j++)for(d=q[j],r=d.value,k=0,o=r.length;k<o;k++)c=r[k],c.disabled=!(null!=(s=g[d.param])?s[c.value]:void 0);return null}}},a.prototype._getAspectRatioString=function(){var a,b,c,d,e;return a=null!=(b=this.projectService)&&null!=(c=b.currentProject)&&null!=(d=c.product)&&null!=(e=d.sizeId)?e.split("x"):void 0,a[0]===a[1]?"sq":"rec"},a.prototype._generateContentUrl=function(b){var c,d,e,f;return e=this.config.extendedPaletteContentService,"backgrounds"===b||"backgrounds-cover"===b?e+=""+b+"&sizeInfo="+this._getAspectRatioString():"layouts-interior"===b||"ideapages-interior"===b?e+=""+b+"&sizeInfo="+this.projectService.currentProject.product.sizeId:"spread-layouts-interior"===b?e+="layouts-interior&pagetype=spread&sizeInfo="+this.projectService.currentProject.product.sizeId:"spread-ideapages-interior"===b?e+="ideapages-interior&pagetype=ideaspread&sizeInfo="+this.projectService.currentProject.product.sizeId:"ideapages-cover"===b?(f=this.projectService.currentProject.product.getLayoutFormFactorForPage(null,!0),e+=""+b+"&sizeInfo="+f+"&orderby=Style"):e+=b,d=this._buildContentRequestData(b),d&&(e+="&"+d),c=this.contentPageIndex*a.CONTENT_PAGE_SIZE,this.contentPageIndex>0&&(c+=1),e+="&offset="+c+"&length="+a.CONTENT_PAGE_SIZE,"frames"===b&&(e+="&orderby=Default"),e},a.prototype._requestAttributeDataForType=function(a){var b,c,d;return d=this.config.extendedPaletteAttributeService,d+="spread-layouts-interior"===a?"layouts-interior":"spread-ideapages-interior"===a?"ideapages-interior":a,c=this.logger.asyncMetric("extendedPaletteAttributes",d),b=this.$q.defer(),this.$http({method:"GET",url:d}).success(function(d){return function(e,f,g,h){var i;return c.success(),d.paletteTypeData[a]=null!=e&&null!=(i=e.displayObject)?i[0].attribute:void 0,b.resolve()}}(this)).error(function(a){return function(d,e,f,g){return c.failure({status:e,response:d}),b.reject(d),a.logger.critical("Could not get extended palette attributes: "+d)}}(this)),b},a.prototype.requestInitialSearchContent=function(a,b){return this.searchContentPageIndex=0,this._requestSearchContent(a,b)},a.prototype.requestNextSearchContentPage=function(a,b){return this.searchContentPageIndex+=1,this._requestSearchContent(a,b)},a.prototype._requestSearchContent=function(b,c){var d,e,f,g;return g=this.config.extendedPaletteSearchService+encodeURIComponent(c),g+="backgrounds"===b||"backgrounds-cover"===b?"&type="+b+"&sizeInfo="+this._getAspectRatioString():"spread-layouts-interior"===b?"&type=layouts-interior":"spread-ideapages-interior"===b?"&type=ideapages-interior":"&type="+b,e=this.searchContentPageIndex*a.CONTENT_PAGE_SIZE,this.searchContentPageIndex>0&&(e+=1),g+="&offset="+e+"&length="+a.CONTENT_PAGE_SIZE,d=this.logger.asyncMetric("extendedPaletteSearch",g),f=this.$q.defer(),function(a){return function(c){return a.$http({method:"GET",url:g}).success(function(e,g,h,i){var j,k,l;return d.success(),null!=(null!=e&&null!=(j=e.objects)?j.object:void 0)&&a.setPaletteContent(null!=e&&null!=(k=e.objects)?k.object:void 0,0!==c,b),a.contentCount=null!=e&&null!=(l=e.summary)?l.totalCount:void 0,f.resolve()}).error(function(b,c,e,g){return d.failure({status:c,response:b}),f.reject(b),a.logger.critical("Could not get extended palette search content: "+b)})}}(this)(this.searchContentPageIndex),f},a.prototype.setPaletteContent=function(a,b,c){var d,e,f;for(null==b&&(b=!1),a=a.filter(function(a){var b,c,d,e;return"hidden"!==a.state&&(b=null,"embellishment"===a.objectType?b=null!=(c=a.embellishmentAttributes)?c.PaletteVisibility:void 0:"background"===a.objectType?b=null!=(d=a.backgroundAttributes)?d.PaletteVisibility:void 0:"layout"===a.objectType&&(b=null!=(e=a.layoutAttributes)?e.PaletteVisibility:void 0),!("none"===b||"core"===b))}),e=0,f=a.length;e<f;e++)d=a[e],this.isExistingItem(c,d.objectId)&&(d.isCorePaletteItem=!0);return b?(this.paletteContent=this.paletteContent.concat(a),this.cacheSkuPrices(a)):(this.paletteContent=a,this.cacheSkuPrices(this.paletteContent))},a.prototype.cacheSkuPrices=function(a){var b,c;return c=function(){var c,d,e;for(e=[],c=0,d=a.length;c<d;c++)b=a[c],null!=b.sku&&""!==b.sku&&e.push(b.sku);return e}(),this.itemPricingService.cacheSkus(c)},a.prototype.isExistingItem=function(a,c){var d,e;return!(!this.paletteService.existingAssetsMap||!this.paletteService.existingAssetsMap[c])&&(d=this.paletteService.existingAssetsMap[c],e=this.CORE_PALETTE_ITEM,b.call(d,e)>=0||b.call(d,a)>=0)},a.prototype.requestInitialFavoritesContent=function(a,b){return this.favoritesContentPageIndex=0,this._requestFavoritesContent(a,b)},a.prototype.requestNextFavoritesContentPage=function(a,b){return this.favoritesContentPageIndex+=1,this._requestFavoritesContent(a,b)},a.prototype._requestFavoritesContent=function(a,b){var c,d,e;return c=this.$q.defer(),e=this.config.extendedPaletteFavoriteContentService,d=this.logger.asyncMetric("extendedPaletteFilterFavorites",e),function(f){return function(g){return f.$http({method:"POST",url:e,data:f._getFilterFavoritesData(a,b),headers:{"Content-Type":"text/plain"}}).success(function(a,e,h,i){var j,k,l,m;return d.success(),null!=(null!=a&&null!=(j=a.objects)?j.object:void 0)&&f.setPaletteContent(null!=a&&null!=(k=a.objects)?k.object:void 0,0!==g,b),f.contentCount=null!=a&&null!=(l=a.objects)&&null!=(m=l.object)?m.length:void 0,c.resolve()}).error(function(a,b,e,g){return d.failure({status:b,response:a}),c.reject(a),f.logger.critical("Could not fetch extended palette favorite filter content: "+a)})}}(this)(this.favoritesContentPageIndex),c},a.prototype._getFilterFavoritesData=function(b,c){var d,e,f,g,h;f=this.favoritesContentPageIndex*a.CONTENT_PAGE_SIZE,this.favoritesContentPageIndex>0&&(f+=1),"spread-layouts-interior"===c?(h="layouts-interior",g="spread"):"spread-ideapages-interior"===c?(h="ideapages-interior",g="ideaspread"):h=c,d={favoriteExtendedPaletteAttributes:{type:h,pagetype:g,offset:f,length:a.CONTENT_PAGE_SIZE,favoriteIds:{value:[]}}};for(e in b)h=b[e],h===this._getObjectTypeFromDisplayObjectType(c)&&d.favoriteExtendedPaletteAttributes.favoriteIds.value.push(e);return d},a.prototype._getObjectTypeFromDisplayObjectType=function(a){switch(a){case"backgrounds":case"backgrounds-cover":return"background";case"layouts-interior":case"spread-layouts-interior":case"spread-ideapages-interior":case"ideapages-cover":case"ideapages-interior":return"layout";case"stickers":return"sticker";case"patternbands":return"patternband";case"frames":return"frame"}return null},a}(),a.$inject=["$http","CONFIG","loggerFactory","$q","projectService","urlUtil","itemPricingService","contentService","paletteService"],angular.module("galleon").service("extendedPaletteService",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f){this.$http=a,this.config=b,this.$q=d,this.userService=e,this.projectService=f,this.logger=c.newInstance("FavoritesService"),this.favoritesContent={},this.rawFavoritesResponse={},this.showFavorites=!1}return a.prototype.fetchFavorites=function(){var a;return a=this.$q.defer(),this.userService.userInfo().then(function(b){return function(c){var d,e;return c.isLoggedIn?(e=b.config.extendedPaletteFavoriteService+"getFavorites?auth="+c.openflyToken,d=b.logger.asyncMetric("extendedPaletteFetchFavorites",e),b.$http({method:"GET",url:e}).success(function(c,e,f,g){return d.success(),b._setFavoritesContent(c),a.resolve()}).error(function(c,e,f,g){return d.failure({status:e,response:c}),a.reject(c),b.logger.error("Could not fetch extended palette favorite content: "+c)})):(b.showFavorites=!1,a.resolve(),a.promise)}}(this)),a.promise},a.prototype.updateFavorites=function(a){var b,c;return c=this.$q.defer(),b=this._stripSizeAndAspectRatio(a),0===b.adds.length&&0===b.removes.length?(c.resolve(),c.promise):(this.userService.userInfo().then(function(a){return function(d){var e,f;return d.isLoggedIn?(f=a.config.extendedPaletteFavoriteService+"updateFavorites?auth="+d.openflyToken,e=a.logger.asyncMetric("extendedPaletteUpdateFavorites",f),a.$http({method:"POST",url:f,data:b}).success(function(a,b,d,f){return e.success(),c.resolve()}).error(function(b,d,f,g){return e.failure({status:d,response:b}),c.reject(b),a.logger.error("Could not save extended palette favorite content: "+b)})):(c.resolve(),c.promise)}}(this)),c.promise)},a.prototype._setFavoritesContent=function(a){var b,c,d,e;for(this.favoritesContent={},this.rawFavoritesResponse={},d=0,e=a.length;d<e;d++)b=a[d],c=this._populateSizeAndAspectRatio(b.objectId),this.favoritesContent[c]=b.type,this.rawFavoritesResponse[b.objectId]=b.type;return this.showFavorites=!0},a.prototype._populateSizeAndAspectRatio=function(a){var b,c,d,e,f;return c=null!=(d=this.projectService)&&null!=(e=d.currentProject)&&null!=(f=e.product)?f.sizeId:void 0,b=this._getAspectRatio(),a.replace("size",c).replace("aspectRatio",b)},a.prototype._getAspectRatio=function(){var a,b,c;return"square"===(null!=(a=this.projectService)&&null!=(b=a.currentProject)&&null!=(c=b.product)?c.aspectRatio:void 0)?"sq":"rec"},a.prototype._stripSizeAndAspectRatio=function(a){var b,c,d,e,f,g,h,i,j,k,l;g=null!=(i=this.projectService)&&null!=(j=i.currentProject)&&null!=(k=j.product)?k.sizeId:void 0,c=this._getAspectRatio(),b=[],f=[];for(d in a)h=a[d],e=d.replace(g,"size").replace(c,"aspectRatio"),null!=this.rawFavoritesResponse[e]?delete this.rawFavoritesResponse[e]:b.push({objectId:e,type:h});l=this.rawFavoritesResponse;for(d in l)h=l[d],f.push({objectId:d,type:h});return{adds:b,removes:f}},a}(),a.$inject=["$http","CONFIG","loggerFactory","$q","userService","projectService"],angular.module("galleon").service("favoritesService",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.storytellingAssetRegistry=a,this.itemPricingService=b,this.pricingService=c,this.showUtils=!1}return a.prototype.isPremium=function(a){return this.storytellingAssetRegistry.hasAsset(a)},a.prototype.itemHasPrice=function(a){return null!=a&&""!==a&&!(""===this.getItemPrice(a))},a.prototype.getItemPrice=function(a){var b,c,d,e;return c=this.storytellingAssetRegistry.getAsset(a),null==c?"":(b=null!=(d=null!=(e=this.itemPricingService.getSkuPrice(c))?e.saleTotalPrice:void 0)?d:"",""===b?"":"$"+b)},a}(),a.$inject=["storytellingAssetRegistry","itemPricingService","pricingService"],angular.module("galleon").service("utilsService",a)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b){this.priorityLoaderService=a,this.$window=b,this._loadThumbnailIfDesired=c(this._loadThumbnailIfDesired,this),this._backgroundErrorCallback=c(this._backgroundErrorCallback,this),this._srcErrorCallback=c(this._srcErrorCallback,this),this._backgroundCallback=c(this._backgroundCallback,this),this._srcCallback=c(this._srcCallback,this),this._requestedCallback=c(this._requestedCallback,this),this._queuedCallback=c(this._queuedCallback,this)}return a.prototype.BLANK_GIF="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",a.prototype.LIFECYCLE_CSS_CLASSES="priority-queued priority-requested has-load-error".split(" "),a.prototype.link=function(a,b,c,d){var e,f,g,h,i,j,k,l;return this.config=d,this.element=b[0],j=a.$eval(c.sfPriority)||"low",i="background"===c.sfPriorityOnload?this._backgroundCallback:this._srcCallback,h="background"===c.sfPriorityOnload?this._backgroundErrorCallback:this._srcErrorCallback,f=a.$eval(c.sfPrioritySrc),f=this._protocolRelativeUrl(f),l="true"===c.sfPriorityWatch,k="true"===a.$eval(c.useThumbnail),e={},g={success:i,error:h},"true"===a.$eval(c.sfPriorityLifecycleCallbacks)&&(g.queued=this._queuedCallback,g.requested=this._requestedCallback),this._loadThumbnailIfDesired(k,f,i),this.priorityLoaderService.enqueue(f,j,g,e),l&&a.$watch(c.sfPrioritySrc,function(b){return function(d){if(null!=d&&f!==d)return e.stale=!0,e={},j=a.$eval(c.sfPriority)||"low",f=b._protocolRelativeUrl(d),b._loadThumbnailIfDesired(k,f,i),b.priorityLoaderService.enqueue(f,j,g,e)}}(this)),a.$on("$destroy",function(){return e.stale=!0})},a.prototype._queuedCallback=function(){this.$window.fastdom.write(function(a){return function(){var b,c,d,e;for(e=a.LIFECYCLE_CSS_CLASSES,c=0,d=e.length;c<d;c++)b=e[c],a.element.classList.remove(b);return a.element.classList.add("priority-queued")}}(this))},a.prototype._requestedCallback=function(){this.$window.fastdom.write(function(a){return function(){var b,c,d,e;for(e=a.LIFECYCLE_CSS_CLASSES,c=0,d=e.length;c<d;c++)b=e[c],a.element.classList.remove(b);return a.element.classList.add("priority-requested")}}(this))},a.prototype._srcCallback=function(a){this.$window.fastdom.write(function(b){return function(){var c,d,e,f,g;for(b.element.setAttribute("src",a),f=b.LIFECYCLE_CSS_CLASSES,g=[],d=0,e=f.length;d<e;d++)c=f[d],g.push(b.element.classList.remove(c));return g}}(this))},a.prototype._backgroundCallback=function(a){this.$window.fastdom.write(function(b){return function(){var c,d,e,f,g;for(b.element.style["background-image"]="url('"+a+"')",f=b.LIFECYCLE_CSS_CLASSES,g=[],d=0,e=f.length;d<e;d++)c=f[d],g.push(b.element.classList.remove(c));return g}}(this))},a.prototype._srcErrorCallback=function(){this.$window.fastdom.write(function(a){return function(){var b,c,d,e;for(a.element.setAttribute("src",a.BLANK_GIF),e=a.LIFECYCLE_CSS_CLASSES,c=0,d=e.length;c<d;c++)b=e[c],a.element.classList.remove(b);return a.element.classList.add("has-load-error")}}(this))},a.prototype._backgroundErrorCallback=function(){this.$window.fastdom.write(function(a){return function(){var b,c,d,e;for(delete a.element.style["background-image"],e=a.LIFECYCLE_CSS_CLASSES,c=0,d=e.length;c<d;c++)b=e[c],a.element.classList.remove(b);return a.element.classList.add("has-load-error")}}(this))},a.prototype._loadThumbnailIfDesired=function(a,b,c){var d;if(a&&(d=this._deriveThumbnailUrl(b),null!=d&&d!==b))return c(d)},a.prototype._protocolRelativeUrl=function(a){return/blob:/.test(a)||null==a?a:this.config.protocolRelativeUrl(a)},a.prototype._deriveThumbnailUrl=function(a){return a.replace(/rendersize=[^&]+/,function(){return"rendersize=fit96x96"})},a}(),b=function(b,c,d){return{restrict:"A",link:function(e,f,g){var h;return h=new a(c,d),h.link(e,f,g,b)}}},b.$inject=["CONFIG","priorityLoaderService","$window"],angular.module("galleon").directive("sfPrioritySrc",b)}.call(this),function(){"use strict";var a;a=function(a,b,c,d){return this.hostNames={},this.priorities={HIGH:50,MEDIUM:100,LOW:200},this.logger=d.newInstance("PriorityLoader"),this.cache={},this.maximumWorkers=5,this.numWorkers=0,this.counter=0,this.queue=new a.PriorityQueue({low:!0}),this.logSuccesses=function(a){return function(){var b,c,d,e;d=a.hostNames,e=[];for(b in d)c=d[b],c>0?(a.logger.metric("priorityLoaderSuccesses",{hostName:b,numSuccesses:c}),e.push(a.hostNames[b]=0)):e.push(void 0);return e}}(this),this.enqueue=function(c,d,e,f){var g,h,i,j,k;null==e&&(e={}),null==f&&(f={}),c&&(k={data:c,callbacks:e,blackbox:f},d=this.priorities[d.toUpperCase()]||this.priorities.LOW,g=this.cache[c],null!=g&&(g.priority<=d||"queued"!==g.state)?"success"===g.state?a.setTimeout(function(){return e.success(g.fixedUrl)}):"error"===g.state?a.setTimeout(function(){return e.error(g.fixedUrl)}):"requested"===g.state?("function"==typeof e.requested&&e.requested(g.fixedUrl),g.list.push(k)):("function"==typeof e.queued&&e.queued(g.fixedUrl),g.list.push(k)):null!=g?("function"==typeof e.queued&&e.queued(g.fixedUrl),g.list.push(k),j={data:g.fixedUrl,blackbox:{stale:!1},callbacks:g.callbacks,priority:d},this.counter+=1e-6,this.queue.push(j,d+this.counter)):(i=c,0===c.indexOf("http")&&(i=b.protocolRelativeUrl(c)),this.cache[c]=h={state:"queued",fixedUrl:i,list:[k],priority:d},"function"==typeof e.queued&&e.queued(i),j={data:i,blackbox:{stale:!1}},h.callbacks=j.callbacks={requested:function(){var a,b,c,d,e,f;for(h.state="requested",e=h.list,f=[],c=0,d=e.length;c<d;c++)a=e[c],a.blackbox.stale?f.push(void 0):f.push("function"==typeof(b=a.callbacks).requested?b.requested(h.fixedUrl):void 0);return f},success:function(){var a,b,c,d,e;for(h.state="success",e=h.list,c=0,d=e.length;c<d;c++)a=e[c],a.blackbox.stale||"function"==typeof(b=a.callbacks).success&&b.success(h.fixedUrl);return h.list=[]},error:function(){var a,b,c,d,e,f;for(h.state="error",e=h.list,f=[],c=0,d=e.length;c<d;c++)a=e[c],a.blackbox.stale||"function"==typeof(b=a.callbacks).error&&b.error(h.fixedUrl),f.push(h.list=[]);return f},retry:function(a){return function(){return j.callbacks.isRetry=!0,h.state="queued",a.queue.push(j,d+a.counter)}}(this)},this.counter+=1e-6,this.queue.push(j,d+this.counter)),a.setTimeout(this.check),a.setInterval(this.logSuccesses,3e4))},this.dequeue=function(){var a,b,c;try{for(c=!0;c;)b=this.queue.pop(),c=b.blackbox.stale;return{data:b.data,callbacks:b.callbacks}}catch(b){return void(a=b)}},this.done=function(){return this.numWorkers--,this.check()},this.check=function(b){return function(){var d,e;for(e=[];b.numWorkers<b.maximumWorkers&&(d=b.dequeue());)b.numWorkers++,e.push(new c(a,d,b,b.hostNames).work());return e}}(this),this},a.$inject=["$window","CONFIG","PriorityLoaderWorker","loggerFactory"],angular.module("galleon").service("priorityLoaderService",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e){this.$window=a,this.payload=c,this.service=d,this.hostNames=e,this.onTimeout=b(this.onTimeout,this),this.onError=b(this.onError,this),this.onLoad=b(this.onLoad,this),this.onDone=b(this.onDone,this),this.TIMEOUT=1e4}return a.prototype.reset=function(){if(this.image)return this.image.onload=null,this.image.onerror=null,this.image.onabort=null,this.timeoutId=null,this.image=null,this.url=null},a.prototype.onDone=function(a){var b;return b=this.url,null!=this.timeoutId&&this.$window.clearTimeout(this.timeoutId),this.$window.setTimeout(function(){return"function"==typeof a?a(b):void 0}),this.reset(),this.$window.setTimeout(function(a){return function(){return a.service.done()}}(this))},a.prototype.onLoad=function(){return this._incrementHostName(this._getHostName()),this.onDone(this.successCallback)},a.prototype._getHostName=function(){var a,b;return b=/https?:\/\/([^\/]+)/g,a=b.exec(this.url),null!=a?a[1]:void 0},a.prototype._incrementHostName=function(a){if(null!=a)return null!=this.hostNames[a]?this.hostNames[a]=this.hostNames[a]+1:this.hostNames[a]=1},a.prototype.onError=function(){var a,b;return a=this._getHostName(),null!=a&&null!=(b=this.service.logger)&&b.warn("failed priority load",{url:this.url,hostName:a}),this.onDone(this.errorCallback)},a.prototype.onTimeout=function(){var a,b;return a=this._getHostName(),null!=a&&null!=(b=this.service.logger)&&b.warn("retrying priority load",{url:this.url,hostName:a}),this.onDone(this.retryCallback)},a.prototype.work=function(){var a,b,c,d,e,f;return a=this.payload.callbacks,this.successCallback=a.success,this.errorCallback=a.error,this.retryCallback=a.retry,a.isRetry?(c=this.onError,b=3*this.TIMEOUT):(c=this.onTimeout,b=this.TIMEOUT),"function"==typeof a.requested&&a.requested(),this.url=null!=(d=this.payload)?d.data:void 0,0!==(null!=(e=this.payload)&&null!=(f=e.data)?f.search(/http/):void 0)?this.onLoad():(this.image=new this.$window.Image,this.image.onload=this.onLoad,this.image.onerror=this.onError,this.image.onabort=this.onError,this.timeoutId=this.$window.setTimeout(c,b),this.image.src=this.url,this.image.complete?this.onLoad():void 0)},a}(),angular.module("galleon").constant("PriorityLoaderWorker",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f,g){this.$scope=a,this.uppService=b,this.eventBus=c,this.hotkeys=d,this.$modal=e,this.deviceDetectionService=f,this.appState=g,this.minImage=0,this.maxImage=0,this.eventBus.subscribe(this.eventBus.events.HANDLE_UPP_CANCEL,function(a){return function(){return a.deviceDetectionService.isDeviceAPhone()&&(a.minImage=a.deviceDetectionService.getSuperSimpleDefaults().photoSelection.min,a.maxImage=a.deviceDetectionService.getSuperSimpleDefaults().photoSelection.max),a.deviceDetectionService.isDeviceATablet()&&(a.minImage=a.deviceDetectionService.getSuperSimpleDefaults().photoSelection.min,a.maxImage=a.deviceDetectionService.getSuperSimpleDefaults().photoSelection.max),a._showWarning()}}(this)),this.hotkeys.add({combo:"mod+u",description:"Add photos",callback:function(a){return function(b,c){a.showUPP(),b.preventDefault()}}(this)}),this.uppOptions={backgroundImport:!0,onSignin:function(){return c.publish(this.eventBus.events.UPP_USER_SIGNIN,{})},onOk:function(a,b,c){return console.log("upp done",b,c)}},this.$scope.ctrls.UppCtrl=this}return a.prototype.showUPP=function(a,b){return null==a&&(a=0),null==b&&(b=!1),this.appState.cancelBackgroundWaitingForPicture(),this.uppOptions.currentCount=a,this.uppService.show("UniversalPicker",this.uppOptions,b)},a.prototype.allowUpload=function(){if(this.uppService.allowUpload())return!0},a.prototype._showWarning=function(){return this.modalInstance=this.$modal.open({templateUrl:"UPP/views/first-time-login-cancel-modal.html",backdrop:"static",scope:this.$scope})},a.prototype.ok=function(){return this.modalInstance.close(),this.showUPP()},a}(),a.$inject=["$scope","uppService","eventBus","hotkeys","$modal","deviceDetectionService","appState"],angular.module("galleon").controller("UppCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d){this.urlUtil=a,this.dateUtil=b,this.imageOrigin=c,this.mediaPreferenceService=d}var b,c,d,e,f;return f=["auto","none","monochrome"],b=function(){function a(a,b,c){this.id=a.id,this.data=a.data,this.ranking=a.ranking,this.source=a.source,this.xOrigin=a.xOrigin,this.sflyId=a.sflyId,this.width=b.width,this.height=b.height,this.effect=b.effect,this.redeye=b.redeye,this.rotation=b.rotation,this.crop=b.crop,this.filename=c.filename,this.title=c.title,this.description=c.description,this.captureTime=c.captureTime,this.uploadTime=c.uploadTime}return a}(),e=function(){function a(a,b,c,d,e,f){this.id=a,this.data=b,this.ranking=c,this.source=d,this.xOrigin=e,this.sflyId=f}return a}(),d=function(){function a(a,b,c,d,e,f,g){var h,i,j,k,l;this.mediaPreferenceService=a,this.width=b,this.height=c,this.effect=null!=d?d:null,this.redeye=null!=e?e:"",this.rotation=null!=f?f:0,this.crop=null!=g?g:{llx:0,lly:0,urx:1,ury:1},null==this.effect&&(this.effect=this.mediaPreferenceService.vividPics?"Auto":"None"),1===(h=this.rotation)||2===h||4===h?this.rotation=0:6===(i=this.rotation)||7===i?(this.rotation=90,j=[this.height,this.width],this.width=j[0],this.height=j[1]):3===this.rotation?this.rotation=180:5!==(k=this.rotation)&&8!==k&&9!==k||(this.rotation=270,l=[this.height,this.width],this.width=l[0],this.height=l[1]),this.effect=this._stripUnwantedEffects(this.effect)}return a.prototype._stripUnwantedEffects=function(a){var b,c;return b=a.toLowerCase(),f.indexOf(b)>-1||0===b.indexOf("afs-")?a:c=this.mediaPreferenceService.vividPics?"Auto":"None"},a}(),c=function(){function a(a,b,c,d,e,f){this.title=b,this.filename=c,this.description=d,this.captureTime=a.getISOFormat(e),this.uploadTime=a.getISOFormat(f)}return a}(),a.prototype.extractPropsFromProcSimpleUrl=function(a){var b,c,d,e,f,g,h;return e=this.urlUtil.explodeQueryString(a),f={},f.imageID=e.imageID,f.DATA=e.DATA,f.redeye=e.redeye,f.rotation=parseFloat(e.rotation),f.effect=e.effect,c=null!=(g=e.cropll)?g.split(","):void 0,d=null!=(h=e.cropur)?h.split(","):void 0,b={},b.llx=parseFloat(c[0]),b.lly=parseFloat(c[1]),b.urx=parseFloat(d[0]),b.ury=parseFloat(d[1]),f.crop=b,f},a.prototype._isLegacySflyImage=function(a){var b,c,d;return"sfly"===(null!=(b=a.source)?b.id:void 0)&&null!=(null!=(c=a.data)?c.url:void 0)&&(null!=(d=a.mPath)?d.indexOf("/sfly/"):void 0)!==-1},a.prototype.newInstance=function(a){var b,c,d;return this._isLegacySflyImage(a)?this.processLegacySflyImage(a):"sfly"===(null!=(b=a.source)?b.id:void 0)?this.processSflyImage(a):100===a.state||null!=a.umsData?"myComputer"===(null!=(c=a.source)?c.id:void 0)||"device"===(null!=(d=a.source)?d.id:void 0)?this.processMyComputerUpload(a):this.processThirdPartyImage(a):this.processUppThumb(a)},a.prototype.instanceFromBookInitImage=function(a){var c,f,g,h;return h={0:0,1:90,2:180,3:270},g="",c={llx:parseFloat(a.crop._llx,10),lly:parseFloat(a.crop._lly,10),urx:parseFloat(a.crop._urx,10),ury:parseFloat(a.crop._ury,10)},f={title:a.title.__text,filename:a.filename.__text,description:a.description.__text,captureTime:a.captureTime.__text,uploadTime:a.uploadTime.__text},"undefined"!=typeof a.redeye.__text&&(g=a.redeye.__text),new b(new e(a._id,a.data.__text,parseFloat(a.ranking.__text,10),"sfly","SFLY_LIGHTBOX",a.id),new d(this.mediaPreferenceService,parseInt(a.size._width,10),parseInt(a.size._height,10),a.effect.__text,g,h[a.rotation]||0,c),f)},a.prototype.processSflyImage=function(a){var f,g;return g=a.data.created_at_timestamp,f=a.data.original_filename,new b(new e(a.id,a,null,"thisLife",this.imageOrigin.fromValue("thisLife"),a.id),new d(this.mediaPreferenceService,a.width,a.height),new c(this.dateUtil,a.title,f,a.data.caption_text,a.date,g))},a.prototype.processLegacySflyImage=function(a){var f;return f=this.extractPropsFromProcSimpleUrl(a.data.url),a.id=a.data.view_efx.encodedMspPath,new b(new e(a.data.view_efx.encodedMspPath,a.data.view_efx.data,null,a.source.id,this.imageOrigin.fromValue(a.source.id),a.data.id),new d(this.mediaPreferenceService,a.data.image_def.primary_width,a.data.image_def.primary_height,f.effect,f.redeye,f.rotation,f.crop),new c(this.dateUtil,a.title,a.title,null,a.date,a.data.updtime))},a.prototype.processUppThumb=function(a){var f,g,h,i;return f=function(){var b;switch(null!=(b=a.source)?b.id:void 0){case"sites":return 1e3*a.data.captureDate;case"thisLife":return 1e3*a.date;case"flickr":return a.data.datetaken;default:return a.date}}(),h=a.width,g=a.height,new b(new e(a.id,a,null,null!=(i=a.source)?i.id:void 0,this.imageOrigin.fromValue(a.source.id,a.id)),new d(this.mediaPreferenceService,h,g),new c(this.dateUtil,a.title,a.title,null,f,Date.now()))},a.prototype.processMyComputerUpload=function(a){var f;return f=null,f=a.data?new e(a.data.mspImagePath,a.data.mspData,null,a.source.id,this.imageOrigin.fromValue(a.source.id),a.data.imageId):new e(a.id,null,null,a.source.id,this.imageOrigin.fromValue(a.source.id),a.id),new b(f,new d(this.mediaPreferenceService,a.width,a.height,"Auto","",a.orientation),new c(this.dateUtil,a.title,a.title,null,a.date,Date.now()))},a.prototype.processThirdPartyImage=function(a){var f,g,h,i,j,k,l,m,n,o;return k=null!=(n=null!=(o=a.source)?o.id:void 0)?n:"thisLife",a.umsData?(i=this.extractPropsFromProcSimpleUrl(a.umsData.url),m=a.umsData.image_def.primary_width,h=a.umsData.image_def.primary_height,l=a.umsData.data_acquisition.upload_time,f=a.umsData.image_def.capture_time||l||a.umsData.instime,g=a.umsData.title||a.title,j=a.umsData.id):(i={imageID:a.id,DATA:a},m=a.width,h=a.height,f=a.date,l=a.date,g=a.title,j=a.id),"instagram"===k&&(f=a.date),"flickr"===k&&(f=a.data.datetaken),new b(new e(i.imageID,i.DATA,null,k,this.imageOrigin.fromValue(k),j),new d(this.mediaPreferenceService,m,h,i.effect,i.redeye,i.rotation,i.crop),new c(this.dateUtil,a.title,g,null,f,l))},a}(),a.$inject=["urlUtil","dateUtil","imageOrigin","mediaPreferenceService"],"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("uppImageFactory",a)}.call(this),function(){var a;a=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S;return this.logger=g.newInstance("UPPService"),s=!1,w=!0,E=c.loadUppOnStart,x=[],y=null,O=null,q=c.allowAnonymousUpload,H=!0,z=[],P=0,I={},r=!1,D=!1,F=function(b,d){if(!c.runningTests()&&c.features.autoSwitchLanguage){if("es"===b)return d.L10N=a.translations.uppes;if("fr"===b)return d.L10N=a.translations.uppfr;if(d.L10N=a.translations.uppen,d.L10N.done="Add to project",p.isDeviceAPhone()&&(d.L10N.sources="Select 20-40 photos",d.L10N.done="Add"),p.isDeviceATablet())return d.L10N.sources="Select 20-200 photos"}},v=function(a){var b,c,d,e,f,g,h,i,j;if((null!=a?a.length:void 0)>0){for(j=[],b=e=f=a.length-1;f<=0?e<=0:e>=0;b=f<=0?++e:--e)c=a[b],d=null!=(g=null!=(h=c.data)&&null!=(i=h.view_efx)?i.encodedMspPath:void 0)?g:c.id,I[d]===!0?j.push(a.splice(b,1)):j.push(void 0);return j}},A=function(a){return a.detail.wait.length+a.detail.done.length+a.detail.xfer.length},Q=function(c){var d,e,f,g,h,i,j,l,m;if(h=a.Shr.Dialogs.UniversalPicker,g=function(){switch(c.detail.type){case h.EventType.start:return b.events.UPP_IMAGE_START;case h.EventType.done:return b.events.UPP_IMAGE_FINISH;case h.EventType.itemUpdate:return b.events.UPP_IMAGE_UPDATE;default:return b.events.UPP_UNKNOWN}}(),i=c.detail,i.type===h.EventType.start&&(f=A(i),v(null!=(j=i.detail)?j.wait:void 0),v(null!=(l=i.detail)?l.done:void 0),v(null!=(m=i.detail)?m.xfer:void 0),d=f-A(i),d&&(a.Shr.Dialogs.UniversalPicker.context.currentCount-=d),p.isDeviceMobile()&&0===k.getCollectionSize()&&(e=A(i),(e<p.getSuperSimpleDefaults().photoSelection.min||e>p.getSuperSimpleDefaults().photoSelection.max)&&a.Shr.Dialogs.UniversalPicker.context.maxCount!==e&&(i.detail.wait=[],i.detail.done=[],i.detail.xfer=[])),k.appendToUppObjects(i)),i.type!==h.EventType.itemUpdate||!i.detail.cancelled)return w||c.detail.type!==h.EventType.done||S(),w&&c.detail.type!==h.EventType.start?x.push({topic:g,uppData:i}):b.publish(g,i)},B=function(a){return"string"==typeof(null!=a?a.mPath:void 0)&&0===a.mPath.indexOf("Image:")},J=function(){var a,c,d;for(c=0,d=x.length;c<d;c++)a=x[c],b.publish(a.topic,a.uppData);return x=[]},K=function(){var a,b,d,e,f;if(S(),q&&!H&&z.length&&!(P>=c.uploadThreads))for(d=function(a){return m(function(){return a.cancelled?(P--,void K()):O.onItemSelected(a.item,a.update,a.folder)},100)},b=e=P,f=c.uploadThreads-1;P<=f?e<=f:e>=f;b=P<=f?++e:--e){if(!z.length)return;P++,a=z.shift(),d(a)}},S=function(){var a,c,d,e,f,g,h;if(c=null!=(f=n.currentProject)&&null!=(g=f.imageCollection)?g.projectImages:void 0,null!=c){for(h=[],d=0,e=c.length;d<e;d++)a=c[d],a.isRawSuperfly()&&h.push(b.publish(b.events.UPP_IMAGE_UPDATE,{detail:a}));return h}},C=function(a,b){if((null!=b?b.source:void 0)&&("myComputer"===(null!=b?b.source.id:void 0)||"device"===(null!=b?b.source.id:void 0)))return P--,K()},R=function(){return f.userInfo().then(function(a){return L(a),q=!0,K()})},L=function(b){var c;if(c=a.Shr)return c.U.sflyMember=!0,c.U.id=c.U.uid=c.U.un=c.U.userId=c.U.userName=b.id,c.U.oauthToken=b.oAuthToken,c.U.oflyToken=b.openflyToken},M=function(a){return null==a&&(a=!0),b.publish(b.events.MODAL_UPLOAD_PROGRESS_SHOW,{disableClose:a}),b.subscribe(b.events.UPP_UPLOAD_COMPLETED,function(){return b.publish(b.events.MODAL_UPLOAD_PROGRESS_HIDE)})},N=function(){var b,c,d,e,f,g;for(c=a.Shr.Dialogs.UniversalPicker,d=c.getStatus(),e=0,f=0,g=d.length;f<g;f++)b=d[f],e+=b.xfer.length;if(P>e)return P=e,K()},u=function(){var b,c,d,e,f,g,h,i,j,k,l;if(z=[],P=0,c=a.Shr.Dialogs.UniversalPicker,d=c.getStatus()){for(l=[],g=0,i=d.length;g<i;g++){for(b=d[g],k=b.xfer,h=0,j=k.length;h<j;h++)f=k[h],c.deselectItem(f),f.cancelled=!0;l.push(function(){
var a,d,f,g;for(f=b.wait,g=[],a=0,d=f.length;a<d;a++)e=f[a],c.deselectItem(e),g.push(e.cancelled=!0);return g}())}return l}},t=function(b,c){var d,e,f,g,h,i,j;if(g=c.uppObject,g.cancelled=!0,a.Shr.Array.removeByProperty(z,"item",g),f=a.Shr.Dialogs.UniversalPicker,h=f.getStatus()){for(d=!1,i=0,j=h.length;i<j;i++){if(e=h[i],e.xfer.indexOf(g)!==-1){f.deselectItem(g),P--,K(),d=!0;break}if(e.wait.indexOf(g)!==-1){f.deselectItem(g),d=!0;break}}return N()}},b.subscribe(b.events.START_UPLOADS,function(){var a,b,d,e,f,g,h,i;if(d=null!=(g=n.currentProject)&&null!=(h=g.imageCollection)?h.projectImages:void 0,null!=d&&!c.superSimple){for(b=0,e=0,f=d.length;e<f;e++)a=d[e],"myComputer"===(null!=(i=a.uppObject)?i.source.id:void 0)&&b++;b>5&&M(!1)}return w=!1,H=!1,m(J,100),m(K,1e3)}),b.subscribe(b.events.APP_READY,function(){return r=!0}),b.subscribe(b.events.PROJECT_LOADED,function(){if(r)return w=!1,m(J,100)}),b.subscribe(b.events.PALETTE_IMAGES_UPLOADED,C),b.subscribe(b.events.PALETTE_IMAGES_UPLOAD_ERROR,C),b.subscribe(b.events.PALETTE_IMAGES_UPLOAD_CANCEL,t),b.subscribe(b.events.CANCEL_UPLOADS,u),c.allowAnonymousUpload||f.userInfo().then(function(a){return a.isLoggedIn?R():(b.subscribe(b.events.USER_SIGNIN,R),b.subscribe(b.events.UPP_USER_SIGNIN,R))}),G={Shr:a.Shr,show:function(d){return function(e,g,h){var i,j,k,q,r,t,u,v,w,x,A,B,C,E,G,H,J,N,P,Q;return null==h&&(h=!1),a.scw&&(a.scw.userAgent=null!=(w=a.navigator)?w.userAgent:void 0),c.features.disableAutofill&&(h=c.features.disableAutofill),I=null!=(x=null!=(C=n.currentProject)&&null!=(E=C.imageCollection)?E.createIdMap():void 0)?x:{},r=c.defaults.maxAllowedImages,a.Galleon.uppPhotoPlacementHook.forceAutofill=g.forceAutofill,null!=g.selectionLimit?(t=a.Galleon.uppPhotoSelectionLimitHook,r=g.selectionLimit.maxPhotos,null!=(G=a.Shr)&&null!=(H=G.Dialogs)&&null!=(J=H.UniversalPicker)&&null!=(N=J.context)&&(N.maxCount=r),t.options=angular.extend({},t.options,g.selectionLimit)):a.Galleon.uppPhotoSelectionLimitHook.init(),i=o.getBrowserName(),j=o.getBrowserVersion(),"Internet Explorer"===i&&"10.0"===j&&(r=c.defaults.maxAllowedImagesForIE10),"iPhone"===i&&j<8&&(k=!0),b.publish(b.events.MODAL_OPENED),a.Galleon.uppPhotoPlacementHook.template||a.Galleon.uppPhotoPlacementHook.getTemplate(),a.Galleon.uppPleaseWaitHook.template||a.Galleon.uppPleaseWaitHook.getTemplate(),a.Galleon.uppPhotoSelectionLimitHook.template||a.Galleon.uppPhotoSelectionLimitHook.getTemplate(),c.superSimple&&(a.Shr.B.isTouch=!0),u=null!=(P=n.currentProject)&&null!=(Q=P.product)&&null!=(A=Q.cover)?A.sku:void 0,q=null!=(B=n.currentProject)?B.hasBeenSaved:void 0,a.Shr?s?(a.Galleon.placePhotosDirectlyInTray=h,a.Galleon.uppPhotoPlacementHook.setEnable(!c.features.disableAutofill),a.Galleon.uppPhotoPlacementHook.getContent(),a.Galleon.uppPleaseWaitHook.getContent(),a.Shr.Dialogs.UniversalPicker.context.product=l.getProductCode(u),a.Shr.Dialogs.UniversalPicker.context.category=l.getCategoryCode(u),"function"==typeof(v=a.Shr.Dialogs.UniversalPicker).reopen?v.reopen():void 0):(a.Galleon.placePhotosDirectlyInTray=h,q&&a.Galleon.uppPhotoPlacementHook.setEnable(!c.features.disableAutofill),a.Galleon.uppPhotoPlacementHook.getContent(),a.Galleon.uppPleaseWaitHook.getContent(),f.userInfo().then(function(d){var f,h;return g.category=l.getCategoryCode(u),g.product=l.getProductCode(u),g.onLoadComplete=function(){var b;return b=a.Shr.Dialogs.UniversalPicker,O=a.Shr.Array.findByProperty(b.sinks,"id","upload")},g.maxCount=r,g.umsWWW="local-beta"===c.env?c.userMediaService:void 0,g.minCount=0,g.useHtml5ItemV2=!0,g.showNavBarSelectAllNone=!0,g.sources={myComputer:{requiresSignin:c.forceSignIn||p.isDeviceAPhone(),useExif:!0}},g.sinks={deferredUpload:{id:"deferredUpload",init:function(a){return y=this},onItemSelected:function(b,c,d){return a.Galleon.uppPhotoSelectionLimitHook.adjustUppBehavior(),"upload"===b.source.dataSourceType&&(z.push({item:b,update:c,folder:d}),!0)},onItemDeselected:function(b){return a.Shr.Array.removeByProperty(z,"item",b)},start:function(){return K()}},upload:{immediate:!0,maxThreads:c.uploadThreads}},g.onCancel=function(){if(c.superSimple&&!D)return m(function(){return b.publish(b.events.HANDLE_UPP_CANCEL)},10)},g.ok={id:"waitForData",type:7,noSelect:!0,title:"Loading",pending:a.Galleon.uppPleaseWaitHook.getContent(),getContents:function(){return this.pending=a.Galleon.uppPleaseWaitHook.getContent(),a.Galleon.uppPhotoPlacementHook.getContent(),a.Galleon.uppPleaseWaitHook.gatherUppImagesData().then(function(){var b;return a.Shr.Dialogs.UniversalPicker.context.onCancel=function(){},p.isDeviceMobile()?a.Galleon.uppPhotoSelectionLimitHook.isInSelectionLimitRange()?(a.Galleon.uppPhotoPlacementHook.getSuperSimpleContent(!0),k&&M(),!0):(b=a.Galleon.uppPhotoSelectionLimitHook.getContent(),$(".upp-please-wait-hook-container").parent().html(b)):a.Galleon.superSimple===!0?(a.Galleon.uppPhotoPlacementHook.getSuperSimpleContent(!0),!0):a.Shr.Dialogs.UniversalPicker.close()}),!1}},h=p.isDeviceAPhone()?"Number of photos":"Where would you like to add your photos?",g.done={id:"picUPDone",type:7,noSelect:!0,title:h,pending:a.Galleon.uppPhotoPlacementHook.getContent(),getContents:function(){var b;return p.isDeviceMobile()?a.Galleon.uppPhotoSelectionLimitHook.isInSelectionLimitRange()?(b=null==n.currentProject.product||!n.currentProject.product.hasFilledPages(),this.pending=a.Galleon.uppPhotoPlacementHook.getSuperSimpleContent(!1,{initialAutofill:b}),D=!0,!0):(this.pending=a.Galleon.uppPhotoSelectionLimitHook.getContent(),!1):a.Galleon.superSimple===!0?(this.pending=a.Galleon.uppPhotoPlacementHook.getSuperSimpleContent(),!0):a.Galleon.placePhotosDirectlyInTray===!0?(this.pending=a.Galleon.uppPhotoPlacementHook.getDirectToTrayContent(),!0):(this.pending=a.Galleon.uppPhotoPlacementHook.getContent(),!a.Galleon.uppPhotoPlacementHook.isEnabled()&&(a.Shr.Dialogs.UniversalPicker.done(),a.Galleon.uppPhotoPlacementHook.setEnable(!c.features.disableAutofill),!0))}},L(d),f=a.Shr,F(c.language,g),f.Dialog.show(e,g),s=!0})):d.logger.critical("Cannot launch Picture Picker")}}(this),cancelSelection:function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;if(f=a.Shr.Dialogs.UniversalPicker,d=f.getStatus()){for(c=d[0],o=c.wait,i=0,l=o.length;i<l;i++)g=o[i],f.deselectItem(g);for(p=c.done,j=0,m=p.length;j<m;j++)e=p[j],f.deselectItem(e);for(q=c.xfer,k=0,n=q.length;k<n;k++)h=q[k],f.deselectItem(h);return w=!1,x=[],b.publish(b.events.UPP_IMAGE_FINISH)}},bootstrapUppEvents:function(){return a.addEventListener("Shr.Dialogs.UniversalPicker",Q),this.superSimple=c.superSimple,a.Galleon={uppPhotoPlacementHook:h,uppPleaseWaitHook:i,uppPhotoSelectionLimitHook:j,superSimple:this.superSimple,placePhotosDirectlyInTray:!1}},hasSuperflyMPath:function(a){return B(a)},getLocalImageData:function(a){var b,g,h,i,j,l,m,n,o,p,q,r;i=e.defer(),a.localImageDataPromise=i.promise,g=1999,b=17,l=function(a){return a.mPath.split(":")[1]};try{return p="",q=k.getUppObject(a.imageId),B(q)?p=l(q):B(a)?p=l(a):(m=a.mPath.split("/"),n=parseInt(m[m.length-1]),h=parseInt(m[m.length-2]),o=parseInt(m[m.length-3]),r=parseInt(m[m.length-4]),p=1<<30|12*(r-g)+o-1<<b+5|h<<b|n),f.userInfo().then(function(b){return d({method:"GET",url:c.userMediaService+"/"+b.id+"/images/"+p.toString(),params:{access_token:b.oAuthToken}}).success(function(b,c,d,e){return a.umsData=angular.fromJson(b),i.resolve(a)}).error(function(b,c,d,e){return i.reject("Could not get image data for "+a.mPath)})}),i.promise}catch(b){return j=b,i.reject("Path "+a.mPath+" is not a path to an image"),i.promise}},deferUppEvents:function(){return w=!0},processDeferredUppEvents:function(){return m(function(){return w=!1,J()},0)},shouldDeferUppEvents:function(){return w},addToDeferedEventsList:function(a,b){return x.push({topic:a,uppData:b})},isUppReady:function(){return!!a.Shr},loadUppOnStart:function(){return E},uppFailedToLoad:function(){return E=!1},allowUpload:function(){return q},pauseUpload:function(){return H=!0},resumeUpload:function(){return m(function(){return H=!1,K()},0)},gatherUppImagesData:function(){return k.incompleteDataPromise()},removeImageFromUpp:function(b){var c,d,e,f;if(null!=(d=a.Shr)&&null!=(e=d.Dialogs)&&null!=(f=e.UniversalPicker)?f.context:void 0)return c=b.uppObject||k.getUppObject(b.imageId),c?a.Shr.Dialogs.UniversalPicker.deselectItem(c):a.Shr.Dialogs.UniversalPicker.context.currentCount--}},b.subscribe(b.events.PALETTE_IMAGES_REMOVED,function(a,b){return G.removeImageFromUpp(b)}),G},a.$inject=["$window","eventBus","CONFIG","$http","$q","userService","loggerFactory","photoPlacementUppHook","pleaseWaitUppHook","photoSelectionLimitUppHook","uppObjectCollection","uppProductCodeService","$timeout","projectService","browserDetectionService","deviceDetectionService"],angular.module("galleon").service("uppService",a)}.call(this),function(){var a;a=function(){function a(){this._productCodes={PB_10X10_01:{category:18900,product:1088669},PB_10X10_02:{category:18900,product:1088669},PB_10X10_04:{category:18900,product:1088669},PB_10X10_05:{category:18900,product:1088669},PB_10X10_09:{category:18900,product:1088669},PB_10X10_08:{category:1000241,product:1088682},PB_10X10_10:{category:1000241,product:1088682},PB_11X14_02:{category:18900,product:1088671},PB_11X14_04:{category:18900,product:1088671},PB_11X14_05:{category:18900,product:1088671},PB_11X14_09:{category:18900,product:1088671},PB_11X14_08:{category:1000241,product:1088686},PB_11X14_10:{category:1000241,product:1088686},PB_12X12_02:{category:18900,product:616978},PB_12X12_04:{category:18900,product:616978},PB_12X12_05:{category:18900,product:616978},PB_12X12_09:{category:18900,product:616978},PB_12X12_08:{category:1000241,product:1080192},PB_12X12_10:{category:1000241,product:1080192},PB_5X7_01:{category:18900,product:613681},PB_7X9_01:{category:18900,product:615244},PB_8X11_01:{category:18900,product:616980},PB_8X11_02:{category:18900,product:616980},PB_8X11_04:{category:18900,product:616980},PB_8X11_05:{category:18900,product:616980},PB_8X11_09:{category:18900,product:616980},PB_8X11_08:{category:1000241,product:1080188},PB_8X11_10:{category:1000241,product:1080188},PB_8X8_01:{category:18900,product:616976},PB_8X8_02:{category:18900,product:616976},PB_8X8_04:{category:18900,product:616976},PB_8X8_05:{category:18900,product:616976},PB_8X8_09:{category:18900,product:616976},PB_8X8_08:{category:1000241,product:1080184},PB_8X8_10:{category:1000241,product:1080184}}}var b,c;return c=616980,b=18900,a.prototype.getProductCode=function(a){return this._productCodes[a]?this._productCodes[a].product:c},a.prototype.getCategoryCode=function(a){return this._productCodes[a]?this._productCodes[a].category:b},a}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("uppProductCodeService",[a])}.call(this),function(){var a;a=function(){function a(a,b){this.$timeout=a,this.$q=b,this._productImageIds={},this._uppObjects=[],this._incompleteDataQueue=[],this._incompleteDataProcessing=!1,this._lastId=0,this._incompleteDataDefer=null}return a.prototype.appendToUppObjects=function(a){var b,c,d,e;for(b=[].concat(a.detail.wait,a.detail.done,a.detail.xfer),0===this._incompleteDataQueue.length&&(this._incompleteDataDefer=this.$q.defer()),d=0,e=b.length;d<e;d++)c=b[d],c&&(c.id=Date.now()+""+this._lastId++,c.origId=c.id,c.width&&c.height||this._incompleteDataQueue.push(c));return this._uppObjects=this._uppObjects.concat(b),this.processIncompleteDataQueue()},a.prototype.getCollectionSize=function(){return this._uppObjects.length},a.prototype.getUppObject=function(a){var b,c,d,e;for(e=this._uppObjects,c=0,d=e.length;c<d;c++)if(b=e[c],b.origId===a||b.id===a)return b},a.prototype.processIncompleteDataQueue=function(){var a,b;if(!this._incompleteDataProcessing)return this._incompleteDataQueue.length?(this._incompleteDataProcessing=!0,b=this._incompleteDataQueue.shift(),b.width&&b.height?void this.imgLoadEvent(b,0):(a=b.getThumbnailUrl(90,90,function(a){return function(c){return b.width&&b.height?a.imgLoadEvent(b,20):b.getThumbnailUrl(Number.MAX_VALUE,Number.MAX_VALUE,function(c){return a.getImageSize(b,c)})}}(this)),a&&!a.match(/^data:image\/gif;base64/)?this.getImageSize(b,a):void 0)):void this._incompleteDataDefer.resolve()},a.prototype.imgLoadEvent=function(a,b){this._incompleteDataProcessing=!1,this.$timeout(function(a){return function(){return a.processIncompleteDataQueue()}}(this),b)},a.prototype.addProductImageId=function(a,b){return this._productImageIds[a]=b},a.prototype.getProductImageId=function(a){return this._productImageIds[a]},a.prototype.getImageSize=function(a,b){var c;return c=new Image,c.onload=function(b){return function(){return a.width=c.naturalWidth,a.height=c.naturalHeight,b.imgLoadEvent(a,20)}}(this),c.onerror=function(b){return function(){return a.state=300,b.imgLoadEvent(a,20)}}(this),c.src=b},a.prototype.incompleteDataPromise=function(){return this._incompleteDataDefer.promise},a.prototype.getIncompleteDataQueueLength=function(){return this._incompleteDataQueue.length},a}(),"undefined"!=typeof angular&&null!==angular&&angular.module("galleon").service("uppObjectCollection",["$timeout","$q",a])}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j){this.$window=a,this.$http=c,this.$q=d,this.$templateCache=e,this.$compile=f,this.eventBus=g,this.$rootScope=h,this.$timeout=i,this.deviceDetectionService=j,this.cancel=b(this.cancel,this),this.close=b(this.close,this),this.done=b(this.done,this),this.getContent=b(this.getContent,this),this.getDirectToTrayContent=b(this.getDirectToTrayContent,this),this.updateData=b(this.updateData,this),this.getTemplate=b(this.getTemplate,this),this.isEnabled=b(this.isEnabled,this),this.setEnable=b(this.setEnable,this),this.projectLoaded=b(this.projectLoaded,this),this.init()}return a.prototype.init=function(a){var b;return this.options=null!=a?a:{templateUrl:"UPP/views/upp-photo-placement.html"},this.scope=null!=(b=this.$rootScope)?b.$$childHead:void 0,this.jquery=this.$window.$,this.enabled=!1,this.defaultSelection="ADD_TO_PALETTE",this.selectedDataKey="SELECTED_OPTION",this.dataVault={SELECTED_OPTION:"ADD_TO_PALETTE"},this.eventBus.subscribe(this.eventBus.events.PROJECT_LOADED,this.projectLoaded,this.scope)},a.prototype.projectLoaded=function(){return this.getTemplate()},a.prototype.setEnable=function(a){return this.enabled=a},a.prototype.isEnabled=function(){return this.enabled},a.prototype.getTemplate=function(){var a;return this.options.templateUrl?(a=this.$http.get(this.options.templateUrl,{cache:this.$templateCache}),a.success(function(a){return function(b){return a.template=angular.element(b)}}(this)).error(function(a){return function(){throw new Error("Unknown template for: PhotoPlacementUppHook")}}(this))):void(this.template=angular.element("<div>DUMMY</div>"))},a.prototype.updateData=function(a,b){return this.dataVault[a]=b,this.defaultSelection=b},a.prototype.getSuperSimpleContent=function(a,b){var c;return null==a&&(a=!1),c="ADD_TO_PALETTE",(this.deviceDetectionService.isDeviceAPhone()||this.forceAutofill===!0)&&(c="ADD_TO_NEW_PAGES"),this.dataVault[this.selectedDataKey]=c,a?this.close():this.done(b),!0},a.prototype.getDirectToTrayContent=function(){return this.dataVault[this.selectedDataKey]="ADD_TO_PALETTE",this.done(),!0},a.prototype.getContent=function(a){var b;if(null==a&&(a=!1),this.scope)return this.dataVault[this.selectedDataKey]="ADD_TO_PALETTE",b=this.$compile(this.template)(this.scope),"ADD_TO_NEW_PAGES"===this.defaultSelection&&(this.dataVault[this.selectedDataKey]=this.defaultSelection,this.$timeout(function(a){return function(){if(!a.jquery("#radio_placement_modal_add_to_new_pages").is(":disabled"))return a.jquery("#radio_placement_modal_add_to_new_pages").attr("checked","checked")}}(this),0)),b.html()},a.prototype.done=function(a){var b;return b=this.dataVault[this.selectedDataKey],(null!=a?a.initialAutofill:void 0)===!0&&this.deviceDetectionService.isDeviceATablet()||this.eventBus.publish(this.eventBus.events.UPP_IMAGE_PLACEMENT_SELECTED,b),this.$window.Shr.Dialogs.UniversalPicker.done()},a.prototype.close=function(){var a;return a=this.dataVault[this.selectedDataKey],this.$timeout(function(b){return function(){return b.eventBus.publish(b.eventBus.events.UPP_IMAGE_PLACEMENT_SELECTED,a)}}(this),0),this.$window.Shr.Dialogs.UniversalPicker.close()},a.prototype.cancel=function(){return this.$window.Shr.Dialogs.UniversalPicker.cancel()},a}(),a.$inject=["$window","$http","$q","$templateCache","$compile","eventBus","$rootScope","$timeout","deviceDetectionService"],angular.module("galleon").service("photoPlacementUppHook",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i){this.$http=a,this.$q=c,this.$templateCache=d,this.$window=e,this.$compile=f,this.uppObjectCollection=g,this.$timeout=h,this.$rootScope=i,this.gatherUppImagesData=b(this.gatherUppImagesData,this),this.monitorProgress=b(this.monitorProgress,this),this.getContent=b(this.getContent,this),this.getTemplate=b(this.getTemplate,this),this.init()}return a.prototype.init=function(a){var b;return this.options=null!=a?a:{templateUrl:"UPP/views/upp-please-wait.html"},this.progressBarStart=0,this.progressBarNow=0,this.shouldMonitorProgress=!1,this.jquery=this.$window.$,this.scope=null!=(b=this.$rootScope)?b.$$childHead:void 0},a.prototype.getTemplate=function(){var a;return this.options.templateUrl?(a=this.$http.get(this.options.templateUrl,{cache:this.$templateCache}),a.success(function(a){return function(b){return a.template=angular.element(b)}}(this)).error(function(a){return function(){throw new Error("Unknown template for: PleaseWaitUppHook")}}(this))):void(this.template=angular.element("<div>DUMMY</div>"))},a.prototype.getContent=function(){var a;if(this.scope)return a=this.$compile(this.template)(this.scope),a.html()},a.prototype.monitorProgress=function(){var a;if(this.shouldMonitorProgress)return this.progressBarNow=this.progressBarStart-this.uppObjectCollection.getIncompleteDataQueueLength(),a=Math.round(100*this.progressBarNow/this.progressBarStart),this.jquery(".upp-please-wait .progress-bar").width(a+"%"),this.$timeout(function(a){return function(){return a.monitorProgress()}}(this),500)},a.prototype.gatherUppImagesData=function(){var a;return this.progressBarStart=this.uppObjectCollection.getIncompleteDataQueueLength(),this.progressBarNow=0,this.shouldMonitorProgress=!0,this.monitorProgress(),a=this.uppObjectCollection.incompleteDataPromise(),a.then(function(a){return function(){return a.shouldMonitorProgress=!1}}(this)),a},a}(),a.$inject=["$http","$q","$templateCache","$window","$compile","uppObjectCollection","$timeout","$rootScope"],angular.module("galleon").service("pleaseWaitUppHook",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j){var k;this.$http=a,this.$q=c,this.$templateCache=d,this.$window=e,this.imageCollection=f,this.eventBus=g,this.$rootScope=h,this.config=i,this.deviceDetectionService=j,this.goBack=b(this.goBack,this),this.done=b(this.done,this),this.adjustUppBehavior=b(this.adjustUppBehavior,this),this.getContent=b(this.getContent,this),this.isInSelectionLimitRange=b(this.isInSelectionLimitRange,this),this._getTotalSelectedImages=b(this._getTotalSelectedImages,this),this.getTemplate=b(this.getTemplate,this),this.preloadTemplate=b(this.preloadTemplate,this),this.init(),this.eventBus.subscribe(this.eventBus.events.PROJECT_LOADED,this.preloadTemplate,this.scope),this.jquery=this.$window.$,this.scope=null!=(k=this.$rootScope)?k.$$childHead:void 0}return a.prototype.init=function(a){return this.options=null!=a?a:{templateUrl:"UPP/views/upp-photo-selection-limit.html",maxPhotos:this.deviceDetectionService.getSuperSimpleDefaults().photoSelection.max,minPhotos:this.deviceDetectionService.getSuperSimpleDefaults().photoSelection.min},this.progressBarStart=0,this.progressBarNow=0,this.shouldMonitorProgress=!1},a.prototype.preloadTemplate=function(){return this.getTemplate()},a.prototype.getTemplate=function(){var a;return this.options.templateUrl?(a=this.$http.get(this.options.templateUrl,{cache:this.$templateCache}),a.success(function(a){return function(b){return a.template=angular.element(b)}}(this)).error(function(a){return function(){throw new Error("Unknown template for: PleaseWaitUppHook")}}(this))):void(this.template=angular.element("<div>DUMMY</div>"))},a.prototype._getTotalSelectedImages=function(){var a,b,c;return a=null!=this.imageCollection.projectImages?this.imageCollection.projectImages.length:0,this.totalSelectedImages=a,b=null!=(c=this.$window.document.getElementsByClassName("shrUPSelCount")[0])?c.innerText:void 0,b&&(b=parseInt(b,10),angular.isNumber(b)&&(this.totalSelectedImages=a+b)),this.totalSelectedImages},a.prototype.isInSelectionLimitRange=function(){var a;return a=this._getTotalSelectedImages(),a>=this.options.minPhotos&&a<=this.options.maxPhotos},a.prototype.getContent=function(){var a,b,c;if(this.isInSelectionLimitRange())return this.done(),!0;if(this.template)return c=this._getTotalSelectedImages(),a=c>this.options.maxPhotos?"remove":"add",b=this.template.html(),b=b.replace("{{minPhotos}}",this.options.minPhotos),b=b.replace("{{maxPhotos}}",this.options.maxPhotos),b=b.replace("{{selectedPhotos}}",c),b=b.replace("{{backAction}}",a)},a.prototype.adjustUppBehavior=function(){if(this.$window.Galleon.superSimple===!0)return this.$window.Shr.Dialogs.UniversalPicker.context.onCancel=function(){},this.deviceDetectionService.isDeviceATablet()===!1?this.$window.Shr.Dialogs.UniversalPicker.context.maxCount=null:void 0},a.prototype.done=function(){return this.$window.Shr.Dialogs.UniversalPicker.done()},a.prototype.goBack=function(){return this.$window.Shr.Dialogs.UniversalPicker.back()},a}(),a.$inject=["$http","$q","$templateCache","$window","imageCollection","eventBus","$rootScope","CONFIG","deviceDetectionService"],angular.module("galleon").service("photoSelectionLimitUppHook",a)}.call(this),function(){"use strict";var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,b,d,e,f,g,h,i,j,k,l,m,n){this.imageURLService=a,this.eventBus=b,this.styleProvider=e,this.$translate=f,this.imageCollection=g,this.uppService=h,this.config=i,this.pageRenderAssistant=j,this.dropProxyHelper=k,this.modelStrategy=m,this.projectService=n,this._checkIfEditable=c(this._checkIfEditable,this),this._checkIfEmpty=c(this._checkIfEmpty,this),this._checkIfRemovable=c(this._checkIfRemovable,this),this._handleEmbellishmentRemoveClick=c(this._handleEmbellishmentRemoveClick,this),this._handlePageRemoveClick=c(this._handlePageRemoveClick,this),this._handlePageDoubleClick=c(this._handlePageDoubleClick,this),this._handlePageClick=c(this._handlePageClick,this),this._handleEditClick=c(this._handleEditClick,this),this._handlePageMouseleave=c(this._handlePageMouseleave,this),this._setTooltip=c(this._setTooltip,this),this._setActiveAsset=c(this._setActiveAsset,this),this._handlePageMouseenter=c(this._handlePageMouseenter,this),this.log=d.newInstance("PageDisplay"),this.scopeHelpersCreated=!1,this.jQuery=l.$,this.document=l.document}return a.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.scope.hasReportedLoad=!1,this.scope.directive=this,this.scope.handlePageRemoveClick=this._handlePageRemoveClick,this.scope.usePriorityLoadingLifecycleCallbacks=this.attrs.usePriorityLoadingLifecycleCallbacks,this.element.children().css("background-color","#fff"),this.touchMode=!1,this.clickListener=function(a){return function(b){return a._handlePageClick(b)}}(this),this.assetTapListener=function(a){return function(b){return a._handleAssetTap(b)}}(this),this.documentTapListener=function(a){return function(b){return a._handleDocumentTap(b)}}(this),this.doubleClickListener=function(a){return function(b){return a._handlePageDoubleClick(b)}}(this),this.mouseenterListener=function(a){return function(b){return a._handlePageMouseenter(b)}}(this),this.mouseleaveListener=function(a){return function(b){return a._handlePageMouseleave(b)}}(this),this._refreshEditListeners(),this._updateSize(),this.scope.removePageTooltip=this.$translate("SilverApp.removePageTooltip"),this._setUpWatchAndListeners(),this._setUpScopeProperties(),this.element.on("$destroy",function(a){return function(){return a._removeEditListeners()}}(this)),this.scope.reportPageLoad=function(a){return function(){return null==a.pageModel||a.scope.hasReportedLoad||null==a.scope.onPageLoad||(a.scope.onPageLoad(),a.scope.hasReportedLoad=!0),{}}}(this),this.scope.hasLayflat=function(a){return function(){return a.modelStrategy.hasLayflat()}}(this),this.scope.isSquare=function(a){return function(){return"square"===a.projectService.project.product.aspectRatio}}(this),this.scope.gutterShadowVisible=function(a){return function(b){return a.modelStrategy.gutterShadowVisible(b,a.pageModel)}}(this),this.scope.spreadGutterShadowVisible=function(a){return function(b,c){return a.modelStrategy.spreadGutterShadowVisible(b,a.pageModel,c)}}(this)},a.prototype._removeEditListeners=function(){return this.element[0].removeEventListener("click",this.clickListener,!0),this.element[0].removeEventListener("assettap",this.assetTapListener,!0),this.element[0].removeEventListener("touchstart",this.assetTapListener,!0),this.element[0].removeEventListener("dblclick",this.doubleClickListener,!0),this.element[0].removeEventListener("mouseover",this.mouseenterListener,!0),this.element[0].removeEventListener("mouseleave",this.mouseleaveListener,!0),this.document.removeEventListener("touchstart",this.documentTapListener,!0)},a.prototype._refreshEditListeners=function(){return this._removeEditListeners(),this.scope.editable?(this.config.superSimple&&(this.element[0].addEventListener("assettap",this.assetTapListener,!0),this.element[0].addEventListener("touchstart",this.assetTapListener,!0)),this.element[0].addEventListener("click",this.clickListener,!0),this.element[0].addEventListener("dblclick",this.doubleClickListener,!0),this.element[0].addEventListener("mouseover",this.mouseenterListener,!0),this.element[0].addEventListener("mouseleave",this.mouseleaveListener,!0),this.document.addEventListener("touchstart",this.documentTapListener,!0)):(this.element[0].addEventListener("click",this.clickListener,!0),this.element[0].addEventListener("mouseover",this.mouseenterListener,!0))},a.prototype._handlePageMouseenter=function(a){if(this.touchMode!==!0)return this._setTooltip(a.target),setTimeout(function(b){return function(){return b._setActiveAsset(a.target)}}(this),0)},a.prototype._setActiveAsset=function(a){var b;if(a.hasAttribute("data-attach-asset")!==!0&&a.hasAttribute("data-hoverable")!==!1)return b=parseInt(a.getAttribute("data-assetIndex"),10),this.scope.activeAsset!==this.pageModel.layout.assets[b]&&this.scope.$evalAsync(function(a){return function(){return a.scope.activeAsset=a.pageModel.layout.assets[b]}}(this)),this.scope.activeEmbellishmentAsset!==this.pageModel.layout.assets[b]&&angular.element(a).hasClass("embellishment-asset")?this.scope.$evalAsync(function(a){return function(){return a.scope.activeEmbellishmentAsset=a.pageModel.layout.assets[b]}}(this)):void 0},a.prototype._unsetActiveAsset=function(){return this.scope.activeAsset=null,setTimeout(function(a){return function(){return a.scope.$digest()}}(this),0)},a.prototype._setTooltip=function(a){var b,c;if(this.config.arrange===!0&&this.scope.editable?this.scope.pageTooltip=this.$translate("SilverApp.pageTooltip"):this.scope.pageTooltip="","text-image"===a.getAttribute("data-assetType")&&(b=this.pageModel.layout.assets[parseInt(a.getAttribute("data-assetIndex"),10)],this.scope.pageTooltip="",this.scope.editable?b.hasContent()||!b.canRemove?this.scope.textTooltip=this.$translate("SilverApp.textTooltip"):this.scope.textTooltip=this.$translate("SilverApp.textTooltipEmpty"):this.scope.textTooltip=""),"text-event"===a.getAttribute("data-assetType")&&this.scope.editable?this.scope.textTooltip=this.$translate("SilverApp.textTooltipEvent"):this.scope.editable||(this.scope.textTooltip=""),a.hasAttribute("data-embellishment")&&(this.scope.pageTooltip="",this.scope.imageTooltip=""),"image"===a.getAttribute("data-assetType")&&!a.hasAttribute("data-attach-asset")&&(this.scope.pageTooltip="",b=this.pageModel.layout.assets[parseInt(a.getAttribute("data-assetIndex"),10)],isNaN(b.projectImageId)?b.canRemove?(this.scope.imageTooltip=this.$translate("SilverApp.imageTooltipEmpty"),this.scope.removeTooltip=this.$translate("SilverApp.removeImageTooltipEmpty")):(this.scope.imageTooltip=this.$translate("SilverApp.imageTooltipEmptyLocked"),this.pageModel.isGrid&&(this.scope.imageTooltip+=this.$translate("SilverApp.eventAddPromptTooltip")),this.scope.removeTooltip=""):a.hasAttribute("data-attach-asset")||(this.scope.removeTooltip=this.$translate("SilverApp.removeImageTooltip"),c=this.imageCollection.getImageByProductImageId(b.projectImageId),(null!=c?c.isThumb:void 0)===!0?this.uppService.allowUpload()?this.scope.imageTooltip=this.$translate("SilverApp.imageTooltipUploading"):this.scope.imageTooltip=this.$translate("SilverApp.imageTooltipNotUploading"):this.scope.imageTooltip=this.$translate("SilverApp.imageEventTooltip")),!this.scope.editable))return this.scope.textTooltip="",this.scope.imageTooltip=""},a.prototype._handlePageMouseleave=function(a){var b;if(a.target.hasAttribute("data-hoverable")||a.target.hasAttribute("data-embellishment")||"hollow-dispatch"!==(null!=(b=a.customAttr)?b.reason:void 0)&&this.scope.$evalAsync(function(a){return function(){return a.scope.activeEmbellishmentAsset=null}}(this)),!a.target.hasAttribute("data-attach-asset")&&!a.target.hasAttribute("data-hoverable"))return this._unsetActiveAsset()},a.prototype._handleDocumentTap=function(a){if(!a.target.hasAttribute("data-assetType"))return this._unsetActiveAsset()},a.prototype._handleEditClick=function(){return setTimeout(function(a){return function(){return a.scope.tooltip=""}}(this),2e3)},a.prototype._handleAssetTap=function(a){var b,c,d,e;if(this.touchMode=!0,d=null!=a?a.target:void 0,d.hasAttribute("data-assetType")&&this.scope.isEditable){if("image-edit-prompt"===d.getAttribute("data-assetType")&&(c=this.pageModel.layout.assets[parseInt(d.getAttribute("data-assetIndex"),10)],isNaN(c.projectImageId)?(this.uppService.allowUpload()?this.scope.tooltip=this.$translate("SilverApp.imageTooltipUploading"):this.scope.tooltip=this.$translate("SilverApp.imageTooltipNotUploading"),this.scope.clickHandler=this._handleEditClick()):(b=this.imageCollection.getImageByProductImageId(c.projectImageId),b.isThumb===!1||null==b.isThumb?(this._handleImageDoubleClick(),this._unsetActiveAsset()):(this.uppService.allowUpload()?this.scope.tooltip=this.$translate("SilverApp.imageTooltipUploading"):this.scope.tooltip=this.$translate("SilverApp.imageTooltipNotUploading"),this.scope.clickHandler=this._handleEditClick()))),d.hasAttribute("data-attach-asset")&&"image"===d.getAttribute("data-assetType"))return"function"==typeof(e=this.scope).onRemoveImage&&e.onRemoveImage({page:this.pageModel,asset:this.scope.activeAsset}),void this._unsetActiveAsset();if(this._setActiveAsset(d),"image"!==d.getAttribute("data-assetType")&&"image-edit-prompt"!==d.getAttribute("data-assetType"))return this._unsetActiveAsset(),this._executePageEvent(a)}},a.prototype._handlePageClick=function(a){if(a.forwardedTouchEvent===!0&&(this.touchMode=!0),this.touchMode!==!0)return this._executePageEvent(a)},a.prototype._executePageEvent=function(a){var b;if(this._dispatchOnSelect(),b=a.target,b.hasAttribute("data-clickable")&&b.hasAttribute("data-assetType")&&this.scope.isEditable){switch(a.stopPropagation(),b.getAttribute("data-assetType")){case"image":this._handleImageClick(b);break;case"text-event":this._forceRemovePageHover(a),this._handleEventClick(b);break;case"text-image":this._forceRemovePageHover(a),
this._handleTextClick(b);break;case"page-remove-handle":this._handlePageRemoveClick();break;case"embellishment-remove-handle":this._handleEmbellishmentRemoveClick()}return!1}},a.prototype._handlePageDoubleClick=function(a){var b;if(this._dispatchOnSelect(),b=a.target,!b.hasAttribute("data-double-clickable")||!b.hasAttribute("data-assetType"))return void this._dispatchOnPageDoubleClick();if(this.scope.isEditable){switch(a.stopPropagation(),b.getAttribute("data-assetType")){case"image":this._launchEdit(b);break;case"text-image":this._handleTextClick(b)}return!1}},a.prototype._forceRemovePageHover=function(a){return angular.element(a.target).trigger("mouseleave")},a.prototype._launchEdit=function(a){var b,c,d,e,f,g,h;if(g=this.pageModel.layout.assets[parseInt(a.getAttribute("data-assetIndex"),10)],f=this.imageCollection.getImageByProductImageId(g.projectImageId),this.pageModel.isGrid&&(b=this.projectService.currentProject.product.calendarGrid,h=b.getEditableAssetsByClickedGridCellAsset(this.pageModel,g),c=h.dateAsset,d=h.eventAsset,e=h.gridCellAssets),this.config.calendarV2){if(null!=c&&null!=d)return this._handleEventClick(a,c,d,g,e);if(!isNaN(g.projectImageId))return this._handleImageDoubleClick(f.isThumb,this.uppService.allowUpload())}else{if(!isNaN(g.projectImageId))return this._handleImageDoubleClick(f.isThumb,this.uppService.allowUpload());if(this.pageModel.isGrid&&!g.canRemove)return this._handleEventClick(a)}},a.prototype._dispatchOnSelect=function(){if(null!=this.scope.onSelect)return this.scope.onSelect({page:this.pageModel})},a.prototype._dispatchOnPageDoubleClick=function(){if(null!=this.scope.onPageDoubleClick)return this.scope.onPageDoubleClick({page:this.pageModel})},a.prototype._handleTextClick=function(a){var b,c;if(b=parseInt(a.getAttribute("data-assetIndex")),b>0&&b<this.pageModel.layout.assets.length)return null!=(c=this.scope)?c.onEditText({assetIndex:b,surfaceNumber:this.pageModel.surfaceNumber}):void 0},a.prototype._handleEventClick=function(a,b,c,d,e){var f,g,h,i,j;if(g=parseInt(a.getAttribute("data-assetIndex")),g>0&&g<this.pageModel.layout.assets.length)return f=this.pageModel.layout.assets[g],null==b&&(h=this.projectService.currentProject.product.calendarGrid,i=h.getEditableAssetsByClickedGridCellAsset(this.pageModel,f),b=i.dateAsset,c=i.eventAsset,d=i.imageAsset,e=i.gridCellAssets),null!=(j=this.scope)&&"function"==typeof j.onEditEvent?j.onEditEvent({page:this.pageModel,asset:f,dateAsset:b,eventAsset:c,imageAsset:d,gridCellAssets:e}):void 0},a.prototype._handleImageClick=function(a){return a.hasAttribute("data-attach-asset")?this.scope.onRemoveImage&&this.scope.onRemoveImage({page:this.pageModel,asset:this.scope.activeAsset}):this._launchEdit(a),this._unsetActiveAsset()},a.prototype._handlePageRemoveClick=function(){return this.scope.onRemovePage&&this.scope.onRemovePage({page:this.pageModel}),this.scope.$apply()},a.prototype._handleEmbellishmentRemoveClick=function(){if(this.scope.onRemoveEmbellishment)return this.scope.onRemoveEmbellishment({page:this.pageModel,asset:this.scope.activeEmbellishmentAsset}),this.scope.$apply()},a.prototype._checkIfRemovable=function(){if(null!=this.pageModel)return this.scope.isRemovablePage=this.scope.editable,this.pageModel.isRemovablePage()?void 0:this.scope.isRemovablePage=!1},a.prototype._handleImageDoubleClick=function(a,b){var c;return null==a&&(a=!1),null==b&&(b=!0),this.scope.onImageDoubleClick&&(null!=(c=this.scope.activeAsset)?c.hasAssignedImage():void 0)&&this.scope.onImageDoubleClick({page:this.pageModel,asset:this.scope.activeAsset,thumb:a,upload:b}),this.scope.$digest()},a.prototype._checkIfEmpty=function(){if(null!=this.pageModel)return this.scope.isEmptyPage=this.pageModel.isEmpty()},a.prototype._checkIfEditable=function(){if(null!=this.pageModel)return this.scope.isEditable=this.scope.editable,this.pageModel.isFiller()?this.scope.isEditable=!1:void 0},a.prototype._updateDimensions=function(){return this._updateSize(),this._updateScale()},a.prototype._updateSize=function(){return null!=this.scope.width&&null!=this.scope.height?(this.widthAttr=this.scope.width,this.heightAttr=this.scope.height):null!=this.pageModel?this.log.warn("No dimensions passed to page with surface number "+this.pageModel.surfaceNumber):void 0},a.prototype._updateScale=function(){var a,b,c;if(null!=this.pageModel&&null!=this.widthAttr)return c=this.pageRenderAssistant.resizedDimensions(this.pageModel,this.widthAttr,this.heightAttr),b=c.width,a=c.height,this.assetScale=c.assetScale,this.element.css("width",Math.round(b)),this.element.css("height",Math.round(a)),this.pageModel.isStockCover&&(this.element.css("margin-right","auto"),this.element.css("margin-left","auto")),this.scope.assetScale=this.assetScale,this.scope.pageStyle=this.styleProvider.styleForPage(this.pageModel,this.assetScale),this.scope.gutterShadowClass=this.modelStrategy.classForGutterShadow(this.pageModel)},a.prototype._setUpWatchAndListeners=function(){return this.scope.$watch("page",function(a){return function(b){return a.pageModel=b,a._setUpScopeHelpers(),a._updateDimensions(),a._checkIfEditable(),a._checkIfRemovable(),a._checkIfEmpty()}}(this)),this.scope.$watch("editable",function(a){return function(b){return a._refreshEditListeners(),a._checkIfEditable()}}(this)),this.scope.$watch("width",function(a){return function(b){return a._updateDimensions()}}(this)),this.scope.$watch("height",function(a){return function(b){return a._updateDimensions()}}(this)),this._setUpInvalidationListeners()},a.prototype._setUpInvalidationListeners=function(){return this.eventBus.subscribe(this.eventBus.events.SURFACE_IMAGE_REMOVED,function(a){return function(b,c){return a._invalidate(null!=c?c.pageNumber:void 0)}}(this),this.scope),this.eventBus.subscribe(this.eventBus.events.SURFACE_IMAGE_ADDED,function(a){return function(b,c){return a._invalidate(null!=c?c.pageNumber:void 0)}}(this),this.scope),this.eventBus.subscribe(this.eventBus.events.SURFACE_BACKGROUND_UPDATED,function(a){return function(b,c){return a._invalidate(null!=c?c.pageNumber:void 0)}}(this),this.scope),this.eventBus.subscribe(this.eventBus.events.SURFACE_LAYOUT_UPDATED,function(a){return function(b,c){return a._invalidate(null!=c?c.pageNumber:void 0,null!=c?c.redrawRequired:void 0)}}(this),this.scope),this.eventBus.subscribe(this.eventBus.events.SURFACE_INVALIDATED,function(a){return function(b,c){return a._invalidate(null!=c?c.pageNumber:void 0,null!=c?c.redrawRequired:void 0)}}(this),this.scope),this.eventBus.subscribe(this.eventBus.events.SURFACE_EMBELLISHMENT_REMOVED,function(a){return function(b,c){return a._invalidate(null!=c?c.pageNumber:void 0)}}(this),this.scope),this.eventBus.subscribe(this.eventBus.events.PROJECT_LOADED,function(a){return function(b,c){return a._handleProjectLoaded()}}(this),this.scope)},a.prototype._handleProjectLoaded=function(){return this.scope.$evalAsync(function(a){return function(){return a._checkIfEmpty()}}(this))},a.prototype._invalidate=function(a,b){var c;if(parseInt(a,10)===parseInt(null!=(c=this.scope.page)?c.surfaceNumber:void 0,10))return this._checkIfEmpty(),b&&this._updateDimensions(),this.scope.$digest()},a.prototype._checkIfOffStage=function(){return!this.scope.activeSpread&&this.scope.bookSpread},a.prototype._renderData=function(){return this.pageRenderAssistant.templateDataWithObjectStyles(this.pageModel,this.scope.width,this.scope.height,this.assetScale)},a.prototype._setUpScopeHelpers=function(){if(!this.scopeHelpersCreated&&null!=this.pageModel)return this.scopeHelpersCreated=!0,this.scope.styleForSoftRender=this.styleProvider.styleForSoftRender,this.scope.dropOptions=function(a){return function(){return null!=a.pageModel&&a.scope.isEditable?{pageNumber:a.pageModel.surfaceNumber}:{}}}(this),this.scope.dragOptions=function(a){return function(){return null!=a.pageModel&&a.scope.isEditable?{pageNumber:a.pageModel.surfaceNumber,useCustomAvatar:!0}:{}}}(this),this.scope.useThumbnails=this.attrs.useThumbnails,this.scope.fillerAsset={type:"filler-asset"},this.scope.dropBackgroundAsset={type:"background"},this.scope.backcoverBarcodeAsset={type:"backcover-barcode"},this.scope.styleForWarning=this.styleProvider.styleForWarning,this.scope.styleForStockCover=this.styleProvider.styleForStockCover,this.scope.isStockCover=this.pageModel.isStockCover,this.scope.dropProxyClassForAsset=this.dropProxyHelper.relatedDropProxyClass,this.jQuery.extend(this.scope,this._renderData()),this.scope.imageAssetURL=function(a){return function(b){return a._checkIfOffStage()&&"uppTemp"===b.data?a.imageURLService.thumbURLForImageAsset(b):a.imageURLService.imageURLForImageAsset(b,a.assetScale)}}(this),this.scope.backgroundSourceURL=function(a){return function(b){return null==b.imageAssignment?b.sourceUrl:a.scope.imageAssetURL(b)}}(this)},a.prototype._setUpScopeProperties=function(){return this.scope.activeAsset=null},a}(),b=function(b,c,d,e,f,g,h,i,j,k,l,m,n){return{restrict:"E",templateUrl:"Project/views/page.html",scope:{page:"=",width:"=",height:"=",onRemoveImage:"&",onRemoveEmbellishment:"&",onRemovePage:"&",onEditText:"&",onEditEvent:"&",onImageDoubleClick:"&",onSelect:"&",onPageDoubleClick:"&",onPageLoad:"&",editable:"=",bookSpread:"=",activeSpread:"=",heightSourceId:"=",priority:"=",devPageData:"=",devData:"="},transclude:!0,link:function(o,p,q){var r;return r=new a(b,c,d,e,f,g,h,i,j,k,l,m,n),r.link(o,p,q)}}},b.$inject=["imageURLService","eventBus","loggerFactory","pageStyleProvider","$translate","imageCollection","uppService","CONFIG","pageRenderAssistant","dropProxyHelper","$window","pageModelStrategy","projectService"],angular.module("galleon").directive("sfPage",b)}.call(this),function(){"use strict";var a,b,c,d=function(a,b){return function(){return a.apply(b,arguments)}};c=void 0,a=function(){function a(a,b,c,e,f,g,h,i,j){this.$http=a,this.$templateCache=b,this.$window=c,this.eventBus=e,this.$compile=f,this.pageRenderAssistant=g,this.config=h,this.styleProvider=i,this.modelStrategy=j,this._handleSurfacesRemoved=d(this._handleSurfacesRemoved,this),this._handleSurfacesAdded=d(this._handleSurfacesAdded,this),this._compileTemplate=d(this._compileTemplate,this),this._data=void 0,this._renderedPage=void 0,this.doT=this.$window.doT}return a.prototype.link=function(a,b,c){var d,e,f;if(this.scope=a,this.element=b,this.attrs=c,this.scope.directive=this,this.liveResize=null!=(null!=(d=this.attrs)?d.liveResize:void 0),this.bgOnly=null!=(null!=(e=this.attrs)?e.backgroundOnlyRender:void 0),this.percentScreenWidth=null!=(f=this.attrs)?f.percentScreenWidth:void 0,this._updateScale(),this._refreshPage(),this._setUpInvalidationListeners(),this.scope.gutterShadowVisible=function(a){return function(b){return a.modelStrategy.gutterShadowVisible(null,null)}}(this),this.scope.$watch("page",function(a){return function(b){return a._updateDimensions()}}(this)),this.liveResize)return this.scope.$watch("width",function(a){return function(b){return a._renderedPage=void 0,a._updateDimensions()}}(this)),this.scope.$watch("height",function(a){return function(b){return a._renderedPage=void 0,a._updateDimensions()}}(this))},a.prototype._updateDimensions=function(){if(this._updateScale(),this._refreshPage(),this.liveResize)return this.scope.$evalAsync()},a.prototype._refreshPage=function(){var a,b;return null!=c?this._renderPage():(b=this.config.advancedArrange?"less-simple-page.html":"simple-page.html",a=this.$http.get("Project/views/"+b,{cache:this.$templateCache}),a.success(this._compileTemplate).error(this._handleTemplateLoadError))},a.prototype._compileTemplate=function(a){return c=this.doT.template(a),this._renderPage()},a.prototype._renderPage=function(){if(null!=this.scope.page&&this.scope.page!==this._renderedPage)return this.liveResize?this._liveResizeRender():this._staticSizeRender(),this._renderedPage=this.scope.page},a.prototype._staticSizeRender=function(){var a;return a=this._angularTemplate(),this.$window.fastdom.write(function(b){return function(){return b.element.empty(),b.element.append(a)}}(this))},a.prototype._liveResizeRender=function(){return this.element.empty(),this.element.append(this._angularTemplate())},a.prototype._angularTemplate=function(){var a;return a=c({data:this._renderData()}),this.$compile(a)(this.scope)},a.prototype._handleTemplateLoadError=function(a){return console.log("Error loading template: ",a)},a.prototype._renderData=function(){var a,b;return b=this.pageRenderAssistant.templateDataWithStringStyles(this.scope.page,this.scope.width,this.scope.height,this.assetScale),a=this.scope.page.layout.assets,b.assets=this.bgOnly?a.filter(function(a){return a.asset.isBackground()}):a,b},a.prototype._updateScale=function(){var a,b,c,d,e,f,g;if(null!=this.scope.page)return c=this.scope.width,!c&&this.percentScreenWidth&&null!=(null!=(e=this.$window)&&null!=(f=e.screen)?f.width:void 0)&&(c=this.$window.screen.width*this.percentScreenWidth),g=this.pageRenderAssistant.resizedDimensions(this.scope.page,c,this.scope.height),d=g.width,b=g.height,this.assetScale=g.assetScale,a=this.element[0],this.$window.fastdom.write(function(){return a.style.width=""+Math.round(d)+"px",a.style.height=""+Math.round(b)+"px"}),this.scope.isCustomizing?this.scope.gutterShadowClass=this.modelStrategy.classForGutterShadow(this.scope.page,!0):void 0},a.prototype._setUpInvalidationListeners=function(){return this.eventBus.subscribe(this.eventBus.events.SURFACE_IMAGE_REMOVED,function(a){return function(b,c){return a._invalidate(null!=c?c.pageNumber:void 0)}}(this),this.scope),this.eventBus.subscribe(this.eventBus.events.SURFACE_IMAGE_ADDED,function(a){return function(b,c){return a._invalidate(null!=c?c.pageNumber:void 0)}}(this),this.scope),this.eventBus.subscribe(this.eventBus.events.SURFACE_BACKGROUND_UPDATED,function(a){return function(b,c){return a._invalidate(null!=c?c.pageNumber:void 0)}}(this),this.scope),this.eventBus.subscribe(this.eventBus.events.SURFACE_LAYOUT_UPDATED,function(a){return function(b,c){return a._invalidate(null!=c?c.pageNumber:void 0)}}(this),this.scope),this.eventBus.subscribe(this.eventBus.events.SURFACE_INVALIDATED,function(a){return function(b,c){return a._invalidate(null!=c?c.pageNumber:void 0)}}(this),this.scope),this.eventBus.subscribe(this.eventBus.events.SURFACE_EMBELLISHMENT_REMOVED,function(a){return function(b,c){return a._invalidate(null!=c?c.pageNumber:void 0)}}(this),this.scope),this.eventBus.subscribe(this.eventBus.events.SURFACES_ADDED,this._handleSurfacesAdded,this.scope),this.eventBus.subscribe(this.eventBus.events.SURFACES_REMOVED,this._handleSurfacesRemoved,this.scope)},a.prototype._handleSurfacesAdded=function(a,b){if(b.toInclusive<this.scope.page.surfaceNumber)return this._invalidate(this.scope.page.surfaceNumber)},a.prototype._handleSurfacesRemoved=function(a,b){if(b.from<=this.scope.page.surfaceNumber&&this.scope.page.surfaceNumber<=b.toInclusive||b.toInclusive<this.scope.page.surfaceNumber)return this._invalidate(this.scope.page.surfaceNumber)},a.prototype._invalidate=function(a){var b;if(parseInt(a,10)===parseInt(null!=(b=this.scope.page)?b.surfaceNumber:void 0,10))return this._renderedPage=void 0,this._updateScale(),this._refreshPage()},a}(),b=function(b,c,d,e,f,g,h,i,j){return{restrict:"E",template:"",scope:{width:"=",height:"=",page:"=",priority:"=",isCustomizing:"="},transclude:!0,link:function(k,l,m){var n;return n=new a(b,c,d,e,f,g,h,i,j),n.link(k,l,m)}}},b.$inject=["$http","$templateCache","$window","eventBus","$compile","pageRenderAssistant","CONFIG","pageStyleProvider","pageModelStrategy"],angular.module("galleon").directive("sfSimplePage",b)}.call(this),function(){"use strict";var a,b;a=function(){function a(a,b,c,d){this.styleProvider=a,this.config=b,this.pageRenderAssistant=c,this.jQuery=d.$}return a.prototype.link=function(a,b,c){return this.scope=a,this.element=b,this.attrs=c,this.scope.directive=this,this.element.children().css("background-color","#fff"),this.element.css("visibility","hidden"),this._updateSize(),this._setUpWatchAndListeners()},a.prototype._updateDimensions=function(){return this._updateSize(),this._updateScale()},a.prototype._updateSize=function(){if(null!=this.scope.width&&null!=this.scope.height)return this.widthAttr=this.scope.width,this.heightAttr=this.scope.height},a.prototype._updateScale=function(){var a,b,c;if(null!=this.pageModel&&null!=this.widthAttr)return this.element.css("visibility","visible"),c=this.pageRenderAssistant.resizedDimensions(this.pageModel,this.widthAttr,this.heightAttr),b=c.width,a=c.height,this.assetScale=c.assetScale,this.element.css("margin-left","auto"),this.element.css("margin-right","auto"),this.scope.assetScale=this.assetScale,this.scope.binderStyle=this.styleProvider.styleForBinder(this.pageModel,this.assetScale),this.scope.binderRingStyle=this.styleProvider.styleForBinderRing(this.pageModel,this.assetScale)},a.prototype._setUpWatchAndListeners=function(){return this.scope.$watch("page",function(a){return function(b){return a.pageModel=b,a._updateDimensions()}}(this)),this.scope.$watch("width",function(a){return function(b){return a._updateDimensions()}}(this)),this.scope.$watch("height",function(a){return function(b){return a._updateDimensions()}}(this))},a}(),b=function(b,c,d,e){return{restrict:"E",templateUrl:"Project/views/binder-ring.html",scope:{page:"=",width:"=",height:"=",editable:"="},transclude:!1,link:function(f,g,h){var i;return i=new a(b,c,d,e),i.link(f,g,h)}}},b.$inject=["pageStyleProvider","CONFIG","pageRenderAssistant","$window"],angular.module("galleon").directive("sfBinderRing",b)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t;this.$scope=a,this.$window=c,this.projectService=d,this.eventBus=e,this.$modal=f,this.$q=g,this.contentService=h,this.config=i,this.internalProjectService=j,this.userService=k,this.galleon=l,this.$timeout=m,this.appState=n,this.$http=o,this.productTrackingStrategy=p,this.deviceDetectionService=q,this.adaptiveLayoutService=r,this.commandService=s,this.getUserInfo=b(this.getUserInfo,this),this.$scope.ctrls.DevCtrl=this,null!=(t=this.$window.Galleon)&&(t.openGalleonDevCtrlPanel=function(a){return function(){return a.openPanel()}}(this)),this.devPanel=null,this.disableDevConsoleItems=this.config.features.disableDevConsoleItems,this.softRender=this.config.features.softRender,null!=this.$window.Clipboard&&angular.isFunction(this.$window.Clipboard)&&new this.$window.Clipboard("#copyGuidBtn"),this.buildNumber=""+this.galleon.buildNumber,this.timeStamp=""+this.galleon.timeStamp,this.browser=bowser,this.android=bowser.android?"true":"false",this.device=this.deviceDetectionService.getDeviceType(),this.ios=bowser.ios?"true":"false",this.eventBus.subscribe(this.eventBus.events.UPP_USER_SIGNIN,function(a){return function(){return a.getUserInfo()}}(this),this.$scope),this.tools=[{name:"Book information",templateUrl:"SilverApp/views/dev/book-info.html"},{name:"Selected page information",templateUrl:"SilverApp/views/dev/page-info.html"},{name:"Application information",templateUrl:"SilverApp/views/dev/app-info.html"},{name:"Config values",templateUrl:"SilverApp/views/dev/config-values.html"},{name:"Export project JSON",templateUrl:"SilverApp/views/dev/show-project-json.html"},{name:"Import project JSON",templateUrl:"SilverApp/views/dev/import-project-json.html"},{name:"Switch language",templateUrl:"SilverApp/views/dev/switch-language.html"},{name:"Change style",templateUrl:"SilverApp/views/dev/change-style.html"},{name:"Project node query",templateUrl:"SilverApp/views/dev/project-query.html"},{name:"Product doctor",templateUrl:"SilverApp/views/dev/product-doctor.html"},{name:"Performance monitor",templateUrl:"SilverApp/views/dev/performance-monitor.html"},{name:"Import favorites",templateUrl:"SilverApp/views/dev/Import-Favorites.html"},{name:"Perfect storm",templateUrl:"SilverApp/views/dev/perfect-storm.html"},{name:"Super Project",templateUrl:"SilverApp/views/dev/super-project.html"}],this.config.virtualAssets&&this.tools.push({name:"Remove grid assets",templateUrl:"SilverApp/views/dev/virtual-assets.html"}),this.activeTool=this.tools[0],this.disableDevConsoleItems||(this.tools.push({name:"Manage projects",templateUrl:"SilverApp/views/dev/manage-projects.html"}),this.tools.push({name:"Selected page XML",templateUrl:"SilverApp/views/dev/page-xml.html"}),this.tools.push({name:"Project XML",templateUrl:"SilverApp/views/dev/project-xml.html"})),this.softRender!==!0||this.disableDevConsoleItems||this.tools.push({name:"Soft render compare",templateUrl:"SilverApp/views/dev/soft-render-compare.html"})}return a.prototype.userIdsMatch=function(){var a,b;return null!=(null!=(a=this.user)?a.id:void 0)&&(null!=(b=this.user)?b.id:void 0)===this.projectService.currentProject.userId},a.prototype.getUserInfo=function(){return this.userService.userInfo().then(function(a){return function(b){return a.user=b}}(this))},a.prototype.openARFTool=function(){this.$window.open(this.config.arfTool,"_blank")},a.prototype.generatePageXML=function(a){var b,c,d,e;return b=this.projectService.currentProject.projectGUID,e=this.projectService.currentProject.userId,d=a,a<0&&(a===-1?d="frontPage":a===-2?d="spinePage":a===-3&&(d="backPage")),c=this.internalProjectService.loadSDXML(e,b,d),c.then(function(a){return function(b){return a.sdxml=b}}(this))},a.prototype.assetCountsByType=function(a){var b,c,d,e,f;for(c={},f=a.layout.assets,d=0,e=f.length;d<e;d++)b=f[d],c[b.asset.assetType]=null!=c[b.asset.assetType]?c[b.asset.assetType]+1:1;return c},a.prototype.generateProjectXML=function(){var a,b,c;return a=this.projectService.currentProject.projectGUID,c=this.projectService.currentProject.userId,b=this.loadProjectXML(c,a),b.then(function(a){return function(b){var c,d,e,f;return a.x2js=new $window.X2JS,c=a.x2js.xml_str2json(b),d=c.feed.details,a.projectxml=a.x2js.json2xml_str(d),e='<![CDATA[<?xml version="1.0" encoding="UTF-8"?>',f="]]>",a.projectxml=a.projectxml.replace(e,"").replace(f,"")}}(this))},a.prototype.loadProjectXML=function(a,b){var c,d;return c=this.$q.defer(),d=this.config.secureAppServer+("/userid/"+a+"/project/"+b),d+="?oflyAppId=00000000000000000000000000000008&oflyForce200=true",d=d+"&X-OPENFLY-Authorization=SFLY%20user-auth="+this.user.openflyToken,this.$http({method:"GET",url:d}).success(function(a,b,d,e){return c.resolve(a)}).error(function(a,b,d,e){var f;return f="Could not load project xml: "+b,c.reject(f)}),c.promise},a.prototype.uppVersion=function(){return this.$window.Shr.Dialogs.UniversalPicker.version},a.prototype.enableCustomize=function(){return this.config.customize=!0,this.$scope.ctrls.MainCtrl.customize=!0},a.prototype.enableStoryboard=function(){return this.config.storyboard=!0,this.$scope.ctrls.StoryboardTabCtrl.storyboardEnabled=!0,this.$scope.ctrls.MainCtrl.storyboardEnabled=!0},a.prototype.enablePaletteSwitching=function(){return this.$scope.ctrls.MainCtrl.switchPalettesEnabled=!0},a.prototype.enableEmbellishments=function(){return this.$scope.ctrls.MainCtrl.features.embellishments=!0,this.$scope.ctrls.PaletteCtrl.embellishmentsFeatureAllowed=!0},a.prototype.getBuildNumber=function(){return this.$window.galleon},a.prototype.docSmithVersion=function(){return this.projectService.currentProject.getReportingValue("docSmithCoreVersion")},a.prototype.showAbout=function(){return this.modalInstance=this.$modal.open({templateUrl:"SilverApp/views/dev/about.html",scope:this.$scope}),this.$timeout(function(a){return function(){return a.hideAbout()}}(this),47e3)},a.prototype.hideAbout=function(){var a;return null!=(a=this.modalInstance)&&a.close(),this.modalInstance=null},a.prototype.openPanel=function(){return this.getUserInfo(),this.devPanel="SilverApp/views/dev/dev-panel.html",this.activeTool=this.tools[0]},a.prototype.closePanel=function(){return this.devPanel=null},a.prototype.getProjectURL=function(){var a;return a=this.productTrackingStrategy.productizeTemplateDirectory(),this.url=""+this.config.secureAppServer+"/forwardingSignin/start.sfly?authTicket="+this.user.openflyToken+"&forwardToURL="+this.config.appServer+"/"+a+"/#/?projectGuid="+this.projectService.currentProject.projectGUID},a.prototype.openProjectViaURL=function(){this.$window.open(this.url,"_blank")},a.prototype.openProjectJSONInNewWindow=function(){var a,b;return a=this.generateProjectJSON(),b=this.$window.open(),b.document.open(),b.document.write("<pre>"+a+"</pre>"),b.document.close()},a.prototype.exportProjectXMLToFile=function(){var a,b,c;return c="application/json;charset=utf-8",a=new Blob([this.generateProjectXML()],{type:c}),b=(this.projectService.currentProject.projectGUID||"project")+".xml",saveAs(a,b)},a.prototype.exportProjectJSONToFile=function(){var a,b,c;return c="application/json;charset=utf-8",a=new Blob([this.generateProjectJSON()],{type:c}),b=(this.projectService.currentProject.projectGUID||"project")+".json",saveAs(a,b)},a.prototype.generateProjectJSON=function(){return JSON.stringify(this.projectService.currentProject.values,null," ")},a.prototype.generatePageJSON=function(a){return JSON.stringify(this.projectService.currentProject.product.pageBySurfaceNumber(a).values,null," ")},a.prototype.displayMMBButton=function(){return"MMB_HIDDEN"===this.projectService.currentProject.product.subtype&&this.user.id===this.projectService.currentProject.userId},a.prototype.makeCopyOfMMBProject=function(){var a;return a=this.projectService.currentProject,a.product.subtype="MMB",a.setInitalReportingValue("originalGUID",a.projectGUID),this.eventBus.publish(this.eventBus.events.PLEASE_WAIT_SHOW),this.userService.userInfo().then(function(a){return function(b){return a.projectService.saveNew(b).then(function(){return a.eventBus.publish(a.eventBus.events.PLEASE_WAIT_HIDE)})}}(this))},a.prototype.applyLayout=function(a,b){return console.log("page",b.layout.type)},a.prototype.createPerfectStorm=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;for(e=this.projectService.currentProject.values.imageCollection,(null!=a?a.withMissingImages:void 0)===!0&&e.projectImages.splice(0,1),k=e.projectImages,g=0,i=k.length;g<i;g++)d=k[g],d.view=d.view.replace(/Xwidth=\d+&/,"Xwidth=NaN"),d.view=d.view.replace(/Xheight=\d+&/,"Xheight=NaN");for(this.projectService.currentProject.imageCollection.init(e,this.projectService.currentProject),l=this.projectService.currentProject.product.allSurfaces,h=0,j=l.length;h<j;h++){f=l[h],m=f.layout.assets;for(c in m)if(b=m[c],("function"==typeof b.hasAssignedImage?b.hasAssignedImage():void 0)===!0)return b.values.imageRectangle.xOffset="NaN",b.values.imageRectangle.yOffset="NaN",void f.init(f.values)}return this.projectService.currentProject.init(this.projectService.currentProject.values)},a.prototype.createSuperbook=function(){return this.commandService.execute("SuperProjectCommand",{styleJSON:this.contentService.currentStyle})},a}(),a.$inject=["$scope","$window","projectService","eventBus","$modal","$q","contentService","CONFIG","internalProjectService","userService","galleon","$timeout","appState","$http","productTrackingStrategy","deviceDetectionService","adaptiveLayoutService","commandService"],angular.module("silverApp").controller("DevCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e,f){this.$scope=a,this.contentService=b,this.layoutService=c,this.contentLayoutFactory=d,this.pageFactory=e,this.projectService=f,this.$scope.ctrls.DevPanelApplyLayoutCtrl=this,this.layoutId=""}return a.prototype.applyLayout=function(a){var b,c,d,e,f;if(!a.isStockCover)return(null!=(f=this.layoutId)?f.length:void 0)>0?(c=this._getFormFactor(a),d=this.contentService.getLayoutByAttributes(this.layoutId,c,this._getLayoutSurfaceTypes(a.surfaceNumber)),null!=d?(b=this.contentLayoutFactory.newInstance(d),this.layoutService.applyToSelectedPage(b)):(e="Could not apply layout "+this.layoutId+". \nPossible reasons:\n1. Could not find layout. \n2. Layout size didn't match the book size \n3. Layout surface type does not match page type. You may have tried to:\n\tapply a cover layout to an inner page\n\tspread to a title page etc.",alert(e))):void 0},a.prototype._getLayoutSurfaceTypes=function(a){switch(a){case this.pageFactory.Page.BACK_COVER_PAGE_NUMBER:return["backcover","ideabackcover"];case this.pageFactory.Page.SPINE_PAGE_NUMBER:return["spine","ideaspine"];case this.pageFactory.Page.FRONT_COVER_PAGE_NUMBER:return["frontcover","ideafrontcover"];case this.pageFactory.Page.TITLE_PAGE_NUMBER:return["page","ideapage","title"];default:return["page","ideapage","title","ideatitle","spread","ideaspread"]}},a.prototype._getFormFactor=function(a){var b;if(null!=a)return b=this.projectService.currentProject.product.sizeId,a.isCover()&&(this.projectService.currentProject.product.cover.isHardCover()&&(b+="hard"),this.projectService.currentProject.product.cover.isSoftCover()&&(b+="soft")),b},a}(),a.$inject="$scope contentService layoutService contentLayoutFactory pageFactory projectService".split(" "),angular.module("silverApp").controller("DevPanelApplyLayoutCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.$scope=a,this.docsmithConversionService=b,this.projectService=c,this.$scope.ctrls.DevChangeStyleCtrl=this,this.styleIdInput=""}return a.prototype.executeChangeStyle=function(){var a;return a="1",this.docsmithConversionService.startChangeStyle(this.projectService.currentProject,this.styleIdInput,a)},a}(),a.$inject=["$scope","docsmithConversionService","projectService"],angular.module("silverApp").controller("DevChangeStyleCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l){this.$scope=a,this.eventBus=c,this.projectService=d,this.internalProjectService=e,this.userService=f,this.$timeout=g,this.navService=h,this.project=i,this.$window=j,this.config=k,this.contentService=l,this._handleSummaries=b(this._handleSummaries,this),this._handleProjectLoad=b(this._handleProjectLoad,this),this.$scope.ctrls.ManageProjectsCtrl=this,this.summaries=[],this.selected=[],this.user={},this.doubleChecking=!1,this.loadFromManageProjects=!1,this.eventBus.subscribe(this.eventBus.events.PROJECT_SUMMARIES,this._handleSummaries,this.$scope),this.eventBus.subscribe(this.eventBus.events.PROJECT_LOADED,this._handleProjectLoad,this.$scope),this._refreshSummaries()}return a.prototype._handleProjectLoad=function(a,b){return this.loadFromManageProjects===!0&&this.navService.gotoPage(1,!0),this.loadFromManageProjects=!1},a.prototype._refreshSummaries=function(){return this.userService.userInfo().then(function(a){return function(b){if(a.user=b,a.user.isLoggedIn)return a.projectService.summaries(a.user.id,"GCP")}}(this))},a.prototype._handleSummaries=function(a,b){var c,d,e,f;for(this.summaries=[],f=b.PaginatedCollection.items,d=0,e=f.length;d<e;d++)c=f[d],this.summaries.push({title:c.title,guid:c.projectGUID});return this.$scope.$digest()},a.prototype.openProject=function(){this.selected.length<1||(this.url=""+this.config.secureAppServer+"/forwardingSignin/start.sfly?authTicket="+this.user.openflyToken+"&forwardToURL="+this.config.appServer+"/pb/#/?projectGuid="+this.selected[0].guid,this.$window.open(this.url,"_blank"))},a.prototype.importProject=function(){var a,b;if(this.projectJSONToLoad)try{return this.loadFromManageProjects=!0,a=this.project.init(angular.fromJson(this.projectJSONToLoad)),this.projectService.currentProject=a,this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,a),this.contentService.setStyleAfterInitialProjectLoad(a)}catch(a){return b=a,console.log("Unable to import project json."),console.log(b)}},a.prototype.deleteProjects=function(){return this.doubleChecking===!0?(this.doubleChecking=!1,this._executeDeleteProjects()):this.doubleChecking=!0},a.prototype._executeDeleteProjects=function(){var a,b;return b=this.selected.map(function(a){return a.guid}).join(","),a=this.user.oAuthToken,this.internalProjectService.deleteProjects(b,a,this.user.id).then(function(a){return function(){
return a.summaries=[],a.selected=[],a.$timeout(function(){return a._refreshSummaries()},0)}}(this))},a}(),a.$inject=["$scope","eventBus","projectService","internalProjectService","userService","$timeout","navService","project","$window","CONFIG","contentService"],angular.module("silverApp").controller("ManageProjectsCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e){this.$scope=a,this.projectService=b,this.navService=c,this.favoritesService=d,this.userService=e,this.$scope.ctrls.ImportFavoritesCtrl=this,this.user={},this.favorites={},this.loadFromImportFavoriteCtrl=!1,this._refreshSummaries()}return a.prototype._refreshSummaries=function(){return this.userService.userInfo().then(function(a){return function(b){if(a.user=b,a.user.isLoggedIn)return a.projectService.summaries(a.user.id,"GCP")}}(this))},a.prototype.importFavorites=function(){if(this.favoritesJSONToImport)return this.favoritesService.fetchFavorites().then(function(a){return function(){var b,c,d,e,f,g,h,i,j,k;a.originMap={},f=null!=(h=a.projectService)&&null!=(i=h.currentProject)&&null!=(j=i.product)?j.sizeId:void 0,b=a._getAspectRatio(),a.origin=a.favoritesService.favoritesContent,k=a.origin;for(d in k)g=k[d],e=d.replace(f,"size").replace(b,"aspectRatio"),a.originMap[e]=g;try{return a.favorites=a.convert(a.originMap,JSON.parse(a.favoritesJSONToImport)),a.favoritesService.updateFavorites(a.favorites)}catch(a){return c=a,console.log("Unable to import favorites."),console.log(c)}}}(this))},a.prototype._getAspectRatio=function(){var a,b,c;return"square"===(null!=(a=this.projectService)&&null!=(b=a.currentProject)&&null!=(c=b.product)?c.aspectRatio:void 0)?"sq":"rec"},a.prototype.convert=function(a,b){var c,d,e,f;for(d=a,c=e=0,f=b.length;0<=f?e<f:e>f;c=0<=f?++e:--e)d[b[c].objectId]=b[c].type;return d},a}(),a.$inject=["$scope","projectService","navService","favoritesService","userService"],angular.module("silverApp").controller("ImportFavoritesCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.$scope=a,this.projectService=b,this.$scope.ctrls.ProjectQueryCtrl=this,this.projectNodeQuery="",this.projectNodeResult="",this.matchingKeys=[],this.matchIndex=-1}return a.prototype.handleKeyUp=function(a){var b,c,d,e;return c=null!=(d=null!=(e=this.projectNodeQuery)?e.split("."):void 0)?d:[],0!==(b=this._getNavDirection(a))?(this.matchIndex+=b,this.matchIndex<0?this.matchIndex=this.matchingKeys.length-1:this.matchIndex>=this.matchingKeys.length&&(this.matchIndex=0),c[c.length-1]=this.matchingKeys[this.matchIndex],this.projectNodeQuery=c.join(".")):this.matchIndex=-1,this.findProjectNode(c)},a.prototype._getNavDirection=function(a){return 38===a.keyCode||37===a.keyCode?-1:40===a.keyCode||39===a.keyCode?1:0},a.prototype.findProjectNode=function(a){var b,c,d,e,f,g,h,i,j,k,l;for(e=this.projectService.currentProject.values,a=a.filter(function(a){return a.length>0}),i=0,k=a.length;i<k;i++)if(g=a[i],null!=e[g])e=e[g];else if("object"==typeof e){try{h=new RegExp(g)}catch(a){b=a,h=new RegExp("")}for(d=Object.keys(e),e=null,this.matchingKeys=[],j=0,l=d.length;j<l;j++)c=d[j],h.test(c)&&this.matchingKeys.push(c);break}return f=null!=e?e:this.matchingKeys,this.projectNodeResult=JSON.stringify(f,null,2)},a}(),a.$inject=["$scope","projectService"],angular.module("silverApp").controller("ProjectQueryCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c,d,e){this.$scope=a,this.$translate=b,this.uppService=c,this.config=d,this.$window=e,this.$scope.ctrls.SwitchLanguageCtrl=this,this.languages=[],this.languages.push({name:"English"}),this.languages.push({name:"Spanish"}),this.selected=[]}return a.prototype.switchLanguage=function(){var a,b,c;if(!(this.selected.length<1)){switch(this.selected[0].name){case"English":b="en";break;case"Spanish":b="es"}return a=this.$window.location.href,c="",c=a.indexOf("?")>-1?a+"&language="+b:a+"?language="+b,this.$window.location=c}},a}(),a.$inject=["$scope","$translate","uppService","CONFIG","$window"],angular.module("silverApp").controller("SwitchLanguageCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h){this.$scope=a,this.eventBus=c,this.projectService=d,this.internalProjectService=e,this.userService=f,this.navService=g,this.appState=h,this._resetOverlays=b(this._resetOverlays,this),this.$scope.ctrls.SoftRenderCompareCtrl=this,this.user={},this.leftRenderPromise=null,this.spineRenderPromise=null,this.rightRenderPromise=null,this._resetOverlays(),this.userService.userInfo().then(function(a){return function(b){return a.user=b}}(this)),this.eventBus.subscribe(this.eventBus.events.SURFACE_SELECTED,this._resetOverlays,this.$scope)}var c,d,e,f;return f="standby",e="load",d="loaded",c="failed",a.prototype._resetOverlays=function(){var a,b,c;return this.appState.dev.softRenderOpacity=1,this.appState.dev.leftPage={softRenderURL:null},this.appState.dev.rightPage={softRenderURL:null},this.appState.dev.spinePage={softRenderURL:null},this.leftRenderState=f,this.spineRenderState=f,this.rightRenderState=f,null!=(a=this.leftRenderPromise)&&"function"==typeof a.resolve&&a.resolve(null),null!=(b=this.spineRenderPromise)&&"function"==typeof b.resolve&&b.resolve(null),null!=(c=this.rightRenderPromise)&&"function"==typeof c.resolve&&c.resolve(null),this.leftRenderPromise=null,this.spineRenderPromise=null,this.rightRenderPromise=null},a.prototype.hasSpine=function(){return this.navService.leftPage.isCover()},a.prototype.confirmProjectExists=function(){var a;return null==(null!=(a=this.projectService.currentProject)?a.projectGUID:void 0)?(alert("Please load an existing project or save the current one."),null):this.projectService.currentProject.projectGUID},a.prototype.renderBook=function(){var a;if(a=this.confirmProjectExists(),null!=a)return this.internalProjectService.renderBook(this.user.id,a,this.projectService.currentProject.product)},a.prototype.renderActiveSpread=function(){var a,b;if(this.leftRenderState!==e&&this.rightRenderState!==e&&this.spineRenderState!==e)return null==(null!=(b=this.projectService.currentProject)?b.projectGUID:void 0)?void alert("Please load an existing project or save the current one."):(a=this.projectService.currentProject.projectGUID,this._renderLeftPage(a),this._renderSpinePage(a),this._renderRightPage(a))},a.prototype._renderLeftPage=function(a){var b;return this.leftRenderState=e,this.leftRenderPromise=this._renderPage(this.navService.leftPage,a),null==this.leftRenderPromise&&(this.leftRenderState=f),null!=(b=this.leftRenderPromise)?b.then(function(a){return function(b){return a.appState.dev.leftPage.softRenderURL=b,a.leftRenderState=null!=b?d:c}}(this)):void 0},a.prototype._renderSpinePage=function(a){var b;return this.spineRenderState=e,this.spineRenderPromise=this._renderPage(this.navService.spinePage,a),null==this.spineRenderPromise&&(this.spineRenderState=f),null!=(b=this.spineRenderPromise)?b.then(function(a){return function(b){return a.appState.dev.spinePage.softRenderURL=b,a.spineRenderState=null!=b?d:c}}(this)):void 0},a.prototype._renderRightPage=function(a){var b;return this.rightRenderState=e,this.rightRenderPromise=this._renderPage(this.navService.rightPage,a),null==this.rightRenderPromise&&(this.rightRenderState=f),null!=(b=this.rightRenderPromise)?b.then(function(a){return function(b){return a.appState.dev.rightPage.softRenderURL=b,a.rightRenderState=null!=b?d:c}}(this)):void 0},a.prototype._renderPage=function(a,b){return null==a||a.isFiller()?null:this.internalProjectService.loadSoftRenderPage(this.user.id,b,this._requestSurfaceNumber(a))},a.prototype._requestSurfaceNumber=function(a){return a.isFrontCover()?"frontPage":a.isBackCover()?"backPage":a.isSpine()?"spinePage":a.surfaceNumber},a}(),a.$inject=["$scope","eventBus","projectService","internalProjectService","userService","navService","appState"],angular.module("silverApp").controller("SoftRenderCompareCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i){this.$scope=a,this.eventBus=c,this.projectService=d,this.userService=e,this.projectValidator=f,this.globalContentService=g,this.adaptiveLayoutService=h,this.layoutFactory=i,this._initCheckups=b(this._initCheckups,this),this.project=void 0,this.user={},this.fixable={},this.fixable[this.projectValidator.constructor.IMAGEID_NOT_ENCODED]=function(a){return function(){return a._fixImageIDNotEncoded()}}(this),this.fixable[this.projectValidator.constructor.LOGO_PAGE_MISMATCH]=function(a){return function(){return a._correctLogoPageMismatch()}}(this),this.fixable[this.projectValidator.constructor.NAN_OFFSET_COORDS]=function(a){return function(){return a._fixNaNOffsetCoords()}}(this),this.issues=[],this.uniqueIssues={},this._initCheckups(),this.eventBus.subscribe(c.events.PROJECT_LOADED,this._initCheckups,this.$scope)}return a.prototype._initCheckups=function(){var a,b,c,d,e;if(this._refreshUser(),null!=this.projectService.currentProject){for(this.project=this.projectService.currentProject,b=this.projectValidator.validate(this.project,{intensity:"thorough"}),this.uniqueIssues={},c=0,d=b.length;c<d;c++)a=b[c],this.uniqueIssues[a.message]=null!=(e=this.uniqueIssues[a.message])?e:[],this.uniqueIssues[a.message].push(a);return this.issues=Object.keys(this.uniqueIssues)}},a.prototype._refreshUser=function(){return this.userService.userInfo().then(function(a){return function(b){return a.user=b}}(this))},a.prototype.fix=function(a){var b;return"function"==typeof(b=this.fixable)[a]?b[a]():void 0},a.prototype._fixNaNOffsetCoords=function(){var a,b,c,d,e,f,g;for(f=this.project.product.allSurfaces,d=0,e=f.length;d<e;d++){c=f[d],g=c.layout.assets;for(b in g)a=g[b],isNaN(a.asset.imageXOffset)&&(a.asset.imageXOffset=0),isNaN(a.asset.imageYOffset)&&(a.asset.imageYOffset=0),isNaN(a.asset.containerXOffset)&&(a.asset.containerXOffset=0),isNaN(a.asset.containerYOffset)&&(a.asset.containerYOffset=0)}return this.project.init(this.project.values),this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.project)},a.prototype._fixImageIDNotEncoded=function(){return this.userService.fetchImageMetadataForImageIds(this._imageIDsToEncode()).then(function(a){return function(b){return a._correctImageIDsWithEncodedMSP(b)}}(this))},a.prototype._correctImageIDsWithEncodedMSP=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(c={},i=0,m=a.length;i<m;i++)h=a[i],c[h.viewId]=h.encodedMspPath;for(q=this.project.product.allSurfaces,j=0,n=q.length;j<n;j++)for(f=q[j],r=f.layout.assets,k=0,o=r.length;k<o;k++)b=r[k],null!=c[b.imageId]&&(b.imageId=c[b.imageId]);for(s=this.project.imageCollection.projectImages,e=l=0,p=s.length;l<p;e=++l)g=s[e],d=this.project.imageCollection.values.projectImages[e],null!=c[g.imageId]&&g.productImageID===parseInt(d.productImageID,10)&&(d.view=d.view.replace("imageID="+g.imageId,"imageID="+c[g.imageId]));return this.project.init(this.project.values),this.eventBus.publish(this.eventBus.events.PROJECT_LOADED,this.project)},a.prototype._imageIDsToEncode=function(){var a,b,c,d,e;for(b={},e=this.uniqueIssues[this.projectValidator.constructor.IMAGEID_NOT_ENCODED],c=0,d=e.length;c<d;c++)a=e[c],b[a.imageId]=!0;return Object.keys(b)},a.prototype._correctLogoPageMismatch=function(){var a,b,c;return c=this.globalContentService.getLogoPageForSize(this.project.product.sizeId),a=c.url.filter(function(a){return"json"===a.repType}),b={assetId:c.layoutId,version:c.version,jsonUrl:a[0].value},this.adaptiveLayoutService._fetchLayoutJson(b).then(function(a){return function(b){var d;return d=a.project.product.logoPage,d.layoutName=c.layoutId,d.layoutVersion=c.version,d.layout=a.layoutFactory.newInstance(b),a.eventBus.publish(a.eventBus.events.PROJECT_LOADED,a.project)}}(this))},a}(),a.$inject=["$scope","eventBus","projectService","userService","projectValidator","globalContentService","adaptiveLayoutService","layoutFactory"],angular.module("silverApp").controller("ProductDoctorCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.$scope=a,this.$timeout=b,this.$scope.ctrls.PerformanceMonitorCtrl=this,this.numWatchers="undetermined.",this.message=""}return a.prototype.countWatchers=function(){return this.numWatchers="counting...",this.watchersMessage="",this.$timeout(function(a){return function(){var b,c,d,e,f,g,h,i,j;return h=$(document.getElementsByTagName("html")),j=[],b=[],c=[],d=[],i=[],e=function(a){a.data().hasOwnProperty("$scope")&&"undefined"==typeof i[a.data().$scope.$id]&&(i[a.data().$scope.$id]=!0,angular.forEach(a.data().$scope.$$watchers,function(b){var e;for(j.push(b),e=0;e<a[0].attributes.length;)g(d[a[0].attributes[e].nodeName],a.data().$scope.$id)&&("undefined"==typeof c[a[0].attributes[e].nodeName]&&(c[a[0].attributes[e].nodeName]=[]),c[a[0].attributes[e].nodeName].push({element:"(Scope "+a.data().$scope.$id+"): "+a[0].outerHTML,element_obj:a[0],element_data:a.data(),relevant_watcher:b,current_value:b.last}),"undefined"==typeof d[a[0].attributes[e].nodeName]&&(d[a[0].attributes[e].nodeName]=[]),d[a[0].attributes[e].nodeName].push(a.data().$scope.$id)),++e})),angular.forEach(a.children(),function(a){e($(a))})},f=function(a,b){return a.indexOf(b)!==-1},g=function(a,b){return"undefined"==typeof a||!f(a,b)},e(h),console.log("+--------------------------------------+\n| Watcher count: "+j.length+"\n|\n| Watched Elements grouped by attribute:\n"),console.log(c),console.log("+--------------------------------------+\n"),a.numWatchers=j.length,a.watchersMessage="See console log for memory distribution."}}(this))},a}(),a.$inject=["$scope","$timeout"],angular.module("silverApp").controller("PerformanceMonitorCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b,c){this.$scope=a,this.navService=b,this.commandService=c,this.$scope.ctrls.VirtualAssetsCtrl=this}return a.prototype.executeRemove=function(){return this.commandService.execute("RemoveEmptyGridAssetsCommand",{activePageNumber:this.navService.selectedPage.surfaceNumber})},a}(),a.$inject=["$scope","navService","commandService"],angular.module("silverApp").controller("VirtualAssetsCtrl",a)}.call(this),function(){"use strict";var a;a=function(){function a(a,b){this.$scope=a,this.config=b,this.$scope.ctrls.ConfigValuesCtrl=this,this.configValues=[],this.getConfigValues()}return a.prototype.getConfigValues=function(){return this.configValues.push({key:"zoom",value:this.config.zoom}),this.configValues.push({key:"startingMonth",value:this.config.startingMonth}),this.configValues.push({key:"startingYear",value:this.config.startingYear}),this.configValues.push({key:"styleId",value:this.config.styleId}),this.configValues.push({key:"styleVersion",value:this.config.styleVersion}),this.configValues.push({key:"coverSpecId",value:this.config.coverSpecId}),this.configValues.push({key:"stockCoverSpecId",value:this.config.stockCoverSpecId}),this.configValues.push({key:"paletteMode",value:this.config.paletteMode}),this.configValues.push({key:"autoSaveTimer",value:this.config.autoSaveTimer}),this.configValues.push({key:"sessionIdleTimeout",value:this.config.sessionIdleTimeout}),this.configValues.push({key:"zoomFactor",value:this.config.zoomFactor}),this.configValues.push({key:"hideUsed",value:this.config.hideUsed}),this.configValues.push({key:"clusterStoryboard",value:this.config.clusterStoryboard}),this.configValues.push({key:"helpOverlay",value:this.config.helpOverlay}),this.configValues.push({key:"highlights",value:this.config.highlights}),this.configValues.push({key:"hideStoryboardIntro",value:this.config.hideStoryboardIntro}),this.configValues.push({key:"hideArrangeIntro",value:this.config.hideArrangeIntro}),this.configValues.push({key:"passiveMode",value:this.config.passiveMode}),this.configValues.push({key:"fade",value:this.config.fade}),this.configValues.push({key:"saveJPG",value:this.config.saveJPG}),this.configValues.push({key:"pinterest",value:this.config.pinterest}),this.configValues.push({key:"preview",value:this.config.preview}),this.configValues.push({key:"hideCustomizeIntro",value:this.config.hideCustomizeIntro}),this.configValues.push({key:"ranIntroTour",value:this.config.ranIntroTour}),this.configValues.push({key:"playButton",value:this.config.playButton}),this.configValues.push({key:"photoccinoSuggestedCrop",value:this.config.photoccinoSuggestedCrop}),this.configValues.push({key:"forceSignIn",value:this.config.forceSignIn}),this.configValues.push({key:"previewText",value:this.config.previewText}),this.configValues.push({key:"photoccinoGetRankBatchSize",value:this.config.photoccinoGetRankBatchSize}),this.configValues.push({key:"initialAutofill",value:this.config.initialAutofill}),this.configValues.push({key:"startupTab",value:this.config.startupTab}),this.configValues.push({key:"afsMode",value:this.config.afsMode}),this.configValues.push({key:"customizeFilters",value:this.config.customizeFilters}),this.configValues.push({key:"superSimple",value:this.config.superSimple}),this.configValues.push({key:"slideshow",value:this.config.slideshow}),this.configValues.push({key:"arrange",value:this.config.arrange}),this.configValues.push({key:"promptOnExit",value:this.config.promptOnExit}),this.configValues.push({key:"calendarSinglePalette",value:this.config.calendarSinglePalette}),this.configValues.push({key:"canOrderFromSlideshow",value:this.config.canOrderFromSlideshow}),this.configValues.push({key:"hideHeaderForSlideshow",value:this.config.hideHeaderForSlideshow}),this.configValues.push({key:"noTextOnCover",value:this.config.noTextOnCover}),this.configValues.push({key:"forceIncrSave",value:this.config.forceIncrSave}),this.configValues.push({key:"startWithFrontCover",value:this.config.startWithFrontCover}),this.configValues.push({key:"allowAutoSave",value:this.config.allowAutoSave}),this.configValues.push({key:"allowHotKeys",value:this.config.allowHotKeys}),this.configValues.push({key:"loadUppOnStart",value:this.config.loadUppOnStart}),this.configValues.push({key:"startupMode",value:this.config.startupMode}),this.configValues.push({key:"customize",value:this.config.customize}),this.configValues.push({key:"switchLanguage",value:this.config.switchLanguage}),this.configValues.push({key:"storyboard",value:this.config.storyboard}),this.configValues.push({key:"smartStoryboard",value:this.config.smartStoryboard}),this.configValues.push({key:"exportToPDF",value:this.config.exportToPDF}),this.configValues.push({key:"uploadThreads",value:this.config.uploadThreads}),this.configValues.push({key:"maxErrorLogs",value:this.config.maxErrorLogs}),this.configValues.push({key:"allowAnonymousUpload",value:this.config.allowAnonymousUpload}),this.configValues.push({key:"styleDialog",value:this.config.styleDialog}),this.configValues.push({key:"tourOnStart",value:this.config.tourOnStart}),this.configValues.push({key:"forceTourOnStart",value:this.config.forceTourOnStart}),this.configValues.push({key:"whatsNewTour",value:this.config.whatsNewTour}),this.configValues.push({key:"advancedArrange",value:this.config.advancedArrange}),this.configValues.push({key:"clearAutofillPrompt",value:this.config.clearAutofillPrompt}),this.configValues.push({key:"spreads",value:this.config.spreads}),this.configValues.push({key:"richSubtypes",value:this.config.richSubtypes}),this.configValues.push({key:"startWithSummary",value:this.config.startWithSummary}),this.configValues.push({key:"isBaconV2",value:this.config.isBaconV2}),this.configValues.push({key:"virtualAssets",value:this.config.virtualAssets}),this.configValues.push({key:"calendarV2",value:this.config.calendarV2}),this.configValues.push({key:"patchSaveInterval",value:this.config.patchSaveInterval}),this.configValues.push({key:"changeStartDate",value:this.config.changeStartDate})},a}(),a.$inject=["$scope","CONFIG"],angular.module("silverApp").controller("ConfigValuesCtrl",a)}.call(this),function(){"use strict";var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c,d,e,f,g,h,i,j,k,l){var m;this.$scope=a,this.eventBus=c,this.$timeout=d,this.appState=e,this.config=f,this.localStorageService=g,this.customizeService=h,this.navService=i,this.hotkeys=j,this.omnitureService=k,this.tabIntroModalService=l,this._handleCustomizeGroupDestroyed=b(this._handleCustomizeGroupDestroyed,this),this._handleCustomizeGroupCreated=b(this._handleCustomizeGroupCreated,this),this._onSurfaceSelected=b(this._onSurfaceSelected,this),this._onBeginCustomizing=b(this._onBeginCustomizing,this),this._handleCustomizeDeleteMode=b(this._handleCustomizeDeleteMode,this),this.hideCustomizeIntro=this.config.hideCustomizeIntro,this.eventBus.subscribe(this.eventBus.events.CUSTOMIZE_MODE_ENTERED,this._onBeginCustomizing,this.$scope),this.eventBus.subscribe(this.eventBus.events.CUSTOMIZE_DELETE_TOGGLED,this._handleCustomizeDeleteMode,this.$scope),this.eventBus.subscribe(this.eventBus.events.CUSTOMIZE_SELECTION_CREATED,this._handleCustomizeGroupCreated,this.$scope),this.eventBus.subscribe(this.eventBus.events.CUSTOMIZE_SELECTION_DESTROYED,this._handleCustomizeGroupDestroyed,this.$scope),this.eventBus.subscribe(this.eventBus.events.SURFACE_SELECTED,this._onSurfaceSelected,this.$scope),this.canAddTextArea=!0,this.canAddPhotoArea=!0,this.canSelectAll=!0,this.shownCustomizeIntro=!1,this.hideCustomizeIntro=this.config.hideCustomizeIntro,this.canAlign=!1,this.canSpaceVert=!1,this.canSpaceHoriz=!1,this.canLayerForward=!1,this.canLayerBackward=!1,this.config.allowHotKeys&&(this.hotkeys.add({combo:"mod+d",description:"Advanced Edit",callback:function(a){return function(b,c){var d;a.config.customize&&(null!=(d=a.$scope.ctrls.NavCtrl)?d.editIsActive:void 0)&&!a.$scope.ctrls.MainCtrl.previewMode&&(a.toggleCustomizeActiveMode(),b.preventDefault())}}(this)}),this.hotkeys.add({combo:"mod+b",description:"Add Text",callback:function(a){return function(b,c){var d;a.config.customize&&(null!=(d=a.$scope.ctrls.NavCtrl)?d.editIsActive:void 0)&&(a.addTextArea(),b.preventDefault())}}(this)}),this.hotkeys.add({combo:"mod+e",description:"Add Photo",callback:function(a){return function(b,c){var d;a.config.customize&&(null!=(d=a.$scope.ctrls.NavCtrl)?d.editIsActive:void 0)&&(a.addPhotoArea(),b.preventDefault())}}(this)}),this.hotkeys.add({combo:"mod+a",description:"Select All",callback:function(a){return function(b,c){var d;a.config.customize&&(null!=(d=a.$scope.ctrls.NavCtrl)?d.editIsActive:void 0)&&(a.selectAll(),b.preventDefault())}}(this)})),this.eventBus.subscribe(this.eventBus.events.PROJECT_LOADED,function(a){return function(){if(a.customizeService.shouldBeginInCustomizeMode)return setTimeout(function(){return a.toggleCustomizeActiveMode()},2e3)}}(this)),null==(m=this.$scope).ctrls&&(m.ctrls={}),this.$scope.ctrls.CustomizeCtrl=this}return a.prototype._handleCustomizeDeleteMode=function(a,b){if(b.inDeleteMode&&this.appState.addBodyClass(this.appState.customize.DELETING_MODE_CLASS),!b.inDeleteMode)return this.appState.removeBodyClass(this.appState.customize.DELETING_MODE_CLASS)},a.prototype._onBeginCustomizing=function(){if(this.appState.cancelBackgroundWaitingForPicture(),this.canAlign=!1,this.omnitureService.trackPageName({pageName:this.omnitureService.ADVANCED_EDIT_PAGE_NAME}),!this.shownCustomizeIntro&&!this.hideCustomizeIntro)return this.shownCustomizeIntro=!0,this.tabIntroModalService.open(this.$scope,"hideCustomizeIntro",{titleKey:"SilverApp.customize.popover.title",bodyKey:"SilverApp.customize.popover.message.active",buttonDtk:"button_customizeIntro_ok",inputDtk:"button_customizeIntro_disable"})},a.prototype._onSurfaceSelected=function(a,b){var c;return c=b,this.canAddTextArea=c.isCustomizable(),this.canAddPhotoArea=c.isCustomizable()},a.prototype.toggleCustomizeActiveMode=function(){return this.appState.cancelBackgroundWaitingForPicture(),this.isCustomizing()?(this.appState.customizeMode=this.appState.customize.NONE,this.omnitureService.trackPageName({pageName:this.omnitureService.EDIT_PAGE_NAME})):(this.appState.customizeMode=this.appState.customize.ACTIVE,this.eventBus.publish(this.eventBus.events.CUSTOMIZE_MODE_ENTERED,{mode:this.appState.customize.ACTIVE}),this._ensureSpineIsNotSelected())},a.prototype._ensureSpineIsNotSelected=function(){if(this.navService.selectedPage.isSpine())return this.navService.setSelectedPage(this.navService.project.product.cover.frontPage)},a.prototype.isCustomizing=function(){return this.appState.isCustomizing()},a.prototype.addTextArea=function(){if(this.canAddTextArea&&this.navService.spinePage!==this.navService.selectedPage)return this.customizeService.prepareApplyTextAreaCommand(this.navService.selectedPage.surfaceNumber)()},a.prototype.addPhotoArea=function(){if(this.canAddPhotoArea&&this.navService.spinePage!==this.navService.selectedPage)return this.customizeService.prepareApplyEmptyWellCommand(this.navService.selectedPage.surfaceNumber)()},a.prototype.saveDoNotShow=function(){return this.localStorageService.add("hideCustomizeIntro",!this.hideCustomizeIntro)},a.prototype.deselectAll=function(){if(this.isCustomizing())return this.eventBus.publish(this.eventBus.events.CUSTOMIZE_MODE_CLICKED_OUT_OF_BOUNDS)},a.prototype._handleCustomizeGroupCreated=function(a,b){return this.$scope.$apply(function(a){return function(){var c,d;return d=a.navService.selectedPage.isSpread()?2:1,c=a.navService.selectedPage.layout.assets.length-d-1,a.canAlign=b.groupSize>1,a.canSpaceVert=b.groupSize>2&&a._hasRoomForSpacing(b.selection,"vertical"),a.canSpaceHoriz=b.groupSize>2&&a._hasRoomForSpacing(b.selection,"horizontal"),a.canLayerForward=1===b.groupSize&&b.index<c,a.canLayerBackward=1===b.groupSize&&0!==b.index,a.canMatch=b.groupSize>1}}(this))},a.prototype._hasRoomForSpacing=function(a,b){return(null!=a||null!=b)&&("vertical"===b?this._objectsLengthSum(a.getObjects(),b)<a.height:"horizontal"===b&&this._objectsLengthSum(a.getObjects(),b)<a.width)},a.prototype._objectsLengthSum=function(a,b){var c,d,e,f,g,h;if(c=0,"vertical"===b)for(e=0,g=a.length;e<g;e++)d=a[e],c+=d.getBoundingRect().height;if("horizontal"===b)for(f=0,h=a.length;f<h;f++)d=a[f],c+=d.getBoundingRect().width;return c},a.prototype._handleCustomizeGroupDestroyed=function(){return this.$scope.$apply(function(a){return function(){return a.canAlign=!1,a.canSpaceVert=!1,a.canSpaceHoriz=!1,a.canLayerForward=!1,a.canLayerBackward=!1,a.canMatch=!1}}(this))},a.prototype.selectAll=function(){return this._conditionallyCallEvent(this.canSelectAll,this.eventBus.events.CUSTOMIZE_SELECT_ALL)},a.prototype.alignLeft=function(){return this._conditionallyCallEvent(this.canAlign,this.eventBus.events.CUSTOMIZE_ALIGN_LEFT)},a.prototype.alignTop=function(){return this._conditionallyCallEvent(this.canAlign,this.eventBus.events.CUSTOMIZE_ALIGN_TOP)},a.prototype.alignRight=function(){return this._conditionallyCallEvent(this.canAlign,this.eventBus.events.CUSTOMIZE_ALIGN_RIGHT)},a.prototype.alignBottom=function(){return this._conditionallyCallEvent(this.canAlign,this.eventBus.events.CUSTOMIZE_ALIGN_BOTTOM)},a.prototype.alignCenter=function(){return this._conditionallyCallEvent(this.canAlign,this.eventBus.events.CUSTOMIZE_ALIGN_CENTER)},a.prototype.alignMiddle=function(){return this._conditionallyCallEvent(this.canAlign,this.eventBus.events.CUSTOMIZE_ALIGN_MIDDLE)},a.prototype.layerForward=function(){return this._conditionallyCallEvent(this.canLayerForward,this.eventBus.events.CUSTOMIZE_LAYER,{direction:"forward"})},a.prototype.layerBackward=function(){return this._conditionallyCallEvent(this.canLayerBackward,this.eventBus.events.CUSTOMIZE_LAYER,{direction:"backward"})},a.prototype.layerFront=function(){return this._conditionallyCallEvent(this.canLayerForward,this.eventBus.events.CUSTOMIZE_LAYER,{direction:"front"})},a.prototype.layerBack=function(){return this._conditionallyCallEvent(this.canLayerBackward,this.eventBus.events.CUSTOMIZE_LAYER,{direction:"back"})},a.prototype.spaceVert=function(){return this._conditionallyCallEvent(this.canSpaceVert,this.eventBus.events.CUSTOMIZE_SPACE,{direction:"vertical"})},a.prototype.spaceHoriz=function(){return this._conditionallyCallEvent(this.canSpaceHoriz,this.eventBus.events.CUSTOMIZE_SPACE,{direction:"horizontal"})},a.prototype.matchTallest=function(){return this._conditionallyCallEvent(this.canMatch,this.eventBus.events.CUSTOMIZE_MATCH,{dimension:"tallest"})},a.prototype.matchShortest=function(){return this._conditionallyCallEvent(this.canMatch,this.eventBus.events.CUSTOMIZE_MATCH,{dimension:"shortest"})},a.prototype.matchWidest=function(){return this._conditionallyCallEvent(this.canMatch,this.eventBus.events.CUSTOMIZE_MATCH,{dimension:"widest"})},a.prototype.matchNarrowest=function(){return this._conditionallyCallEvent(this.canMatch,this.eventBus.events.CUSTOMIZE_MATCH,{dimension:"narrowest"})},a.prototype.matchBoth=function(){return this._conditionallyCallEvent(this.canMatch,this.eventBus.events.CUSTOMIZE_MATCH,{dimension:"both"})},a.prototype._conditionallyCallEvent=function(a,b,c){var d;if(null==c&&(c={}),a)return d=angular.extend(c,{pageNumber:this.navService.selectedPage.surfaceNumber}),this.eventBus.publish(b,d)},a.prototype.isEditSubMenu1Enabled=function(){return this.config.editSubMenu1},a.prototype.editSubMenu1Item2=function(){return alert("Not implemented yet.")},a.prototype.editSubMenu1Item3=function(){return alert("Not implemented yet.")},a.prototype.editSubMenu1Item4=function(){return alert("Not implemented yet.")},a}(),a.$inject=["$scope","eventBus","$timeout","appState","CONFIG","localStorageService","customizeService","navService","hotkeys","omnitureService","tabIntroModalService"],angular.module("silverApp").controller("CustomizeCtrl",a)}.call(this),function(a,b){a.OOo=b()}(this,function(){window.OOo={__detectBrowser:function(a){var b,c="[object Opera]"===Object.prototype.toString.call(window.opera),d={IE:!!b,Opera:c,WebKit:a.indexOf("AppleWebKit/")>-1,Chrome:a.indexOf("Chrome")>-1,Gecko:a.indexOf("Gecko")>-1&&a.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile.*Safari/.test(a),iOs:a.indexOf("iPad")>-1||a.indexOf("iPhone")>-1||a.indexOf("iPod")>-1,iOS67:a.search(/OS 6(.*)|7(.*) like Mac OS/i)>-1,BlackBerry:a.indexOf("BlackBerry")>-1,Fennec:a.indexOf("Fennec")>-1,IEMobile:a.indexOf("IEMobile")>-1,WindowsPhone:a.toLowerCase().indexOf("windows phone")>-1,WindowsTablet:a.toLowerCase().indexOf("windows nt")>-1&&a.toLowerCase().indexOf("touch")>-1,OperaMobile:a.search(/Opera (?:Mobi|Mini)/)>-1,Kindle:a.search(/[ ](Kindle|Silk)/)>-1,isChromeIOS:/crios/i.test(a),ua:a,Android:/Android/.test(a)};return d.isMobile=d.MobileSafari||d.BlackBerry||d.Fennec||d.IEMobile||d.OperaMobile||d.Kindle||d.iOs||d.Android||d.WindowsPhone||d.WindowsTablet,d.isMobileNonIOS=d.isMobile&&!d.iOs,d}},OOo.Browser=OOo.__detectBrowser(navigator.userAgent),OOo.Cache={},OOo.instanceCount=0,OOo.K=function(){};var a=a||OOo;return function(){function a(a){return document.getElementById(a)}function b(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function c(a,b,c,d){a.addEventListener?a.addEventListener(b,c,d):a.attachEvent&&a.attachEvent("on"+b,c)}function d(a,b,c,d){a.removeEventListener?a.removeEventListener(b,c,d):a.detachEvent&&a.detachEvent("on"+b,c)}function e(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b+"="+(encodeURIComponent(a[b])||""));return c.join("&")}function f(a){var b=e(a.metrics),c=a.tealeafId+"|"+a.clickTalePID+"/"+a.clickTaleUID+"/"+a.clickTaleSID;return b+="&custom_var="+OOo.createLegacyVars(a.legacyVariables,c),"OnPage"===a.metrics.type&&(b+="|iframe"),a.asm&&(b+="&asm=2"),b+="&_rev=2",a.customVariables&&(b+="&customVars="+encodeURIComponent(OOo.serialize(a.customVariables))),b}function g(a,b){var c=document,d=c.createElement("form"),e=c.createElement("input"),g=a.referrerRewrite;return a.metrics.referer=location.href,g&&(a.metrics.referer=OOo.referrerRewrite(g)),d.style.display="none",d.method="post",d.target=b||"OnlineOpinion",d.action=a.onPageCard?"https://secure.opinionlab.com/ccc01/comment_card_json_4_0_b.asp?r="+location.href:"https://secure.opinionlab.com/ccc01/comment_card_d.asp",
a.commentCardUrl&&(d.action=a.commentCardUrl,a.onPageCard&&(d.action+="?r="+location.href)),e.name="params",e.value=f(a),d.appendChild(e),c.body.appendChild(d),d}function h(){return{width:screen.width,height:screen.height,referer:location.href,prev:document.referrer,time1:(new Date).getTime(),time2:null,currentURL:location.href,ocodeVersion:"5.9.3"}}function i(a){var b="";if(a&&a.search("://")>-1)for(var c=a.split("/"),d=3;d<c.length;d++)b+="/",b+=c[d];return b}function j(a,b){return a=a||{},"string"==typeof a?b+"|"+a:a.override?a.vars:b+(a.vars?"|"+a.vars:"")}function k(a,b){return b||(b=location),"string"==typeof a?a:a.searchPattern?b.href.replace(a.searchPattern,a.replacePattern):a.replacePattern}function l(a,b){var c=a||window.event;c.preventDefault&&c.stopPropagation?(c.preventDefault(),c.stopPropagation()):c.returnValue=!1;var d=OOo.$("oo_waypoint_container"),e=d.parentNode;e.removeChild(d),b&&b.focus()}function m(){var a=this.options,b="<div id='oo_waypoint_prompt' role='dialogue' aria-describedby='oo_waypoint_message'><div id='oo_company_logo'></div><div id='oo_waypoint_content'><p id='oo_waypoint_message'>Select a category</p><p id='waypoint_icons'></p><p id='ol_brand_logo'><a href='http://www.opinionlab.com/company/' target='_0' aria-label='Powered by OpinionLab. This will open a new window'></a></p></div><a id='oo_close_prompt' href='#' aria-label='Close dialog'><div class='screen_reader'>Close dialogue</div><span aria-hidden='true'>&#10006;</span></a></div><!--[if IE 8]><style>/* IE 8 does not support box-shadow */#oo_waypoint_prompt #oo_waypoint_content { width: 400px; padding: 40px 49px 20px 49px; border: 1px solid #ccc; }</style><![endif]-->";"undefined"!=typeof a.wpmarkup&&(b=a.wpmarkup);var c=OOo.$("oo_waypoint_prompt");if(c){var d=OOo.$("oo_waypoint_container");return void this.showWaypoint(d)}this.showWaypoint(b)}function n(a){var b,c,d,e,f,g=document,h=0,i="string"==typeof a?g.createElement("div"):a,j=g.createElement("div"),k=this.options,l=k.categories,m=g.activeElement;j.id="oo_waypoint_overlay",i.id="oo_waypoint_container",i.style.visibility="hidden","string"==typeof a&&(i.innerHTML=a,g.body.appendChild(i)),i.appendChild(j),k.companyLogo&&k.companySlogan&&(b=new Image,b.src=k.companyLogo,b.alt=k.companySlogan,OOo.$("oo_company_logo").appendChild(b),OOo.$("oo_waypoint_prompt").setAttribute("aria-label",k.companySlogan)),c=new Image,c.src=k.pathToAssets+"oo_opinionlab_logo.png",c.alt="powered by OpinionLab",OOo.$("ol_brand_logo").children[0].appendChild(c),e=OOo.$("oo_close_prompt");for(var n in l)if(l.hasOwnProperty(n)){var o=document.createElement("a"),p=k.categories[n].icon;o.className="waypoint_icon",o.href="#",o.innerHTML=String(n).replace(/_/g," ")+'<span class="screen_reader">This will open a new window</span>',p&&g.addEventListener&&(o.style.backgroundImage="url("+k.pathToAssets+p+")",o.style.backgroundRepeat="no-repeat",o.style.backgroundPosition="left center",o.style.backgroundSize="70px 50px",o.style.textAlign="left",o.style.paddingLeft="90px"),"string"==typeof k.categories[n].oCode?(OOo.addEventListener(o,"click",function(a){return function(b){var c=b||window.event;window.open(k.categories[a].oCode,"_0","scrollbars=yes,location=yes,menubar=yes,resizable=yes"),OOo.hideWaypoint(c,m)}}(n),!1),o.onkeyup=function(a){return function(b){var c=b||window.event;13===c.keyCode&&(window.open(k.categories[a].oCode,"_0","scrollbars=yes,location=yes,menubar=yes,resizable=yes"),OOo.hideWaypoint(c,m))}}(n)):(OOo.addEventListener(o,"click",function(a){return function(b){var c=b||window.event;OOo.Waypoint[a].show(c),OOo.hideWaypoint(c,m)}}(n),!1),o.onkeyup=function(a){return function(b){var c=b||window.event;13===c.keyCode&&(OOo.Waypoint[a].show(c),OOo.hideWaypoint(c,m))}}(n)),h++,OOo.$("waypoint_icons").appendChild(o)}OOo.addEventListener(e,"click",function(a){var b=a||window.event;OOo.hideWaypoint(b,m)},!1),d=OOo.$("waypoint_icons").children,f=d[0],f.onkeydown=function(a){var b=a||window.event;if(9===b.keyCode&&b.shiftKey)return e.focus(),!1},e.onkeyup=function(a){var b=a||window.event;13===b.keyCode&&OOo.hideWaypoint(b,m)},e.onkeydown=function(a){var b=a||window.event;if(9===b.keyCode&&!b.shiftKey)return f.focus(),!1},d[h-1].className="waypoint_icon last",i.style.visibility="visible",i.style.display="block",j.className="no_loading",f.focus()}function o(a,b){var c=a||window.event;c.preventDefault&&c.stopPropagation?(c.preventDefault(),c.stopPropagation()):c.returnValue=!1,OOo.$("oo_container").style.display="none",b&&b.focus()}function p(){var a="<div id='oo_invitation_prompt' role='dialog' aria-describedby='oo_invite_message'><div id='oo_company_logo'></div><div id='oo_invite_content'><p id='oo_invite_message'>After your visit, would you be willing to provide some quick feedback?<br /><br />(It will only take a minute)</p><p class='prompt_button'><a href='#' id='oo_launch_prompt'>Yes<span class='screen_reader'>This will open a new window</span></a></p><p class='prompt_button'><a href='#' id='oo_no_thanks'>No Thanks</a></p><p id='ol_brand_logo'><a href='http://www.opinionlab.com/company/'; target='_0' aria-label='Powered by OpinionLab. This will open a new window'></a></p></div><a id='oo_close_prompt' href='#' aria-label='Close dialog'><div class='screen_reader'>Close dialog</div><span aria-hidden='true'>&#10006;</span></a></div><!--[if IE 8]><style>/* IE 8 does not support box-shadow */#oo_invitation_prompt #oo_invite_content { width: 400px; padding: 40px 49px 20px 49px; border: 1px solid #ccc; }</style><![endif]-->",b=this.options;"undefined"!=typeof b.inviteMarkup&&(a=b.inviteMarkup);var c=OOo.$("oo_invitation_prompt");if(c){var d=OOo.$("oo_container");return void this.showPrompt(d)}this.showPrompt(a)}function q(a,b){var c,d,e,f,g,h,i=document,j="string"==typeof a?i.createElement("div"):a,k=i.createElement("div"),l=this.options,m=i.activeElement;k.id="oo_invitation_overlay",j.id="oo_container",j.style.visibility="hidden","string"==typeof a&&(j.innerHTML=a,i.body.appendChild(j)),j.appendChild(k),e=OOo.$("oo_launch_prompt"),f=OOo.$("oo_no_thanks"),g=OOo.$("oo_close_prompt"),h=OOo.$("oo_company_logo"),l.companyLogo&&l.companySlogan&&(c=new Image,c.src=l.companyLogo,c.alt=l.companySlogan,h.appendChild(c),OOo.$("oo_invitation_prompt").setAttribute("aria-label",l.companySlogan)),d=new Image,d.src=l.pathToAssets+"oo_opinionlab_logo.png",d.alt="powered by OpinionLab",OOo.$("ol_brand_logo").children[0].appendChild(d),l.callBacks&&("function"==typeof l.callBacks.prompt&&l.callBacks.prompt(),"function"==typeof l.callBacks.yesClick&&OOo.addEventListener(e,"click",function(){l.callBacks.yesClick()},!1),"function"==typeof l.callBacks.noClick&&OOo.addEventListener(f,"click",function(){l.callBacks.noClick()},!1),"function"==typeof l.callBacks.closeClick&&OOo.addEventListener(g,"click",function(){l.callBacks.closeClick()},!1)),OOo.addEventListener(e,"click",b.bind(this),!1),OOo.addEventListener(f,"click",function(a){var b=a||window.event;OOo.hidePrompt(b,m)},!1),OOo.addEventListener(g,"click",function(a){var b=a||window.event;OOo.hidePrompt(b,m)},!1),e.onkeyup=function(a){var c=a||window.event;13===c.keyCode&&b.bind(this)}.bind(this),e.onkeydown=function(a){var b=a||window.event;if(9===b.keyCode&&b.shiftKey)return g.focus(),!1},f.onkeyup=function(a){var b=a||window.event;13===b.keyCode&&OOo.hidePrompt(b,m)},g.onkeyup=function(a){var b=a||window.event;13===b.keyCode&&OOo.hidePrompt(b,m)},g.onkeydown=function(a){var b=a||window.event;if(9===b.keyCode&&!b.shiftKey)return e.focus(),!1},j.style.visibility="visible",j.style.display="block",k.className="no_loading",m.blur(),e.focus()}var r=function(){if("Microsoft Internet Explorer"===navigator.appName&&navigator.userAgent.search("MSIE 6")!==-1)return!0;var a,b,c=document.body;return document.createElement&&c&&c.appendChild&&c.removeChild?(a=document.createElement("iframe"),b=!1,a.setAttribute("name","oo_test"),a.style.display="none",c.appendChild(a),b=!document.getElementsByName("oo_test")[0],c.removeChild(a),b):null}();b(OOo,{extend:b,toQueryString:e,addEventListener:c,$:a,appendOOForm:g,removeEventListener:d,createMetrics:h,truncateMetric:i,createLegacyVars:j,DYNAMIC_FRAME_NAME_IS_BUGGY:r,getFormParams:f,referrerRewrite:k,hidePrompt:o,getPrompt:p,showPrompt:q,hideWaypoint:l,getWaypoint:m,showWaypoint:n})}(),function(){function a(b){if(!b)return null;switch(typeof b){case"number":case"boolean":case"function":return b;case"string":return"'"+b+"'";case"object":var c,d,e,f;if(b.constructor===Array||"undefined"!=typeof b.callee){for(c="[",e=b.length,d=0;d<e-1;d+=1)c+=a(b[d])+",";c+=a(b[d])+"]"}else{c="{";for(f in b)b.hasOwnProperty(f)&&(c+=f+":"+a(b[f])+",");c=c.replace(/\,$/,"")+"}"}return c;default:return null}}OOo.extend(OOo,{serialize:a})}(),function(){function a(a,b,c){var d;return a.search(b[0])!==-1?(OOo.createCookie(c,0),!1):!!OOo.readCookie(c)&&(d=parseInt(OOo.readCookie(c),10),a.search(b[d+1])!==-1&&d+1!==b.length-1?(OOo.createCookie(c,d+1),!1):a.search(b[d])===-1&&(d+1===b.length-1&&a.search(b.pop())!==-1?(OOo.eraseCookie(c),!0):(OOo.eraseCookie(c),!1)))}OOo.extend(OOo,{checkTunnel:a})}(),function(){function a(a){var b,c="";for(b=7;b>=0;b-=1)c+="0123456789abcdef".charAt(a>>4*b&15);return c}function b(a){var b,c=(a.length+8>>6)+1,d=new Array(16*c);for(b=0;b<16*c;b+=1)d[b]=0;for(b=0;b<a.length;b+=1)d[b>>2]|=a.charCodeAt(b)<<24-b%4*8;return d[b>>2]|=128<<24-b%4*8,d[16*c-1]=8*a.length,d}function c(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function d(a,b){return a<<b|a>>>32-b}function e(a,b,c,d){return a<20?b&c|~b&d:a<40?b^c^d:a<60?b&c|b&d|c&d:b^c^d}function f(a){return a<20?1518500249:a<40?1859775393:a<60?-1894007588:-899497514}function g(g){var h,i,j,k,l,m,n,o,p=b(g),q=new Array(80),r=1732584193,s=-271733879,t=-1732584194,u=271733878,v=-1009589776;for(n=0;n<p.length;n+=16){for(h=r,i=s,j=t,k=u,l=v,o=0;o<80;o+=1)o<16?q[o]=p[n+o]:q[o]=d(q[o-3]^q[o-8]^q[o-14]^q[o-16],1),m=c(c(d(r,5),e(o,s,t,u)),c(c(v,q[o]),f(o))),v=u,u=t,t=d(s,30),s=r,r=m;r=c(r,h),s=c(s,i),t=c(t,j),u=c(u,k),v=c(v,l)}return a(r)+a(s)+a(t)+a(u)+a(v)}OOo.extend(OOo,{sha1:g})}(),function(){function a(a,b){b||(b=location);var c=a.cookieName||"oo_abandon",d=OOo.readCookie(c),e=a.startPage,f=a.endPage,g=a.middle;return d?b.pathname.indexOf(f)!==-1?(OOo.eraseCookie(c),!1):b.pathname.search(g)===-1&&(OOo.eraseCookie(c),!0):(b.pathname.indexOf(e)!==-1&&OOo.createCookie(c),!1)}OOo.extend(OOo,{checkAbandonment:a})}(),function(){function a(a){var b,c;for(b=a.length-1;b>=0;b-=1)if(a[b].read){if(c=OOo.readCookie(a[b].name),c&&c===a[b].value)return!0;if("undefined"==typeof a[b].value&&OOo.readCookie(a[b].name))return!0}return!1}function b(a){var b;for(b=a.length-1;b>=0;b-=1)a[b].set&&OOo.createCookie(a[b].name,a[b].value,a[b].expiration)}OOo.extend(OOo,{checkThirdPartyCookies:a,setThirdPartyCookies:b})}(),OOo.extend(Function.prototype,function(){function a(a,b){for(var c=a.length,d=b.length;d;)d-=1,a[c+d]=b[d];return a}function b(b,c){return b=d.call(b,0),a(b,c)}function c(a){if(arguments.length<2&&"undefined"==typeof a)return this;var c=this,e=d.call(arguments,1);return function(){var d=b(e,arguments);return c.apply(a,d)}}if("undefined"==typeof Function.prototype.bind){var d=Array.prototype.slice;return{bind:c}}}()),function(){function a(a){a||(a=location);var b;if(a.host.search(/\.[a-z]+/)!==-1){if(b=a.host.split(".").reverse(),b.length>3)return a.host;b="."+b[1]+"."+b[0]}else b=a.host;return b}function b(b,c,d){var e="",f="";d&&(e=new Date,e.setTime(e.getTime()+1e3*d),f="; expires="+e.toGMTString()),location.host!==a()?document.cookie=b+"="+c+f+"; path=/; domain="+a()+";":document.cookie=b+"="+c+f+"; path=/;"}function c(a){var b,c,d=a+"=",e=document.cookie.split(";");for(c=0;c<e.length;c+=1){for(b=e[c];" "===b.charAt(0);)b=b.substring(1,b.length);if(0===b.indexOf(d))return b.substring(d.length,b.length)}return null}function d(a){b(a,"",-1)}OOo.extend(OOo,{getCookieDomain:a,createCookie:b,readCookie:c,eraseCookie:d})}(),OOo.Ocode=function(a){var b,c=OOo.Browser;a.disableMobile&&c.isMobile||a.disableNoniOS&&c.isMobileNonIOS||(OOo.instanceCount+=1,this.options={tealeafCookieName:"TLTSID"},OOo.extend(this.options,a),b=this.options,b.metrics=OOo.createMetrics(),this.frameName=b.onPageCard?"OnlineOpinion"+OOo.instanceCount:"OnlineOpinion",b.cookie&&OOo.Ocode.matchUrl(b.cookie,location)||b.thirdPartyCookies&&OOo.checkThirdPartyCookies(b.thirdPartyCookies)||b.abandonment&&!OOo.checkAbandonment(b.abandonment)||b.tunnel&&!OOo.checkTunnel(location.pathname,b.tunnel.path,b.tunnel.cookieName)||(b.events&&b.events.onSingleClick&&(this.singProbability=Math.random()<1-b.events.onSingleClick/100),b.tealeafId=OOo.readCookie(b.tealeafCookieName)||OOo.readCookie(b.sessionCookieName),b.events&&(this.setupEvents(),(b.events.disableLinks||b.events.disableFormElements)&&this.setupDisableElements()),b.floating?this.floating():b.bar?this.bar():b.tab&&this.tab()))},OOo.Ocode.prototype={show:function(a,b){var c=a||window.event;if("exit"!==b&&"entry"!==b&&(c.preventDefault&&c.stopPropagation?(c.preventDefault(),c.stopPropagation()):c.returnValue=!1),!this.onPageCardVisible){var d,e=this.options;if(e.events&&e.events.prompt&&(e.cookie&&OOo.eraseCookie(e.cookie.name||"oo_r"),OOo.hidePrompt()),!this.interruptShow&&(this.floatingLogo||!e.cookie||!OOo.Ocode.matchUrl(e.cookie))&&(e.floating||!e.events||!this.singProbability)){if(e.events&&e.events.onSingleClick&&(this.singProbability=!0),e.cookie&&OOo.Ocode.tagUrl(e.cookie),e.thirdPartyCookies){if(OOo.checkThirdPartyCookies(e.thirdPartyCookies))return;OOo.setThirdPartyCookies(e.thirdPartyCookies)}this.floatingLogo&&this.floatingLogo.children[0].blur(),this.floatingLogo&&e.disappearOnClick&&(this.floatingLogo.style.display="none"),e.clickTalePID&&"function"==typeof window.ClickTale&&(e.clickTaleUID=window.ClickTaleGetUID(),e.clickTaleSID=window.ClickTaleGetSID()),e.onPageCard&&!OOo.Browser.isMobile?this.setupOnPageCC():this.launchOOPopup(),d=e.floating||e.tab||e.bar,d&&"function"==typeof d.onClickCallback&&d.onClickCallback()}}}},OOo.extend(OOo.Ocode,{tagUrl:function(a,b){b||(b=location);var c=a.name||"oo_r",d="page"===a.type?b.href:b.hostname,e=OOo.readCookie(c)||"";OOo.Ocode.matchUrl(a,b)||OOo.createCookie(c,e+OOo.sha1(d),a.expiration)},matchUrl:function(a,b){b||(b=location);var c,d=OOo.readCookie(a.name||"oo_r");return!!d&&(c="page"===a.type?b.href:b.hostname,d.search(OOo.sha1(c))!==-1)}}),function(){function a(){var a,c,d=this.options,e=d.newWindowSize||[545,325],f=[parseInt((d.metrics.height-e[1])/2,10),parseInt((d.metrics.width-e[0])/2,10)],g="resizable=yes,location=no,status=no,scrollbars=1,width="+e[0]+",height="+e[1]+",top="+f[0]+",left="+f[1],h="OnlineOpinion";d.newWindow&&(h+=b++),d.metrics.time2=(new Date).getTime(),d.metrics.type="Popup",a=OOo.appendOOForm(d,h);var i="https://secure.opinionlab.com/ccc01/comment_card_d.asp?"+a.children[0].value;d.commentCardUrl&&(i=d.commentCardUrl),OOo.Browser.isChromeIOS&&(h="_0"),OOo.Browser.isMobile&&OOo.Browser.ua.search("Android")!==-1?a.submit():(c=window.open(i,h,g),c&&!OOo.Browser.isChromeIOS&&a.submit())}var b=0;OOo.extend(OOo.Ocode.prototype,{launchOOPopup:a})}(),function(){function a(){var a,b,c,d,e=this.options.events,f=[!1,!1],g=["onExit","onEntry"],h="beforeunload";for(OOo.Browser.Opera&&(h="unload"),OOo.Browser.iOs&&(h="pagehide"),e.prompt&&OOo.extend(this.options,{promptMarkup:e.prompt.promptMarkup||"oo_event_prompt.html",neverShowAgainButton:!1,pathToAssets:e.prompt.pathToAssets}),b=g.length-1;b>=0;b-=1)if(a=g[b],e[a]instanceof Array)for(c=e[a],d=c.length;d&&!f[b];)d-=1,window.location.href.search(c[d].url)!==-1&&Math.random()>=1-c[d].p/100&&(f[b]=!0);else e[a]&&Math.random()>=1-e[a]/100&&(f[b]=!0);f[0]&&OOo.addEventListener(window,h,function(a){var b=a||window.event;this.show(b,"exit")}.bind(this),!1),f[1]&&(e.delayEntry?window.setTimeout(function(a){var b=a||window.event;e.prompt?this.getPrompt():this.show(b,"entry")}.bind(this),1e3*e.delayEntry):e.prompt?this.getPrompt():function(a){var b=a||window.event;this.show(b,"entry")}.bind(this)())}function b(a){for(var b=(a||window.event,a.target||a.srcElement),c=this.options.events,d=b.parentNode,e=5,f=0;d&&("A"!==b.nodeName||"INPUT"!==b.nodeName)&&f!==e;)"A"===d.nodeName&&(b=d),d=d.parentNode,f+=1;!c.disableFormElements||"INPUT"!==b.tagName&&"BUTTON"!==b.tagName||"submit"!==b.type&&"image"!==b.type&&"reset"!==b.type&&"button"!==b.type||(this.interruptShow=!0),!c.disableLinks||"A"!==b.nodeName&&"AREA"!==b.nodeName||"http"!==b.href.substr(0,4)||b.href.search(c.disableLinks)===-1||(this.interruptShow=!0)}function c(a){this.interruptShow=!0}function d(){if(OOo.addEventListener(document.body,"mousedown",b.bind(this)),this.options.events.disableFormElements){var a,d=document.getElementsByTagName("form");for(a=d.length-1;a>=0;a-=1)OOo.addEventListener(d[a],"submit",c.bind(this))}}OOo.extend(OOo.Ocode.prototype,{setupEvents:a,setupDisableElements:d,getPrompt:function(){OOo.getPrompt.call(this)},showPrompt:function(a){this.options.cookie&&OOo.Ocode.tagUrl(this.options.cookie),OOo.showPrompt.call(this,a,this.show)}})}(),OOo.extend(OOo.Ocode.prototype,{floating:function(){function a(a){return a.offsetLeft+a.offsetWidth}function b(b){d.style.left=a(n)+"px"}var c,d,e,f,g=document,h=this.floatingLogo=document.createElement("div"),i=g.createElement("div"),j=g.createElement("div"),k=g.createElement("div"),l=g.createElement("span"),m=this.options.floating,n=OOo.$(m.contentId),o="10px",p=m.id,q=g.createElement("span"),r=0;if(q.innerHTML="Screen reader users: Please switch to forms mode for this link.",q.className="screen_reader",p&&(h.id=p),h.className="oo_feedback_float",j.className="oo_transparent",i.className="olUp",k.className="olOver",i.tabIndex=0,i.onkeyup=function(a){c=a||window.event,13===c.keyCode&&this.show(c)}.bind(this),i.innerHTML=m.caption||"Feedback",h.appendChild(q),h.appendChild(i),l.innerHTML=m.hoverCaption||"Click here to<br>rate this page",k.appendChild(l),h.appendChild(k),h.appendChild(j),m.position&&m.position.search(/Content/)&&n){switch(d=this.spacer=g.createElement("div"),e=OOo.Browser.WebKit?g.body:g.documentElement,d.id="oo_feedback_fl_spacer",d.style.left=a(n)+"px",g.body.appendChild(d),m.position){case"rightOfContent":f=function(b){h.style.left=a(n)-e.scrollLeft+"px"};break;case"fixedPreserveContent":f=function(b){var c=OOo.Browser.IE?g.body.clientWidth:window.innerWidth,d=e.scrollLeft;c<=a(n)+h.offsetWidth+parseInt(o,10)?h.style.left=a(n)-d+"px":(h.style.left="",h.style.right=o)};break;case"fixedContentMax":f=function(b){var c=OOo.Browser.IE?g.body.clientWidth:window.innerWidth;c<=a(n)+h.offsetWidth+parseInt(o,10)?(h.style.left="",h.style.right=o):(h.style.left=a(n)-e.scrollLeft+"px",h.style.right="")}}window.setTimeout(f,0),OOo.addEventListener(window,"scroll",f,!1),OOo.addEventListener(window,"resize",f,!1),OOo.addEventListener(window,"resize",b,!1)}else h.style.right=o;h.onkeyup=function(a){var b=a||window.event;13===b.keyCode&&this.show(b)}.bind(this),OOo.Browser.isMobile&&"ontouchstart"in window?(h.ontouchstart=function(a){var b=a||window.event;b.preventDefault&&b.stopPropagation?(b.preventDefault(),b.stopPropagation()):b.returnValue=!1,r++}.bind(this),h.ontouchend=function(a){var b=a||window.event;r>=2&&(this.show(b),r=0)}.bind(this)):h.onclick=function(a){var b=a||window.event;this.show(b)}.bind(this),g.body.appendChild(h)},removeFloatingLogo:function(){document.body.removeChild(this.floatingLogo),this.spacer&&document.body.removeChild(this.spacer)}}),OOo.extend(OOo.Ocode.prototype,{bar:function(){function a(a){var b=0,c=0;if(a.offsetParent){do b+=a.offsetLeft,c+=a.offsetTop;while(a==a.offsetParent);return[b,c]}}function b(b){var c,e=document.activeElement;e&&(c=a(e),c&&c[1]+e.clientHeight>(window.innerHeight||document.body.clientHeight)+(window.pageYOffset||document.body.scrollTop)-d.clientHeight&&(navigator.appVersion.indexOf("MSIE 7.")!==-1?window.scrollBy(0,0):window.scrollBy(0,e.clientHeight+20)))}var c=document,d=this.floatingLogo=c.createElement("a"),e=(c.documentElement.scrollTop||c.body.scrollTop,c.createElement("span")),f=this.options,g=0,h=c.createElement("span");e.innerHTML="Launches comment card in new window",e.className="screen_reader",h.className="icon",this.reflowBar=OOo.K,d.id="oo_bar",d.href="#",d.innerHTML=f.bar.caption||"Feedback",d.appendChild(e),d.appendChild(h),"number"==typeof f.tabIndex?d.tabIndex=f.tabIndex:d.tabIndex=0,d.onkeyup=function(a){var b=a||window.event;13===b.keyCode&&this.show(b)}.bind(this),OOo.Browser.isMobile&&"ontouchstart"in window?(d.ontouchstart=function(a){var b=a||window.event;b.preventDefault&&b.stopPropagation?(b.preventDefault(),b.stopPropagation()):b.returnValue=!1,g++}.bind(this),d.ontouchend=function(a){var b=a||window.event;g>=2&&(this.show(b),g=0)}.bind(this)):d.onclick=function(a){var b=a||window.event;this.show(b)}.bind(this),document.body.className+=document.body.className<1?"oo_bar":" oo_bar",document.body.appendChild(d),OOo.addEventListener(document.body,"keyup",b,!1)}}),OOo.extend(OOo.Ocode.prototype,{tab:function(){var a=document,b=this.floatingLogo=a.createElement("div"),c=a.createElement("div"),d=a.createElement("div"),e=a.createElement("span"),f=this.options.tab,g=a.createElement("a"),h="Feedback",i=f.tabType,j="right",k=0;switch(i){case 1:var l=a.createElement("span");b=this.floatingLogo=a.createElement("a"),c=a.createElement("span"),b.href="#",b.id="oo_tab_"+i,f.position&&(j=f.position),b.className=tabClass="oo_tab_"+j+"_"+i,c.className="screen_reader",l.className="icon","number"==typeof f.tabIndex?b.tabIndex=f.tabIndex:b.tabIndex=0,f.verbiage&&(h=f.verbiage),b.innerHTML=h,c.innerHTML="Launches comment card in new window",b.appendChild(c),b.appendChild(l),setTimeout(function(){b.className+=" small"},2500);break;default:b.id="oo_tab",b.className="oo_tab_"+(f.position||j),f.wcagBasePath&&(b.className+=" wcag"),"number"==typeof f.tabIndex?b.tabIndex=f.tabIndex:"undefined"==typeof f.tabIndex&&(b.tabIndex=0),d.appendChild(g),b.appendChild(d),d.appendChild(e),b.appendChild(d),c&&(c.className="screen_reader",c.innerHTML="Activate to launch comment card",b.appendChild(c))}b.onkeyup=function(a){var b=a||window.event;13===b.keyCode&&this.show(b)}.bind(this),OOo.Browser.isMobile&&"ontouchstart"in window?(b.ontouchstart=function(a){var b=a||window.event;b.preventDefault&&b.stopPropagation?(b.preventDefault(),b.stopPropagation()):b.returnValue=!1,k++}.bind(this),b.ontouchend=function(a){var b=a||window.event;k>=2&&(this.show(b),k=0)}.bind(this)):b.onclick=function(a){var b=a||window.event;this.show(b)}.bind(this),a.body.appendChild(b)}}),OOo.extend(OOo.Ocode.prototype,{setupOnPageCC:function(){function a(a){return a&&a.preventDefault&&a.preventDefault(),document.body.focus(),n.tabIndex=-1,n.title="empty",n["aria-hidden"]="true",h.style.display="none",h.className="",g.body.removeChild(i),window.postMessage?OOo.removeEventListener(window,"message",d):window.clearInterval(c),r=!1,s.onPageCardVisible=!1,!1}var b,c,d,e,f,g=document,h=OOo.Cache.overlay||g.createElement("div"),i=this.wrapper=g.createElement("div"),j=g.createElement("a"),k=g.createElement("div"),l=g.createElement("span"),m=this.frameName,n=g.createElement(OOo.DYNAMIC_FRAME_NAME_IS_BUGGY?'<iframe name="'+m+'">':"iframe"),o=g.createDocumentFragment(),p=this.options,q=p.onPageCard,r=!1,s=this,t=g.createElement("span");d=OOo.Ocode.postMessageHandler(function(c){var d,e,j=parseInt(c,10);if(j>0){if(r)return;r=!0,d=window.innerHeight||g.documentElement.clientHeight||g.body.clientHeight,e=j,f=i.offsetTop,e+f>d&&(e=d-40-f),n.style.width="555px",k.style.width="555px",n.style.height=e+"px",i.style.visibility="visible",l.clientHeight<20&&(l.style.height=i.offsetHeight+"px"),h.className="no_loading",s.onPageCardVisible=!0,b&&g.body.removeChild(b)}else"submitted"===c&&a();OOo.Browser.IE&&"BackCompat"===g.compatMode&&window.scrollTo(0,0)},s.options.commentCardUrl),p.metrics.type="OnPage",OOo.Cache.overlay=h,h.id="oo_overlay",h.style.display="block",h.className="",k.className="iwrapper",i.className="oo_cc_wrapper",i.setAttribute("role","alert"),i.setAttribute("aria-describedby","comment_card_description"),t.className="screen_reader",t.id="comment_card_description",t.innerHTML="Please leave your feedback in the comment card you just activated",i.appendChild(t),j.className="oo_cc_close",j.innerHTML='<span class="screen_reader">Close dialog</span><span aria-hidden="true">&#10006;</span>',j.title=p.closeTitle?p.closeTitle:"Close dialog",g.addEventListener||(k.style.outline="1px solid #cdcdcd"),i.style.visibility="hidden",j.tabIndex=0,j.onkeyup=function(b){var c=b||window.event;13===c.keyCode&&a()},OOo.Browser.IE&&(n.frameBorder="0",window.XMLHttpRequest&&"BackCompat"!==g.compatMode||(e=Math.max(g.documentElement.clientWidth,g.body.offsetWidth),h.style.position="absolute",h.style.width="BackCompat"===g.compatMode?e-21+"px":e+"px",h.style.height=Math.max(g.documentElement.clientHeight,g.body.offsetHeight)+"px",i.style.position="absolute",OOo.addEventListener(window,"scroll",function(){h.style.top=g.body.scrollTop+document.body.clientHeight-h.clientHeight+"px",i.style.top=g.body.scrollTop+f+25+"px"}))),OOo.addEventListener(j,"click",a),q.closeWithOverlay&&!OOo.Browser.isMobile&&(i.appendChild(l),l.onclick=a,h.onclick=a),n.src=" ",n.name=m,n.title="Comment Card",k.appendChild(j),k.appendChild(n),i.appendChild(k),o.appendChild(i),o.appendChild(h),g.body.appendChild(o),window.postMessage?OOo.addEventListener(window,"message",d):c=setInterval(d,500),p.metrics.time2=(new Date).getTime(),b=OOo.appendOOForm(p,m),b.submit()}}),OOo.extend(OOo.Ocode,{postMessageHandler:function(a,b,c){return function(d){var e,f="https://secure.opinionlab.com";return c||(c=location),!(d&&d.origin!==f&&0===d.origin.indexOf(b)||!d&&c.hash.search("OL=")===-1)&&(e=d?d.data:c.hash.split("=").pop(),!d&&location.hash&&(location.hash=""),a(e),e)}}}),OOo.Invitation=function(a){this.options={tunnelCookie:"oo_inv_tunnel",repromptTime:604800,responseRate:50,repromptCookie:"oo_inv_reprompt",promptMarkup:"oo_inv_prompt.html",promptStyles:"oo_inverstitial_style.css",percentageCookie:"oo_inv_percent",pagesHitCookie:"oo_inv_hit",popupType:"popunder",promptDelay:0,neverShowAgainButton:!1,loadPopupInBackground:!1,truncatePrevCurrentMetrics:!1,disablePrevCurrentMetrics:!1,tealeafCookieName:"TLTSID",monitorWindow:"oo_inv_monitor.html",companySlogan:"We value your opinion",beforePrompt:OOo.K,callBacks:{prompt:"",yesClick:"",noClick:"",closeClick:""},inviteMarkup:"<div id='oo_invitation_prompt' role='dialog' aria-describedby='oo_invite_message'><div id='oo_company_logo'></div><div id='oo_invite_content'><p id='oo_invite_message'>After your visit, would you be willing to provide some quick feedback?<br /><br />(It will only take a minute)</p><p class='prompt_button'><a href='#' id='oo_launch_prompt'>Yes<span class='screen_reader'>This will open a new window</span></a></p><p class='prompt_button'><a href='#' id='oo_no_thanks'>No Thanks</a></p><p id='ol_brand_logo'><a href='http://www.opinionlab.com/company/'; target='_0' aria-label='Powered by OpinionLab. This will open a new window'></a></p></div><a id='oo_close_prompt' href='#' aria-label='Close dialog'><div class='screen_reader'>Close dialog</div><span aria-hidden='true'>&#10006;</span></a></div><!--[if IE 8]><style>/* IE 8 does not support box-shadow */#oo_invitation_prompt #oo_invite_content { width: 400px; padding: 40px 49px 20px 49px; border: 1px solid #ccc; }</style><![endif]-->"},this.popupShown=!1,OOo.extend(this.options,a);var b=this.options,c=parseInt(OOo.readCookie(b.pagesHitCookie),10)||0;OOo.Invitation.friendlyDomains=b.friendlyDomains||null;var d={weight:Number(OOo.readCookie("oo_OODynamicRewrite_weight")),searchPattern:OOo.readCookie("oo_OODynamicRewrite_searchPattern"),replacePattern:OOo.readCookie("oo_OODynamicRewrite_replacePattern")};if(OOo.eraseCookie("oo_OODynamicRewrite_weight"),OOo.eraseCookie("oo_OODynamicRewrite_searchPattern"),OOo.eraseCookie("oo_OODynamicRewrite_replacePattern"),(!window.OOoDynamicRewrite||window.OOoDynamicRewrite.weight<d.weight)&&(window.OOoDynamicRewrite=d),window.OOoDynamicRewrite&&"number"==typeof window.OOoDynamicRewrite.weight&&!isNaN(window.OOoDynamicRewrite.weight)&&(OOo.createCookie("oo_OODynamicRewrite_weight",window.OOoDynamicRewrite.weight),window.OOoDynamicRewrite.searchPattern&&OOo.createCookie("oo_OODynamicRewrite_searchPattern",window.OOoDynamicRewrite.searchPattern),window.OOoDynamicRewrite.replacePattern&&OOo.createCookie("oo_OODynamicRewrite_replacePattern",window.OOoDynamicRewrite.replacePattern)),location.search.search("evs")===-1&&"yes"!==OOo.readCookie("oo_evs_friendly")||(OOo.eraseCookie("oo_evs_friendly"),b.loadPopupInBackground=!0,this.launchPopup(),OOo.createCookie(b.repromptCookie,1,b.repromptTime===-1?0:b.repromptTime)),setTimeout(function(){window.oo_inv_monitor&&(b.area&&location.href.search(b.area)===-1?(this.options.popupType="popup",this.launchPopup()):b.goal&&location.href.search(b.goal)!==-1&&window.oo_inv_monitor.close())}.bind(this),1600),!(OOo.readCookie(b.repromptCookie)||b.thirdPartyCookies&&OOo.checkThirdPartyCookies(b.thirdPartyCookies))){if(OOo.readCookie(b.percentageCookie)||OOo.createCookie(b.percentageCookie,Math.random()>1-b.responseRate/100?"1":"0"),"undefined"!=typeof b.promptTrigger)if(b.promptTrigger instanceof RegExp){if(!window.location.href.match(b.promptTrigger))return}else if(b.promptTrigger instanceof Array&&!OOo.checkTunnel(location.pathname,b.promptTrigger,b.tunnelCookie))return;c+=1,OOo.createCookie(b.pagesHitCookie,c),b.pagesHit&&c<b.pagesHit||(OOo.eraseCookie(b.tunnelCookie),"1"===OOo.readCookie(b.percentageCookie)&&window.setTimeout(function(){OOo.createCookie(b.repromptCookie,1,b.repromptTime),this.options.beforePrompt(),this.getPrompt()}.bind(this),1e3*b.promptDelay))}},OOo.Invitation.notifyFriendlyLocationChange=function(a){window.oo_inv_monitor&&OOo.createCookie("oo_evs_friendly","yes")},OOo.Invitation.prototype={getPrompt:function(){OOo.getPrompt.call(this)},showPrompt:function(a){OOo.showPrompt.call(this,a,this.launchPopup)},launchPopup:function(a){if(!this.popupShown){this.popupShown=!0;var b=a||window.event;b.preventDefault&&b.stopPropagation?(b.preventDefault(),b.stopPropagation()):b.returnValue=!1;var c,d,e,f=this.options,g=(window.location.href,"popup"===f.popupType?"https://secure.opinionlab.com/ccc01/comment_card.asp?":f.pathToAssets+f.monitorWindow+"?time1="+(new Date).getTime()+"&"),h=f.asm?[555,500]:OOo.Browser.Chrome?[400,400]:[400,350],i=OOo.createMetrics(),j=OOo.readCookie(f.tealeafCookieName);f.clickTalePID&&window.ClickTaleGetUID&&window.ClickTaleGetSID&&(j+="|"+[f.clickTalePID,window.ClickTaleGetUID(),window.ClickTaleGetSID()].join("/")),h=f.newWindowSize||h,e="scrollbars=1,resizable=1,location=no,status=no,width="+h[0]+",height="+h[1],f.referrerRewrite&&(i.referer=OOo.referrerRewrite(f.referrerRewrite)),f.truncatePrevCurrentMetrics&&(i.prev=OOo.truncateMetric(i.prev),i.currentURL=OOo.truncateMetric(i.currentURL)),f.disablePrevCurrentMetrics&&(i.prev="",i.currentURL=""),f.thirdPartyCookies&&OOo.setThirdPartyCookies(f.thirdPartyCookies),c=OOo.toQueryString(i)+"&type=Invitation",f.customVariables&&(c+="&customVars="+encodeURIComponent(OOo.serialize(f.customVariables))),c+="&custom_var="+OOo.createLegacyVars(f.legacyVariables,j),f.asm&&(c+="&asm=2",e+=",scrollbars=1"),g+=c,2===g.match(/\?/g).length&&(g=g.replace(/\?([^?]*)$/,"&$1")),this.popup=d=window.open(g,"OnlineOpinionInvitation",e),!f.loadPopupInBackground&&OOo.$("oo_container")&&OOo.hidePrompt(b),f.chromeSurveyPrompt&&setTimeout(function(a){d.postMessage(f.chromeSurveyPrompt,"*")},500)}},killPrompt:function(a){var b=a||window.event;this.options.callBacks&&"function"==typeof this.options.callBacks.noClick&&this.options.callBacks.noClick(),OOo.createCookie(this.options.repromptCookie,1,15768e4),OOo.hidePrompt(b)}},OOo.extend(OOo.Invitation,{navigateToFriendlyDomain:function(a){location.href=a}}),OOo.Waypoint=function(a){var b=OOo.Browser;
if(!(a.disableMobile&&b.isMobile||a.disableNoniOS&&b.isMobileNonIOS)){this.options={pathToAssets:"/onlineopinionV5/",waypointMarkup:"oo_waypoint.html",companySlogan:"Give us feedback",companyLogo:"waypoint_logo.png",categories:{website:{tealeafCookieName:"TLTSID",waypointIcon:"waypoint_icon.png"},store:{referrerRewrite:{searchPattern:/:\/\//,replacePattern:"://store."},tealeafCookieName:"TLTSID",waypointIcon:"waypoint_icon.png"},product:{referrerRewrite:{searchPattern:/:\/\//,replacePattern:"://product."},tealeafCookieName:"TLTSID",waypointIcon:"waypoint_icon.png"},other:{referrerRewrite:{searchPattern:/:\/\//,replacePattern:"://other."},tealeafCookieName:"TLTSID",waypointIcon:"waypoint_icon.png"}},wpmarkup:"<div id='oo_waypoint_prompt' role='dialogue' aria-describedby='oo_waypoint_message'><div id='oo_company_logo'></div><div id='oo_waypoint_content'><p id='oo_waypoint_message'>Select a category</p><p id='waypoint_icons'></p><p id='ol_brand_logo'><a href='http://www.opinionlab.com/company/' target='_0' aria-label='Powered by OpinionLab. This will open a new window'></a></p></div><a id='oo_close_prompt' href='#' aria-label='Close dialog'><div class='screen_reader'>Close dialogue</div><span aria-hidden='true'>&#10006;</span></a></div><!--[if IE 8]><style>/* IE 8 does not support box-shadow */#oo_waypoint_prompt #oo_waypoint_content { width: 400px; padding: 40px 49px 20px 49px; border: 1px solid #ccc; }</style><![endif]-->"},OOo.extend(this.options,a);var c=this.options,d=c.categories;for(var e in d)if(d.hasOwnProperty(e)&&"object"==typeof c.categories[e].oCode){var f={};f[e]=new OOo.Ocode(d[e].oCode),OOo.extend(OOo.Waypoint,f)}OOo.extend(OOo.Waypoint,{getWaypoint:function(){this.getWaypoint()}.bind(this)})}},OOo.Waypoint.prototype={getWaypoint:function(){OOo.getWaypoint.call(this)},showWaypoint:function(a){OOo.showWaypoint.call(this,a)},killWaypoint:function(a){var b=a||window.event;OOo.hideWaypoint(b)}},OOo.extend(OOo,{appendWaypoint:function(a){var b=OOo.$(a);if(b)if(OOo.Browser.isMobile){var c=0;"ontouchstart"in window?(OOo.addEventListener(b,"touchstart",function(a){var b=a||window.event;b.preventDefault&&b.stopPropagation?(b.preventDefault(),b.stopPropagation()):b.returnValue=!1,c++},!1),OOo.addEventListener(b,"touchend",function(a){a||window.event;c>=2&&(OOo.Waypoint.getWaypoint(),c=0)},!1)):OOo.addEventListener(b,"click",function(a){var b=a||window.event;b.preventDefault&&b.stopPropagation?(b.preventDefault(),b.stopPropagation()):b.returnValue=!1,OOo.Waypoint.getWaypoint()},!1)}else OOo.addEventListener(b,"click",function(a){var b=a||window.event;b.preventDefault&&b.stopPropagation?(b.preventDefault(),b.stopPropagation()):b.returnValue=!1,OOo.Waypoint.getWaypoint()},!1),OOo.addEventListener(b,"keydown",function(a){var b=a||window.event;b.preventDefault&&b.stopPropagation?(b.preventDefault(),b.stopPropagation()):b.returnValue=!1,13===b.keyCode&&OOo.Waypoint.getWaypoint()},!1)}}),OOo}),function(a,b){"use strict";b.oo_launch=function(a,c){var d=a||window.event;b[c].show(d)},b.inlineFeedbackShow=function(a){b.oo_feedback=new b.Ocode({customVariables:{atgRecSessionId:OOo.readCookie("atgRecSessionId"),atgRecVisitorId:OOo.readCookie("atgRecVisitorId"),xdVisitorId:OOo.readCookie("xdVisitorId"),JSESSIONID:OOo.readCookie("JSESSIONID"),GUID:"undefined"!=typeof window.parsedValue&&"undefined"!=typeof window.parsedValue[0].GUID?window.parsedValue[0].GUID:"",UID:"undefined"!=typeof window.parsedValue&&"undefined"!=typeof window.parsedValue[0].UID?window.parsedValue[0].UID:"",subtype:"undefined"!=typeof window.parsedValue&&"undefined"!=typeof window.parsedValue[0].subtype?window.parsedValue[0].subtype:""}}),console.log(b.oo_feedback),b.oo_launch(a,"oo_feedback")}}(window,OOo),function(){"use strict";var a,b,c,d,e,f,g,h,i,j;(new window.GlobalErrorHandler).interceptErrors(window),g="pb",d=function(a){var b,c;return a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search),null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))},g=null!=(h=window.location)&&null!=(i=h.pathname)?i.split("/")[1]:void 0,g="pb"===g||"gc"===g||"ss"===g?g:"pb",e=d("product"),null!=e&&""!==e&&(g=e),window.logApplicationLoad=function(a,b){var c,d,e,f;return null==a&&(a="pageLoad"),null==b&&(b="Bootstrap"),f="/application",f+="gc"===g?"/groundhog.gif":"/silver.gif",e=(new Date).getTime(),c=""+window.bowser.name+window.bowser.version,d="time="+e+"&level=METRIC&uid=anon&pguid=&browser="+c+"&msg="+a+"&name="+b+"&success=true&clientStartTime="+window.galleon.startTime+"&duration="+(e-window.galleon.startTime),$.get(""+f+"?"+d)},"undefined"!=typeof window&&null!==window&&null!=(j=window.document)&&j.body.classList.add("product-"+g),logApplicationLoad(),c=new window.Env($),f=function(a){var b,c;return b=a[g],c=$.extend(!0,{},a,b)},a=function(a){var b;return b=document.createElement("script"),b.src=a,document.body.appendChild(b)},b=function(){var b,d,e,h,i,j,k,l,m,n,o,p,q;e=$.extend({},c.config,c.queryParams);try{d=null!=(k="undefined"!=typeof window&&null!==window&&null!=(l=window.frameElement)?l.id:void 0)?k:"",i=null!=(m="undefined"!=typeof window&&null!==window&&null!=(n=window.galleon)&&null!=(o=n.context)?o.config:void 0)?m:"undefined"!=typeof window&&null!==window&&null!=(p=window.parent)&&null!=(q=p.galleon)&&null!=(j=q.context)?j["config_"+d]:void 0,"object"==typeof i&&$.extend(!0,e,i)}catch(a){}return b=f(e),h=function(){return angular.module("galleon").constant("_CONFIG_JSON",b),angular.bootstrap(document,["silverApp","galleon-"+g])},window.shouldUseSuperSimple="iPad"===bowser.name||bowser.tablet||"iPhone"===bowser.name||bowser.android||window.innerWidth<=640,window.shouldUseSuperSimple?h():null!=window.onCustomizeServiceLoaded||"@@uuid"===window.galleon.uuid?h():(window.onCustomizeServiceLoaded=h,a(""===window.galleon.uuid?"scripts/optional.customize.app.js":""+b.cdnServer+"/pb/builds/"+window.galleon.uuid+"/scripts/optional.customize.app.js"))},c.load({success:function(){return setTimeout(b)},error:function(){return null}},window.translations.cachedConfig)}.call(this),angular.module("silverApp").run(["$templateCache",function(a){"use strict";a.put("Common/views/please-wait.html",'<div class="modal-width-xsmall modal-content"><div class="modal-body"><div class="please-wait-spinner"></div><span class="please-wait-label">{{::\'please.wait\'|translate}}</span><div ng-if=":: ctrls.PleaseWaitCtrl.data.determinate"><progressbar max="ctrls.PleaseWaitCtrl.maxProgress" value="ctrls.PleaseWaitCtrl.currentProgress"></progressbar></div></div></div>'),a.put("Common/views/rotation-blocker.html",'<div class="orientation-blocker"><div class="blocker-message">{{::\'SilverApp.rotationMessage\'|translate}}</div></div>'),a.put("Common/views/session-ended-modal.html",'<div class="modal-width-medium-small-2 modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.session.timeout.title\'|translate}}</span></div><div class="modal-body"><span translate="">SilverApp.sessionTimeout1</span> <span translate="">SilverApp.sessionTimeout2</span> <a ng-click="ctrls.IdleTimeoutCtrl.gotoMyProjects()">My Projects</a> <span translate="">SilverApp.sessionTimeout3</span></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.IdleTimeoutCtrl.gotoMyShutterfly()" data-test-key="button_movepage_modal_ok">{{::\'SilverApp.session.timeout.goToStore\'|translate}}</button></div></div>'),a.put("Common/views/storytelling-cap-modal.html",'<div class="modal-defaults storytelling-cap-modal modal-content modal-width-medium" data-test-key="storytelling-cap-modal" movemodal=""><div class="modal-header storytelling-cap-header"><i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_storytelling_cap_modal_xclose" ng-click="ctrls.SimpleModalCtrl.cancel()"></i> <span class="modal-header-title">{{::\'SilverApp.storytellingCapTitle\'|translate}}</span></div><div class="modal-body"><div>{{::\'SilverApp.storytellingCapMessage1\'|translate}}</div><br><div class="storytelling-cap-message">{{::\'SilverApp.storytellingCapMessage2\'|translate}}</div><div class="storytelling-icon"></div></div></div>'),a.put("Palette/views/backgrounds-toolbar.html",'<div ng-click="ctrls.BackgroundsCtrl.addRealPictureAsBackground()" ng-if="ctrls.MainCtrl.config.realPictureAsBackground" omniture="" linkname="Backgrounds: Add photo as background" class="pull-right palette-header-text clickable" data-test-key="button_backgrounds_addphotoasbackground"><span class="icon icon-right-padded icon-pab"></span> <span>{{::\'SilverApp.usePhotoAsBackground\'|translate}}</span></div><div ng-click="ctrls.PaletteCtrl.showExtendedPalette(\'backgrounds\')" omniture="" linkname="Backgrounds: Get more backgrounds" class="pull-right palette-header-text clickable" data-test-key="button_backgrounds_extendedpalette"><span class="icon icon-right-padded icon-add-tray"></span> <span>{{::\'Palette.extended.button\'|translate}}</span> <span>{{::\'Palette.extended.backgrounds.lowercase\'|translate}}</span></div>'),a.put("Palette/views/backgrounds.html",'<div class="palette-subpalette palette-subpalette--no-border" ng-if="ctrls.MainCtrl.project" ng-controller="BackgroundsCtrl"><div ng-if="ctrls.MainCtrl.customize" class="ext-palette-search ext-palette-search-core" ng-class="{\'ext-palette-search-active\' : ctrls.ExtendedPaletteCtrl.searchKeywords != \'\'}"><i class="ext-palette-search-icon ext-palette-search-icon-core" ng-click="ctrls.PaletteCtrl.search(\'backgrounds\')"></i><input data-test-key="ext-palette-searchText" placeholder="{{\'Palette.backgrounds\'|translate | postfixTranslate:\'Palette.extended.searchText\'}}" ng-keyup="$event.keyCode == 13 ? ctrls.PaletteCtrl.search(\'backgrounds\') : null" ng-model="ctrls.PaletteCtrl.searchKeywords" ng-class="{\'ext-palette-search-active\' : ctrls.PaletteCtrl.searchKeywords != \'\'}"><i class="ext-palette-clear-search-left ext-palette-clear-search-core" ng-show="ctrls.PaletteCtrl.disableFilters" data-test-key="ext-palette-clear-search-icon" ng-click="ctrls.PaletteCtrl.clearSearch()"></i></div><div class="palette-subpalette backgrounds-subpalette clearfix" ng-class="{\'backgrounds-subpalette-pab\': ctrls.MainCtrl.config.realPictureAsBackground}" ng-include="\'Palette/views/backgrounds-toolbar.html\'" ng-if="ctrls.MainCtrl.features.extendedPalette && ctrls.BackgroundsCtrl.backgrounds.length"></div></div><scroll-synchronizer watch-on="ctrls.BackgroundsCtrl.forceScroll" action-when="ctrls.NavCtrl.editIsActive && ctrls.PaletteCtrl.PaletteTabSelection.backgrounds" pad-left="120" pad-top="120" target-elements-classifier=".selected" class="palette-body backgrounds-tab allowHorizontalScroll palette-{{ctrls.MainCtrl.project.product.aspectRatio}}" ng-class="{\'backgrounds-tab-top\':ctrls.MainCtrl.customize, \'backgrounds-tab-pab\': ctrls.MainCtrl.config.realPictureAsBackground}" data-test-key="palette_backgrounds"><ul class="list-unstyled clearfix" ng-class="{\'palette-body-4-wide\': ctrls.PaletteCtrl.calendarPaletteMode}" ng-mouseleave="ctrls.BackgroundsCtrl.itemHover = null"><li class="custom-background-item clickable" ng-if="ctrls.MainCtrl.config.realPictureAsBackground == false &&\n                   ctrls.NavCtrl.selectedPage.isInnerPage()" ng-click="ctrls.BackgroundsCtrl.addPictureAsBackground()" ng-mouseenter="ctrls.BackgroundsCtrl.itemHover = ctrls.BackgroundsCtrl.pabAsset;" ng-mousedown="ctrls.BackgroundsCtrl.itemHover = null;"><div id="_pab-asset-id" class="add-pab-icon" sf-draggable="" drag-asset="ctrls.BackgroundsCtrl.pabAsset" location="palette"></div></li><li ng-repeat="background in ctrls.BackgroundsCtrl.extPaletteItems track by background.assetId" data-test-key="{{::\'background_\' + background.assetId}}" ng-class="{\'hide\': background.assetId==ctrls.BackgroundsCtrl.markedAsRemoveItemId}"><div class="palette-renderer-wrapper palette-renderer-wrapper--extended" ng-mouseenter="ctrls.BackgroundsCtrl.itemHover = background;" ng-mousedown="ctrls.BackgroundsCtrl.itemHover = null;" palette-renderer="background" ng-class="{\'selected\': (background.assetId == ctrls.BackgroundsCtrl.selectedBackgroundId)}"><img width="{{background.previewWidth}}" sf-priority-src="background.thumbUrl" sf-priority="priority" sf-priority-onload="src" height="{{background.previewHeight}}" class="bkgs palette-item" id="{{::\'_\' + background.assetId}}" ng-click="ctrls.BackgroundsCtrl.applyWithoutScroll($index, ctrls.BackgroundsCtrl.extPaletteItems )" sf-draggable="" drag-asset="background" location="palette"/><div ng-if="ctrls.BackgroundsCtrl.utilsService.isPremium(background.assetId)" class="content-storytelling"></div><i class="removable-handler" ng-click="ctrls.BackgroundsCtrl.onRemoveFromProject(background.assetId);ctrls.BackgroundsCtrl.itemHover = null; ctrls.BackgroundsCtrl.markedAsRemoveItemId = background.assetId" data-test-key="button_ep_embellishment_remove"></i></div></li><li class="extended-separator" ng-if="ctrls.BackgroundsCtrl.extPaletteItems.length > 0" ng-mouseenter="ctrls.EmbellishmentsCtrl.itemHover = null;"></li><li ng-repeat="background in ctrls.BackgroundsCtrl.backgrounds track by background.assetId" data-test-key="{{::\'background_\' + background.assetId}}"><div class="palette-renderer-wrapper" ng-mouseenter="ctrls.BackgroundsCtrl.itemHover = background;" ng-mousedown="ctrls.BackgroundsCtrl.itemHover = null;" palette-renderer="background" ng-class="{\'selected\': (background.assetId == ctrls.BackgroundsCtrl.selectedBackgroundId)}"><div id="{{::\'_\' + background.assetId}}" class="bkgs palette-item" ng-click="ctrls.BackgroundsCtrl.applyWithoutScroll($index, ctrls.BackgroundsCtrl.backgrounds)" sf-draggable="" drag-asset="background" location="palette"></div></div></li><li ng-if="(!ctrls.BackgroundsCtrl.backgrounds.length) && ctrls.NavCtrl.selectedPage.isCover()" class="no-palette-for-page-container"><div class="no-palette-for-page" translate="">Palette.NoItemForCover</div></li></ul></scroll-synchronizer><positionable ng-if="ctrls.BackgroundsCtrl.itemHover" delay="{{ctrls.MainCtrl.hoverDelay}}" target="#_{{ctrls.BackgroundsCtrl.itemHover.assetId}}" placement="right" h-spacing="10" v-spacing="-70" width="{{ctrls.BackgroundsCtrl.itemHover.previewWidth}}" height="{{ctrls.BackgroundsCtrl.itemHover.previewHeight}}" z-index="1200" class="shadow-box"><div id="palette-preview-container" class="preview-container" data-test-key="div_background_preview_{{ctrls.BackgroundsCtrl.itemHover.assetId}}" ng-if="ctrls.BackgroundsCtrl.itemHover && ctrls.BackgroundsCtrl.itemHover.assetId"><div class="palette-wrapper" ng-style="{width: ctrls.BackgroundsCtrl.itemHover.previewWidth + \'px\'}"><div ng-if="ctrls.BackgroundsCtrl.utilsService.itemHasPrice(ctrls.BackgroundsCtrl.itemHover.assetId)"><div class="premium-ribbon-stripe"></div><div class="premium-ribbon-img"></div><div class="premium-text" ng-if="!ctrls.BackgroundsCtrl.utilsService.pricingService.shouldChargeForPremiumItems">{{::\'Palette.extended.noCharge\'|translate}}</div><div class="premium-text" ng-if="ctrls.BackgroundsCtrl.utilsService.pricingService.shouldChargeForPremiumItems" ng-bind="ctrls.BackgroundsCtrl.utilsService.getItemPrice(ctrls.BackgroundsCtrl.itemHover.assetId) | postfixTranslate:\'Palette.extended.popupItemPrice\'"></div></div><img class="preview-image" sf-priority-src="ctrls.BackgroundsCtrl.itemHover.previewUrl" sf-priority="priority" sf-priority-watch="true" sf-priority-onload="src"/></div></div></positionable>'),a.put("Palette/views/bottom-toolbar.html",'<nav class="navbar navbar-default navbar-footer-pagesView navbar-footer-pagesView-arrange" ng-if="ctrls.MainCtrl.config.isBaconV2 && ctrls.MainCtrl.superSimple"><div ng-controller="PriceCtrl" ng-show="project != null"><sf-pricing-receipt page-count="project.product.pages.length" description-id="project.product.descriptionId" is-enabled="!ctrls.OrderCtrl.orderAndInUpsellModal" book-pricing="bookPricing"></sf-pricing-receipt></div><a ng-hide="!ctrls.PaletteCtrl.canAddMorePhotos()" ng-click="ctrls.UppCtrl.showUPP()">{{::\'SilverApp.addPhotos\' | translate}}</a></nav>'),a.put("Palette/views/embellishments.html",'<div class="palette-subpalette palette-subpalette--no-border" ng-if="ctrls.MainCtrl.project && ctrls.MainCtrl.customize" ng-controller="EmbellishmentsCtrl" ng-class="{\'filters-align-center\' : ctrls.PaletteCtrl.isDualPaletteMode, \'filter-align-center--hidden\': (!ctrls.EmbellishmentsCtrl.activeFilter.objects.length) && ctrls.NavCtrl.selectedPage.isCover()}" ng-show="ctrls.EmbellishmentsCtrl.showFilters"><div class="ext-palette-search ext-palette-search-core" ng-class="{\'ext-palette-search-active\' : ctrls.ExtendedPaletteCtrl.searchKeywords != \'\'}"><i class="ext-palette-search-icon ext-palette-search-icon-core" ng-click="ctrls.PaletteCtrl.search(\'embellishments\')"></i><input data-test-key="ext-palette-searchText" placeholder="{{\'Palette.embellishments\'|translate | postfixTranslate:\'Palette.extended.searchText\'}}" ng-keyup="$event.keyCode == 13 ? ctrls.PaletteCtrl.search(\'embellishments\') : null" ng-model="ctrls.PaletteCtrl.searchKeywords" ng-class="{\'ext-palette-search-active\' : ctrls.PaletteCtrl.searchKeywords != \'\'}"><i class="ext-palette-clear-search-left ext-palette-clear-search-core" ng-show="ctrls.PaletteCtrl.disableFilters" data-test-key="ext-palette-clear-search-icon" ng-click="ctrls.PaletteCtrl.clearSearch()"></i></div><div class="btn-group btn-group-sm"><button ng-repeat="option in ctrls.EmbellishmentsCtrl.filterOptions track by option.dataTestKey" type="button" class="btn btn-link-layouts" ng-class="{\'filters-in-dual-palette\' : ctrls.PaletteCtrl.isDualPaletteMode, \'filters-in-single-palette\' : !ctrls.PaletteCtrl.isDualPaletteMode}" ng-model="ctrls.EmbellishmentsCtrl.selectedFilterIndex" btn-radio="$index" data-test-key="{{option.dataTestKey}}" translate="">{{option.text}}</button></div><div ng-click="ctrls.PaletteCtrl.showExtendedPalette(\'embellishments\')" omniture="" linkname="Embellishments: Get more stickers" class="pull-right palette-header-text emb-extpalette-button clickable" data-test-key="button_embellishments_extendedpalette"><span class="icon icon-right-padded icon-add-tray"></span> <span>{{::\'Palette.extended.button\'|translate}}</span> <span>{{ctrls.EmbellishmentsCtrl.filterOptions[ctrls.EmbellishmentsCtrl.selectedFilterIndex].textMore | translate}}</span></div></div><scroll-synchronizer watch-on="ctrls.EmbellishmentsCtrl.forceScroll" action-when="ctrls.NavCtrl.editIsActive && ctrls.PaletteCtrl.PaletteTabSelection.embellishments" pad-left="120" pad-top="120" target-elements-classifier=".selected" ng-class="{\'embellishments-tab-top\':ctrls.MainCtrl.customize}" class="palette-body embellishments-tab allowHorizontalScroll" data-test-key="palette_embellishments"><ul class="list-unstyled clearfix" ng-class="{\'palette-body-4-wide\': ctrls.PaletteCtrl.calendarPaletteMode}" ng-mouseleave="ctrls.EmbellishmentsCtrl.itemHover = null"><li ng-repeat="embellishment in ctrls.EmbellishmentsCtrl.activeFilter.extPaletteItems track by embellishment.assetId" data-test-key="{{::\'embellishment_\' + embellishment.assetId}}" ng-class="{\'hide\': embellishment.assetId==ctrls.EmbellishmentsCtrl.markedAsRemoveItemId}"><div class="palette-renderer-wrapper palette-renderer-wrapper--extended" ng-mouseenter="ctrls.EmbellishmentsCtrl.itemHover = embellishment;" ng-mousedown="ctrls.EmbellishmentsCtrl.itemHover = null;" palette-renderer="embellishment" ng-class="{\'selected\': ($index == ctrls.EmbellishmentsCtrl.selectedEmbellishmentIndex)}"><img id="{{::\'_\' + embellishment.assetId}}" class="embs palette-item" sf-priority-src="embellishment.thumbUrl" sf-priority="priority" sf-priority-onload="src" ng-click="ctrls.EmbellishmentsCtrl.apply($index, ctrls.EmbellishmentsCtrl.activeFilter.extPaletteItems)" width="{{embellishment.previewWidth + \'px\'}}" height="{{embellishment.previewHeight + \'px\'}}" sf-draggable="" drag-asset="embellishment" location="palette"/><div ng-if="ctrls.EmbellishmentsCtrl.utilsService.isPremium(embellishment.assetId)" class="content-storytelling"></div><i class="removable-handler" ng-click="ctrls.EmbellishmentsCtrl.onRemoveFromProject(embellishment.assetId);ctrls.EmbellishmentsCtrl.itemHover = null; ctrls.EmbellishmentsCtrl.markedAsRemoveItemId = embellishment.assetId" data-test-key="button_ep_embellishment_remove"></i></div><div ng-if="embellishment.assetType === \'frame\'" class="palette-label-two-lines">{{embellishment.colorName}} {{embellishment.thickness | capitalize}}&nbsp;<div class="palette-label-two-lines__additional-details" ng-if="embellishment.thickness !== \'none\'">{{::\'Palette.line\'|translate}}</div></div></li><li class="extended-separator" ng-if="ctrls.EmbellishmentsCtrl.activeFilter.extPaletteItems.length > 0" ng-mouseenter="ctrls.EmbellishmentsCtrl.itemHover = null;"></li><li ng-repeat="embellishment in ctrls.EmbellishmentsCtrl.activeFilter.objects track by embellishment.assetId" data-test-key="{{::\'embellishment_\' + embellishment.assetId}}"><div class="palette-renderer-wrapper" ng-mouseenter="ctrls.EmbellishmentsCtrl.itemHover = embellishment;" ng-mousedown="ctrls.EmbellishmentsCtrl.itemHover = null;" palette-renderer="embellishment" ng-class="{\'selected\': ($index == ctrls.EmbellishmentsCtrl.selectedEmbellishmentIndex)}"><div id="{{::\'_\' + embellishment.assetId}}" class="embs palette-item" ng-click="ctrls.EmbellishmentsCtrl.apply($index, ctrls.EmbellishmentsCtrl.activeFilter.objects)" sf-draggable="" drag-asset="embellishment" location="palette"></div></div><div ng-if="embellishment.assetType === \'frame\'" class="palette-label-two-lines">{{embellishment.colorName}} {{embellishment.thickness | capitalize}}&nbsp;<div class="palette-label-two-lines__additional-details" ng-if="embellishment.thickness !== \'none\'">{{::\'Palette.line\'|translate}}</div></div></li><li ng-if="(!ctrls.EmbellishmentsCtrl.activeFilter.objects.length) && ctrls.NavCtrl.selectedPage.isCover()" class="no-palette-for-page-container"><div class="no-palette-for-page no-palette-for-page--embellishments">{{::\'Palette.NoItemForCover\'|translate}}</div></li><li ng-if="(!ctrls.EmbellishmentsCtrl.activeFilter.objects.length) && !ctrls.EmbellishmentsCtrl.activeFilter.extPaletteItems.length && !ctrls.NavCtrl.selectedPage.isCover()" class="no-palette-for-page-container"><div class="no-palette-for-page"><span>{{ctrls.EmbellishmentsCtrl.activeFilter.textMore | translate | postfixTranslate:\'Palette.itemsNotAddedToProject\'}}</span> <a class="no-palette-for-page-link" data-test-key="link_add_items_to_project" ng-click="ctrls.PaletteCtrl.showExtendedPalette(\'embellishments\')">{{::\'Palette.addItemsToProject\'|translate}}</a></div></li></ul></scroll-synchronizer><div sf-force-scroll="" enable-when="ctrls.NavCtrl.editIsActive" scroll-when="ctrls.EmbellishmentsCtrl.embellishmentListModified" scroll-direction="\'horizontal\'" scroll-to="0" target-elements-classifier="\'.palette-body.embellishments-tab\'"></div><positionable ng-if="ctrls.EmbellishmentsCtrl.itemHover" delay="{{ctrls.MainCtrl.hoverDelay}}" target="#_{{ctrls.EmbellishmentsCtrl.itemHover.assetId}}" placement="right" h-spacing="10" v-spacing="-70" width="{{ctrls.EmbellishmentsCtrl.itemHover.previewWidth}}" height="{{ctrls.EmbellishmentsCtrl.itemHover.assetType === \'frame\' ?\n                        ctrls.EmbellishmentsCtrl.itemHover.previewHeight + 25 : ctrls.EmbellishmentsCtrl.itemHover.previewHeight}}" z-index="1200" class="shadow-box"><div id="palette-preview-container" class="preview-container" data-test-key="div_embellishment_preview_{{ctrls.EmbellishmentsCtrl.itemHover.assetId}}" ng-if="ctrls.EmbellishmentsCtrl.itemHover && ctrls.EmbellishmentsCtrl.itemHover.assetId"><div class="palette-wrapper" ng-style="{width: ctrls.EmbellishmentsCtrl.itemHover.previewWidth + \'px\'}"><div id="_{{ctrls.EmbellishmentsCtrl.itemHover.assetId}}" ng-if="!ctrls.EmbellishmentsCtrl.itemHover.isExtPalItem" class="preview-image"></div><div ng-if="ctrls.EmbellishmentsCtrl.utilsService.itemHasPrice(ctrls.EmbellishmentsCtrl.itemHover.assetId)"><div class="premium-ribbon-stripe"></div><div class="premium-ribbon-img"></div><div class="premium-text" ng-if="!ctrls.EmbellishmentsCtrl.utilsService.pricingService.shouldChargeForPremiumItems">{{::\'Palette.extended.noCharge\'|translate}}</div><div class="premium-text" ng-if="ctrls.EmbellishmentsCtrl.utilsService.pricingService.shouldChargeForPremiumItems" ng-bind="ctrls.EmbellishmentsCtrl.utilsService.getItemPrice(ctrls.EmbellishmentsCtrl.itemHover.assetId) | postfixTranslate:\'Palette.extended.popupItemPrice\'"></div></div><img class="preview-image" sf-priority-src="ctrls.EmbellishmentsCtrl.itemHover.previewUrl" sf-priority="priority" sf-priority-watch="true" sf-priority-onload="src"/></div></div></positionable>'),a.put("Palette/views/extended-palette-modal.html",'<div class="modal-width-large modal-content extended-palette-modal" data-test-key="ext-palette-modal" resizemodal="" movemodal=""><div class="modal-header"><div class="clearfix"><i type="button" class="icon-dialog-move"></i></div><span class="modal-header-title">{{::\'Palette.extended.title\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" data-test-key="button_extendedpalette_modal_xclose" ng-click="ctrls.ExtendedPaletteCtrl.cancel()"></i></div><form><div class="modal-body"><div class="ext-palette-header-nav"><div class="ext-palette-header-button" ng-repeat="assetType in ctrls.ExtendedPaletteCtrl.assetTypes" data-test-key="ext-palette-header-{{assetType.name}}" ng-class="{\'selected\': assetType == ctrls.ExtendedPaletteCtrl.currentAssetType}" ng-click="ctrls.ExtendedPaletteCtrl.changeAssetType(assetType)">{{assetType.name}}<div class="ext-palette-arrow" ng-class="{\'selected\': assetType == ctrls.ExtendedPaletteCtrl.currentAssetType}"></div></div><div class="ext-palette-header-nav-right"><div class="ext-palette-num-selected-text">{{ctrls.ExtendedPaletteCtrl.getSelectedItemsCount()}} selected</div><div class="btn-primary ext-palette-add-button" data-test-key="ext-palette-addToProject" ng-click="ctrls.ExtendedPaletteCtrl.onAddToProject()">{{::\'Palette.extended.addbutton\'|translate}}</div></div></div><div class="ext-palette-body-container"><div class="ext-palette-abn-container" ng-show="!ctrls.ExtendedPaletteCtrl.disableFilters"><div class="favorites-filter-container" ng-show="ctrls.ExtendedPaletteCtrl.showFavorites" ng-click="ctrls.ExtendedPaletteCtrl.favoriteFilterClicked()"><div class="favorites-filter-box" ng-class="{\'selected\': ctrls.ExtendedPaletteCtrl.filterByFavorites[ctrls.ExtendedPaletteCtrl.currentAssetType.name]}"></div><div class="favorites-filter-text" data-test-key="attribute-text-container-favorites">{{ ctrls.ExtendedPaletteCtrl.currentAssetType.name | postfixTranslate:\'Palette.extended.favorites.title\' }}</div></div><accordion close-others="oneAtATime"><accordion-group ng-class="{\'expanded\': ctrls.ExtendedPaletteCtrl.radioGroup.expanded}" ng-if="ctrls.ExtendedPaletteCtrl.radioGroup" is-open="ctrls.ExtendedPaletteCtrl.radioGroup.expanded"><accordion-heading ng-click="ctrls.ExtendedPaletteCtrl.radioGroup.expanded = !ctrls.ExtendedPaletteCtrl.radioGroup.expanded"><div class="ext-palette-attribute-group-icon"></div><div class="ext-palette-attribute-group" data-test-key="ext-palette-attribute-group-{{ctrls.ExtendedPaletteCtrl.radioGroup.header}}">{{ctrls.ExtendedPaletteCtrl.radioGroup.header}}</div></accordion-heading><div class="ext-palette-radio" ng-repeat="radio in ctrls.ExtendedPaletteCtrl.radioGroup.buttons" omniture="" linkname="{{radio.omniture}}" ng-click="ctrls.ExtendedPaletteCtrl.radioClicked(radio)"><div class="radio-selection-box" ng-class="{\'selected\': radio.selected}"></div><div class="attribute-text-container" data-test-key="attribute-text-container-{{radio.name}}">{{radio.name}}</div></div></accordion-group><div class="favorites-filter-message" ng-show="ctrls.ExtendedPaletteCtrl.filterByFavorites[ctrls.ExtendedPaletteCtrl.currentAssetType.name]">{{::\'Palette.extended.favorites.message\'|translate}}</div><accordion-group ng-class="{\'expanded\': attributeGroup.expanded}" ng-repeat="attributeGroup in ctrls.ExtendedPaletteCtrl.attributeGroups" is-open="attributeGroup.expanded" ng-show="!ctrls.ExtendedPaletteCtrl.filterByFavorites[ctrls.ExtendedPaletteCtrl.currentAssetType.name]"><accordion-heading ng-click="attributeGroup.expanded = !attributeGroup.expanded"><div class="ext-palette-attribute-group-icon"></div><div class="ext-palette-attribute-group" data-test-key="ext-palette-attribute-group-{{attributeGroup.name}}">{{attributeGroup.name}}</div></accordion-heading><div ng-repeat="attribute in attributeGroup.value"><label class="normal-text"><input type="checkbox" ng-class="{\'clickable\': !attribute.disabled}" ng-disabled="attribute.disabled" ng-model="attribute.selected" ng-click="ctrls.ExtendedPaletteCtrl.attributeClicked(attribute)"><span ng-class="{\'clickable\': !attribute.disabled}" class="attribute-text-container attribute-text-container--close-to-control" data-test-key="attribute-text-container-{{attribute.value}}">{{attribute.value}}</span></label></div></accordion-group></accordion></div><div class="ext-palette-content-container"><div class="ext-palette-content-wait-container" ng-include="\'Common/views/please-wait.html\'" ng-show="ctrls.ExtendedPaletteCtrl.waiting"></div><div class="ext-palette-content-header" ng-class="{\'ext-palette-search-header\' : ctrls.ExtendedPaletteCtrl.disableFilters}"><span ng-if="ctrls.ExtendedPaletteCtrl.disableFilters">{{ ctrls.ExtendedPaletteCtrl.totalCount | postfixTranslate:\'Palette.extended.search.numitems\'}}</span> <span ng-if="!ctrls.ExtendedPaletteCtrl.disableFilters">{{ ctrls.ExtendedPaletteCtrl.totalCount | postfixTranslate:\'Palette.extended.numitems\'}}</span><div class="ext-palette-search" ng-class="{\'ext-palette-search-active\' : ctrls.ExtendedPaletteCtrl.searchKeywords != \'\'}" ng-show="ctrls.ExtendedPaletteCtrl.currentAssetType.coreContext != \'layouts\' && ctrls.ExtendedPaletteCtrl.currentAssetType.coreContext != \'ideaPages\'\n                            && !(ctrls.ExtendedPaletteCtrl.currentAssetType.coreContext == \'embellishments\' && ctrls.ExtendedPaletteCtrl.radioGroup.buttons[2].selected)"><i class="ext-palette-search-icon" ng-click="ctrls.ExtendedPaletteCtrl.search()"></i><input data-test-key="ext-palette-searchText" placeholder="{{ctrls.ExtendedPaletteCtrl.currentAssetType.name | postfixTranslate:\'Palette.extended.searchText\'}}" ng-keyup="$event.keyCode == 13 ? ctrls.ExtendedPaletteCtrl.search() : null" ng-model="ctrls.ExtendedPaletteCtrl.searchKeywords" ng-class="{\'ext-palette-search-active\' : ctrls.ExtendedPaletteCtrl.searchKeywords != \'\'}"><i class="ext-palette-clear-search" ng-show="ctrls.ExtendedPaletteCtrl.disableFilters" data-test-key="ext-palette-clear-search-icon" ng-click="ctrls.ExtendedPaletteCtrl.clearSearch()"></i></div></div><div class="ext-palette-content-body" infinite-scroll="ctrls.ExtendedPaletteCtrl.requestNextPage()"><ul class="list-unstyled clearfix" ng-mouseleave="ctrls.ExtendedPaletteCtrl.itemHover = null"><li id="{{::\'extpalcontent_\' + contentItem.objectId}}" data-test-key="{{::\'extpalcontent_\' + contentItem.objectId}}" ng-repeat="contentItem in ctrls.ExtendedPaletteCtrl.content" ng-mouseenter="ctrls.ExtendedPaletteCtrl.itemHover = contentItem;" ng-mousedown="ctrls.ExtendedPaletteCtrl.itemHover = null" ng-mouseleave="ctrls.ExtendedPaletteCtrl.itemHover = null" ng-class="{\'ideacover\' : ctrls.ExtendedPaletteCtrl.isIdeaCovers}" ng-click="ctrls.ExtendedPaletteCtrl.onContentClick(contentItem)"><div class="extpalette-content-renderer-container" ng-class="{\'selected\' : ctrls.ExtendedPaletteCtrl.isObjectSelected(contentItem.objectId)}"><img ng-class="{\'extpalette-spine-image\': contentItem.layoutAttributes.PageType === \'ideaspine\'}" ng-src="{{ctrls.ExtendedPaletteCtrl.getThumbUrlFromAsset(contentItem.assetRef)}}"/><div class="content-storytelling" ng-show="contentItem.contentType == \'premium\' && !contentItem.isCorePaletteItem"></div><div class="content-favorite" ng-show="ctrls.ExtendedPaletteCtrl.showFavorites" ng-class="{\'empty\': !ctrls.ExtendedPaletteCtrl.favorites[contentItem.objectId], \'filled\': ctrls.ExtendedPaletteCtrl.favorites[contentItem.objectId]}" ng-click="ctrls.ExtendedPaletteCtrl.favoriteItemClicked(contentItem); $event.stopPropagation();"></div><div class="icon-cp-item" ng-show="contentItem.isCorePaletteItem"></div><div class="ext-palette-ideapage-label" ng-show="ctrls.ExtendedPaletteCtrl.isIdeaCovers">{{contentItem.layoutAttributes.IdeaPageDisplayName || contentItem.layoutAttributes.ideaPageDisplayName}}</div><div ng-if="contentItem.objectType === \'frame\'" class="palette-label-two-lines palette-label-two-line__extendedp-palette" data-test-key="label_frame_preview">{{contentItem.frameAttributes.DisplayName}}</div></div></li></ul></div><positionable ng-if="ctrls.ExtendedPaletteCtrl.itemHover" delay="{{ctrls.MainCtrl.hoverDelay}}" target="#extpalcontent_{{ctrls.ExtendedPaletteCtrl.itemHover.objectId}}" placement="left" h-spacing="0" v-spacing="-70" class="shadow-box ext-palette-hover-preview" width="300" ng-init="itemHover = ctrls.ExtendedPaletteCtrl.itemHover"><div id="palette-preview-container" class="preview-container" data-test-key="div_extpalette_preview_{{itemHover.objectId}}" ng-if="itemHover && itemHover.objectId"><div class="palette-wrapper"><div ng-if="ctrls.ExtendedPaletteCtrl.itemHasPrice(itemHover)"><div class="premium-ribbon-stripe"></div><div class="premium-ribbon-img"></div><div class="premium-text" ng-if="!ctrls.ExtendedPaletteCtrl.pricingService.shouldChargeForPremiumItems">{{::\'Palette.extended.noCharge\'|translate}}</div><div class="premium-text" ng-if="ctrls.ExtendedPaletteCtrl.pricingService.shouldChargeForPremiumItems" ng-bind="ctrls.ExtendedPaletteCtrl.getItemPrice(itemHover) | postfixTranslate:\'Palette.extended.popupItemPrice\'"></div></div><div class="preview-image"><img ng-src="{{ctrls.ExtendedPaletteCtrl.getPreviewUrlFromAsset(itemHover.assetRef)}}" class="ext-palette-hover-image"/></div></div></div></positionable></div></div></div></form><div class="modal-footer"><div class="storytelling-footer-small"></div><span class="ext-palette-footer-text">{{::\'Palette.extended.footer\'|translate}}</span> <span>-</span> <a href="http://shutterfly-2.custhelp.com/app/answers/detail/a_id/1498/kw/storytelling" target="_blank"><span class="ext-palette-footer-text-size">{{::\'Palette.extended.footer.learnmore\'|translate}}</span></a></div></div>'),
a.put("Palette/views/favorites-modal.html",'<div class="modal-defaults favorite-modal modal-content" data-test-key="favorites-modal" movemodal=""><div class="modal-header"><i type="button" class="icon-dialog-close" data-dismiss="modal" data-test-key="button_favorites_modal_xclose" ng-click="ctrls.FavoritesModalCtrl.close()"></i></div><div class="modal-body"><div class="favorite-modal-icon"></div></div><div class="modal-footer"></div></div>'),a.put("Palette/views/gc/events.html",'<div class="allowVerticalScroll palette-subpalette events-subpalette" ng-if="ctrls.MainCtrl.project" ng-controller="EventsPaletteCtrl"><div class="calendar-control-buttons-palette" ng-class="{\'calendar-control-buttons-csp\' : ctrls.MainCtrl.config.calendarSinglePalette}"><div class="icon-previous-page-palette icon-prev-next-page" ng-class="{\'icon-previous-page-press\': ctrls.NavCtrl.appState.isCustomizing(), \'nav-buttons-csp\': ctrls.MainCtrl.config.calendarSinglePalette}" data-test-key="button_nav_previous" ng-click="ctrls.NavCtrl.previousMonth()"></div><div class="calendar-control-date-palette" data-test-key="month_label"><span>{{ctrls.NavCtrl.activeLeftPage.surfaceKey | calendarizeMonth | translate}}</span> {{ctrls.NavCtrl.activeLeftPage.surfaceKey | calendarizeYear}}</div><div class="icon-next-page-palette icon-prev-next-page" ng-class="{\'icon-next-page-press\': ctrls.NavCtrl.appState.isCustomizing(), \'nav-buttons-csp\': ctrls.MainCtrl.config.calendarSinglePalette}" data-test-key="button_nav_next" ng-click="ctrls.NavCtrl.nextMonth()"></div></div><ul class="palette-body events-tab list-unstyled clearfix" style="overflow-y: auto"><li class="clickable event-palette-row event-dialog-events-item event-list-row event-list-row-view-mode" ng-click="ctrls.EventsPaletteCtrl.editEvent($event, event)" ng-repeat="event in ctrls.EventsPaletteCtrl.editor.events | filter:{\'month\': ctrls.EventsPaletteCtrl.eventsDate.month, \'isSelected\':true}:true | orderBy:[\'dateMillis\',\'id\']"><div data-test-key="{{::\'event_date_\' + event.id}}"><div class="event-palette-date event-palette-date-row region-value">{{event.displayDate() | date:\'MMM d\' | uppercase}}</div><div class="event-palette-row-name">{{event.name}}</div></div></li><div class="event-palette-row-instructions">{{::\'Palette.events.instructions\'|translate}}</div></ul><div ng-click="ctrls.EventsPaletteCtrl.manageEvents()" omniture="" linkname="Events: Manage Events" class="pull-right palette-header-text ideapages-extpalette-button clickable" data-test-key="button_manage_events"><span class="icon icon-right-padded icon-events"></span> <span>{{::\'Palette.extended.manage.events\'|translate}}</span></div></div>'),a.put("Palette/views/gc/idea-pages.html","<div ng-include=\"'Palette/views/idea-pages.html'\"></div><div class=\"palette-substitute-message\" ng-if=\"ctrls.PaletteCtrl.product.isGridPage(ctrls.NavCtrl.selectedPage.surfaceNumber)\"><h5>{{::'Calendars.product.name'|translate}}</h5><p>{{::'Calendar.palette.ideaPagesDisabled'|translate}}</p></div>"),a.put("Palette/views/gc/layouts.html","<div ng-include=\"'Palette/views/layouts.html'\"></div><div class=\"palette-substitute-message\" ng-if=\"ctrls.PaletteCtrl.product.isGridPage(ctrls.NavCtrl.selectedPage.surfaceNumber)\"><h5>{{::'Calendars.product.name'|translate}}</h5><p>{{::'Calendar.palette.layoutsDisabled'|translate}}</p></div>"),a.put("Palette/views/gc/left-nav.html",'<div class="event-dialog-items" ng-show="ctrls.MainCtrl.config.eventsPalette == false || (ctrls.MainCtrl.config.eventsPalette == true && !ctrls.PaletteCtrl.product.isGridPage(ctrls.NavCtrl.selectedPage.surfaceNumber))" ng-click="ctrls.PaletteCtrl.PaletteTabSelection.layouts = true" ng-class="{selected: (ctrls.PaletteCtrl.PaletteTabSelection.layouts == true)}"><i class="icon-layouts-normal" ng-class="{\'icon-layouts-selected\': ctrls.PaletteCtrl.PaletteTabSelection.layouts == true}"></i> <span class="event-dialog-text">{{::\'Palette.layouts\'|translate}}</span><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.layouts == true" class="palette-dialog-arrow"></div></div><div class="event-dialog-items event-dialog-items-nav-left-events" ng-if="ctrls.MainCtrl.config.eventsPalette == true" ng-show="ctrls.PaletteCtrl.product.isGridPage(ctrls.NavCtrl.selectedPage.surfaceNumber)" ng-click="ctrls.PaletteCtrl.PaletteTabSelection.events = true" ng-class="{selected: (ctrls.PaletteCtrl.PaletteTabSelection.events == true)}"><i class="icon-events-normal" ng-class="{\'icon-events-selected\': ctrls.PaletteCtrl.PaletteTabSelection.events == true}"></i> <span class="event-dialog-text">{{::\'Palette.events\'|translate}}</span><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.events == true" class="palette-dialog-arrow"></div></div><div class="event-dialog-items" ng-click="ctrls.PaletteCtrl.PaletteTabSelection.backgrounds = true" ng-class="{selected: (ctrls.PaletteCtrl.PaletteTabSelection.backgrounds == true)}"><i class="icon-backgrounds-normal" ng-class="{\'icon-backgrounds-selected\': ctrls.PaletteCtrl.PaletteTabSelection.backgrounds == true}"></i> <span class="event-dialog-text">{{::\'Palette.backgrounds\'|translate}}</span><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.backgrounds == true" class="palette-dialog-arrow"></div></div><div class="event-dialog-items" ng-if="ctrls.MainCtrl.features.embellishments" ng-click="ctrls.PaletteCtrl.PaletteTabSelection.embellishments = true" ng-class="{selected: (ctrls.PaletteCtrl.PaletteTabSelection.embellishments == true)}"><i class="icon-embellishments-normal" ng-class="{\'icon-embellishments-selected\': ctrls.PaletteCtrl.PaletteTabSelection.embellishments == true}"></i> <span class="event-dialog-text">{{::\'Palette.embellishments\'|translate}}</span><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.embellishments == true" class="palette-dialog-arrow"></div></div><div class="event-dialog-items" ng-click="ctrls.PaletteCtrl.PaletteTabSelection.ideaPages = true" ng-class="{selected: (ctrls.PaletteCtrl.PaletteTabSelection.ideaPages == true)}"><i class="icon-ideapages-normal" ng-class="{\'icon-ideapages-selected\': ctrls.PaletteCtrl.PaletteTabSelection.ideaPages == true}"></i> <span class="event-dialog-text">{{::\'Palette.ideaPages\'|translate}}</span><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.ideaPages == true" class="palette-dialog-arrow"></div></div>'),a.put("Palette/views/gc/pages-tab.html",'<tab id="pagesTab" heading="{{::\'Calendar.Palette.pages\' | translate }}" data-test-key="tab_pages" class="clickable first-tab" ng-click="ctrls.PaletteCtrl.selectPaletteTab(\'pages\')" active="ctrls.PaletteCtrl.PaletteTabSelection.pages" tooltip-append-to-body="true" tooltip="{{\'SilverApp.tooltip.monthsTab\' | translate}}" select="ctrls.PagesCtrl.tabActivated()"><div ng-include="\'Palette/views/@@p/pages.html\'" include-replace=""></div></tab>'),a.put("Palette/views/gc/pages.html",""),a.put("Palette/views/gc/primary-palette-tabs.html",'<tabset id="bottomPaletteTabs" ng-class="{\'new-nav\':ctrls.NavCtrl.showNewNavigation}"><tab data-intro="{{::\'HelpOverlay.1\' | translate }}" data-position="top" tooltip-append-to-body="true" tooltip="{{\'SilverApp.tooltip.photosTab\' | translate}}" heading="{{::\'Palette.photo\' | translate }}" data-test-key="tab_photos" class="clickable" ng-click="ctrls.PaletteCtrl.selectPaletteTab(\'images\')" active="ctrls.PaletteCtrl.PaletteTabSelection.images"><div class="palette-images clearfix" ng-if="ctrls.NavCtrl.editIsActive && (ctrls.PaletteCtrl.PaletteTabSelection.images || !ctrls.PaletteCtrl.PaletteTabFirstRun.images)" ng-include="\'Palette/views/images.html\'"></div></tab></tabset>'),a.put("Palette/views/gc/secondary-palette-tabs.html",'<tabset id="paletteTabs" ng-class="{\'new-nav\':ctrls.NavCtrl.showNewNavigation}"><tab ng-if="ctrls.PaletteCtrl.calendarPaletteMode" data-test-key="tab_photos" class="clickable" ng-click="ctrls.PaletteCtrl.selectPaletteTab(\'images\')" tooltip-append-to-body="true" tooltip-placement="right" tooltip="{{\'SilverApp.tooltip.photosTab\' | translate}}" active="ctrls.PaletteCtrl.PaletteTabSelection.images"><tab-heading><span ng-if="!ctrls.NavCtrl.showNewNavigation">{{::\'Palette.photo\' | translate}}</span></tab-heading><div class="palette-images clearfix" ng-if="ctrls.NavCtrl.editIsActive && (ctrls.PaletteCtrl.PaletteTabSelection.images || !ctrls.PaletteCtrl.PaletteTabFirstRun.images)" ng-include="\'Palette/views/images.html\'"></div></tab><tab id="layoutsTab" disabled="disabled" data-test-key="tab_layouts" class="clickable first-tab" select="ctrls.LayoutsCtrl.tabActivated()" ng-show="ctrls.MainCtrl.config.eventsPalette == false || (ctrls.MainCtrl.config.eventsPalette == true && !ctrls.PaletteCtrl.product.isGridPage(ctrls.NavCtrl.selectedPage.surfaceNumber))" deselect="ctrls.LayoutsCtrl.tabDeactivated()" tooltip-append-to-body="true" tooltip-placement="right" tooltip="{{\'SilverApp.tooltip.layoutsTab\' | translate}}" active="ctrls.PaletteCtrl.PaletteTabSelection.layouts" ng-click="ctrls.PaletteCtrl.ensureSecondaryPaletteExpanded(); ctrls.PaletteCtrl.selectPaletteTab(\'layouts\')"><tab-heading><span ng-if="!ctrls.NavCtrl.showNewNavigation">{{::\'Palette.layouts\' | translate}}</span></tab-heading><div ng-include="\'Palette/views/@@p/layouts.html\'" data-test-key="div_layouts"></div></tab><tab id="eventsTab" disabled="disabled" data-test-key="tab_events" class="clickable" ng-if="ctrls.MainCtrl.config.eventsPalette == true" ng-show="ctrls.PaletteCtrl.product.isGridPage(ctrls.NavCtrl.selectedPage.surfaceNumber)" ng-click="ctrls.PaletteCtrl.ensureSecondaryPaletteExpanded();ctrls.PaletteCtrl.selectPaletteTab(\'events\')" tooltip-append-to-body="true" tooltip-placement="right" tooltip="{{\'SilverApp.tooltip.eventsTab\' | translate}}" select="ctrls.EventsPaletteCtrl.tabActivated()" deselect="ctrls.EventsPaletteCtrl.tabDeactivated()" active="ctrls.PaletteCtrl.PaletteTabSelection.events"><tab-heading><span ng-if="!ctrls.NavCtrl.showNewNavigation">{{::\'Palette.events\' | translate}}</span></tab-heading><div ng-if="ctrls.MainCtrl.config.eventsPalette == true && (ctrls.PaletteCtrl.PaletteTabSelection.events || !ctrls.PaletteCtrl.PaletteTabFirstRun.events)" ng-include="\'Palette/views/@@p/events.html\'" data-test-key="div_events"></div></tab><tab id="backgroundsTab" disabled="disabled" heading="{{::\'Palette.backgrounds\' | translate }}" data-test-key="tab_backgrounds" class="clickable" select="ctrls.BackgroundsCtrl.tabActivated()" deselect="ctrls.BackgroundsCtrl.tabDeactivated()" tooltip-append-to-body="true" tooltip-placement="right" tooltip="{{\'SilverApp.tooltip.backgroundsTab\' | translate}}" active="ctrls.PaletteCtrl.PaletteTabSelection.backgrounds" ng-click="ctrls.PaletteCtrl.ensureSecondaryPaletteExpanded(); ctrls.PaletteCtrl.selectPaletteTab(\'backgrounds\')"><tab-heading><span ng-if="!ctrls.NavCtrl.showNewNavigation">{{::\'Palette.backgrounds\' | translate}}</span></tab-heading><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.backgrounds || !ctrls.PaletteCtrl.PaletteTabFirstRun.backgrounds" ng-include="\'Palette/views/backgrounds.html\'" data-test-key="div_backgrounds"></div><span ng-hide="true" secondary-palette-tabs-resizer="" size-element=".secondary-palette" target=".secondary-palette .nav.nav-tabs"></span></tab><tab id="embellishmentsTab" disabled="disabled" data-test-key="tab_embellishments" class="clickable" ng-if="ctrls.MainCtrl.features.embellishments" select="ctrls.EmbellishmentsCtrl.tabActivated()" deselect="ctrls.EmbellishmentsCtrl.tabDeactivated()" tooltip-append-to-body="true" tooltip-placement="right" tooltip="{{\'SilverApp.tooltip.embellishmentsTab\' | translate}}" active="ctrls.PaletteCtrl.PaletteTabSelection.embellishments" ng-click="ctrls.PaletteCtrl.ensureSecondaryPaletteExpanded(); ctrls.PaletteCtrl.selectPaletteTab(\'embellishments\')"><tab-heading><span ng-if="!ctrls.NavCtrl.showNewNavigation">{{::\'Palette.embellishments\' | translate}}</span></tab-heading><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.embellishments || !ctrls.PaletteCtrl.PaletteTabFirstRun.embellishments" ng-include="\'Palette/views/embellishments.html\'" data-test-key="div_embellishments"></div><span ng-hide="true" secondary-palette-tabs-resizer="" size-element=".secondary-palette" target=".secondary-palette .nav.nav-tabs"></span></tab><tab disabled="disabled" data-test-key="tab_ideaPages" class="clickable" ng-click="ctrls.PaletteCtrl.ensureSecondaryPaletteExpanded();ctrls.PaletteCtrl.selectPaletteTab(\'ideaPages\')" tooltip-append-to-body="true" tooltip-placement="right" tooltip="{{\'SilverApp.tooltip.ideaPagesTab\' | translate}}" select="ctrls.IdeaPagesCtrl.tabActivated()" deselect="ctrls.IdeaPagesCtrl.tabDeactivated()" active="ctrls.PaletteCtrl.PaletteTabSelection.ideaPages"><tab-heading><span ng-if="!ctrls.NavCtrl.showNewNavigation">{{::\'Palette.ideaPages\' | translate}}</span></tab-heading><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.ideaPages || !ctrls.PaletteCtrl.PaletteTabFirstRun.ideaPages" ng-include="\'Palette/views/@@p/idea-pages.html\'" data-test-key="div_ideaPages"></div></tab><li class="palette-toggle-handle clickable" ng-click="ctrls.PaletteCtrl.toggleSecondaryPalette()"><i class="icon" ng-class="{\'expanded\': ctrls.PaletteCtrl.secondaryPalette.isExpanded, \'collapsed\': !ctrls.PaletteCtrl.secondaryPalette.isExpanded }"></i></li></tabset>'),a.put("Palette/views/gc/storyboard-add-page.html",""),a.put("Palette/views/gc/storyboard-page-labels.html",'<div class="pull-left" style="margin-left: 5px">{{ page.surfaceKey | calendarizeMonth | translate }}</div>'),a.put("Palette/views/idea-pages.html",'<div class="palette-subpalette ideapages-subpalette" ng-if="ctrls.MainCtrl.project" ng-controller="IdeaPagesCtrl"><div ng-click="ctrls.PaletteCtrl.showExtendedPalette(\'ideaPages\')" omniture="" linkname="Idea pages: Get more idea pages" ng-if="ctrls.MainCtrl.features.extendedPalette && ctrls.StylesCtrl.isStyleLoaded" class="pull-right palette-header-text ideapages-extpalette-button clickable" data-test-key="button_ideapages_extendedpalette"><span class="icon icon-right-padded icon-add-tray"></span> <span>{{::\'Palette.extended.button\'|translate}}</span> <span>{{::\'Palette.extended.ideapages.lowercase\'|translate}}</span></div></div><scroll-synchronizer watch-on="ctrls.IdeaPagesCtrl.forceScroll" action-when="ctrls.NavCtrl.editIsActive && ctrls.PaletteCtrl.PaletteTabSelection.ideaPages" pad-left="120" pad-top="120" target-elements-classifier=".selected" class="palette-body idea-pages-tab allowHorizontalScroll" ng-if="ctrls.MainCtrl.project" ng-class="{\'loadingInProgress\': !ctrls.ShareCtrl.isStyleLoaded}"><div class="loading-mask" ng-show="!ctrls.StylesCtrl.isStyleLoaded"><div class="please-wait-spinner middle-align large"></div></div><ul class="list-unstyled clearfix idea-pages" ng-class="{\'palette-body-4-wide-margin\': ctrls.PaletteCtrl.calendarPaletteMode}" ng-controller="IdeaPagesCtrl" ng-mouseleave="ctrls.IdeaPagesCtrl.itemHover = null"><li ng-if="!ctrls.NavCtrl.selectedPage.isTitlePage()" ng-repeat="ideaPage in ctrls.IdeaPagesCtrl.extPaletteSpreadItems track by ideaPage.assetId" data-test-key="{{::\'palette_ideaPage_item_\' + ideaPage.assetId}}" ng-class="{\'hide\': ideaPage.assetId==ctrls.IdeaPagesCtrl.markedAsRemoveItemId}"><div class="palette-renderer-wrapper palette-renderer-wrapper--extended" ng-mouseenter="ctrls.IdeaPagesCtrl.itemHover = ideaPage;" ng-mousedown="ctrls.IdeaPagesCtrl.itemHover = null;" palette-renderer="ideaPage" ng-class="{\'selected\': (ideaPage.assetId == ctrls.IdeaPagesCtrl.selectedIdeaPageId), \'palette-renderer-wrapper--spread\':ideaPage.isSpread()}"><div id="{{::\'_\' + ideaPage.assetId}}" ng-style="ideaPage.elementStyle" class="layouts palette-item" ng-click="ctrls.IdeaPagesCtrl.applyWithoutScroll(ideaPage)" sf-draggable="" drag-asset="ideaPage" location="palette"></div><i class="removable-handler" ng-click="ctrls.IdeaPagesCtrl.onRemoveFromProject(ideaPage.assetId);ctrls.IdeaPagesCtrl.itemHover = null; ctrls.IdeaPagesCtrl.markedAsRemoveItemId = ideaPage.assetId" data-test-key="button_ep_spreadideapage_remove"></i><div ng-if="ctrls.IdeaPagesCtrl.utilsService.isPremium(ideaPage.assetId)" class="content-storytelling"></div></div><div class="palette-label">{{ideaPage.layoutAttributes.ideaPageDisplayName}}</div></li><li ng-repeat="ideaPage in ctrls.IdeaPagesCtrl.extPaletteItems track by ideaPage.assetId" data-test-key="{{::\'palette_ideaPage_item_\' + ideaPage.assetId}}" ng-class="{\'hide\': ideaPage.assetId==ctrls.IdeaPagesCtrl.markedAsRemoveItemId}"><div class="palette-renderer-wrapper palette-renderer-wrapper--extended" ng-mouseenter="ctrls.IdeaPagesCtrl.itemHover = ideaPage;" ng-mousedown="ctrls.IdeaPagesCtrl.itemHover = null;" palette-renderer="ideaPage" ng-class="{\'selected\': (ideaPage.assetId == ctrls.IdeaPagesCtrl.selectedIdeaPageId), \'palette-renderer-wrapper--spread\':ideaPage.isSpread()}"><div id="{{::\'_\' + ideaPage.assetId}}" ng-style="ideaPage.elementStyle" class="layouts palette-item" ng-click="ctrls.IdeaPagesCtrl.applyWithoutScroll(ideaPage)" sf-draggable="" drag-asset="ideaPage" location="palette"></div><i class="removable-handler" ng-click="ctrls.IdeaPagesCtrl.onRemoveFromProject(ideaPage.assetId);ctrls.IdeaPagesCtrl.itemHover = null; ctrls.IdeaPagesCtrl.markedAsRemoveItemId = ideaPage.assetId" data-test-key="button_ep_ideapage_remove"></i><div ng-if="ctrls.IdeaPagesCtrl.utilsService.isPremium(ideaPage.assetId)" class="content-storytelling"></div></div><div class="palette-label">{{ideaPage.layoutAttributes.ideaPageDisplayName}}</div></li><li class="extended-separator idea-pages-separator" ng-if="ctrls.IdeaPagesCtrl.extPaletteItems.length > 0 || ctrls.IdeaPagesCtrl.extPaletteSpreadItems.length > 0" ng-mouseenter="ctrls.EmbellishmentsCtrl.itemHover = null;"></li><li ng-if="!ctrls.NavCtrl.selectedPage.isTitlePage()" ng-repeat="ideaPage in ctrls.IdeaPagesCtrl.paletteSpreadIdeaPages track by ideaPage.assetId" data-test-key="{{::\'palette_ideaPage_item_\' + ideaPage.assetId}}"><div class="palette-renderer-wrapper" ng-mouseenter="ctrls.IdeaPagesCtrl.itemHover = ideaPage;" ng-mousedown="ctrls.IdeaPagesCtrl.itemHover = null;" palette-renderer="ideaPage" ng-class="{\'selected\': (ideaPage.assetId == ctrls.IdeaPagesCtrl.selectedIdeaPageId), \'palette-renderer-wrapper--spread\': ideaPage.isIdeaSpread() }"><div id="{{::\'_\' + ideaPage.assetId}}" class="layouts palette-item" ng-class="ctrls.IdeaPagesCtrl.thumbnailCssClass(ideaPage)" ng-click="ctrls.IdeaPagesCtrl.applyWithoutScroll(ideaPage)" sf-draggable="" drag-asset="ideaPage" location="palette"></div></div><div class="palette-label">{{ideaPage.layoutAttributes.ideaPageDisplayName}}</div></li><li ng-repeat="ideaPage in ctrls.IdeaPagesCtrl.paletteIdeaPages track by ideaPage.assetId" data-test-key="{{::\'palette_ideaPage_item_\' + ideaPage.assetId}}"><div class="palette-renderer-wrapper" ng-mouseenter="ctrls.IdeaPagesCtrl.itemHover = ideaPage;" ng-mousedown="ctrls.IdeaPagesCtrl.itemHover = null;" palette-renderer="ideaPage" ng-class="{\'selected\': (ideaPage.assetId == ctrls.IdeaPagesCtrl.selectedIdeaPageId)}"><div id="{{::\'_\' + ideaPage.assetId}}" class="layouts palette-item" ng-class="ctrls.IdeaPagesCtrl.thumbnailCssClass(ideaPage)" ng-click="ctrls.IdeaPagesCtrl.applyWithoutScroll(ideaPage)" sf-draggable="" drag-asset="ideaPage" location="palette"></div></div><div class="palette-label">{{ideaPage.layoutAttributes.ideaPageDisplayName}}</div></li><li ng-if="(!ctrls.IdeaPagesCtrl.paletteIdeaPages.length) && ctrls.NavCtrl.selectedPage.isCover()" class="no-palette-for-page-container"><div class="no-palette-for-page">{{::\'Palette.NoItemForCover\'|translate}}</div></li><li ng-if="!ctrls.IdeaPagesCtrl.extPaletteSpreadItems.length &&\n      !ctrls.IdeaPagesCtrl.paletteSpreadIdeaPages.length &&\n      !ctrls.IdeaPagesCtrl.extPaletteItems.length &&\n      !ctrls.IdeaPagesCtrl.paletteIdeaPages.length &&\n      !ctrls.NavCtrl.selectedPage.isCover()" class="no-palette-for-page-container"><div class="no-palette-for-page"><span>{{::\'Palette.ideaPagesNotAddedToProject\'|translate}}</span> <a class="no-palette-for-page-link" data-test-key="link_add_items_to_project" ng-click="ctrls.PaletteCtrl.showExtendedPalette(\'ideaPages\')">{{::\'Palette.addIdeaPagesToProject\'|translate}}</a></div></li></ul></scroll-synchronizer><positionable ng-if="ctrls.IdeaPagesCtrl.itemHover" delay="{{ctrls.MainCtrl.hoverDelay}}" target="#_{{ctrls.IdeaPagesCtrl.itemHover.assetId}}" placement="right" h-spacing="10" v-spacing="-70" width="{{ctrls.IdeaPagesCtrl.itemHover.previewWidth}}" height="{{ctrls.IdeaPagesCtrl.itemHover.previewHeight}}" z-index="1200" class="shadow-box"><div id="palette-preview-container" class="preview-container" data-test-key="div_ideaPage_preview_{{ctrls.IdeaPagesCtrl.itemHover.assetId}}" ng-if="ctrls.IdeaPagesCtrl.itemHover && ctrls.IdeaPagesCtrl.itemHover.assetId"><div class="palette-wrapper" ng-style="{width: ctrls.IdeaPagesCtrl.itemHover.previewWidth + \'px\'}"><div ng-if="ctrls.IdeaPagesCtrl.utilsService.itemHasPrice(ctrls.IdeaPagesCtrl.itemHover.assetId)"><div class="premium-ribbon-stripe"></div><div class="premium-ribbon-img"></div><div class="premium-text" ng-if="!ctrls.IdeaPagesCtrl.utilsService.pricingService.shouldChargeForPremiumItems">{{::\'Palette.extended.noCharge\'|translate}}</div><div class="premium-text" ng-if="ctrls.IdeaPagesCtrl.utilsService.pricingService.shouldChargeForPremiumItems" ng-bind="ctrls.IdeaPagesCtrl.utilsService.getItemPrice(ctrls.IdeaPagesCtrl.itemHover.assetId) | postfixTranslate:\'Palette.extended.popupItemPrice\'"></div></div><img class="preview-image" sf-priority-src="ctrls.IdeaPagesCtrl.itemHover.previewUrl" sf-priority="priority" sf-priority-watch="true" sf-priority-onload="src"/></div></div></positionable>'),a.put("Palette/views/image-used-cant-delete.html",'<div class="modal-width-small modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'Palette.imageDelete.title\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_modal_xclose" ng-click="ctrls.SimpleModalCtrl.cancel()"></i></div><div class="modal-body">{{::\'Palette.imageDelete.description\'|translate}}</div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.SimpleModalCtrl.ok()" data-test-key="button_modal_ok">{{::\'SilverApp.Ok\'|translate}}</button></div></div>'),a.put("Palette/views/images-list-choose-cover.html",'<ul class="list-unstyled image-list list-inline"><li ng-repeat="image in ctrls.ImageCtrl.projectImages | orderBy:ctrls.PaletteCtrl.sortByField:ctrls.PaletteCtrl.reverseSort\n        | moveEmptyFieldToEnd:ctrls.PaletteCtrl.sortByField:ctrls.PaletteCtrl.appendEmptyField" data-test-key="{{::\'palette_photo_\' + image.productImageID}}" ng-click="ctrls.ChooseCoverPhotoCtrl.changeCoverPhoto(image)" ng-class="{\'has-error\': image.hasError}"><img class="palette-image-thumbnail clickable" sf-priority-src="image.thumbSrc" sf-priority="ctrls.PaletteCtrl.priorities.images" sf-priority-watch="true" sf-priority-lifecycle-callbacks="\'true\'" sf-priority-onload="src" width="{{image.thumbWidth}}" height="{{image.thumbHeight}}"/> <i class="image-remove" ng-if="image.hasError" ng-click="ctrls.ImageCtrl.removeImage(image.productImageID)" data-test-key="button_photo_remove"></i> <span class="image-error-indicator" data-test-key="icon_photo_error"></span></li></ul>'),a.put("Palette/views/images-list-storyboard.html",'<div ng-repeat="cluster in ctrls.ImageCtrl.clusters"><div ng-if="!ctrls.ImageCtrl.isClusterEmpty(cluster, ctrls.PaletteCtrl.hideUsed, ctrls.PaletteCtrl.highlights)" class="cluster-title" style="margin-left: 15px"><hr ng-if="!$first"><span ng-style="{color: \'#EE4C37\'}">{{ctrls.ImageCtrl.getClusterTitle(cluster, ctrls.PaletteCtrl.clusterKey)}}</span></div><ul class="list-unstyled image-list list-inline" style="margin-right: 10px" ng-mouseleave="ctrls.ImageCtrl.arrangeImageHover = null"><li ng-if="ctrls.PaletteCtrl.groupDuplicates" ng-repeat="image in cluster | hideUsed:ctrls.PaletteCtrl.hideUsed\n                    | highlights:ctrls.PaletteCtrl.highlights\n                    | orderBy:ctrls.PaletteCtrl.sortByField:ctrls.PaletteCtrl.reverseSort\n                    | moveEmptyFieldToEnd:ctrls.PaletteCtrl.sortByField:ctrls.PaletteCtrl.appendEmptyField\n                    | hideDuplicates:true:ctrls.PaletteCtrl.hideUsed" data-test-key="storyboard_photo_{{::image.productImageID}}" ng-class="{\'has-error\': image.hasError, \'image-used\': image.useCount}"><div ng-if="!ctrls.ImageCtrl.imageHasDuplicate(image, ctrls.PaletteCtrl.hideUsed)"><img class="palette-image-thumbnail clickable" sf-priority-src="image.storyboardThumbSrc" sf-priority="ctrls.PaletteCtrl.priorities.storyboard" sf-priority-watch="true" sf-priority-lifecycle-callbacks="\'true\'" sf-priority-onload="src" ng-mouseenter="ctrls.ImageCtrl.arrangeImageHover = image;" ng-mouseleave="ctrls.ImageCtrl.arrangeImageHover = null;" ng-mousedown="ctrls.ImageCtrl.arrangeImageHover = null;" width="{{::image.storyboardThumbWidth}}" height="{{::image.storyboardThumbHeight}}" sf-draggable="" drag-asset="image" location="palette"/> <i class="image-remove" ng-click="ctrls.ImageCtrl.removeImage(image.productImageID);ctrls.ImageCtrl.arrangeImageHover = null" data-test-key="button_photo_remove"></i><progressbar class="image-progress-bar" max="100" ng-show="image.progress < 100 && image.hasError != true" value="image.progress"></progressbar><span class="image-used-indicator" data-test-key="icon_photo_used"></span> <span class="image-error-indicator" data-test-key="icon_photo_error"></span></div><div ng-if="ctrls.ImageCtrl.imageHasDuplicate(image, ctrls.PaletteCtrl.hideUsed)" ng-include="\'Palette/views/storyboard-image-stack.html\'"></div></li><li ng-if="!ctrls.PaletteCtrl.groupDuplicates" ng-repeat="image in cluster | hideUsed:ctrls.PaletteCtrl.hideUsed\n                | highlights:ctrls.PaletteCtrl.highlights | orderBy:ctrls.PaletteCtrl.sortByField:ctrls.PaletteCtrl.reverseSort\n                | moveEmptyFieldToEnd:ctrls.PaletteCtrl.sortByField:ctrls.PaletteCtrl.appendEmptyField" data-test-key="storyboard_photo_{{::image.productImageID}}" ng-class="{\'has-error\': image.hasError, \'image-used\': image.useCount}"><img class="palette-image-thumbnail clickable" sf-priority-src="image.storyboardThumbSrc" sf-priority="ctrls.PaletteCtrl.priorities.storyboard" sf-priority-watch="true" sf-priority-lifecycle-callbacks="\'true\'" sf-priority-onload="src" ng-mouseenter="ctrls.ImageCtrl.arrangeImageHover = image;" ng-mousedown="ctrls.ImageCtrl.arrangeImageHover = null;" width="{{::image.storyboardThumbWidth}}" height="{{::image.storyboardThumbHeight}}" sf-draggable="" drag-asset="image" location="palette"/> <i class="image-remove" ng-click="ctrls.ImageCtrl.removeImage(image.productImageID);ctrls.ImageCtrl.arrangeImageHover = null" data-test-key="button_photo_remove"></i><progressbar class="image-progress-bar" ng-show="image.progress < 100 && image.hasError != true" max="100" value="image.progress"></progressbar><span class="image-used-indicator" data-test-key="icon_photo_used"></span> <span class="image-error-indicator" data-test-key="icon_photo_error"></span></li></ul></div><div><ul class="list-unstyled image-list list-inline" style="margin-right: 10px" ng-mouseleave="ctrls.ImageCtrl.arrangeImageHover = null"><li ng-if="(!ctrls.ImageCtrl.projectImages.length) ||\n               ((ctrls.ImageCtrl.projectImages.length === ctrls.ImageCtrl.imageCollection.getUsedImages()) && ctrls.PaletteCtrl.hideUsed)" ng-click="ctrls.UppCtrl.showUPP(ctrls.ImageCtrl.projectImages.length, !ctrls.NavCtrl.editIsActive)" omniture="" linkname="Add Photos - Storyboard 2" class="add-stub-storyboard clickable" ng-mouseenter="ctrls.ImageCtrl.arrangeImageHover = null" data-test-key="button_add_photos_palette"></li></ul></div><positionable ng-if="ctrls.ImageCtrl.arrangeImageHover" delay="{{ctrls.MainCtrl.hoverDelay}}" target="[data-test-key=\'storyboard_photo_{{ctrls.ImageCtrl.arrangeImageHover.productImageID}}\'] .palette-image-thumbnail" placement="right" h-spacing="10" v-spacing="-70" width="370" height="390" z-index="1200" class="shadow-box"><div id="image-preview-container" class="preview-container" ng-if="ctrls.ImageCtrl.arrangeImageHover && ctrls.ImageCtrl.arrangeImageHover.imageId" data-test-key="div_photo_preview_{{ctrls.ImageCtrl.arrangeImageHover.productImageID}}"><div class="image-wrapper"><img class="preview-image" ng-src="{{ctrls.ImageCtrl.arrangeImageHover.previewSrc}}"/></div><div class="preview-footage" data-test-key="label_photo_preview">{{ctrls.ImageCtrl.getImageFooter(ctrls.ImageCtrl.arrangeImageHover)}}</div></div></positionable>'),a.put("Palette/views/images-list.html",'<ul class="list-unstyled image-list list-inline" ng-class="{\'palette-body-4-wide\': ctrls.PaletteCtrl.calendarPaletteMode}" ng-mouseleave="ctrls.ImageCtrl.imageHover = null"><li ng-repeat="image in ctrls.ImageCtrl.projectImages | hideUsed:ctrls.PaletteCtrl.hideUsed\n    | highlights:ctrls.PaletteCtrl.highlights | orderBy:ctrls.PaletteCtrl.sortByField:ctrls.PaletteCtrl.reverseSort\n    | moveEmptyFieldToEnd:ctrls.PaletteCtrl.sortByField:ctrls.PaletteCtrl.appendEmptyField\n    track by image.productImageID\n    " data-test-key="palette_photo_{{::image.productImageID}}" ng-class="{\'has-error\': image.hasError, \'image-used\': image.useCount, \'palette-float\':ctrls.PaletteCtrl.calendarPaletteMode}"><img class="palette-image-thumbnail clickable" sf-priority-src="image.thumbSrc" sf-priority="ctrls.PaletteCtrl.priorities.images" sf-priority-watch="true" sf-priority-lifecycle-callbacks="\'true\'" sf-priority-onload="src" ng-class="{\'image-ranking-best\': image.ranking==1, \'image-ranking-good\': image.ranking==2, \'image-ranking-other\': image.ranking==3}" ng-mouseenter="ctrls.ImageCtrl.imageHover = image;" ng-mousedown="ctrls.ImageCtrl.imageHover = null;" ng-mouseleave="ctrls.ImageCtrl.imageHover = null;" width="{{::image.thumbWidth}}" height="{{::image.thumbHeight}}" sf-draggable="" drag-asset="image" location="palette"/> <i class="image-remove" ng-if="!image.isUploading || image.hasError" ng-click="ctrls.ImageCtrl.removeImage(image.productImageID);ctrls.ImageCtrl.imageHover = null" data-test-key="button_photo_remove"></i><progressbar class="image-progress-bar" ng-show="image.progress < 100 && image.hasError != true" max="100" value="image.progress"></progressbar><span class="image-used-indicator" data-test-key="icon_photo_used"></span> <span class="image-error-indicator" data-test-key="icon_photo_error"></span></li><li ng-if="(!ctrls.ImageCtrl.projectImages.length) ||\n               ((ctrls.ImageCtrl.projectImages.length === ctrls.ImageCtrl.imageCollection.getUsedImages()) && ctrls.PaletteCtrl.hideUsed)" ng-controller="UppCtrl" ng-click="ctrls.UppCtrl.showUPP(ctrls.ImageCtrl.projectImages.length)" omniture="" linkname="Add Photos - Photos tab button" class="clickable" ng-class="{\'add-stub-calendar-single-palette\': ctrls.PaletteCtrl.calendarPaletteMode, \'add-stub\': !ctrls.PaletteCtrl.calendarPaletteMode}" ng-mouseenter="ctrls.ImageCtrl.imageHover = null" data-test-key="button_add_photos_palette"></li></ul><positionable ng-if="ctrls.ImageCtrl.imageHover" delay="{{::ctrls.MainCtrl.hoverDelay}}" target="[data-test-key=\'palette_photo_{{ctrls.ImageCtrl.imageHover.productImageID}}\'] .palette-image-thumbnail" placement="right" h-spacing="10" v-spacing="-70" width="610" height="630" z-index="1200" class="shadow-box"><div id="image-preview-container" class="preview-container" ng-if="ctrls.ImageCtrl.imageHover && ctrls.ImageCtrl.imageHover.imageId" data-test-key="div_photo_preview_{{ctrls.ImageCtrl.imageHover.productImageID}}"><div class="image-wrapper"><img class="preview-image" ng-src="{{ctrls.ImageCtrl.imageHover.previewSrc}}"/></div><div class="preview-footage" data-test-key="label_photo_preview">{{ctrls.ImageCtrl.getImageFooter(ctrls.ImageCtrl.imageHover)}}</div></div></positionable>'),
a.put("Palette/views/images-toolbar.html",'<div ng-if="!ctrls.NavCtrl.arrangeIsActive && !ctrls.NavCtrl.editIsActive" ng-controller="UppCtrl" ng-click="ctrls.UppCtrl.showUPP(ctrls.ImageCtrl.projectImages.length, !ctrls.NavCtrl.arrangeIsActive && !ctrls.NavCtrl.editIsActive)" omniture="" linkname="Add Photos - Storyboard" class="pull-right palette-header-text clickable add-photos" data-test-key="button_add_photos_palette"><span class="icon icon-right-padded icon-add-photo"></span><span id="addPhotosText">{{::\'Palette.addPhotos\'|translate}}</span></div><div ng-if="!(!ctrls.NavCtrl.arrangeIsActive && !ctrls.NavCtrl.editIsActive) && !ctrls.PaletteCtrl.calendarPaletteMode" ng-controller="UppCtrl" ng-click="ctrls.UppCtrl.showUPP(ctrls.ImageCtrl.projectImages.length, !ctrls.NavCtrl.arrangeIsActive && !ctrls.NavCtrl.editIsActive)" omniture="" linkname="Add Photos - Bottom nav icon" class="pull-right palette-header-text clickable add-photos" data-test-key="button_add_photos_palette"><span class="icon icon-right-padded icon-add-photo"></span><span id="addPhotosText">{{::\'Palette.addPhotos\'|translate}}</span></div><div id="autofillButton" ng-if="!ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.config.features.disableAutofill " ng-controller="AutofillCtrl" class="pull-right autofillButtonMargin"><span ng-class="{disabled: !ctrls.AutofillCtrl.canAutofill()}" ng-click="ctrls.AutofillCtrl.autofill()" omniture="" linkname="Autofill Photos - Tab" data-test-key="button_autofill" class="palette-header-text autofill clickable">{{::\'SilverApp.autofill\'|translate}}</span></div><li ng-if="!ctrls.MainCtrl.superSimple && !ctrls.PaletteCtrl.calendarPaletteMode" class="divider-vertical-gray tool-icon"></li><div id="sortByControl" ng-if="!ctrls.MainCtrl.superSimple" class="sort-by pull-right"><div><span><span>{{::\'SilverApp.sort.by\'|translate}}</span> <span class="caret"></span><select data-test-key="sortPhotos" ng-model="ctrls.PaletteCtrl.selectedOption" ng-options="value | translate for value in ctrls.PaletteCtrl.sortOptions" ng-change="ctrls.PaletteCtrl.changeSortOrder()"></select></span></div></div><div class="pull-right clickable hide-used"><label class="checkbox pull-right clickable"><input class="clickable" style="margin-top: 1px" type="checkbox" ng-click="ctrls.PaletteCtrl.toggleHideUsed()" ng-model="ctrls.PaletteCtrl.hideUsed" data-test-key="input_hide_used"/><span class="normal-text">{{::\'Palette.hideUsed\'|translate}}</span></label></div><div ng-if="ctrls.NavCtrl.storyboardIsActive && ctrls.MainCtrl.features.groupDuplicates" id="groupDuplicatesFilter" class="pull-right clickable highlights"><label class="checkbox pull-right clickable" ng-class="{disabled:ctrls.PaletteCtrl.getRankInProgress}"><input class="clickable" style="margin-top: 1px" type="checkbox" ng-click="ctrls.PaletteCtrl.toggleGroupDuplicates()" ng-model="ctrls.PaletteCtrl.groupDuplicates" data-test-key="input_groupDuplicates" ng-disabled="ctrls.PaletteCtrl.getRankInProgress"/><span class="normal-text">{{::\'Palette.groupDuplicates\'|translate}}</span></label></div><div ng-if="!ctrls.MainCtrl.superSimple && ctrls.MainCtrl.features.clusterStoryboard && ctrls.NavCtrl.storyboardIsActive" class="sort-by pull-right"><div><span><span>{{::\'Palette.clusterStoryboard\'|translate}}</span> <span class="caret"></span><select class="cluster-label" data-test-key="clusterPhotos" ng-model="ctrls.PaletteCtrl.selectedClusterOption" ng-options="value | translate for value in ctrls.PaletteCtrl.clusterOptions" ng-change="ctrls.PaletteCtrl.changeClusterOrder()"></select></span></div></div><div ng-if="!ctrls.MainCtrl.superSimple && ctrls.MainCtrl.features.clusterStoryboard && ctrls.NavCtrl.storyboardIsActive" class="cluster-storyboard pull-right"><label class="checkbox pull-right clickable"><input class="clickable" style="margin-top: 1px" type="checkbox" ng-click="ctrls.PaletteCtrl.toggleClusterStoryboard()" ng-model="ctrls.PaletteCtrl.clusterStoryboard" data-test-key="input_cluster_storyboard"/></label></div><div id="highlightsFilter" ng-if="ctrls.MainCtrl.features.highlightsFeature" class="pull-right clickable highlights"><label class="checkbox pull-right clickable" ng-class="{disabled:ctrls.PaletteCtrl.getRankInProgress}"><input class="clickable" style="margin-top: 1px" type="checkbox" ng-click="ctrls.PaletteCtrl.toggleHighlights()" ng-model="ctrls.PaletteCtrl.highlights" data-test-key="input_highlights" ng-disabled="ctrls.PaletteCtrl.getRankInProgress"/><span class="normal-text">{{::\'Palette.highlights\'|translate}}</span></label></div><li ng-if="!ctrls.NavCtrl.storyboardIsActive && !ctrls.MainCtrl.superSimple && !ctrls.PaletteCtrl.calendarPaletteMode" class="divider-vertical-gray tool-icon"></li><a ng-if="ctrls.UppCtrl.allowUpload()" class="pull-left upload-indicator" ng-click="ctrls.ImageCtrl.showUploadInProgressModal()" data-test-key="label_upload_in_progress" ng-show="ctrls.ImageCtrl.imageCollection.currentUploadTotal > 0">{{ctrls.ImageCtrl.imageCollection.currentUploadInProgress | postfixTranslate:\'Palette.uploadInProgress\'}}</a> <span class="photo-count pull-right"><span>{{( ctrls.ImageCtrl.projectImages | hideUsed:ctrls.PaletteCtrl.hideUsed | highlights:ctrls.PaletteCtrl.highlights ).length | postfixTranslate:\'Palette.numPhotos\'}}</span></span>'),a.put("Palette/views/images.html",'<div class="clickable expand" style="display: table;  margin: 0 auto" ng-if="!ctrls.NavCtrl.storyboardIsActive && !ctrls.MainCtrl.superSimple && !ctrls.PaletteCtrl.calendarPaletteMode"><span ng-if="!ctrls.PaletteCtrl.lowerPaletteIsExpanded && !ctrls.PaletteCtrl.lowerPaletteIsCollapsed" class="icon icon-expand-tray" ng-click="ctrls.PaletteCtrl.toggleExpandLowerPalette()"></span> <span ng-if="ctrls.PaletteCtrl.lowerPaletteIsExpanded && !ctrls.PaletteCtrl.lowerPaletteIsCollapsed" class="icon icon-contract-tray" ng-click="ctrls.PaletteCtrl.toggleExpandLowerPalette()"></span> <span ng-if="!ctrls.PaletteCtrl.lowerPaletteIsCollapsed && !ctrls.PaletteCtrl.lowerPaletteIsExpanded" class="icon icon-contract-tray" ng-click="ctrls.PaletteCtrl.toggleCollapseLowerPalette()"></span> <span ng-if="ctrls.PaletteCtrl.lowerPaletteIsCollapsed  && !ctrls.PaletteCtrl.lowerPaletteIsExpanded" class="icon icon-expand-tray" ng-click="ctrls.PaletteCtrl.toggleCollapseLowerPalette()"></span></div><div class="palette-body vertical-layout allowVerticalScroll" ng-class="{\'palette-4-wide-top\': ctrls.PaletteCtrl.calendarPaletteMode}" ng-include="\'Palette/views/images-list.html\'" data-test-key="div_photos" sf-droppable="" location="palette"></div><div class="palette-subpalette clearfix" ng-class="{\'palette-subpalette-simple\': ctrls.MainCtrl.superSimple}" ng-include="\'Palette/views/images-toolbar.html\'"></div><div class="palette-tertiary-palette"></div>'),a.put("Palette/views/layouts.html",'<div class="palette-subpalette palette-subpalette--no-border" ng-if="ctrls.MainCtrl.project" ng-show="ctrls.LayoutsCtrl.showFilters">{{::\'Palette.numberPhotos\'|translate}}</div><div class="palette-subpalette" ng-if="ctrls.MainCtrl.project" ng-controller="LayoutsCtrl"><div class="btn-group btn-group-sm" ng-show="ctrls.LayoutsCtrl.showFilters" ng-class="{\'filters-align-center\' : ctrls.PaletteCtrl.isDualPaletteMode, \'filter-align-center--hidden\': !ctrls.LayoutsCtrl.showFilters}"><button ng-repeat="option in ctrls.LayoutsCtrl.filterOptions track by option.dataTestKey" type="button" class="btn btn-link-layouts" ng-class="{\'filters-in-dual-palette-spreads\' : ctrls.MainCtrl.features.spreads, \'filters-in-dual-palette\':ctrls.PaletteCtrl.isDualPaletteMode && !ctrls.MainCtrl.features.spreads, \'filters-in-single-palette\' : !ctrls.PaletteCtrl.isDualPaletteMode}" ng-model="ctrls.LayoutsCtrl.selectedFilterIndex" btn-radio="$index" data-test-key="{{option.dataTestKey}}" translate="">{{option.text}}</button></div><div ng-click="ctrls.PaletteCtrl.showExtendedPalette(\'layouts\')" ng-if="ctrls.MainCtrl.features.extendedPalette" ng-show="ctrls.LayoutsCtrl.showEPLink" omniture="" linkname="Layouts: Get more layouts" class="pull-right palette-header-text layouts-extpalette-button clickable" data-test-key="button_layouts_extendedpalette"><span class="icon icon-right-padded icon-add-tray"></span> <span>{{::\'Palette.extended.button\'|translate}}</span> <span>{{::\'Palette.extended.layouts.lowercase\'|translate}}</span></div></div><scroll-synchronizer watch-on="ctrls.LayoutsCtrl.forceScroll" action-when="ctrls.NavCtrl.editIsActive && ctrls.PaletteCtrl.PaletteTabSelection.layouts" pad-left="120" pad-top="120" target-elements-classifier=".selected" class="palette-body layouts-tab allowHorizontalScroll palette-{{ctrls.MainCtrl.project.product.aspectRatio}}" ng-class="{\'layouts-tab-lower\': ctrls.LayoutsCtrl.showFilters}" ng-if="ctrls.MainCtrl.project"><ul class="list-unstyled clearfix" ng-class="{\'palette-body-4-wide\': ctrls.PaletteCtrl.calendarPaletteMode}" ng-mouseleave="ctrls.LayoutsCtrl.itemHover = null"><li ng-if="!ctrls.NavCtrl.selectedPage.isTitlePage()" ng-repeat="layout in ctrls.LayoutsCtrl.extPaletteSpreadItems track by layout.assetId" data-test-key="{{::\'palette_layout_item_\' + layout.assetId}}" ng-class="{\'hide\': layout.assetId==ctrls.LayoutsCtrl.markedAsRemoveItemId}"><div class="palette-renderer-wrapper palette-renderer-wrapper--extended" ng-mouseenter="ctrls.LayoutsCtrl.itemHover = layout;" ng-mousedown="ctrls.LayoutsCtrl.itemHover = null;" palette-renderer="layout" ng-class="{\'selected\': (layout.assetId == ctrls.LayoutsCtrl.selectedLayoutId), \'palette-renderer-wrapper--spread\':layout.isSpread()}"><img id="{{::\'_\' + layout.assetId}}" class="layouts palette-item" ng-class="ctrls.LayoutsCtrl.layoutThumbnailClass(layout)" sf-priority-src="layout.previewUrl" sf-priority="priority" sf-priority-onload="src" width="{{layout.previewWidth}} + \'px\'" height="{{layout.previewHeight}} + \'px\'" ng-click="ctrls.LayoutsCtrl.applyWithoutScroll($index, ctrls.LayoutsCtrl.extPaletteSpreadItems)" sf-draggable="" drag-asset="layout" location="palette"/> <i class="removable-handler" ng-click="ctrls.LayoutsCtrl.onRemoveFromProject(layout.assetId);ctrls.LayoutsCtrl.itemHover = null; ctrls.LayoutsCtrl.markedAsRemoveItemId = layout.assetId" data-test-key="button_ep_spread_layout_remove"></i></div></li><li ng-repeat="layout in ctrls.LayoutsCtrl.extPaletteItems track by layout.assetId" data-test-key="{{::\'palette_layout_item_\' + layout.assetId}}" ng-class="{\'hide\': layout.assetId==ctrls.LayoutsCtrl.markedAsRemoveItemId}"><div class="palette-renderer-wrapper palette-renderer-wrapper--extended" ng-mouseenter="ctrls.LayoutsCtrl.itemHover = layout;" ng-mousedown="ctrls.LayoutsCtrl.itemHover = null;" palette-renderer="layout" ng-class="{\'selected\': (layout.assetId == ctrls.LayoutsCtrl.selectedLayoutId), \'palette-renderer-wrapper--spread\':layout.isSpread()}"><img id="{{::\'_\' + layout.assetId}}" class="layouts palette-item" ng-class="ctrls.LayoutsCtrl.layoutThumbnailClass(layout)" sf-priority-src="layout.previewUrl" sf-priority="priority" sf-priority-onload="src" width="{{layout.previewWidth}} + \'px\'" height="{{layout.previewHeight}} + \'px\'" ng-click="ctrls.LayoutsCtrl.applyWithoutScroll($index, ctrls.LayoutsCtrl.extPaletteItems)" sf-draggable="" drag-asset="layout" location="palette"/> <i class="removable-handler" ng-click="ctrls.LayoutsCtrl.onRemoveFromProject(layout.assetId);ctrls.LayoutsCtrl.itemHover = null; ctrls.LayoutsCtrl.markedAsRemoveItemId = layout.assetId" data-test-key="button_ep_layout_remove"></i></div></li><li class="extended-separator" ng-if="ctrls.LayoutsCtrl.extPaletteSpreadItems.length > 0 || ctrls.LayoutsCtrl.extPaletteItems.length > 0" ng-mouseenter="ctrls.LayoutsCtrl.itemHover = null;"></li><li ng-if="!ctrls.NavCtrl.selectedPage.isTitlePage()" ng-repeat="layout in ctrls.LayoutsCtrl.paletteSpreadLayouts track by layout.assetId" data-test-key="{{::\'palette_layout_item_\' + layout.assetId}}"><div class="palette-renderer-wrapper" ng-mouseenter="ctrls.LayoutsCtrl.itemHover = layout;" ng-mousedown="ctrls.LayoutsCtrl.itemHover = null;" palette-renderer="layout" ng-class="{\'selected\': (layout.assetId == ctrls.LayoutsCtrl.selectedLayoutId), \'palette-renderer-wrapper--spread\':layout.isSpread()}"><div id="{{::\'_\' + layout.assetId}}" class="layouts palette-item" ng-class="ctrls.LayoutsCtrl.layoutThumbnailClass(layout)" ng-click="ctrls.LayoutsCtrl.applyWithoutScroll($index, ctrls.LayoutsCtrl.paletteSpreadLayouts)" sf-draggable="" drag-asset="layout" location="palette"></div></div></li><li ng-repeat="layout in ctrls.LayoutsCtrl.paletteLayouts track by layout.assetId" data-test-key="{{::\'palette_layout_item_\' + layout.assetId}}"><div class="palette-renderer-wrapper" ng-mouseenter="ctrls.LayoutsCtrl.itemHover = layout;" ng-mousedown="ctrls.LayoutsCtrl.itemHover = null;" palette-renderer="layout" ng-class="{\'selected\': (layout.assetId == ctrls.LayoutsCtrl.selectedLayoutId), \'palette-renderer-wrapper--spread\':layout.isSpread()}"><div id="{{::\'_\' + layout.assetId}}" class="layouts palette-item" ng-class="ctrls.LayoutsCtrl.layoutThumbnailClass(layout)" ng-click="ctrls.LayoutsCtrl.applyWithoutScroll($index, ctrls.LayoutsCtrl.paletteLayouts)" sf-draggable="" drag-asset="layout" location="palette"></div></div></li><li ng-if="(!ctrls.LayoutsCtrl.paletteLayouts.length) && ctrls.NavCtrl.selectedPage.isCover()" class="no-palette-for-page-container"><div class="no-palette-for-page no-palette-for-page--layouts">{{::\'Palette.NoItemForCover\'|translate}}</div></li></ul></scroll-synchronizer><positionable ng-if="ctrls.LayoutsCtrl.itemHover" delay="{{ctrls.MainCtrl.hoverDelay}}" target="#_{{ctrls.LayoutsCtrl.itemHover.assetId}}" placement="right" h-spacing="10" v-spacing="-70" width="{{ctrls.LayoutsCtrl.itemHover.previewWidth}}" height="{{ctrls.LayoutsCtrl.itemHover.previewHeight}}" z-index="1200" class="shadow-box"><div id="palette-preview-container" class="preview-container" data-test-key="div_layout_preview_{{ctrls.LayoutsCtrl.itemHover.assetId}}" ng-if="ctrls.LayoutsCtrl.itemHover && ctrls.LayoutsCtrl.itemHover.assetId"><div class="palette-wrapper" ng-style="{width: ctrls.LayoutsCtrl.itemHover.previewWidth + \'px\', height: ctrls.LayoutsCtrl.itemHover.previewHeight + \'px\'}"><div id="_{{ctrls.LayoutsCtrl.itemHover.assetId}}" ng-if="!ctrls.LayoutsCtrl.itemHover.isExtPalItem" class="preview-asset layouts" ng-class="ctrls.LayoutsCtrl.layoutThumbnailClass(ctrls.LayoutsCtrl.itemHover)"></div><img ng-src="{{ctrls.LayoutsCtrl.config.protocolRelativeUrl(ctrls.LayoutsCtrl.itemHover.previewUrl)}}" ng-if="ctrls.LayoutsCtrl.itemHover.isExtPalItem" class="preview-asset layouts"/></div></div></positionable>'),a.put("Palette/views/left-nav.html",'<div class="event-dialog-items" ng-click="ctrls.PaletteCtrl.PaletteTabSelection.layouts = true" ng-class="{selected: (ctrls.PaletteCtrl.PaletteTabSelection.layouts == true)}"><i class="icon-layouts-normal" ng-class="{\'icon-layouts-selected\': ctrls.PaletteCtrl.PaletteTabSelection.layouts == true}"></i> <span class="event-dialog-text">{{::\'Palette.layouts\'|translate}}</span><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.layouts == true" class="palette-dialog-arrow"></div></div><div class="event-dialog-items" ng-click="ctrls.PaletteCtrl.PaletteTabSelection.backgrounds = true" ng-class="{selected: (ctrls.PaletteCtrl.PaletteTabSelection.backgrounds == true)}"><i class="icon-backgrounds-normal" ng-class="{\'icon-backgrounds-selected\': ctrls.PaletteCtrl.PaletteTabSelection.backgrounds == true}"></i> <span class="event-dialog-text">{{::\'Palette.backgrounds\'|translate}}</span><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.backgrounds == true" class="palette-dialog-arrow"></div></div><div class="event-dialog-items" ng-if="ctrls.MainCtrl.features.embellishments" ng-click="ctrls.PaletteCtrl.PaletteTabSelection.embellishments = true" ng-class="{selected: (ctrls.PaletteCtrl.PaletteTabSelection.embellishments == true)}"><i class="icon-embellishments-normal" ng-class="{\'icon-embellishments-selected\': ctrls.PaletteCtrl.PaletteTabSelection.embellishments == true}"></i> <span class="event-dialog-text">{{::\'Palette.embellishments\'|translate}}</span><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.embellishments == true" class="palette-dialog-arrow"></div></div><div class="event-dialog-items" ng-click="ctrls.PaletteCtrl.PaletteTabSelection.ideaPages = true" ng-class="{selected: (ctrls.PaletteCtrl.PaletteTabSelection.ideaPages == true)}"><i class="icon-ideapages-normal" ng-class="{\'icon-ideapages-selected\': ctrls.PaletteCtrl.PaletteTabSelection.ideaPages == true}"></i> <span class="event-dialog-text">{{::\'Palette.ideaPages\'|translate}}</span><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.ideaPages == true" class="palette-dialog-arrow"></div></div>'),a.put("Palette/views/pages-in-arrange-tab.html",'<scroll-synchronizer id="arrange_page_scroller" ng-if="ctrls.PagesCtrl.project.product.pages.length>0" watch-on="ctrls.ArrangeTabCtrl.currentPaletteItemIndex" action-when="ctrls.NavCtrl.arrangeIsActive" pad-top="10" pad-left="0" sf-drag-scroll="" scroll-direction="\'vertical\'" target-elements-classifier=".sf-page-selected" class="clearfix palette-body pages-tab allowVerticalScroll page-{{ctrls.MainCtrl.project.product.aspectRatio}}" ng-class="{\'advanced-arrange\':ctrls.MainCtrl.config.advancedArrange}" data-test-key="div_pages-arrange"><div class="inline-block" ng-class="::{\'arrange-spread\': !ctrls.MainCtrl.isDeviceAPhone()}"><div class="single-page-wrapper" ng-class="::{\'page-thumbnail-arrange-simple\': !ctrls.MainCtrl.isDeviceAPhone() && ctrls.MainCtrl.superSimple,\n                    \'page-thumbnail-arrange\': !ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone(),\n                    \'page-thumbnail\': ctrls.MainCtrl.isDeviceAPhone()}" style="visibility: hidden"><sf-simple-page ng-if="::!ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.frontFillerPage" width="194" height="140"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.frontFillerPage" width="97" height="70"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.frontFillerPage" width="243" height="175"></sf-simple-page></div><div class="inline-block between-pages collapsed" ng-class="::{\'between-pages-arrange\': !ctrls.MainCtrl.isDeviceAPhone(), \'between-pages--phone\': ctrls.MainCtrl.isDeviceAPhone()}"></div><div class="single-page-wrapper clickable" ng-click="ctrls.PagesCtrl.selectFrontCover()" ng-dblclick="ctrls.ArrangeTabCtrl.handleDoubleClick()" ng-class="{\'page-hovered\': ctrls.ArrangeTabCtrl.hoverMap[\'frontPage\'],\n                    \'sf-page-selected\': ctrls.NavCtrl.selectedPage.isFrontCover(),\n                    \'page-thumbnail-arrange-simple\': !ctrls.MainCtrl.isDeviceAPhone() && ctrls.MainCtrl.superSimple,\n                    \'page-thumbnail-arrange\': !ctrls.MainCtrl.isDeviceAPhone() && !ctrls.MainCtrl.superSimple,\n                    \'page-thumbnail\': ctrls.MainCtrl.isDeviceAPhone(),\n                    \'filler-arrange-margin--phone\': ctrls.MainCtrl.isDeviceAPhone()}" ng-mouseenter="ctrls.ArrangeTabCtrl.updateHoverState(\'frontPage\', true)" ng-mouseleave="ctrls.ArrangeTabCtrl.updateHoverState(\'frontPage\', false)" data-test-key="arrange_cover_front"><sf-page-warning page="ctrls.PagesCtrl.project.product.cover.frontPage"></sf-page-warning><sf-simple-page ng-if="::!ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.cover.frontPage" width="194" height="140" class="page-shadow" ng-class="{\'page-stock-cover\': ctrls.PagesCtrl.project.product.cover.isStockCover}"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.cover.frontPage" width="97" height="70" ng-class="{\'page-stock-cover\': ctrls.PagesCtrl.project.product.cover.isStockCover}"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.cover.frontPage" width="243" height="175" ng-class="{\'page-stock-cover\': ctrls.PagesCtrl.project.product.cover.isStockCover}"></sf-simple-page><div ng-if="!ctrls.MainCtrl.config.advancedArrange" class="inner-page-tooltip" tooltip-append-to-body="true" tooltip="{{ctrls.ArrangeTabCtrl.arrangeCoverPageTooltip}}" tooltip-trigger="mouseenter" tooltip-placement="top"></div><div class="page-number page-number-arrange clickable" tooltip-append-to-body="true" tooltip="{{ctrls.ArrangeTabCtrl.arrangeCoverPageTooltip}}" tooltip-trigger="mouseenter" tooltip-placement="bottom"><span ng-class="::{\'page-number-arrange-phone\': ctrls.MainCtrl.isDeviceAPhone()}">{{::\'Palette.frontCover\'|translate}}</span></div><div ng-controller="LayoutsCtrl" class="layout-switcher-inarrange" ng-if="::ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" tooltip-append-to-body="true" tooltip="{{ctrls.ArrangeTabCtrl.arrangeCoverPageLayoutsTooltip}}" tooltip-trigger="mouseenter" tooltip-placement="bottom"><a data-test-key="button_switch_layouts" ng-click="ctrls.LayoutsCtrl.applyNextWithoutScrollCover()" class="tool-icon clickable"><i class="icon icon-switch-layouts"></i></a></div></div><div class="inline-block between-pages" ng-class="::{\'between-pages-arrange\': !ctrls.MainCtrl.isDeviceAPhone(), \'between-pages-arrange-wider\': !ctrls.MainCtrl.isDeviceAPhone(), \'between-pages--phone\': ctrls.MainCtrl.isDeviceAPhone()}"></div></div><div class="inline-block" ng-class="::{\'arrange-spread\': !ctrls.MainCtrl.isDeviceAPhone()}"><div class="single-page-wrapper clickable" ng-click="ctrls.PagesCtrl.selectFrontFiller()" ng-dblclick="ctrls.ArrangeTabCtrl.handleDoubleClick()" ng-class="{\'sf-page-selected\':ctrls.NavCtrl.selectedPage.isFrontFiller(),\n                    \'page-thumbnail-arrange-simple\': !ctrls.MainCtrl.isDeviceAPhone() && ctrls.MainCtrl.superSimple,\n                    \'page-thumbnail-arrange\': !ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone(),\n                    \'page-thumbnail\': ctrls.MainCtrl.isDeviceAPhone()}" data-test-key="arrange_filler_front"><sf-simple-page ng-if="::!ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.frontFillerPage" width="194" height="140" class="page-shadow"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.frontFillerPage" width="97" height="70"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.frontFillerPage" width="243" height="175"></sf-simple-page><div class="left-page page-number page-number-arrange clickable"><span></span></div></div><div class="inline-block between-pages collapsed-filler"></div><div class="single-page-wrapper clickable" sf-page-moveable-target="" move-page-number="{{ctrls.PagesCtrl.project.product.pages[0].surfaceNumber}}" ng-class="{\'page-hovered\': ctrls.ArrangeTabCtrl.hoverMap[\'titlePage\'],\n                    \'right-page\': true,\n                    \'sf-page-selected\': ctrls.NavCtrl.selectedPage == ctrls.PagesCtrl.project.product.pages[0],\n                    \'inner-page-arrange-margin\': !ctrls.MainCtrl.isDeviceAPhone(), \'inner-page-arrange-margin--phone\': ctrls.MainCtrl.isDeviceAPhone(),\n                    \'page-thumbnail-arrange-simple\': !ctrls.MainCtrl.isDeviceAPhone() && ctrls.MainCtrl.superSimple,\n                    \'page-thumbnail-arrange\': !ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone(),\n                    \'page-thumbnail\': ctrls.MainCtrl.isDeviceAPhone()}" ng-mouseenter="ctrls.ArrangeTabCtrl.updateHoverState(\'titlePage\', true)" ng-mouseleave="ctrls.ArrangeTabCtrl.updateHoverState(\'titlePage\', false)" ng-click="ctrls.PagesCtrl.selectPage(ctrls.PagesCtrl.project.product.pages[0])" ng-dblclick="ctrls.ArrangeTabCtrl.handleDoubleClick()" data-test-key="arrange_page_1"><sf-page-warning page="ctrls.PagesCtrl.project.product.pages[0]"></sf-page-warning><div sly-evaluate-me="ctrls.NavCtrl.selectedPage == ctrls.PagesCtrl.project.product.pages[0] ||\n                              ctrls.PagesCtrl.evalAllPages ||\n                              ctrls.ArrangeTabCtrl.hoverMap[\'titlePage\'] ||\n                              ctrls.PagesCtrl.surfaceNumbersInvalidated[ctrls.PagesCtrl.project.product.pages[0].surfaceNumber]"><sf-simple-page ng-if="::!ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.pages[0]" width="194" height="140" class="page-shadow"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.pages[0]" width="97" height="70"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.pages[0]" width="243" height="175"></sf-simple-page></div><div ng-if="!ctrls.MainCtrl.config.advancedArrange" class="inner-page-tooltip" tooltip-append-to-body="true" tooltip="{{ctrls.ArrangeTabCtrl.arrangeCoverPageTooltip}}" tooltip-trigger="mouseenter" tooltip-placement="top"></div><div class="page-number page-number-arrange clickable" tooltip-append-to-body="true" tooltip="{{ctrls.ArrangeTabCtrl.arrangeCoverPageTooltip}}" tooltip-trigger="mouseenter" tooltip-placement="bottom"><span>1</span></div></div><div class="move-sibling inline-block between-pages" ng-class="::{\'between-pages-arrange\': !ctrls.MainCtrl.isDeviceAPhone(), \'between-pages--phone\': ctrls.MainCtrl.isDeviceAPhone()}" sf-page-moveable-target="" move-page-number="{{ctrls.PagesCtrl.project.product.pages[0].surfaceNumber}}"><div class="move-target-highlight"></div></div></div><div class="clickable inline-block" ng-class="::{\'arrange-spread\': !ctrls.MainCtrl.isDeviceAPhone()}" ng-repeat="spread in ctrls.PagesCtrl.project.product.spreads track by spread.id"><div class="single-page-wrapper clickable inline-block" ng-class="{\'spread-page-layout\':page.isSpread(),\n                    \'auto-moved\': ctrls.PagesCtrl.autoMoveNumber == page.surfaceNumber}" ng-if="!ctrls.PagesCtrl.project.product.pageBySurfaceNumber(page.surfaceNumber-1).isSpread()" ng-repeat="page in spread track by page.uid"><div sf-page-moveable-source="" sf-page-moveable-target="" move-page-number="{{page.surfaceNumber}}" ng-class="{\'page-hovered\': ctrls.ArrangeTabCtrl.hoverMap[page.uid],\n                        \'right-page\': ($index % 2 != 0) || page.isSpread(),\n                        \'sf-page-selected\': ctrls.NavCtrl.selectedPage == page,\n                        \'page-thumbnail-arrange-simple\': !ctrls.MainCtrl.isDeviceAPhone() && ctrls.MainCtrl.superSimple,\n                        \'page-thumbnail-arrange\': !ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone(),\n                        \'page-thumbnail\': ctrls.MainCtrl.isDeviceAPhone()}" ng-mouseenter="ctrls.ArrangeTabCtrl.updateHoverState(page.uid, true)" ng-mouseleave="ctrls.ArrangeTabCtrl.updateHoverState(page.uid, false)" ng-click="ctrls.PagesCtrl.selectPage(page)" ng-dblclick="ctrls.ArrangeTabCtrl.handleDoubleClick()" data-test-key="arrange_page_{{::page.surfaceNumber}}"><sf-page-warning page="page"></sf-page-warning><div ng-class="::{\'page-loading-indicator-arrange\': !ctrls.MainCtrl.isDeviceAPhone(), \'page-loading-indicator-arrange-phone\': ctrls.MainCtrl.isDeviceAPhone()}"></div><div sly-evaluate-me="(ctrls.NavCtrl.activeLeftPage == page || ctrls.NavCtrl.activeRightPage == page) ||\n                                  ctrls.ArrangeTabCtrl.hoverMap[page.uid] ||\n                                  ctrls.PagesCtrl.surfaceNumbersInvalidated[page.surfaceNumber]"><sf-simple-page ng-if="::!ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="page" width="page.isSpread() ? 388 : 194" height="140" data-hoverable="true" data-page-number="{{page.surfaceNumber}}" class="page-shadow"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.isDeviceAPhone()" page="page" width="page.isSpread() ? 194 : 97" height="70" data-hoverable="true" data-page-number="{{page.surfaceNumber}}"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="page" width="page.isSpread() ? 486 : 243" height="175" data-hoverable="true" data-page-number="{{page.surfaceNumber}}"></sf-simple-page></div><div ng-if="!ctrls.MainCtrl.config.advancedArrange" class="inner-page-tooltip" tooltip-append-to-body="true" tooltip="{{ctrls.ArrangeTabCtrl.arrangeInnerPageTooltipDynamicString}}" tooltip-trigger="mouseenter" tooltip-placement="top"></div><div class="page-remove-arrange" tooltip-append-to-body="true" tooltip="{{::\'SilverApp.removePageTooltip\' | translate}}" tooltip-trigger="mouseenter" ng-click="ctrls.SurfaceCtrl.onRemovePage(page)" ng-mouseenter="ctrls.ArrangeTabCtrl.arrangeInnerPageTooltipDynamicString=\'\'" ng-mouseleave="ctrls.ArrangeTabCtrl.arrangeInnerPageTooltipDynamicString=ctrls.ArrangeTabCtrl.arrangeInnerPageTooltip" data-clickable="true" data-test-key="button_arrange_remove_{{::page.surfaceNumber}}" data-assetType="page-remove-handle-arrange"></div><div class="page-number page-number-arrange clickable" tooltip-append-to-body="true" tooltip="{{ctrls.ArrangeTabCtrl.arrangeInnerPageTooltipDynamicString}}" tooltip-trigger="mouseenter" tooltip-placement="bottom"><span>{{::page.surfaceNumber}}</span></div><div ng-if="page.isSpread()" class="right-spread-page-number page-number-arrange clickable" tooltip-append-to-body="true" tooltip="{{ctrls.ArrangeTabCtrl.arrangeInnerPageTooltipDynamicString}}" tooltip-trigger="mouseenter" tooltip-placement="bottom"><span>{{::page.surfaceNumber + 1}}</span></div></div><div class="move-sibling" sf-page-moveable-target="" ng-class="{\'inline-block\': true,\n                        \'between-pages\': true,\n                        \'between-pages-arrange\': !ctrls.MainCtrl.isDeviceAPhone(),\n                        \'between-pages--phone\': ctrls.MainCtrl.isDeviceAPhone(),\n                        collapsed: $even && !page.isSpread()}" move-page-number="{{page.surfaceNumber}}"><div class="move-target-highlight"></div></div></div></div><div class="inline-block" ng-class="::{\'arrange-spread\': !ctrls.MainCtrl.isDeviceAPhone()}" ng-if="(ctrls.PagesCtrl.project.product.pages.length % 2) === 0"><div class="single-page-wrapper clickable inline-block" ng-class="{\'page-hovered\': ctrls.ArrangeTabCtrl.hoverMap[\'lastPage\'],\n                    \'sf-page-selected\': ctrls.NavCtrl.selectedPage == ctrls.PagesCtrl.project.product.lastPage(),\n                    \'page-thumbnail-arrange-simple\': !ctrls.MainCtrl.isDeviceAPhone() && ctrls.MainCtrl.superSimple,\n                    \'page-thumbnail-arrange\': !ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone(),\n                    \'page-thumbnail\': ctrls.MainCtrl.isDeviceAPhone()}" sf-page-moveable-source="" sf-page-moveable-target="" move-page-number="{{ctrls.PagesCtrl.project.product.pages[ctrls.PagesCtrl.project.product.pages.length-1].surfaceNumber}}" ng-mouseenter="ctrls.ArrangeTabCtrl.updateHoverState(\'lastPage\', true)" ng-mouseleave="ctrls.ArrangeTabCtrl.updateHoverState(\'lastPage\', false)" ng-dblclick="ctrls.ArrangeTabCtrl.handleDoubleClick()" ng-click="ctrls.PagesCtrl.selectLastPage()" data-test-key="arrange_page_{{ctrls.PagesCtrl.project.product.lastPage().surfaceNumber}}"><sf-page-warning page="ctrls.PagesCtrl.project.product.pages[ctrls.PagesCtrl.project.product.pages.length-1]"></sf-page-warning><div sly-evaluate-me="ctrls.NavCtrl.selectedPage == ctrls.PagesCtrl.project.product.pages[ctrls.PagesCtrl.project.product.pages.length-1] ||\n                             ctrls.PagesCtrl.evalAllPages ||\n                             ctrls.ArrangeTabCtrl.hoverMap[\'lastPage\'] ||\n                             ctrls.PagesCtrl.surfaceNumbersInvalidated[ctrls.PagesCtrl.project.product.pages[ctrls.PagesCtrl.project.product.pages.length-1].surfaceNumber]"><sf-simple-page ng-if="::!ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.lastPage()" width="194" height="140" data-hoverable="true" data-page-number="{{ctrls.PagesCtrl.project.product.lastPage().surfaceNumber}}" class="page-shadow"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.lastPage()" width="97" height="70" data-hoverable="true" data-page-number="{{ctrls.PagesCtrl.project.product.lastPage().surfaceNumber}}"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.lastPage()" width="243" height="175" data-hoverable="true" data-page-number="{{ctrls.PagesCtrl.project.product.lastPage().surfaceNumber}}"></sf-simple-page></div><div ng-if="!ctrls.MainCtrl.config.advancedArrange" class="inner-page-tooltip" tooltip-append-to-body="true" tooltip="{{ctrls.ArrangeTabCtrl.arrangeInnerPageTooltipDynamicString}}" tooltip-trigger="mouseenter" tooltip-placement="top"></div><div class="page-remove-arrange" tooltip-append-to-body="false" tooltip="{{::\'SilverApp.removePageTooltip\' | translate}}" ng-click="ctrls.SurfaceCtrl.onRemovePage(ctrls.PagesCtrl.project.product.lastPage())" tooltip-trigger="mouseenter" ng-mouseenter="ctrls.ArrangeTabCtrl.arrangeInnerPageTooltipDynamicString=\'\'" ng-mouseleave="ctrls.ArrangeTabCtrl.arrangeInnerPageTooltipDynamicString=ctrls.ArrangeTabCtrl.arrangeInnerPageTooltip" data-clickable="true" data-test-key="button_arrange_remove_last" data-assetType="page-remove-handle-arrange"></div><div class="page-number page-number-arrange clickable" tooltip-append-to-body="true" tooltip="{{ctrls.ArrangeTabCtrl.arrangeInnerPageTooltipDynamicString}}" tooltip-trigger="mouseenter" tooltip-placement="bottom"><span>{{ctrls.PagesCtrl.project.product.pages.length}}</span></div></div><div class="move-sibling inline-block between-pages collapsed-filler" sf-page-moveable-target="" ng-class="::{\'between-pages-arrange\': !ctrls.MainCtrl.isDeviceAPhone(), \'between-pages--phone\': ctrls.MainCtrl.isDeviceAPhone()}" move-page-number="{{ctrls.PagesCtrl.project.product.pages[ctrls.PagesCtrl.project.product.pages.length-1].surfaceNumber}}"><div class="move-target-highlight"></div></div><div class="single-page-wrapper clickable inline-block" ng-class="{\'sf-page-selected\': ctrls.NavCtrl.selectedPage.isBackFiller(),\n                    \'filler-arrange-margin\': !ctrls.MainCtrl.isDeviceAPhone(), \'filler-arrange-margin--phone\': ctrls.MainCtrl.isDeviceAPhone(),\n                    \'page-thumbnail-arrange-simple\': !ctrls.MainCtrl.isDeviceAPhone() && ctrls.MainCtrl.superSimple,\n                    \'page-thumbnail-arrange\': !ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone(),\n                    \'page-thumbnail\': ctrls.MainCtrl.isDeviceAPhone()}" ng-dblclick="ctrls.ArrangeTabCtrl.handleDoubleClick()" ng-click="ctrls.PagesCtrl.selectBackFiller()" sf-droppable="" drop-asset="{type:\'filler-asset\'}" drop-options="{}" location="back-filler-page" data-test-key="arrange_filler_back"><sf-simple-page ng-if="::!ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.backFillerPage" width="194" height="140" class="page-shadow"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.backFillerPage" width="97" height="70"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.backFillerPage" width="243" height="175"></sf-simple-page><div class="right-page page-number page-number-arrange clickable"><span></span></div></div><div class="single-page-wrapper clickable inline-block between-pages" ng-class="::{\'between-pages-arrange\': !ctrls.MainCtrl.isDeviceAPhone(), \'between-pages--phone\': ctrls.MainCtrl.isDeviceAPhone()}"></div></div><div class="inline-block last-spread" ng-class="::{\'arrange-spread\': !ctrls.MainCtrl.isDeviceAPhone()}"><div class="single-page-wrapper clickable" ng-class="::{\'page-thumbnail-arrange-simple\': !ctrls.MainCtrl.isDeviceAPhone() && ctrls.MainCtrl.superSimple,\n                    \'page-thumbnail-arrange\': !ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone(),\n                    \'page-thumbnail\': ctrls.MainCtrl.isDeviceAPhone()}" tooltip-append-to-body="true" tooltip="{{ctrls.ArrangeTabCtrl.arrangeInsertPageTooltip}}" tooltip-trigger="mouseenter" tooltip-placement="top" data-test-key="button_arrange_add_page" omniture="" linkname="{{ctrls.PageActionsCtrl.getOmniTrackLinkForAddPages(\'arrange\', \'pages\', \'inpages\')}}" ng-if="!ctrls.PageActionsCtrl.disabledAddPagesAtEnd && !ctrls.MainCtrl.superSimple" ng-click="ctrls.PageActionsCtrl.addPageAtEnd()"><sf-simple-page ng-if="::!ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.frontFillerPage" width="194" height="140" class="page-shadow"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.frontFillerPage" width="97" height="70"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.frontFillerPage" width="243" height="175"></sf-simple-page><div class="page-number"></div><div class="page-add-pages clickable"><div class="add-page-label"><div class="page-add-pages-icon"></div><span>{{::\'SilverApp.addPage\'|translate}}</span></div></div></div><div class="inline-block between-pages collapsed" ng-class="::{\'between-pages-arrange\': !ctrls.MainCtrl.isDeviceAPhone(), \'between-pages--phone\': ctrls.MainCtrl.isDeviceAPhone()}"></div><div ng-if="!ctrls.PagesCtrl.project.product.cover.isStockCover" class="single-page-wrapper clickable" ng-class="{\'page-hovered\': ctrls.ArrangeTabCtrl.hoverMap[\'backPage\'],\n                    \'sf-page-selected\': ctrls.NavCtrl.selectedPage.isBackCover(),\n                    \'page-thumbnail-arrange-simple\': !ctrls.MainCtrl.isDeviceAPhone() && ctrls.MainCtrl.superSimple,\n                    \'page-thumbnail-arrange\': !ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone(),\n                    \'page-thumbnail\': ctrls.MainCtrl.isDeviceAPhone()}" ng-click="ctrls.PagesCtrl.selectBackCover()" ng-dblclick="ctrls.ArrangeTabCtrl.handleDoubleClick()" ng-mouseenter="ctrls.ArrangeTabCtrl.updateHoverState(\'backPage\', true)" ng-mouseleave="ctrls.ArrangeTabCtrl.updateHoverState(\'backPage\', false)" data-test-key="arrange_cover_back"><sf-page-warning page="ctrls.PagesCtrl.project.product.cover.backPage"></sf-page-warning><sf-simple-page ng-if="::!ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.cover.backPage" width="194" height="140" class="page-shadow"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.cover.backPage" width="97" height="70"></sf-simple-page><sf-simple-page ng-if="::ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.isDeviceAPhone()" page="ctrls.PagesCtrl.project.product.cover.backPage" width="243" height="175"></sf-simple-page><div ng-if="!ctrls.MainCtrl.config.advancedArrange" class="inner-page-tooltip" tooltip-append-to-body="true" tooltip="{{ctrls.ArrangeTabCtrl.arrangeCoverPageTooltip}}" tooltip-trigger="mouseenter" tooltip-placement="top"></div><div class="page-number page-number-arrange clickable" tooltip-append-to-body="true" tooltip="{{ctrls.ArrangeTabCtrl.arrangeCoverPageTooltip}}" tooltip-trigger="mouseenter" tooltip-placement="bottom"><span>{{::\'Palette.backCover\'|translate}}</span></div></div></div></scroll-synchronizer>'),
a.put("Palette/views/pages-in-smartStoryboard.html",'<ul class="list-unstyled list-unstyled-margin clearfix"><li class="smartStoryboard-pages" data-test-key="storyboard_page_0"><div class="smartStoryboard-leftPage-label"><span class="pull-left">{{::\'SilverApp.smartStoryboard.blankPage\' | translate}}</span></div><ul class="list-unstyled image-list list-inline smartStoryboard-page" ng-class="{\'expanded\' : ctrls.StoryboardTabCtrl.shouldExpandPage(0)}"></ul></li><li class="smartStoryboard-pages" data-test-key="storyboard_page_{{page.surfaceNumber}}" ng-repeat="page in ctrls.PagesCtrl.productSpecificPages track by page.uid" ng-class="{\'expanded\': ctrls.StoryboardTabCtrl.shouldExpandPage(page.surfaceNumber),\n                   \'spread\': page.isSpread()}" sf-droppable="" indicate-droppable="false" drop-asset="asset" drop-options="{pageNumber: page.surfaceNumber}" location="storyboard_background" ng-if="!ctrls.PagesCtrl.project.product.pageBySurfaceNumber(page.surfaceNumber-1).isSpread()"><div ng-if="page.surfaceNumber % 2 == 0" class="smartStoryboard-leftPage-label"><span class="pull-left">{{ page.surfaceNumber | postfixTranslate:\'SilverApp.Page\' }}</span></div><div ng-if="page.surfaceNumber % 2 == 1 || page.isSpread()" class="smartStoryboard-rightPage-label" ng-class="{\'spread\': page.isSpread()}"><div ng-if="page.surfaceNumber != 1" class="pull-left"><span ng-if="page.isSpread()" class="icon-splitSpread clickable" tooltip="{{::\'SilverApp.smartStoryboard.splitSpread.tooltip\' | translate}}" tooltip-trigger="mouseenter" tooltip-append-to-body="true" ng-click="ctrls.PagesCtrl.selectPage(page); ctrls.PageActionsCtrl.breakSpread()" data-test-key="icon_split_spread"></span> <span ng-if="!page.isSpread()" class="icon-makeSpread clickable" tooltip="{{::\'SilverApp.smartStoryboard.makeSpread.tooltip\' | translate}}" tooltip-trigger="mouseenter" tooltip-append-to-body="true" ng-click="ctrls.PagesCtrl.selectPage(page); ctrls.PageActionsCtrl.makeSpread()" data-test-key="icon_make_spread"></span></div><span ng-if="!page.isSpread()" class="pull-right">{{ page.surfaceNumber | postfixTranslate:\'SilverApp.Page\' }}</span> <span ng-if="page.isSpread()" class="pull-right">{{ page.surfaceNumber + 1 | postfixTranslate:\'SilverApp.Page\' }}</span></div><ul class="list-unstyled image-list list-inline clickable smartStoryboard-page" sf-vertical-scroll="" ng-click="ctrls.PagesCtrl.selectPage(page)" ng-dblclick="ctrls.ArrangeTabCtrl.handleDoubleClick()" ng-class="{\'expanded\' : ctrls.StoryboardTabCtrl.shouldExpandPage(page.surfaceNumber),\n                     \'spread\' : page.isSpread(),\n                     \'storyboard-page-selected\': ctrls.NavCtrl.selectedPage == page}" ng-mouseleave="ctrls.ImageCtrl.arrangePageImageHover = null"><li ng-repeat="asset in page.getImages()" ng-class="{\'has-error\': ctrls.StoryboardTabCtrl.getImage(asset).hasError,\n                        \'spread\': page.isSpread()}" data-test-key="{{::\'storyboard_page_\' + page.surfaceNumber + \'_photo_\' + asset.projectImageId}}"><img class="palette-image-thumbnail clickable" id="{{::\'_\' + page.surfaceNumber + \'_\' + asset.projectImageId}}" ng-style="{\'background-image\':\'url({{ctrls.StoryboardTabCtrl.getImage(asset).thumbSrc}})\'}" ng-mouseenter="ctrls.ImageCtrl.arrangePageImageHover = asset; ctrls.ImageCtrl.arrangePagePageHover = page.surfaceNumber;" ng-mousedown="ctrls.ImageCtrl.arrangePageImageHover = null;" width="100%" height="100%" ng-src="{{::ctrls.StoryboardTabCtrl.config.TRANSPARENT_IMAGE}}" sf-draggable="" update-stage="true" drag-asset="asset" drag-options="{pageNumber: page.surfaceNumber, useCustomAvatar: true}" location="storyboard_page"/> <i class="image-remove" ng-click="ctrls.SurfaceCtrl.removeImageFromPageAndAdapt(page, asset)" data-test-key="button_photo_remove"></i> <span class="image-error-indicator" data-test-key="icon_photo_error"></span></li></ul><div ng-if="page.isEmpty()" class="empty-page-small" tooltip-append-to-body="true" tooltip="{{::\'SilverApp.dragPhotoToPage\' | translate}}" tooltip-trigger="mouseenter" data-test-key="empty_page_indicator" sf-droppable="" indicate-droppable="false" drop-asset="asset" drop-options="{pageNumber: page.surfaceNumber}" location="storyboard_background"></div><span class="icon ng-hide" ng-class="{\'icon-contract-tray\': !ctrls.StoryboardTabCtrl.shouldExpandPage(page.surfaceNumber),\n                        \'icon-expand-tray\': ctrls.StoryboardTabCtrl.shouldExpandPage(page.surfaceNumber)}" ng-click="ctrls.StoryboardTabCtrl.toggleExpandCollapsePage(page)"></span></li><li class="smartStoryboard-pages clickable" ng-if="!ctrls.PageActionsCtrl.disabledAddPagesAtEnd" style="height: 200px" ng-click="ctrls.PageActionsCtrl.addPageAtEnd()" ng-class="{\'expanded\': ctrls.StoryboardTabCtrl.shouldExpandPage(ctrls.PagesCtrl.productSpecificPages.length + 1)}" omniture="" linkname="{{ctrls.PageActionsCtrl.getOmniTrackLinkForAddPages(\'storyboard\', \'pages\', \'inpages\')}}" data-test-key="button_add_page"><div class="clickable smartStoryboard-add-page" ng-class="{\'expanded\': ctrls.StoryboardTabCtrl.shouldExpandPage(ctrls.PagesCtrl.productSpecificPages.length + 1)}"><div class="add-page-label"><div class="page-add-pages-icon-large"></div><span>{{::\'SilverApp.addPage\'|translate}}</span></div></div></li></ul><positionable ng-if="ctrls.ImageCtrl.arrangePageImageHover" delay="{{ctrls.MainCtrl.hoverDelay}}" target="#_{{ctrls.ImageCtrl.arrangePagePageHover}}_{{ctrls.ImageCtrl.arrangePageImageHover.projectImageId}}" placement="left" h-spacing="200" v-spacing="-250" width="370" height="390" z-index="1200" class="shadow-box"><div id="image-preview-container" class="preview-container" ng-if="ctrls.ImageCtrl.arrangePageImageHover && ctrls.ImageCtrl.arrangePageImageHover.projectImageId>=0" data-test-key="div_photo_preview_{{ctrls.ImageCtrl.arrangePageImageHover.projectImageId}}"><div class="image-wrapper"><img class="preview-image" ng-src="{{ctrls.StoryboardTabCtrl.getImage(ctrls.ImageCtrl.arrangePageImageHover).previewSrc}}"/></div><div class="preview-footage" data-test-key="label_photo_preview">{{ctrls.ImageCtrl.getImageFooter(ctrls.StoryboardTabCtrl.getImage(ctrls.ImageCtrl.arrangePageImageHover))}}</div></div></positionable>'),a.put("Palette/views/pages-in-storyboard.html",'<ul class="list-unstyled list-unstyled-margin clearfix"><li class="storyboard-pages clickable" data-test-key="storyboard_page_{{page.surfaceNumber}}" ng-click="ctrls.PagesCtrl.selectPage(page)" ng-dblclick="ctrls.ArrangeTabCtrl.handleDoubleClick()" ng-repeat="page in ctrls.PagesCtrl.productSpecificPages track by page.uid" ng-class="{\'storyboard-pages-filler\': (page.surfaceNumber % 2 == 1) || page.isSpread(),\n                   \'storyboard-spread-page\': page.isSpread(),\n                   \'storyboard-page-selected\': ctrls.NavCtrl.selectedPage == page}" sf-droppable="" indicate-droppable="false" drop-asset="asset" drop-options="{pageNumber: page.surfaceNumber}" location="storyboard_background" ng-if="!ctrls.PagesCtrl.project.product.pageBySurfaceNumber(page.surfaceNumber-1).isSpread()"><div ng-include="\'Palette/views/@@p/storyboard-page-labels.html\'"></div><ul class="list-unstyled image-list list-inline storyboard-page" ng-mouseleave="ctrls.ImageCtrl.arrangePageImageHover = null"><li ng-repeat="asset in page.getImages()" ng-class="{\'has-error\': ctrls.StoryboardTabCtrl.getImage(asset).hasError}" data-test-key="{{::\'storyboard_page_\' + page.surfaceNumber + \'_photo_\' + asset.projectImageId}}\'"><img class="palette-image-thumbnail clickable" id="{{::\'_\' + page.surfaceNumber + \'_\' + asset.projectImageId}}" ng-src="{{ctrls.StoryboardTabCtrl.getImage(asset).thumbSrc}}" ng-mouseenter="ctrls.ImageCtrl.arrangePageImageHover = asset; ctrls.ImageCtrl.arrangePagePageHover = page.surfaceNumber;" ng-mousedown="ctrls.ImageCtrl.arrangePageImageHover = null;" width="::ctrls.StoryboardTabCtrl.getImage(asset).thumbSize.width" height="::ctrls.StoryboardTabCtrl.getImage(asset).thumbSize.height" sf-draggable="" update-stage="true" drag-asset="asset" drag-options="{pageNumber: page.surfaceNumber}" location="storyboard_page"/> <i class="image-remove" ng-click="ctrls.SurfaceCtrl.removeImageFromPageAndAdapt(page, asset)" data-test-key="button_photo_remove"></i> <span class="image-error-indicator" data-test-key="icon_photo_error"></span></li></ul><div ng-if="page.isEmpty()" class="empty-page-small" tooltip-append-to-body="true" tooltip="{{::\'SilverApp.dragPhotoToPage\' | translate}}" tooltip-trigger="mouseenter" data-test-key="empty_page_indicator" sf-droppable="" indicate-droppable="false" drop-asset="asset" drop-options="{pageNumber: page.surfaceNumber}" location="storyboard_background"></div></li><div ng-include="\'Palette/views/@@p/storyboard-add-page.html\'"></div></ul><positionable ng-if="ctrls.ImageCtrl.arrangePageImageHover" delay="{{ctrls.MainCtrl.hoverDelay}}" target="#_{{ctrls.ImageCtrl.arrangePagePageHover}}_{{ctrls.ImageCtrl.arrangePageImageHover.projectImageId}}" placement="left" h-spacing="200" v-spacing="-250" width="370" height="390" z-index="1200" class="shadow-box"><div id="image-preview-container" class="preview-container" ng-if="ctrls.ImageCtrl.arrangePageImageHover && ctrls.ImageCtrl.arrangePageImageHover.projectImageId>=0" data-test-key="div_photo_preview_{{ctrls.ImageCtrl.arrangePageImageHover.projectImageId}}"><div class="image-wrapper"><img class="preview-image" ng-src="{{ctrls.StoryboardTabCtrl.getImage(ctrls.ImageCtrl.arrangePageImageHover).previewSrc}}"/></div><div class="preview-footage" data-test-key="label_photo_preview">{{ctrls.ImageCtrl.getImageFooter(ctrls.StoryboardTabCtrl.getImage(ctrls.ImageCtrl.arrangePageImageHover))}}</div></div></positionable>'),a.put("Palette/views/palette.html","<div ng-controller=\"PaletteCtrl\" ng-class=\"{'secondary-palette-expanded': ctrls.PaletteCtrl.isDualPaletteMode && ctrls.PaletteCtrl.secondaryPalette.isExpanded,\n     'secondary-palette-expanded-customize': ctrls.CustomizeCtrl.isCustomizing(),\n     'secondary-palette-collapsed': ctrls.PaletteCtrl.isDualPaletteMode && !ctrls.PaletteCtrl.secondaryPalette.isExpanded,\n     'with-idea-pages-and-embellishments': ctrls.MainCtrl.features.embellishments,\n     'with-idea-pages': !ctrls.MainCtrl.features.embellishments\n     }\" ng-click=\"ctrls.CustomizeCtrl.deselectAll()\" data-test-key=\"primary_palette\"><div ng-if=\"ctrls.PaletteCtrl.appState.twoPageSpreadHasLoaded && !ctrls.PaletteCtrl.calendarPaletteMode\" class=\"palette-tabs app-footer clearfix\" ng-class=\"{'new-nav': ctrls.NavCtrl.showNewNavigation, 'expanded': ctrls.PaletteCtrl.lowerPaletteIsExpanded, 'collapsed': ctrls.PaletteCtrl.lowerPaletteIsCollapsed, 'advanced-edit-shadow-grey': ctrls.CustomizeCtrl.isCustomizing(), 'advanced-edit-shadow-white': !ctrls.CustomizeCtrl.isCustomizing()}\"><div ng-include=\"'Palette/views/@@p/primary-palette-tabs.html'\" ng-class=\"{'advanced-edit-nav-tabs-grey': ctrls.CustomizeCtrl.isCustomizing(), 'advanced-edit-nav-tabs-white': !ctrls.CustomizeCtrl.isCustomizing()}\"></div></div><div class=\"secondary-palette\" ng-class=\"{'new-nav': ctrls.NavCtrl.showNewNavigation, 'secondary-palette-background-none': ctrls.CustomizeCtrl.isCustomizing(), 'secondary-palette-expanded-4-wide': ctrls.PaletteCtrl.calendarPaletteMode}\" ng-if=\"ctrls.PaletteCtrl.isDualPaletteMode && ctrls.PaletteCtrl.appState.twoPageSpreadHasLoaded\" data-test-key=\"secondary_palette\"><div ng-if=\"ctrls.NavCtrl.showNewNavigation\" ng-include=\"'Palette/views/@@p/left-nav.html'\" class=\"left-nav event-dialog-arrow\"></div><div ng-include=\"'Palette/views/@@p/secondary-palette-tabs.html'\" ng-class=\"{'advanced-edit-nav-tabs-grey': ctrls.CustomizeCtrl.isCustomizing(), 'advanced-edit-nav-tabs-white': !ctrls.CustomizeCtrl.isCustomizing()}\"></div></div></div>"),a.put("Palette/views/pb/idea-pages.html","<div ng-include=\"'Palette/views/idea-pages.html'\"></div>"),a.put("Palette/views/pb/layouts.html","<div ng-include=\"'Palette/views/layouts.html'\"></div>"),a.put("Palette/views/pb/left-nav.html","<ng-include src=\"'Palette/views/left-nav.html'\"></ng-include>"),a.put("Palette/views/pb/pages-tab.html",'<tab id="pagesTab" heading="{{::\'Book.Palette.pages\' | translate }}" data-test-key="tab_pages" class="clickable first-tab" ng-click="ctrls.PaletteCtrl.selectPaletteTab(\'pages\')" active="ctrls.PaletteCtrl.PaletteTabSelection.pages" tooltip-append-to-body="true" tooltip="{{\'SilverApp.tooltip.pagesTab\' | translate}}" select="ctrls.PagesCtrl.tabActivated()"><div ng-include="\'Palette/views/@@p/pages.html\'" include-replace=""></div></tab>'),a.put("Palette/views/pb/pages.html",'<div><div class="palette-subpalette"><a ng-if="ctrls.UppCtrl.allowUpload() && !ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.slideshow && !ctrls.MainCtrl.previewMode" class="pull-left upload-indicator" ng-click="ctrls.ImageCtrl.showUploadInProgressModal()" data-test-key="label_upload_in_progress" ng-show="ctrls.ImageCtrl.imageCollection.currentUploadTotal > 0">{{ctrls.ImageCtrl.imageCollection.currentUploadInProgress | postfixTranslate:\'Palette.uploadInProgress\'}}</a><div ng-hide="(ctrls.MainCtrl.superSimple || ctrls.MainCtrl.slideshow || ctrls.MainCtrl.previewMode)" ng-class="{\'disabled\': ctrls.PageActionsCtrl.disabledAddPages }" ng-click="ctrls.PageActionsCtrl.addPages()" omniture="" linkname="{{ctrls.PageActionsCtrl.getOmniTrackLinkForAddPages(ctrls.CustomizeCtrl.isCustomizing()?\'advanced-edit\':\'edit\', \'pagestab\', \'button\')}}" class="pull-right palette-header-text clickable add-pages" data-test-key="button_add_page_palette"><span disabled="disabled" class="icon icon-right-padded icon-add-page" ng-class="{\'icon-add-page-disabled\': ctrls.PageActionsCtrl.disabledAddPages}"></span> <span>{{::\'Palette.addPages\'|translate}}</span></div></div><div class="clickable expand" style="display: table;  margin: 0 auto" ng-if="!ctrls.NavCtrl.storyboardIsActive && !ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.slideshow" ng-hide="ctrls.MainCtrl.previewMode"><span ng-if="!ctrls.PaletteCtrl.lowerPaletteIsExpanded && !ctrls.PaletteCtrl.lowerPaletteIsCollapsed" class="icon icon-expand-tray" ng-click="ctrls.PaletteCtrl.toggleExpandLowerPalette()"></span> <span ng-if="ctrls.PaletteCtrl.lowerPaletteIsExpanded && !ctrls.PaletteCtrl.lowerPaletteIsCollapsed" class="icon icon-contract-tray" ng-click="ctrls.PaletteCtrl.toggleExpandLowerPalette()"></span> <span ng-if="!ctrls.PaletteCtrl.lowerPaletteIsCollapsed && !ctrls.PaletteCtrl.lowerPaletteIsExpanded" class="icon icon-contract-tray" ng-click="ctrls.PaletteCtrl.toggleCollapseLowerPalette()"></span> <span ng-if="ctrls.PaletteCtrl.lowerPaletteIsCollapsed  && !ctrls.PaletteCtrl.lowerPaletteIsExpanded" class="icon icon-expand-tray" ng-click="ctrls.PaletteCtrl.toggleCollapseLowerPalette()"></span></div><scroll-synchronizer id="page_scroller" ng-if="ctrls.MainCtrl.project" ng-class="::{\'pages-tab-tablet\': ctrls.MainCtrl.isDeviceATablet()}" watch-on="ctrls.PagesCtrl.currentPaletteItemIndex" action-when="ctrls.NavCtrl.editIsActive && (ctrls.MainCtrl.isDeviceATablet() || (!ctrls.MainCtrl.isDeviceATablet() && ctrls.PaletteCtrl.PaletteTabSelection.pages))" pad-left="0" pad-top="120" scroll-direction="\'horizontal\'" sf-drag-scroll="" target-elements-classifier=".sf-page-selected" class="clearfix palette-body pages-tab allowHorizontalScroll page-{{ctrls.MainCtrl.project.product.aspectRatio}}" data-test-key="div_pages"><div class="single-page-wrapper clickable front-cover" ng-class="{\'page-thumbnail-arrange\': ctrls.PaletteCtrl.lowerPaletteIsExpanded, \'page-thumbnail\': !ctrls.PaletteCtrl.lowerPaletteIsExpanded, \'sf-page-selected\': ctrls.NavCtrl.selectedPage.isFrontCover()}" ng-dblclick="ctrls.EditTabCtrl.handleFrontCoverPageDoubleClick()" ng-click="ctrls.NavCtrl.superSimpleTablet ? ctrls.NavCtrl.showSummary() : ctrls.PagesCtrl.selectFrontCover()" data-test-key="palette_cover_front"><sf-page-warning page="ctrls.PagesCtrl.project.product.cover.frontPage"></sf-page-warning><sf-simple-page ng-if="!ctrls.PaletteCtrl.lowerPaletteIsExpanded" page="ctrls.PagesCtrl.project.product.cover.frontPage" width="97" height="70" class="sf-simple-page--front-cover" ng-class="{\'page-stock-cover\': ctrls.PagesCtrl.project.product.cover.isStockCover}" priority="ctrls.PaletteCtrl.priorities.pages"></sf-simple-page><sf-simple-page ng-if="ctrls.PaletteCtrl.lowerPaletteIsExpanded" page="ctrls.PagesCtrl.project.product.cover.frontPage" width="194" height="140" class="sf-simple-page--front-cover" ng-class="{\'page-stock-cover\': ctrls.PagesCtrl.project.product.cover.isStockCover}" priority="ctrls.PaletteCtrl.priorities.pages"></sf-simple-page><div ng-if="!ctrls.MainCtrl.previewMode" class="inner-page-tooltip"></div><div class="page-number clickable">{{::\'Palette.frontCover\'|translate}}</div></div><div class="inline-block between-pages"></div><div class="single-page-wrapper clickable" ng-class="{\'page-thumbnail-arrange\': ctrls.PaletteCtrl.lowerPaletteIsExpanded, \'page-thumbnail\': !ctrls.PaletteCtrl.lowerPaletteIsExpanded}" ng-dblclick="ctrls.EditTabCtrl.handleFrontFillerPageDoubleClick()" ng-click="ctrls.PagesCtrl.selectFrontFiller()" data-test-key="palette_filler_front"><sf-simple-page ng-if="!ctrls.PaletteCtrl.lowerPaletteIsExpanded" page="ctrls.PagesCtrl.project.product.frontFillerPage" width="97" height="70" priority="ctrls.PaletteCtrl.priorities.pages"></sf-simple-page><sf-simple-page ng-if="ctrls.PaletteCtrl.lowerPaletteIsExpanded" page="ctrls.PagesCtrl.project.product.frontFillerPage" width="194" height="140" priority="ctrls.PaletteCtrl.priorities.pages"></sf-simple-page><div class="left-page page-number clickable"></div></div><div class="single-page-wrapper clickable inline-block" ng-class="{\'sf-page-selected\':ctrls.NavCtrl.selectedPage == ctrls.PagesCtrl.project.product.pages[0], \'right-page\': true}"><div ng-class="{\'page-thumbnail-arrange\': ctrls.PaletteCtrl.lowerPaletteIsExpanded, \'page-thumbnail\': !ctrls.PaletteCtrl.lowerPaletteIsExpanded}" ng-click="ctrls.PagesCtrl.selectPage(ctrls.PagesCtrl.project.product.pages[0])" ng-dblclick="ctrls.EditTabCtrl.handleInnerPageDoubleClick(ctrls.PagesCtrl.project.product.pages[0])" sf-page-moveable-target="" move-page-number="{{ctrls.PagesCtrl.project.product.pages[0].surfaceNumber}}" data-test-key="palette_page_1"><sf-page-warning page="ctrls.PagesCtrl.project.product.pages[0]"></sf-page-warning><div class="page-loading-indicator" ng-class="{\'page-loading-indicator-arrange\': ctrls.PaletteCtrl.lowerPaletteIsExpanded}"></div><div sly-evaluate-me="(ctrls.NavCtrl.activeLeftPage == ctrls.PagesCtrl.project.product.pages[0] ||\n                             ctrls.NavCtrl.activeRightPage == ctrls.PagesCtrl.project.product.pages[0]) ||\n                             ctrls.PagesCtrl.evalAllPages"><sf-simple-page ng-if="!ctrls.PaletteCtrl.lowerPaletteIsExpanded" page="ctrls.PagesCtrl.project.product.pages[0]" width="97" height="70" priority="ctrls.PaletteCtrl.priorities.pages"></sf-simple-page><sf-simple-page ng-if="ctrls.PaletteCtrl.lowerPaletteIsExpanded" page="ctrls.PagesCtrl.project.product.pages[0]" width="194" height="140" priority="ctrls.PaletteCtrl.priorities.pages"></sf-simple-page></div><div ng-if="!ctrls.MainCtrl.previewMode" class="inner-page-tooltip"></div><div class="page-number clickable">1</div></div><div class="move-sibling-tab inline-block between-pages" ng-class="{\'between-pages-arrange\': ctrls.PaletteCtrl.lowerPaletteIsExpanded, \'between-pages--phone\': ctrls.MainCtrl.isDeviceAPhone()}" sf-page-moveable-target="" move-page-number="{{ctrls.PagesCtrl.project.product.pages[0].surfaceNumber}}"><div class="move-target-highlight-tab"></div></div></div><div class="single-page-wrapper clickable inline-block" ng-repeat="page in ctrls.PagesCtrl.project.product.pages track by page.uid" ng-if="page.surfaceNumber != 1 &&\n              !ctrls.PagesCtrl.project.product.pageBySurfaceNumber(page.surfaceNumber-1).isSpread()" ng-class="{\'sf-page-selected\':ctrls.NavCtrl.selectedPage == page,\n                  \'right-page\': (page.surfaceNumber % 2 == 1) || page.isSpread(),\n                  \'spread-page-layout\':page.isSpread(),\n                  \'auto-moved\': ctrls.PagesCtrl.autoMoveNumber == page.surfaceNumber}"><div ng-class="{\'page-thumbnail-arrange\': ctrls.PaletteCtrl.lowerPaletteIsExpanded, \'page-thumbnail\': !ctrls.PaletteCtrl.lowerPaletteIsExpanded}" ng-click="ctrls.PagesCtrl.selectPage(page)" ng-dblclick="ctrls.EditTabCtrl.handleInnerPageDoubleClick(page)" sf-page-moveable-source="" sf-page-moveable-target="" is-page-move-disabled="{{ctrls.MainCtrl.slideshow}}" move-page-number="{{page.surfaceNumber}}" data-test-key="palette_page_{{page.surfaceNumber}}"><sf-page-warning page="page"></sf-page-warning><div class="page-loading-indicator" ng-class="{\'page-loading-indicator-arrange\': ctrls.PaletteCtrl.lowerPaletteIsExpanded}"></div><div ng-if="!ctrls.PaletteCtrl.lowerPaletteIsExpanded" sly-evaluate-me="(ctrls.NavCtrl.activeLeftPage == page || ctrls.NavCtrl.activeRightPage == page) ||\n                             ctrls.PagesCtrl.evalAllPages"><sf-simple-page page="page" width="page.isSpread() ? 194 : 97" height="70" priority="ctrls.PaletteCtrl.priorities.pages"></sf-simple-page></div><div ng-if="ctrls.PaletteCtrl.lowerPaletteIsExpanded" sly-evaluate-me="(ctrls.NavCtrl.activeLeftPage == page || ctrls.NavCtrl.activeRightPage == page) ||\n                             ctrls.PagesCtrl.evalAllPages"><sf-simple-page page="page" width="page.isSpread() ? 388 : 194" height="140" priority="ctrls.PaletteCtrl.priorities.pages"></sf-simple-page></div><div ng-if="!ctrls.MainCtrl.previewMode" class="inner-page-tooltip" tooltip-append-to-body="true" tooltip="{{ctrls.MainCtrl.pageTabPageTooltip}}" tooltip-placement="top" tooltip-trigger="mouseenter"></div><div class="page-number clickable">{{page.surfaceNumber}}</div><div ng-if="page.isSpread()" class="right-spread-page-number clickable">{{page.surfaceNumber + 1}}</div></div><div class="move-sibling-tab inline-block between-pages" sf-page-moveable-target="" ng-class="{\'between-pages--phone\': ctrls.MainCtrl.isDeviceAPhone()}" move-page-number="{{page.surfaceNumber}}"><div class="move-target-highlight-tab"></div></div></div><div class="single-page-wrapper clickable inline-block right-page" ng-class="{\'page-thumbnail-arrange\': ctrls.PaletteCtrl.lowerPaletteIsExpanded, \'page-thumbnail\': !ctrls.PaletteCtrl.lowerPaletteIsExpanded}" ng-if="ctrls.PagesCtrl.project.product.pages.length % 2 == 0" ng-dblclick="ctrls.EditTabCtrl.handleBackFillerPageDoubleClick()" ng-click="ctrls.PagesCtrl.selectBackFiller()" data-test-key="palette_filler_back"><sf-simple-page page="ctrls.PagesCtrl.project.product.backFillerPage" ng-if="!ctrls.PaletteCtrl.lowerPaletteIsExpanded" width="97" height="70" priority="ctrls.PaletteCtrl.priorities.pages"></sf-simple-page><sf-simple-page page="ctrls.PagesCtrl.project.product.backFillerPage" ng-if="ctrls.PaletteCtrl.lowerPaletteIsExpanded" width="194" height="140" priority="ctrls.PaletteCtrl.priorities.pages"></sf-simple-page><div class="right-page page-number clickable"></div></div><div class="inline-block between-pages" ng-class="{\'between-pages--phone\': ctrls.MainCtrl.isDeviceAPhone()}"></div><div class="single-page-wrapper clickable inline-block add-photo-page-strip" ng-if="ctrls.PaletteCtrl.canAddMorePhotos()" ng-click="ctrls.PaletteCtrl.addMorePhotos()" data-test-key="button_add-photo-page-strip"><div class="add-more-pages"><div class="add-more-pages-icon"></div><div class="add-more-pages-text">{{::\'SilverApp.tablet.addMorePages\'|translate}}</div></div></div><div class="single-page-wrapper clickable inline-block back-cover" ng-class="{\'page-thumbnail-arrange\': ctrls.PaletteCtrl.lowerPaletteIsExpanded, \'page-thumbnail\': !ctrls.PaletteCtrl.lowerPaletteIsExpanded, \'add-page-stock-cover\': ctrls.PagesCtrl.project.product.cover.isStockCover}" ng-if="!ctrls.PageActionsCtrl.disabledAddPagesAtEnd && !ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.previewMode && !ctrls.MainCtrl.slideshow" tooltip-append-to-body="true" tooltip="{{\'SilverApp.arrangeInsertPageTooltip\' | translate}}" tooltip-trigger="mouseenter" tooltip-placement="top" omniture="" linkname="{{ctrls.PageActionsCtrl.getOmniTrackLinkForAddPages(ctrls.CustomizeCtrl.isCustomizing()?\'advanced-edit\':\'edit\', \'pagestab\', \'inpages\')}}" ng-click="ctrls.PageActionsCtrl.addPageAtEnd()" data-test-key="button_add_page"><sf-simple-page page="ctrls.PagesCtrl.project.product.frontFillerPage" ng-if="!ctrls.PaletteCtrl.lowerPaletteIsExpanded" width="97" height="70" priority="ctrls.PaletteCtrl.priorities.pages"></sf-simple-page><sf-simple-page page="ctrls.PagesCtrl.project.product.frontFillerPage" ng-if="ctrls.PaletteCtrl.lowerPaletteIsExpanded" width="194" height="140" priority="ctrls.PaletteCtrl.priorities.pages"></sf-simple-page><div class="page-number"></div><div class="page-add-pages clickable"><div class="add-page-label"><div class="page-add-pages-icon"></div><span>{{::\'SilverApp.addPage\'|translate}}</span></div></div></div><div ng-if="!ctrls.PagesCtrl.project.product.cover.isStockCover && !ctrls.NavCtrl.superSimpleTablet" class="single-page-wrapper clickable back-cover-with-add-page" ng-click="ctrls.PagesCtrl.selectBackCover()" ng-dblclick="ctrls.EditTabCtrl.handleBackCoverPageDoubleClick()" data-test-key="palette_cover_back" ng-class="{\'page-thumbnail-arrange\': ctrls.PaletteCtrl.lowerPaletteIsExpanded, \'page-thumbnail\': !ctrls.PaletteCtrl.lowerPaletteIsExpanded, \'sf-page-selected\':ctrls.NavCtrl.selectedPage.isBackCover()}"><sf-page-warning page="ctrls.PagesCtrl.project.product.cover.backPage"></sf-page-warning><sf-simple-page page="ctrls.PagesCtrl.project.product.cover.backPage" ng-if="!ctrls.PaletteCtrl.lowerPaletteIsExpanded" width="97" height="70" class="sf-simple-page--back-cover" priority="ctrls.PaletteCtrl.priorities.pages"></sf-simple-page><sf-simple-page page="ctrls.PagesCtrl.project.product.cover.backPage" ng-if="ctrls.PaletteCtrl.lowerPaletteIsExpanded" width="194" height="140" class="sf-simple-page--back-cover" priority="ctrls.PaletteCtrl.priorities.pages"></sf-simple-page><div ng-if="!ctrls.MainCtrl.previewMode" class="inner-page-tooltip"></div><div class="page-number clickable">{{::\'Palette.backCover\'|translate}}</div></div></scroll-synchronizer></div>'),a.put("Palette/views/pb/primary-palette-tabs.html","<ng-include src=\"'Palette/views/primary-palette-tabs.html'\"></ng-include>"),a.put("Palette/views/pb/secondary-palette-tabs.html",'<tabset id="paletteTabs" ng-class="{\'new-nav\':ctrls.NavCtrl.showNewNavigation}"><tab id="layoutsTab" disabled="disabled" data-test-key="tab_layouts" class="clickable first-tab" select="ctrls.LayoutsCtrl.tabActivated()" deselect="ctrls.LayoutsCtrl.tabDeactivated()" tooltip-append-to-body="true" tooltip-placement="right" tooltip="{{\'SilverApp.tooltip.layoutsTab\' | translate}}" active="ctrls.PaletteCtrl.PaletteTabSelection.layouts" ng-click="ctrls.PaletteCtrl.ensureSecondaryPaletteExpanded(); ctrls.PaletteCtrl.selectPaletteTab(\'layouts\')"><tab-heading><span ng-if="!ctrls.NavCtrl.showNewNavigation">{{::\'Palette.layouts\' | translate}}</span></tab-heading><div ng-include="\'Palette/views/@@p/layouts.html\'" data-test-key="div_layouts"></div></tab><tab id="backgroundsTab" disabled="disabled" data-test-key="tab_backgrounds" class="clickable" select="ctrls.BackgroundsCtrl.tabActivated()" deselect="ctrls.BackgroundsCtrl.tabDeactivated()" tooltip-append-to-body="true" tooltip-placement="right" tooltip="{{\'SilverApp.tooltip.backgroundsTab\' | translate}}" active="ctrls.PaletteCtrl.PaletteTabSelection.backgrounds" ng-click="ctrls.PaletteCtrl.ensureSecondaryPaletteExpanded(); ctrls.PaletteCtrl.selectPaletteTab(\'backgrounds\')"><tab-heading><span ng-if="!ctrls.NavCtrl.showNewNavigation">{{::\'Palette.backgrounds\' | translate}}</span></tab-heading><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.backgrounds || !ctrls.PaletteCtrl.PaletteTabFirstRun.backgrounds" ng-include="\'Palette/views/backgrounds.html\'" data-test-key="div_backgrounds"></div><span ng-hide="true" secondary-palette-tabs-resizer="" size-element=".secondary-palette" target=".secondary-palette .nav.nav-tabs"></span></tab><tab id="embellishmentsTab" disabled="disabled" data-test-key="tab_embellishments" class="clickable" ng-if="ctrls.MainCtrl.features.embellishments" select="ctrls.EmbellishmentsCtrl.tabActivated()" deselect="ctrls.EmbellishmentsCtrl.tabDeactivated()" tooltip-append-to-body="true" tooltip-placement="right" tooltip="{{\'SilverApp.tooltip.embellishmentsTab\' | translate}}" active="ctrls.PaletteCtrl.PaletteTabSelection.embellishments" ng-click="ctrls.PaletteCtrl.ensureSecondaryPaletteExpanded(); ctrls.PaletteCtrl.selectPaletteTab(\'embellishments\')"><tab-heading><span ng-if="!ctrls.NavCtrl.showNewNavigation">{{::\'Palette.embellishments\' | translate}}</span></tab-heading><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.embellishments || !ctrls.PaletteCtrl.PaletteTabFirstRun.embellishments" ng-include="\'Palette/views/embellishments.html\'" data-test-key="div_embellishments"></div><span ng-hide="true" secondary-palette-tabs-resizer="" size-element=".secondary-palette" target=".secondary-palette .nav.nav-tabs"></span></tab><tab disabled="disabled" data-test-key="tab_ideaPages" class="clickable" ng-click="ctrls.PaletteCtrl.ensureSecondaryPaletteExpanded();ctrls.PaletteCtrl.selectPaletteTab(\'ideaPages\')" tooltip-append-to-body="true" tooltip-placement="right" tooltip="{{\'SilverApp.tooltip.ideaPagesTab\' | translate}}" select="ctrls.IdeaPagesCtrl.tabActivated()" deselect="ctrls.IdeaPagesCtrl.tabDeactivated()" active="ctrls.PaletteCtrl.PaletteTabSelection.ideaPages"><tab-heading><span ng-if="!ctrls.NavCtrl.showNewNavigation">{{::\'Palette.ideaPages\' | translate}}</span></tab-heading><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.ideaPages || !ctrls.PaletteCtrl.PaletteTabFirstRun.ideaPages" ng-include="\'Palette/views/@@p/idea-pages.html\'" data-test-key="div_ideaPages"></div></tab><li ng-if="!ctrls.NavCtrl.showNewNavigation" class="palette-toggle-handle clickable" ng-click="ctrls.PaletteCtrl.toggleSecondaryPalette()"><i class="icon" ng-class="{\'expanded\': ctrls.PaletteCtrl.secondaryPalette.isExpanded, \'collapsed\': !ctrls.PaletteCtrl.secondaryPalette.isExpanded }"></i></li></tabset>'),a.put("Palette/views/pb/storyboard-add-page.html",'<li class="storyboard-pages clickable" ng-if="!ctrls.PageActionsCtrl.disabledAddPagesAtEnd" style="height: 200px" ng-click="ctrls.PageActionsCtrl.addPageAtEnd()" omniture="" linkname="{{ctrls.PageActionsCtrl.getOmniTrackLinkForAddPages(\'storyboard\', \'pages\', \'inpages\')}}" data-test-key="button_add_page"><div class="storyboard-add-page clickable"><div class="add-page-label"><div class="page-add-pages-icon-large"></div><span>{{::\'SilverApp.addPage\'|translate}}</span></div></div></li>'),a.put("Palette/views/pb/storyboard-page-labels.html",'<div class="pull-left" style="margin-left: 5px">{{ page.surfaceNumber | postfixTranslate:\'SilverApp.Page\' }} <span ng-if="page.isSpread()">-&nbsp;{{page.surfaceNumber + 1}}&nbsp;<span>{{::\'SilverApp.spread\'|translate}}</span> <span></span></span></div>'),a.put("Palette/views/primary-palette-tabs.html",'<tabset id="bottomPaletteTabs" ng-class="{\'new-nav\':ctrls.NavCtrl.showNewNavigation}"><div ng-include="\'Palette/views/@@p/pages-tab.html\'" include-replace=""></div><tab data-intro="{{::\'HelpOverlay.1\' | translate }}" data-position="top" tooltip-append-to-body="true" tooltip="{{\'SilverApp.tooltip.photosTab\' | translate}}" heading="{{::\'Palette.photo\' | translate }}" data-test-key="tab_photos" class="clickable" ng-click="ctrls.PaletteCtrl.selectPaletteTab(\'images\')" active="ctrls.PaletteCtrl.PaletteTabSelection.images"><div class="palette-images clearfix" ng-if="ctrls.NavCtrl.editIsActive && (ctrls.PaletteCtrl.PaletteTabSelection.images || !ctrls.PaletteCtrl.PaletteTabFirstRun.images)" ng-include="\'Palette/views/images.html\'"></div></tab><tab id="layoutsTab" disabled="disabled" heading="{{::\'Palette.layouts\' | translate }}" data-test-key="tab_layouts" class="clickable" ng-if="!ctrls.PaletteCtrl.isDualPaletteMode" ng-click="ctrls.PaletteCtrl.selectPaletteTab(\'layouts\')" tooltip-append-to-body="true" tooltip="{{\'SilverApp.tooltip.layoutsTab\' | translate}}" select="ctrls.LayoutsCtrl.tabActivated()" deselect="ctrls.LayoutsCtrl.tabDeactivated()" active="ctrls.PaletteCtrl.PaletteTabSelection.layouts"><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.layouts || !ctrls.PaletteCtrl.PaletteTabFirstRun.layouts" ng-include="\'Palette/views/@@p/layouts.html\'" data-test-key="div_layouts"></div></tab><tab id="backgroundsTab" disabled="disabled" heading="{{::\'Palette.backgrounds\' | translate }}" data-test-key="tab_backgrounds" class="clickable" ng-if="!ctrls.PaletteCtrl.isDualPaletteMode" ng-click="ctrls.PaletteCtrl.selectPaletteTab(\'backgrounds\')" select="ctrls.BackgroundsCtrl.tabActivated()" deselect="ctrls.BackgroundsCtrl.tabDeactivated()" active="ctrls.PaletteCtrl.PaletteTabSelection.backgrounds"><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.backgrounds || !ctrls.PaletteCtrl.PaletteTabFirstRun.backgrounds" ng-include="\'Palette/views/backgrounds.html\'" data-test-key="div_backgrounds"></div></tab><tab id="embellishmentsTab" disabled="disabled" heading="{{::\'Palette.embellishments\' | translate }}" data-test-key="tab_embellishments" class="clickable" ng-if="!ctrls.PaletteCtrl.isDualPaletteMode && ctrls.MainCtrl.features.embellishments" ng-click="ctrls.PaletteCtrl.selectPaletteTab(\'embellishments\')" tooltip-append-to-body="true" tooltip="{{\'SilverApp.tooltip.embellishmentsTab\' | translate}}" select="ctrls.EmbellishmentsCtrl.tabActivated()" deselect="ctrls.EmbellishmentsCtrl.tabDeactivated()" active="ctrls.PaletteCtrl.PaletteTabSelection.embellishments"><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.embellishments || !ctrls.PaletteCtrl.PaletteTabFirstRun.embellishments" ng-include="\'Palette/views/embellishments.html\'" data-test-key="div_embellishments"></div></tab><tab disabled="disabled" heading="{{::\'Palette.ideaPages\' | translate }}" data-test-key="tab_ideaPages" class="clickable" ng-if="!ctrls.PaletteCtrl.isDualPaletteMode" ng-click="ctrls.PaletteCtrl.selectPaletteTab(\'ideaPages\')" tooltip-append-to-body="true" tooltip="{{\'SilverApp.tooltip.ideaPagesTab\' | translate}}" select="ctrls.IdeaPagesCtrl.tabActivated()" deselect="ctrls.IdeaPagesCtrl.tabDeactivated()" active="ctrls.PaletteCtrl.PaletteTabSelection.ideaPages"><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.ideaPages || !ctrls.PaletteCtrl.PaletteTabFirstRun.ideaPages" ng-include="\'Palette/views/@@p/idea-pages.html\'" data-test-key="div_ideaPages"></div></tab></tabset>'),
a.put("Palette/views/ss/idea-pages.html","<div ng-include=\"'Palette/views/idea-pages.html'\"></div>"),a.put("Palette/views/ss/layouts.html","<div ng-include=\"'Palette/views/layouts.html'\"></div>"),a.put("Palette/views/ss/left-nav.html","<ng-include src=\"'Palette/views/left-nav.html'\"></ng-include>"),a.put("Palette/views/ss/pages.html",""),a.put("Palette/views/ss/primary-palette-tabs.html",'<tabset><tab heading="{{:: \'Palette.photo\' | translate }}" data-test-key="tab_photos" class="first-tab clickable" ng-click="ctrls.PaletteCtrl.selectPaletteTab(\'images\')" active="ctrls.PaletteCtrl.PaletteTabSelection.images"><div class="palette-images clearfix" ng-if="ctrls.NavCtrl.editIsActive && (ctrls.PaletteCtrl.PaletteTabSelection.images || !ctrls.PaletteCtrl.PaletteTabFirstRun.images)" ng-include="\'Palette/views/images.html\'"></div></tab></tabset>'),a.put("Palette/views/ss/secondary-palette-tabs.html",'<tabset><tab id="layoutsTab" disabled="disabled" data-test-key="tab_layouts" class="clickable first-tab" select="ctrls.LayoutsCtrl.tabActivated()" deselect="ctrls.LayoutsCtrl.tabDeactivated()" tooltip-append-to-body="true" tooltip-placement="right" tooltip="{{\'SilverApp.tooltip.layoutsTab\' | translate}}" active="ctrls.PaletteCtrl.PaletteTabSelection.layouts" ng-click="ctrls.PaletteCtrl.ensureSecondaryPaletteExpanded(); ctrls.PaletteCtrl.selectPaletteTab(\'layouts\')"><tab-heading><span ng-if="!ctrls.NavCtrl.showNewNavigation">{{::\'Palette.layouts\' | translate}}</span></tab-heading><div ng-include="\'Palette/views/@@p/layouts.html\'" data-test-key="div_layouts"></div></tab><tab id="backgroundsTab" disabled="disabled" heading="{{::\'Palette.backgrounds\' | translate }}" data-test-key="tab_backgrounds" class="clickable" select="ctrls.BackgroundsCtrl.tabActivated()" deselect="ctrls.BackgroundsCtrl.tabDeactivated()" tooltip-append-to-body="true" tooltip-placement="right" tooltip="{{\'SilverApp.tooltip.backgroundsTab\' | translate}}" active="ctrls.PaletteCtrl.PaletteTabSelection.backgrounds" ng-click="ctrls.PaletteCtrl.ensureSecondaryPaletteExpanded(); ctrls.PaletteCtrl.selectPaletteTab(\'backgrounds\')"><tab-heading><span ng-if="!ctrls.NavCtrl.showNewNavigation">{{::\'Palette.backgrounds\' | translate}}</span></tab-heading><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.backgrounds || !ctrls.PaletteCtrl.PaletteTabFirstRun.backgrounds" ng-include="\'Palette/views/backgrounds.html\'" data-test-key="div_backgrounds"></div><span ng-hide="true" secondary-palette-tabs-resizer="" size-element=".secondary-palette" target=".secondary-palette .nav.nav-tabs"></span></tab><tab id="embellishmentsTab" disabled="disabled" heading="{{::\'Palette.embellishments\' | translate }}" data-test-key="tab_embellishments" class="clickable" ng-if="ctrls.MainCtrl.features.embellishments" select="ctrls.EmbellishmentsCtrl.tabActivated()" deselect="ctrls.EmbellishmentsCtrl.tabDeactivated()" tooltip-append-to-body="true" tooltip-placement="right" tooltip="{{\'SilverApp.tooltip.embellishmentsTab\' | translate}}" active="ctrls.PaletteCtrl.PaletteTabSelection.embellishments" ng-click="ctrls.PaletteCtrl.ensureSecondaryPaletteExpanded(); ctrls.PaletteCtrl.selectPaletteTab(\'embellishments\')"><tab-heading><span ng-if="!ctrls.NavCtrl.showNewNavigation">{{::\'Palette.embellishments\' | translate}}</span></tab-heading><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.embellishments || !ctrls.PaletteCtrl.PaletteTabFirstRun.embellishments" ng-include="\'Palette/views/embellishments.html\'" data-test-key="div_embellishments"></div><span ng-hide="true" secondary-palette-tabs-resizer="" size-element=".secondary-palette" target=".secondary-palette .nav.nav-tabs"></span></tab><tab disabled="disabled" heading="{{::\'Palette.ideaPages\' | translate }}" data-test-key="tab_ideaPages" class="clickable" ng-click="ctrls.PaletteCtrl.ensureSecondaryPaletteExpanded();ctrls.PaletteCtrl.selectPaletteTab(\'ideaPages\')" tooltip-append-to-body="true" tooltip-placement="right" tooltip="{{\'SilverApp.tooltip.ideaPagesTab\' | translate}}" select="ctrls.IdeaPagesCtrl.tabActivated()" deselect="ctrls.IdeaPagesCtrl.tabDeactivated()" active="ctrls.PaletteCtrl.PaletteTabSelection.ideaPages"><tab-heading><span ng-if="!ctrls.NavCtrl.showNewNavigation">{{::\'Palette.ideaPages\' | translate}}</span></tab-heading><div ng-if="ctrls.PaletteCtrl.PaletteTabSelection.ideaPages || !ctrls.PaletteCtrl.PaletteTabFirstRun.ideaPages" ng-include="\'Palette/views/@@p/idea-pages.html\'" data-test-key="div_ideaPages"></div></tab><li class="palette-toggle-handle clickable" ng-click="ctrls.PaletteCtrl.toggleSecondaryPalette()"><i class="icon" ng-class="{\'expanded\': ctrls.PaletteCtrl.secondaryPalette.isExpanded, \'collapsed\': !ctrls.PaletteCtrl.secondaryPalette.isExpanded }"></i></li></tabset>'),a.put("Palette/views/storyboard-image-stack.html",'<div class="image-stack"><div ng-repeat="image in (group = (ctrls.ImageCtrl.getDuplicateImages(image.pHash, ctrls.PaletteCtrl.hideUsed)) | orderBy:\'ranking\' | limitTo:1)" ng-mouseenter="tooltipClassName = ctrls.StoryboardTabCtrl.getPhotoStackTooltipClass($event);"><img class="palette-image-thumbnail back-image" sf-priority-src="image.storyboardThumbSrc" sf-priority="ctrls.PaletteCtrl.priorities.storyboard" sf-priority-watch="true" sf-priority-lifecycle-callbacks="\'true\'" sf-priority-onload="src" width="{{::image.storyboardThumbWidth}}" height="{{::image.storyboardThumbHeight}}"/> <img class="palette-image-thumbnail clickable" sf-priority-src="image.storyboardThumbSrc" sf-priority="ctrls.PaletteCtrl.priorities.storyboard" sf-priority-watch="true" sf-priority-lifecycle-callbacks="\'true\'" sf-priority-onload="src" width="{{::image.storyboardThumbWidth}}" height="{{::image.storyboardThumbHeight}}" sf-draggable="" drag-asset="image" location="palette"/><div class="count"><span>{{group.length}}</span></div><div class="photo-stack-tooltip {{tooltipClassName}}"><div class="arrow-border"></div><div class="arrow"></div><div class="photo-stack-tooltip-wrap"><div class="scrollable-wrap"><ul class="photo-stack-tooltip-list"><li ng-repeat="item in group" data-test-key="storyboard_photo_{{::item.productImageID}}"><img class="palette-image-thumbnail clickable" sf-priority-src="item.storyboardThumbSrc" sf-priority="ctrls.PaletteCtrl.priorities.storyboard" sf-priority-watch="true" sf-priority-lifecycle-callbacks="\'true\'" sf-priority-onload="src" ng-mouseenter="ctrls.ImageCtrl.arrangeImageHover = item;" ng-mouseleave="ctrls.ImageCtrl.arrangeImageHover = null;" ng-mousedown="ctrls.ImageCtrl.arrangeImageHover = null;" width="{{::item.storyboardThumbWidth}}" height="{{::item.storyboardThumbHeight}}" sf-draggable="" drag-asset="item" location="palette"/></li></ul></div><span class="drag-message">{{::\'Palette.photoStack.dragMessage\'|translate}}</span></div></div></div></div>'),a.put("Palette/views/storyboard-pages-toolbar.html",'<div tooltip-append-to-body="false" tooltip="{{::\'SilverApp.redo\' | translate}}" tooltip-trigger="mouseenter" ng-class="{\'clickable\': true, \'active-command\': ctrls.CommandCtrl.canRedo, \'command-actions\':true}" ng-click="ctrls.CommandCtrl.redo()" class="pull-right palette-header-text clickable add-pages" style="margin-right: 5px" data-test-key="button_redo_storyboard"><span disabled="disabled" class="icon icon-right-padded icon-redo"></span></div><div tooltip-append-to-body="false" tooltip="{{::\'SilverApp.undo\' | translate}}" tooltip-trigger="mouseenter" ng-class="{\'clickable\': true, \'active-command\': ctrls.CommandCtrl.canUndo, \'command-actions\':true}" ng-click="ctrls.CommandCtrl.undo()" class="pull-right palette-header-text clickable add-pages" style="margin-right: 5px" data-test-key="button_undo_storyboard"><span disabled="disabled" class="icon icon-right-padded icon-undo"></span></div><div ng-if="ctrls.PageActionsCtrl.disableStoryboardRemovePage == \'no\'" tooltip-append-to-body="false" tooltip="{{::\'SilverApp.removepage.dialog.RemovePage\' | translate}}" tooltip-trigger="mouseenter" ng-class="{\'disabled\': ctrls.PageActionsCtrl.disabledRemove}" ng-click="ctrls.PageActionsCtrl.removePage()" class="pull-right palette-header-text clickable add-pages" style="margin-top: -5px; margin-right: 5px" data-test-key="button_remove_page_storyboard"><span disabled="disabled" class="icon icon-remove-page" ng-class="{\'icon-remove-page-disabled\': ctrls.PageActionsCtrl.disabledRemove}"></span></div><div tooltip-append-to-body="false" tooltip="{{::\'SilverApp.addPages\' | translate}}" tooltip-trigger="mouseenter" ng-class="{\'disabled\': ctrls.PageActionsCtrl.disabledAddPages}" ng-click="ctrls.PageActionsCtrl.addPages()" omniture="" linkname="{{ctrls.PageActionsCtrl.getOmniTrackLinkForAddPages(\'storyboard\', \'toolbar\', \'button\')}}" class="pull-right palette-header-text clickable add-pages" style="margin-right: 5px" data-test-key="button_add_page_storyboard"></div><div ng-if="ctrls.PageActionsCtrl.disableStoryboardAddPage == \'no\'" tooltip-append-to-body="false" tooltip="{{::\'SilverApp.addPages\' | translate}}" tooltip-trigger="mouseenter" ng-class="{\'disabled\': ctrls.PageActionsCtrl.disabledAddPages}" ng-click="ctrls.PageActionsCtrl.addPages()" omniture="" linkname="{{ctrls.PageActionsCtrl.getOmniTrackLinkForAddPages(\'storyboard\', \'toolbar\', \'button\')}}" class="pull-right palette-header-text clickable add-pages" data-test-key="button_add_page_storyboard"><span class="icon icon-right-padded icon-add-page" ng-class="{\'icon-add-page-disabled\': ctrls.PageActionsCtrl.disabledAddPages}"></span> <span class="icon-add-page-margin">{{::\'Palette.addPages\'|translate}}</span></div>'),a.put("Palette/views/styles.html",'<div class="style-store style-store-tab allowHorizontalScroll" ng-if="!ctrls.StyleTabCtrl.styleStoreInactive"><iframe data-test-key="style_store" class="style-store style-store-tab allowHorizontalScroll" frameborder="1" frameloadedsimple="" ng-src="{{(ctrls.StyleTabCtrl.styleStoreUrl)}}"></iframe></div>'),a.put("Palette/views/upload-error.html",'<div class="modal-width-medium modal-content"><div class="modal-header"><span class="modal-header-title"><i class="icon icon-error"></i></span> <span>{{ctrls.ImageCtrl.imageCollection.currentUploadErrors | postfixTranslate:\'Palette.uploadErrorTitle\'}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_upload_progress_modal_xclose" ng-click="ctrls.ImageCtrl.cancelUploadErrorModal()"></i></div><div class="modal-body"><p class="upload-error-body"><span ng-if="::!ctrls.MainCtrl.isDeviceAPhone()" translate="">Palette.uploadErrorModalBody</span> <span ng-if="::ctrls.MainCtrl.isDeviceAPhone()" translate="">Palette.uploadErrorModalBodyPhone</span> <span ng-if="!ctrls.MainCtrl.isDeviceAPhone()" ng-show="ctrls.ImageCtrl.hasUsedImagesWithError" translate="">Palette.uploadErrorModalBodySuffix</span> <span ng-if="ctrls.MainCtrl.isDeviceAPhone()" ng-show="ctrls.ImageCtrl.hasUsedImagesWithError" translate="">Palette.uploadErrorModalBodySuffixPhone</span></p><div class="upload-error-desc"><span class="upload-error-image"></span><p>{{::\'Palette.uploadErrorModalDescription\'|translate}}</p></div></div><div ng-if="ctrls.ImageCtrl.has3rdPartyImagesWithError"><div class="modal-footer" ng-if="!ctrls.ImageCtrl.hasUsedImagesWithError"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.ImageCtrl.cancelUploadErrorModal()" data-test-key="button_upload_progress_modal_ok">{{::\'Palette.Ok\'|translate}}</button></div><div class="modal-footer" ng-if="ctrls.ImageCtrl.hasUsedImagesWithError"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.ImageCtrl.cancelUploadErrorModal()" data-test-key="button_upload_progress_modal_ok">{{::\'Palette.removePlacedImages\'|translate}}</button></div></div><div ng-if="!ctrls.ImageCtrl.has3rdPartyImagesWithError"><div class="modal-footer" ng-if="!ctrls.ImageCtrl.hasUsedImagesWithError"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.ImageCtrl.retryUpload()" data-test-key="button_upload_progress_modal_ok">{{::\'Palette.retryUpload\'|translate}}</button></div><div class="modal-footer" ng-if="ctrls.ImageCtrl.hasUsedImagesWithError"><button type="button" class="btn btn-default btn-link" ng-click="ctrls.ImageCtrl.retryUpload()" data-test-key="button_upload_progress_modal_ok">{{::\'Palette.retryUpload\'|translate}}</button> <button type="button" class="btn btn-default btn-primary" ng-click="ctrls.ImageCtrl.cancelUploadErrorModal()" data-test-key="button_upload_progress_modal_ok">{{::\'Palette.removePlacedImages\'|translate}}</button></div></div></div>'),a.put("Palette/views/upload-in-progress.html",'<div class="modal-width-medium modal-content"><div class="modal-header"><span class="modal-header-title"><i class="icon icon-warning"></i> <span>{{::\'Palette.uploadInProgressModalTitle\'|translate}}</span></span></div><div class="modal-body"><p class="upload-progress-body">{{::\'Palette.uploadInProgressModalBody\'|translate}}</p><div ng-show="ctrls.ImageCtrl.imageCollection.currentUploadInProgress"><p class="upload-progress-count"><span>{{::\'Palette.uploading\'|translate}}</span> {{ ctrls.ImageCtrl.imageCollection.currentUploadTotal - ctrls.ImageCtrl.imageCollection.currentUploadInProgress + 1 }} <span>{{::\'Palette.of\'|translate}}</span> {{ctrls.ImageCtrl.imageCollection.currentUploadTotal}}</p><progressbar class="upload-progress-bar" max="ctrls.ImageCtrl.imageCollection.currentUploadTotal" value="(ctrls.ImageCtrl.imageCollection.currentUploadTotal-ctrls.ImageCtrl.imageCollection.currentUploadInProgress)\n        "></progressbar></div><div style="overflow: auto; height: 200px"><ul class="list-unstyled image-list list-inline" style="margin-right: 10px" ng-mouseleave="ctrls.ImageCtrl.arrangeImageHover = null"><li ng-repeat="image in ctrls.ImageCtrl.projectImages" ng-show="image.isThumb == true && image.hasError != true" style="width: 120px" data-test-key="upload_photo_{{::image.productImageID}}"><div style="max-width: 90px"><img class="palette-image-thumbnail clickable" sf-priority-src="image.thumbSrc" sf-priority="ctrls.PaletteCtrl.priorities.images" sf-priority-watch="true" sf-priority-lifecycle-callbacks="\'true\'" sf-priority-onload="src" width="{{::image.thumbWidth}}" height="{{::image.thumbHeight}}"/> <i class="image-remove-upload" ng-click="ctrls.ImageCtrl.cancelUpload(image)" data-test-key="button_photo_remove"></i><progressbar class="image-progress-bar" max="100" value="image.progress"></progressbar><span class="image-error-indicator" data-test-key="icon_photo_error"></span></div></li></ul></div></div><div class="modal-footer" ng-if="ctrls.ImageCtrl.uploadInProgressDisableClose != true"><button ng-click="ctrls.ImageCtrl.cancelUploadsInProgress()" type="button" class="btn btn-default btn-secondary" data-test-key="button_upload_progress_modal_cancel">{{::\'Palette.uploadInProgressCancel\'|translate}}</button> <button type="button" class="btn btn-default btn-primary" ng-click="ctrls.ImageCtrl.dismissUploadInProgressModal()" data-test-key="button_upload_progress_modal_ok">{{::\'Palette.Ok\'|translate}}</button></div></div>'),a.put("Project/views/binder-ring.html",'<div class="surface-binder" ng-style="binderStyle"><div class="surface-binder__asset" ng-style="binderRingStyle"></div></div>'),a.put("Project/views/customize-page.html",'<sf-simple-page page="page" width="width" height="height" live-resize="" background-only-render="" priority="HIGH" is-customizing="true" style="position: absolute; overflow: hidden"></sf-simple-page><div ng-style="pageStyle" tabindex="1" style="outline:none"><canvas></canvas><div ng-if="page.isBackCover()" class="back-cover-barcode" ng-style="barcodeContainerStyle" data-test-key="back_cover_barcode_indicator"></div></div>'),a.put("Project/views/less-simple-page.html",'<div class="page-content {{=it.data.pageClasses}}" style="{{=it.data.pageStyle}}"><div id="gutter-shadow" ng-if="::gutterShadowVisible()" ng-class="gutterShadowClass"></div>{{~ it.data.assets :asset:index }} {{? (asset.asset.assetType !== \'text\') || asset.hasContent() }}<div class="asset-container"><div style="{{=it.data.styleForAsset(asset.asset)}}" class="asset-wrapper {{=it.data.classForAsset(asset)}}" data-test-key="layout_{{=it.data.page.layoutName}}">{{? (asset.asset.assetType === \'image\') }} <span><div class="image-asset-container"><div style="{{=it.data.styleForImageWrapper(asset)}}" data-test-key="page_photo_area_{{=asset.uniqueProjectRef}}"><div data-hoverable="true" data-assetType="image" data-assetIndex="{{=index}}" style="{{=it.data.styleForFadeUnderlay(asset)}}"></div><img class="{{=it.data.classForImage(asset)}}" style="{{=it.data.styleForImage(asset)}}" tooltip-append-to-body="true" tooltip="{{=it.data.tooltipForAsset(asset)}}" tooltip-trigger="mouseenter" draggable="" data-assetIndex="{{=index}}" data-hoverable="true" sf-droppable="" drop-options="{pageNumber: {{=it.data.page.surfaceNumber}}}" sf-draggable="" drag-options="{pageNumber: {{=it.data.page.surfaceNumber}}, useCustomAvatar:true}" location="well" data-assetType="image" data-test-key="page_photo_{{=asset.projectImageId}}" data-imageKey="image_remove_{{=asset.uniqueProjectRef}}_{{=it.data.page.surfaceNumber}}" sf-priority-src="{{=it.data.imageAssetURL(asset)}}" sf-priority="priority" sf-priority-onload="src" sf-priority-watch="true" use-thumbnail="\'false\'" sf-priority-lifecycle-callbacks="usePriorityLoadingLifecycleCallbacks"/></div>{{? (!it.data.page.isStockCover) || (asset.hasAssignedImage())}}<div class="photo-remove-arrange" style="{{=it.data.reverseScaleStyle(it.data.assetScale)}}" tooltip-append-to-body="true" tooltip="{{=it.data.tooltipForImageRemoveButton(asset)}}" tooltip-trigger="mouseenter" data-assetIndex="{{=index}}" drop-options="{pageNumber: {{=it.data.page.surfaceNumber}}}" data-clickable="true" data-attach-asset="true" data-assetType="image" data-imageReference="image_remove_{{=asset.uniqueProjectRef}}_{{=it.data.page.surfaceNumber}}" data-test-key="button_photo_remove_arrange_{{=asset.projectImageId}}"></div>{{?}}</div></span> {{?}} {{? (asset.asset.assetType === \'graphic\') }} <span><div data-assetType="graphic" data-assetIndex="{{=index}}" data-test-key="page_{{=asset.asset.type}}_{{=asset.asset.assetId}}" class="page-graphic-asset {{=it.data.classForGraphicAsset(asset)}}" sf-priority-src="{{=it.data.sourceURLForAsset(asset)}}" sf-priority="priority" sf-priority-onload="background" sf-priority-watch="true" use-thumbnail="\'false\'" data-hoverable="true" sf-droppable="" drop-options="{pageNumber: {{=it.data.page.surfaceNumber}}}" location="{{= it.data.page.isStockCover ? \'\' : \'graphic\'}}" tooltip-append-to-body="true" tooltip-placement="top" tooltip="{{=it.data.tooltipForAsset(asset)}}" tooltip-trigger="mouseenter" sf-hollow-embellishment="{{=asset.isHollow}}" scale="{{=it.data.assetScale}}"><div class="fade-overlay" style="{{=it.data.styleForPABFade(asset)}}"></div></div></span> {{?}} {{? (asset.asset.assetType === \'text\' && !it.data.page.hideTextBoxes) }} <span>{{? (!it.data.serverText || it.data.shouldRenderTextLowRes(asset)) }}<div data-assetType="text" data-assetIndex="{{=index}}" sf-droppable="" drop-options="{pageNumber: {{=it.data.page.surfaceNumber}}}" location="text" style="{{=it.data.styleForTextAsset(asset)}}">{{=it.data.contentForLines(asset.lines)}}</div>{{?? true }} <img class="hundies" sf-priority-src="{{=it.data.textAssetImageURL(asset)}}" sf-priority="priority" use-thumbnail="\'false\'" sf-priority-watch="true" data-assetType="text-image" data-assetIndex="{{=index}}" sf-droppable="" drop-options="{pageNumber: {{=it.data.page.surfaceNumber}}}" location="text" draggable="false"/> {{?}}</span> {{?}}</div></div>{{?}} {{~}} {{? it.data.page.isBackCover() }}<div class="back-cover-barcode" data-test-key="back_cover_barcode_indicator"></div>{{?}}</div>'),a.put("Project/views/page.html",'<div class="page-content" ng-style="pageStyle" tooltip-append-to-body="false" tooltip="{{pageTooltip}}" tooltip-trigger="mouseenter" ng-mouseenter="pageHovered=true" ng-mousemove="pageHovered=true" ng-mouseleave="pageHovered=false" ng-class="{\'page-hovered\': isEditable && pageHovered,\n        \'non-idea-layout\': !page.ideaLayout,\n        \'transient-layout\': page.appliedLayout,\n        \'is-editable\': isEditable}" sf-transient-layout-activator="" transient-page-number="{{page.surfaceNumber}}"><div id="gutter-shadow-spread" ng-class="gutterShadowClass"></div><div ng-if="page.isBackFiller()" class="hundies"><div class="hundies" sf-droppable="" drop-asset="fillerAsset" drop-options="dropOptions()" location="back-filler-page"></div></div><div ng-if="isEditable" class="hundies background-drop-target" sf-droppable="" drop-asset="dropBackgroundAsset" drop-options="dropOptions()" location="background"></div><div class="asset-container" ng-repeat="asset in page.layout.assets track by asset.asset.generatedAssetId" ng-class="{\'asset-container--text\': asset.asset.assetType == \'text\'}"><div ng-style="styleForAsset(asset.asset)" ng-switch="" on="asset.asset.assetType" ng-class="classForAsset(asset, page)" class="asset-wrapper" ng-show="asset.asset.assetType!=\'text\' || !page.hideTextBoxes" ng-if="(!asset.isEventTextAsset || asset.hasContent())" data-test-key="layout_{{page.layoutName}}"><span ng-switch-when="image"><div class="asset-swap-indicator">{{:: \'SilverApp.tablet.swap\' | translate }}</div><div class="image-asset-container"><div ng-style="styleForImageWrapper(asset)" data-test-key="{{::\'page_photo_area_\' + asset.uniqueProjectRef}}"><sf-image-asset-warning ng-if="isEditable" data-test-key="{{::\'page_image_warning_\' + $index}}" asset="asset"></sf-image-asset-warning><div ng-show="asset.hasAssignedImage()" data-hoverable="true" data-assetType="image" data-assetIndex="{{$index}}" ng-style="styleForFadeUnderlay(asset)"></div><img tooltip-append-to-body="true" tooltip="{{imageTooltip}}" ng-class="{\'has-assigned-image\': asset.hasAssignedImage()}" tooltip-trigger="mouseenter" ng-style="styleForImage(asset)" draggable="{{isEditable}}" sf-droppable="" drop-asset="asset" drop-options="dropOptions()" sf-draggable="" drag-asset="asset" drag-options="dragOptions()" location="well" data-hoverable="true" data-assetType="image" data-assetIndex="{{$index}}" data-objectStyle="{{asset.asset.objectStyle}}" data-test-key="page_photo_{{asset.projectImageId}}" data-double-clickable="true" data-clickable="true" sf-priority-src="imageAssetURL(asset)" sf-priority="priority" sf-priority-onload="src" sf-priority-watch="true" sf-priority-location="2pv" use-thumbnail="useThumbnails" sf-priority-lifecycle-callbacks="usePriorityLoadingLifecycleCallbacks"/><div ng-if="isEditable && (asset.canRemove || asset.hasAssignedImage())" ng-show="activeAsset==asset && (!page.isStockCover || asset.hasAssignedImage())" tooltip-append-to-body="true" tooltip="{{removeTooltip}}" tooltip-trigger="mouseenter" class="remove-image" ng-class="{\'tablet-non-removable\': page.isCover()}" ng-style="styleForUIElement(page, asset, {width: 26, right: 5, top: 5}, assetScale)" data-clickable="true" data-attach-asset="true" data-assetType="image" data-test-key="button_page_photo_remove"></div><div ng-if="isEditable && asset.hasAssignedImage()" ng-show="activeAsset==asset && asset.hasAssignedImage()" class="tablet-edit-image" ng-style="styleForUIElement(page, asset, {width: 26, right: 5, top: (page.isCover() ? 5 : 45)}, assetScale)" data-assetType="image-edit-prompt" data-test-key="button_page_photo_edit" tooltip="{{tooltip}}" tooltip-append-to-body="true" tooltip-trigger="click" ng-click="clickHandler" data-assetIndex="{{$index}}"></div></div></div></span> <span ng-switch-when="graphic"><div sf-priority-src="backgroundSourceURL(asset)" sf-priority="priority" sf-priority-onload="background" sf-priority-watch="true" use-thumbnail="useThumbnails" data-hoverable="true" data-assetType="graphic" data-assetIndex="{{$index}}" sf-droppable="" drop-asset="asset" drop-options="dropOptions()" location="graphic" data-test-key="page_{{::asset.asset.type}}_{{$index}}_{{asset.asset.assetId}}" class="page-graphic-asset {{::classForGraphicAsset(asset)}}" sf-hollow-embellishment="asset.isHollow && bookSpread" asset="asset" scale="assetScale"><div class="fade-overlay" ng-style="styleForPABFade(asset)"></div><div ng-if="isEditable && asset.canRemove" ng-show="activeEmbellishmentAsset==asset" tooltip-append-to-body="true" tooltip="{{:: \'SilverApp.removeStickerTooltip\' | translate}}" tooltip-trigger="mouseenter" class="remove-embellishment" ng-class="::{\'for-hollow-embellishment\': asset.isHollow}" data-clickable="true" data-embellishment="true" data-assetType="embellishment-remove-handle" data-test-key="button_page_embellishment_remove"></div></div></span> <span ng-switch-when="text" class="clickable"><sf-text-asset-warning ng-if="isEditable && asset.asset.assetType == \'text\' && (!asset.isEventTextAsset || asset.hasContent())" data-test-key="{{::\'page_text_warning_\' + $index}}" asset="asset" page="page"></sf-text-asset-warning><div ng-if="!serverText || shouldRenderTextLowRes(asset)" data-assetType="text" data-assetIndex="{{$index}}" ng-style="styleForTextAsset(asset)" ng-bind-html="contentForLines(asset.lines)" sf-droppable="" drop-asset="asset" drop-options="dropOptions()" location="text"></div><img class="hundies" ng-if="serverText && !shouldRenderTextLowRes(asset)" tooltip-append-to-body="true" tooltip="{{::asset.isEventTextAsset ? imageTooltip : textTooltip}}" tooltip-trigger="mouseenter" sf-priority-src="textAssetImageURL(asset)" sf-priority="priority" use-thumbnail="\'false\'" sf-priority-watch="true" data-assetType="{{::asset.isEventTextAsset ? \'text-event\' : \'text-image\'}}" data-assetIndex="{{$index}}" data-clickable="true" data-double-clickable="true" data-test-key="{{::\'page_text_\' + $index}}" sf-droppable="" drop-asset="asset" drop-options="dropOptions()" location="text" drop-proxy-class="dropProxyClassForAsset(asset,page)" draggable="false"/></span> <span ng-switch-when="virtual-image"><div class="asset-swap-indicator">{{:: \'SilverApp.tablet.swap\' | translate }}</div><div class="image-asset-container"><div ng-style="styleForImageWrapper(asset)" data-test-key="{{::\'page_photo_area_\' + asset.uniqueProjectRef}}"><img tooltip-append-to-body="true" tooltip="{{imageTooltip}}" ng-class="{\'has-assigned-image\': asset.hasAssignedImage()}" tooltip-trigger="mouseenter" ng-style="styleForImage(asset)" draggable="{{isEditable}}" sf-droppable="" drop-asset="asset" drop-options="dropOptions()" sf-draggable="" drag-asset="asset" drag-options="dragOptions()" location="well" data-hoverable="true" data-assetType="image" data-assetIndex="{{$index}}" data-objectStyle="{{asset.asset.objectStyle}}" data-test-key="page_photo_{{asset.projectImageId}}" data-double-clickable="true" data-clickable="true" sf-priority-src="" sf-priority="priority" sf-priority-onload="src" sf-priority-watch="true" sf-priority-location="2pv" use-thumbnail="useThumbnails" sf-priority-lifecycle-callbacks="usePriorityLoadingLifecycleCallbacks"/></div></div></span></div></div><div ng-if="isRemovablePage && isEditable" class="page-remove" tooltip-append-to-body="true" tooltip="{{removePageTooltip}}" tooltip-trigger="mouseenter" data-clickable="true" data-test-key="button_page_remove" data-assetType="page-remove-handle"></div><div ng-if="isEditable && isEmptyPage && !page.isSpine() && !page.isStockCover" ng-class="{\'empty-page-cover\' : hasLayflat() || page.isCover(), \'square\': isSquare(), \'rect\': !isSquare()}" class="empty-page" tooltip-append-to-body="true" tooltip="{{::\'SilverApp.dragPhotoToPage\' | translate}}" tooltip-trigger="mouseenter" data-test-key="empty_page_indicator" sf-droppable="" drop-asset="dropBackgroundAsset" drop-options="dropOptions()" location="background"></div><div ng-if="page.isBackCover()" class="back-cover-barcode" data-test-key="back_cover_barcode_indicator" sf-droppable="" drop-asset="backcoverBarcodeAsset" drop-options="dropOptions()" location="background"></div><img ng-if="devPageData.softRenderURL" ng-src="{{devPageData.softRenderURL}}" ng-style="styleForSoftRender(page, devData.softRenderOpacity)"/>  <span ng-if="!hasReportedLoad && page" ng-style="reportPageLoad()"></span></div>'),a.put("Project/views/simple-page.html",'<div class="page-content {{=it.data.pageClasses}}" style="{{=it.data.pageStyle}}">{{~ it.data.assets :asset:index }}<div class="asset-container"><div style="{{=it.data.styleForAsset(asset.asset)}}" class="asset-wrapper {{=it.data.classForAsset(asset)}}" data-test-key="layout_{{=it.data.page.layoutName}}">{{? (asset.asset.assetType === \'image\') }} <span><div class="image-asset-container"><div style="{{=it.data.styleForImageWrapper(asset)}}" data-test-key="page_photo_area_{{=asset.uniqueProjectRef}}"><div style="{{=it.data.styleForFadeUnderlay(asset)}}"></div><img class="{{=it.data.classForImage(asset)}}" style="{{=it.data.styleForImage(asset)}} pointer-events: none" draggable="false" data-test-key="page_photo_{{=asset.projectImageId}}" sf-priority-src="{{=it.data.imageAssetURL(asset)}}" sf-priority="priority" sf-priority-onload="src" sf-priority-watch="true" use-thumbnail="\'false\'" sf-priority-lifecycle-callbacks="usePriorityLoadingLifecycleCallbacks"/><div ng-show="asset.hasAssignedImage()" class="&quot;fade-overlay-ima"></div></div></div></span> {{?}} {{? (asset.asset.assetType === \'graphic\') }} <span><div data-assetType="graphic" data-assetIndex="{{=index}}" data-test-key="page_{{=asset.asset.type}}_{{=asset.asset.assetId}}" class="page-graphic-asset {{=it.data.classForGraphicAsset(asset)}}" sf-priority-src="{{=it.data.sourceURLForAsset(asset)}}" sf-priority="priority" sf-priority-onload="background" sf-priority-watch="true" use-thumbnail="\'false\'"><div class="fade-overlay" style="{{=it.data.styleForPABFade(asset)}}"></div></div></span> {{?}} {{? (asset.asset.assetType === \'text\') }} <span>{{? (!it.data.serverText || it.data.shouldRenderTextLowRes(asset)) }}<div data-assetType="text" data-assetIndex="{{=index}}" style="{{=it.data.styleForTextAsset(asset)}}">{{=it.data.contentForLines(asset.lines)}}</div>{{?? true }} <img class="hundies" sf-priority-src="{{=it.data.textAssetImageURL(asset)}}" sf-priority="priority" use-thumbnail="\'false\'" sf-priority-watch="true" data-assetType="text-image" data-assetIndex="{{=index}}" draggable="false"/> {{?}}</span> {{?}}</div></div>{{~}} {{? it.data.page.isBackCover() }}<div class="back-cover-barcode" data-test-key="back_cover_barcode_indicator"></div>{{?}}</div>'),a.put("SilverApp/views/add-after-spread-check.html",'<div class="modal-width-small modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.addPages\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_spreadaddpages_modal_xclose" ng-click="ctrls.SimpleModalCtrl.cancel()"></i></div><div class="modal-body">{{::\'SilverApp.addPages.spreadCheck\'|translate}}</div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.SimpleModalCtrl.ok()" data-test-key="button_addextrapage_modal_ok">{{::\'SilverApp.Ok\'|translate}}</button></div></div>'),a.put("SilverApp/views/add-pages-modal.html",'<div class="modal-width-medium modal-content"><div class="modal-header"><span class="modal-header-title" translate="">SilverApp.addPages</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_addpages_modal_xclose" ng-click="ctrls.AddPagesModalCtrl.cancel()"></i></div><form class="form-horizontal" name="addPagesForm" role="form"><div class="modal-body"><div class="form-group"><div class="col-sm-12"><ul class="list-inline"><li class="pull-left"><label for="pageNumber" class="control-label normal-label" translate="">SilverApp.add</label></li><li class="col-xs-2"><input type="sf-number" max-val="{{ctrls.AddPagesModalCtrl.numPagesLeftToAdd}}" ng-model="ctrls.AddPagesModalCtrl.numOfPagesToAdd" class="form-control" id="pageNumber" name="pageNumber" data-test-key="pagenum_addpages" required=""/></li><li><label for="pageNumber" class="control-label normal-label">{{ ctrls.AddPagesModalCtrl.numPagesLeftToAdd | postfixTranslate:\'SilverApp.canAddUpToXPages\' }}</label></li></ul></div></div><div class="form-group"><div ng-switch="" on="ctrls.AddPagesModalCtrl.isOnSpecialPage" class="col-sm-12"><div ng-switch-when="true"><div class="share-radio clickable" btn-radio="\'{{ctrls.AddPagesModalCtrl.OPTION_AFTER}}\'" ng-model="ctrls.AddPagesModalCtrl.selectedDirection" ng-change="ctrls.AddPagesModalCtrl.refreshPagesLeftToAdd()"><div class="share-text" data-test-key="radio_addpages_after">{{::\'SilverApp.afterTitlePage\'|translate}}</div></div><div class="share-radio clickable" btn-radio="\'{{ctrls.AddPagesModalCtrl.OPTION_END}}\'" ng-model="ctrls.AddPagesModalCtrl.selectedDirection" ng-change="ctrls.AddPagesModalCtrl.refreshPagesLeftToAdd()"><div class="share-text" data-test-key="radio_addpages_end">{{::\'SilverApp.toTheEndOfTheBook\'|translate}}</div></div></div><div ng-switch-default=""><div class="share-radio clickable" btn-radio="\'{{ctrls.AddPagesModalCtrl.OPTION_AFTER}}\'" ng-model="ctrls.AddPagesModalCtrl.selectedDirection" ng-change="ctrls.AddPagesModalCtrl.refreshPagesLeftToAdd()"><div class="share-text" data-test-key="radio_addpages_after">{{ctrls.AddPagesModalCtrl.afterPageNumber | postfixTranslate:\'SilverApp.afterPageX\'}}</div></div><div class="share-radio clickable" btn-radio="\'{{ctrls.AddPagesModalCtrl.OPTION_BEFORE}}\'" ng-model="ctrls.AddPagesModalCtrl.selectedDirection" ng-change="ctrls.AddPagesModalCtrl.refreshPagesLeftToAdd()"><div class="share-text" data-test-key="radio_addpages_before">{{ctrls.AddPagesModalCtrl.currentPageNumber | postfixTranslate:\'SilverApp.beforePageX\'}}</div></div><div class="share-radio clickable" btn-radio="\'{{ctrls.AddPagesModalCtrl.OPTION_END}}\'" ng-model="ctrls.AddPagesModalCtrl.selectedDirection" ng-change="ctrls.AddPagesModalCtrl.refreshPagesLeftToAdd()"><div class="share-text" data-test-key="radio_addpages_end">{{::\'SilverApp.toTheEndOfTheBook\'|translate}}</div></div></div></div></div><div class="form-group"><div class="col-sm-12">{{::\'SilverApp.addEvenPagesReminder\'|translate}}</div></div></div><div class="modal-footer"><button type="button" ng-disabled="!addPagesForm.pageNumber.$valid || ctrls.AddPagesModalCtrl.numOfPagesToAdd==0" class="btn btn-default btn-primary" ng-click="ctrls.AddPagesModalCtrl.ok()" data-test-key="button_addpages_modal_ok">{{::\'SilverApp.add.button\'|translate}}</button></div></form></div>'),
a.put("SilverApp/views/add-photos-modal.html",'<div ng-class="{\'modal-width-small\': !ctrls.MainCtrl.superSimple, \'modal-width-small-for-simple\': ctrls.MainCtrl.superSimple, \'modal-content\': true}"><div class="modal-header"><span class="modal-header-title modal-header-title-center">{{::\'SilverApp.createYourStory\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" data-test-key="button_addphotos_modal_xclose" ng-click="ctrls.SimpleModalCtrl.cancel()"></i></div><div class="modal-body"><p>{{::\'SilverApp.createYourStoryBooks\'|translate}}</p></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.SimpleModalCtrl.ok()" omniture="" linkname="Add photos" data-test-key="button_addphotos_modal_ok">{{::\'SilverApp.addPhotos\'|translate}}</button></div></div>'),a.put("SilverApp/views/align-menu-items.html",'<li ng-class="{disabled: !ctrls.CustomizeCtrl.canAlign}"><a class="clickable" ng-click="ctrls.CustomizeCtrl.alignLeft()" data-test-key="button_align_left_edges">{{::\'SilverApp.alignLeftMenuItem\'|translate}}</a></li><li ng-class="{disabled: !ctrls.CustomizeCtrl.canAlign}"><a data-test-key="button_align_centers" ng-click="ctrls.CustomizeCtrl.alignCenter()" class="clickable">{{::\'SilverApp.alignCenterMenuItem\'|translate}}</a></li><li ng-class="{disabled: !ctrls.CustomizeCtrl.canAlign}"><a data-test-key="button_align_right_edges" ng-click="ctrls.CustomizeCtrl.alignRight()" class="clickable">{{::\'SilverApp.alignRightMenuItem\'|translate}}</a></li><li class="divider"></li><li ng-class="{disabled: !ctrls.CustomizeCtrl.canAlign}"><a class="clickable" ng-click="ctrls.CustomizeCtrl.alignTop()" data-test-key="button_align_top_edges">{{::\'SilverApp.alignTopMenuItem\'|translate}}</a></li><li ng-class="{disabled: !ctrls.CustomizeCtrl.canAlign}"><a data-test-key="button_align_middles" ng-click="ctrls.CustomizeCtrl.alignMiddle()" class="clickable">{{::\'SilverApp.alignMiddleMenuItem\'|translate}}</a></li><li ng-class="{disabled: !ctrls.CustomizeCtrl.canAlign}"><a data-test-key="button_align_bottom_edges" ng-click="ctrls.CustomizeCtrl.alignBottom()" class="clickable">{{::\'SilverApp.alignBottomMenuItem\'|translate}}</a></li>'),a.put("SilverApp/views/allow-undo-autofill-modal.html",'<div class="modal-width-medium-2 modal-content"><div class="modal-header"><h4 class="modal-header-title">{{::\'SilverApp.allowUndoAutofillModalTitle\'|translate}}</h4></div><form class="form-horizontal" name="autofillPagesForm" role="form"><div class="modal-body"><div class="form-group"><div class="col-sm-12"><div class="share-radio autofill-radio clickable" btn-radio="\'{{ctrls.AllowUndoAutofillModalCtrl.OPTION_YES}}\'" ng-model="ctrls.AllowUndoAutofillModalCtrl.selectedOption"><div class="autofill-text" data-test-key="radio_autofill_yes">{{::\'SilverApp.autofillBook\'|translate}}</div><div class="autofill-text-light">{{::\'SilverApp.autofillBook2\'|translate}}</div></div><div style="height: 100px"></div><div class="share-radio autofill-radio clickable" btn-radio="\'{{ctrls.AllowUndoAutofillModalCtrl.OPTION_NO}}\'" ng-model="ctrls.AllowUndoAutofillModalCtrl.selectedOption"><div class="autofill-text" data-test-key="radio_autofill_no">{{::\'SilverApp.dontAutofillBook\'|translate}}</div><div class="autofill-text-light">{{::\'SilverApp.dontAutofillBook2\'|translate}}</div></div><div style="height: 50px"></div></div></div><div style="height: 200px"><div class="autofill-thumbnail" style="position: absolute; top: 230px; left: 70px"><img style="max-width: 120px; max-height: 120px" ng-src="{{ctrls.AllowUndoAutofillModalCtrl.image1}}"></div><div class="autofill-thumbnail" style="position: absolute; top: 280px; left: 100px"><img style="max-width: 120px; max-height: 120px" ng-src="{{ctrls.AllowUndoAutofillModalCtrl.image2}}"></div><div class="autofill-thumbnail" style="position: absolute; top: 210px; left: 150px"><img style="max-width: 120px; max-height: 120px" ng-src="{{ctrls.AllowUndoAutofillModalCtrl.image3}}"></div><i class="icon-place-photos-pb"></i></div></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.AllowUndoAutofillModalCtrl.ok()" data-test-key="button_allowundoautofill_modal_ok">{{::\'SilverApp.nextButton\'|translate}}</button></div></form></div>'),a.put("SilverApp/views/apply-to-other-pages-modal.html",'<div class="apply-to-other-pages-modal apply-to-other-pages-modal modal-width-small modal-content" movemodal=""><div class="modal-header"><span class="modal-header-title" translate="">SilverApp.applyOtherPageButton</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_apply_to_other_pages_modal_xclose" ng-click="ctrls.ApplyToOtherPagesCtrl.closeDialog()"></i></div><form class="form-horizontal modal-body" role="form"><div class="form-group"><div class="col-sm-12"><span translate="">SilverApp.applyOtherPageModal1</span> {{ctrls.ApplyToOtherPagesCtrl.getPageNumber()}} <span translate="">SilverApp.applyOtherPageModal2</span></div></div><div class="checkbox"><input id="check1" type="checkbox" name="check" ng-model="selections.layout"><label for="check1">Layout</label><br><input id="check2" type="checkbox" name="check" ng-model="selections.background"><label for="check2">Background</label><br><input id="check3" type="checkbox" name="check" ng-model="selections.frames"><label for="check3">Frame</label></div></form><div class="modal-footer"><a class="btn btn-link" ng-click="ctrls.ApplyToOtherPagesCtrl.closeDialog()" data-test-key="button_apply_to_other_pages_do_not_apply" translate="">SilverApp.doNotApplyOtherPageModalButton</a> <button type="button" class="btn btn-primary" ng-click="ctrls.ApplyToOtherPagesCtrl.apply()" data-test-key="button_apply_to_other_pages_apply" translate="">SilverApp.applyOtherPageModalButton</button></div></div>'),a.put("SilverApp/views/arrange-tab-simple.html",'<div ng-include="\'SilverApp/views/toolbar.html\'" ng-if="!ctrls.MainCtrl.superSimple"></div><div class="clearfix app-subnav" ng-class="::{\'entrytext-phone\':ctrls.MainCtrl.isDeviceAPhone()}" ng-if="ctrls.MainCtrl.superSimple"><div class="subnav-title" translate="">SilverApp.arrangetab.entrytext</div></div><div class="arrange-pages allowVerticalScroll" ng-class="{\'arrange-pages-bottom\':ctrls.MainCtrl.config.isBaconV2, \'advanced-arrange\':ctrls.MainCtrl.config.advancedArrange}" sf-editable-asset-handler="" on-remove-image="ctrls.SurfaceCtrl.onRemoveImage(page, asset)" ng-include="\'Palette/views/pages-in-arrange-tab.html\'"></div><div ng-if="ctrls.MainCtrl.config.advancedArrange" class="palette-tabs app-footer arrange-palette clearfix"><tabset><tab class="clickable" heading="{{::\'Palette.photo\' | translate }}" data-test-key="tab_photos" active="ctrls.PaletteCtrl.PaletteTabSelection.images"><div ng-if="ctrls.NavCtrl.arrangeIsActive" class="palette-images clearfix" ng-include="\'Palette/views/images.html\'"></div></tab><tab class="clickable" heading="{{::\'Palette.styles\' | translate }}" data-test-key="tab_styles" select="ctrls.StyleTabCtrl.tabWasMadeActive()" active="ctrls.PaletteCtrl.PaletteTabSelection.styles"><div ng-if="ctrls.NavCtrl.arrangeIsActive" class="palette-images clearfix" ng-include="\'Palette/views/styles.html\'"></div></tab></tabset></div>'),a.put("SilverApp/views/arrange-tab.html",'<div ng-include="\'SilverApp/views/toolbar.html\'" ng-if="!ctrls.MainCtrl.superSimple"></div><div class="arrange-pages" ng-class="{\'arrange-pages-supersimple\': ctrls.MainCtrl.superSimple, \'advanced-arrange\':ctrls.MainCtrl.config.advancedArrange, \'expanded-bottom-palette\':ctrls.PaletteCtrl.lowerPaletteIsExpanded, \'collapsed-bottom-palette\':ctrls.PaletteCtrl.lowerPaletteIsCollapsed}" sf-editable-asset-handler="" on-remove-image="ctrls.SurfaceCtrl.onRemoveImage(page, asset)" ng-include="\'Palette/views/pages-in-arrange-tab.html\'"></div><div ng-if="ctrls.MainCtrl.config.advancedArrange" class="palette-tabs app-footer arrange-palette clearfix" ng-class="{\'expanded\': ctrls.PaletteCtrl.lowerPaletteIsExpanded, \'collapsed\': ctrls.PaletteCtrl.lowerPaletteIsCollapsed}"><tabset><tab class="clickable" heading="{{::\'Palette.photo\' | translate }}" data-test-key="tab_photos" active="true"><div ng-if="ctrls.NavCtrl.arrangeIsActive" class="palette-images clearfix" ng-include="\'Palette/views/images.html\'"></div></tab></tabset></div>'),a.put("SilverApp/views/auth-forms.html",'<div class="modal-width-small modal-content"><div id="login-container" ng-show="!ctrls.AuthenticationCtrl.showingSignUp"><div class="modal-header"><span class="modal-header-title" ng-if="!ctrls.AuthenticationCtrl.signInModalWithDetail">{{::\'SilverApp.sign.in.title\'|translate}}</span> <span class="modal-header-title" ng-if="ctrls.AuthenticationCtrl.signInModalWithDetail">{{::\'SilverApp.sign.in.to.save.your.work\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_login_modal_xclose" ng-click="ctrls.AuthenticationCtrl.close()" ng-if="!ctrls.AuthenticationCtrl.forceLogin"></i></div><div class="modal-body" ng-if="ctrls.AuthenticationCtrl.signInModalWithDetail"><p class="red-text">{{::\'SilverApp.sign.in.to.save.your.work.content\'|translate}}</p></div><form name="loginForm" action="{{ctrls.AuthenticationCtrl.signInActionUrl}}" method="POST" target="sf-sfly-auth-target" ng-submit="ctrls.AuthenticationCtrl.reportLoginSubmit()" novalidate=""><input type="hidden" name="outputFormat" value="postMessage"/><input type="hidden" name="subdomain" value="{{ctrls.AuthenticationCtrl.targetSubdomain}}"/><input type="hidden" name="version" value="2"/><input type="hidden" name="av" value="0"/><input type="hidden" name="each" value="1"/><input type="hidden" name="h"/><input type="hidden" name="t"/><input type="hidden" name="h2"/><div class="modal-body"><div class="form-group" ng-class="{\'has-error\':ctrls.AuthenticationCtrl.invalidCredentials}"><input class="auth-input-fields" name="userName" sf-focus="" placeholder="{{::\'SilverApp.login.dialog.email\'|translate}}" ng-model="ctrls.AuthenticationCtrl.email" data-test-key="sign_in_dialog_email" required=""/><div class="message-container message-container--inline" data-test-key="required-email" ng-show="loginForm.email.$dirty && loginForm.email.$error.required"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error">{{::\'SilverApp.required\'|translate}}</span></div><div class="checkbox"><label><input type="checkbox" name="rememberUserName" ng-model="ctrls.AuthenticationCtrl.rememberEmail" ng-change="ctrls.AuthenticationCtrl.forgetEmail()"><span>{{::\'SilverApp.email.remember\'|translate}}</span></label></div></div><div class="form-group" ng-class="{\'has-error\':ctrls.AuthenticationCtrl.invalidCredentials}"><input class="auth-input-fields" type="password" name="password" placeholder="{{::\'SilverApp.login.dialog.password\'|translate}}" ng-model="ctrls.AuthenticationCtrl.password" data-test-key="sign_in_dialog_password" required=""/><div class="message-container message-container--inline" ng-show="loginForm.password.$dirty && loginForm.password.$error.required"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error">{{::\'SilverApp.required\'|translate}}</span></div></div><div class="form-group"><a target="_blank" href="{{ctrls.AuthenticationCtrl.forgotUrl}}" class="btn-link">{{::\'SilverApp.login.dialog.forgot\'|translate}}</a></div><div class="form-group"><span>{{::\'SilverApp.do.not.have.account\'|translate}}</span> <a data-test-key="link-go-to-sign-up" class="btn-link" ng-click="ctrls.AuthenticationCtrl.flipForm()">{{::\'SilverApp.sign.up\'|translate}}</a></div></div><div class="modal-footer"><div class="message-container message-container--inline message-container--lef-align message-container--medium" ng-show="ctrls.AuthenticationCtrl.invalidCredentials"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error" data-test-key="invalid-credentials">{{::\'SilverApp.login.dialog.invalid.login\'|translate}}</span></div><button ng-disabled="ctrls.AuthenticationCtrl.submitDisabled" type="submit" class="btn btn-primary" data-test-key="button_sign_in_dialog"><span>{{::\'SilverApp.sign.in\'|translate}}</span></button></div></form></div><div id="sign-up-container" ng-show="ctrls.AuthenticationCtrl.showingSignUp"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.sign.up.title\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_login_modal_xclose" ng-click="ctrls.AuthenticationCtrl.close()" ng-click="ctrls.AuthenticationCtrl.close()"></i></div><form name="signUpForm" action="{{ctrls.AuthenticationCtrl.signUpActionUrl}}" method="POST" target="sf-sfly-auth-target" ng-submit="ctrls.AuthenticationCtrl.reportSignUp()" novalidate=""><input type="hidden" name="outputFormat" value="postMessage"/><input type="hidden" name="subdomain" value="{{ctrls.AuthenticationCtrl.targetSubdomain}}"/><input type="hidden" name="version" value="2"/><input type="hidden" name="av" value="0"/><input type="hidden" name="terms" value="on"/><input type="hidden" name="receivePromos" value="on"/><input type="hidden" name="h"/><input type="hidden" name="t"/><input type="hidden" name="h2"/><div class="modal-body"><div class="form-group"><input class="auth-input-fields" name="firstName" placeholder="{{::\'SilverApp.sign.up.first.name\'|translate}}" ng-model="ctrls.AuthenticationCtrl.firstName" data-test-key="sign_up_first_name" required=""><div class="message-container message-container--inline" ng-show="signUpForm.firstName.$dirty && signUpForm.firstName.$error.required" data-test-key="required-first-name"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error">{{::\'SilverApp.required\'|translate}}</span></div></div><div class="form-group"><input class="auth-input-fields" name="lastName" placeholder="{{::\'SilverApp.sign.up.last.name\'|translate}}" ng-model="ctrls.AuthenticationCtrl.lastName" data-test-key="sign_up_last_name" required=""><div class="message-container message-container--inline" ng-show="signUpForm.lastName.$dirty && signUpForm.lastName.$error.required" data-test-key="required-last-name"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error">{{::\'SilverApp.required\'|translate}}</span></div></div><div class="form-group"><input class="auth-input-fields" type="email" name="userName" placeholder="{{::\'SilverApp.login.dialog.email\'|translate}}" ng-model="ctrls.AuthenticationCtrl.email" ng-change="ctrls.AuthenticationCtrl.emailChanged()" sf-email-validator="" data-test-key="sign_up_dialog_email" required=""><div class="message-container message-container--inline" ng-show="signUpForm.email.$dirty && signUpForm.email.$error.required" data-test-key="required-email"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error">{{::\'SilverApp.required\'|translate}}</span></div><div class="message-container message-container--inline" ng-show="signUpForm.email.$dirty && signUpForm.email.$error.sfMultipleEmails && !signUpForm.email.$error.required" data-test-key="invalid-email"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error">{{::\'SilverApp.email.invalid\'|translate}}</span></div><div class="message-container message-container--inline" ng-show="ctrls.AuthenticationCtrl.emailExists" data-test-key="invalid-credentials"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error">{{::\'SilverApp.email.already.used\'|translate}}</span></div><div class="message-container message-container--inline" ng-show="ctrls.AuthenticationCtrl.alreadyLogin" data-test-key="already-log-in"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error">{{::\'SilverApp.email.already.login\'|translate}}</span></div><div class="checkbox"><label><input type="checkbox" ng-model="ctrls.AuthenticationCtrl.rememberEmail" ng-change="ctrls.AuthenticationCtrl.forgetEmail()">{{::\'SilverApp.email.remember\'|translate}}</label></div></div><div class="form-group"><input class="auth-input-fields" type="password" name="newPassword" id="newPassword" placeholder="{{::\'SilverApp.login.dialog.password\'|translate}}" ng-model="ctrls.AuthenticationCtrl.newPassword" data-test-key="sign_up_password" required="" ng-minlength="4" maxlength="10"><div class="message-container message-container--inline" ng-show="signUpForm.newPassword.$dirty && signUpForm.newPassword.$error.required" data-test-key="required-password"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error">{{::\'SilverApp.required\'|translate}}</span></div><div class="message-container message-container--inline" ng-show="signUpForm.newPassword.$dirty && signUpForm.newPassword.$error.minlength && !signUpForm.newPassword.$error.required" data-test-key="password-length"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error">{{::\'SilverApp.sign.up.password.length\'|translate}}</span></div><p>{{::\'SilverApp.sign.up.password.description\'|translate}}</p></div><div class="form-group"><input class="auth-input-fields" type="password" name="password" placeholder="{{::\'SilverApp.login.dialog.confirmPassword\'|translate}}" ng-model="ctrls.AuthenticationCtrl.password" data-test-key="sign_up_confirm_password" required="" ng-minlength="4" maxlength="10" must-match="#newPassword"><div class="message-container message-container--inline" ng-show="signUpForm.password.$dirty && signUpForm.password.$error.required" data-test-key="required-confirm-password"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error">{{::\'SilverApp.required\'|translate}}</span></div><div class="message-container message-container--inline" ng-show="signUpForm.password.$dirty && signUpForm.password.$error.minlength && !signUpForm.password.$error.required" data-test-key="confirm-password-length"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error">{{::\'SilverApp.sign.up.password.length\'|translate}}</span></div><div class="message-container message-container--inline" ng-show="signUpForm.password.$dirty && !signUpForm.password.$error.minlength && signUpForm.password.$error.mustMatch && !signUpForm.password.$error.required" data-test-key="confirm-passwords-match"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error">{{::\'SilverApp.sign.up.password.mustMatch\'|translate}}</span></div></div><div class="form-group">{{::\'SilverApp.sign.up.accept.terms.prefix\'|translate}} <a ng-click="ctrls.AuthenticationCtrl.openTermsAndConditions()" class="btn-link">{{::\'SilverApp.sign.up.terms.and.conditions\'|translate}}</a> {{::\'SilverApp.sign.up.accept.terms.conjunction\'|translate}} <a ng-click="ctrls.AuthenticationCtrl.openPrivacyPolicy()" class="btn-link">{{::\'SilverApp.sign.up.privacy.policy\'|translate}}</a></div><div class="form-group"><a class="btn-link" data-test-key="link-go-to-sign-in" ng-click="ctrls.AuthenticationCtrl.flipForm()">{{::\'SilverApp.sign.in\'|translate}}</a></div></div><div class="modal-footer"><button ng-disabled="signUpForm.$invalid || ctrls.AuthenticationCtrl.submitDisabled" class="btn btn-primary" type="submit" data-test-key="button_sign_up_dialog"><span>{{::\'SilverApp.sign.up\'|translate}}</span></button></div></form></div></div>'),a.put("SilverApp/views/autofill-unplaced-photos-modal.html",'<div class="modal-width-medium modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.autofill.unplacedPhotos.title\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_cannotaddphoto_modal_xclose" ng-click="ctrls.SimpleModalCtrl.cancel()"></i></div><div class="modal-body"><p>{{[ctrls.SimpleModalCtrl.data.numPlaced, ctrls.SimpleModalCtrl.data.numUnplaced] | postfixTranslate:\'SilverApp.autofill.unplacedPhotos.p1\'}}</p><p>{{::\'SilverApp.autofill.unplacedPhotos.p3\'|translate}}</p></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.SimpleModalCtrl.ok()" data-test-key="button_cannotaddphoto_modal_ok">{{::\'SilverApp.Ok\'|translate}}</button></div></div>'),a.put("SilverApp/views/bacon-choose-cover.html",'<div class="modal-width-cover modal-content" ng-class="{\'modal-width-fit\': !ctrls.ChooseCoverCtrl.nativeAndroid, \'modal-width-fit-native-browser\': ctrls.ChooseCoverCtrl.nativeAndroid}"><div class="modal-header-mobile bacon-book-type-text"><div class="text-center book-type" data-test-key="v2_book_type">{{::\'SilverApp.bookType\'|translate}}</div></div><div class="bacon-select-next" ng-if="ctrls.ChooseCoverCtrl.showUpp" ng-click="ctrls.ChooseCoverCtrl.baconChangeSize(); ctrls.UppCtrl.showUPP()"><div class="bacon-next bacon-next-cover" data-test-key="v2_select">{{::\'SilverApp.arrange.navbar.next\'|translate}}</div></div><div class="bacon-select-next" ng-if="!ctrls.ChooseCoverCtrl.showUpp" ng-click="ctrls.ChooseCoverCtrl.baconChangeSize()"><div class="bacon-next bacon-next-cover" data-test-key="v2_select">{{::\'SilverApp.arrange.navbar.next\'|translate}}</div></div><div class="choose-cover"><div class="col-xs-6" ng-click="ctrls.ChooseCoverCtrl.hardCover()" ng-class="{selected: (ctrls.ChooseCoverCtrl.hardCoverSelected == true)}"><div class="cover-toggle-left-mobile" data-test-key="v2_hard_cover"></div></div><div class="col-xs-6" ng-click="ctrls.ChooseCoverCtrl.softCover()" ng-class="{selected: (ctrls.ChooseCoverCtrl.hardCoverSelected == false)}"><div class="cover-toggle-right-mobile" data-test-key="v2_soft_cover"></div></div></div><div class="modal-body-mobile"><div id="baconCoverStyleList"><ol class="list-unstyled"><li ng-repeat="book in ctrls.ChooseCoverCtrl.bookTypes()" ng-click="ctrls.ChooseCoverCtrl.baconSelect(book.size, book)" ng-class="{selected: (book.size == ctrls.ChooseCoverCtrl.selectedSize)}" data-test-key="v2_input_book_size_{{:: book.size }}"><div class="col-xs-3"><div class="book-thumbnail-{{:: book.size }}"></div></div><div class="col-xs-7 column-for-bacon"><div class="bookDesc">{{:: book.bookType | translate}}</div><div class="priceWrapper"><span>{{::\'SilverApp.from\'|translate}}</span><div class="origPrice" ng-if="ctrls.ChooseCoverCtrl.hardCoverSelected == true" ng-class="{\'strikeThrough\': ctrls.ChooseCoverCtrl.originHardCoverPrice !== null && ctrls.ChooseCoverCtrl.originHardCoverPrice[book.size].isOnSale}">{{ ctrls.ChooseCoverCtrl.originHardCoverPrice[book.size].origPrice | currency }}</div><div class="origPrice" ng-if="ctrls.ChooseCoverCtrl.hardCoverSelected == false" ng-class="{\'strikeThrough\': ctrls.ChooseCoverCtrl.originSoftCoverPrice !== null && ctrls.ChooseCoverCtrl.originSoftCoverPrice[book.size].isOnSale}">{{ ctrls.ChooseCoverCtrl.originSoftCoverPrice[book.size].origPrice | currency}}</div><div class="salePrice" ng-if="ctrls.ChooseCoverCtrl.coverPricesBySize !== null && ctrls.ChooseCoverCtrl.coverPricesBySize[book.size].isOnSale">{{ctrls.ChooseCoverCtrl.getPriceForSize(book.size) | currency}}</div></div></div><div class="col-xs-2"><div class="cover-book-size-check-mobile" data-test-key="v2_check"></div></div></li></ol></div></div></div>'),a.put("SilverApp/views/book-tab.html",'<div class="book-tab" ng-controller="BookTabCtrl"><div class="clearfix app-subnav"><div class="subnav-title">{{::\'SilverApp.booktab.entrytext\'|translate}}</div></div><div><div class="cover-choices btn-group"><div class="book-tab-row-category"><div class="book-tab-row book-tab-title-row"><div class="book-tab-cell book-tab-cell-heavy">{{::\'SilverApp.booktab.options\'|translate}}</div><div class="book-tab-cell wrap-header">{{::\'SilverApp.booktab.pageOptions.standard\'|translate}}</div><div class="book-tab-cell wrap-header">{{::\'SilverApp.booktab.pageOptions.glossy\'|translate}}</div><div class="book-tab-cell wrap-header-layflat" ng-if="ctrls.BookTabCtrl.showHingedLayflatColumn">{{::\'SilverApp.booktab.pageOptions.hingedLayflat\'|translate}}</div><div class="book-tab-cell wrap-header-layflat">{{::\'SilverApp.booktab.pageOptions.layflat\'|translate}}</div></div></div><div class="book-tab-row-category" ng-repeat="bookCategory in ctrls.BookTabCtrl.getAvailableCoverCategories() track by bookCategory.type"><div class="book-tab-row book-tab-row--first-content category-title"><div class="book-tab-cell" translate="">{{bookCategory.description}}</div><div class="book-tab-cell"></div><div class="book-tab-cell"></div><div class="book-tab-cell"></div></div><div class="book-tab-row highlightable-row" ng-repeat="bookOption in ctrls.BookTabCtrl.getAvailableOptions() | filter:{category:bookCategory.type} | orderBy : \'categoryIndex\' : reverse track by bookOption.testKeyPrefix"><div class="book-tab-cell"><span translate="">{{bookOption.description}}</span><span ng-class="{\'best-seller-badge\': bookOption.isBestSeller}"></span></div><div class="book-tab-cell"><div class="book-tab-radio clickable" btn-radio="bookOption.pageOptions.standard" ng-model="ctrls.BookTabCtrl.selectedCover" ng-show="bookOption.pageOptions.standard != undefined" ng-mouseover="ctrls.BookTabCtrl.setMarketingMaterial(bookOption.pageOptions.standard)" ng-mouseleave="ctrls.BookTabCtrl.setMarketingMaterialToCurrentCover()" ng-click="ctrls.BookTabCtrl.setSelectedCover(bookOption, ctrls.BookTabCtrl.PAGES_STANDARD)" data-test-key="{{bookOption.testKeyPrefix}}-standard"></div></div><div class="book-tab-cell"><div class="book-tab-radio clickable" btn-radio="bookOption.pageOptions.glossy" ng-model="ctrls.BookTabCtrl.selectedCover" ng-if="bookOption.pageOptions.glossy" ng-mouseover="ctrls.BookTabCtrl.setMarketingMaterial(bookOption.pageOptions.glossy)" ng-mouseleave="ctrls.BookTabCtrl.setMarketingMaterialToCurrentCover()" ng-click="ctrls.BookTabCtrl.setSelectedCover(bookOption, ctrls.BookTabCtrl.PAGES_GLOSSY)" data-test-key="{{bookOption.testKeyPrefix}}-glossy"></div></div><div class="book-tab-cell" ng-if="ctrls.BookTabCtrl.showHingedLayflatColumn"><div class="book-tab-radio clickable" btn-radio="bookOption.pageOptions.hinged" ng-model="ctrls.BookTabCtrl.selectedCover" ng-if="bookOption.pageOptions.hinged" ng-mouseover="ctrls.BookTabCtrl.setMarketingMaterial(bookOption.pageOptions.hinged)" ng-mouseleave="ctrls.BookTabCtrl.setMarketingMaterialToCurrentCover()" ng-click="ctrls.BookTabCtrl.setSelectedCover(bookOption, ctrls.BookTabCtrl.PAGES_HINGED_LAYFLAT)" data-test-key="{{bookOption.testKeyPrefix}}-hinged-layflat"></div></div><div class="book-tab-cell"><div class="book-tab-radio clickable" btn-radio="bookOption.pageOptions.layflat" ng-model="ctrls.BookTabCtrl.selectedCover" ng-if="bookOption.pageOptions.layflat" ng-mouseover="ctrls.BookTabCtrl.setMarketingMaterial(bookOption.pageOptions.layflat)" ng-mouseleave="ctrls.BookTabCtrl.setMarketingMaterialToCurrentCover()" ng-click="ctrls.BookTabCtrl.setSelectedCover(bookOption, ctrls.BookTabCtrl.PAGES_LAYFLAT)" data-test-key="{{bookOption.testKeyPrefix}}-layflat"></div></div></div></div><div class="book-tab-row"><div class="book-tab-cell"></div><div class="book-tab-cell"></div><div class="book-tab-cell"></div><div class="book-tab-cell"></div></div><div class="book-tab-row" ng-class="{\'book-tab-disable-pocket\': ctrls.BookTabCtrl.isKeepsakeDisabled}"><div class="book-tab-cell book-tab-cell-heavy">{{::\'SilverApp.booktab.keepsakePocket.title\'|translate}}</div></div><div class="book-tab-row book-tab-row--last-content"><div class="book-tab-cell"></div><div class="book-tab-cell"></div><div class="book-tab-cell"></div><div class="book-tab-cell"></div></div><p></p><p></p><div class="book-tab-row" ng-class="{\'book-tab-disable-pocket\': ctrls.BookTabCtrl.isKeepsakeDisabled}"><input type="checkbox" class="book-tab-radio book-tab-radio-checkbox clickable" data-test-key="input-keepsake-pocket" ng-class="{\'book-tab-checked\': ctrls.BookTabCtrl.isKeepsakeSelected}" ng-disabled="ctrls.BookTabCtrl.isKeepsakeDisabled" ng-model="ctrls.BookTabCtrl.isKeepsakeSelected" ng-click="ctrls.BookTabCtrl.toggleKeepsakePocket()"/><div class="book-tab-cell book-tab-cell-checkbox-width">{{::\'SilverApp.booktab.keepsakePocket\'|translate}}</div></div></div><div class="book-cover-image-wrapper"><div class="book-cover-image-cell"><i class="book-cover-image {{ctrls.BookTabCtrl.currentMarketingAsset}}"></i> <span class="book-cover-text">{{ctrls.BookTabCtrl.currentMarketingText | translate}}</span></div></div></div></div>'),a.put("SilverApp/views/cannot-add-photo-area-modal.html",'<div class="modal-width-small modal-content"><div class="modal-header"><i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_cannotaddphoto_modal_xclose" ng-click="ctrls.SimpleModalCtrl.cancel()"></i><h4 class="modal-header-title">{{::\'SilverApp.CannotAddPhotoarea\'|translate}}</h4></div><div class="modal-body">{{::\'SilverApp.CannotAddPhotoareaMoreDescription\'|translate}}</div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.SimpleModalCtrl.ok()" data-test-key="button_cannotaddphoto_modal_ok">{{::\'SilverApp.Ok\'|translate}}</button></div></div>'),a.put("SilverApp/views/cannot-choose-cover-photo-modal.html",'<div class="modal-width-small modal-content"><div class="modal-header"><i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_cannotaddphoto_modal_xclose" ng-click="ctrls.SimpleModalCtrl.cancel()"></i><h4 class="modal-header-title">{{::\'SilverApp.cannotChooseCoverPhotoTitle\'|translate}}</h4></div><div class="modal-body"><div>{{::\'SilverApp.imageTooltipNotUploadingCover\'|translate}}</div></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.SimpleModalCtrl.ok()" data-test-key="button_cannotaddphoto_modal_ok">{{::\'SilverApp.Ok\'|translate}}</button></div></div>'),a.put("SilverApp/views/cannot-edit-photo-modal.html",'<div class="modal-width-small modal-content"><div class="modal-header"><i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_cannotaddphoto_modal_xclose" ng-click="ctrls.SimpleModalCtrl.cancel()"></i><h4 class="modal-header-title">{{::\'SilverApp.cannotEditPhotoTitle\'|translate}}</h4></div><div class="modal-body"><div ng-if="!ctrls.SimpleModalCtrl.data.allowUpload">{{::\'SilverApp.imageTooltipNotUploading\'|translate}}</div><div ng-if="ctrls.SimpleModalCtrl.data.allowUpload">{{::\'SilverApp.imageTooltipUploading\'|translate}}</div></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.SimpleModalCtrl.ok()" data-test-key="button_cannotaddphoto_modal_ok">{{::\'SilverApp.Ok\'|translate}}</button></div></div>'),a.put("SilverApp/views/cannot-save-jpg-modal.html",'<div class="modal-width-small modal-content"><div class="modal-header"><i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_cannotsavejpg_modal_xclose" ng-click="ctrls.SimpleModalCtrl.cancel()"></i><h4 class="modal-header-title">{{::\'SilverApp.saveJPG\'|translate}}</h4></div><div class="modal-body"><div ng-if="!ctrls.SimpleModalCtrl.data.allowUpload">{{::\'SilverApp.cannotSaveJPG\'|translate}}</div></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.SimpleModalCtrl.ok()" data-test-key="button_cannotsavejpg_modal_ok">{{::\'SilverApp.Ok\'|translate}}</button></div></div>'),
a.put("SilverApp/views/change-cover-warning.html",'<div class="modal-width-medium modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.changeCoverWarningDialog.title\'|translate}}</span></div><div class="modal-body"><div><span>{{\'SilverApp.changeCoverWarningDialog.coverChangeMessage\' | translate: ctrls.ChangeCoverWarningCtrl.params}}</span><ul><li>{{\'SilverApp.changeCoverWarningDialog.sizeChangeMessage\' | translate: ctrls.ChangeCoverWarningCtrl.params}}</li></ul></div><div><span>{{::\'SilverApp.changeCoverWarningDialog.pleaseReviewMessage\'|translate}}</span><ul><li>{{::\'SilverApp.changeSizeWarningDialog.textNotFitMessage\'|translate}}</li><li>{{::\'SilverApp.changeSizeWarningDialog.photoCropMessage\'|translate}}</li></ul></div><div><span>{{::\'SilverApp.note\'|translate}}</span><ul><li><span>{{::\'SilverApp.changeSizeWarningDialog.aspectChangeReviewNote\'|translate}}</span></li><li><span>{{::\'SilverApp.changeCoverWarningDialog.priceChange\'|translate}}</span></li></ul></div></div><div class="modal-footer"><div ng-if="ctrls.ChangeCoverWarningCtrl.isCoverUpgrade"><button type="button" class="btn btn-default btn-link" data-test-key="button_changecover_modal_cancel" ng-click="ctrls.ChangeCoverWarningCtrl.cancel()">{{::\'SilverApp.changeCoverWarningDialog.dontChangeSize\'|translate}}</button> <button type="button" class="btn btn-default btn-primary" data-test-key="button_changecover_modal_ok" ng-click="ctrls.ChangeCoverWarningCtrl.continue()">{{::\'SilverApp.changeCoverWarningDialog.changeSize\'|translate}}</button></div><div ng-if="!ctrls.ChangeCoverWarningCtrl.isCoverUpgrade"><button type="button" class="btn btn-default btn-link" data-test-key="button_changecover_modal_ok" ng-click="ctrls.ChangeCoverWarningCtrl.continue()">{{::\'SilverApp.changeCoverWarningDialog.changeSize\'|translate}}</button> <button type="button" class="btn btn-default btn-primary" data-test-key="button_changecover_modal_cancel" ng-click="ctrls.ChangeCoverWarningCtrl.cancel()">{{::\'SilverApp.changeCoverWarningDialog.dontChangeSize\'|translate}}</button></div></div></div>'),a.put("SilverApp/views/change-size-warning.html",'<div class="modal-width-medium modal-content"><div class="modal-header"><span class="modal-header-title"><i class="icon icon-warning"></i><span translate="">{{ctrls.ChangeSizeWarningCtrl.warningType.title}}</span></span></div><div class="modal-body"><div ng-show="{{ctrls.ChangeSizeWarningCtrl.showCoverSizeWarning()}}"><span>{{ctrls.ChangeSizeWarningCtrl.warningType.coverMesg | translate: ctrls.ChangeSizeWarningCtrl.params}}</span><ul><li>{{\'SilverApp.changeSizeWarningDialog.coverTypeMessage\' | translate: ctrls.ChangeSizeWarningCtrl.params}}</li></ul></div><div ng-show="{{ctrls.ChangeSizeWarningCtrl.showSizeWarning()}}"><span>{{ctrls.ChangeSizeWarningCtrl.warningType.sizeMesg | translate: ctrls.ChangeSizeWarningCtrl.params}}</span><ul><li>{{::\'SilverApp.changeSizeWarningDialog.textNotFitMessage\'|translate}}</li><li>{{::\'SilverApp.changeSizeWarningDialog.photoCropMessage\'|translate}}</li><li>{{::\'SilverApp.changeSizeWarningDialog.layoutChangedMessage\'|translate}}</li></ul></div><div><span>{{::\'SilverApp.note\'|translate}}</span><ul><li ng-repeat="note in ctrls.ChangeSizeWarningCtrl.warningType.note"><span>{{note | translate}}</span></li></ul></div></div><div class="modal-footer"><button type="button" class="btn btn-default btn-link" data-test-key="button_changesize_modal_cancel" ng-click="ctrls.ChangeSizeWarningCtrl.cancel()">{{::\'SilverApp.changeCoverWarningDialog.dontChangeSize\'|translate}}</button> <button type="button" class="btn btn-default btn-primary" data-test-key="button_changesize_modal_ok" ng-click="ctrls.ChangeSizeWarningCtrl.continue()">{{::\'SilverApp.continue\'|translate}}</button></div></div>'),a.put("SilverApp/views/change-style-warning.html",'<div class="modal-width-small modal-content"><div class="modal-header"><span class="modal-header-title"><span>{{::\'SilverApp.changeStyleWarningDialog.simpleTitle\'|translate}}</span></span></div><div class="modal-body"><div><p>{{::\'SilverApp.changeStyleWarningDialog.simple\'|translate}}</p></div></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" data-test-key="button_changestyle_modal_ok" ng-click="ctrls.StyleTabCtrl.warningContinue()">{{::\'SilverApp.Ok\'|translate}}</button></div></div>'),a.put("SilverApp/views/change-style.html","<div data-test-key=\"style_store_dialog\" ng-class=\"{'modal-width-xlarge': !ctrls.MainCtrl.superSimple,\n                'modal-width-large-left': ctrls.MainCtrl.superSimple,\n                'modal-height-tall': !ctrls.MainCtrl.superSimple,\n                'modal-height-medium': ctrls.MainCtrl.superSimple,\n"+'                \'modal-content\': true}"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.changeStyle\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" data-test-key="button_style_modal_xclose" ng-click="ctrls.StyleTabCtrl.cancel()"></i></div><div class="modal-body" style="padding: 0"><div ng-class="{\'style-store-dialog\': ctrls.MainCtrl.superSimple, \'style-store-dialog-tall\': !ctrls.MainCtrl.superSimple}" ng-if="!ctrls.StyleTabCtrl.styleStoreInactive"><iframe ng-class="{\'style-store-dialog\': ctrls.MainCtrl.superSimple, \'style-store-dialog-tall\': !ctrls.MainCtrl.superSimple}" data-test-key="style_store_dialog" frameborder="1" frameloadedall="" ng-src="{{(ctrls.StyleTabCtrl.styleStoreUrl)}}"></iframe></div></div><div class="modal-footer"></div></div>'),a.put("SilverApp/views/choose-cover-photo.html",'<div class="modal-width-cover modal-content" ng-class="{\'modal-width-fit\': !ctrls.ChooseCoverCtrl.nativeAndroid, \'modal-width-fit-native-browser\': ctrls.ChooseCoverCtrl.nativeAndroid}"><div class="modal-header modal-header-cover"><span class="modal-header-title-cover">{{::\'SilverApp.selectCoverPhoto\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" data-test-key="button_choosephotocover_modal_xclose" ng-click="ctrls.ChooseCoverPhotoCtrl.cancel()"></i></div><div class="modal-body" ng-controller="ImageCtrl"><div id="coverStyleList" class="allowVerticalScroll" ng-include="\'Palette/views/images-list-choose-cover.html\'" data-test-key="div_photos_choose_cover"></div></div></div>'),a.put("SilverApp/views/choose-cover.html",'<div class="modal-width-cover modal-content" ng-class="{\'modal-width-fit\': !ctrls.ChooseCoverCtrl.nativeAndroid, \'modal-width-fit-native-browser\': ctrls.ChooseCoverCtrl.nativeAndroid}"><div class="modal-header modal-header-cover"><span class="modal-header-title-cover">{{::\'SilverApp.selectACover\'|translate}}</span></div><div class="modal-body" style="height: 100%"><div id="coverStyleList"><ul class="list-unstyled clearfix allowVerticalScroll"><li class="styleWrapper" ng-repeat="option in ctrls.ChooseCoverCtrl.coverOptions" ng-click="ctrls.ChooseCoverCtrl.selectCover(option)" omniture="" linkname="Choose Cover Style" ng-class="{\'selected\': (option == ctrls.ChooseCoverCtrl.activeCover)}"><img class="thumbImg" src="{{option.thumbImg}}"><div class="descWrapper"><div class="styleName">{{option.styleName | translate}}</div><div class="bookDesc">{{option.bookDesc | translate}}</div><div class="priceWrapper"><span>{{::\'SilverApp.from\'|translate}}</span><div class="origPrice" ng-class="{\'strikeThrough\': ctrls.ChooseCoverCtrl.priceOptions[option.bookDesc].totalOrigPrice != ctrls.ChooseCoverCtrl.priceOptions[option.bookDesc].totalSalePrice}">{{ctrls.ChooseCoverCtrl.priceOptions[option.bookDesc].totalOrigPrice | currency}}</div><div class="salePrice" ng-if="ctrls.ChooseCoverCtrl.priceOptions[option.bookDesc].totalOrigPrice != ctrls.ChooseCoverCtrl.priceOptions[option.bookDesc].totalSalePrice">{{ctrls.ChooseCoverCtrl.priceOptions[option.bookDesc].totalSalePrice | currency}}</div></div></div></li></ul></div></div></div>'),a.put("SilverApp/views/default-pricing-receipt.html",'<sf-pricing-receipt page-count="project.product.pages.length" description-id="project.product.descriptionId" binding-type="project.product.cover.binding" is-enabled="!ctrls.OrderCtrl.orderAndInUpsellModal" book-pricing="bookPricing"></sf-pricing-receipt>'),a.put("SilverApp/views/dev/Import-Favorites.html",'<textarea class="json-viewer" ng-controller="ImportFavoritesCtrl" ng-model="ctrls.ImportFavoritesCtrl.favoritesJSONToImport"></textarea><div style="margin: 2px"><sf-button ng-click="ctrls.ImportFavoritesCtrl.importFavorites()">Import Favorites</sf-button></div><div class="log-in-warning" ng-if="!ctrls.ImportFavoritesCtrl.user.isLoggedIn">Please login to use this panel</div>'),a.put("SilverApp/views/dev/about.html",'<div class="modal-width-about modal-content force-fullscreen"><div class="modal-header"></div><div class="modal-body"><div id="titles"></div><div style="display: none"><div id="credits-source"><h1>Management</h1><p>Rachel Ensminger, Alex Ross, Mike Pfeffer</p><h1>Software</h1><p>Joe Rozek, Ben Longoria, Jason Rose</p><p>Artur Marnik, Lin Tun, Scott Delamater</p><p>Mark Blanford, Matt Ganski, Andy Fischer</p><p>Swarna Kanukurthy</p><h1>Quality</h1><p>Shailaja Natte, Zoya Ismakova, Phil Jenkins</p><p>Glenn Ong, Gordon Zaft, Truett Kueck</p><h1>User Experience</h1><p>Riordan Reyes, Greg Bosch</p><h1>Services</h1><p>Chandru Subramaniam, Steve Churchill, Lakshmi Vyas</p><h1>Special Thanks</h1><p>Trynne Miller, Raghu Srinivasan, Michael Hirsch</p><p>Anuradha Gali, Ammie Kalygulov, Andrew Mullen</p><p>Lauren Oltesvig, Lara Hoyem, Bill Law</p><p>Jonathan Davalle, Dana Brecher, Dave Pirtle</p><p>Manoj Aggarwal, Matthew Holloway, Eugene Chen</p><p>Manan Singh, Monica Dominguez</p></div></div></div><script>var options = {time_factor: 1};\n        $(\'#titles\').titleSequence([\n            {\n                pause: 40\n            },\n            {\n                content: \'Galleon\',\n                id: \'galleon\',\n                class: \'title\',\n'+"                css: {left: '225px', top: '180px', opacity: 0},\n                animate: {opacity: 1},\n                duration: 1800,\n                pause: 900\n            },\n            {\n                content: 'A rensminger production',\n                class: 'subtitle',\n                id: 'galleonsub',\n                css: {left: '65px', top: '246px', width: 0},\n                animate: {width: '478px'},\n                duration: 1200\n            },\n            {\n                pause: 2300\n            },\n            {\n                delete: '#galleonsub'\n            },\n            {\n                delete: '#galleon'\n            },\n            {\n                pause: 700\n            },\n            {\n                content: $('#credits-source').html(),\n                id: 'credits',\n                css: {top: '350px', height: '1400px'},\n                animate: {top: '-1150px'},\n                duration: 45000,\n                easing: 'linear'\n            }\n        ], options);</script></div>"),a.put("SilverApp/views/dev/app-info.html",'<div class="dev-book-info"><p></p><p><strong>Build number:</strong> {{ctrls.DevCtrl.buildNumber}}</p><p><strong>Time stamp:</strong> {{ctrls.DevCtrl.timeStamp}}</p><p><strong>UPP version:</strong> {{ctrls.DevCtrl.uppVersion()}}</p><p><strong>DocSmith core version:</strong> {{ctrls.DevCtrl.docSmithVersion()}}</p><p></p><p><strong>Browser name:</strong> {{ctrls.DevCtrl.browser.name}}</p><p><strong>Browser version:</strong> {{ctrls.DevCtrl.browser.version}}</p><p><strong>Android:</strong> {{ctrls.DevCtrl.android}}</p><p><strong>iOS:</strong> {{ctrls.DevCtrl.ios}}</p><p><strong>Device:</strong> {{ctrls.DevCtrl.device}}</p></div><div style="margin: 2px"><button type="button" class="btn btn-default btn-secondary" ng-click="ctrls.DevCtrl.showAbout()">About</button></div>'),a.put("SilverApp/views/dev/book-info.html",'<div class="dev-book-info"><p></p><p><strong><span>Title:</span></strong><span data-test-key="dev_console_title">{{ctrls.DevCtrl.projectService.currentProject.title}}</span></p><p ng-if="ctrls.DevCtrl.projectService.currentProject.projectGUID"><strong><span>Project Guid:</span></strong><span data-test-key="dev_console_projectGuid">{{ctrls.DevCtrl.projectService.currentProject.projectGUID}}</span></p><p ng-if="ctrls.DevCtrl.projectService.currentProject.projectGUID"><strong><span>guid|userid:</span></strong> <span data-test-key="dev_console_projectGuid" id="guidToCopy">{{ctrls.DevCtrl.projectService.currentProject.projectGUID}}|{{ctrls.DevCtrl.projectService.currentProject.userId}}</span> <button class="btn btn-primary" id="copyGuidBtn" data-clipboard-target="#guidToCopy" ng-if="ctrls.DevCtrl.userIdsMatch()">Copy</button></p><p ng-if="ctrls.DevCtrl.projectService.currentProject.userId"><strong><span>User Id:</span></strong><span data-test-key="dev_console_userId">{{ctrls.DevCtrl.projectService.currentProject.userId}}</span></p><p><strong><span>Type:</span></strong><span data-test-key="dev_console_type">{{ctrls.DevCtrl.projectService.currentProject.type}}</span></p><p><strong><span>Subtype:</span></strong><span data-test-key="dev_console_subType">{{ctrls.DevCtrl.projectService.currentProject.product.subtype}}</span> <button class="btn btn-primary" ng-if="ctrls.DevCtrl.displayMMBButton()" ng-click="ctrls.DevCtrl.makeCopyOfMMBProject()">Make Visible Copy</button></p><p><strong><span>Page count:</span></strong><span data-test-key="dev_console_pageCount">{{ctrls.DevCtrl.projectService.currentProject.product.pages.length}}</span></p><p><strong><span>Photo count:</span></strong><span data-test-key="dev_console_photoCount">{{ctrls.DevCtrl.projectService.currentProject.imageCollection.projectImages.length}}</span></p><p><strong><span>Cover:</span></strong><span data-test-key="dev_console_cover">{{ctrls.DevCtrl.projectService.currentProject.product.cover.coverSpecID}}</span></p><p><strong><span>Stock cover:</span></strong><span data-test-key="dev_console_stock_cover">{{ctrls.DevCtrl.projectService.currentProject.product.cover.stockCoverSpecID}}</span></p><p><strong><span>Binding:</span></strong><span data-test-key="dev_console_binding">{{ctrls.DevCtrl.projectService.currentProject.product.cover.binding}}</span></p><p><strong><span>Style:</span></strong><span data-test-key="dev_console_style">{{ctrls.DevCtrl.contentService.currentStyle.displayName}}</span></p><p><strong><span>Style Id:</span></strong><span data-test-key="dev_console_styleId">{{ctrls.DevCtrl.contentService.currentStyle.styleId}}</span></p><p><strong><span>Style version:</span></strong><span data-test-key="dev_console_styleVersion">{{ctrls.DevCtrl.projectService.currentProject.product.styleContentVersion}}</span></p><p><strong><span>Style size:</span></strong><span data-test-key="dev_console_styleSize">{{ctrls.DevCtrl.contentService.currentStyle.sizeId}}</span></p><p><strong><span>Spine form factor:</span></strong><span data-test-key="dev_console_spineFormFactor">{{ctrls.DevCtrl.projectService.currentProject.product.cover.compositionTemplateLayoutName}}</span></p><p><strong><span>Spine layout Id:</span></strong><span data-test-key="dev_console_spineLayoutId">{{ctrls.DevCtrl.projectService.currentProject.product.cover.spinePage.layoutName}}</span></p><p><strong><span>Front cover layout Id:</span></strong><span data-test-key="dev_console_frontCoverLayoutId">{{ctrls.DevCtrl.projectService.currentProject.product.cover.frontPage.layoutName}}</span></p><p><strong><span>Back cover layout Id:</span></strong><span data-test-key="dev_console_backCoverLayoutId">{{ctrls.DevCtrl.projectService.currentProject.product.cover.backPage.layoutName}}</span></p><p><strong><span>Finish:</span></strong><span data-test-key="dev_console_finish">{{ctrls.DevCtrl.projectService.currentProject.product.finish}}</span></p><p><strong><span>Dust jacket:</span></strong><span data-test-key="dev_console_dustjacket">{{ctrls.DevCtrl.projectService.currentProject.product.hasDustJacket() ? ctrls.DevCtrl.projectService.currentProject.product.photobookDustJacket.id : \'None\'}}</span></p><p><strong><span>Keepsake pocket:</span></strong><span data-test-key="dev_console_keepsakePocket">{{ctrls.DevCtrl.projectService.currentProject.product.hasKeepsakePocket() ? \'Yes\' : \'No\'}}</span></p><p><strong><span>Glossy pages:</span></strong><span data-test-key="dev_console_glossyPages">{{ctrls.DevCtrl.projectService.currentProject.product.hasGlossyPages() ? \'Yes\' : \'No\'}}</span></p><a ng-if="ctrls.DevCtrl.projectService.currentProject.projectGUID" class="clickable" data-test-key="dev_console_projectURL" ng-click="ctrls.DevCtrl.openProjectViaURL()">{{ctrls.DevCtrl.getProjectURL()}}</a></div>'),a.put("SilverApp/views/dev/change-style.html",'<div ng-controller="DevChangeStyleCtrl"><span style="margin: 2px">Style Id:</span><input style="margin: 2px" ng-model="ctrls.DevChangeStyleCtrl.styleIdInput"><div style="margin: 2px"><button type="button" class="btn btn-default btn-secondary" ng-click="ctrls.DevChangeStyleCtrl.executeChangeStyle()">Change style</button></div></div>'),a.put("SilverApp/views/dev/config-values.html",'<ul class="config-values-list clearfix" ng-controller="ConfigValuesCtrl"><li ng-repeat="obj in ctrls.ConfigValuesCtrl.configValues">{{obj.key}}: {{obj.value}}</li></ul>'),a.put("SilverApp/views/dev/dev-panel.html",'<div class="dev-tool-selector"><select class="dev-tool-select" ng-model="ctrls.DevCtrl.activeTool" ng-options="tool.name for tool in ctrls.DevCtrl.tools"></select><div class="icon-dialog-close dev-close-button" ng-click="ctrls.DevCtrl.closePanel()"></div></div><div class="dev-content" ng-include="ctrls.DevCtrl.activeTool.templateUrl"></div>'),a.put("SilverApp/views/dev/export-to-pdf.html",'<div style="margin: 10px" ng-controller="SoftRenderCompareCtrl"><span>This feature only works on the Shutterfly network</span><p></p><sf-button ng-click="ctrls.SoftRenderCompareCtrl.renderBook()">Export book</sf-button></div><div class="log-in-warning" ng-if="!ctrls.SoftRenderCompareCtrl.user.isLoggedIn">Please login to use this panel</div>'),a.put("SilverApp/views/dev/import-project-json.html",'<textarea class="json-viewer" ng-controller="ManageProjectsCtrl" ng-model="ctrls.ManageProjectsCtrl.projectJSONToLoad"></textarea><div style="margin: 2px"><sf-button ng-click="ctrls.ManageProjectsCtrl.importProject()">Import project JSON</sf-button></div>'),a.put("SilverApp/views/dev/manage-projects.html",'<select class="summary-list" multiple="multiple" ng-controller="ManageProjectsCtrl" ng-if="!ctrls.ManageProjectsCtrl.doubleChecking" ng-model="ctrls.ManageProjectsCtrl.selected" ng-options="summary.title for summary in ctrls.ManageProjectsCtrl.summaries"></select><div ng-if="ctrls.ManageProjectsCtrl.doubleChecking" style="margin: 10px"><span>Are you sure you want to delete the selected projects?</span><ul><li ng-repeat="summary in ctrls.ManageProjectsCtrl.selected">{{summary.title}}</li></ul></div><div style="margin: 2px"><button type="button" class="btn btn-default btn-secondary" ng-click="ctrls.ManageProjectsCtrl.deleteProjects()">Delete selected projects</button> <button type="button" class="btn btn-default btn-primary" ng-if="!ctrls.ManageProjectsCtrl.doubleChecking && ctrls.ManageProjectsCtrl.selected.length == 1" ng-click="ctrls.ManageProjectsCtrl.openProject()">Open project</button> <button type="button" class="btn btn-default btn-primary" ng-if="ctrls.ManageProjectsCtrl.doubleChecking" ng-click="ctrls.ManageProjectsCtrl.doubleChecking = false">Cancel</button></div><div class="log-in-warning" ng-if="!ctrls.ManageProjectsCtrl.user.isLoggedIn">Please login to use this panel</div>'),a.put("SilverApp/views/dev/page-info.html",'<div class="dev-book-info"><p><strong><span>Page number:</span></strong><span data-test-key="dev_console_title">{{ctrls.NavCtrl.selectedPage.surfaceNumber}}</span></p><p ng-controller="DevPanelApplyLayoutCtrl"><strong><span>Apply Layout:</span></strong><input ng-model="ctrls.DevPanelApplyLayoutCtrl.layoutId"/><button class="btn btn-primary" ng-click="ctrls.DevPanelApplyLayoutCtrl.applyLayout(ctrls.NavCtrl.selectedPage)">Apply</button></p><p><strong><span>Asset counts by type:</span></strong><span data-test-key="dev_console_subType"></span><ul><li ng-repeat="(key, value) in ctrls.DevCtrl.assetCountsByType(ctrls.NavCtrl.selectedPage)">{{key}} : {{value}}</li></ul></p></div><textarea class="json-viewer" readonly="readonly">{{ctrls.DevCtrl.generatePageJSON(ctrls.NavCtrl.selectedPage.surfaceNumber)}}</textarea>'),a.put("SilverApp/views/dev/page-xml.html",'<textarea style="height: 50%" class="json-viewer" readonly="readonly">{{ctrls.DevCtrl.sdxml}}</textarea><div class="log-in-warning" ng-if="!ctrls.SoftRenderCompareCtrl.user.isLoggedIn">Please login to use this panel</div><div style="margin: 2px"><button type="button" class="btn btn-default btn-secondary" ng-click="ctrls.DevCtrl.generatePageXML(ctrls.NavCtrl.selectedPage.surfaceNumber)">Get Page SDXML</button> <button type="button" class="btn btn-secondary" ng-click="ctrls.DevCtrl.openARFTool()">Open ARF tool</button></div>'),a.put("SilverApp/views/dev/perfect-storm.html",'<div class="dev-button-container"><sf-button ng-click="ctrls.DevCtrl.createPerfectStorm()">Create perfect storm</sf-button><sf-button ng-click="ctrls.DevCtrl.createPerfectStorm({withMissingImages: true})">Create perfect storm (with missing image)</sf-button></div>'),a.put("SilverApp/views/dev/performance-monitor.html",'<div class="performance-monitor" ng-controller="PerformanceMonitorCtrl"><fieldset><legend>Watcher Information</legend><div style="font-weight: bold">Number of watchers: {{ ctrls.PerformanceMonitorCtrl.numWatchers }}</div><div style="margin-bottom: 10px">{{ ctrls.PerformanceMonitorCtrl.watchersMessage }}</div><button type="button" class="btn btn-default btn-secondary" ng-click="ctrls.PerformanceMonitorCtrl.countWatchers()">Count Watchers</button></fieldset></div>'),a.put("SilverApp/views/dev/product-doctor.html",'<div class="dev-button-container" ng-controller="ProductDoctorCtrl as ctrl" style="margin: 10px"><div ng-repeat="issue in ctrl.issues" style="margin-bottom: 10px"><span>{{issue}}:</span><div ng-if="!ctrl.fixable[issue]"><strong>Can\'t auto fix</strong></div><span ng-if="ctrl.fixable[issue]"><sf-button ng-click="ctrl.fix(issue)">Fix</sf-button></span></div><div ng-if="ctrl.issues.length === 0"><h3>No issues.</h3><sf-button ng-click="ctrls.SaveCtrl.save()">Save</sf-button></div></div>'),a.put("SilverApp/views/dev/project-query.html",'<div ng-controller="ProjectQueryCtrl" style="height: 90%"><input class="query-input" name="projectQuery" placeholder="enter query" ng-model="ctrls.ProjectQueryCtrl.projectNodeQuery" ng-keyup="ctrls.ProjectQueryCtrl.handleKeyUp($event)"><span style="margin-left: 5px; font-size: 11px">(Use dot separators, even for array elements)</span><textarea style="height: 90%" class="json-viewer" readonly="readonly">{{ctrls.ProjectQueryCtrl.projectNodeResult}}</textarea></div>'),a.put("SilverApp/views/dev/project-xml.html",'<textarea style="height: 50%" class="json-viewer" readonly="readonly">{{ctrls.DevCtrl.projectxml}}</textarea><div class="log-in-warning" ng-if="!ctrls.SoftRenderCompareCtrl.user.isLoggedIn">Please login to use this panel</div><div style="margin: 2px"><button type="button" class="btn btn-default btn-secondary" ng-click="ctrls.DevCtrl.generateProjectXML()">Get Project XML</button> <button type="button" class="btn btn-secondary" ng-click="ctrls.DevCtrl.openARFTool()">Open ARF tool</button></div>'),a.put("SilverApp/views/dev/show-project-json.html",'<textarea class="json-viewer" readonly="readonly">{{ctrls.DevCtrl.generateProjectJSON()}}</textarea><div style="margin: 2px"><button type="button" class="btn btn-default btn-secondary" ng-click="ctrls.DevCtrl.openProjectJSONInNewWindow()">Open in new window</button> <button type="button" class="btn btn-default btn-secondary" ng-hide="ctrls.DevCtrl.$window.bowser.safari" ng-click="ctrls.DevCtrl.exportProjectJSONToFile()">Save to disk</button></div>'),a.put("SilverApp/views/dev/soft-render-compare.html",'<div style="margin: 10px" ng-controller="SoftRenderCompareCtrl"><span>This feature only works on the Shutterfly network</span><p></p><sf-button ng-click="ctrls.SoftRenderCompareCtrl.renderActiveSpread()">Render spread</sf-button><div><h5>Left page:</h5><span class="render-status {{ctrls.SoftRenderCompareCtrl.leftRenderState}}">{{ctrls.SoftRenderCompareCtrl.leftRenderState}}</span></div><div ng-if="ctrls.SoftRenderCompareCtrl.hasSpine()"><h5>Spine page:</h5><span class="render-status {{ctrls.SoftRenderCompareCtrl.spineRenderState}}">{{ctrls.SoftRenderCompareCtrl.spineRenderState}}</span></div><div><h5>Right page:</h5><span class="render-status {{ctrls.SoftRenderCompareCtrl.rightRenderState}}">{{ctrls.SoftRenderCompareCtrl.rightRenderState}}</span></div></div><div class="log-in-warning" ng-if="!ctrls.SoftRenderCompareCtrl.user.isLoggedIn">Please login to use this panel</div>'),a.put("SilverApp/views/dev/super-project.html",'<div class="dev-button-container"><sf-button ng-click="ctrls.DevCtrl.createSuperbook()">Create superbook project</sf-button></div>'),a.put("SilverApp/views/dev/switch-language.html",'<select class="summary-list" multiple="multiple" ng-controller="SwitchLanguageCtrl" ng-model="ctrls.SwitchLanguageCtrl.selected" ng-options="language.name for language in ctrls.SwitchLanguageCtrl.languages"></select><div style="margin: 2px"><button type="button" class="btn btn-default btn-secondary" ng-click="ctrls.SwitchLanguageCtrl.switchLanguage()">Switch language</button></div>'),a.put("SilverApp/views/dev/switch-palette.html",'<div style="margin: 2px"><button type="button" class="btn btn-default btn-secondary" ng-click="ctrls.PaletteCtrl.switchPaletteMode()">Switch palette mode</button></div>'),a.put("SilverApp/views/dev/virtual-assets.html",'<div ng-controller="VirtualAssetsCtrl"><span style="margin: 2px">Remove empty grid assets; undoable</span><div style="margin: 2px"><button type="button" class="btn btn-default btn-secondary" ng-click="ctrls.VirtualAssetsCtrl.executeRemove()">Remove</button></div></div>'),a.put("SilverApp/views/edit-image-simple.html",'<div class="modal-width-xlarge-edit modal-height-tall-edit modal-content edit-image-simple" movemodal="" ng-class="::{\'exclude-from-drag\': ctrls.MainCtrl.isDeviceAPhone()}"><div class="modal-header"><div class="clearfix"><i type="button" class="icon-dialog-close icon-dialog-close-edit-image" data-dismiss="modal" aria-hidden="true" data-test-key="button_edit_image_modal_xclose" ng-click="ctrls.EditImageCtrl.dismiss()"></i></div></div><div class="modal-body"><image-editor max-size="405" on-commit-changes="ctrls.EditImageCtrl.setTabChangedCallback(tabChangedCallback)" on-remove="ctrls.EditImageCtrl.dismiss()" original-asset="ctrls.EditImageCtrl.originalAsset" page="ctrls.EditImageCtrl.page"></image-editor></div><div class="modal-footer"><ul class="list-unstyled list-inline"><li class="cancel-button"><a class="btn btn-link" ng-click="ctrls.EditImageCtrl.dismiss()" data-test-key="button_edittext_modal_cancel">{{::\'Palette.Cancel\'|translate}}</a></li><li class="done-button"><a class="btn btn-link" ng-click="ctrls.EditImageCtrl.done()" data-test-key="button_edittext_modal_ok_mobile">{{::\'SilverApp.done\'|translate}}</a></li><li><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.EditImageCtrl.done()" data-test-key="button_edit_image_modal_ok">{{::\'SilverApp.done\'|translate}}</button></li></ul></div></div>'),a.put("SilverApp/views/edit-tab.html",'<div class="edit-tab {{ctrls.PaletteCtrl.isDualPaletteMode ? \'dual-palette\' : \'single-palette\'}}" ng-class="{collapsed: !ctrls.PaletteCtrl.secondaryPalette.isExpanded, \'edit-tab--inpreview\':ctrls.MainCtrl.appState.inPreviewMode }" ng-controller="EditTabCtrl"><div ng-if="!ctrls.MainCtrl.previewMode" ng-include="\'SilverApp/views/toolbar.html\'"></div><div class="entire-surface-area" ng-class="{\'entire-surface-area-preview\': ctrls.MainCtrl.previewMode, \'advanced-edit-background\': ctrls.CustomizeCtrl.isCustomizing()}" ng-click="ctrls.CustomizeCtrl.deselectAll()"><div ng-include="\'SilverApp/views/@@p/surface.html\'" include-replace=""></div></div><div ng-if="!ctrls.MainCtrl.previewMode" ng-include="\'Palette/views/palette.html\'"></div><div ng-if="ctrls.MainCtrl.previewMode && !ctrls.PaletteCtrl.hidePages" class="palette-tabs app-footer clearfix" ng-if="!ctrls.MainCtrl.isDeviceAPhone() || (ctrls.MainCtrl.isDeviceAPhone() && ctrls.MainCtrl.deviceOrientation!=\'landscape\')"><div ng-include="\'Palette/views/@@p/pages.html\'"></div></div></div>'),a.put("SilverApp/views/edit-text-simple.html",'<div class="edit-text-modal modal-width-medium modal-content" ng-class="::{\'exclude-from-drag\': ctrls.MainCtrl.isDeviceAPhone(), \'edit-text-modal--with-preview\': ctrls.EditTextCtrl.previewTextEnabled}" movemodal=""><div class="modal-header edit-text-header" ng-class="::{\'edit-text-header-higher\': ctrls.MainCtrl.isDeviceAPhone()}"><div class="clearfix"><i type="button" class="icon-dialog-move"></i></div><div class="edit-text-style"><span class="edit-text-style-label" translate="">SilverApp.editText.textStyle</span> <span class="edit-text-style-value">{{"SilverApp.editText.paraStyle." + ctrls.EditTextCtrl.textAsset.asset.paraStyle | translate}} <span translate="">SilverApp.editText.textSuffix</span></span></div><font-settings asset="ctrls.EditTextCtrl.textAsset" is-advanced-text="ctrls.MainCtrl.features.advancedText" on-text-style-changed="ctrls.EditTextCtrl.onTextStyleChanged(data)"></font-settings><i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_edittext_modal_xclose" ng-click="ctrls.EditTextCtrl.close()"></i></div><div class="modal-body edit-text-body"><div class="message-container"><span class="modal-header-title"></span><div ng-show="ctrls.EditTextCtrl.warnings.length > 0" class="edit-text-style-tablet"><span class="message-container__icon message-container__icon--warning"></span> <span class="message-container__text message-container__text--warning" data-test-key="long-text-warning" translate="">{{ctrls.EditTextCtrl.warnings.join(" ")}}</span></div></div><form name="editTextForm" novalidate=""><textarea name="textInput" class="edit-text-area" ng-readonly="ctrls.EditTextCtrl.textAsset.isEventTextAsset && ctrls.MainCtrl.features.calendarV2" sf-focus="" sf-refocus="{{!ctrls.EditTextCtrl.finishingCurrentSession}}" ng-trim="false" spellcheck="true" data-test-key="simple_edit_text_area" ng-model="ctrls.EditTextCtrl.textContent" ng-change="ctrls.EditTextCtrl.checkForWarnings()">\n          </textarea></form><div class="edit-text-padding"></div></div><div class="modal-footer edit-text-footer"><i class="icon-previous-page" ng-if="!ctrls.MainCtrl.superSimple" ng-class="{\'disabled\': ctrls.EditTextCtrl.finishingCurrentSession}" data-test-key="edit_text_previous" ng-click="ctrls.EditTextCtrl.finishingCurrentSession || ctrls.EditTextCtrl.previousTextAsset()"></i> <i class="icon-next-page" ng-if="!ctrls.MainCtrl.superSimple" ng-class="{\'disabled\': ctrls.EditTextCtrl.finishingCurrentSession}" data-test-key="edit_text_next" ng-click="ctrls.EditTextCtrl.finishingCurrentSession || ctrls.EditTextCtrl.nextTextAsset()"></i><div ng-if="ctrls.EditTextCtrl.textAsset.isEventTextAsset && ctrls.MainCtrl.features.calendarV2" class="message-event-text-edit">{{::\'SilverApp.clickToEditEvent\'|translate}}</div><button type="button" ng-class="{\'disabled\': ctrls.EditTextCtrl.finishingCurrentSession}" class="btn btn-default btn-primary" ng-click="ctrls.EditTextCtrl.finishingCurrentSession || ctrls.EditTextCtrl.done()" data-test-key="button_edittext_modal_ok">{{::\'SilverApp.done\'|translate}}</button></div><div class="edit-text-preview" ng-if="ctrls.EditTextCtrl.width > 800 || ctrls.EditTextCtrl.height > 600 && !ctrls.MainCtrl.superSimple && ctrls.EditTextCtrl.previewTextEnabled">{{::\'SilverApp.noTextPreview\'|translate}}</div><div ng-if="ctrls.EditTextCtrl.textContent != \'\' && !ctrls.MainCtrl.superSimple && ctrls.EditTextCtrl.previewTextEnabled && ctrls.EditTextCtrl.width <= 800 && ctrls.EditTextCtrl.height <= 600" class="preview-text-body" ng-class="{\'preview-dark\': ctrls.EditTextCtrl.textStyles.color == \'#FFFFFF\' || ctrls.EditTextCtrl.textStyles.color == \'#FFFEEE\'}" ng-style="ctrls.EditTextCtrl.styles"><img class="hundies" ng-src="{{ctrls.EditTextCtrl.url}}"></div></div>'),
a.put("SilverApp/views/edit-text-tablet.html",'<div class="edit-text-modal modal-width-medium modal-content" movemodal=""><div class="modal-header modal-header-tablet"></div><div class="modal-body edit-text-body"><div class="message-container"><span class="modal-header-title" translate="">SilverApp.editText</span><div ng-show="ctrls.EditTextCtrl.warnings.length > 0" class="edit-text-style-tablet"><span class="message-container__icon message-container__icon--warning"></span> <span class="message-container__text message-container__text--warning" data-test-key="long-text-warning" translate="">{{ctrls.EditTextCtrl.warnings.join(" ")}}</span></div></div><form name="editTextForm" novalidate=""><textarea name="textInput" class="edit-text-area" sf-focus="" sf-refocus="{{!ctrls.EditTextCtrl.finishingCurrentSession}}" ng-trim="false" spellcheck="true" data-test-key="simple_edit_text_area" ng-model="ctrls.EditTextCtrl.textContent" ng-change="ctrls.EditTextCtrl.checkForWarnings()"></textarea></form></div><div class="modal-footer edit-text-footer edit-text-footer-tablet"><font-settings asset="ctrls.EditTextCtrl.textAsset" is-advanced-text="ctrls.MainCtrl.features.advancedText" on-text-style-changed="ctrls.EditTextCtrl.onTextStyleChanged(data)"></font-settings><div class="tablet-buttons"><a class="btn btn-link" ng-click="ctrls.EditTextCtrl.close()" data-test-key="button_edittext_modal_cancel" translate="">Palette.Cancel</a> <button type="button" ng-class="{\'disabled\': ctrls.EditTextCtrl.finishingCurrentSession}" class="btn btn-default btn-primary" ng-click="ctrls.EditTextCtrl.finishingCurrentSession || ctrls.EditTextCtrl.done()" data-test-key="button_edittext_modal_ok">{{::\'SilverApp.done\'|translate}}</button></div></div></div>'),a.put("SilverApp/views/editable-book.html",'<div class="offscreen" ng-include="\'SilverApp/views/imperative-nonsense.html\'"></div><div class="offscreen"><div ng-controller="CustomizeCtrl"></div><div ng-controller="EditTextCtrl"></div><div ng-controller="ImageCtrl"></div><div ng-controller="PagesCtrl"></div><div ng-controller="PageActionsCtrl"></div><div ng-controller="ShareCtrl"></div><div ng-controller="StylesCtrl"></div><div ng-controller="DevCtrl"></div><div ng-controller="SaveJpgCtrl"></div><div ng-controller="ShowOpenOnDesktopCtrl"></div><div class="hide" ng-controller="NewFeatureCtrl"></div></div><div class="app-header" ng-include="\'SilverApp/views/header.html\'" ng-controller="StoryboardTabCtrl"></div><div ng-controller="NavCtrl" ng-include="\'SilverApp/views/@@p/tabs.html\'" include-replace=""></div><div class="app-status" ng-include="\'SilverApp/views/status.html\'" ng-click="ctrls.CustomizeCtrl.deselectAll()"></div><div ng-controller="StyleTabCtrl" class="dev-panel" ng-include="ctrls.DevCtrl.devPanel"></div><div ng-include="\'SilverApp/views/filters.html\'"></div><sf-tooltip></sf-tooltip>'),a.put("SilverApp/views/error-dialog.html",'<div class="modal-width-medium modal-content" movemodal=""><div ng-show="ctrls.ErrorDialogCtrl.show()"><div class="modal-header"><span class="modal-header-title"><i class="icon icon-error"></i> <span ng-switch="ctrls.ErrorDialogCtrl.data.hasUnrecoverableErrors === true"><span ng-switch-when="false">{{::\'SilverApp.error\'|translate}}</span> <span ng-switch-when="true">{{::\'SilverApp.unrecoverable.title\'|translate}}</span></span></span> <i type="button" class="icon-dialog-move"></i> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_errordialog_modal_xclose" ng-click="ctrls.ErrorDialogCtrl.cancel()"></i></div><div class="modal-body"><span ng-switch="ctrls.ErrorDialogCtrl.data.hasUnrecoverableErrors === true"><span ng-switch-when="false">{{::\'SilverApp.sorry\'|translate}}</span> <span ng-switch-when="true">{{::\'SilverApp.unrecoverable.message\'|translate}}</span></span><div style="margin-top: 10px"><a class="btn-link" data-test-key="link-go-to-sign-in" ng-click="ctrls.ErrorDialogCtrl.off()">{{::\'SilverApp.hideDetails\'|translate}}</a></div><textarea readonly="readonly" class="error-text-area" ng-trim="false" data-test-key="error_text_area">{{::\'SilverApp.sorryAgain\'|translate}}{{::\'SilverApp.contact\'|translate}}{{::\'SilverApp.pleaseProvide\'|translate}}{{ctrls.ErrorDialogCtrl.data.message}}\n                      </textarea></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.ErrorDialogCtrl.ok()" data-test-key="button_errrodialog_modal_ok">{{::ctrls.ErrorDialogCtrl.data.hasUnrecoverableErrors === true ? \'SilverApp.unrecoverable.reopen\' : \'SilverApp.Ok\' | translate}}</button></div></div><div ng-hide="ctrls.ErrorDialogCtrl.show()"><div class="modal-header"><span class="modal-header-title"><i class="icon icon-error"></i> <span ng-switch="ctrls.ErrorDialogCtrl.data.hasUnrecoverableErrors === true"><span ng-switch-when="false">{{::\'SilverApp.error\'|translate}}</span> <span ng-switch-when="true">{{::\'SilverApp.unrecoverable.title\'|translate}}</span></span></span> <i type="button" class="icon-dialog-move"></i> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_errordialog_modal_xclose" ng-click="ctrls.ErrorDialogCtrl.cancel()"></i></div><div class="modal-body"><span ng-switch="ctrls.ErrorDialogCtrl.data.hasUnrecoverableErrors === true"><span ng-switch-when="false">{{::\'SilverApp.sorry\'|translate}}</span> <span ng-switch-when="true">{{::\'SilverApp.unrecoverable.message\'|translate}}</span></span><div style="margin-top: 10px"><a class="btn-link" data-test-key="link-go-to-sign-in" ng-click="ctrls.ErrorDialogCtrl.on()">{{::\'SilverApp.showDetails\'|translate}}</a></div></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.ErrorDialogCtrl.ok()" data-test-key="button_errrodialog_modal_ok">{{::ctrls.ErrorDialogCtrl.data.hasUnrecoverableErrors === true ? \'SilverApp.unrecoverable.reopen\' : \'SilverApp.Ok\' | translate}}</button></div></div></div>'),a.put("SilverApp/views/export-pdf.html",'<div class="modal-width-medium modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.exportToPDF\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_exportpdf_modal_xclose" ng-click="ctrls.ExportToPDFCtrl.cancel()"></i></div><div class="modal-body"><div class="form-group">{{::\'SilverApp.exportInstructions\'|translate}}</div><div class="form-group"><div class="share-radio clickable" ng-if="!ctrls.ExportToPDFCtrl.disallowCurrentPageSelection()" btn-radio="\'{{ctrls.ExportToPDFCtrl.OPTION_PAGE}}\'" ng-click="ctrls.ExportToPDFCtrl.setFilename()" ng-model="ctrls.ExportToPDFCtrl.exportType"><div class="share-text" data-test-key="radio_export_page">{{::\'SilverApp.exportCurrentPage\'|translate}}</div></div><div class="share-radio clickable" btn-radio="\'{{ctrls.ExportToPDFCtrl.OPTION_BOOK}}\'" ng-click="ctrls.ExportToPDFCtrl.setFilename()" ng-model="ctrls.ExportToPDFCtrl.exportType"><div class="share-text" data-test-key="radio_export_book">{{::\'SilverApp.exportEntireBook\'|translate}}</div></div></div><span ng-if="ctrls.ExportToPDFCtrl.exportType === ctrls.ExportToPDFCtrl.OPTION_BOOK">{{ctrls.ExportToPDFCtrl.exportToPDFFilenameBook | postfixTranslate:\'SilverApp.exportToPDFContent\'}}</span> <span ng-if="ctrls.ExportToPDFCtrl.exportType === ctrls.ExportToPDFCtrl.OPTION_PAGE">{{ctrls.ExportToPDFCtrl.exportToPDFFilenamePage | postfixTranslate:\'SilverApp.exportToPDFContent\'}}</span><div ng-show="ctrls.ExportToPDFCtrl.internalProjectService.pdfService.exportTotal > 0"><br/><progressbar max="100" value="(ctrls.ExportToPDFCtrl.internalProjectService.pdfService.exporting * 100) / ctrls.ExportToPDFCtrl.internalProjectService.pdfService.exportTotal"></progressbar><span>{{::\'SilverApp.exporting\'|translate}}</span>{{ctrls.ExportToPDFCtrl.internalProjectService.pdfService.exporting}}</div></div><div class="modal-footer"><div class="pull-left">{{::\'SilverApp.photoEffectsNotInPDF\'|translate}}</div><button ng-class="{\'disabled\' : ctrls.ExportToPDFCtrl.exporting}" type="button" class="btn btn-default btn-primary" ng-click="ctrls.ExportToPDFCtrl.export()" data-test-key="button_export_pdf_modal_ok">{{::\'SilverApp.export\'|translate}}</button></div></div>'),a.put("SilverApp/views/filters.html",'<svg xmlns="http://www.w3.org/2000/svg" height="0"><filter id="webkit-BlackWhite-1"><fecomponenttransfer><fefuncr type="discrete" tableValues="0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1 1 1 1 1 1 1 1"/><fefuncg type="discrete" tableValues="0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1 1 1 1 1 1 1 1"/><fefuncb type="discrete" tableValues="0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1 1 1 1 1 1 1 1"/></fecomponenttransfer><fecomponenttransfer><fefuncr type="discrete" tableValues="0 0 0 0 0 0 0 0 0 0 0 0 0 0.003 0.007 0.011 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.988 0.992 0.996 1 1 1 1 1 1 1 1 1 1 1 1 1"/><fefuncg type="discrete" tableValues="0 0 0 0 0 0 0 0 0 0 0 0 0 0.003 0.007 0.011 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.988 0.992 0.996 1 1 1 1 1 1 1 1 1 1 1 1 1"/><fefuncb type="discrete" tableValues="0 0 0 0 0 0 0 0 0 0 0 0 0 0.003 0.007 0.011 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.988 0.992 0.996 1 1 1 1 1 1 1 1 1 1 1 1 1"/></fecomponenttransfer></filter><filter id="webkit-BlackWhite-2"><fecolormatrix type="matrix" values="0.5 0.4 0.1 0 0\n                           0.5 0.4 0.1 0 0\n                           0.5 0.4 0.1 0 0\n                           0   0   0   1 0"/></filter><filter id="BlackWhite"><fecomponenttransfer><fefuncr type="discrete" tableValues="0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1 1 1 1 1 1 1 1"/><fefuncg type="discrete" tableValues="0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1 1 1 1 1 1 1 1"/><fefuncb type="discrete" tableValues="0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1 1 1 1 1 1 1 1"/></fecomponenttransfer><fecomponenttransfer><fefuncr type="discrete" tableValues="0 0 0 0 0 0 0 0 0 0 0 0 0 0.003 0.007 0.011 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.988 0.992 0.996 1 1 1 1 1 1 1 1 1 1 1 1 1"/><fefuncg type="discrete" tableValues="0 0 0 0 0 0 0 0 0 0 0 0 0 0.003 0.007 0.011 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.988 0.992 0.996 1 1 1 1 1 1 1 1 1 1 1 1 1"/><fefuncb type="discrete" tableValues="0 0 0 0 0 0 0 0 0 0 0 0 0 0.003 0.007 0.011 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.988 0.992 0.996 1 1 1 1 1 1 1 1 1 1 1 1 1"/></fecomponenttransfer><fecolormatrix type="matrix" values="0.5 0.4 0.1 0 0\n                           0.5 0.4 0.1 0 0\n                           0.5 0.4 0.1 0 0\n                           0   0   0   1 0"/></filter><filter id="Sepia"><fecolormatrix type="matrix" values="0.299 0.587 0.114 0 0\n                           0.299 0.587 0.114 0 0\n                           0.299 0.587 0.114 0 0\n                           0     0     0     1 0"/><fecomponenttransfer><fefuncr type="discrete" tableValues="0 0.011 0.019 0.027 0.035 0.039 0.047 0.054 0.058 0.066 0.07 0.078 0.082 0.09 0.094 0.098 0.105 0.109 0.117 0.121 0.125 0.129 0.137 0.141 0.145 0.152 0.156 0.16 0.164 0.172 0.176 0.18 0.184 0.188 0.196 0.2 0.203 0.207 0.211 0.215 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.839 0.843 0.847 0.85 0.854 0.858 0.858 0.862 0.866 0.87 0.874 0.878 0.878 0.882 0.886 0.89 0.894 0.898 0.898 0.901 0.905 0.909 0.913 0.917 0.917 0.921 0.925 0.929 0.933 0.937 0.937 0.941 0.945 0.949 0.952 0.956 0.956 0.96 0.964 0.968 0.972 0.972 0.976 0.98 0.984 0.988 0.992 0.992 0.996 1"/><fefuncg type="discrete" tableValues="0 0.003 0.003 0.007 0.011 0.011 0.015 0.019 0.019 0.023 0.027 0.031 0.035 0.035 0.039 0.043 0.047 0.05 0.05 0.054 0.058 0.062 0.066 0.07 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.984 0.988 0.992 0.996 1"/><fefuncb type="discrete" tableValues="0 0 0 0.003 0.003 0.003 0.007 0.007 0.011 0.011 0.011 0.015 0.015 0.019 0.019 0.023 0.023 0.027 0.027 0.031 0.035 0.035 0.039 0.039 0.043 0.047 0.047 0.05 0.05 0.054 0.058 0.058 0.062 0.066 0.066 0.07 0.074 0.074 0.078 0.082 0.086 0.086 0.09 0.094 0.094 0.098 0.101 0.105 0.109 0.109 0.113 0.117 0.121 0.121 0.125 0.129 0.133 0.137 0.137 0.141 0.145 0.149 0.152 0.156 0.156 0.16 0.164 0.168 0.172 0.176 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.556 0.56 0.564 0.568 0.572 0.576 0.584 0.588 0.592 0.596 0.6 0.603 0.611 0.615 0.619 0.623 0.627 0.631 0.639 0.643 0.647 0.65 0.654 0.662 0.666 0.67 0.674 0.678 0.686 0.69 0.694 0.698 0.705 0.709 0.713 0.717 0.721 0.729 0.733 0.737 0.741 0.749 0.752 0.756 0.76 0.768 0.772 0.776 0.78 0.788 0.792 0.796 0.8 0.807 0.811 0.815 0.819 0.827 0.831 0.835 0.843 0.847 0.85 0.854 0.862 0.866 0.87 0.878 0.882 0.886 0.89 0.898 0.901 0.905 0.913 0.917 0.921 0.929 0.933 0.937 0.941 0.949 0.952 0.956 0.964 0.968 0.972 0.98 0.984 0.988 0.996 1"/></fecomponenttransfer></filter><filter id="webkit-Sepia"><fecomponenttransfer><fefuncr type="discrete" tableValues="0 0.011 0.019 0.027 0.035 0.039 0.047 0.054 0.058 0.066 0.07 0.078 0.082 0.09 0.094 0.098 0.105 0.109 0.117 0.121 0.125 0.129 0.137 0.141 0.145 0.152 0.156 0.16 0.164 0.172 0.176 0.18 0.184 0.188 0.196 0.2 0.203 0.207 0.211 0.215 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.839 0.843 0.847 0.85 0.854 0.858 0.858 0.862 0.866 0.87 0.874 0.878 0.878 0.882 0.886 0.89 0.894 0.898 0.898 0.901 0.905 0.909 0.913 0.917 0.917 0.921 0.925 0.929 0.933 0.937 0.937 0.941 0.945 0.949 0.952 0.956 0.956 0.96 0.964 0.968 0.972 0.972 0.976 0.98 0.984 0.988 0.992 0.992 0.996 1"/><fefuncg type="discrete" tableValues="0 0.003 0.003 0.007 0.011 0.011 0.015 0.019 0.019 0.023 0.027 0.031 0.035 0.035 0.039 0.043 0.047 0.05 0.05 0.054 0.058 0.062 0.066 0.07 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.984 0.988 0.992 0.996 1"/><fefuncb type="discrete" tableValues="0 0 0 0.003 0.003 0.003 0.007 0.007 0.011 0.011 0.011 0.015 0.015 0.019 0.019 0.023 0.023 0.027 0.027 0.031 0.035 0.035 0.039 0.039 0.043 0.047 0.047 0.05 0.05 0.054 0.058 0.058 0.062 0.066 0.066 0.07 0.074 0.074 0.078 0.082 0.086 0.086 0.09 0.094 0.094 0.098 0.101 0.105 0.109 0.109 0.113 0.117 0.121 0.121 0.125 0.129 0.133 0.137 0.137 0.141 0.145 0.149 0.152 0.156 0.156 0.16 0.164 0.168 0.172 0.176 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.556 0.56 0.564 0.568 0.572 0.576 0.584 0.588 0.592 0.596 0.6 0.603 0.611 0.615 0.619 0.623 0.627 0.631 0.639 0.643 0.647 0.65 0.654 0.662 0.666 0.67 0.674 0.678 0.686 0.69 0.694 0.698 0.705 0.709 0.713 0.717 0.721 0.729 0.733 0.737 0.741 0.749 0.752 0.756 0.76 0.768 0.772 0.776 0.78 0.788 0.792 0.796 0.8 0.807 0.811 0.815 0.819 0.827 0.831 0.835 0.843 0.847 0.85 0.854 0.862 0.866 0.87 0.878 0.882 0.886 0.89 0.898 0.901 0.905 0.913 0.917 0.921 0.929 0.933 0.937 0.941 0.949 0.952 0.956 0.964 0.968 0.972 0.98 0.984 0.988 0.996 1"/></fecomponenttransfer></filter><filter id="Sunshine"><fecomponenttransfer in="SourceGraphic" result="temp"><fefuncr type="discrete" tableValues="0 0.011 0.019 0.027 0.035 0.043 0.05 0.054 0.062 0.07 0.074 0.082 0.086 0.094 0.098 0.101 0.109 0.113 0.121 0.125 0.129 0.137 0.141 0.145 0.152 0.156 0.16 0.164 0.172 0.176 0.18 0.184 0.188 0.196 0.2 0.203 0.207 0.211 0.219 0.223 0.227 0.231 0.235 0.239 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.792 0.796 0.8 0.803 0.807 0.811 0.811 0.815 0.819 0.823 0.827 0.831 0.831 0.835 0.839 0.843 0.847 0.85 0.85 0.854 0.858 0.862 0.866 0.87 0.87 0.874 0.878 0.882 0.886 0.89 0.89 0.894 0.898 0.901 0.905 0.909 0.909 0.913 0.917 0.921 0.925 0.925 0.929 0.933 0.937 0.941 0.941 0.945 0.949 0.952 0.956 0.96 0.96 0.964 0.968 0.972 0.976 0.976 0.98 0.984 0.988 0.992 0.992 0.996 1"/><fefuncg type="discrete" tableValues="0 0.011 0.019 0.027 0.035 0.043 0.05 0.054 0.062 0.07 0.074 0.082 0.086 0.094 0.098 0.101 0.109 0.113 0.121 0.125 0.129 0.137 0.141 0.145 0.152 0.156 0.16 0.164 0.172 0.176 0.18 0.184 0.188 0.196 0.2 0.203 0.207 0.211 0.219 0.223 0.227 0.231 0.235 0.239 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.792 0.796 0.8 0.803 0.807 0.811 0.811 0.815 0.819 0.823 0.827 0.831 0.831 0.835 0.839 0.843 0.847 0.85 0.85 0.854 0.858 0.862 0.866 0.87 0.87 0.874 0.878 0.882 0.886 0.89 0.89 0.894 0.898 0.901 0.905 0.909 0.909 0.913 0.917 0.921 0.925 0.925 0.929 0.933 0.937 0.941 0.941 0.945 0.949 0.952 0.956 0.96 0.96 0.964 0.968 0.972 0.976 0.976 0.98 0.984 0.988 0.992 0.992 0.996 1"/><fefuncb type="discrete" tableValues="0 0.011 0.019 0.027 0.035 0.043 0.05 0.054 0.062 0.07 0.074 0.082 0.086 0.094 0.098 0.101 0.109 0.113 0.121 0.125 0.129 0.137 0.141 0.145 0.152 0.156 0.16 0.164 0.172 0.176 0.18 0.184 0.188 0.196 0.2 0.203 0.207 0.211 0.219 0.223 0.227 0.231 0.235 0.239 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.792 0.796 0.8 0.803 0.807 0.811 0.811 0.815 0.819 0.823 0.827 0.831 0.831 0.835 0.839 0.843 0.847 0.85 0.85 0.854 0.858 0.862 0.866 0.87 0.87 0.874 0.878 0.882 0.886 0.89 0.89 0.894 0.898 0.901 0.905 0.909 0.909 0.913 0.917 0.921 0.925 0.925 0.929 0.933 0.937 0.941 0.941 0.945 0.949 0.952 0.956 0.96 0.96 0.964 0.968 0.972 0.976 0.976 0.98 0.984 0.988 0.992 0.992 0.996 1"/></fecomponenttransfer><fecomponenttransfer in="temp" result="temp2"><fefuncr type="discrete" tableValues="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.003 0.007 0.011 0.019 0.023 0.027 0.031 0.039 0.043 0.047 0.05 0.054 0.062 0.066 0.07 0.074 0.078 0.086 0.09 0.094 0.098 0.101 0.109 0.113 0.117 0.121 0.129 0.133 0.137 0.141 0.145 0.152 0.156 0.16 0.164 0.168 0.176 0.18 0.184 0.188 0.192 0.2 0.203 0.207 0.211 0.219 0.223 0.227 0.231 0.235 0.243 0.247 0.25 0.254 0.258 0.266 0.27 0.274 0.278 0.282 0.29 0.294 0.298 0.301 0.305 0.313 0.317 0.321 0.325 0.333 0.337 0.341 0.345 0.349 0.356 0.36 0.364 0.368 0.372 0.38 0.384 0.388 0.392 0.396 0.403 0.407 0.411 0.415 0.423 0.427 0.431 0.435 0.439 0.447 0.45 0.454 0.458 0.462 0.47 0.474 0.478 0.482 0.486 0.494 0.498 0.501 0.505 0.513 0.517 0.521 0.525 0.529 0.537 0.541 0.545 0.549 0.552 0.56 0.564 0.568 0.572 0.576 0.584 0.588 0.592 0.596 0.603 0.607 0.611 0.615 0.619 0.627 0.631 0.635 0.639 0.643 0.65 0.654 0.658 0.662 0.666 0.674 0.678 0.682 0.686 0.694 0.698 0.701 0.705 0.709 0.717 0.721 0.725 0.729 0.733 0.741 0.745 0.749 0.752 0.756 0.764 0.768 0.772 0.776 0.78 0.788 0.792 0.796 0.8 0.807 0.811 0.815 0.819 0.823 0.831 0.835 0.839 0.843 0.847 0.854 0.858 0.862 0.866 0.87 0.878 0.882 0.886 0.89 0.898 0.901 0.905 0.909 0.913 0.921 0.925 0.929 0.933 0.937 0.945 0.949 0.952 0.956 0.96 0.968 0.972 0.976 0.98 0.988 0.992 0.996 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"/><fefuncg type="discrete" tableValues="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.003 0.007 0.011 0.019 0.023 0.027 0.031 0.039 0.043 0.047 0.05 0.054 0.062 0.066 0.07 0.074 0.078 0.086 0.09 0.094 0.098 0.101 0.109 0.113 0.117 0.121 0.129 0.133 0.137 0.141 0.145 0.152 0.156 0.16 0.164 0.168 0.176 0.18 0.184 0.188 0.192 0.2 0.203 0.207 0.211 0.219 0.223 0.227 0.231 0.235 0.243 0.247 0.25 0.254 0.258 0.266 0.27 0.274 0.278 0.282 0.29 0.294 0.298 0.301 0.305 0.313 0.317 0.321 0.325 0.333 0.337 0.341 0.345 0.349 0.356 0.36 0.364 0.368 0.372 0.38 0.384 0.388 0.392 0.396 0.403 0.407 0.411 0.415 0.423 0.427 0.431 0.435 0.439 0.447 0.45 0.454 0.458 0.462 0.47 0.474 0.478 0.482 0.486 0.494 0.498 0.501 0.505 0.513 0.517 0.521 0.525 0.529 0.537 0.541 0.545 0.549 0.552 0.56 0.564 0.568 0.572 0.576 0.584 0.588 0.592 0.596 0.603 0.607 0.611 0.615 0.619 0.627 0.631 0.635 0.639 0.643 0.65 0.654 0.658 0.662 0.666 0.674 0.678 0.682 0.686 0.694 0.698 0.701 0.705 0.709 0.717 0.721 0.725 0.729 0.733 0.741 0.745 0.749 0.752 0.756 0.764 0.768 0.772 0.776 0.78 0.788 0.792 0.796 0.8 0.807 0.811 0.815 0.819 0.823 0.831 0.835 0.839 0.843 0.847 0.854 0.858 0.862 0.866 0.87 0.878 0.882 0.886 0.89 0.898 0.901 0.905 0.909 0.913 0.921 0.925 0.929 0.933 0.937 0.945 0.949 0.952 0.956 0.96 0.968 0.972 0.976 0.98 0.988 0.992 0.996 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"/><fefuncb type="discrete" tableValues="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.003 0.007 0.011 0.019 0.023 0.027 0.031 0.039 0.043 0.047 0.05 0.054 0.062 0.066 0.07 0.074 0.078 0.086 0.09 0.094 0.098 0.101 0.109 0.113 0.117 0.121 0.129 0.133 0.137 0.141 0.145 0.152 0.156 0.16 0.164 0.168 0.176 0.18 0.184 0.188 0.192 0.2 0.203 0.207 0.211 0.219 0.223 0.227 0.231 0.235 0.243 0.247 0.25 0.254 0.258 0.266 0.27 0.274 0.278 0.282 0.29 0.294 0.298 0.301 0.305 0.313 0.317 0.321 0.325 0.333 0.337 0.341 0.345 0.349 0.356 0.36 0.364 0.368 0.372 0.38 0.384 0.388 0.392 0.396 0.403 0.407 0.411 0.415 0.423 0.427 0.431 0.435 0.439 0.447 0.45 0.454 0.458 0.462 0.47 0.474 0.478 0.482 0.486 0.494 0.498 0.501 0.505 0.513 0.517 0.521 0.525 0.529 0.537 0.541 0.545 0.549 0.552 0.56 0.564 0.568 0.572 0.576 0.584 0.588 0.592 0.596 0.603 0.607 0.611 0.615 0.619 0.627 0.631 0.635 0.639 0.643 0.65 0.654 0.658 0.662 0.666 0.674 0.678 0.682 0.686 0.694 0.698 0.701 0.705 0.709 0.717 0.721 0.725 0.729 0.733 0.741 0.745 0.749 0.752 0.756 0.764 0.768 0.772 0.776 0.78 0.788 0.792 0.796 0.8 0.807 0.811 0.815 0.819 0.823 0.831 0.835 0.839 0.843 0.847 0.854 0.858 0.862 0.866 0.87 0.878 0.882 0.886 0.89 0.898 0.901 0.905 0.909 0.913 0.921 0.925 0.929 0.933 0.937 0.945 0.949 0.952 0.956 0.96 0.968 0.972 0.976 0.98 0.988 0.992 0.996 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"/></fecomponenttransfer><fecomponenttransfer result="brightness"><fefuncr type="discrete" tableValues="0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"/><fefuncg type="discrete" tableValues="0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"/><fefuncb type="discrete" tableValues="0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"/></fecomponenttransfer><feblend mode="multiply" in2="brightness" in="brightness"/><fecomponenttransfer><fefuncr type="discrete" tableValues="0 0.003 0.007 0.011 0.019 0.023 0.027 0.031 0.039 0.043 0.047 0.05 0.054 0.058 0.066 0.07 0.074 0.078 0.086 0.09 0.094 0.098 0.101 0.105 0.113 0.117 0.121 0.125 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.164 0.168 0.172 0.176 0.184 0.188 0.192 0.196 0.2 0.203 0.211 0.215 0.219 0.223 0.231 0.235 0.239 0.243 0.247 0.25 0.258 0.262 0.266 0.27 0.274 0.282 0.286 0.29 0.294 0.298 0.301 0.309 0.313 0.317 0.321 0.329 0.333 0.337 0.341 0.345 0.349 0.356 0.36 0.364 0.368 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.407 0.411 0.415 0.419 0.427 0.431 0.435 0.439 0.443 0.447 0.454 0.458 0.462 0.466 0.474 0.478 0.482 0.486 0.49 0.494 0.501 0.505 0.509 0.513 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.552 0.556 0.56 0.564 0.572 0.576 0.58 0.584 0.588 0.592 0.6 0.6 0.603 0.607 0.611 0.611 0.615 0.619 0.623 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.647 0.65 0.654 0.658 0.658 0.662 0.666 0.67 0.674 0.678 0.678 0.682 0.686 0.69 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.713 0.717 0.721 0.725 0.725 0.729 0.733 0.737 0.741 0.745 0.745 0.749 0.752 0.756 0.756 0.76 0.764 0.768 0.772 0.776 0.776 0.78 0.784 0.788 0.792 0.792 0.796 0.8 0.803 0.807 0.811 0.811 0.815 0.819 0.823 0.823 0.827 0.831 0.835 0.839 0.843 0.843 0.847 0.85 0.854 0.858 0.858 0.862 0.866 0.87 0.874 0.878 0.878 0.882 0.886 0.89 0.89 0.894 0.898 0.901 0.905 0.909 0.909 0.913 0.917 0.921 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.945 0.949 0.952 0.956 0.956 0.96 0.964 0.968 0.972 0.976 0.976 0.98 0.984 0.988 0.988 0.992 0.996 1"/><fefuncg type="discrete" tableValues="0 0.003 0.007 0.011 0.015 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.521 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1"/><fefuncb type="discrete" tableValues="0 0.003 0.007 0.011 0.011 0.015 0.019 0.023 0.023 0.027 0.031 0.035 0.039 0.043 0.043 0.047 0.05 0.054 0.054 0.058 0.062 0.066 0.07 0.074 0.074 0.078 0.082 0.086 0.086 0.09 0.094 0.098 0.101 0.105 0.105 0.109 0.113 0.117 0.117 0.121 0.125 0.129 0.133 0.137 0.137 0.141 0.145 0.149 0.149 0.152 0.156 0.16 0.164 0.168 0.168 0.172 0.176 0.18 0.18 0.184 0.188 0.192 0.196 0.2 0.2 0.203 0.207 0.211 0.211 0.215 0.219 0.223 0.227 0.231 0.231 0.235 0.239 0.243 0.243 0.247 0.25 0.254 0.258 0.262 0.262 0.266 0.27 0.274 0.274 0.278 0.282 0.286 0.29 0.294 0.294 0.298 0.301 0.305 0.305 0.309 0.313 0.317 0.321 0.325 0.325 0.329 0.333 0.337 0.337 0.341 0.345 0.349 0.352 0.356 0.356 0.36 0.364 0.368 0.368 0.372 0.376 0.38 0.384 0.388 0.388 0.392 0.396 0.4 0.4 0.407 0.411 0.415 0.419 0.427 0.431 0.435 0.439 0.443 0.447 0.454 0.458 0.462 0.466 0.474 0.478 0.482 0.486 0.49 0.494 0.501 0.505 0.509 0.513 0.521 0.525 0.529 0.533 0.537 0.541 0.549 0.552 0.556 0.56 0.568 0.572 0.576 0.58 0.584 0.588 0.596 0.6 0.603 0.607 0.615 0.619 0.623 0.627 0.631 0.635 0.643 0.647 0.65 0.654 0.662 0.666 0.67 0.674 0.678 0.682 0.69 0.694 0.698 0.701 0.709 0.713 0.717 0.721 0.725 0.729 0.737 0.741 0.745 0.749 0.756 0.76 0.764 0.768 0.772 0.776 0.784 0.788 0.792 0.796 0.803 0.807 0.811 0.815 0.819 0.823 0.831 0.835 0.839 0.843 0.85 0.854 0.858 0.862 0.866 0.87 0.878 0.882 0.886 0.89 0.898 0.901 0.905 0.909 0.913 0.917 0.925 0.929 0.933 0.937 0.945 0.949 0.952 0.956 0.96 0.964 0.972 0.976 0.98 0.984 0.992 0.996 1"/></fecomponenttransfer><fecomponenttransfer><fefuncr type="discrete" tableValues="0 0.011 0.019 0.027 0.035 0.043 0.05 0.054 0.062 0.07 0.074 0.082 0.086 0.094 0.098 0.101 0.109 0.113 0.121 0.125 0.129 0.137 0.141 0.145 0.152 0.156 0.16 0.164 0.172 0.176 0.18 0.184 0.188 0.196 0.2 0.203 0.207 0.211 0.219 0.223 0.227 0.231 0.235 0.239 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.792 0.796 0.8 0.803 0.807 0.811 0.811 0.815 0.819 0.823 0.827 0.831 0.831 0.835 0.839 0.843 0.847 0.85 0.85 0.854 0.858 0.862 0.866 0.87 0.87 0.874 0.878 0.882 0.886 0.89 0.89 0.894 0.898 0.901 0.905 0.909 0.909 0.913 0.917 0.921 0.925 0.925 0.929 0.933 0.937 0.941 0.941 0.945 0.949 0.952 0.956 0.96 0.96 0.964 0.968 0.972 0.976 0.976 0.98 0.984 0.988 0.992 0.992 0.996 1"/><fefuncg type="discrete" tableValues="0 0.011 0.019 0.027 0.035 0.043 0.05 0.054 0.062 0.07 0.074 0.082 0.086 0.094 0.098 0.101 0.109 0.113 0.121 0.125 0.129 0.137 0.141 0.145 0.152 0.156 0.16 0.164 0.172 0.176 0.18 0.184 0.188 0.196 0.2 0.203 0.207 0.211 0.219 0.223 0.227 0.231 0.235 0.239 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.792 0.796 0.8 0.803 0.807 0.811 0.811 0.815 0.819 0.823 0.827 0.831 0.831 0.835 0.839 0.843 0.847 0.85 0.85 0.854 0.858 0.862 0.866 0.87 0.87 0.874 0.878 0.882 0.886 0.89 0.89 0.894 0.898 0.901 0.905 0.909 0.909 0.913 0.917 0.921 0.925 0.925 0.929 0.933 0.937 0.941 0.941 0.945 0.949 0.952 0.956 0.96 0.96 0.964 0.968 0.972 0.976 0.976 0.98 0.984 0.988 0.992 0.992 0.996 1"/><fefuncb type="discrete" tableValues="0 0.011 0.019 0.027 0.035 0.043 0.05 0.054 0.062 0.07 0.074 0.082 0.086 0.094 0.098 0.101 0.109 0.113 0.121 0.125 0.129 0.137 0.141 0.145 0.152 0.156 0.16 0.164 0.172 0.176 0.18 0.184 0.188 0.196 0.2 0.203 0.207 0.211 0.219 0.223 0.227 0.231 0.235 0.239 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.792 0.796 0.8 0.803 0.807 0.811 0.811 0.815 0.819 0.823 0.827 0.831 0.831 0.835 0.839 0.843 0.847 0.85 0.85 0.854 0.858 0.862 0.866 0.87 0.87 0.874 0.878 0.882 0.886 0.89 0.89 0.894 0.898 0.901 0.905 0.909 0.909 0.913 0.917 0.921 0.925 0.925 0.929 0.933 0.937 0.941 0.941 0.945 0.949 0.952 0.956 0.96 0.96 0.964 0.968 0.972 0.976 0.976 0.98 0.984 0.988 0.992 0.992 0.996 1"/></fecomponenttransfer></filter><filter id="Vibrant"><fecomponenttransfer><fefuncr type="discrete" tableValues="0 0.003 0.007 0.011 0.015 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1"/><fefuncg type="discrete" tableValues="0 0.003 0.007 0.011 0.015 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1"/><fefuncb type="discrete" tableValues="0 0.003 0.007 0.011 0.015 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1"/></fecomponenttransfer><fecomponenttransfer><fefuncr type="discrete" tableValues="0 0 0 0.003 0.003 0.003 0.003 0.007 0.007 0.011 0.011 0.011 0.015 0.015 0.019 0.019 0.023 0.023 0.027 0.027 0.031 0.031 0.035 0.035 0.039 0.043 0.043 0.047 0.047 0.05 0.054 0.054 0.058 0.058 0.062 0.066 0.066 0.07 0.074 0.074 0.078 0.082 0.086 0.086 0.09 0.094 0.094 0.098 0.101 0.105 0.105 0.109 0.113 0.117 0.117 0.121 0.125 0.129 0.133 0.133 0.137 0.141 0.145 0.149 0.149 0.152 0.156 0.16 0.164 0.168 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.556 0.56 0.564 0.568 0.572 0.58 0.584 0.588 0.592 0.596 0.6 0.607 0.611 0.615 0.619 0.623 0.631 0.635 0.639 0.643 0.65 0.654 0.658 0.662 0.666 0.674 0.678 0.682 0.686 0.694 0.698 0.701 0.705 0.713 0.717 0.721 0.725 0.733 0.737 0.741 0.745 0.752 0.756 0.76 0.764 0.772 0.776 0.78 0.788 0.792 0.796 0.8 0.807 0.811 0.815 0.823 0.827 0.831 0.839 0.843 0.847 0.85 0.858 0.862 0.866 0.874 0.878 0.882 0.89 0.894 0.898 0.905 0.909 0.913 0.921 0.925 0.929 0.937 0.941 0.945 0.952 0.956 0.96 0.968 0.972 0.98 0.984 0.988 0.996 1"/><fefuncg type="discrete" tableValues="0 0 0 0 0.003 0.003 0.003 0.003 0.007 0.007 0.007 0.011 0.011 0.015 0.015 0.015 0.019 0.019 0.023 0.023 0.027 0.027 0.031 0.031 0.035 0.035 0.039 0.039 0.043 0.043 0.047 0.05 0.05 0.054 0.054 0.058 0.062 0.062 0.066 0.066 0.07 0.074 0.074 0.078 0.082 0.082 0.086 0.09 0.09 0.094 0.098 0.101 0.101 0.105 0.109 0.113 0.113 0.117 0.121 0.125 0.125 0.129 0.133 0.137 0.137 0.141 0.145 0.149 0.152 0.152 0.156 0.16 0.164 0.168 0.172 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.474 0.478 0.482 0.486 0.49 0.494 0.501 0.505 0.509 0.513 0.517 0.521 0.529 0.533 0.537 0.541 0.545 0.549 0.556 0.56 0.564 0.568 0.572 0.58 0.584 0.588 0.592 0.6 0.603 0.607 0.611 0.619 0.623 0.627 0.631 0.635 0.643 0.647 0.65 0.654 0.662 0.666 0.67 0.678 0.682 0.686 0.69 0.698 0.701 0.705 0.713 0.717 0.721 0.725 0.733 0.737 0.741 0.749 0.752 0.756 0.764 0.768 0.772 0.78 0.784 0.788 0.796 0.8 0.803 0.811 0.815 0.819 0.827 0.831 0.835 0.843 0.847 0.85 0.858 0.862 0.866 0.874 0.878 0.886 0.89 0.894 0.901 0.905 0.909 0.917 0.921 0.929 0.933 0.937 0.945 0.949 0.956 0.96 0.964 0.972 0.976 0.984 0.988 0.996 1"/><fefuncb type="discrete" tableValues="0 0 0 0.003 0.003 0.003 0.003 0.007 0.007 0.011 0.011 0.011 0.015 0.015 0.019 0.019 0.023 0.023 0.027 0.027 0.031 0.031 0.035 0.035 0.039 0.043 0.043 0.047 0.047 0.05 0.054 0.054 0.058 0.058 0.062 0.066 0.066 0.07 0.074 0.074 0.078 0.082 0.086 0.086 0.09 0.094 0.094 0.098 0.101 0.105 0.105 0.109 0.113 0.117 0.117 0.121 0.125 0.129 0.133 0.133 0.137 0.141 0.145 0.149 0.149 0.152 0.156 0.16 0.164 0.168 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.556 0.56 0.564 0.568 0.572 0.58 0.584 0.588 0.592 0.596 0.6 0.607 0.611 0.615 0.619 0.623 0.631 0.635 0.639 0.643 0.65 0.654 0.658 0.662 0.666 0.674 0.678 0.682 0.686 0.694 0.698 0.701 0.705 0.713 0.717 0.721 0.725 0.733 0.737 0.741 0.745 0.752 0.756 0.76 0.764 0.772 0.776 0.78 0.788 0.792 0.796 0.8 0.807 0.811 0.815 0.823 0.827 0.831 0.839 0.843 0.847 0.85 0.858 0.862 0.866 0.874 0.878 0.882 0.89 0.894 0.898 0.905 0.909 0.913 0.921 0.925 0.929 0.937 0.941 0.945 0.952 0.956 0.96 0.968 0.972 0.98 0.984 0.988 0.996 1"/></fecomponenttransfer><fecomponenttransfer><fefuncr type="discrete" tableValues="0 0 0 0 0 0 0.003 0.007 0.011 0.015 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1 1 1 1 1 1"/><fefuncg type="discrete" tableValues="0 0 0 0 0 0 0.003 0.007 0.011 0.015 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1 1 1 1 1 1"/><fefuncb type="discrete" tableValues="0 0 0 0 0 0 0.003 0.007 0.011 0.015 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1 1 1 1 1 1"/></fecomponenttransfer><fecomponenttransfer><fefuncr type="discrete" tableValues="0.019 0.035 0.047 0.054 0.066 0.074 0.082 0.09 0.098 0.105 0.109 0.117 0.125 0.129 0.137 0.145 0.149 0.156 0.16 0.168 0.172 0.18 0.184 0.192 0.196 0.2 0.207 0.211 0.219 0.223 0.227 0.235 0.239 0.243 0.25 0.254 0.258 0.262 0.27 0.274 0.278 0.286 0.29 0.294 0.298 0.305 0.309 0.313 0.317 0.321 0.329 0.333 0.337 0.341 0.345 0.349 0.356 0.36 0.364 0.368 0.372 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.533 0.537 0.541 0.541 0.545 0.549 0.552 0.556 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.588 0.592 0.596 0.6 0.603 0.611 0.615 0.619 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.76 0.764 0.768 0.772 0.776 0.78 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.803 0.807 0.811 0.815 0.819 0.823 0.823 0.827 0.831 0.835 0.839 0.839 0.843 0.847 0.85 0.85 0.854 0.858 0.862 0.866 0.866 0.87 0.874 0.878 0.878 0.882 0.886 0.89 0.89 0.894 0.898 0.898 0.901 0.905 0.909 0.909 0.913 0.917 0.917 0.921 0.925 0.925 0.929 0.933 0.933 0.937 0.941 0.941 0.945 0.945 0.949 0.952 0.952 0.956 0.956 0.96 0.964 0.964 0.968 0.968 0.972 0.972 0.976 0.976 0.98 0.98 0.984 0.984 0.984 0.988 0.988 0.992 0.992 0.992 0.996 0.996 0.996 0.996 1 1 1 1 1 1"/><fefuncg type="discrete" tableValues="0.019 0.035 0.047 0.054 0.066 0.074 0.082 0.09 0.098 0.105 0.109 0.117 0.125 0.129 0.137 0.145 0.149 0.156 0.16 0.168 0.172 0.18 0.184 0.192 0.196 0.2 0.207 0.211 0.219 0.223 0.227 0.235 0.239 0.243 0.25 0.254 0.258 0.262 0.27 0.274 0.278 0.286 0.29 0.294 0.298 0.305 0.309 0.313 0.317 0.321 0.329 0.333 0.337 0.341 0.345 0.349 0.356 0.36 0.364 0.368 0.372 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.533 0.537 0.541 0.541 0.545 0.549 0.552 0.556 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.588 0.592 0.596 0.6 0.603 0.611 0.615 0.619 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.76 0.764 0.768 0.772 0.776 0.78 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.803 0.807 0.811 0.815 0.819 0.823 0.823 0.827 0.831 0.835 0.839 0.839 0.843 0.847 0.85 0.85 0.854 0.858 0.862 0.866 0.866 0.87 0.874 0.878 0.878 0.882 0.886 0.89 0.89 0.894 0.898 0.898 0.901 0.905 0.909 0.909 0.913 0.917 0.917 0.921 0.925 0.925 0.929 0.933 0.933 0.937 0.941 0.941 0.945 0.945 0.949 0.952 0.952 0.956 0.956 0.96 0.964 0.964 0.968 0.968 0.972 0.972 0.976 0.976 0.98 0.98 0.984 0.984 0.984 0.988 0.988 0.992 0.992 0.992 0.996 0.996 0.996 0.996 1 1 1 1 1 1"/><fefuncb type="discrete" tableValues="0.019 0.035 0.047 0.054 0.066 0.074 0.082 0.09 0.098 0.105 0.109 0.117 0.125 0.129 0.137 0.145 0.149 0.156 0.16 0.168 0.172 0.18 0.184 0.192 0.196 0.2 0.207 0.211 0.219 0.223 0.227 0.235 0.239 0.243 0.25 0.254 0.258 0.262 0.27 0.274 0.278 0.286 0.29 0.294 0.298 0.305 0.309 0.313 0.317 0.321 0.329 0.333 0.337 0.341 0.345 0.349 0.356 0.36 0.364 0.368 0.372 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.533 0.537 0.541 0.541 0.545 0.549 0.552 0.556 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.588 0.592 0.596 0.6 0.603 0.611 0.615 0.619 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.76 0.764 0.768 0.772 0.776 0.78 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.803 0.807 0.811 0.815 0.819 0.823 0.823 0.827 0.831 0.835 0.839 0.839 0.843 0.847 0.85 0.85 0.854 0.858 0.862 0.866 0.866 0.87 0.874 0.878 0.878 0.882 0.886 0.89 0.89 0.894 0.898 0.898 0.901 0.905 0.909 0.909 0.913 0.917 0.917 0.921 0.925 0.925 0.929 0.933 0.933 0.937 0.941 0.941 0.945 0.945 0.949 0.952 0.952 0.956 0.956 0.96 0.964 0.964 0.968 0.968 0.972 0.972 0.976 0.976 0.98 0.98 0.984 0.984 0.984 0.988 0.988 0.992 0.992 0.992 0.996 0.996 0.996 0.996 1 1 1 1 1 1"/></fecomponenttransfer><fecomponenttransfer><fefuncr type="discrete" tableValues="0 0.003 0.007 0.011 0.015 0.019 0.023 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921"/><fefuncg type="discrete" tableValues="0 0.003 0.007 0.011 0.015 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.988 0.992 0.996 1 1 1"/><fefuncb type="discrete" tableValues="0 0.003 0.007 0.011 0.015 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.984 0.988 0.992 0.996 1 1"/></fecomponenttransfer></filter><filter id="Vintage"><fecomponenttransfer><fefuncr type="discrete" tableValues="0 0.003 0.007 0.011 0.015 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1"/><fefuncg type="discrete" tableValues="0 0.003 0.007 0.011 0.015 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1"/><fefuncb type="discrete" tableValues="0 0.003 0.007 0.011 0.015 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1"/></fecomponenttransfer><fecomponenttransfer><fefuncr type="discrete" tableValues="0 0.003 0.007 0.011 0.015 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1"/><fefuncg type="discrete" tableValues="0 0.003 0.007 0.011 0.015 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1"/><fefuncb type="discrete" tableValues="0 0.003 0.007 0.011 0.015 0.019 0.023 0.027 0.031 0.035 0.039 0.043 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.117 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.149 0.152 0.156 0.16 0.164 0.168 0.172 0.176 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.341 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.396 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.435 0.439 0.443 0.447 0.45 0.454 0.458 0.462 0.466 0.47 0.474 0.478 0.482 0.486 0.49 0.494 0.498 0.501 0.505 0.509 0.513 0.517 0.521 0.525 0.529 0.533 0.537 0.541 0.545 0.549 0.552 0.556 0.56 0.564 0.568 0.572 0.576 0.58 0.584 0.588 0.592 0.596 0.6 0.603 0.607 0.611 0.615 0.619 0.623 0.627 0.631 0.635 0.639 0.643 0.647 0.65 0.654 0.658 0.662 0.666 0.67 0.674 0.678 0.682 0.686 0.69 0.694 0.698 0.701 0.705 0.709 0.713 0.717 0.721 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.764 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.85 0.854 0.858 0.862 0.866 0.87 0.874 0.878 0.882 0.886 0.89 0.894 0.898 0.901 0.905 0.909 0.913 0.917 0.921 0.925 0.929 0.933 0.937 0.941 0.945 0.949 0.952 0.956 0.96 0.964 0.968 0.972 0.976 0.98 0.984 0.988 0.992 0.996 1"/></fecomponenttransfer><fecomponenttransfer><fefuncr type="discrete" tableValues="0 0 0 0 0.003 0.003 0.003 0.003 0.003 0.007 0.007 0.007 0.011 0.011 0.011 0.015 0.015 0.015 0.019 0.019 0.023 0.023 0.023 0.027 0.027 0.031 0.031 0.035 0.035 0.039 0.039 0.043 0.043 0.047 0.047 0.05 0.054 0.054 0.058 0.058 0.062 0.062 0.066 0.07 0.07 0.074 0.078 0.078 0.082 0.082 0.086 0.09 0.09 0.094 0.098 0.101 0.101 0.105 0.109 0.109 0.113 0.117 0.121 0.121 0.125 0.129 0.133 0.133 0.137 0.141 0.145 0.145 0.149 0.152 0.156 0.16 0.16 0.164 0.168 0.172 0.176 0.18 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.439 0.443 0.447 0.45 0.454 0.458 0.466 0.47 0.474 0.478 0.482 0.486 0.494 0.498 0.501 0.505 0.509 0.517 0.521 0.525 0.529 0.533 0.541 0.545 0.549 0.552 0.556 0.564 0.568 0.572 0.576 0.584 0.588 0.592 0.596 0.603 0.607 0.611 0.619 0.623 0.627 0.631 0.639 0.643 0.647 0.654 0.658 0.662 0.67 0.674 0.678 0.682 0.69 0.694 0.698 0.705 0.709 0.713 0.721 0.725 0.733 0.737 0.741 0.749 0.752 0.756 0.764 0.768 0.772 0.78 0.784 0.792 0.796 0.8 0.807 0.811 0.819 0.823 0.827 0.835 0.839 0.847 0.85 0.854 0.862 0.866 0.874 0.878 0.886 0.89 0.894 0.901 0.905 0.913 0.917 0.925 0.929 0.937 0.941 0.949 0.952 0.96 0.964 0.972 0.976 0.984 0.988 0.996 1"/><fefuncg type="discrete" tableValues="0 0 0 0 0.003 0.003 0.003 0.003 0.003 0.007 0.007 0.007 0.011 0.011 0.011 0.015 0.015 0.015 0.019 0.019 0.023 0.023 0.023 0.027 0.027 0.031 0.031 0.035 0.035 0.039 0.039 0.043 0.043 0.047 0.047 0.05 0.054 0.054 0.058 0.058 0.062 0.062 0.066 0.07 0.07 0.074 0.078 0.078 0.082 0.082 0.086 0.09 0.09 0.094 0.098 0.101 0.101 0.105 0.109 0.109 0.113 0.117 0.121 0.121 0.125 0.129 0.133 0.133 0.137 0.141 0.145 0.145 0.149 0.152 0.156 0.16 0.16 0.164 0.168 0.172 0.176 0.18 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.439 0.443 0.447 0.45 0.454 0.458 0.466 0.47 0.474 0.478 0.482 0.486 0.494 0.498 0.501 0.505 0.509 0.517 0.521 0.525 0.529 0.533 0.541 0.545 0.549 0.552 0.556 0.564 0.568 0.572 0.576 0.584 0.588 0.592 0.596 0.603 0.607 0.611 0.619 0.623 0.627 0.631 0.639 0.643 0.647 0.654 0.658 0.662 0.67 0.674 0.678 0.682 0.69 0.694 0.698 0.705 0.709 0.713 0.721 0.725 0.733 0.737 0.741 0.749 0.752 0.756 0.764 0.768 0.772 0.78 0.784 0.792 0.796 0.8 0.807 0.811 0.819 0.823 0.827 0.835 0.839 0.847 0.85 0.854 0.862 0.866 0.874 0.878 0.886 0.89 0.894 0.901 0.905 0.913 0.917 0.925 0.929 0.937 0.941 0.949 0.952 0.96 0.964 0.972 0.976 0.984 0.988 0.996 1"/><fefuncb type="discrete" tableValues="0 0 0 0 0.003 0.003 0.003 0.003 0.003 0.007 0.007 0.007 0.011 0.011 0.011 0.015 0.015 0.015 0.019 0.019 0.023 0.023 0.023 0.027 0.027 0.031 0.031 0.035 0.035 0.039 0.039 0.043 0.043 0.047 0.047 0.05 0.054 0.054 0.058 0.058 0.062 0.062 0.066 0.07 0.07 0.074 0.078 0.078 0.082 0.082 0.086 0.09 0.09 0.094 0.098 0.101 0.101 0.105 0.109 0.109 0.113 0.117 0.121 0.121 0.125 0.129 0.133 0.133 0.137 0.141 0.145 0.145 0.149 0.152 0.156 0.16 0.16 0.164 0.168 0.172 0.176 0.18 0.18 0.184 0.188 0.192 0.196 0.2 0.203 0.207 0.207 0.211 0.215 0.219 0.223 0.227 0.231 0.235 0.239 0.243 0.247 0.25 0.254 0.254 0.258 0.262 0.266 0.27 0.274 0.278 0.282 0.286 0.29 0.294 0.298 0.301 0.305 0.309 0.313 0.317 0.321 0.325 0.329 0.333 0.337 0.345 0.349 0.352 0.356 0.36 0.364 0.368 0.372 0.376 0.38 0.384 0.388 0.392 0.4 0.403 0.407 0.411 0.415 0.419 0.423 0.427 0.431 0.439 0.443 0.447 0.45 0.454 0.458 0.466 0.47 0.474 0.478 0.482 0.486 0.494 0.498 0.501 0.505 0.509 0.517 0.521 0.525 0.529 0.533 0.541 0.545 0.549 0.552 0.556 0.564 0.568 0.572 0.576 0.584 0.588 0.592 0.596 0.603 0.607 0.611 0.619 0.623 0.627 0.631 0.639 0.643 0.647 0.654 0.658 0.662 0.67 0.674 0.678 0.682 0.69 0.694 0.698 0.705 0.709 0.713 0.721 0.725 0.733 0.737 0.741 0.749 0.752 0.756 0.764 0.768 0.772 0.78 0.784 0.792 0.796 0.8 0.807 0.811 0.819 0.823 0.827 0.835 0.839 0.847 0.85 0.854 0.862 0.866 0.874 0.878 0.886 0.89 0.894 0.901 0.905 0.913 0.917 0.925 0.929 0.937 0.941 0.949 0.952 0.96 0.964 0.972 0.976 0.984 0.988 0.996 1"/></fecomponenttransfer><fecolormatrix type="matrix" values="0.7572 0.3076 0.0756 0 0\n                           0.1396 0.8744 0.0672 0 0\n                           0.1088 0.2136 0.6524 0 0\n                           0 0 0 1 0"/><fecomponenttransfer><fefuncr type="discrete" tableValues="0 0.003 0.007 0.007 0.011 0.015 0.015 0.019 0.023 0.027 0.027 0.031 0.035 0.039 0.043 0.047 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.152 0.156 0.16 0.168 0.172 0.176 0.18 0.188 0.192 0.196 0.203 0.207 0.211 0.219 0.223 0.227 0.235 0.239 0.243 0.25 0.254 0.262 0.266 0.274 0.278 0.282 0.29 0.294 0.301 0.305 0.313 0.317 0.325 0.329 0.337 0.341 0.349 0.352 0.36 0.364 0.372 0.376 0.384 0.388 0.396 0.4 0.407 0.411 0.419 0.423 0.431 0.435 0.443 0.447 0.454 0.458 0.466 0.47 0.474 0.482 0.486 0.494 0.498 0.505 0.509 0.517 0.521 0.529 0.533 0.541 0.545 0.549 0.556 0.56 0.568 0.572 0.58 0.584 0.588 0.596 0.6 0.603 0.611 0.615 0.619 0.627 0.631 0.635 0.643 0.647 0.65 0.658 0.662 0.666 0.67 0.678 0.682 0.686 0.69 0.694 0.701 0.705 0.709 0.713 0.717 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.847 0.85 0.854 0.858 0.862 0.862 0.866 0.87 0.874 0.878 0.878 0.882 0.886 0.89 0.89 0.894 0.898 0.898 0.901 0.905 0.905 0.909 0.913 0.913 0.917 0.921 0.921 0.925 0.925 0.929 0.929 0.933 0.937 0.937 0.941 0.941 0.945 0.945 0.949 0.949 0.952 0.952 0.956 0.956 0.96 0.96 0.96 0.964 0.964 0.968 0.968 0.972 0.972 0.972 0.976 0.976 0.976 0.98 0.98 0.98 0.984 0.984 0.984 0.988 0.988 0.988 0.988 0.992 0.992 0.992 0.996 0.996 0.996 0.996 0.996 1 1 1"/><fefuncg type="discrete" tableValues="0 0.003 0.007 0.007 0.011 0.015 0.015 0.019 0.023 0.027 0.027 0.031 0.035 0.039 0.043 0.047 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.152 0.156 0.16 0.168 0.172 0.176 0.18 0.188 0.192 0.196 0.203 0.207 0.211 0.219 0.223 0.227 0.235 0.239 0.243 0.25 0.254 0.262 0.266 0.274 0.278 0.282 0.29 0.294 0.301 0.305 0.313 0.317 0.325 0.329 0.337 0.341 0.349 0.352 0.36 0.364 0.372 0.376 0.384 0.388 0.396 0.4 0.407 0.411 0.419 0.423 0.431 0.435 0.443 0.447 0.454 0.458 0.466 0.47 0.474 0.482 0.486 0.494 0.498 0.505 0.509 0.517 0.521 0.529 0.533 0.541 0.545 0.549 0.556 0.56 0.568 0.572 0.58 0.584 0.588 0.596 0.6 0.603 0.611 0.615 0.619 0.627 0.631 0.635 0.643 0.647 0.65 0.658 0.662 0.666 0.67 0.678 0.682 0.686 0.69 0.694 0.701 0.705 0.709 0.713 0.717 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.847 0.85 0.854 0.858 0.862 0.862 0.866 0.87 0.874 0.878 0.878 0.882 0.886 0.89 0.89 0.894 0.898 0.898 0.901 0.905 0.905 0.909 0.913 0.913 0.917 0.921 0.921 0.925 0.925 0.929 0.929 0.933 0.937 0.937 0.941 0.941 0.945 0.945 0.949 0.949 0.952 0.952 0.956 0.956 0.96 0.96 0.96 0.964 0.964 0.968 0.968 0.972 0.972 0.972 0.976 0.976 0.976 0.98 0.98 0.98 0.984 0.984 0.984 0.988 0.988 0.988 0.988 0.992 0.992 0.992 0.996 0.996 0.996 0.996 0.996 1 1 1"/><fefuncb type="discrete" tableValues="0 0.003 0.007 0.007 0.011 0.015 0.015 0.019 0.023 0.027 0.027 0.031 0.035 0.039 0.043 0.047 0.047 0.05 0.054 0.058 0.062 0.066 0.07 0.074 0.078 0.082 0.086 0.09 0.094 0.098 0.101 0.105 0.109 0.113 0.121 0.125 0.129 0.133 0.137 0.141 0.145 0.152 0.156 0.16 0.168 0.172 0.176 0.18 0.188 0.192 0.196 0.203 0.207 0.211 0.219 0.223 0.227 0.235 0.239 0.243 0.25 0.254 0.262 0.266 0.274 0.278 0.282 0.29 0.294 0.301 0.305 0.313 0.317 0.325 0.329 0.337 0.341 0.349 0.352 0.36 0.364 0.372 0.376 0.384 0.388 0.396 0.4 0.407 0.411 0.419 0.423 0.431 0.435 0.443 0.447 0.454 0.458 0.466 0.47 0.474 0.482 0.486 0.494 0.498 0.505 0.509 0.517 0.521 0.529 0.533 0.541 0.545 0.549 0.556 0.56 0.568 0.572 0.58 0.584 0.588 0.596 0.6 0.603 0.611 0.615 0.619 0.627 0.631 0.635 0.643 0.647 0.65 0.658 0.662 0.666 0.67 0.678 0.682 0.686 0.69 0.694 0.701 0.705 0.709 0.713 0.717 0.725 0.729 0.733 0.737 0.741 0.745 0.749 0.752 0.756 0.76 0.768 0.772 0.776 0.78 0.784 0.788 0.792 0.796 0.8 0.803 0.807 0.811 0.815 0.819 0.819 0.823 0.827 0.831 0.835 0.839 0.843 0.847 0.847 0.85 0.854 0.858 0.862 0.862 0.866 0.87 0.874 0.878 0.878 0.882 0.886 0.89 0.89 0.894 0.898 0.898 0.901 0.905 0.905 0.909 0.913 0.913 0.917 0.921 0.921 0.925 0.925 0.929 0.929 0.933 0.937 0.937 0.941 0.941 0.945 0.945 0.949 0.949 0.952 0.952 0.956 0.956 0.96 0.96 0.96 0.964 0.964 0.968 0.968 0.972 0.972 0.972 0.976 0.976 0.976 0.98 0.98 0.98 0.984 0.984 0.984 0.988 0.988 0.988 0.988 0.992 0.992 0.992 0.996 0.996 0.996 0.996 0.996 1 1 1"/></fecomponenttransfer></filter></svg>'),
a.put("SilverApp/views/font-settings.html",'<div class="edit-text-font-settings clearfix exclude-from-drag" ng-class="::{\'advanced-text\': $ctrl.isAdvancedText}"><div class="dropdown edit-text-fonts edit-text-control" dropdown=""><div dropdown-toggle="" class="edit-text-dropdown dropdown-toggle" data-test-key="font_dropdown"><span class="text-tool-label font-image-display"><img alt="{{family.displayName}}" ng-src="{{$ctrl.selectedFontFamily.previewURL}}"></span> <span class="spacer"></span><div class="caret-holder"><span class="caret"></span></div></div><ul class="dropdown-menu edit-text-family-list"><span ng-if="$ctrl.userSelectedFontFamilies.length>0" class="advanced-feature">{{::\'SilverApp.editText.userSelectedFonts\'|translate}}</span><li ng-repeat="family in $ctrl.userSelectedFontFamilies | orderBy:\'displayName\':false" class="family-list edit-text-list-item advanced-feature" ng-class="{\'selected\':$ctrl.selectedFontFamily.fontFamilyId == family.fontFamilyId}" title="{{family.displayName}}" ng-click="$ctrl.selectFontFamily(family)"><img alt="{{family.displayName}}" ng-src="{{family.previewURL}}"><div class="font-img-hover"></div></li><div ng-if="$ctrl.userSelectedFontFamilies.length>0" class="divider advanced-feature"></div><span class="advanced-feature">{{::\'SilverApp.editText.styleFonts\'|translate}}</span><li ng-repeat="family in $ctrl.fontFamilies | orderBy:\'displayName\':false" class="family-list edit-text-list-item" ng-class="{\'selected\':$ctrl.selectedFontFamily.fontFamilyId == family.fontFamilyId}" title="{{family.displayName}}" ng-click="$ctrl.selectFontFamily(family)"><img alt="{{family.displayName}}" ng-src="{{family.previewURL}}"><div class="font-img-hover"></div></li><div class="divider advanced-feature"></div><span class="advanced-feature">{{::\'SilverApp.editText.allFonts\'|translate}}</span><li ng-repeat="family in $ctrl.allFontFamilies | orderBy:\'displayName\':false" class="family-list edit-text-list-item advanced-feature" ng-class="{\'selected\':$ctrl.selectedFontFamily.fontFamilyId == family.fontFamilyId}" title="{{family.displayName}}" ng-click="$ctrl.selectFontFamily(family)"><img alt="{{family.displayName}}" ng-src="{{family.previewURL}}"><div class="font-img-hover"></div></li></ul></div><div class="dropdown edit-text-styles edit-text-control" is-open="$ctrl.isStyleDropdownOpen" dropdown=""><div class="edit-text-dropdown dropdown-toggle" data-test-key="font_style_dropdown" dropdown-toggle=""><span class="text-tool-label">{{$ctrl.selectedFont.styleName}}</span> <span class="spacer"></span><div class="caret-holder"><span class="caret"></span></div></div><ul class="dropdown-menu edit-text-font-list"><li ng-repeat="font in $ctrl.selectedFontFamily.fonts" class="edit-text-list-item" ng-class="{\'selected\':$ctrl.selectedFont.fontId == font.fontId}" title="{{font.styleName}}" ng-click="$ctrl.selectFont(font)">{{font.styleName}}</li></ul></div><div class="dropdown edit-text-control edit-text-sizes" is-open="$ctrl.isSizeDropdownOpen" dropdown=""><div class="edit-text-dropdown dropdown-toggle" data-test-key="font_size_dropdown" dropdown-toggle=""><span class="text-tool-label">{{$ctrl.selectedFontSize}}</span></div><ul class="dropdown-menu"><li ng-repeat="size in $ctrl.fontSizes" class="edit-text-list-item" ng-class="{\'selected\':$ctrl.selectedFontSize == size}" ng-click="$ctrl.selectFontSize(size)">{{size}}</li></ul></div><div class="edit-text-control edit-text-steppers"><a data-test-key="font_size_minus" ng-click="$ctrl.decrementFontSize()" sf-dropdown-close="" class="tool-icon clickable"><i class="icon icon-font-size-minus"></i></a> <a data-test-key="font_size_plus" ng-click="$ctrl.incrementFontSize()" sf-dropdown-close="" class="tool-icon clickable"><i class="icon icon-font-size-plus"></i></a></div><div class="dropdown edit-text-colors edit-text-control" is-open="$ctrl.isColorDropdownOpen" dropdown=""><div class="edit-text-dropdown dropdown-toggle" data-test-key="font_color_dropdown" dropdown-toggle=""><div class="color-swatch" ng-style="{\'background-color\':$ctrl.selectedColor.color}"></div><span class="text-tool-label">{{$ctrl.selectedColor.name}}</span> <span class="spacer"></span><div class="caret-holder"><span class="caret"></span></div></div><ul class="dropdown-menu edit-text-color-grid"><div class="advanced-feature color-section-label" ng-if="$ctrl.userSelectedColors.length > 0">{{::\'SilverApp.editText.userSelectedColors\'|translate}}</div><li ng-repeat="color in $ctrl.userSelectedColors" class="color-swatch advanced-feature" ng-class="{\'selected\':$ctrl.selectedColor.color == color.color}" title="{{color.name}}" ng-style="{\'background-color\':color.color}" ng-click="$ctrl.selectColor(color)"></li><div ng-if="$ctrl.userSelectedColors.length > 0" class="divider advanced-feature"></div><div class="advanced-feature color-section-label">{{::\'SilverApp.editText.styleColors\'|translate}}</div><li ng-repeat="color in $ctrl.colors" class="color-swatch" ng-class="{\'selected\':$ctrl.selectedColor.color == color.color}" title="{{color.name}}" ng-style="{\'background-color\':color.color}" ng-click="$ctrl.selectColor(color)"></li><div class="divider advanced-feature"></div><div class="advanced-feature color-section-label">{{::\'SilverApp.editText.allColors\'|translate}}</div><li ng-repeat="color in $ctrl.allColors" class="color-swatch advanced-feature" ng-class="{\'selected\':$ctrl.selectedColor.color == color.color}" title="{{color.name}}" ng-style="{\'background-color\':color.color}" ng-click="$ctrl.selectColor(color)"></li></ul></div><div class="edit-text-alignment clearfix"><text-horizontal-alignment on-apply="$ctrl.updateHorizontalAlignment(data)" text-styles="$ctrl.textStyles"></text-horizontal-alignment><text-vertical-alignment on-apply="$ctrl.updateVerticalAlignment(data)" text-styles="$ctrl.textStyles"></text-vertical-alignment><text-spacing on-apply="$ctrl.updateSpacing(data)" text-spacing="$ctrl.textStyles.textSpacing"></text-spacing></div></div>'),a.put("SilverApp/views/gc/add-page-toolbar-item.html",""),a.put("SilverApp/views/gc/add-pages-menu-items.html",""),a.put("SilverApp/views/gc/add-photos-modal.html",'<div ng-class="{\'modal-width-medium-small-2\': !ctrls.MainCtrl.superSimple, \'modal-width-small-for-simple\': ctrls.MainCtrl.superSimple, \'modal-content\': true}"><div class="modal-header"><p class="modal-header-title">{{::\'SilverApp.createYourStory\'|translate}}</p><i type="button" class="icon-dialog-close icon-dialog-close-add-photos" data-dismiss="modal" data-test-key="button_addphotos_modal_xclose" ng-click="ctrls.SimpleModalCtrl.cancel()"></i></div><div class="modal-body"><p class="modal-text">{{::\'SilverApp.createYourStoryCal\'|translate}}</p></div><div><i class="icon-add-photos-cal"></i></div><div class="modal-footer"><a class="btn btn-link" ng-click="ctrls.SimpleModalCtrl.cancel()" data-test-key="button_addphoto_modal_cancel" translate="">SilverApp.skip</a> <button type="button" class="btn btn-default btn-primary" ng-click="ctrls.SimpleModalCtrl.ok()" omniture="" linkname="Add photos" data-test-key="button_addphotos_modal_ok">{{::\'SilverApp.addPhotos\'|translate}}</button></div></div>'),a.put("SilverApp/views/gc/calendar-nav-control.html",'<div class="calendar-controls-container"><div class="calendar-controls" ng-class="{\'new-nav\': ctrls.NavCtrl.showNewNavigation && !ctrls.MainCtrl.appState.inPreviewMode, \'advanced-edit-background\': ctrls.NavCtrl.appState.isCustomizing(), \'calendar-controls-csp\': ctrls.PaletteCtrl.calendarPaletteMode, \'calendar-controls-white\': !ctrls.NavCtrl.appState.isCustomizing()}"><div class="page-label page-label--top" ng-show="ctrls.NavCtrl.zoomFactor == 1" ng-style="{\'margin-left\': controlWidth(\'top\', ctrls.MainCtrl.appState.inPreviewMode)}" data-test-key="top_label" ng-class="{\'page-label-selected\': ctrls.NavCtrl.topLeftPageSelected}" ng-click="ctrls.NavCtrl.selectLeftPage()"><div class="calendar-top-text"><div>{{::\'Calendar.navigation.top\'|translate}}</div></div></div><div ng-hide="!ctrls.MainCtrl.config.playButton || ctrls.NavCtrl.zoomFactor > 1" class="play-btn-container--calender"><i class="icon-play icon-prev-next-page" ng-style="{\'margin-left\': controlWidth(\'play/pause\', ctrls.MainCtrl.appState.inPreviewMode)}" ng-hide="ctrls.NavCtrl.playing" data-test-key="button_nav_play" ng-click="ctrls.NavCtrl.play()"></i> <i class="icon-pause icon-prev-next-page" ng-style="{\'margin-left\': controlWidth(\'play/pause\', ctrls.MainCtrl.appState.inPreviewMode)}" ng-hide="!ctrls.NavCtrl.playing" data-test-key="button_nav_pause" ng-click="ctrls.NavCtrl.cancelPlay()"></i></div><div class="page-label page-label--bottom" ng-show="ctrls.NavCtrl.zoomFactor == 1" ng-style="{\'visibility\': ctrls.NavCtrl.activeRightPage.isFiller() ? \'hidden\' : \'visible\',\n                        \'margin-left\': controlWidth(\'bottom\', ctrls.MainCtrl.appState.inPreviewMode)}" data-test-key="bottom_label" ng-class="{\'page-label-selected\': ctrls.NavCtrl.bottomRightPageSelected, \'page-label--bottom-with-play\': ctrls.MainCtrl.config.playButton}" ng-click="ctrls.NavCtrl.selectRightPage()"><div class="calendar-bottom-text">{{::\'Calendar.navigation.bottom\'|translate}}</div></div><div class="calendar-control-buttons" ng-class="{\'calendar-control-buttons-csp\' : ctrls.PaletteCtrl.calendarPaletteMode}"><div class="calendar-control-date clickable inline-block" ng-repeat="page in ctrls.PagesCtrl.productSpecificPages track by page.uid" ng-class="{\'calendar-control-date-slideshow\': ctrls.MainCtrl.slideshow, \'sf-page-selected-cal-nav\': ctrls.NavCtrl.activeLeftPage == page, \'calandar-control-date-cover\': page.surfaceNumber == 1}"><span ng-if="page.surfaceNumber != 24" class="divider-vertical-gray divider-vertical-gray-no-margin"></span><div ng-click="ctrls.PagesCtrl.selectPage(page, true)" data-test-key="palette_page_{{page.surfaceNumber}}"><div class="clickable" translate="">{{page.surfaceKey | calendarizeMonth}}</div></div></div></div><div class="calendar-border"></div></div></div>'),a.put("SilverApp/views/gc/change-size.html",'<div class="modal-width-small modal-content"><div class="modal-header"><span class="modal-header-title" translate="">SilverApp.changeSizeTitle</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_changesize_modal_xclose" ng-click="ctrls.ChangeSizeCtrl.cancel()"></i></div><div class="modal-body"><div class="size-options-group-calendars"><div class="inline-block size-option" ng-repeat="option in ctrls.ChangeSizeCtrl.sizeOptions" ng-click="ctrls.ChangeSizeCtrl.select(option.size)" data-test-key="size_option_{{option.size}}"><div class="{{(option.size == ctrls.ChangeSizeCtrl.selectedSize) ? option.selectedAsset : option.asset}}"></div><div><span class="size-option-price">{{::\'SilverApp.from\'|translate}}</span> <span class="{{ctrls.ChangeSizeCtrl.origPriceStyling(option)}}">{{option.origPrice | currency}}</span> <span class="{{ctrls.ChangeSizeCtrl.salePriceStyling(option)}}">{{option.salePrice | currency}}</span></div><div class="{{ctrls.ChangeSizeCtrl.salePriceStyling(option)}}">{{ctrls.ChangeSizeCtrl.savings(option) | postfixTranslate:\'SilverApp.savings\'}}</div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.ChangeSizeCtrl.changeSize()" data-test-key="button_changesize_modal_ok">{{::\'SilverApp.changeSize\'|translate}}</button></div></div>'),a.put("SilverApp/views/gc/change-start-date.html",'<div ng-class="{\'modal-width-small modal-content\': !(ctrls.ChangeStartDateCtrl.isStartDatePast()), \'modal-width-medium modal-content\': (ctrls.ChangeStartDateCtrl.isStartDatePast())}"><div class="modal-header"><span class="modal-header-title" ng-show="!ctrls.ChangeStartDateCtrl.isStartDatePast()" translate="">SilverApp.changeStartDateTitle</span> <span class="modal-header-title" ng-show="ctrls.ChangeStartDateCtrl.isStartDatePast()" translate="">SilverApp.changeStartDateTitle2</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_changestartdate_modal_xclose" ng-click="ctrls.ChangeStartDateCtrl.cancel()"></i></div><div class="modal-body"><span class="change-date-text" ng-show="ctrls.ChangeStartDateCtrl.isStartDatePast()" translate="">SilverApp.changeStartDateContent</span><div class="datepicker-container" style="padding-top: 10px"><div class="btn-grp-csd" dropdown=""><div dropdown-toggle="" class="dropdown-toggle clickable" data-test-key="month_dropdown"><span>{{ctrls.ChangeStartDateCtrl.isMonthPropertyNull() ? ctrls.ChangeStartDateCtrl.months[0] : ctrls.ChangeStartDateCtrl.monthProperty}}</span> <span class="caret"></span></div><ul class="dropdown-menu"><li ng-repeat="item in ctrls.ChangeStartDateCtrl.months"><a class="clickable" ng-click="ctrls.ChangeStartDateCtrl.setDateProperty(\'month\', item)" data-test-key="{{::\'menu_item_month_\'+item}}">{{::item}}</a></li></ul></div><div class="btn-grp-csd" dropdown=""><div dropdown-toggle="" class="dropdown-toggle clickable" data-test-key="year_dropdown"><span>{{ctrls.ChangeStartDateCtrl.isYearPropertyNull() ? ctrls.ChangeStartDateCtrl.defaultYear : ctrls.ChangeStartDateCtrl.yearProperty}}</span> <span class="caret"></span></div><ul class="dropdown-menu"><li ng-repeat="item in ctrls.ChangeStartDateCtrl.getAllYears()" value="{{item.value}}"><a class="clickable" ng-click="ctrls.ChangeStartDateCtrl.setDateProperty(\'year\', item)" data-test-key="{{::\'menu_item_year_\'+item}}">{{::item}}</a></li></ul></div></div></div><div class="modal-footer"><button ng-show="ctrls.ChangeStartDateCtrl.isStartDatePast()" class="btn btn-link" ng-click="ctrls.ChangeStartDateCtrl.cancel()" data-test-key="button_changestartdate_modal_cancel">{{::\'SilverApp.dontChange\'|translate}}</button> <button type="button" class="btn btn-default btn-primary" ng-click="ctrls.ChangeStartDateCtrl.changeStartDate()" data-test-key="button_changestartdate_modal_ok">{{::\'SilverApp.changeStartDate\'|translate}}</button></div></div>'),a.put("SilverApp/views/gc/dialog-events-editor.html",'<div><div class="event-dialog-edit-event-content event-dialog-edit-event-detail" ng-if="$ctrl.editor.isCreatingNewEvent"><div class="empty-events-state"><div><sf-inline-event-drawer editor="$ctrl.editor" event="$ctrl.editor.newEventModel" show-events-max-warning="true" on-new-property="$ctrl.editor.setNewEventProperty(name, value)" on-request-save="$ctrl.saveNewEvent()" on-request-cancel="$ctrl.cancelCreatingNewEvent()"></sf-inline-event-drawer></div></div></div><div class="event-dialog-edit-event-content event-dialog-edit-event-list" ng-if="$ctrl.eventsForDay.length > 0 && $ctrl.eventToDelete == undefined"><button role="button" class="btn btn-secondary events-new-event-button" ng-if="!$ctrl.editor.isCreatingNewEvent && $ctrl.eventsForDay.length > 0 && $ctrl.eventToDelete == undefined" data-test-key="button_add_event_header" ng-click="$ctrl.startCreatingNewEvent()">{{::\'Calendars.eventstab.addNewEvent\'|translate}}</button><div class="event-dialog-events-table" ng-class="{\'events-dialog-short-table\': $ctrl.editor.isCreatingNewEvent}"><div class="event-dialog-events-header"><div class="event-dialog-events-show">Show</div><div class="event-dialog-events-name">Event Name</div><div class="event-dialog-events-photo">Photo</div><div class="event-dialog-events-use">Use</div><div class="event-dialog-events-edit">Edit</div><div class="event-dialog-events-delete">Delete</div></div><div class="event-dialog-events-body"><div class="event-dialog-events-item event-list-row event-list-row-view-mode" ng-class="{\'selected\': event.isSelected, \'public\': event.visibility == \'public\', \'editing-inline\': event.isBeingEdited}" ng-repeat="event in $ctrl.editor.events | filter:{\'month\': $ctrl.date.month, \'day\': $ctrl.date.day}:true | orderBy:[\'dateMillis\',\'id\']"><sf-inline-event-drawer ng-if="event.isBeingEdited" editor="$ctrl.editor" event="$ctrl.editor.editEventModel" show-events-max-warning="false" on-new-property="$ctrl.editor.setEditEventProperty(name, value)" on-request-save="$ctrl.editor.finishEditingEvent()" on-request-cancel="$ctrl.editor.cancelEditingEvent()"></sf-inline-event-drawer><div class="event-dialog-events-show read-row"><div class="add-to-project event-list-item clickable" ng-click="$ctrl.editor.selectEvent(event)"><div class="event-checkbox" data-test-key="{{::\'event_add_to_project_\' + event.id}}"></div></div></div><div class="event-dialog-events-name read-row" ng-click="$ctrl.editor.startEditingEvent($event, event)" ng-class="{clickable:event.type != \'holiday\'}">{{event.name}}</div><div class="event-dialog-events-photo event-photo read-row" ng-click="$ctrl.editor.startEditingEvent($event, event)" ng-class="{\'selected-date-photo\': $ctrl.editor.getImageAssociation(event.id).active == true, clickable:event.type != \'holiday\'}" sf-droppable="" drop-options="{eventId: event.id}" location="event" indicate-droppable="true"><sf-event-photo-well event="event" in-advanced-edit-tab="true" editor="$ctrl.editor" hover-delay="$ctrl.hoverDelay"></sf-event-photo-well></div><div class="event-dialog-events-use event-photo-radio read-row"><sf-event-photo-radio event="event" active="$ctrl.editor.getImageAssociation(event.id).active" editor="$ctrl.editor" active-label="\'Shown photo\'" inactive-label="\'\'"></sf-event-photo-radio></div><div class="event-dialog-events-edit read-row"><div class="clickable action action-edit" ng-click="$ctrl.editor.startEditingEvent($event, event)" data-test-key="{{::\'event_edit_\' + event.id}}"></div></div><div class="event-dialog-events-delete read-row"><div class="clickable action action-delete" ng-click="$ctrl.requestEventDeletion($event, event)" data-test-key="{{::\'event_delete_\' + event.id}}"></div></div></div></div></div></div><div class="events-editor-cell-preview"></div><grid-cell-preview grid-cell-assets="$ctrl.gridCellAssets"></grid-cell-preview><div class="event-dialog-delete-event-message" ng-if="$ctrl.eventToDelete != undefined"><div><i class="icon icon-warning"></i><div class="delete-event-title">{{\'Calendars.eventstab.deleteEvent\' | translate}}: {{$ctrl.eventToDelete.name}}</div></div><div class="delete-event-body">{{\'Calendars.eventstab.deleteModalLine1\' | translate}} {{\'Calendars.eventstab.deleteModalLine2\' | translate}}</div><div class="delete-event-controls"><button class="btn btn-link" ng-click="$ctrl.eventToDelete = undefined" data-test-key="button_cancel_delete_event">{{::\'Palette.Cancel\'|translate}}</button> <button class="btn btn-primary" data-test-key="button_delete_event" ng-click="$ctrl.deleteEvent();">{{::\'SilverApp.delete\'|translate}}</button></div></div></div>'),a.put("SilverApp/views/gc/dupe-page-menu-item.html",""),a.put("SilverApp/views/gc/event-dialog-grid-cell-preview.html",'<div class="event-dialog-grid-cell-preview-area"><div class="event-dialog-grid-cell-preview"><div class="asset-container {{:: \'feature-afsMode-\' + $ctrl.config.afsMode}}" ng-repeat="asset in $ctrl.gridCellAssets track by asset.asset.generatedAssetId" ng-class="{\'asset-container--text\': asset.asset.assetType == \'text\'}"><div ng-style="$ctrl.styleForAsset(asset.asset)" ng-switch="" on="asset.asset.assetType" ng-class="$ctrl.classForAsset(asset)" ng-show="asset.asset.assetType!=\'text\' || !page.hideTextBoxes" ng-if="(!asset.isEventTextAsset || asset.hasContent())"><span ng-switch-when="image"><div class="asset-swap-indicator">{{:: \'SilverApp.tablet.swap\' | translate }}</div><div class="image-asset-container"><div ng-style="$ctrl.styleForImageWrapper(asset)" data-test-key="{{::\'gridCell_photo_area_\' + asset.uniqueProjectRef}}"><img ng-class="{\'has-assigned-image\': asset.hasAssignedImage()}" ng-style="$ctrl.styleForImage(asset)" data-objectStyle="{{asset.asset.objectStyle}}" data-test-key="page_photo_{{asset.projectImageId}}" sf-priority-src="$ctrl.imageAssetURL(asset)" sf-priority="priority" sf-priority-onload="src" sf-priority-watch="true" use-thumbnail="\'false\'" sf-priority-lifecycle-callbacks="usePriorityLoadingLifecycleCallbacks"/></div></div></span> <span ng-switch-when="graphic"><div sf-priority-src="$ctrl.backgroundSourceURL(asset)" sf-priority="priority" sf-priority-onload="background" sf-priority-watch="true" use-thumbnail="useThumbnails" data-hoverable="true" data-assetType="graphic" data-assetIndex="{{$index}}" data-test-key="gridCell_{{::asset.asset.type}}_{{$index}}_{{asset.asset.assetId}}" class="page-graphic-asset {{::$ctrl.classForGraphicAsset(asset)}}" sf-hollow-embellishment="asset.isHollow && bookSpread" asset="asset" scale="assetScale"></div></span> <span ng-switch-when="text"><img class="hundies" sf-priority-src="$ctrl.textAssetImageURL(asset)" sf-priority="priority" use-thumbnail="\'false\'" sf-priority-watch="true" data-assetType="{{::asset.isEventTextAsset ? \'text-event\' : \'text-image\'}}" data-assetIndex="{{$index}}" data-test-key="{{::\'gridCell_text_\' + $index}}"/></span></div></div></div></div>'),a.put("SilverApp/views/gc/event-dialog-text-style-editor.html",'<div class="event-dialog-text-style-editor"><div class="event-dialog-text-style-editor-title">{{$ctrl.title | translate}}</div><font-settings asset="$ctrl.asset" is-advanced-text="$ctrl.isAdvancedText" on-text-style-changed="$ctrl.onTextStyleChanged(data)"></font-settings><label ng-if="$ctrl.styleSupportsEventTextBackground && !$ctrl.asset.isDateTextAsset" class="event-dialog-text-event-bg"><input type="checkbox" ng-change="$ctrl.toggleEventTextBackground()" ng-model="$ctrl.useEventTextBackground"><span translate="">Calendars.eventsdialog.eventTextBackground</span></label></div>'),a.put("SilverApp/views/gc/event-dialog-text-style-preview.html",'<div class="event-dialog-text-style-preview"><grid-cell-preview grid-cell-assets="$ctrl.gridCellAssets"></grid-cell-preview><ul class="list-inline"><li ng-repeat="(tab, key) in ::$ctrl.tabs" ng-class="{active: tab === $ctrl.activeTab}"><a ng-click="$ctrl.toggleTab(tab)" data-test-key="{{:: \'label_toggle">{{:: key | translate}}</a></li></ul></div>'),a.put("SilverApp/views/gc/event-dialog-text-style.html",'<div class="event-dialog-text-style-container clearfix"><text-style-editor asset="$ctrl.activeAsset" is-advanced-text="$ctrl.isAdvancedText" on-tab-changed="$ctrl.setTabChangedCallback(tabChangedCallback)" on-cell-assets-preview-update="$ctrl.refreshCellAssetsPreview(gridCellAssets)" page="$ctrl.page" grid-cell-assets="$ctrl.gridCellAssets"></text-style-editor><text-style-preview active-tab="$ctrl.activeTab" on-tab-selected="$ctrl.toggleTab(tab)" tabs="$ctrl.tabs" grid-cell-assets="$ctrl.gridCellAssets"></text-style-preview></div>'),a.put("SilverApp/views/gc/event-dialog.html",'<div class="modal-width-xlarge-event-dialog modal-height-tall-event-dialog modal-content"><div class="event-dialog-left"><div class="event-dialog-items" ng-click="ctrls.EventsDialogCtrl.editEvents()" ng-class="{selected: (ctrls.EventsDialogCtrl.eventsDialogItems.event == true)}"><i ng-class="{\'icon-event-dialog-events\': (ctrls.EventsDialogCtrl.eventsDialogItems.event == true), \'icon-event-dialog-eventsu\': (ctrls.EventsDialogCtrl.eventsDialogItems.event == false)}"></i> <span class="event-dialog-text">{{::\'SilverApp.events\'|translate}}</span></div><div class="event-dialog-items" ng-click="ctrls.EventsDialogCtrl.editTextStyle()" ng-class="{selected: (ctrls.EventsDialogCtrl.eventsDialogItems.textStyle == true)}"><i ng-class="{\'icon-event-dialog-text\': (ctrls.EventsDialogCtrl.eventsDialogItems.textStyle == true), \'icon-event-dialog-textu\': (ctrls.EventsDialogCtrl.eventsDialogItems.textStyle == false)}"></i> <span class="event-dialog-text">{{::\'SilverApp.events.textStyle\'|translate}}</span></div><div class="event-dialog-items" ng-click="ctrls.EventsDialogCtrl.editPhoto()" ng-class="{selected: (ctrls.EventsDialogCtrl.eventsDialogItems.editPhoto == true),\n                        disabled: ctrls.EventsDialogCtrl.isEmptyGrid}"><i ng-class="{\'icon-event-dialog-photo\': (ctrls.EventsDialogCtrl.eventsDialogItems.editPhoto == true), \'icon-event-dialog-photou\': (ctrls.EventsDialogCtrl.eventsDialogItems.editPhoto == false)}"></i> <span class="event-dialog-text">{{::\'SilverApp.events.edit.photo\'|translate}}</span></div></div><div class="event-dialog-right" data-test-key="event_dialog_title"><div class="event-dialog-arrow" ng-class="{\'event-dialog-edit-events\': ctrls.EventsDialogCtrl.eventsDialogItems.event == true,\n               \'event-dialog-edit-text-style\': ctrls.EventsDialogCtrl.eventsDialogItems.textStyle == true,\n               \'event-dialog-edit-photo\': ctrls.EventsDialogCtrl.eventsDialogItems.editPhoto == true}"><i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_event_dialog_modal_xclose" ng-click="ctrls.EventsDialogCtrl.dismiss()"></i><div class="modal-header"><div data-test-key="event_dialog_title"><div class="modal-header-title"><span>{{ctrls.EventsDialogCtrl.dateClass | calendarizeMonth | translate}}</span> <span>{{ctrls.EventsDialogCtrl.eventsDate.day}},</span> <span>{{ctrls.EventsDialogCtrl.eventsDate.year}}</span></div></div></div><div class="event-dialog-body"><div ng-if="ctrls.EventsDialogCtrl.eventsDialogItems.event"><sf-dialog-events-editor date="ctrls.EventsDialogCtrl.eventsDate" grid-cell-assets="ctrls.EventsDialogCtrl.gridCellAssets" hover-delay="ctrls.MainCtrl.hoverDelay" on-tab-changed="ctrls.EventsDialogCtrl.setTabChangedCallback(tabChangedCallback)"></sf-dialog-events-editor></div><div ng-if="ctrls.EventsDialogCtrl.eventsDialogItems.textStyle"><text-style active-tab="ctrls.EventsDialogCtrl.activeTextTab" date-text-asset="ctrls.EventsDialogCtrl.dateTextAsset" event-text-asset="ctrls.EventsDialogCtrl.eventTextAsset" grid-cell-assets="ctrls.EventsDialogCtrl.gridCellAssets" is-advanced-text="ctrls.EventsDialogCtrl.config.features.advancedText" page="ctrls.EventsDialogCtrl.page" on-tab-changed="ctrls.EventsDialogCtrl.setTabChangedCallback(tabChangedCallback)"></text-style></div><div ng-if="ctrls.EventsDialogCtrl.eventsDialogItems.editPhoto"><image-editor max-size="340" on-commit-changes="ctrls.EventsDialogCtrl.setTabChangedCallback(tabChangedCallback)" original-asset="ctrls.EventsDialogCtrl.imageAsset" page="ctrls.EventsDialogCtrl.page"></image-editor></div></div><div class="event-dialog-done"><div ng-if="ctrls.EventsDialogCtrl.eventsDialogItems.editPhoto != true" class="message-event-photo-edit">{{::\'SilverApp.eventEditPhotoGuidance\'|translate}}</div><button type="button" class="btn btn-default btn-primary pull-right" ng-click="ctrls.EventsDialogCtrl.commit()" data-test-key="button_event_dialog_done">{{::\'SilverApp.done\'|translate}}</button> <button ng-if="ctrls.EventsDialogCtrl.eventsDialogItems.event != true" class="btn btn-link pull-right" style="margin-top: 4px" ng-click="ctrls.EventsDialogCtrl.dismiss()" data-test-key="button_event_dialog_cancel">{{::\'Palette.Cancel\'|translate}}</button></div></div></div></div>'),a.put("SilverApp/views/gc/event-drawer.html",'<div class="new-event-drawer clearfix"><div class="region event-list-item"><div class="datepicker-container" ng-if="allowDateEdit"><div class="btn-group" dropdown=""><div dropdown-toggle="" class="dropdown-toggle clickable" data-test-key="month_dropdown"><span>{{\'Calendar.cover.\' + editor.newEventModel.month | translate}}</span> <span class="caret"></span></div><ul class="dropdown-menu"><li ng-repeat="it in editor.months"><a class="clickable" ng-click="onNewProperty({name:\'month\', value:it.month})" data-test-key="{{::\'menu_item_month_\' + it.month}}">{{::it.date | date:\'MMM\' | uppercase}}</a></li></ul></div></div><div class="datepicker-container datepicker-container--day" ng-if="allowDateEdit"><div class="btn-group" dropdown=""><div dropdown-toggle="" class="dropdown-toggle clickable" data-test-key="day_dropdown"><span>{{editor.newEventModel.day}}</span> <span class="caret"></span></div><ul class="dropdown-menu"><li ng-repeat="it in editor.days"><a class="clickable" ng-click="onNewProperty({name:\'day\', value:it})" data-test-key="{{::\'menu_item_day_\' + it}}">{{::it}}</a></li></ul></div></div><div data-test-key="warning_too_many_selected_events" class="too-many-selected-events" ng-show="editor.hasTooManySelectedEvents">{{::\'Calendars.eventstab.selectionInlineWarning\'|translate}}</div></div><div class="event-name event-list-item"><input data-test-key="input_new_event_name" sf-focus="" class="event-name-field" ng-change="editor.applyEventNameValidation(editor.newEventModel.name)" maxlength="{{::editor.maxEventNameLength}}" placeholder="{{::\'Calendars.eventstab.eventName\' | translate}}" ng-model="editor.newEventModel.name"/><div class="btn-group relationship-dropdown" dropdown=""><div dropdown-toggle="" class="dropdown-toggle clickable" data-test-key="relationship_dropdown"><span>{{\'relationship \' + editor.newEventModel.relationship | translate}}</span> <span class="caret"></span></div><ul class="dropdown-menu"><li ng-repeat="it in editor.relationships"><a class="clickable" ng-click="onNewProperty({name:\'relationship\', value:it})" data-test-key="{{::\'menu_item_relationship_\' + it}}" translate="">{{::\'relationship \' + it}}</a></li></ul></div><div class="message-container message-container--top-padded" ng-style="{visibility:editor.invalidCharsWarning}"><span class="message-container__icon message-container__icon--warning"></span> <span class="message-container__text message-container__text--warning" data-test-key="long-text-warning">{{::\'SilverApp.editText.removeNonPrintable\'|translate}}</span></div></div><div class="occasion event-list-item"><div class="btn-group" dropdown=""><div dropdown-toggle="" class="dropdown-toggle clickable" data-test-key="occasion_dropdown"><span>{{\'occasion \' + editor.newEventModel.type | translate}}</span> <span class="caret"></span></div><ul class="dropdown-menu"><li ng-repeat="it in editor.occasions"><a class="clickable" ng-click="onNewProperty({name:\'type\', value:it})" data-test-key="{{::\'menu_item_occasion_\' + it}}" translate="">{{::\'occasion \' + it}}</a></li></ul></div></div><div class="occurrence event-list-item"><div class="btn-group" dropdown=""><div dropdown-toggle="" class="dropdown-toggle clickable" data-test-key="occurrence_dropdown"><span>{{\'occurrence \' + editor.newEventModel.recurring | translate}}</span> <span class="caret"></span></div><ul class="dropdown-menu"><li ng-repeat="it in editor.occurrences"><a class="clickable" ng-click="onNewProperty({name:\'recurring\', value:it})" data-test-key="{{::\'menu_item_occurrence_\' + it}}" translate="">{{::\'occurrence \' + it}}</a></li></ul></div></div><div class="clearfix edit-event-controls"><button class="btn btn-link" ng-click="onRequestCancel()" data-test-key="button_cancel_new_event">{{::\'Palette.Cancel\'|translate}}</button> <button class="btn btn-primary event-save-btn" data-test-key="button_save_new_event" ng-class="{disabled: !editor.newEventModel.name}" ng-click="onRequestSave()">{{::\'SilverApp.save\'|translate}}</button></div></div>'),a.put("SilverApp/views/gc/event-photo-radio.html",'<div class="share-radio clickable" ng-class="{\'active\': $ctrl.active}" ng-if="$ctrl.event.type != \'holiday\' && $ctrl.event.isSelected && $ctrl.editor.getImageById($ctrl.event.id) != null" ng-click="$ctrl.editor.onChangeEventImage($event, $ctrl.event)" data-test-key="{{::\'event_photo_radio_\' + $ctrl.event.id}}" uncheckable="true"><div class="radio-label" ng-if="$ctrl.active == true" data-test-key="{{:: \'radio_addpages_is_active_text_\' + $ctrl.event.id }}">{{::$ctrl.activeLabel}}</div><div class="radio-label" ng-if="$ctrl.active != true" data-test-key="{{:: \'radio_addpages_not_active_text_\' + $ctrl.event.id }}">{{::$ctrl.inactiveLabel}}</div></div>'),a.put("SilverApp/views/gc/event-photo-well.html",'<div class="event-photo-wrap" ng-if="$ctrl.inAdvancedEditTab && $ctrl.event.type != \'holiday\'"><img ng-if="(asset = $ctrl.editor.getEventImageAsset($ctrl.event)) != null" width="100%" height="100%" ng-style="{\'background-image\':\'url(\' + (asset.thumbSrc) + \')\'}" ng-src="{{::$ctrl.editor.config.TRANSPARENT_IMAGE}}" sf-draggable="" drag-asset="asset" drag-options="{eventId: $ctrl.event.id, useCustomAvatar:true}" location="event" data-test-event="{{$ctrl.event.id}}" data-test-key="event_photo_{{$ctrl.event.id}}"/> <i class="image-remove" ng-if="asset != null" ng-click="$ctrl.editor.removeEventPhotoAssignment($ctrl.event)" data-test-key="button_event_image_remove"></i><div ng-if="asset == null" class="empty-event-photo" data-test-key="{{:: \'empty_event_photo_indicator_\' + $ctrl.event.id }}"></div><positionable ng-if="$ctrl.imageHover && $ctrl.eventHover" target="[data-test-key=\'event_photo_{{$ctrl.eventHover.id}}\']" delay="{{$ctrl.hoverDelay}}" placement="right" h-spacing="10" v-spacing="-70" width="370" height="390" z-index="1200" class="shadow-box"><div id="image-preview-container" class="preview-container" ng-if="$ctrl.imageHover && $ctrl.eventHover.id" data-test-key="div_photo_preview_{{$ctrl.eventHover.id}}"><div class="image-wrapper"><img class="preview-image" ng-src="{{$ctrl.imageHover.previewSrc}}"/></div><div class="preview-footage" data-test-key="label_photo_preview">{{$ctrl.imageHover.createTimestampedDescription()}}</div></div></positionable></div>'),
a.put("SilverApp/views/gc/events/delete-event-modal.html",'<div class="modal-width-small modal-content"><div class="modal-header"><span class="modal-header-title" translate="">Calendars.eventstab.deleteEvent</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_delete_event_modal_xclose" ng-click="$dismiss()"></i></div><div class="modal-body"><p translate="">Calendars.eventstab.deleteModalLine1</p><p translate="">Calendars.eventstab.deleteModalLine2</p></div><div class="modal-footer"><button role="button" class="btn btn-link" ng-click="$dismiss()" data-test-key="button_delete_event_modal_cancel">{{::\'Palette.Cancel\'|translate}}</button> <button role="button" class="btn btn-primary" ng-click="$close()" data-test-key="button_delete_event_modal_confirm">{{::\'SilverApp.continueDialog\'|translate}}</button></div></div>'),a.put("SilverApp/views/gc/events/edit-event-drawer.html",'<div class="edit-event-drawer clearfix"><div class="region clearfix event-list-item"><div class="datepicker-container datepicker-container--day"><div class="btn-group" dropdown=""><div dropdown-toggle="" class="dropdown-toggle clickable" data-test-key="day_dropdown"><span>{{ctrls.EventsCtrl.editor.editEventModel.day}}</span> <span class="caret"></span></div><ul class="dropdown-menu"><li ng-repeat="it in ctrls.EventsCtrl.editor.days"><a class="clickable" ng-click="ctrls.EventsCtrl.editor.setEditEventProperty(\'day\', it)" data-test-key="{{::\'menu_item_day_\' + it}}">{{::it}}</a></li></ul></div></div><div class="datepicker-container"><div class="btn-group" dropdown=""><div dropdown-toggle="" class="dropdown-toggle clickable" data-test-key="month_dropdown"><span>{{\'Calendar.cover.\' + ctrls.EventsCtrl.editor.editEventModel.month | translate}}</span> <span class="caret"></span></div><ul class="dropdown-menu"><li ng-repeat="it in ctrls.EventsCtrl.editor.months"><a class="clickable" ng-click="ctrls.EventsCtrl.editor.setEditEventProperty(\'month\', it.month)" data-test-key="{{::\'menu_item_month_\' + it.month}}">{{::it.date | date:\'MMM\' | uppercase}}</a></li></ul></div></div><div data-test-key="warning_too_many_selected_events" class="too-many-selected-events" ng-show="ctrls.EventsCtrl.editor.hasTooManySelectedEvents">{{::\'Calendars.eventstab.selectionInlineWarning\'|translate}}</div></div><div class="add-to-project event-list-item"></div><div class="event-name event-list-item"><input data-test-key="input_edit_event_name" ng-change="ctrls.EventsCtrl.editor.applyEventNameValidation(ctrls.EventsCtrl.editor.editEventModel.name)" maxlength="{{::ctrls.EventsCtrl.editor.maxEventNameLength}}" placeholder="{{::\'Calendars.eventstab.eventName\' | translate}}" ng-model="ctrls.EventsCtrl.editor.editEventModel.name"/><div class="btn-group relationship-dropdown" dropdown=""><div dropdown-toggle="" class="dropdown-toggle clickable" data-test-key="relationship_dropdown"><span>{{\'relationship \' + ctrls.EventsCtrl.editor.editEventModel.relationship | translate}}</span> <span class="caret"></span></div><ul class="dropdown-menu"><li ng-repeat="it in ctrls.EventsCtrl.editor.relationships"><a class="clickable" ng-click="ctrls.EventsCtrl.editor.setEditEventProperty(\'relationship\', it)" data-test-key="{{::\'menu_item_relationship_\' + it}}" translate="">{{::\'relationship \' + it}}</a></li></ul></div><div class="message-container message-container--top-padded" ng-style="{visibility:ctrls.EventsCtrl.editor.invalidCharsWarning}"><span class="message-container__icon message-container__icon--warning"></span> <span class="message-container__text message-container__text--warning" data-test-key="long-text-warning">{{::\'SilverApp.editText.removeNonPrintable\'|translate}}</span></div></div><div class="occasion event-list-item"><div class="btn-group" dropdown=""><div dropdown-toggle="" class="dropdown-toggle clickable" data-test-key="occasion_dropdown"><span>{{\'occasion \' + ctrls.EventsCtrl.editor.editEventModel.type | translate}}</span> <span class="caret"></span></div><ul class="dropdown-menu"><li ng-repeat="it in ctrls.EventsCtrl.editor.occasions"><a class="clickable" ng-click="ctrls.EventsCtrl.editor.setEditEventProperty(\'type\', it)" data-test-key="{{::\'menu_item_occasion_\' + it}}" translate="">{{::\'occasion \' + it}}</a></li></ul></div></div><div class="occurrence event-list-item"><div class="btn-group" dropdown=""><div dropdown-toggle="" class="dropdown-toggle clickable" data-test-key="occurrence_dropdown"><span>{{\'occurrence \' + ctrls.EventsCtrl.editor.editEventModel.recurring | translate}}</span> <span class="caret"></span></div><ul class="dropdown-menu"><li ng-repeat="it in ctrls.EventsCtrl.editor.occurrences"><a class="clickable" ng-click="ctrls.EventsCtrl.editor.setEditEventProperty(\'recurring\', it)" data-test-key="{{::\'menu_item_occurrence_\' + it}}" translate="">{{::\'occurrence \' + it}}</a></li></ul></div></div><div class="clearfix pull-right edit-event-controls"><button class="btn btn-primary pull-right event-save-btn" data-test-key="button_save_edit_event" ng-disabled="!ctrls.EventsCtrl.editor.editEventModel.name" ng-click="ctrls.EventsCtrl.finishEditingEvent()">{{::\'SilverApp.save\'|translate}}</button> <button class="btn btn-link pull-right" ng-click="ctrls.EventsCtrl.editor.cancelEditingEvent()" data-test-key="button_cancel_edit_event">{{::\'Palette.Cancel\'|translate}}</button></div></div>'),a.put("SilverApp/views/gc/events/events.html",'<div><div class="clearfix app-subnav"><div class="subnav-title">{{::\'Calendars.eventstab.entrytext\'|translate}}</div><div class="exit-button detached-dropdown-button exit-advanced-edit-button pull-right"><a data-test-key="button_exitEvents" ng-click="ctrls.EventsCtrl.editor.returnToEdit()" class="header-button">{{::\'SilverApp.returnToEdit\'|translate}}</a></div></div><div class="events-page-content-container events-page-content clearfix" ng-class="{\'new-event-drawer-open\': ctrls.EventsCtrl.editor.isCreatingNewEvent,\n         \'events-page-content-bottom\': ctrls.MainCtrl.features.advancedEventsTab && (!ctrls.PaletteCtrl.lowerPaletteIsExpanded && !ctrls.PaletteCtrl.lowerPaletteIsCollapsed),\n         \'events-page-content-bottom-expanded\': ctrls.MainCtrl.features.advancedEventsTab && ctrls.PaletteCtrl.lowerPaletteIsExpanded,\n         \'events-page-content-bottom-collapsed\': ctrls.MainCtrl.features.advancedEventsTab && ctrls.PaletteCtrl.lowerPaletteIsCollapsed}"><div class="event-list"><div class="date-list-row" ng-repeat="group in (ctrls.EventsCtrl.editor.events | filter: ctrls.EventsCtrl.eventFilterCriteria[ctrls.EventsCtrl.selectedEventFilter] | orderBy:[\'dateMillis\',\'id\'] | groupBy:\'dateMillis\')"><div ng-repeat="event in group" class="event-list-row {{::\'event_\' + event.id}} {{\'event-type-\' + event.type}} {{\'date_\' + event.month + \'-\' + event.day}}" ng-class="{\'edit-event-drawer-open\': event.isBeingEdited,\n                                \'selected\': event.isSelected}" sf-droppable="" drop-options="{eventId: event.id}" location="event" indicate-droppable="true" data-test-key="{{::\'event_\' + event.id}}"><div class="event-list-row-view-mode"><div class="region event-list-item" ng-class="{clickable:event.type != \'holiday\'}" ng-click="ctrls.EventsCtrl.editor.startEditingEvent($event, event)" data-test-key="{{::\'event_date_\' + event.id}}"><span class="region-value">{{event.displayDate() | date:\'MMM d, yyyy\' | uppercase}}</span></div><div class="add-to-project event-list-item clickable" ng-click="ctrls.EventsCtrl.editor.selectEvent(event)"><div class="event-checkbox" data-test-key="{{::\'event_add_to_project_\' + event.id}}"></div></div><div class="event-name event-list-item" ng-class="{clickable:event.type != \'holiday\'}" ng-click="ctrls.EventsCtrl.editor.startEditingEvent($event, event)" data-test-key="{{::\'event_name_\' + event.id}}">{{event.name}}</div><div class="occasion event-list-item" ng-class="{clickable:event.type != \'holiday\'}" data-test-key="{{::\'event_occasion_\' + event.id}}" ng-click="ctrls.EventsCtrl.editor.startEditingEvent($event, event)">{{\'occasion \' + event.type | translate}}</div><div class="event-photo event-list-item" ng-class="{\'selected-date-photo\': ctrls.EventsCtrl.editor.getImageAssociation(event.id).active == true, clickable:event.type != \'holiday\'}"><sf-event-photo-well event="event" in-advanced-edit-tab="ctrls.MainCtrl.features.advancedEventsTab" editor="ctrls.EventsCtrl.editor" hover-delay="ctrls.MainCtrl.hoverDelay"></sf-event-photo-well></div><div class="event-list-item event-photo-radio"><sf-event-photo-radio event="event" active="ctrls.EventsCtrl.editor.getImageAssociation(event.id).active" editor="ctrls.EventsCtrl.editor" active-label="ctrls.EventsCtrl.translatePhotoRadioLabel(event, \'Current photo for \')" inactive-label="ctrls.EventsCtrl.translatePhotoRadioLabel(event, \'Use this photo for \')"></sf-event-photo-radio></div><div class="actions editremove event-list-item"><div class="clickable action action-edit" ng-click="ctrls.EventsCtrl.editor.startEditingEvent($event, event)" data-test-key="{{::\'event_edit_\' + event.id}}"></div><div class="clickable action action-delete" ng-click="ctrls.EventsCtrl.editor.delete($event, event)" data-test-key="{{::\'event_delete_\' + event.id}}"></div></div></div><div ng-if="event.isBeingEdited" class="event-list-row-edit-mode" ng-include="\'SilverApp/views/gc/events/edit-event-drawer.html\'"></div></div></div></div><div class="event-list-header"><div ng-if="ctrls.EventsCtrl.editor.isCreatingNewEvent && ctrls.EventsCtrl.editor.active == true"><sf-event-drawer editor="ctrls.EventsCtrl.editor" allow-date-edit="true" on-new-property="ctrls.EventsCtrl.editor.setNewEventProperty(name, value)" on-request-save="ctrls.EventsCtrl.saveNewEvent()" on-request-cancel="ctrls.EventsCtrl.editor.cancelCreatingNewEvent()"></sf-event-drawer></div><div class="dropdown filter-control" is-open="ctrls.EventsCtrl.isFilterDropdownOpen" dropdown=""><div class="filter-control__label filter-control__label--events-filter dropdown-toggle" data-test-key="filter-control__label--events-filter" dropdown-toggle=""><span class="filter-control__label-text">{{::\'Calendars.eventstab.filterBy\' | translate}} {{ \'Calendars.EventFilter.\' + ctrls.EventsCtrl.selectedEventFilter | translate}}</span> <span class="caret-holder filter-control__label-icon"><span class="caret"></span></span></div><ul class="dropdown-menu filter-control__dropdown"><li class="filter-control__dropdown-item" data-test-key="filter-control__item--events-filter-all" ng-class="{\'filter-control__dropdown-item--selected\':ctrls.EventsCtrl.selectedEventFilter == ctrls.EventsCtrl.eventFilters.SHOW_ALL}" ng-click="ctrls.EventsCtrl.selectedEventFilter = ctrls.EventsCtrl.eventFilters.SHOW_ALL"><span class="selection-indicator"></span> <span>{{ \'Calendars.EventFilter.\' + ctrls.EventsCtrl.eventFilters.SHOW_ALL | translate}}</span></li><li class="filter-control__dropdown-item" data-test-key="filter-control__item--events-filter-my-event" ng-class="{\'filter-control__dropdown-item--selected\':ctrls.EventsCtrl.selectedEventFilter == ctrls.EventsCtrl.eventFilters.MY_EVENTS}" ng-click="ctrls.EventsCtrl.selectedEventFilter = ctrls.EventsCtrl.eventFilters.MY_EVENTS"><span class="selection-indicator"></span> <span>{{ \'Calendars.EventFilter.\' + ctrls.EventsCtrl.eventFilters.MY_EVENTS | translate}}</span></li><li class="filter-control__dropdown-item" data-test-key="filter-control__item--events-filter-public" ng-class="{\'filter-control__dropdown-item--selected\':ctrls.EventsCtrl.selectedEventFilter == ctrls.EventsCtrl.eventFilters.PUBLIC_HOLIDAYS}" ng-click="ctrls.EventsCtrl.selectedEventFilter = ctrls.EventsCtrl.eventFilters.PUBLIC_HOLIDAYS"><span class="selection-indicator"></span> <span>{{ \'Calendars.EventFilter.\' + ctrls.EventsCtrl.eventFilters.PUBLIC_HOLIDAYS | translate}}</span></li></ul></div><div class="add-to-project event-list-item" data-test-key="event_header_add_to_project">{{::\'Calendars.eventstab.addToProject\'|translate}}</div><div class="event-name event-list-item" data-test-key="event_header_name">{{::\'Calendars.eventstab.eventName\'|translate}}</div><div class="occasion event-list-item" data-test-key="event_header_occasion">{{::\'Calendars.eventstab.occasion\'|translate}}</div><div class="event-photo event-list-item" ng-if="ctrls.MainCtrl.features.advancedEventsTab">{{::\'Calendars.eventstab.photo\'|translate}}</div><button role="button" class="btn btn-secondary events-new-event-button" ng-class="{disabled: ctrls.EventsCtrl.editor.isCreatingNewEvent}" data-test-key="button_add_event_header" ng-click="ctrls.EventsCtrl.editor.startCreatingNewEvent()">{{::\'Calendars.eventstab.addNewEvent\'|translate}}</button><div class="event-edit event-list-item" ng-if="ctrls.MainCtrl.features.advancedEventsTab">{{::\'SilverApp.edit\'|translate}}</div><div class="event-delete event-list-item" ng-if="ctrls.MainCtrl.features.advancedEventsTab">{{::\'SilverApp.delete\'|translate}}</div></div><div sf-force-scroll="" enable-when="ctrls.NavCtrl.eventsIsActive" scroll-when="ctrls.EventsCtrl.activatedEvent" scroll-direction="\'vertical\'" scroll-to="-65" scroll-to-element="ctrls.EventsCtrl.activatedEventTargetClassifier" target-elements-classifier="\'.events-page-content .event-list\'"></div></div><div ng-if="ctrls.MainCtrl.features.advancedEventsTab" class="palette-tabs app-footer events-palette clearfix" ng-class="{\'expanded\': ctrls.PaletteCtrl.lowerPaletteIsExpanded, \'collapsed\': ctrls.PaletteCtrl.lowerPaletteIsCollapsed}"><tabset><tab class="clickable" heading="{{::\'Palette.photo\' | translate }}" data-test-key="tab_photos" active="true" sf-droppable="" location="palette"><div class="palette-images clearfix" ng-include="\'Palette/views/images.html\'"></div></tab></tabset></div></div>'),a.put("SilverApp/views/gc/events/too-many-selected-events-modal.html",'<div class="modal-width-small modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'Calendars.eventstab.selectionModalHeader\'|translate}}</span></div><div class="modal-body"><p>{{::\'Calendars.eventstab.selectionModalContent\'|translate}}</p></div><div class="modal-footer"><button role="button" class="btn btn-primary" ng-click="$close()" data-test-key="button_selection_event_modal_confirm">{{::\'SilverApp.Ok\'|translate}}</button></div></div>'),a.put("SilverApp/views/gc/get-design-elements-menu-item.html",'<li><a ng-click="ctrls.PaletteCtrl.showExtendedPalette()" class="clickable" omniture="" linkname="Pages:Get design elements" data-test-key="button_get_design_elements">{{::\'SilverApp.getDesignElements\'|translate}}</a></li>'),a.put("SilverApp/views/gc/inline-event-drawer.html",'<div class="inline-event-drawer"><input class="inline-event-name inline-event-item" data-test-key="input_edit_event_name" ng-change="$ctrl.editor.applyEventNameValidation($ctrl.event.name)" maxlength="{{::$ctrl.editor.maxEventNameLength}}" placeholder="{{::\'Calendars.eventstab.eventName\' | translate}}" ng-model="$ctrl.event.name" sf-focus=""/><div class="inline-occasion-dropdown inline-event-item btn-group" dropdown=""><div dropdown-toggle="" class="dropdown-toggle clickable" data-test-key="occasion_dropdown"><span>{{\'occasion \' + $ctrl.event.type | translate}}</span> <span class="caret"></span></div><ul class="dropdown-menu"><li ng-repeat="it in $ctrl.editor.occasions"><a class="clickable" ng-click="$ctrl.onNewProperty({name: \'type\', value: it})" data-test-key="{{::\'menu_item_occasion_\' + it}}" translate="">{{::\'occasion \' + it}}</a></li></ul></div><div class="inline-occurrence-dropdown inline-event-item btn-group" dropdown=""><div dropdown-toggle="" class="dropdown-toggle clickable" data-test-key="occurrence_dropdown"><span>{{\'occurrence \' + $ctrl.event.recurring | translate}}</span> <span class="caret"></span></div><ul class="dropdown-menu"><li ng-repeat="it in $ctrl.editor.occurrences"><a class="clickable" ng-click="$ctrl.onNewProperty({name: \'recurring\', value: it})" data-test-key="{{::\'menu_item_occurrence_\' + it}}" translate="">{{::\'occurrence \' + it}}</a></li></ul></div><div class="btn-group relationship-dropdown inline-event-item" dropdown=""><div dropdown-toggle="" class="dropdown-toggle clickable" data-test-key="relationship_dropdown"><span>{{\'relationship \' + $ctrl.event.relationship | translate}}</span> <span class="caret"></span></div><ul class="dropdown-menu"><li ng-repeat="it in $ctrl.editor.relationships"><a class="clickable" ng-click="$ctrl.onNewProperty({name: \'relationship\', value: it})" data-test-key="{{::\'menu_item_relationship_\' + it}}" translate="">{{::\'relationship \' + it}}</a></li></ul></div><div data-test-key="warning_too_many_selected_events" class="too-many-selected-events" ng-show="$ctrl.showEventsMaxWarning && $ctrl.editor.invalidCharsWarning == \'hidden\' && $ctrl.editor.hasTooManySelectedEvents">{{::\'Calendars.eventstab.selectionInlineWarning\'|translate}}</div><div class="message-container message-container--top-padded" ng-if="$ctrl.editor.invalidCharsWarning == \'visible\'"><span class="message-container__icon message-container__icon--warning"></span> <span class="message-container__text message-container__text--warning" data-test-key="long-text-warning">{{::\'SilverApp.editText.removeNonPrintable\'|translate}}</span></div><div class="clearfix pull-right edit-event-controls"><button class="btn btn-primary pull-right event-save-btn" data-test-key="button_save_edit_event" ng-disabled="!$ctrl.event.name" ng-click="$ctrl.onRequestSave()">{{::\'SilverApp.save\'|translate}}</button> <button class="btn btn-link pull-right event-cancel-btn" ng-click="$ctrl.onRequestCancel()" data-test-key="button_cancel_edit_event">{{::\'Palette.Cancel\'|translate}}</button></div></div>'),a.put("SilverApp/views/gc/layer-menu-items.html",'<li ng-class="{disabled: !ctrls.CustomizeCtrl.canLayerForward}"><a class="clickable" ng-click="ctrls.CustomizeCtrl.layerFront()" class="clickable" data-test-key="button_layer_front">{{::\'SilverApp.layerBringToFrontMenuItem\'|translate}}</a></li><li ng-class="{disabled: !ctrls.CustomizeCtrl.canLayerBackward}"><a class="clickable" ng-click="ctrls.CustomizeCtrl.layerBack()" data-test-key="button_layer_back">{{::\'SilverApp.layerSendToBackMenuItem\'|translate}}</a></li>'),a.put("SilverApp/views/gc/miss-day-target-warning.html",'<div class="modal-width-small modal-content"><div class="miss-day-target-warning-modal-body"><span translate="">SilverApp.MissDayTargetWarning</span></div><div class="modal-footer"><div class="checkbox pull-left"><label><input type="checkbox" ng-model="ctrls.MissDayTargetWarningCtrl.doNotShowAgain" data-test-key="{{::state.inputDtk}}"/><span>{{::\'SilverApp.doNotShowAgain\'|translate}}</span></label></div><button type="button" class="btn btn-default btn-primary miss-day-target-warning-ok" ng-click="ctrls.MissDayTargetWarningCtrl.close()" data-test-key="button_apply_to_other_pages_apply" translate="">SilverApp.Ok</button></div></div>'),a.put("SilverApp/views/gc/pages-tab.html",""),a.put("SilverApp/views/gc/path-switch-menu-item.html",""),a.put("SilverApp/views/gc/preview.html",'<div class="edit-tab edit-tab--inpreview single-palette" ng-controller="EditTabCtrl"><div class="entire-surface-area entire-surface-area-preview" ng-click="ctrls.CustomizeCtrl.deselectAll()" ng-controller="ImageCtrl"><div ng-include="\'SilverApp/views/@@p/surface.html\'" include-replace="" ng-if="!ctrls.NavCtrl.showingSummary"></div><div ng-include="\'SilverApp/views/@@p/summary.html\'" include-replace="" ng-if="ctrls.NavCtrl.showingSummary"></div></div></div><sf-dimension-watcher ng-if="::ctrls.MainCtrl.isDeviceAPhone()" source="sf-galleon-app-container" on-dimensions-changed="ctrls.MainCtrl.updateDeviceOrientation(width, height)"></sf-dimension-watcher>'),a.put("SilverApp/views/gc/pricing-receipt.html","<div ng-include=\"'SilverApp/views/default-pricing-receipt.html'\"></div>"),a.put("SilverApp/views/gc/prompt-for-storyboard.html",'<div class="modal-width-medium-large modal-height-medium-large modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.prompt.storyboardTitle\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" data-test-key="button_storyboard_prompt__modal_xclose" ng-click="ctrls.SimpleModalCtrl.cancel()"></i></div><div class="modal-body"><p>{{::\'SilverApp.prompt.storyboardText\'|translate}}</p><div class="storyboard-visual"></div></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.SimpleModalCtrl.ok()" data-test-key="button_storyboard_prompt_modal_ok">{{::\'SilverApp.getStarted\'|translate}}</button></div></div>'),a.put("SilverApp/views/gc/save-button.html",'<button id="saveButton" data-intro="{{::\'HelpOverlay.3\' | translate }}" data-position="bottom" class="btn btn-secondary navbar-btn order-btn header-button save-btn" ng-click="!ctrls.MainCtrl.inTourMode && ctrls.SaveCtrl.save()" omniture="" linkname="Order" data-test-key="header_save_button">{{::\'SilverApp.save\'|translate}}</button>'),a.put("SilverApp/views/gc/share-tab-items.html",'<div class="modal-body"><div class="ext-palette-header-nav"><div class="ext-palette-header-button" ng-class="{active: ctrls.ShareCtrl.activeTab == \'email\', selected: ctrls.ShareCtrl.activeTab == \'email\'}" ng-click="ctrls.ShareCtrl.selectTab(\'email\')">{{\'SilverApp.Share.dialog.tab.email\'|translate}}<div class="ext-palette-arrow" ng-class="{\'selected\': ctrls.ShareCtrl.activeTab == \'email\'}"></div></div><div class="ext-palette-header-button" ng-class="{active: ctrls.ShareCtrl.activeTab == \'weblink\', selected: ctrls.ShareCtrl.activeTab == \'weblink\'}" ng-click="ctrls.ShareCtrl.selectTab(\'weblink\')">{{\'SilverApp.Share.dialog.tab.weblink\'|translate}}<div class="ext-palette-arrow" ng-class="{\'selected\': ctrls.ShareCtrl.activeTab == \'weblink\'}"></div></div></div></div><div ng-show="ctrls.ShareCtrl.activeTab == \'email\'" ng-form="emailShareForm"><div class="modal-body share-modal-body"><div class="input-group" id="share-emails"><span class="input-group-addon">To:</span><input name="shareEmails" ng-model="ctrls.ShareCtrl.emails" class="form-control" placeholder="{{::\'SilverApp.Share.dialog.emails\'|translate}}" sf-email-validator="" multi-email-mode="true" required=""></div><div id="share-message"><textarea ng-trim="false" ng-init="ctrls.ShareCtrl.updateEmailMessageLength()" ng-keyup="ctrls.ShareCtrl.updateEmailMessageLength()" ng-hide="ctrls.ShareCtrl.sent" ng-model="ctrls.ShareCtrl.emailMessage" maxlength="200"></textarea><span class="emailCharLimit" ng-hide="ctrls.ShareCtrl.sent">{{::\'SilverApp.Share.dialog.charlimitlabel\'|translate}}{{ctrls.ShareCtrl.emailMessageCharRemainForSingleCharNewLine}}</span> <span class="emailCharLimitTwoChar" ng-hide="ctrls.ShareCtrl.sent">{{::\'SilverApp.Share.dialog.charlimitlabel\'|translate}}{{ctrls.ShareCtrl.emailMessageCharRemainForDoubleCharNewLine}}</span><p ng-show="ctrls.ShareCtrl.sent">{{ctrls.ShareCtrl.sentMessage}}</p></div><div id="share-cover" class="single-page-wrapper page-thumbnail front-cover"><sf-simple-page page="ctrls.PagesCtrl.getFrontCover()" width="260" height="200" priority="high"></sf-simple-page></div></div><div class="modal-footer" id="share-button"><div class="message-container message-container--inline" ng-show="emailShareForm.shareEmails.$dirty && emailShareForm.shareEmails.$error.required" data-test-key="required-email"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error">{{::\'SilverApp.Share.dialog.requiredEmail\'|translate}}</span></div><div class="message-container message-container--inline" ng-show="emailShareForm.shareEmails.$dirty && emailShareForm.shareEmails.$error.sfMultipleEmails && !emailShareForm.shareEmails.$error.required" data-test-key="invalid-email"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error">{{::\'SilverApp.Share.dialog.invalidEmail\'|translate}}</span></div><button ng-show="!ctrls.ShareCtrl.sent" class="btn btn-primary" ng-class="{\'disabled\': !ctrls.ShareCtrl.isFormValid(emailShareForm)}" ng-click="ctrls.ShareCtrl.isFormValid(emailShareForm) && ctrls.ShareCtrl.shareDialogHandler()" data-test-key="button_share_dialog_submit">{{::\'SilverApp.Share.dialog.submit.email\'|translate}}</button> <button ng-show="ctrls.ShareCtrl.sent" class="btn btn-primary" ng-click="ctrls.ShareCtrl.close()" data-test-key="button_share_dialog_close">{{::\'SilverApp.Share.dialog.close\'|translate}}</button></div></div><div ng-show="ctrls.ShareCtrl.activeTab == \'weblink\'" ng-form="weblinkShareForm"><div class="modal-body share-modal-body"><div ng-hide="ctrls.ShareCtrl.isCopyDisabled" id="share-weblink-title">{{::\'SilverApp.Share.dialog.link\'|translate}}</div><div ng-show="ctrls.ShareCtrl.isCopyDisabled" id="share-weblink-title">{{::\'SilverApp.Share.dialog.linknocopy\'|translate}}</div><div class="form-group"><textarea id="share-weblink-input" ng-model="ctrls.ShareCtrl.shareUrl" readonly="readonly"></textarea></div></div><div class="modal-footer" id="share-button"><button ng-show="!ctrls.ShareCtrl.isCopyDisabled && !ctrls.ShareCtrl.sent" class="btn btn-primary" clip-click="ctrls.ShareCtrl.shareDialogHandler()" clip-copy="ctrls.ShareCtrl.shareUrl" data-test-key="button_share_dialog_submit">{{::\'SilverApp.Share.dialog.submit.weblink\'|translate}}</button> <button ng-show="ctrls.ShareCtrl.isCopyDisabled || ctrls.ShareCtrl.sent" class="btn btn-primary" ng-click="ctrls.ShareCtrl.close()" data-test-key="button_share_dialog_close">{{::\'SilverApp.Share.dialog.close\'|translate}}</button></div></div>'),a.put("SilverApp/views/gc/spread-menu-item.html",""),a.put("SilverApp/views/gc/spread-noedit.html",'<div id="spread_{{spreadIndex}}" class="book-surface-area" ng-class="{\'preview-spread\': ctrls.MainCtrl.previewMode, \'book-surface-area-overflow\': ctrls.NavCtrl.zoomFactor > 1}"><div class="book-spread"><div class="pages-surface" id="customize-pages-surface" ng-hide="ctrls.NavCtrl[leftPageId].isFiller()" ng-style="{\'min-height\': ctrls.NavCtrl.pageHeight,\n                     \'max-height\': ctrls.NavCtrl.pageHeight,\n                     \'min-width\': ctrls.NavCtrl.pageWidth,\n                     \'margin-top\': ctrls.NavCtrl.bottomRightPageSelected ? \'37px\' : \'0px\'}"><sf-page id="{{leftPageId}}" ng-if="!ctrls.CustomizeCtrl.isCustomizing()" width="ctrls.NavCtrl.pageWidth" height="ctrls.NavCtrl.pageHeight" priority="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) && \'high\' || \'medium\'" page="ctrls.NavCtrl[leftPageId]" hm-swipe-right="ctrls.NavCtrl.previous()" on-remove-image="ctrls.SurfaceCtrl.onRemoveImage(page, asset)" on-remove-embellishment="ctrls.SurfaceCtrl.onRemoveEmbellishment(page, asset)" on-remove-page="ctrls.SurfaceCtrl.onRemovePage(page)" on-edit-text="ctrls.EditTextCtrl.edit(assetIndex, surfaceNumber)" on-edit-event="ctrls.NavCtrl.selectEventsTab(eventAsset)" on-image-double-click="ctrls.SurfaceCtrl.onImageDoubleClick(page, asset, thumb, upload)" on-select="ctrls.NavCtrl.selectLeftPage()" on-page-double-click="ctrls.EditTabCtrl.handleInnerPageDoubleClick(page)" on-page-load="ctrls.SurfaceCtrl.reportSpreadPageLoad()" use-thumbnail="\'true\'" editable="false" use-priority-loading-lifecycle-callbacks="true" book-spread="true" active-spread="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex)" dev-page-data="ctrls.NavCtrl.appState.dev.leftPage" dev-data="ctrls.NavCtrl.appState.dev" data-page-number="{{ctrls.NavCtrl[leftPageId].surfaceNumber}}"></sf-page></div><div class="pages-surface calendar-grid" id="customize-pages-surface" ng-hide="ctrls.NavCtrl[rightPageId].isFiller()" ng-style="{\'min-height\': ctrls.NavCtrl.pageHeight,\n                     \'max-height\': ctrls.NavCtrl.pageHeight,\n                     \'min-width\': ctrls.NavCtrl.pageWidth,\n                     \'margin-top\': ctrls.NavCtrl.bottomRightPageSelected\n                        && ctrls.MainCtrl.previewMode && ctrls.MainCtrl.inFullScreenMode? \'15px\' : \'0px\'}"><sf-page width="ctrls.NavCtrl.pageWidth" height="ctrls.NavCtrl.pageHeight" ng-if="!ctrls.CustomizeCtrl.isCustomizing() &&\n                          ctrls.NavCtrl.activeSpreadIndex == spreadIndex" page="ctrls.NavCtrl[rightPageId]" hm-swipe-left="ctrls.NavCtrl.next()" editable="false" use-priority-loading-lifecycle-callbacks="true" priority="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) && \'high\' || \'medium\'" use-thumbnail="\'true\'" on-remove-image="ctrls.SurfaceCtrl.onRemoveImage(page, asset)" on-remove-embellishment="ctrls.SurfaceCtrl.onRemoveEmbellishment(page, asset)" on-remove-page="ctrls.SurfaceCtrl.onRemovePage(page)" on-edit-text="ctrls.EditTextCtrl.edit(assetIndex, surfaceNumber)" on-edit-event="ctrls.NavCtrl.selectEventsTab(page, asset, dateAsset, eventAsset, imageAsset, gridCellAssets)" on-image-double-click="ctrls.SurfaceCtrl.onImageDoubleClick(page, asset, thumb, upload)" on-select="ctrls.NavCtrl.selectRightPage()" on-page-double-click="ctrls.EditTabCtrl.handleInnerPageDoubleClick(page)" on-page-load="ctrls.SurfaceCtrl.reportSpreadPageLoad()" book-spread="true" active-spread="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex)" dev-page-data="ctrls.NavCtrl.appState.dev.rightPage" dev-data="ctrls.NavCtrl.appState.dev" data-page-number="{{ctrls.NavCtrl[rightPageId].surfaceNumber}}"></sf-page><sf-simple-page page="ctrls.NavCtrl[rightPageId]" ng-if="!ctrls.CustomizeCtrl.isCustomizing() && ctrls.NavCtrl.zoomFactor == 1" ng-style="{\'visibility\': ctrls.NavCtrl.activeSpreadIndex != spreadIndex ? \'visible\' : \'hidden\'}" live-resize="" background-only-render="" width="ctrls.NavCtrl.pageWidth" height="ctrls.NavCtrl.pageHeight" priority="\'medium\'"></sf-simple-page></div><div class="pages-surface" ng-hide="ctrls.NavCtrl[rightPageId].isFiller()" ng-style="{\'max-height\': \'70px\',\n                     \'margin-top\': (-1) * ctrls.NavCtrl.pageHeight,\n                     \'min-width\': ctrls.NavCtrl.pageWidth}"><sf-binder-ring page="ctrls.NavCtrl.selectedPage" width="ctrls.NavCtrl.pageWidth" height="ctrls.NavCtrl.pageHeight"></sf-binder-ring></div></div></div>'),a.put("SilverApp/views/gc/spread.html",'<div id="spread_{{spreadIndex}}" class="book-surface-area" ng-class="{\'preview-spread\': ctrls.MainCtrl.previewMode, \'book-surface-area-overflow\': ctrls.NavCtrl.zoomFactor > 1}"><div class="book-spread"><div class="pages-surface" id="customize-pages-surface" ng-hide="ctrls.NavCtrl[leftPageId].isFiller()" ng-style="{\'min-height\': ctrls.NavCtrl.pageHeight,\n                     \'max-height\': ctrls.NavCtrl.pageHeight,\n                     \'min-width\': ctrls.NavCtrl.pageWidth,\n                     \'margin-top\': ctrls.NavCtrl.bottomRightPageSelected ? \'37px\' : \'0px\'}"><sf-customize-page width="ctrls.NavCtrl.pageWidth" height="ctrls.NavCtrl.pageHeight" page="ctrls.NavCtrl[leftPageId]" ng-if="ctrls.CustomizeCtrl.isCustomizing()" on-select="ctrls.NavCtrl.selectLeftPage()" tabindex="0" sf-droppable=""></sf-customize-page><sf-page id="{{leftPageId}}" ng-if="!ctrls.CustomizeCtrl.isCustomizing()" width="ctrls.NavCtrl.pageWidth" height="ctrls.NavCtrl.pageHeight" priority="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) && \'high\' || \'medium\'" page="ctrls.NavCtrl[leftPageId]" hm-swipe-right="ctrls.NavCtrl.previous()" on-remove-image="ctrls.SurfaceCtrl.onRemoveImage(page, asset)" on-remove-embellishment="ctrls.SurfaceCtrl.onRemoveEmbellishment(page, asset)" on-remove-page="ctrls.SurfaceCtrl.onRemovePage(page)" on-edit-text="ctrls.EditTextCtrl.edit(assetIndex, surfaceNumber)" on-edit-event="ctrls.NavCtrl.selectEventsTab(eventAsset)" on-image-double-click="ctrls.SurfaceCtrl.onImageDoubleClick(page, asset, thumb, upload)" on-select="ctrls.NavCtrl.selectLeftPage()" on-page-double-click="ctrls.EditTabCtrl.handleInnerPageDoubleClick(page)" on-page-load="ctrls.SurfaceCtrl.reportSpreadPageLoad()" use-thumbnail="\'true\'" editable="!ctrls.MainCtrl.previewMode && (ctrls.NavCtrl[leftPageId] == ctrls.NavCtrl.selectedPage || ctrls.NavCtrl.zoomFactor > 1)" use-priority-loading-lifecycle-callbacks="true" book-spread="true" active-spread="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex)" dev-page-data="ctrls.NavCtrl.appState.dev.leftPage" dev-data="ctrls.NavCtrl.appState.dev" data-page-number="{{ctrls.NavCtrl[leftPageId].surfaceNumber}}"></sf-page></div><div class="pages-surface calendar-grid" id="customize-pages-surface" ng-hide="ctrls.NavCtrl[rightPageId].isFiller()" ng-style="{\'min-height\': ctrls.NavCtrl.pageHeight,\n                     \'max-height\': ctrls.NavCtrl.pageHeight,\n                     \'min-width\': ctrls.NavCtrl.pageWidth,\n                     \'margin-top\': ctrls.NavCtrl.bottomRightPageSelected\n                        && ctrls.MainCtrl.previewMode && ctrls.MainCtrl.inFullScreenMode? \'15px\' : \'0px\'}"><sf-customize-page page="ctrls.NavCtrl[rightPageId]" width="ctrls.NavCtrl.pageWidth" height="ctrls.NavCtrl.pageHeight" ng-if="ctrls.CustomizeCtrl.isCustomizing() &&\n                                    ctrls.NavCtrl.activeSpreadIndex == spreadIndex" on-select="ctrls.NavCtrl.selectRightPage()" tabindex="0" sf-droppable=""></sf-customize-page><sf-page width="ctrls.NavCtrl.pageWidth" height="ctrls.NavCtrl.pageHeight" ng-if="!ctrls.CustomizeCtrl.isCustomizing() &&\n                          ctrls.NavCtrl.activeSpreadIndex == spreadIndex" page="ctrls.NavCtrl[rightPageId]" hm-swipe-left="ctrls.NavCtrl.next()" editable="!ctrls.MainCtrl.previewMode && (ctrls.NavCtrl[rightPageId] == ctrls.NavCtrl.selectedPage || ctrls.NavCtrl.zoomFactor > 1)" use-priority-loading-lifecycle-callbacks="true" priority="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) && \'high\' || \'medium\'" use-thumbnail="\'true\'" on-remove-image="ctrls.SurfaceCtrl.onRemoveImage(page, asset)" on-remove-embellishment="ctrls.SurfaceCtrl.onRemoveEmbellishment(page, asset)" on-remove-page="ctrls.SurfaceCtrl.onRemovePage(page)" on-edit-text="ctrls.EditTextCtrl.edit(assetIndex, surfaceNumber)" on-edit-event="ctrls.NavCtrl.selectEventsTab(page, asset, dateAsset, eventAsset, imageAsset, gridCellAssets)" on-image-double-click="ctrls.SurfaceCtrl.onImageDoubleClick(page, asset, thumb, upload)" on-select="ctrls.NavCtrl.selectRightPage()" on-page-double-click="ctrls.EditTabCtrl.handleInnerPageDoubleClick(page)" on-page-load="ctrls.SurfaceCtrl.reportSpreadPageLoad()" book-spread="true" active-spread="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex)" dev-page-data="ctrls.NavCtrl.appState.dev.rightPage" dev-data="ctrls.NavCtrl.appState.dev" data-page-number="{{ctrls.NavCtrl[rightPageId].surfaceNumber}}"></sf-page><sf-simple-page page="ctrls.NavCtrl[rightPageId]" ng-if="!ctrls.CustomizeCtrl.isCustomizing() && ctrls.NavCtrl.zoomFactor == 1" ng-style="{\'visibility\': ctrls.NavCtrl.activeSpreadIndex != spreadIndex ? \'visible\' : \'hidden\'}" live-resize="" background-only-render="" width="ctrls.NavCtrl.pageWidth" height="ctrls.NavCtrl.pageHeight" priority="\'medium\'"></sf-simple-page></div><div class="pages-surface" ng-hide="ctrls.NavCtrl[rightPageId].isFiller()" ng-style="{\'max-height\': \'70px\',\n                     \'margin-top\': (-1) * ctrls.NavCtrl.pageHeight,\n                     \'min-width\': ctrls.NavCtrl.pageWidth}"><sf-binder-ring page="ctrls.NavCtrl.selectedPage" width="ctrls.NavCtrl.pageWidth" height="ctrls.NavCtrl.pageHeight"></sf-binder-ring></div></div></div>'),
a.put("SilverApp/views/gc/summary.html",'<div id="summaryWrapper" class="book-wrapper" ng-class="{\'expanded-bottom-palette\':ctrls.PaletteCtrl.lowerPaletteIsExpanded}" ng-controller="SummaryCtrl"><div id="summaryCoverWrapper" class="summaryCoverWrapper" ng-click="ctrls.NavCtrl.nextMonth()" ng-if="ctrls.PagesCtrl.project.product"><div id="summaryCover"><sf-dimension-watcher source="summaryCoverWrapper" on-dimensions-changed="ctrls.NavCtrl.updateSummaryDimensions(width, height)"></sf-dimension-watcher><sf-page id="summaryPage" width="ctrls.NavCtrl.pageWidth" height="ctrls.NavCtrl.pageHeight" priority="high" page="ctrls.PagesCtrl.getFrontCover()" on-page-load="ctrls.NavCtrl.summaryPageLoaded(ctrls.PagesCtrl.getFrontCover())" editable="false"></sf-page><div class="play-button"></div></div></div><div id="projectInfoWrapper" style="height:{{ctrls.NavCtrl.pageHeight}}px" ng-if="ctrls.PagesCtrl.project.product"><div id="projectInfo"><span class="summary-project-title">{{ctrls.MainCtrl.project.title}}</span> <span class="summary-project-info">{{ctrls.MainCtrl.project.product.descriptionId | translate}}, {{ctrls.MainCtrl.project.product.pages.length | postfixTranslate:\'SilverApp.numPages\'}}</span> <a ng-if="ctrls.SummaryCtrl.showLink" href="{{ctrls.SummaryCtrl.appLink}}">{{ctrls.SummaryCtrl.appText | translate}}</a></div></div></div>'),a.put("SilverApp/views/gc/surface.html",'<div class="book-wrapper" ng-class="{\'dual-palette-4-wide\': ctrls.PaletteCtrl.calendarPaletteMode, \'expanded-bottom-palette\':ctrls.PaletteCtrl.lowerPaletteIsExpanded, \'collapsed-bottom-palette\':ctrls.PaletteCtrl.lowerPaletteIsCollapsed}" ng-style="{\'height\': ctrls.MainCtrl.previewMode || ctrls.MainCtrl.slideshow ? \'93%\' : \'inherit\'}"><div id="bookCenterArea" class="book-center-area" ng-class="{\'book-center-area-csp\': ctrls.PaletteCtrl.calendarPaletteMode}" ng-controller="SurfaceCtrl" data-test-key="2pv" ng-class="{\'customize-on\': ctrls.CustomizeCtrl.isCustomizing(), \'customize-off\': !ctrls.CustomizeCtrl.isCustomizing()}"><sf-dimension-watcher source="bookCenterArea" on-dimensions-changed="ctrls.NavCtrl.updatePageDimensions(width*ctrls.NavCtrl.zoomFactor, height*ctrls.NavCtrl.zoomFactor)"></sf-dimension-watcher><sf-nav-control-buttons active-spread-index="ctrls.NavCtrl.activeSpreadIndex" ng-show="ctrls.SurfaceCtrl.appState.twoPageSpreadHasLoaded"></sf-nav-control-buttons><div ng-if="!ctrls.MainCtrl.slideshow" ng-controller="FirstSpreadCtrl" ng-include="\'SilverApp/views/gc/spread.html\'"></div><div ng-if="!ctrls.MainCtrl.slideshow" ng-controller="MiddleSpreadCtrl" ng-include="\'SilverApp/views/gc/spread.html\'"></div><div ng-if="!ctrls.MainCtrl.slideshow" ng-controller="LastSpreadCtrl" ng-include="\'SilverApp/views/gc/spread.html\'"></div><div ng-if="ctrls.MainCtrl.slideshow" ng-controller="FirstSpreadCtrl" ng-include="\'SilverApp/views/gc/spread-noedit.html\'"></div><div ng-if="ctrls.MainCtrl.slideshow" ng-controller="MiddleSpreadCtrl" ng-include="\'SilverApp/views/gc/spread-noedit.html\'"></div><div ng-if="ctrls.MainCtrl.slideshow" ng-controller="LastSpreadCtrl" ng-include="\'SilverApp/views/gc/spread-noedit.html\'"></div><sf-spread-slider active-spread-index="ctrls.NavCtrl.activeSpreadIndex" page-height="ctrls.NavCtrl.pageHeight" focused-side="(ctrls.NavCtrl.activeLeftPage === ctrls.NavCtrl.selectedPage || ctrls.NavCtrl.zoomFactor > 1) ? \'top\' : \'bottom\'" on-start-transition="ctrls.NavCtrl.handleSpreadTransitionStart()" on-stop-transition="ctrls.NavCtrl.handleSpreadTransitionStop()" left-spread-id="spread_-1" middle-spread-id="spread_0" right-spread-id="spread_1"></sf-spread-slider><div id="layoutsPreviewLoader" ng-if="ctrls.SurfaceCtrl.appState.twoPageSpreadHasLoaded" class="layouts offscreen"></div><div id="bkgsPreviewLoader" ng-if="ctrls.SurfaceCtrl.appState.twoPageSpreadHasLoaded" class="bkgs offscreen"></div><div id="embellishmentPreviewLoader" ng-if="ctrls.SurfaceCtrl.appState.twoPageSpreadHasLoaded" class="embs offscreen"></div></div></div>'),a.put("SilverApp/views/gc/tabs.html",'<div class="app-content"><div class="offscreen"><div ng-controller="EventsCtrl"></div></div><tabset id="mainTabs" class="main-tabs" ng-class="{\'new-nav\':ctrls.NavCtrl.showNewNavigation}"><tab id="styleTab" ng-show="!ctrls.MainCtrl.previewMode" ng-if="!ctrls.MainCtrl.features.styleDialog" heading="{{ \'SilverApp.style\' | translate }}" select="ctrls.StyleTabCtrl.tabWasMadeActive()" deselect="ctrls.StyleTabCtrl.tabWasMadeInactive()" active="ctrls.NavCtrl.styleIsActive" data-test-key="button_style" class="clickable"><div ng-if="ctrls.NavCtrl.styleIsActive" ng-include="\'SilverApp/views/style-tab.html\'" data-test-key="style_page"></div></tab><tab id="storyboardTab" ng-show="!ctrls.MainCtrl.previewMode" ng-if="ctrls.MainCtrl.storyboardEnabled" heading="{{::\'SilverApp.storyboard\' | translate }}" select="ctrls.StoryboardTabCtrl.tabWasMadeActive()" deselect="ctrls.StoryboardTabCtrl.tabWasMadeInactive()" active="ctrls.NavCtrl.storyboardIsActive" data-test-key="button_storyboard" class="clickable"><div ng-if="ctrls.NavCtrl.storyboardIsActive" ng-include="\'SilverApp/views/storyboard.html\'" data-test-key="storyboard_page"></div></tab><tab id="editTab" heading="{{::\'SilverApp.edit\' | translate }}" class="clickable tourable-item--tab mode-{{ctrls.MainCtrl.modeName}}" select="ctrls.NavCtrl.tabWasMadeActive()" active="ctrls.NavCtrl.editIsActive" data-test-key="button_edit"><div ng-include="\'SilverApp/views/edit-tab.html\'" data-test-key="edit_page"></div></tab><tab id="eventsTab" ng-show="!ctrls.MainCtrl.previewMode" heading="{{::\'SilverApp.events\' | translate }}" class="clickable" select="ctrls.EventsCtrl.tabWasMadeActive()" deselect="ctrls.EventsCtrl.tabWasMadeInactive()" active="ctrls.NavCtrl.eventsIsActive" data-test-key="button_events"><div ng-if="ctrls.NavCtrl.eventsIsActive" ng-include="\'SilverApp/views/gc/events/events.html\'" data-test-key="events_page"></div></tab><tab ng-if="ctrls.NavCtrl.showNewNavigation" ng-show="!ctrls.MainCtrl.previewMode && ctrls.MainCtrl.preview" id="previewTab" heading="{{::\'SilverApp.preview\'|translate}}" class="clickable tourable-item--tab mode-{{ctrls.MainCtrl.modeName}}" select="ctrls.MainCtrl.enablePreviewMode(true)" tooltip-append-to-body="true" tooltip="{{\'SilverApp.preview\' | translate}}" active="ctrls.NavCtrl.previewIsActive" data-test-key="button_preview" disabled="ctrls.MainCtrl.inTourMode"></tab></tabset></div>'),a.put("SilverApp/views/gc/tour-menu-item.html",'<li><a ng-if="ctrls.MainCtrl.features.tour" ng-click="ctrls.MainCtrl.startTour()" data-test-key="button_open_tour" class="clickable">{{::\'SilverApp.tour\'|translate}}</a></li>'),a.put("SilverApp/views/gc/zoom-toolbar-item.html",'<li class="divider-vertical tool-icon" ng-hide="ctrls.MainCtrl.superSimple || ctrls.MainCtrl.previewMode"></li><li class="zoomSlider" ng-class="{\'zoomSlider-in-preview\': ctrls.MainCtrl.previewMode}"><rzslider rz-slider-model="ctrls.NavCtrl.zoomMin" rz-slider-floor="100" rz-slider-ceil="300" rz-slider-step="10" rz-slider-hide-limit-labels="true" rz-slider-always-show-bar="true" rz-slider-translate="ctrls.NavCtrl.changeValueToPercentage"></rzslider></li>'),a.put("SilverApp/views/header-simple.html",'<nav class="navbar navbar-default" role="navigation" ng-class="::{\'tablet-navbar-border\': ctrls.MainCtrl.isDeviceATablet()}" ng-controller="SaveCtrl"><div class="app-header-border" ng-class="::{\'app-header-border-tablet\': ctrls.MainCtrl.isDeviceATablet()}" ng-controller="ArrangeTabCtrl"></div><div class="clearfix app-topnav" ng-controller="AuthenticationCtrl"><div class="navbar-brand" ng-controller="ChangeSizeCtrl"><a ng-if="!ctrls.MainCtrl.config.isBaconV2 || ctrls.MainCtrl.isDeviceATablet()" class="clickable" ng-click="ctrls.AuthenticationCtrl.goHome()" sf-long-press="ctrls.DevCtrl.openPanel()" duration="5000" ng-class="::{\'shutterfly-logo-small\':ctrls.MainCtrl.isDeviceAPhone(), \'shutterfly-logo\':!ctrls.MainCtrl.isDeviceAPhone(), \'logo-tablet\':ctrls.MainCtrl.isDeviceATablet()}" data-test-key="logo"></a><div class="bacon-back" ng-if="::(ctrls.MainCtrl.config.isBaconV2 && ctrls.MainCtrl.isDeviceAPhone())"><a ng-if="ctrls.NavCtrl.arrangeIsActive" ng-click="ctrls.MainCtrl.promptForCover()">{{:: \'SilverApp.back\'|translate}}</a> <a ng-if="ctrls.NavCtrl.editIsActive" ng-click="ctrls.NavCtrl.pagesViewIsActive = true" class="bacon-back">{{:: \'SilverApp.back\'|translate}}</a> <a ng-if="ctrls.NavCtrl.pagesViewIsActive" ng-click="ctrls.NavCtrl.arrangeIsActive = true" class="bacon-back">{{:: \'SilverApp.back\'|translate}}</a></div><iframe ng-src="{{ctrls.AuthenticationCtrl.sessionUrl}}" width="0" height="0" frameborder="0"></iframe><iframe id="sf-sfly-auth-target" name="sf-sfly-auth-target" width="0" height="0" frameborder="0"></iframe></div><div class="navbar-text" ng-controller="UppCtrl" ng-class="{\'navbar-text-wider\':ctrls.ArrangeTabCtrl.arrangeEnabled, \'navbar-text-narrower\':ctrls.MainCtrl.superSimple, \'navbar-text-wider-still\':ctrls.MainCtrl.storyboardEnabled == true, \'navbar-text-widest\':!ctrls.MainCtrl.features.styleDialog && ctrls.MainCtrl.storyboardEnabled, \'navbar-text-tablet\':ctrls.MainCtrl.isDeviceATablet()}"><div class="project-title-wrapper" ng-class="{\'title-tablet\': ctrls.MainCtrl.isDeviceATablet()}" ng-controller="ChooseCoverPhotoCtrl" data-test-key="label_book_title" data-test-projectguid="{{ctrls.MainCtrl.project.projectGUID}}" data-test-userid="{{ctrls.MainCtrl.project.userId}}" ng-show="ctrls.MainCtrl.project">{{ctrls.MainCtrl.project.titleStr}}</div><div id="saveButton" class="book-name__save-project tablet-save" ng-if="::ctrls.MainCtrl.isDeviceATablet()"><div class="link-button" data-test-key="header_save_button" ng-click="ctrls.SaveCtrl.save()">{{::\'SilverApp.save\'|translate}}</div></div><div ng-if="::!ctrls.MainCtrl.isDeviceATablet() && !ctrls.MainCtrl.config.isBaconV2" ng-class="{\'bacon-price\': (ctrls.MainCtrl.config.isBaconV2 && ctrls.MainCtrl.isDeviceAPhone())}"><span id="saveButton" class="book-name__save-project">(<span class="link-button" data-test-key="header_save_button" ng-click="ctrls.SaveCtrl.save()">{{::\'SilverApp.save\'|translate}}</span>)</span><div id="priceControl" ng-controller="PriceCtrl" ng-show="project != null"><sf-pricing-receipt page-count="project.product.pages.length" description-id="project.product.descriptionId" is-enabled="!ctrls.OrderCtrl.orderAndInUpsellModal" book-pricing="bookPricing"></sf-pricing-receipt></div></div></div><div ng-controller="SoftRenderCompareCtrl" class="render-opacity-slider"><div class="soft-render-style"><label ng-if="ctrls.SoftRenderCompareCtrl.appState.dev.leftPage.softRenderURL ||\n                    ctrls.SoftRenderCompareCtrl.appState.dev.rightPage.softRenderURL"><span>Overlay opacity:</span><input class="render-opacity-input" type="range" min="0" max="1" step="0.1" ng-model="ctrls.SoftRenderCompareCtrl.appState.dev.softRenderOpacity">{{ctrls.SoftRenderCompareCtrl.appState.dev.softRenderOpacity}}</label></div></div><div class="navbar-text navbar-title navbar-title-edit" ng-if="ctrls.MainCtrl.isDeviceAPhone()"><span class="bacon-book-type-text" ng-if="ctrls.NavCtrl.pagesViewIsActive">{{:: \'SilverApp.pagesView.navbar.title\'|translate}}</span></div><div class="navbar-text navbar-title" sf-long-press="ctrls.DevCtrl.openPanel()" duration="5000" ng-if="::(ctrls.MainCtrl.config.isBaconV2 && ctrls.MainCtrl.isDeviceAPhone())"><span ng-if="ctrls.NavCtrl.arrangeIsActive">{{:: \'SilverApp.arrange.navbar.title\'|translate}}</span></div><div class="navbar-text navbar-title" ng-if="::(ctrls.MainCtrl.config.isBaconV2 && ctrls.MainCtrl.isDeviceAPhone())"><span ng-if="ctrls.NavCtrl.editIsActive">{{:: \'SilverApp.preview\'|translate}}</span></div><div class="navbar-nav navbar-right navbar-right-simple" ng-if="::(ctrls.MainCtrl.config.isBaconV2 && ctrls.MainCtrl.isDeviceAPhone())"><a ng-if="ctrls.NavCtrl.arrangeIsActive" ng-click="ctrls.NavCtrl.pagesViewIsActive = true" class="bacon-select bacon-next-arrange">{{:: \'SilverApp.arrange.navbar.next\'|translate}}</a></div><div class="navbar-nav navbar-right navbar-right-simple navbar-pages-next" ng-if="::(ctrls.MainCtrl.config.isBaconV2 && ctrls.MainCtrl.isDeviceAPhone())"><a ng-if="ctrls.NavCtrl.pagesViewIsActive" ng-click="ctrls.NavCtrl.enterPreview(ctrls.NavCtrl.pagesViewIsActive)" class="bacon-select bacon-next-arrange">{{:: \'SilverApp.arrange.navbar.next\'|translate}}</a></div><div class="navbar-nav navbar-right navbar-right-order" ng-if="::(ctrls.MainCtrl.config.isBaconV2 && ctrls.MainCtrl.isDeviceAPhone())"><button id="orderButton" ng-if="ctrls.NavCtrl.editIsActive" class="btn btn-primary navbar-btn order-btn order-btn--tablet order-btn--phone" ng-controller="OrderCtrl" ng-click="ctrls.OrderCtrl.order()" omniture="" linkname="Order" data-test-key="button_order">{{::\'SilverApp.order\'|translate}}</button></div><div ng-if="(ctrls.MainCtrl.isDeviceAPhone() && !ctrls.MainCtrl.config.isBaconV2) || ctrls.MainCtrl.isDeviceATablet()" class="navbar-nav navbar-right navbar-right-simple book-tool-bar help-button-dropdown" ng-class="::{\'navbar-right-simple-tablet\': ctrls.MainCtrl.isDeviceAtablet()}" ng-controller="EditTextCtrl"><li id="optionsButton" class="dropdown help-button-dropdown clickable" ng-if="ctrls.NavCtrl.arrangeIsActive && !ctrls.MainCtrl.isDeviceATablet()" style="margin-top: -6px; margin-right: 0px" dropdown="" on-toggle="ctrls.PageActionsCtrl.handlePencilToggle(open)"><a data-test-key="button_options" data-toggle="dropdown" class="tool-icon dropdown-toggle" dropdown-toggle=""><i class="icon icon-options move-menu-down"></i></a><ul class="dropdown-menu move-menu-left" ng-hide="!ctrls.PageActionsCtrl.pencilIsOpen"><li ng-if="::!ctrls.MainCtrl.isDeviceAPhone()"><a class="clickable" ng-click="ctrls.ChangeSizeCtrl.openDialog()" omniture="" linkname="Change Size" data-test-key="button_change_size_simple">{{::\'SilverApp.changeSizeMenuItem\'|translate}}</a></li><li ng-if="::!ctrls.MainCtrl.isDeviceAPhone()" class="divider"></li><li><a ng-click="ctrls.UppCtrl.showUPP()" class="clickable" omniture="" linkname="Add Photos" pagename="/@@p/arrange" data-test-key="button_add_photos_menu_simple">{{::\'SilverApp.addPhotosMenuItem\'|translate}}</a></li><li ng-if="::!ctrls.MainCtrl.isDeviceAPhone()" class="divider"></li><li ng-hide="::ctrls.MainCtrl.isDeviceAPhone()" ng-class="{\'disabled\': ctrls.PageActionsCtrl.disabledAddPages }"><a ng-click="ctrls.PageActionsCtrl.addPage()" class="clickable" omniture="" linkname="Add Page - Top Nav" data-test-key="button_add_page_menu_simple">{{::\'SilverApp.addPage\'|translate}}</a></li><li ng-class="{\'disabled\': ctrls.PageActionsCtrl.disabledMove }" ng-hide="::ctrls.MainCtrl.isDeviceAPhone()"><a ng-click="ctrls.PageActionsCtrl.movePage()" class="clickable" omniture="" linkname="Move Page" data-test-key="button_move_page_simple">{{::\'SilverApp.movePageMenuItem\'|translate}}</a></li><li ng-class="{\'disabled\': ctrls.PageActionsCtrl.disabledRemove }"><a ng-click="ctrls.PageActionsCtrl.removePage()" class="clickable" omniture="" linkname="Remove Page" data-test-key="button_remove_page_simple">{{::\'SilverApp.removePage\'|translate}}</a></li><li ng-if="::!ctrls.MainCtrl.isDeviceAPhone()" class="divider"></li><li ng-class="{\'disabled\': ctrls.MainCtrl.projectService.currentProject.product.cover.frontPage.hasNoText() }"><a ng-click="ctrls.EditTextCtrl.edit(2, -1)" class="clickable" data-test-key="button_editTitle">{{::\'SilverApp.editTitleMenuCover\'|translate}}</a></li><li ng-class="{\'disabled\': !ctrls.ImageCtrl.projectImages.length}"><a ng-if="::ctrls.MainCtrl.isDeviceAPhone()" ng-click="ctrls.ChooseCoverPhotoCtrl.selectCoverPhoto()" class="clickable" data-test-key="button_selectCoverPhoto">{{::\'SilverApp.selectCoverPhotoMenu\'|translate}}</a></li><li ng-if="::ctrls.MainCtrl.isDeviceAPhone()"><a ng-click="ctrls.MainCtrl.startOver()" class="clickable" omniture="" linkname="Start Over" pagename="/@@p/arrange" data-test-key="button_startOver">{{::\'SilverApp.startOver\'|translate}}</a></li><li ng-if="::(ctrls.MainCtrl.isDeviceAPhone() && ctrls.MainCtrl.config.isBaconV2)"><a ng-click="ctrls.NavCtrl.pagesViewIsActive = true" class="clickable" data-test-key="button_pagesView">Pages View</a></li></ul></li><li class="divider-vertical tool-icon simple-toolbar-divider" ng-if="ctrls.NavCtrl.arrangeIsActive && !ctrls.MainCtrl.isDeviceATablet()"></li><div class="preview-button detached-dropdown-button" ng-if="(ctrls.NavCtrl.arrangeIsActive || ctrls.NavCtrl.pagesViewIsActive) && !ctrls.MainCtrl.isDeviceATablet()" ng-class="{\'preview-button-pagesView\': ctrls.NavCtrl.pagesViewIsActive}"><a data-test-key="button_preview" ng-click="ctrls.NavCtrl.enterPreview(ctrls.NavCtrl.pagesViewIsActive)" ng-class="{\'btn btn-primary preview-button-pagesView\': ctrls.NavCtrl.pagesViewIsActive,\n               \'header-button\': !ctrls.NavCtrl.pagesViewIsActive}">{{::\'SilverApp.preview\'|translate}}</a></div><div class="preview-button detached-dropdown-button" ng-if="ctrls.NavCtrl.editIsActive && !ctrls.MainCtrl.isDeviceATablet()"><a data-test-key="button_exit_preview" ng-click="ctrls.NavCtrl.exitPreview()" class="header-button">{{ctrls.NavCtrl.exitPreviewText() |translate}}</a></div><div id="tabletChangeSize" class="tablet-change-size" ng-if="::ctrls.MainCtrl.isDeviceATablet()"><sf-tablet-size-options></sf-tablet-size-options></div><button id="orderButton" ng-if="::!ctrls.MainCtrl.isDeviceAPhone()" class="btn btn-primary navbar-btn order-btn order-btn--tablet" ng-controller="OrderCtrl" ng-click="ctrls.OrderCtrl.order()" omniture="" linkname="Order" data-test-key="button_order">{{::\'SilverApp.order\'|translate}}</button><li id="orderButton" ng-if="ctrls.MainCtrl.isDeviceAPhone() && !ctrls.NavCtrl.pagesViewIsActive" ng-controller="OrderCtrl" style="margin-right: 10px; float: right; margin-top: -4px"><a data-test-key="button_order" ng-click="ctrls.OrderCtrl.order()" class="tool-icon last clickable"><i class="icon icon-cart"></i></a></li></div></div></nav><sf-page-clone class="single-page-clone-wrapper" ng-style="{position: \'absolute\', top: cloneModel.top + \'px\', left: cloneModel.left + \'px\'}"><sf-simple-page ng-if="cloneModel.page && (!ctrls.MainCtrl.superSimple || ctrls.MainCtrl.isDeviceATablet())" page="cloneModel.page" width="194" height="140"></sf-simple-page><sf-simple-page ng-if="cloneModel.page && ctrls.MainCtrl.isDeviceAPhone()" page="cloneModel.page" width="97" height="70"></sf-simple-page></sf-page-clone><sf-image-clone></sf-image-clone>'),a.put("SilverApp/views/header-slideshow.html",'<nav class="navbar navbar-default" role="navigation" ng-controller="SaveCtrl"><div class="app-header-border" ng-controller="ArrangeTabCtrl"></div><div class="clearfix app-topnav" ng-controller="AuthenticationCtrl"><div ng-if="ctrls.MainCtrl.shouldShowFullScreen()" class="navbar-brand preview-button"><a class="clickable" ng-click="ctrls.MainCtrl.toggleFullScreen()" data-test-key="slideshow-fullscreen-link"><span ng-if="ctrls.MainCtrl.inFullScreenMode">{{::\'SilverApp.exitFullScreen\'|translate}}</span> <span ng-if="!ctrls.MainCtrl.inFullScreenMode">{{::\'SilverApp.fullScreen\'|translate}}</span></a><iframe ng-src="{{ctrls.AuthenticationCtrl.sessionUrl}}" width="0" height="0" frameborder="0"></iframe><iframe id="sf-sfly-auth-target" name="sf-sfly-auth-target" width="0" height="0" frameborder="0"></iframe></div><div ng-if="ctrls.MainCtrl.canOrderFromSlideshow" class="navbar-nav navbar-right navbar-right--slideshow"><button class="btn btn-primary navbar-btn order-btn order-btn--slideshow header-button" ng-controller="OrderCtrl" ng-click="ctrls.OrderCtrl.directOrder()" omniture="" linkname="Order" data-test-key="slidshow_order-btn">{{::\'SilverApp.order\'|translate}}</button></div></div></nav>'),a.put("SilverApp/views/header.html",'<nav class="navbar navbar-default" ng-controller="SaveCtrl" role="navigation"><div class="app-header-border" ng-controller="ArrangeTabCtrl"></div><div class="clearfix app-topnav" ng-controller="AuthenticationCtrl"><div ng-if="!ctrls.MainCtrl.previewMode" data-intro="{{::\'HelpOverlay.2\' | translate }}" data-position="bottom" class="navbar-brand" ng-controller="ChangeSizeCtrl" tooltip-append-to-body="true" tooltip="{{\'SilverApp.shutterflyHomePage\' | translate}}" tooltip-trigger="mouseenter"><a class="shutterfly-logo clickable" ng-click="ctrls.AuthenticationCtrl.goHome()" data-test-key="logo"></a><iframe ng-src="{{ctrls.AuthenticationCtrl.sessionUrl}}" width="0" height="0" frameborder="0"></iframe><iframe id="sf-sfly-auth-target" name="sf-sfly-auth-target" width="0" height="0" frameborder="0"></iframe></div><span ng-if="ctrls.MainCtrl.config.defaults.productMode == \'editor\' && !ctrls.MainCtrl.previewMode" class="editor-header" translate="">SilverApp.editor</span><div ng-if="ctrls.MainCtrl.previewMode && ctrls.MainCtrl.shouldShowFullScreen()" class="navbar-brand preview-button" ng-class="{\'new-nav\': ctrls.NavCtrl.showNewNavigation}" ng-controller="ChangeSizeCtrl"><a class="clickable" ng-click="ctrls.MainCtrl.toggleFullScreen()" data-test-key="slideshow-fullscreen-link"><span ng-if="ctrls.MainCtrl.inFullScreenMode">{{::\'SilverApp.exitFullScreen\'|translate}}</span> <span ng-if="!ctrls.MainCtrl.inFullScreenMode">{{::\'SilverApp.fullScreen\'|translate}}</span></a></div><div ng-if="ctrls.MainCtrl.zoom && ctrls.MainCtrl.previewMode" ng-include="\'SilverApp/views/@@p/zoom-toolbar-item.html\'" include-replace=""></div><div ng-show="!ctrls.MainCtrl.previewMode" class="navbar-text" ng-class="{\'navbar-text-wider\':ctrls.ArrangeTabCtrl.arrangeEnabled,\n                    \'navbar-text-narrower\':ctrls.MainCtrl.superSimple,\n                    \'navbar-text-wider-still\':ctrls.MainCtrl.storyboardEnabled == true,\n                    \'navbar-text-widest\':!ctrls.MainCtrl.features.styleDialog && ctrls.MainCtrl.storyboardEnabled,\n                    \'new-nav\': ctrls.NavCtrl.showNewNavigation}"><div class="project-title-wrapper" data-test-key="label_book_title" data-test-projectguid="{{ctrls.MainCtrl.project.projectGUID}}" data-test-userid="{{ctrls.MainCtrl.project.userId}}" ng-show="ctrls.MainCtrl.project">{{ctrls.MainCtrl.project.titleStr}}</div>&nbsp;<div class="status-text-header" ng-show="ctrls.MainCtrl.appState.saving"><span>|</span> <span class="last-saved">{{\'SilverApp.saving\' | translate}}</span></div><div class="status-text-header" data-test-key="label_last_saved" ng-hide="!ctrls.SaveCtrl.lastSavedDate || ctrls.MainCtrl.appState.saving"><span>|</span> <span class="last-saved">{{ctrls.SaveCtrl.lastSavedDate | date:\'mediumTime\' | postfixTranslate:\'SilverApp.lastSaved\'}}</span></div><div ng-controller="PriceCtrl" ng-show="project != null"><div ng-include="\'SilverApp/views/@@p/pricing-receipt.html\'"></div></div></div><div ng-controller="SoftRenderCompareCtrl" class="render-opacity-slider"><div class="soft-render-style"><label ng-if="ctrls.SoftRenderCompareCtrl.appState.dev.leftPage.softRenderURL ||\n                       ctrls.SoftRenderCompareCtrl.appState.dev.rightPage.softRenderURL"><span>Overlay opacity:</span><input class="render-opacity-input" type="range" min="0" max="1" step="0.1" ng-model="ctrls.SoftRenderCompareCtrl.appState.dev.softRenderOpacity">{{ctrls.SoftRenderCompareCtrl.appState.dev.softRenderOpacity}}</label></div></div><div class="navbar-nav navbar-right help-button-dropdown" ng-class="{\'new-nav\': ctrls.NavCtrl.showNewNavigation}" ng-controller="HelpOverlayCtrl"><div ng-if="ctrls.HelpOverlayCtrl.helpOverlay" class="style-info"><a data-test-key="button_info" ng-click="ctrls.HelpOverlayCtrl.showHelpOverlay()" class="tool-icon clickable"><i class="icon icon-info"></i></a></div><div class="preview-button detached-dropdown-button" ng-if="!ctrls.MainCtrl.previewMode && ctrls.MainCtrl.preview && !ctrls.NavCtrl.showNewNavigation"><a data-test-key="button_preview" ng-click="ctrls.MainCtrl.enablePreviewMode(true)" class="header-button">{{::\'SilverApp.preview\'|translate}}</a></div><div class="preview-button detached-dropdown-button" ng-class="{\'new-nav\':ctrls.NavCtrl.showNewNavigation}" ng-show="ctrls.MainCtrl.preview" ng-if="ctrls.MainCtrl.previewMode && ctrls.MainCtrl.preview"><a data-test-key="button_exit_preview" ng-click="ctrls.MainCtrl.enablePreviewMode(false)" class="header-button">{{::\'SilverApp.returnToEditFromPreview\'|translate}}</a></div><div ng-include="\'SilverApp/views/@@p/save-button.html\'" include-replace=""></div><button id="orderButton" data-intro="{{::\'HelpOverlay.4\' | translate }}" data-position="bottom" class="btn btn-primary navbar-btn order-btn header-button" ng-controller="OrderCtrl" ng-click="ctrls.OrderCtrl.order()" omniture="" linkname="Order" data-test-key="button_order">{{::\'SilverApp.order\'|translate}}</button></div></div></nav>'),a.put("SilverApp/views/idea-page-label.html",'<span ng-if="enableLabel()" tooltip-append-to-body="true" tooltip="{{\'SilverApp.ideaPageLabelTooltip\' | translate}}" tooltip-trigger="mouseenter" class="aux-page-label">{{::\'SilverApp.ideaPage\' | translate}}</span>'),a.put("SilverApp/views/image-editor.html",'<div class="image-editor {{:: \'feature-afsMode-\' + $ctrl.config.afsMode}}"><div class="image-editor-image-area"><div class="text-center image-title" data-test-key="edit_image_title">{{$ctrl.generateEditImageTitle()}}</div><div class="edit-image-container"><div class="jcrop-isolation-booth"><div class="{{$ctrl.asset.filterEffect}}" ng-style="{\'opacity\': $ctrl.fadeValueForPage()}"><img ng-src="{{$ctrl.filteredImageUrl}}" croppable="" cropping="!$ctrl.editingRedEye" max-width="{{:: $ctrl.maxImageEditorSize }}" max-height="{{:: $ctrl.maxImageEditorSize }}" model="$ctrl.model" asset="$ctrl.asset" well="$ctrl.originalAsset" reset-count="$ctrl.resetCount" on-crop="$ctrl.onCrop(crop)" on-init="$ctrl.onInit()" image-url="$ctrl.filteredImageUrl" class="editing-image" data-test-key="photo_editor_{{$ctrl.asset.projectImageId}}" data-test-photo-rotation="{{$ctrl.asset.imageAssignmentRotation}}"/><sf-red-eye-glass ng-if="$ctrl.editingRedEye" image-url="$ctrl.filteredImageUrl" image-rotation="$ctrl.asset.imageAssignmentRotation" handler-class="icon-image-editor-red-eye" on-stack-change="$ctrl.handleRedEyeRectangleAddition(dimension, rects)" on-close-ready="$ctrl.tryCloseRedEyeControl()"></sf-red-eye-glass></div></div><i data-test-key="edit_image_previous_image" class="icon-previous-page" ng-class="{disabled: $ctrl.editingRedEye}" ng-click="$ctrl.previousImage()"></i> <i data-test-key="edit_image_next_image" class="icon-next-page" ng-class="{disabled: $ctrl.editingRedEye}" ng-click="$ctrl.nextImage()"></i></div><div class="message-container message-container--center" ng-if="$ctrl.isLowResolution()"><span class="message-container__icon message-container__icon--warning message-container__icon--relative"></span> <span class="message-container__text message-container__text--warning message-container__text--nopad" data-test-key="low-resolution-warning">{{::\'SilverApp.editImage.warnings.lowResolution\'|translate}}</span></div></div><div class="image-editor-actions"><ul class="list-unstyled list-inline edit-image-changes"><li class="edit-image-change-tile red-eye text-center" ng-click="$ctrl.toggleRedEye()"><a class="icon-image-editor-red-eye" ng-class="{\'icon-image-editor-red-eye-off\': !$ctrl.editingRedEye,\n                              \'icon-image-editor-red-eye-on\': $ctrl.editingRedEye}" data-test-key="edit_image_red_eye"></a><div class="edit-image-effect-tile-title">{{::\'SilverApp.editImage.redEye\'|translate}}</div></li><li class="edit-image-change-tile rotate text-center clearfix" ng-class="{disabled: $ctrl.editingRedEye}"><a class="icon-image-editor-rotate-90-cc" data-test-key="edit_image_rotate_cc" ng-click="$ctrl.rotateCC()"></a> <a class="icon-image-editor-rotate-90-c" data-test-key="edit_image_rotate_c" ng-click="$ctrl.rotate()"></a><div class="edit-image-effect-tile-title">{{::\'SilverApp.editImage.rotate\'|translate}}</div></li></ul><ul class="list-unstyled list-inline edit-image-effects" ng-if="::$ctrl.productMode !== \'editor\'"><li ng-repeat="filter in $ctrl.supportedAfsFilters" ng-if="::$ctrl.config.afsMode != \'off\'" class="icon-image-editor-filter edit-image-effect-tile text-center {{::\'filter-\' + filter}}" data-test-key="{{::\'edit_image_filter_\' + filter}}" ng-class="{highlight: $ctrl.hasFilterApplied(filter),\n                           disabled: $ctrl.editingRedEye}" ng-click="$ctrl.applyFilter(filter)"><div class="filter-border"><img sf-priority-src="$ctrl.afsFilteredImageUrl(filter)" sf-priority="\'high\'" sf-priority-onload="src" sf-priority-watch="true" use-thumbnail="\'false\'" sf-priority-lifecycle-callbacks="\'true\'" class="{{::\'AFS-\' + filter}}"/></div><div class="edit-image-effect-tile-title">{{::\'SilverApp.editImage.filter.\' + filter|translate}}</div></li></ul><div class="edit-image-toolbar" ng-if="!$ctrl.editingRedEye"><a ng-class="{disabled: !$ctrl.canReset()}" class="btn btn-link" ng-click="$ctrl.reset()" data-test-key="edit_image_reset">{{::\'SilverApp.editImage.reset\'|translate}}</a><div class="image-toolbar-vertical-divider"></div><a class="btn btn-link btn-remove-photo" ng-click="$ctrl.remove()" data-test-key="edit_image_remove">{{::\'SilverApp.editImage.remove\'|translate}}</a></div><div class="redeye-instructions" ng-if="$ctrl.editingRedEye">{{::\'SilverApp.editImage.redEyeInstructions\'|translate}}</div></div></div>'),a.put("SilverApp/views/imperative-nonsense.html","<browser-detail-appender></browser-detail-appender>"),a.put("SilverApp/views/import-page-modal-open-with-no-project.html",'<div class="modal-width-small modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.importPage\'|translate}}</span></div><div class="modal-body"><span translate="">SilverApp.importPage.noProject</span></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.ImportPageModalCtrl.cancel()" data-test-key="button_import_page_no_project_modal_continue">{{::\'Palette.Ok\'|translate}}</button></div></div>'),a.put("SilverApp/views/import-page-modal-pages-list.html",'<ul class="pages-list" ng-if="ctrls.ImportPageModalCtrl.selectedProjectPages !== null"><li class="inline-block arrange-spread"><div class="single-page-wrapper inline-block"><div class="page-thumbnail-arrange"><sf-simple-page page="ctrls.ImportPageModalCtrl.selectedProjectFrontFillerPage" width="130" height="94" class="page-shadow"></sf-simple-page></div></div><div class="single-page-wrapper inline-block" ng-if="!page.isSpread()"><div class="page-thumbnail-arrange right-page clickable" ng-click="ctrls.ImportPageModalCtrl.selectPage(ctrls.ImportPageModalCtrl.selectedProjectPages[0])" data-test-key="arrange_page_{{::ctrls.ImportPageModalCtrl.selectedProjectPages[0].surfaceNumber}}"><sf-page-warning page="ctrls.ImportPageModalCtrl.selectedProjectPages[0]"></sf-page-warning><sf-simple-page page="ctrls.ImportPageModalCtrl.selectedProjectPages[0]" width="130" height="94" data-page-number="1" class="page-shadow"></sf-simple-page><div class="right-spread-page-number page-number-arrange"><span>1</span></div></div></div><div class="move-sibling inline-block between-pages"></div></li><li class="inline-block arrange-spread" ng-repeat="page in ctrls.ImportPageModalCtrl.selectedProjectPages" ng-if="$odd && $index < ctrls.ImportPageModalCtrl.selectedProjectPages.length - 1"><div class="single-page-wrapper inline-block" ng-class="{\'spread-page-layout\':page.isSpread()}"><div class="page-thumbnail-arrange clickable" ng-click="ctrls.ImportPageModalCtrl.selectPage(page)" data-test-key="arrange_page_{{::page.surfaceNumber}}"><sf-page-warning page="page"></sf-page-warning><div ng-class="::{\'page-loading-indicator-arrange\': !ctrls.MainCtrl.isDeviceAPhone(), \'page-loading-indicator-arrange-phone\': ctrls.MainCtrl.isDeviceAPhone()}"></div><sf-simple-page page="page" width="page.isSpread() ? 260 : 130" height="94" data-page-number="{{page.surfaceNumber}}" class="page-shadow"></sf-simple-page><div class="left-spread-page-number page-number-arrange"><span>{{::page.surfaceNumber}}</span></div><div ng-if="page.isSpread()" class="right-spread-page-number page-number-arrange"><span>{{::page.surfaceNumber + 1}}</span></div></div></div><div class="single-page-wrapper inline-block" ng-if="!page.isSpread()"><div class="page-thumbnail-arrange right-page clickable" ng-click="ctrls.ImportPageModalCtrl.selectPage(ctrls.ImportPageModalCtrl.selectedProjectPages[$index + 1])" data-test-key="arrange_page_{{::ctrls.ImportPageModalCtrl.selectedProjectPages[$index + 1].surfaceNumber}}"><sf-page-warning page="ctrls.ImportPageModalCtrl.selectedProjectPages[$index + 1]"></sf-page-warning><sf-simple-page page="ctrls.ImportPageModalCtrl.selectedProjectPages[$index + 1]" width="130" height="94" data-page-number="{{ctrls.ImportPageModalCtrl.selectedProjectPages[$index + 1].surfaceNumber}}" class="page-shadow"></sf-simple-page><div class="right-spread-page-number page-number-arrange"><span>{{::ctrls.ImportPageModalCtrl.selectedProjectPages[$index + 1].surfaceNumber}}</span></div></div></div><div class="move-sibling inline-block between-pages"></div></li><li class="inline-block arrange-spread" ng-if="ctrls.ImportPageModalCtrl.selectedProjectPages.length % 2 == 0"><div class="single-page-wrapper inline-block" ng-if="!page.isSpread()"><div class="page-thumbnail-arrange right-page clickable" ng-click="ctrls.ImportPageModalCtrl.selectPage(ctrls.ImportPageModalCtrl.selectedProjectPages[0])" data-test-key="arrange_page_{{::ctrls.ImportPageModalCtrl.selectedProjectPages[0].surfaceNumber}}"><sf-page-warning page="ctrls.ImportPageModalCtrl.selectedProjectPages[0]"></sf-page-warning><sf-simple-page page="ctrls.ImportPageModalCtrl.selectedProjectPages[0]" width="130" height="94" data-page-number="1" class="page-shadow"></sf-simple-page><div class="left-spread-page-number page-number-arrange"><span>{{ctrls.ImportPageModalCtrl.selectedProjectPages.length}}</span></div></div></div><div class="single-page-wrapper inline-block"><div class="page-thumbnail-arrange"><sf-simple-page page="ctrls.ImportPageModalCtrl.selectedProjectBackFillerPage" width="130" height="94" class="page-shadow"></sf-simple-page></div></div></li></ul>'),
a.put("SilverApp/views/import-page-modal.html",'<div class="import-page-modal modal-width-medium modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.importPage\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_importpage_modal_xclose" ng-click="ctrls.ImportPageModalCtrl.cancel()"></i></div><div class="modal-section select-project" ng-show="ctrls.ImportPageModalCtrl.currentSection === \'selectProject\'"><div class="text-container"><p>{{::\'SilverApp.importPage.description\'|translate}}</p><p>{{::ctrls.ImportPageModalCtrl.projects.length | postfixTranslate:\'SilverApp.importPage.selectBook\'}}</p></div><div class="scroll-container"><ul><li ng-repeat="project in ::ctrls.ImportPageModalCtrl.projects" class="project-item"><img ng-src="{{::project.url}}" width="100" height="100" ng-class="thumb"><div class="details"><p class="title" sf-truncate="" text="project.title" max-lines="2" line-pixel-height="20"></p><p class="date">{{::project.updtime}}</p><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.ImportPageModalCtrl.selectProject(project)" data-test-key="select_project_button">{{::\'SilverApp.select\'|translate}}</button></div></li></ul></div></div><div class="modal-section select-page" ng-show="ctrls.ImportPageModalCtrl.currentSection === \'selectPage\'"><div class="text-container"><p>{{ctrls.ImportPageModalCtrl.selectedProjectJSON.title|postfixTranslate:\'SilverApp.importPage.selectPageFrom\'}} (<a ng-click="ctrls.ImportPageModalCtrl.previous()">{{::\'SilverApp.importPage.chooseDifferentBook\'|translate}}</a>)</p></div><div class="scroll-container"><div ng-include="\'SilverApp/views/import-page-modal-pages-list.html\'"></div></div></div><div class="modal-section confirm-import" ng-show="ctrls.ImportPageModalCtrl.currentSection === \'confirmImport\'"><div class="text-container"><p>{{ctrls.ImportPageModalCtrl.selectedProjectJSON.title|postfixTranslate:\'SilverApp.importPage.insertPageFrom\'}} (<a ng-click="ctrls.ImportPageModalCtrl.previous()">{{::\'SilverApp.importPage.chooseDifferentPage\'|translate}}</a>)</p><div class="options-container" ng-if="ctrls.NavCtrl.selectedPage.surfaceNumber > 1"><div class="share-radio clickable" btn-radio="\'{{ctrls.ImportPageModalCtrl.IMPORT_AFTER}}\'" ng-model="ctrls.ImportPageModalCtrl.selectedImportLocation" ng-init="ctrls.ImportPageModalCtrl.selectedImportLocation = ctrls.ImportPageModalCtrl.IMPORT_AFTER"><div class="share-text" data-test-key="radio_addpages_after">{{ctrls.NavCtrl.selectedPage.surfaceNumber | postfixTranslate:\'SilverApp.importPage.option.after\'}}</div></div><div class="share-radio clickable" btn-radio="\'{{ctrls.ImportPageModalCtrl.IMPORT_BEFORE}}\'" ng-model="ctrls.ImportPageModalCtrl.selectedImportLocation"><div class="share-text" data-test-key="radio_addpages_after">{{ctrls.NavCtrl.selectedPage.surfaceNumber | postfixTranslate:\'SilverApp.importPage.option.before\'}}</div></div><div class="share-radio clickable" btn-radio="\'{{ctrls.ImportPageModalCtrl.IMPORT_END}}\'" ng-model="ctrls.ImportPageModalCtrl.selectedImportLocation"><div class="share-text" data-test-key="radio_addpages_after">{{::\'SilverApp.importPage.option.end\'|translate}}</div></div></div><div class="options-container" ng-if="ctrls.NavCtrl.selectedPage.surfaceNumber <= 1"><div class="share-radio clickable" btn-radio="\'{{ctrls.ImportPageModalCtrl.IMPORT_BEGINNING}}\'" ng-model="ctrls.ImportPageModalCtrl.selectedImportLocation" ng-init="ctrls.ImportPageModalCtrl.selectedImportLocation = ctrls.ImportPageModalCtrl.IMPORT_BEGINNING"><div class="share-text" data-test-key="radio_addpages_after">{{::\'SilverApp.importPage.option.beginning\'|translate}}</div></div><div class="share-radio clickable" btn-radio="\'{{ctrls.ImportPageModalCtrl.IMPORT_END}}\'" ng-model="ctrls.ImportPageModalCtrl.selectedImportLocation"><div class="share-text" data-test-key="radio_addpages_after">{{::\'SilverApp.importPage.option.end\'|translate}}</div></div></div><sf-simple-page page="ctrls.ImportPageModalCtrl.selectedPage" width="ctrls.ImportPageModalCtrl.selectedPage.isSpread() ? 260 : 130" height="94" data-page-number="{{ctrls.ImportPageModalCtrl.selectedPage.surfaceNumber}}" class="selected-page"></sf-simple-page><div class="clearfix"></div></div><div class="text-container spread-note" ng-if="!ctrls.ImportPageModalCtrl.selectedPage.isSpread()"><p>{{::\'SilverApp.importPage.spreadNote\'|translate}}</p></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.ImportPageModalCtrl.importPage()" data-test-key="button_importpage_modal_ok">{{::\'SilverApp.importPage.button\'|translate}}</button></div></div></div>'),a.put("SilverApp/views/inline-order-dialog-addressing.html",'<div class="inline-order-dialog-address"><span class="modal-header-title" style="padding-bottom:5px">Shipping Information</span> <span class="event-dialog-text">Bart Simpson, 4410 E Cotton Center Blvd, Phoenix, AZ 85040</span> <span class="event-dialog-text" style="padding-top:5px">Delivery Options and Arrival Dates</span> <span class="inline-order-dialog-delivery-method-text">Shutterfly will choose the best shipping method for your selected delivery date.</span><div class="form-group"><div class="share-radio clickable" btn-radio="\'{{ctrls.OrderAdressingCtrl.ECONOMY}}\'" ng-model="ctrls.OrderAdressingCtrl.selectedShipping"><div class="share-text">Economy - $4.99</div></div><div class="share-radio clickable" btn-radio="\'{{ctrls.OrderAdressingCtrl.STANDARD}}\'" ng-model="ctrls.OrderAdressingCtrl.noselectedShipping"><div class="share-text">Standard - $6.99</div></div><div class="share-radio clickable" btn-radio="\'{{ctrls.OrderAdressingCtrl.EXPEDITED}}\'" ng-model="ctrls.OrderAdressingCtrl.waynoselectedShipping"><div class="share-text">Expedited - $9.99</div></div></div></div><div style="height:5px"></div><div class="inline-order-dialog-address"><span class="modal-header-title">Payment Information</span><div class="paymentMethod"><div><div class="payment-cc"><span class="inline-order-visa">************1111 - Expires 10/2017</span></div></div></div><div class="contactInfo"><div id="billingAddress"><div><address class="inline-order-address"><span class="address-name">Homer Simpson<br></span> 123 Fake St, Springfield, USA 85233<br/>4083566098</address></div></div></div></div>'),a.put("SilverApp/views/inline-order-dialog-billing.html",'<span class="modal-header-title">Order Information</span><div style="margin-left:8px; margin-top: 5px"><div class="receipt-row"><div class="receipt-item-description" data-test-key="receipt_item_{{component.sku}}{{dataTestKeySuffix[$index]}}">20-page 10x10 Book</div><div class="receipt-item-price" ng-class="{strike: component.totalSalePrice != component.totalOrigPrice}" data-test-key="receipt_item_price_{{component.sku}}{{dataTestKeySuffix[$index]}}">$29.99</div></div><div class="receipt-row"><div class="receipt-item-description" data-test-key="receipt_item_{{component.sku}}{{dataTestKeySuffix[$index]}}">Hard Photo Cover</div><div class="receipt-item-price" ng-class="{strike: component.totalSalePrice != component.totalOrigPrice}" data-test-key="receipt_item_price_{{component.sku}}{{dataTestKeySuffix[$index]}}">$20.00</div></div><div class="receipt-row" style="margin-bottom: 10px"><div class="receipt-item-description" data-test-key="receipt_item_{{component.sku}}{{dataTestKeySuffix[$index]}}">Standard Layflat</div><div class="receipt-item-price" ng-class="{strike: component.totalSalePrice != component.totalOrigPrice}" data-test-key="receipt_item_price_{{component.sku}}{{dataTestKeySuffix[$index]}}">$25.00</div></div><div class="receipt-row"><div class="receipt-item-description" data-test-key="receipt_item_{{component.sku}}{{dataTestKeySuffix[$index]}}">Tax</div><div class="receipt-item-price" ng-class="{strike: component.totalSalePrice != component.totalOrigPrice}" data-test-key="receipt_item_price_{{component.sku}}{{dataTestKeySuffix[$index]}}">$6.97</div></div><div class="receipt-row"><div class="receipt-item-description" data-test-key="receipt_item_{{component.sku}}{{dataTestKeySuffix[$index]}}">Shipping</div><div class="receipt-item-price" ng-class="{strike: component.totalSalePrice != component.totalOrigPrice}" data-test-key="receipt_item_price_{{component.sku}}{{dataTestKeySuffix[$index]}}">$4.99</div></div><div class="receipt-row"><div class="receipt-item-description" data-test-key="receipt_item_{{component.sku}}{{dataTestKeySuffix[$index]}}"><strong>Total</strong></div><div class="receipt-item-price" ng-class="{strike: component.totalSalePrice != component.totalOrigPrice}" data-test-key="receipt_item_price_{{component.sku}}{{dataTestKeySuffix[$index]}}"><strong>$85.96</strong></div></div></div>'),a.put("SilverApp/views/inline-order-dialog.html",'<div class="modal-width-medium modal-content" style="height:465px; width:750px"><div class="modal-header"><span class="modal-header-title">Order</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" ng-click="ctrls.InlineOrderCtrl.dismiss()"></i></div><div class="modal-body" style="height:350px"><div ng-if="!ctrls.InlineOrderCtrl.orderConfirmation" class="inline-order-dialog-left-pane"><order-addressing></order-addressing></div><div ng-if="!ctrls.InlineOrderCtrl.orderConfirmation" class="inline-order-dialog-right-pane"><order-billing>Billing Information</order-billing></div><div style="padding-left:200px" ng-if="ctrls.InlineOrderCtrl.orderConfirmation"><span class="modal-header-title">Your order is complete!</span> <span class="event-dialog-text" style="padding-top:5px; padding-bottom: 5px">Order confirmation number: 555-1212-2920082</span> <img style="width: 350px" src="http://officialhuskylovers.com/wp-content/uploads/2015/05/puppy-dog-eyes1.jpg"></div></div><div class="modal-footer"><button ng-if="!ctrls.InlineOrderCtrl.orderConfirmation" class="btn btn-default btn-primary pull-right" ng-click="ctrls.InlineOrderCtrl.order()">Place order</button> <button ng-if="ctrls.InlineOrderCtrl.orderConfirmation" class="btn btn-default btn-primary pull-right" ng-click="ctrls.InlineOrderCtrl.dismiss()">Continue shopping</button></div></div>'),a.put("SilverApp/views/inline-red-eye-glass.html",'<div><div id="redEyeZoomedImage"><div id="redEyeGlass" ng-class="{\'undoable\':history.length > 0}"><img id="redEyeButtonMap" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" usemap="#redEyeToolMapArea"/><map id="redEyeToolMap" name="redEyeToolMapArea"><area id="redEyeUndo" ng-if="history.length > 0" ng-click="undo()" shape="poly" coords="{{undoImageMapCoords}}" href="javascript:void(0);" onclick="return false"><area id="redEyeApply" ng-click="apply()" shape="poly" coords="{{applyImageMapCoords}}" href="javascript:void(0);" onclick="return false"></map></div></div><img id="redeyeImgPreloader" style="position: absolute; top:-4000px; left:-4000px"></div>'),a.put("SilverApp/views/match-menu-items.html",'<li ng-class="{disabled: !ctrls.CustomizeCtrl.canMatch}"><a class="clickable" data-test-key="button_match_widest" ng-click="ctrls.CustomizeCtrl.matchWidest()">{{::\'SilverApp.matchWidestMenuItem\'|translate}}</a></li><li ng-class="{disabled: !ctrls.CustomizeCtrl.canMatch}"><a data-test-key="button_match_narrowest" class="clickable" ng-click="ctrls.CustomizeCtrl.matchNarrowest()">{{::\'SilverApp.matchNarrowestMenuItem\'|translate}}</a></li><li class="divider"></li><li ng-class="{disabled: !ctrls.CustomizeCtrl.canMatch}"><a data-test-key="button_match_tallest" class="clickable" ng-click="ctrls.CustomizeCtrl.matchTallest()">{{::\'SilverApp.matchTallestMenuItem\'|translate}}</a></li><li ng-class="{disabled: !ctrls.CustomizeCtrl.canMatch}"><a class="clickable" data-test-key="button_match_shortest" ng-click="ctrls.CustomizeCtrl.matchShortest()">{{::\'SilverApp.matchShortestMenuItem\'|translate}}</a></li><li class="divider"></li><li ng-class="{disabled: !ctrls.CustomizeCtrl.canMatch}"><a data-test-key="button_match_width_and_height" class="clickable" ng-click="ctrls.CustomizeCtrl.matchBoth()">{{::\'SilverApp.matchWidthAndHeightMenuItem\'|translate}}</a></li>'),a.put("SilverApp/views/missing-images-warning.html",'<div class="modal-width-small modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.missingImages.title\' | translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_modal_xclose" ng-click="ctrls.SimpleModalCtrl.cancel()"></i></div><div class="modal-body"><span ng-bind-html="::\'SilverApp.missingImages.message\' | translate"></span> <span>{{:: ctrls.SimpleModalCtrl.data.pageNumbers}}</span></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.SimpleModalCtrl.ok()" data-test-key="button_modal_ok">{{::\'SilverApp.Ok\'|translate}}</button></div></div>'),a.put("SilverApp/views/move-page-modal.html",'<div class="modal-width-small modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.movePage\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_movepage_modal_xclose" ng-click="ctrls.MovePageModalCtrl.cancel()"></i></div><form class="form-horizontal" role="form"><div class="modal-body"><div class="form-group"><div class="col-sm-12"><ul class="list-inline"><li class="pull-left"><label for="moveDirection" class="control-label normal-label">{{::\'SilverApp.moveThisPage\'|translate}}</label></li><li class="col-xs-5"><select id="moveDirection" data-test-key="button_movepage_modal_movedir" class="form-control" ng-model="ctrls.MovePageModalCtrl.moveDirection" ng-options="dir.label for dir in ctrls.MovePageModalCtrl.moveDirections" ng-change="ctrls.MovePageModalCtrl.disableInvalidSpreadTargets()"></select></li><li class="col-xs-3"><select data-test-key="button_movepage_modal_moverelatedto" class="form-control" ng-model="ctrls.MovePageModalCtrl.pageIndexToMove" name="pageToMove"><option ng-repeat="pageData in ctrls.MovePageModalCtrl.movablePages" ng-disabled="!pageData.enabled || pageData.invalidSpreadTarget" value="{{$index}}" ng-selected="ctrls.MovePageModalCtrl.pageIndexToMove == $index">{{pageData.label}}</option></select></li></ul></div></div></div></form><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.MovePageModalCtrl.ok()" data-test-key="button_movepage_modal_ok">{{::\'SilverApp.move.button\'|translate}}</button></div></div>'),a.put("SilverApp/views/no-cookies.html",'<div style="background-color: white" ng-controller="UnsupportedBrowserCtrl"><div style="margin-left: 20px"><div><div><a class="shutterfly-logo"></a></div><h3>No Cookies</h3><div id="browserWarningText">We use cookies to provide you with the best experience in creating your products. If you would like to continue making this product, change your browser settings to enable Cookies and Website data.<br/></div></div></div></div>'),a.put("SilverApp/views/nomore-photos-canbe-added-modal.html",'<div class="modal-width-small modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.NoMorePhotosCanBeAdded\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_nomorephoto_modal_xclose" ng-click="ctrls.SimpleModalCtrl.cancel()"></i></div><div class="modal-body" translate="">{{ ctrls.SimpleModalCtrl.data.maxAllowedPhotos | postfixTranslate:\'SilverApp.NoMorePhotosCanBeAddedMoreDescription\' }}</div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.SimpleModalCtrl.ok()" data-test-key="button_nomorephoto_modal_ok">{{::\'SilverApp.Ok\'|translate}}</button></div></div>'),a.put("SilverApp/views/open-on-desktop-warning.html",'<div class="modal-width-small modal-content"><div class="modal-header"><span class="modal-header-title"><span>{{::\'SilverApp.openOnDesktopWarningDialog.simpleTitle\'|translate}}</span></span></div><div class="modal-body"><div><p>{{::\'SilverApp.openOnDesktopWarningDialog.message1\'|translate}}</p></div></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" data-test-key="button_openOnDesktop_modal_ok" ng-click="ctrls.ShowOpenOnDesktopCtrl.exitToMyProjects()">{{::\'SilverApp.Ok\'|translate}}</button></div></div>'),a.put("SilverApp/views/pages-menu.html",'<li id="pagesMenu" class="dropdown clickable" ng-hide="ctrls.MainCtrl.superSimple" dropdown=""><a class="dropdown-toggle" data-toggle="dropdown" data-test-key="button_pages_dropdown" dropdown-toggle=""><span>{{::\'SilverApp.pages\'|translate}}</span> <span class="caret"></span></a><ul class="dropdown-menu"><div ng-include="\'SilverApp/views/@@p/add-pages-menu-items.html\'" include-replace=""></div><li ng-if="ctrls.MainCtrl.customize" ng-hide="ctrls.MainCtrl.superSimple || ctrls.NavCtrl.arrangeIsActive"><a ng-hide="ctrls.CustomizeCtrl.isCustomizing()" ng-click="ctrls.CustomizeCtrl.toggleCustomizeActiveMode()" omniture="" linkname="Pages:Customizepage" data-test-key="menu_advance_edit" class="clickable">{{::\'SilverApp.advanceEdit\'|translate}}<div ng-if="ctrls.MainCtrl.allowHotKeys && ctrls.MainCtrl.isMac" class="keyboard-shortcut pull-right">{{::\'SilverApp.hotkey.customize.mac\'|translate}}</div><div ng-if="ctrls.MainCtrl.allowHotKeys && !ctrls.MainCtrl.isMac" class="keyboard-shortcut pull-right">{{::\'SilverApp.hotkey.customize.windows\'|translate}}</div></a> <a ng-hide="!ctrls.CustomizeCtrl.isCustomizing()" ng-click="ctrls.CustomizeCtrl.toggleCustomizeActiveMode()" omniture="" linkname="Pages:Exitcustomizepage" data-test-key="menu_advance_edit" class="clickable">{{::\'SilverApp.exitAdvancedEdit\'|translate}}<div ng-if="ctrls.MainCtrl.allowHotKeys && ctrls.MainCtrl.isMac" class="keyboard-shortcut pull-right">{{::\'SilverApp.hotkey.customize.mac\'|translate}}</div><div ng-if="ctrls.MainCtrl.allowHotKeys && !ctrls.MainCtrl.isMac" class="keyboard-shortcut pull-right">{{::\'SilverApp.hotkey.customize.windows\'|translate}}</div></a></li><div ng-include="\'SilverApp/views/@@p/dupe-page-menu-item.html\'" include-replace=""></div><li ng-class="{disabled: !ctrls.NavCtrl.selectedPage.layout.isFlippable || !ctrls.NavCtrl.selectedPage.isFlippingAllowed }"><a ng-click="ctrls.NavCtrl.selectedPage.isFlippingAllowed && ctrls.NavCtrl.selectedPage.layout.isFlippable && ctrls.PageActionsCtrl.flipPage()" class="clickable" omniture="" linkname="Pages:Flip page" data-test-key="button_flip_page">{{::\'SilverApp.flipPage\'|translate}}</a></li><div ng-include="\'SilverApp/views/@@p/get-design-elements-menu-item.html\'" ng-if="ctrls.MainCtrl.features.extendedPalette" include-replace=""></div><li ng-controller="TextSettingsCtrl" ng-show="ctrls.MainCtrl.features.textSettings && !ctrls.CustomizeCtrl.isCustomizing()"><a class="clickable" ng-click="ctrls.TextSettingsCtrl.openDialog()" omniture="" linkname="Project:Settings Text" data-test-key="button_text_settings">{{::\'SilverApp.textSettingsMenuItem\'|translate}}</a></li><li ng-controller="ApplyToOtherPagesCtrl" ng-show="ctrls.ApplyToOtherPagesCtrl.config.features.applyToOtherPages" ng-class="{\'disabled\':ctrls.ApplyToOtherPagesCtrl.handleCoverPage()}"><a ng-click="ctrls.ApplyToOtherPagesCtrl.openDialog()" class="clickable" omniture="" linkname="Project:ApplyToOtherPagesCtrl" translate="">SilverApp.applyOtherPageButtonMenuItem</a></li><li class="divider"></li><li ng-class="{disabled: !ctrls.PhotoActionsCtrl.canRemoveAllPhotos()}"><a class="clickable" omniture="" linkname="Remove All Photos - Top Nav" ng-click="ctrls.PhotoActionsCtrl.removeAllPhotosFromBook()" omniture="" linkname="Pages:Remove placed photos" data-test-key="button_remove_all_photos_menu">{{::\'SilverApp.clearAllPhotosFromPages\'|translate}}</a></li><li ng-controller="EmbellishmentActionsCtrl" ng-if="ctrls.MainCtrl.config.features.removeAllEmbellishments === true" ng-class="{disabled: !ctrls.EmbellishmentActionsCtrl.canRemoveAllEmbellishments()}"><a class="clickable" omniture="" linkname="Remove All Embellishments - Top Nav" ng-click="ctrls.EmbellishmentActionsCtrl.openDialog()" omniture="" linkname="Pages:Remove all embellishments" data-test-key="button_remove_all_embellishments_menu">{{::\'SilverApp.removeStickers.menuItem\'|translate}}</a></li><li class="divider"></li><li ng-if="ctrls.MainCtrl.customize" ng-hide="ctrls.MainCtrl.superSimple || ctrls.NavCtrl.arrangeIsActive" ng-class="{\'disabled\': (!ctrls.CustomizeCtrl.canAddTextArea || (ctrls.NavCtrl.selectedPage == ctrls.NavCtrl.spinePage))}"><a omniture="" linkname="Pages:Add Text box - Top Nav" class="clickable" ng-click="!ctrls.MainCtrl.inTourMode && ctrls.CustomizeCtrl.addTextArea()" data-test-key="button_add_text_menu">{{::\'SilverApp.addText\'|translate}}<div ng-if="ctrls.MainCtrl.allowHotKeys && ctrls.MainCtrl.isMac" class="keyboard-shortcut pull-right">{{::\'SilverApp.hotkey.addtext.mac.menu\'|translate}}</div><div ng-if="ctrls.MainCtrl.allowHotKeys && !ctrls.MainCtrl.isMac" class="keyboard-shortcut pull-right">{{::\'SilverApp.hotkey.addtext.windows.menu\'|translate}}</div></a></li><li ng-if="ctrls.MainCtrl.customize && ctrls.MainCtrl.features.photoArea" ng-hide="ctrls.MainCtrl.superSimple || ctrls.NavCtrl.arrangeIsActive" ng-class="{\'disabled\': (!ctrls.CustomizeCtrl.canAddPhotoArea || (ctrls.NavCtrl.selectedPage == ctrls.NavCtrl.spinePage))}"><a omniture="" linkname="Pages:Add Photo box - Top Nav" class="clickable" ng-click="!ctrls.MainCtrl.inTourMode && ctrls.CustomizeCtrl.addPhotoArea()" data-test-key="button_add_text_menu">{{::\'SilverApp.addPhoto\'|translate}}<div ng-if="ctrls.MainCtrl.allowHotKeys && ctrls.MainCtrl.isMac" class="keyboard-shortcut pull-right">{{::\'SilverApp.hotkey.addphoto.mac.menu\'|translate}}</div><div ng-if="ctrls.MainCtrl.allowHotKeys && !ctrls.MainCtrl.isMac" class="keyboard-shortcut pull-right">{{::\'SilverApp.hotkey.addphoto.windows.menu\'|translate}}</div></a></li><li><a ng-click="ctrls.UppCtrl.showUPP()" class="clickable" omniture="" linkname="Pages:Add Photos" data-test-key="button_add_photos_menu">{{::\'SilverApp.addPhotosMenuItem\'|translate}}<div ng-if="ctrls.MainCtrl.allowHotKeys && ctrls.MainCtrl.isMac" class="keyboard-shortcut pull-right">{{::\'SilverApp.hotkey.addphotos.mac.menu\'|translate}}</div><div ng-if="ctrls.MainCtrl.allowHotKeys && !ctrls.MainCtrl.isMac" class="keyboard-shortcut pull-right">{{::\'SilverApp.hotkey.addphotos.windows.menu\'|translate}}</div></a></li><div ng-include="\'SilverApp/views/@@p/spread-menu-item.html\'" include-replace=""></div><li class="divider" ng-if="ctrls.MainCtrl.saveJPG"></li><li><a class="clickable" ng-if="ctrls.MainCtrl.saveJPG" ng-click="ctrls.SaveJpgCtrl.savePage()" omniture="" linkname="Save JPG" data-test-key="button_save_jpg">{{::\'SilverApp.saveJPG\'|translate}}...</a></li></ul></li>'),a.put("SilverApp/views/pb/add-page-toolbar-item.html",'<li id="addpageButton" ng-hide="ctrls.MainCtrl.superSimple" class="tourable-item--toolbar" tooltip-append-to-body="false" tooltip="{{::\'SilverApp.addPages\' | translate}}" tooltip-trigger="mouseenter"><a ng-click="!ctrls.MainCtrl.inTourMode && ctrls.PageActionsCtrl.addPages()" ng-class="{\'disabled\': ctrls.PageActionsCtrl.disabledAddPages}" omniture="" linkname="{{ctrls.PageActionsCtrl.getOmniTrackLinkForAddPages(ctrls.NavCtrl.arrangeIsActive?\'arrange\':(ctrls.CustomizeCtrl.isCustomizing()?\'advanced-edit\':\'edit\'), \'menubar\', \'button\')}}" data-test-key="button_add_page" class="tool-icon clickable"><i class="icon icon-add-page" ng-class="{\'icon-add-page-disabled disabled\': ctrls.PageActionsCtrl.disabledAddPages}"></i> <span ng-class="{\'disabled\': ctrls.PageActionsCtrl.disabledAddPages}" class="toolbar-button-text">{{::\'SilverApp.addPages\'|translate}}</span></a></li>'),a.put("SilverApp/views/pb/add-pages-menu-items.html",'<li ng-class="{\'disabled\': ctrls.PageActionsCtrl.disabledAddPages }"><a ng-click="ctrls.PageActionsCtrl.addPages()" class="clickable" omniture="" linkname="Pages:Add pages" data-test-key="button_add_pages_menu">{{::\'SilverApp.addPagesMenuItem\'|translate}}</a></li><li ng-class="{\'disabled\': ctrls.PageActionsCtrl.disabledRemove }"><a ng-click="ctrls.PageActionsCtrl.removePage()" class="clickable" omniture="" linkname="Pages:Remove page" data-test-key="button_remove_page">{{::\'SilverApp.removePage\'|translate}}</a></li><li ng-class="{\'disabled\': ctrls.PageActionsCtrl.disabledMove }"><a ng-click="ctrls.PageActionsCtrl.movePage()" class="clickable" omniture="" linkname="Pages:Move page" data-test-key="button_move_page">{{::\'SilverApp.movePageMenuItem\'|translate}}</a></li><li ng-show="ctrls.PageActionsCtrl.config.features.importPage" ng-class="{\'disabled\': ctrls.PageActionsCtrl.disabledImportPage}"><a class="clickable" ng-controller="ImportPageModalCtrl" ng-click="ctrls.ImportPageModalCtrl.open()" omniture="" linkname="Pages:Import page" data-test-key="button_import_page">{{::\'SilverApp.importPageMenuItem\'|translate}}</a></li><li class="divider"></li>'),a.put("SilverApp/views/pb/add-photos-modal.html",'<div ng-class="{\'modal-width-medium-small-2\': !ctrls.MainCtrl.superSimple, \'modal-width-small-for-simple\': ctrls.MainCtrl.superSimple, \'modal-content\': true}"><div class="modal-header"><p class="modal-header-title">{{::\'SilverApp.createYourStory\'|translate}}</p><i type="button" class="icon-dialog-close icon-dialog-close-add-photos" data-dismiss="modal" data-test-key="button_addphotos_modal_xclose" ng-click="ctrls.SimpleModalCtrl.cancel()"></i></div><div class="modal-body"><p class="modal-text">{{::\'SilverApp.createYourStoryBooks\'|translate}}</p></div><div><i class="icon-add-photos-pb"></i></div><div class="modal-footer"><a class="btn btn-link" ng-click="ctrls.SimpleModalCtrl.cancel()" data-test-key="button_addphoto_modal_cancel" translate="">SilverApp.skip</a> <button type="button" class="btn btn-default btn-primary" ng-click="ctrls.SimpleModalCtrl.ok()" omniture="" linkname="Add photos" data-test-key="button_addphotos_modal_ok">{{::\'SilverApp.addPhotos\'|translate}}</button></div></div>'),a.put("SilverApp/views/pb/advocate-browser-upgrade.html",'<div class="advocate-upgrade" ng-controller="AdvocateBrowserUpgradeCtrl"><div><a href="https://www.google.com/intl/en/chrome/browser/" target="_blank" title="Download the latest version of Chrome" class="icon-update-chrome"></a> <a href="http://en.www.mozilla.com/en/firefox/new/" target="_blank" title="Download the latest version of Firefox" class="icon-update-firefox"></a> <a href="http://windows.microsoft.com/en-us/internet-explorer/download-ie" target="_blank" title="Download the latest version of Internet Explorer" class="icon-update-explorer"></a></div><div><h3>{{::\'SilverApp.browser.unsupported\'|translate}}</h3><div class="advocate-content">{{::\'SilverApp.browser.unsupported.content\'|translate}}<p class="advocate-continue" ng-click="ctrls.AdvocateBrowserUpgradeCtrl.goBack()">{{::\'SilverApp.browser.continue\'|translate}}</p></div></div></div>'),a.put("SilverApp/views/pb/change-size.html",'<div ng-class="{\'modal-width-medium-large\': !ctrls.MainCtrl.superSimple, \'modal-width-medium\': ctrls.MainCtrl.superSimple, \'modal-content\': true}"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.changeSizeTitle\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_changesize_modal_xclose" ng-click="ctrls.ChangeSizeCtrl.cancel()"></i></div><div class="modal-body"><div class="size-options-group"><div class="inline-block size-option" ng-repeat="option in ctrls.ChangeSizeCtrl.sizeOptions" ng-click="ctrls.ChangeSizeCtrl.select(option.size)" data-test-key="size_option_{{option.size}}"><div class="{{(option.size == ctrls.ChangeSizeCtrl.selectedSize) ? option.selectedAsset : option.asset}}"></div><div class="size-option-text">{{option.coverOption | translate}}</div><div><span class="size-option-price">{{::\'SilverApp.from\'|translate}}</span> <span class="{{ctrls.ChangeSizeCtrl.origPriceStyling(option)}}">{{option.origPrice | currency}}</span> <span class="{{ctrls.ChangeSizeCtrl.salePriceStyling(option)}}">{{option.salePrice | currency}}</span></div><div class="{{ctrls.ChangeSizeCtrl.salePriceStyling(option)}}">{{ctrls.ChangeSizeCtrl.savings(option) | postfixTranslate:\'SilverApp.savings\'}}</div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.ChangeSizeCtrl.changeSize()" data-test-key="button_changesize_modal_ok">{{::\'SilverApp.changeSize\'|translate}}</button></div></div>'),a.put("SilverApp/views/pb/dupe-page-menu-item.html",'<li ng-class="{\'disabled\': ctrls.PageActionsCtrl.disabledDupe }"><a ng-click="ctrls.PageActionsCtrl.dupePage()" class="clickable" omniture="" linkname="Pages:Duplicate page" data-test-key="button_dupe_page">{{::\'SilverApp.duplicatePage\'|translate}}</a></li>'),a.put("SilverApp/views/pb/get-design-elements-menu-item.html",'<li><a ng-click="ctrls.PaletteCtrl.showExtendedPalette()" class="clickable" omniture="" linkname="Pages:Get design elements" data-test-key="button_get_design_elements">{{::\'SilverApp.getDesignElements\'|translate}}</a></li>'),a.put("SilverApp/views/pb/layer-menu-items.html",'<li ng-class="{disabled: !ctrls.CustomizeCtrl.canLayerForward}"><a class="clickable" ng-click="ctrls.CustomizeCtrl.layerFront()" class="clickable" data-test-key="button_layer_front">{{::\'SilverApp.layerBringToFrontMenuItem\'|translate}}</a></li><li ng-class="{disabled: !ctrls.CustomizeCtrl.canLayerBackward}"><a class="clickable" ng-click="ctrls.CustomizeCtrl.layerBack()" data-test-key="button_layer_back">{{::\'SilverApp.layerSendToBackMenuItem\'|translate}}</a></li><li ng-class="{disabled: !ctrls.CustomizeCtrl.canLayerForward}"><a class="clickable" ng-click="ctrls.CustomizeCtrl.layerForward()" data-test-key="button_layer_forward">{{::\'SilverApp.layerBringForwardMenuItem\'|translate}}</a></li><li ng-class="{disabled: !ctrls.CustomizeCtrl.canLayerBackward}"><a class="clickable" ng-click="ctrls.CustomizeCtrl.layerBackward()" data-test-key="button_layer_backward">{{::\'SilverApp.layerSendBackwardMenuItem\'|translate}}</a></li>'),a.put("SilverApp/views/pb/pages-tab.html",'<tab class="clickable" heading="{{\'Book.Palette.pages\' | translate}}" data-test-key="tab_pages" active="true"><div class="clearfix"><div ng-include="\'Palette/views/@@p/pages.html\'" include-replace=""></div></div></tab>'),a.put("SilverApp/views/pb/path-switch-menu-item.html",'<li><a ng-if="ctrls.MainCtrl.simpleMode" data-test-key="button_switchToCustom" ng-click="ctrls.MainCtrl.switchToSimpleMode(false)">{{::\'SilverApp.switchToCustomPath\'|translate}}</a></li><li><a ng-if="!ctrls.MainCtrl.simpleMode" data-test-key="button_switchToCustom" ng-click="ctrls.MainCtrl.switchToSimpleMode(true)">{{::\'SilverApp.switchToSimplePath\'|translate}}</a></li>'),a.put("SilverApp/views/pb/preview.html",'<div class="edit-tab single-palette" ng-class="{\'edit-tab--inpreview\': !ctrls.MainCtrl.isDeviceATablet() || (ctrls.MainCtrl.isDeviceATablet() && !ctrls.MainCtrl.superSimple)}" ng-controller="EditTabCtrl"><div class="entire-surface-area entire-surface-area-preview" ng-click="ctrls.CustomizeCtrl.deselectAll()" ng-controller="ImageCtrl"><div ng-include="\'SilverApp/views/@@p/summary.html\'" include-replace="" ng-if="ctrls.NavCtrl.showingSummary && !ctrls.MainCtrl.superSimple"></div><div ng-include="\'SilverApp/views/@@p/surface.html\'" include-replace="" ng-if="!ctrls.NavCtrl.showingSummary || (ctrls.MainCtrl.superSimple && ctrls.MainCtrl.isDeviceATablet())"></div><div ng-include="\'SilverApp/views/@@p/tablet-summary.html\'" include-replace="" ng-if="ctrls.NavCtrl.showingSummary && ctrls.MainCtrl.isDeviceATablet() && ctrls.MainCtrl.superSimple"></div></div></div><sf-dimension-watcher ng-if="::ctrls.MainCtrl.isDeviceAPhone()" source="sf-galleon-app-container" on-dimensions-changed="ctrls.MainCtrl.updateDeviceOrientation(width, height)"></sf-dimension-watcher><div class="palette-tabs app-footer clearfix" ng-if="!ctrls.MainCtrl.superSimple ||\n     (!ctrls.MainCtrl.isDeviceAPhone() || (ctrls.MainCtrl.isDeviceAPhone() && ctrls.MainCtrl.deviceOrientation != \'landscape\')) &&\n      !ctrls.NavCtrl.showingSummary"><div ng-include="\'Palette/views/@@p/pages.html\'"></div></div><div ng-if="ctrls.MainCtrl.isDeviceATablet() && ctrls.MainCtrl.superSimple" class="tablet-palette-tabs" ng-include="\'Palette/views/@@p/pages.html\'"></div>'),
a.put("SilverApp/views/pb/pricing-receipt.html","<div ng-include=\"'SilverApp/views/default-pricing-receipt.html'\"></div>"),a.put("SilverApp/views/pb/prompt-for-storyboard.html",""),a.put("SilverApp/views/pb/save-button.html",'<button id="saveButton" ng-show="!ctrls.SaveCtrl.lastSavedDate" data-intro="{{::\'HelpOverlay.3\' | translate }}" data-position="bottom" class="btn btn-secondary navbar-btn order-btn header-button save-btn" ng-click="!ctrls.MainCtrl.inTourMode && ctrls.SaveCtrl.save()" omniture="" linkname="Order" data-test-key="header_save_button">{{::\'SilverApp.save\'|translate}}</button> <button id="saveButton" ng-show="ctrls.SaveCtrl.lastSavedDate" data-intro="{{::\'HelpOverlay.3\' | translate }}" data-position="bottom" tooltip-append-to-body="false" tooltip="{{ctrls.SaveCtrl.lastSavedDate | date:\'mediumTime\' | postfixTranslate:\'SilverApp.lastSaved\'}}" tooltip-trigger="mouseenter" class="btn btn-secondary navbar-btn order-btn header-button save-btn" ng-click="!ctrls.MainCtrl.inTourMode && ctrls.SaveCtrl.save()" omniture="" linkname="Order" data-test-key="header_save_button">{{::\'SilverApp.save\'|translate}}</button>'),a.put("SilverApp/views/pb/share-tab-items.html",'<div class="modal-body"><div class="ext-palette-header-nav"><div class="ext-palette-header-button" ng-class="{active: ctrls.ShareCtrl.activeTab == \'email\', selected: ctrls.ShareCtrl.activeTab == \'email\'}" ng-click="ctrls.ShareCtrl.selectTab(\'email\')">{{::\'SilverApp.Share.dialog.tab.email\'|translate}}<div class="ext-palette-arrow" ng-class="{\'selected\': ctrls.ShareCtrl.activeTab == \'email\'}"></div></div><div class="ext-palette-header-button" ng-class="{active: ctrls.ShareCtrl.activeTab == \'facebook\', selected: ctrls.ShareCtrl.activeTab == \'facebook\'}" ng-click="ctrls.ShareCtrl.selectTab(\'facebook\')">{{::\'SilverApp.Share.dialog.tab.facebook\'|translate}}<div class="ext-palette-arrow" ng-class="{\'selected\': ctrls.ShareCtrl.activeTab == \'facebook\'}"></div></div><div ng-if="ctrls.MainCtrl.pinterest" class="ext-palette-header-button" ng-class="{active: ctrls.ShareCtrl.activeTab == \'pinterest\', selected: ctrls.ShareCtrl.activeTab == \'pinterest\'}" ng-click="ctrls.ShareCtrl.selectTab(\'pinterest\')">{{::\'SilverApp.Share.dialog.tab.pinterest\'|translate}}<div class="ext-palette-arrow" ng-class="{\'selected\': ctrls.ShareCtrl.activeTab == \'pinterest\'}"></div></div><div class="ext-palette-header-button" ng-class="{active: ctrls.ShareCtrl.activeTab == \'weblink\', selected: ctrls.ShareCtrl.activeTab == \'weblink\'}" ng-click="ctrls.ShareCtrl.selectTab(\'weblink\')">{{::\'SilverApp.Share.dialog.tab.weblink\'|translate}}<div class="ext-palette-arrow" ng-class="{\'selected\': ctrls.ShareCtrl.activeTab == \'weblink\'}"></div></div><div class="ext-palette-header-button" ng-class="{active: ctrls.ShareCtrl.activeTab == \'other\', selected: ctrls.ShareCtrl.activeTab == \'other\'}" ng-click="ctrls.ShareCtrl.selectTab(\'other\')">{{::\'SilverApp.Share.dialog.tab.other\'|translate}}<div class="ext-palette-arrow" ng-class="{\'selected\': ctrls.ShareCtrl.activeTab == \'other\'}"></div></div></div></div><div ng-show="ctrls.ShareCtrl.activeTab == \'email\'" ng-form="emailShareForm"><div class="modal-body share-modal-body"><div class="input-group" id="share-emails"><span class="input-group-addon">To:</span><input name="shareEmails" ng-model="ctrls.ShareCtrl.emails" class="form-control" placeholder="{{::\'SilverApp.Share.dialog.emails\'|translate}}" sf-email-validator="" multi-email-mode="true" required=""></div><div id="share-message"><textarea ng-trim="false" ng-init="ctrls.ShareCtrl.updateEmailMessageLength()" ng-keyup="ctrls.ShareCtrl.updateEmailMessageLength()" ng-hide="ctrls.ShareCtrl.sent" ng-model="ctrls.ShareCtrl.emailMessage" maxlength="200"></textarea><span class="emailCharLimit" ng-hide="ctrls.ShareCtrl.sent">{{::\'SilverApp.Share.dialog.charlimitlabel\'|translate}}{{ctrls.ShareCtrl.emailMessageCharRemainForSingleCharNewLine}}</span> <span class="emailCharLimitTwoChar" ng-hide="ctrls.ShareCtrl.sent">{{::\'SilverApp.Share.dialog.charlimitlabel\'|translate}}{{ctrls.ShareCtrl.emailMessageCharRemainForDoubleCharNewLine}}</span><p ng-show="ctrls.ShareCtrl.sent">{{ctrls.ShareCtrl.sentMessage}}</p></div><div id="share-cover" class="single-page-wrapper page-thumbnail front-cover"><sf-simple-page page="ctrls.PagesCtrl.project.product.cover.frontPage" width="260" height="200" priority="high"></sf-simple-page></div></div><div class="modal-footer" id="share-button"><div class="message-container message-container--inline" ng-show="emailShareForm.shareEmails.$dirty && emailShareForm.shareEmails.$error.required" data-test-key="required-email"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error">{{::\'SilverApp.Share.dialog.requiredEmail\'|translate}}</span></div><div class="message-container message-container--inline" ng-show="emailShareForm.shareEmails.$dirty && emailShareForm.shareEmails.$error.sfMultipleEmails && !emailShareForm.shareEmails.$error.required" data-test-key="invalid-email"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error">{{::\'SilverApp.Share.dialog.invalidEmail\'|translate}}</span></div><button ng-show="!ctrls.ShareCtrl.sent" class="btn btn-primary" ng-class="{\'disabled\': !ctrls.ShareCtrl.isFormValid(emailShareForm)}" ng-click="ctrls.ShareCtrl.isFormValid(emailShareForm) && ctrls.ShareCtrl.shareDialogHandler()" data-test-key="button_share_dialog_submit">{{::\'SilverApp.Share.dialog.submit.email\'|translate}}</button> <button ng-show="ctrls.ShareCtrl.sent" class="btn btn-primary" ng-click="ctrls.ShareCtrl.close()" data-test-key="button_share_dialog_close">{{::\'SilverApp.Share.dialog.close\'|translate}}</button></div></div><div ng-show="ctrls.ShareCtrl.activeTab == \'facebook\'" ng-form="fbShareForm"><div class="modal-body share-modal-body"><div id="share-fb-message"></div><div id="share-message"><textarea ng-hide="ctrls.ShareCtrl.sent" readonly="readonly">{{::\'SilverApp.Share.message\'|translate}}</textarea><p ng-show="ctrls.ShareCtrl.sent">{{ctrls.ShareCtrl.sentMessage}}</p></div><div id="share-cover" class="single-page-wrapper page-thumbnail front-cover"><sf-simple-page page="ctrls.PagesCtrl.project.product.cover.frontPage" width="260" height="200" priority="high"></sf-simple-page></div></div><div class="modal-footer" id="share-button"><button ng-show="!ctrls.ShareCtrl.sent" class="btn btn-primary" ng-class="{\'disabled\': !ctrls.ShareCtrl.isFormValid(fbShareForm)}" ng-click="ctrls.ShareCtrl.isFormValid(fbShareForm) && ctrls.ShareCtrl.shareDialogHandler()" data-test-key="button_share_dialog_submit">{{::\'SilverApp.Share.dialog.submit.facebook\'|translate}}</button> <button ng-show="ctrls.ShareCtrl.sent" class="btn btn-primary" ng-click="ctrls.ShareCtrl.close()" data-test-key="button_share_dialog_close">{{::\'SilverApp.Share.dialog.close\'|translate}}</button></div></div><div ng-show="ctrls.ShareCtrl.activeTab == \'pinterest\'" ng-form="pinterestShareForm"><div class="modal-body share-modal-body"><div id="share-pinterest-message"></div><div id="share-message"><textarea ng-trim="false" ng-init="ctrls.ShareCtrl.updatePinterestMessageLength()" ng-keyup="ctrls.ShareCtrl.updatePinterestMessageLength()" ng-hide="ctrls.ShareCtrl.sent" ng-model="ctrls.ShareCtrl.pinterestMessage" maxlength="200">\n            </textarea><span class="emailCharLimit" ng-hide="ctrls.ShareCtrl.sent">{{::\'SilverApp.Share.dialog.charlimitlabel\'|translate}}{{ctrls.ShareCtrl.pinterestMessageCharRemainForSingleCharNewLine}}</span> <span class="emailCharLimitTwoChar" ng-hide="ctrls.ShareCtrl.sent">{{::\'SilverApp.Share.dialog.charlimitlabel\'|translate}}{{ctrls.ShareCtrl.pinterestMessageCharRemainForDoubleCharNewLine}}</span><p ng-show="ctrls.ShareCtrl.sent">{{ctrls.ShareCtrl.sentMessage}}</p></div><div id="share-cover" class="single-page-wrapper page-thumbnail front-cover"><sf-simple-page page="ctrls.PagesCtrl.project.product.cover.frontPage" width="260" height="200" priority="high"></sf-simple-page></div></div><div class="modal-footer" id="share-button"><button ng-show="!ctrls.ShareCtrl.sent" class="btn btn-primary" ng-class="{\'disabled\': !ctrls.ShareCtrl.isFormValid(pinterestShareForm)}" ng-click="ctrls.ShareCtrl.isFormValid(pinterestShareForm) && ctrls.ShareCtrl.shareDialogHandler()" data-test-key="button_share_dialog_submit">{{::\'SilverApp.Share.dialog.submit.pinterest\'|translate}}</button> <button ng-show="ctrls.ShareCtrl.sent" class="btn btn-primary" ng-click="ctrls.ShareCtrl.close()" data-test-key="button_share_dialog_close">{{::\'SilverApp.Share.dialog.close\'|translate}}</button></div></div><div ng-show="ctrls.ShareCtrl.activeTab == \'weblink\'" ng-form="weblinkShareForm"><div class="modal-body share-modal-body"><div ng-hide="ctrls.ShareCtrl.isCopyDisabled" id="share-weblink-title">{{::\'SilverApp.Share.dialog.link\'|translate}}</div><div ng-show="ctrls.ShareCtrl.isCopyDisabled" id="share-weblink-title">{{::\'SilverApp.Share.dialog.linknocopy\'|translate}}</div><div class="form-group"><textarea id="share-weblink-input" ng-model="ctrls.ShareCtrl.shareUrl" readonly="readonly"></textarea></div></div><div class="modal-footer" id="share-button"><button ng-show="!ctrls.ShareCtrl.isCopyDisabled && !ctrls.ShareCtrl.sent" class="btn btn-primary" clip-click="ctrls.ShareCtrl.shareDialogHandler()" clip-copy="ctrls.ShareCtrl.shareUrl" data-test-key="button_share_dialog_submit">{{::\'SilverApp.Share.dialog.submit.weblink\'|translate}}</button> <button ng-show="ctrls.ShareCtrl.isCopyDisabled || ctrls.ShareCtrl.sent" class="btn btn-primary" ng-click="ctrls.ShareCtrl.close()" data-test-key="button_share_dialog_close">{{::\'SilverApp.Share.dialog.close\'|translate}}</button></div></div><div ng-show="ctrls.ShareCtrl.activeTab == \'other\'" ng-form="otherShareForm"><div class="modal-body share-modal-body" id="share-other"><div class="share-radio clickable" btn-radio="\'sites\'" ng-model="ctrls.ShareCtrl.shareOther" ng-change="ctrls.ShareCtrl.sent = false"><div class="share-text" data-test-key="share.shareOther.sites">{{::\'SilverApp.Share.dialog.other.sites\'|translate}}</div></div><div class="share-radio clickable" btn-radio="\'embed\'" ng-model="ctrls.ShareCtrl.shareOther" ng-change="ctrls.ShareCtrl.sent = false"><div class="share-text" data-test-key="share.shareOther.embed">{{::\'SilverApp.Share.dialog.other.embed\'|translate}}</div></div></div><div class="modal-footer" id="share-button"><button ng-show="!ctrls.ShareCtrl.isCopyDisabled && !ctrls.ShareCtrl.sent" class="btn btn-primary" ng-click="ctrls.ShareCtrl.shareDialogHandler()" data-test-key="button_share_dialog_submit">{{::\'SilverApp.Share.dialog.submit.other\'|translate}}</button> <button ng-show="ctrls.ShareCtrl.isCopyDisabled || ctrls.ShareCtrl.sent" class="btn btn-primary" ng-click="ctrls.ShareCtrl.close()" data-test-key="button_share_dialog_close">{{::\'SilverApp.Share.dialog.close\'|translate}}</button></div></div>'),a.put("SilverApp/views/pb/spread-menu-item.html",'<li ng-show="ctrls.MainCtrl.config.spreads && !ctrls.NavCtrl.activeLeftPage.isSpread()" ng-class="{\'disabled\': ctrls.PageActionsCtrl.isMakeSpreadDisabled() }"><a ng-click="ctrls.PageActionsCtrl.makeSpread()" class="clickable" omniture="" linkname="Pages:Make spread" data-test-key="button_make_spread">{{::\'SilverApp.makeSpread\'|translate}}</a></li><li ng-show="ctrls.MainCtrl.config.spreads && ctrls.NavCtrl.activeLeftPage.isSpread()"><a ng-click="ctrls.PageActionsCtrl.breakSpread()" class="clickable" omniture="" linkname="Pages:Split spread" data-test-key="button_break_spread">{{::\'SilverApp.breakSpread\'|translate}}</a></li>'),a.put("SilverApp/views/pb/spread.html",'<div ng-show="!ctrls.NavCtrl.showingSummary" id="spread_{{spreadIndex}}" class="book-surface-area clearfix" ng-class="{\'preview-spread\': ctrls.MainCtrl.previewMode, \'book-surface-area-overflow\': ctrls.NavCtrl.zoomFactor > 1}"><div class="book-spread" ng-class="{\'book-spread-zoom\': ctrls.NavCtrl.zoomFactor > 1}"><div class="pages-surface" ng-hide="ctrls.NavCtrl[rightPageId].isCover() && ctrls.NavCtrl[rightPageId].isStockCover"><sf-customize-page width="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) ? ctrls.NavCtrl.pageWidth : ctrls.NavCtrl.previousPageWidth" height="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) ? ctrls.NavCtrl.pageHeight : ctrls.NavCtrl.previousPageHeight" page="ctrls.NavCtrl[leftPageId]" ng-class="{\'pull-right\': !ctrls.NavCtrl[leftPageId].isSpread(),\n                                        \'left-sf-page\': !ctrls.NavCtrl[leftPageId].isSpread(),\n                                        \'spread-page\':ctrls.NavCtrl[leftPageId].isSpread()}" ng-if="ctrls.CustomizeCtrl.isCustomizing() && !ctrls.NavCtrl[rightPageId].isStockCover" on-select="ctrls.NavCtrl.selectLeftPage()" tabindex="0" sf-droppable=""></sf-customize-page><sf-page id="{{leftPageId}}" ng-if="!ctrls.CustomizeCtrl.isCustomizing() || ctrls.NavCtrl[rightPageId].isStockCover" ng-class="{\'pull-right\': !ctrls.NavCtrl[leftPageId].isSpread(),\n                              \'left-sf-page\': !ctrls.NavCtrl[leftPageId].isSpread(),\n                              \'spread-page\':ctrls.NavCtrl[leftPageId].isSpread()}" width="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) ? ctrls.NavCtrl.pageWidth : ctrls.NavCtrl.previousPageWidth" height="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) ? ctrls.NavCtrl.pageHeight : ctrls.NavCtrl.previousPageHeight" priority="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) && \'high\' || \'medium\'" page="ctrls.NavCtrl[leftPageId]" hm-swipe-right="ctrls.NavCtrl.previous()" hm-swipe-left="ctrls.NavCtrl.next()" on-remove-image="ctrls.SurfaceCtrl.onRemoveImage(page, asset)" on-remove-embellishment="ctrls.SurfaceCtrl.onRemoveEmbellishment(page, asset)" on-remove-page="ctrls.SurfaceCtrl.onRemovePage(page)" on-edit-text="ctrls.EditTextCtrl.edit(assetIndex, surfaceNumber)" on-image-double-click="ctrls.SurfaceCtrl.onImageDoubleClick(page, asset, thumb, upload)" on-select="ctrls.NavCtrl.selectLeftPage()" on-page-double-click="ctrls.EditTabCtrl.handleInnerPageDoubleClick(page)" on-page-load="ctrls.SurfaceCtrl.reportSpreadPageLoad()" use-thumbnail="\'true\'" editable="!ctrls.MainCtrl.previewMode" use-priority-loading-lifecycle-callbacks="true" book-spread="true" active-spread="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex)" dev-page-data="ctrls.NavCtrl.appState.dev.leftPage" dev-data="ctrls.NavCtrl.appState.dev" data-page-number="{{ctrls.NavCtrl[leftPageId].surfaceNumber}}"></sf-page></div><div class="spine-surface" ng-hide="!ctrls.NavCtrl[leftPageId].isCover()"><sf-page class="left-sf-page" ng-if="!ctrls.CustomizeCtrl.isCustomizing()" width="ctrls.NavCtrl.spineWidth" height="ctrls.NavCtrl.pageHeight" page="ctrls.NavCtrl.spinePage" priority="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) && \'high\' || \'medium\'" use-thumbnail="\'true\'" height-source-id="\'{{leftPageId}}\'" on-remove-image="ctrls.SurfaceCtrl.onRemoveImage(page, asset)" on-remove-embellishment="ctrls.SurfaceCtrl.onRemoveEmbellishment(page, asset)" on-edit-text="ctrls.EditTextCtrl.edit(assetIndex, surfaceNumber)" on-image-double-click="ctrls.SurfaceCtrl.onImageDoubleClick(page, asset, thumb, upload)" on-select="ctrls.NavCtrl.selectSpinePage()" on-page-load="ctrls.SurfaceCtrl.reportSpreadPageLoad()" book-spread="true" dev-page-data="ctrls.NavCtrl.appState.dev.spinePage" dev-data="ctrls.NavCtrl.appState.dev" active-spread="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex)" editable="!ctrls.MainCtrl.previewMode" use-priority-loading-lifecycle-callbacks="true" data-page-number="{{ctrls.NavCtrl.spinePage.surfaceNumber}}"></sf-page></div><div class="pages-surface" ng-if="!ctrls.NavCtrl[leftPageId].isSpread()"><sf-customize-page page="ctrls.NavCtrl[rightPageId]" width="ctrls.NavCtrl.pageWidth" height="ctrls.NavCtrl.pageHeight" ng-if="ctrls.CustomizeCtrl.isCustomizing() && !ctrls.NavCtrl[rightPageId].isStockCover" on-select="ctrls.NavCtrl.selectRightPage()" tabindex="0" sf-droppable=""></sf-customize-page><sf-page width="ctrls.NavCtrl.pageWidth" height="ctrls.NavCtrl.pageHeight" ng-if="!ctrls.CustomizeCtrl.isCustomizing() || (ctrls.CustomizeCtrl.isCustomizing() && ctrls.NavCtrl[rightPageId].isStockCover)" page="ctrls.NavCtrl[rightPageId]" hm-swipe-right="ctrls.NavCtrl.previous()" hm-swipe-left="ctrls.NavCtrl.next()" class="pull-left" ng-class="{\'page-stock-cover\':ctrls.NavCtrl[rightPageId].isStockCover}" editable="!ctrls.MainCtrl.previewMode" use-priority-loading-lifecycle-callbacks="true" priority="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) && \'high\' || \'medium\'" use-thumbnail="\'true\'" on-remove-image="ctrls.SurfaceCtrl.onRemoveImage(page, asset)" on-remove-embellishment="ctrls.SurfaceCtrl.onRemoveEmbellishment(page, asset)" on-remove-page="ctrls.SurfaceCtrl.onRemovePage(page)" on-edit-text="ctrls.EditTextCtrl.edit(assetIndex, surfaceNumber)" on-image-double-click="ctrls.SurfaceCtrl.onImageDoubleClick(page, asset, thumb, upload)" on-select="ctrls.NavCtrl.selectRightPage()" on-page-double-click="ctrls.EditTabCtrl.handleInnerPageDoubleClick(page)" on-page-load="ctrls.SurfaceCtrl.reportSpreadPageLoad()" book-spread="true" active-spread="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex)" dev-page-data="ctrls.NavCtrl.appState.dev.rightPage" dev-data="ctrls.NavCtrl.appState.dev" data-page-number="{{ctrls.NavCtrl[rightPageId].surfaceNumber}}"></sf-page></div></div></div>'),a.put("SilverApp/views/pb/summary.html",'<div id="summaryWrapper" class="book-wrapper" ng-class="{\'expanded-bottom-palette\':ctrls.PaletteCtrl.lowerPaletteIsExpanded}" ng-controller="SummaryCtrl"><div id="summaryCoverWrapper" class="summaryCoverWrapper" ng-click="ctrls.NavCtrl.play()" ng-if="ctrls.PagesCtrl.project.product"><div id="summaryCover"><sf-dimension-watcher source="summaryCoverWrapper" on-dimensions-changed="ctrls.NavCtrl.updateSummaryDimensions(width, height)"></sf-dimension-watcher><sf-page id="summaryPage" width="ctrls.NavCtrl.pageWidth" height="ctrls.NavCtrl.pageHeight" priority="high" page="ctrls.PagesCtrl.getFrontCover()" on-page-load="ctrls.NavCtrl.summaryPageLoaded(ctrls.PagesCtrl.getFrontCover())" editable="false"></sf-page><div class="play-button"></div></div></div><div id="projectInfoWrapper" style="height:{{ctrls.NavCtrl.pageHeight}}px" ng-if="ctrls.PagesCtrl.project.product"><div id="projectInfo"><span class="summary-project-title">{{ctrls.MainCtrl.project.title}}</span> <span class="summary-project-info">{{ctrls.MainCtrl.project.product.descriptionId | translate}}, {{ctrls.MainCtrl.project.product.pages.length | postfixTranslate:\'SilverApp.numPages\'}}</span> <a ng-if="ctrls.SummaryCtrl.showLink" href="{{ctrls.SummaryCtrl.appLink}}">{{ctrls.SummaryCtrl.appText | translate}}</a></div></div></div>'),a.put("SilverApp/views/pb/surface.html",'<div class="book-wrapper" ng-class="{\'new-nav\':ctrls.NavCtrl.showNewNavigation, \'book-wrapper-bacon\': ctrls.MainCtrl.config.isBaconV2 && ctrls.MainCtrl.superSimple, \'expanded-bottom-palette\':ctrls.PaletteCtrl.lowerPaletteIsExpanded, \'collapsed-bottom-palette\':ctrls.PaletteCtrl.lowerPaletteIsCollapsed}"><div id="bookCenterArea" class="book-center-area" ng-controller="SurfaceCtrl" data-test-key="2pv" ng-class="{\'customize-on\': ctrls.CustomizeCtrl.isCustomizing(), \'customize-off\': !ctrls.CustomizeCtrl.isCustomizing()}"><sf-dimension-watcher source="bookCenterArea" on-dimensions-changed="ctrls.NavCtrl.updatePageDimensions(width*ctrls.NavCtrl.zoomFactor, height*ctrls.NavCtrl.zoomFactor)"></sf-dimension-watcher><div ng-if="!ctrls.MainCtrl.slideshow && !ctrls.MainCtrl.isDeviceAPhone()" ng-controller="FirstSpreadCtrl" ng-include="\'SilverApp/views/pb/spread.html\'"></div><div ng-if="!ctrls.MainCtrl.slideshow && !ctrls.MainCtrl.isDeviceAPhone()" ng-controller="MiddleSpreadCtrl" ng-include="\'SilverApp/views/pb/spread.html\'"></div><div ng-if="!ctrls.MainCtrl.slideshow && !ctrls.MainCtrl.isDeviceAPhone()" ng-controller="LastSpreadCtrl" ng-include="\'SilverApp/views/pb/spread.html\'"></div><div ng-if="ctrls.MainCtrl.slideshow || ctrls.MainCtrl.isDeviceAPhone()" ng-controller="FirstSpreadCtrl" ng-include="\'SilverApp/views/spread-noedit.html\'"></div><div ng-if="ctrls.MainCtrl.slideshow || ctrls.MainCtrl.isDeviceAPhone()" ng-controller="MiddleSpreadCtrl" ng-include="\'SilverApp/views/spread-noedit.html\'"></div><div ng-if="ctrls.MainCtrl.slideshow || ctrls.MainCtrl.isDeviceAPhone()" ng-controller="LastSpreadCtrl" ng-include="\'SilverApp/views/spread-noedit.html\'"></div><sf-spread-slider active-spread-index="ctrls.NavCtrl.activeSpreadIndex" on-start-transition="ctrls.NavCtrl.handleSpreadTransitionStart()" on-stop-transition="ctrls.NavCtrl.handleSpreadTransitionStop()" left-spread-id="spread_-1" middle-spread-id="spread_0" right-spread-id="spread_1"></sf-spread-slider><sf-two-page-view-controls class="sf-two-page-view-controls" active-left-page="ctrls.NavCtrl.activeLeftPage" active-right-page="ctrls.NavCtrl.activeRightPage" selected-page="ctrls.NavCtrl.selectedPage" active-spread-index="ctrls.NavCtrl.activeSpreadIndex" spine-width="ctrls.NavCtrl.spineWidth" page-width="ctrls.NavCtrl.pageWidth" page-height="ctrls.NavCtrl.pageHeightSansSpine" on-left-label-tapped="ctrls.NavCtrl.selectLeftPage()" on-right-label-tapped="ctrls.NavCtrl.selectRightPage()" on-next-tapped="ctrls.NavCtrl.next()" on-previous-tapped="ctrls.NavCtrl.previous()" on-play-tapped="ctrls.NavCtrl.play()" is-phone="::ctrls.MainCtrl.isDeviceAPhone()" customizing="ctrls.NavCtrl.appState.isCustomizing()" playing="ctrls.NavCtrl.playing"></sf-two-page-view-controls><sf-tablet-tools ng-if="::ctrls.MainCtrl.isDeviceATablet()" selected-page="ctrls.NavCtrl.selectedPage"></sf-tablet-tools><div id="layoutsPreviewLoader" ng-if="ctrls.SurfaceCtrl.appState.twoPageSpreadHasLoaded" class="layouts offscreen"></div><div id="bkgsPreviewLoader" ng-if="ctrls.SurfaceCtrl.appState.twoPageSpreadHasLoaded" class="bkgs offscreen"></div><div id="embellishmentPreviewLoader" ng-if="ctrls.SurfaceCtrl.appState.twoPageSpreadHasLoaded" class="embs offscreen"></div><div ng-style="{\'top\': (ctrls.NavCtrl.pageHeightSansSpine / 2) - 20}" sf-tap="ctrls.NavCtrl.previous()" sf-long-press="ctrls.CommandCtrl.undo()" duration="2000" class="icon-previous-light"></div><div ng-style="{\'top\': (ctrls.NavCtrl.pageHeightSansSpine / 2) - 20}" sf-tap="ctrls.NavCtrl.next()" sf-long-press="ctrls.CommandCtrl.redo()" duration="2000" class="icon-next-light"></div></div></div>'),a.put("SilverApp/views/pb/tablet-summary.html",'<div id="summaryWrapper" class="book-wrapper" ng-class="{\'expanded-bottom-palette\':ctrls.PaletteCtrl.lowerPaletteIsExpanded}" ng-controller="SummaryCtrl"><div id="coverActionsCanvas" class="coverActionsCanvas" style="height:{{ctrls.NavCtrl.pageHeight}}px" ng-if="ctrls.PagesCtrl.project.product"><div id="coverActions" class="coverActions"><div class="cover-info-group"><span class="cover-intro-text">{{::\'SilverApp.tablet.summary.intro.ready\'|translate}}</span></div><div><span class="cover-instr-text">{{::\'SilverApp.tablet.summary.instr.edit\'|translate}}</span> <span class="cover-instr-text">{{::\'SilverApp.tablet.summary.instr.move\'|translate}}</span></div></div></div><div id="summaryCoverWrapper" class="summaryCoverWrapper inline-block" ng-if="ctrls.PagesCtrl.project.product" style="height:{{ctrls.NavCtrl.pageHeight}}px"><div id="summaryCover"><sf-dimension-watcher source="summaryCoverWrapper" on-dimensions-changed="ctrls.NavCtrl.updateSummaryDimensions(width, height)"></sf-dimension-watcher><sf-page id="summaryPage" width="ctrls.NavCtrl.pageWidth" height="ctrls.NavCtrl.pageHeight" priority="high" hm-swipe-right="ctrls.NavCtrl.previous()" hm-swipe-left="ctrls.NavCtrl.next()" page="ctrls.PagesCtrl.getFrontCover()" on-page-load="ctrls.NavCtrl.summaryPageLoaded(ctrls.PagesCtrl.getFrontCover())" on-image-double-click="ctrls.PagesCtrl.editImage(page, asset, thumb, upload)" on-edit-text="ctrls.EditTextCtrl.edit(assetIndex, surfaceNumber)" editable="true"></sf-page></div></div><div ng-click="ctrls.NavCtrl.next()" style="right: 5px" ng-style="{\'top\': (ctrls.NavCtrl.pageHeight / 2) - 15}" class="icon-next-light"></div><div class="tablet-tools tablet-tools-cover"><div class="tablet-tool" ng-click="ctrls.SummaryCtrl.onShuffleClick()"><div class="tablet-swap-photos-icon"></div><a class="tap-primary-btn">{{::\'SilverApp.tablet.swapPhotos\'|translate}}</a></div><div ng-controller="CommandCtrl"><div class="tablet-tool"><div class="icon icon-undo tablet-icon-margin clickable"></div><a class="tap-primary-btn" ng-click="ctrls.CommandCtrl.undo()" ng-class="{\'disabled\': !ctrls.CommandCtrl.canUndo}" translate="">SilverApp.undo</a></div><div class="tablet-tool"><div class="icon icon-redo tablet-icon-margin clickable"></div><a class="tap-primary-btn" ng-click="ctrls.CommandCtrl.redo()" ng-class="{\'disabled\': !ctrls.CommandCtrl.canRedo}" translate="">SilverApp.redo</a></div></div></div></div>'),a.put("SilverApp/views/pb/tabs.html",'<div class="app-content"><tabset id="mainTabs" class="main-tabs" ng-class="{\'new-nav\':ctrls.NavCtrl.showNewNavigation}"><tab ng-show="!ctrls.MainCtrl.previewMode" id="storyboardTab" ng-if="ctrls.MainCtrl.storyboardEnabled" heading="{{ \'SilverApp.storyboard\' | translate }}" tooltip-append-to-body="true" tooltip="{{\'SilverApp.tooltip.storyboardTab\' | translate}}" select="ctrls.StoryboardTabCtrl.tabWasMadeActive()" deselect="ctrls.StoryboardTabCtrl.tabWasMadeInactive()" active="ctrls.NavCtrl.storyboardIsActive" data-test-key="button_storyboard" class="clickable" disabled="ctrls.MainCtrl.inTourMode"><div ng-if="ctrls.NavCtrl.storyboardIsActive" ng-include="\'SilverApp/views/storyboard.html\'" data-test-key="storyboard_page"></div></tab><tab id="editTab" heading="{{ \'SilverApp.edit\' | translate }}" class="clickable tourable-item--tab mode-{{ctrls.MainCtrl.modeName}}" select="ctrls.NavCtrl.tabWasMadeActive()" tooltip-append-to-body="true" tooltip="{{\'SilverApp.tooltip.editTab\' | translate}}" active="ctrls.NavCtrl.editIsActive" data-test-key="button_edit" disabled="ctrls.MainCtrl.inTourMode"><div ng-include="\'SilverApp/views/edit-tab.html\'" data-test-key="edit_page"></div></tab><tab ng-show="!ctrls.MainCtrl.previewMode" id="arrangeTab" tooltip-append-to-body="true" tooltip="{{\'SilverApp.tooltip.arrangeTab\' | translate}}" ng-if="ctrls.ArrangeTabCtrl.arrangeEnabled" class="clickable tourable-item--tab" heading="{{ \'SilverApp.arrange\' | translate }}" select="ctrls.ArrangeTabCtrl.tabWasMadeActive()" deselect="ctrls.ArrangeTabCtrl.tabWasMadeInactive()" active="ctrls.NavCtrl.arrangeIsActive" data-test-key="button_arrange" disabled="ctrls.MainCtrl.inTourMode"><div ng-if="ctrls.NavCtrl.arrangeIsActive" ng-include="\'SilverApp/views/arrange-tab.html\'" data-test-key="arrange_page"></div></tab><tab ng-show="!ctrls.MainCtrl.previewMode" id="styleTab" ng-if="!ctrls.MainCtrl.features.styleDialog" heading="{{ \'SilverApp.style\' | translate }}" tooltip-append-to-body="true" tooltip="{{\'SilverApp.tooltip.styleTab\' | translate}}" select="ctrls.StyleTabCtrl.tabWasMadeActive()" deselect="ctrls.StyleTabCtrl.tabWasMadeInactive()" active="ctrls.NavCtrl.styleIsActive" data-test-key="button_style" class="clickable"><div ng-if="ctrls.NavCtrl.styleIsActive" ng-include="\'SilverApp/views/style-tab.html\'" data-test-key="style_page"></div></tab><tab ng-show="!ctrls.MainCtrl.previewMode" id="bookTab" heading="{{ \'SilverApp.book\' | translate }}" data-intro="{{::\'HelpOverlay.5\' | translate }}" data-position="bottom" tooltip-append-to-body="true" tooltip="{{\'SilverApp.tooltip.bookTab\' | translate}}" class="clickable tourable-item--tab" select="ctrls.BookTabCtrl.tabWasMadeActive()" deselect="ctrls.BookTabCtrl.tabWasMadeInactive()" active="ctrls.NavCtrl.bookIsActive" data-test-key="button_book" disabled="ctrls.MainCtrl.inTourMode"><div ng-include="\'SilverApp/views/book-tab.html\'" data-test-key="book_page"></div></tab><tab ng-if="ctrls.NavCtrl.showNewNavigation" ng-show="!ctrls.MainCtrl.previewMode && ctrls.MainCtrl.preview" id="previewTab" heading="{{::\'SilverApp.preview\'|translate}}" class="clickable tourable-item--tab mode-{{ctrls.MainCtrl.modeName}}" select="ctrls.MainCtrl.enablePreviewMode(true)" tooltip-append-to-body="true" tooltip="{{\'SilverApp.preview\' | translate}}" active="ctrls.NavCtrl.previewIsActive" data-test-key="button_preview" disabled="ctrls.MainCtrl.inTourMode"></tab></tabset></div>'),a.put("SilverApp/views/pb/tour-menu-item.html",'<li><a ng-if="ctrls.MainCtrl.features.tour" ng-hide="ctrls.NavCtrl.arrangeIsActive" ng-click="ctrls.MainCtrl.startTour()" data-test-key="button_open_tour" class="clickable">{{::\'SilverApp.tour\'|translate}}</a></li>'),a.put("SilverApp/views/pb/zoom-toolbar-item.html",'<li class="divider-vertical tool-icon" ng-hide="ctrls.MainCtrl.superSimple || ctrls.MainCtrl.previewMode"></li><li data-intro="{{::\'HelpOverlay.6\' | translate }}" data-position="bottom" tooltip-append-to-body="true" tooltip="{{\'SilverApp.tooltip.zoom\' | translate}}" class="zoomSlider" ng-class="{\'zoomSlider-in-preview\': ctrls.MainCtrl.previewMode}"><rzslider rz-slider-model="ctrls.NavCtrl.zoomMin" rz-slider-floor="100" rz-slider-ceil="300" rz-slider-step="10" rz-slider-hide-limit-labels="true" rz-slider-always-show-bar="true" rz-slider-translate="ctrls.NavCtrl.changeValueToPercentage"></rzslider></li>'),a.put("SilverApp/views/phone-pages-view.html",'<div class="offscreen"><capture-click-events on-click="ctrls.PagesCtrl.selectMobilePage(page, $event)"></capture-click-events></div><div class="pagesView-container allowVerticalScroll"><scroll-synchronizer id="pagesView_page_scroller" ng-if="ctrls.PagesCtrl.project.product.pages.length>0" watch-on="ctrls.PagesViewCtrl.currentPaletteItemIndex" action-when="ctrls.NavCtrl.pagesViewIsActive" pad-top="10" pad-left="0" sf-drag-scroll="" scroll-direction="\'vertical\'" target-elements-classifier=".sf-page-selected" class="clearfix palette-body pages-tab allowVerticalScroll page-{{ctrls.MainCtrl.project.product.aspectRatio}}" ng-class="{\'advanced-arrange\':ctrls.MainCtrl.config.advancedArrange}" data-test-key="div_pages-pagesView"><ul class="list-unstyled clearfix pagesView-content"><div class="page-wrapper clearfix" ng-click="ctrls.PagesCtrl.selectMobilePage(ctrls.PagesCtrl.project.product.cover.frontPage, $event)" ng-class="{\'sf-cover-page-selected\': ctrls.PagesCtrl.selectedMobilePage.surfaceNumber === ctrls.PagesCtrl.project.product.cover.frontPage.constructor.FRONT_COVER_PAGE_NUMBER}"><sf-page-warning class="sf-page-warning-pagesView" page="ctrls.PagesCtrl.project.product.cover.frontPage"></sf-page-warning><sf-simple-page page="ctrls.PagesCtrl.project.product.cover.frontPage" class="pagesView-page" percent-screen-width="0.8"></sf-simple-page><i class="bacon-edit-image" ng-click="ctrls.SurfaceCtrl.editOneUpImageOnPage(ctrls.PagesCtrl.project.product.cover.frontPage)" data-test-key="bacon_editImage"></i> <i class="bacon-change-photo" ng-click="ctrls.ChooseCoverPhotoCtrl.selectCoverPhoto()" data-test-key="bacon_changeCoverPhoto"></i> <i class="bacon-change-layout" ng-controller="ChangeLayoutCtrl" ng-click="ctrls.ChangeLayoutCtrl.selectNextLayout()" data-test-key="bacon_changeLayout"></i> <i class="bacon-edit-text" ng-controller="EditTextCtrl" ng-if="!ctrls.MainCtrl.projectService.currentProject.product.cover.frontPage.hasNoText()" ng-click="ctrls.EditTextCtrl.edit(2, -1)" data-test-key="bacon_editTitle"></i> <span class="pagesView-label">{{::\'SilverApp.frontCover\' | translate}}</span></div><div class="page-wrapper clearfix" ng-repeat="page in ctrls.PagesCtrl.project.product.pages track by page.uid" ng-click="ctrls.PagesCtrl.selectMobilePage(page, $event)" ng-class="{\'sf-page-selected\': ctrls.PagesCtrl.selectedMobilePage.surfaceNumber === page.surfaceNumber,\n                            \'is-title-page\': ctrls.PagesCtrl.selectedMobilePage.surfaceNumber === page.constructor.TITLE_PAGE_NUMBER}"><sf-page-warning class="sf-page-warning-pagesView" page="page"></sf-page-warning><sf-simple-page page="page" class="pagesView-page" percent-screen-width="0.8"></sf-simple-page><i class="touch-edit-image" ng-click="ctrls.SurfaceCtrl.editOneUpImageOnPage(page)"></i> <i class="touch-remove-page" ng-click="ctrls.SurfaceCtrl.onRemovePage(page)"></i> <span id="simple_{{page.surfaceNumber}}" class="pagesView-label">{{ page.surfaceNumber | postfixTranslate:\'SilverApp.Page\' }}</span></div><div class="page-wrapper clearfix"><sf-page-warning class="sf-page-warning-pagesView" page="ctrls.PagesCtrl.project.product.cover.backPage"></sf-page-warning><sf-simple-page page="ctrls.PagesCtrl.project.product.cover.backPage" class="pagesView-page" percent-screen-width="0.8"></sf-simple-page><span class="pagesView-label">{{::\'SilverApp.backCover\' | translate}}</span></div></ul></scroll-synchronizer></div>'),
a.put("SilverApp/views/post-change-size-warning.html",'<div class="modal-width-medium modal-content"><div class="modal-header"><span class="modal-header-title"><span>{{::\'SilverApp.postChangeCoverWarningDialog.newBookIsReady\'|translate}}</span></span></div><div class="modal-body"><div><span>{{::\'SilverApp.postChangeCoverWarningDialog.weMadeACopy\'|translate}}</span></div><br/><div><i class="icon icon-warning"></i> <span>{{::\'SilverApp.postChangeCoverWarningDialog.warningInfo\'|translate}}</span></div></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" data-dismiss="modal" data-test-key="button_postchangesize_modal_ok" ng-click="ctrls.SimpleModalCtrl.cancel()">{{::\'SilverApp.Ok\'|translate}}</button></div></div>'),a.put("SilverApp/views/pricing-receipt.html",'<span id="pricing-size" data-test-key="label_book_size">{{descriptionId | translate}},</span> <span id="pricing-binding" ng-show="bindingType == \'layflat\'" data-test-key="label_book_binding">{{bindingType | translate}},</span> <span id="pricing-count" data-test-key="label_page_count">{{pageCount | postfixTranslate:\'SilverApp.numPages\'}},</span> <a class="clickable navbar-link navbar-price" id="{{pricingLink}}" data-test-key="button_price" ng-mouseenter="isReceiptVisible = true" ng-mouseleave="isReceiptVisible = false" ng-show="hasValidPrice"><span ng-bind="bookPricing.totalSalePrice | currency" data-test-key="label_price"></span> <span class="caret"></span></a><positionable class="shadow-box" redraw="isReceiptVisible" target="#{{pricingLink}}" placement="bottom" z-index="1200" width="100" height="100" h-spacing="0" v-spacing="20"><div class="pricing-receipt-container" ng-show="isReceiptVisible"><div class="receipt-row" ng-repeat="component in bookPricing.component" ng-show="{{(component.quantity | postfixTranslate:component.sku) != component.sku}}"><div class="receipt-item-description" data-test-key="receipt_item_{{component.sku}}{{dataTestKeySuffix[$index]}}">{{component.quantity | postfixTranslate:component.sku}}</div><div class="receipt-item-price" ng-class="{strike: component.totalSalePrice != component.totalOrigPrice}" data-test-key="receipt_item_price_{{component.sku}}{{dataTestKeySuffix[$index]}}">{{component.totalOrigPrice | currency}}</div><div class="receipt-item-price receipt-item-sale-price" ng-show="component.totalSalePrice != component.totalOrigPrice" data-test-key="receipt_item_salePrice_{{component.sku}}{{dataTestKeySuffix[$index]}}">{{component.totalSalePrice | currency}}</div></div><div class="receipt-row" ng-repeat="contentPrice in bookPricing.contentPrice.contentCategory"><div class="receipt-item-description" data-test-key="receipt_item_{{contentPrice.sku}}">{{contentPrice.description}}</div><div class="receipt-item-price" ng-class="{strike: contentPrice.totalSalePrice != contentPrice.totalOrigPrice}" data-test-key="receipt_item_price_{{contentPrice.sku}}">{{contentPrice.totalOrigPrice | currency}}</div><div class="receipt-item-price receipt-item-sale-price" ng-show="contentPrice.totalSalePrice != contentPrice.totalOrigPrice" data-test-key="receipt_item_salePrice_{{contentPrice.sku}}">{{contentPrice.totalSalePrice | currency}}</div></div><div class="receipt-row receipt-total-row"><div class="receipt-item-description"></div><div class="receipt-item-price" data-test-key="label_original_price" ng-class="{strike: bookPricing.totalSalePrice != bookPricing.totalOrigPrice}">{{bookPricing.totalOrigPrice | currency}}</div><div class="receipt-item-price receipt-item-sale-price" ng-show="bookPricing.totalSalePrice != bookPricing.totalOrigPrice" data-test-key="label_sale_price">{{bookPricing.totalSalePrice | currency}}</div></div></div></positionable>'),a.put("SilverApp/views/project-menu.html",'<li id="projectMenu" class="dropdown clickable" ng-hide="ctrls.MainCtrl.superSimple" dropdown=""><a class="dropdown-toggle" data-toggle="dropdown" data-test-key="button_project_dropdown" dropdown-toggle=""><span>{{::\'SilverApp.project\'|translate}}</span> <span class="caret"></span></a><ul class="dropdown-menu" ng-controller="PhotoActionsCtrl"><li><a data-test-key="button_save" ng-click="ctrls.SaveCtrl.save()">{{::\'SilverApp.save\'|translate}}<div ng-if="ctrls.MainCtrl.allowHotKeys && ctrls.MainCtrl.isMac" class="keyboard-shortcut pull-right">{{::\'SilverApp.hotkey.save.mac\'|translate}}</div><div ng-if="ctrls.MainCtrl.allowHotKeys && !ctrls.MainCtrl.isMac" class="keyboard-shortcut pull-right">{{::\'SilverApp.hotkey.save.windows\'|translate}}</div></a></li><li><a data-test-key="button_save_as" ng-click="ctrls.SaveCtrl.saveAs()">{{::\'SilverApp.saveAs\'|translate}}...</a></li><li class="divider"></li><li><a class="clickable" ng-click="ctrls.ChangeSizeCtrl.openDialog()" omniture="" linkname="Project:Change Size" data-test-key="button_change_size">{{::\'SilverApp.changeSizeMenuItem\'|translate}}</a></li><li ng-controller="StyleTabCtrl" ng-if="ctrls.MainCtrl.features.styleDialog"><a class="clickable" ng-click="ctrls.StyleTabCtrl.openDialog()" omniture="" linkname="Project:Change Style" data-test-key="button_change_style">{{::\'SilverApp.changeStyleMenuItem\'|translate}}</a></li><li ng-controller="ChangeStartDateCtrl" ng-show="ctrls.ChangeStartDateCtrl.changeStartDateAllowed"><a class="clickable" ng-click="ctrls.ChangeStartDateCtrl.openDialog()" omniture="" linkname="Project:Change Start Date" data-test-key="button_change_start_date">{{::\'SilverApp.changeStartDateMenuItem\'|translate}}</a></li><li class="divider"></li><li><a ng-click="ctrls.UppCtrl.showUPP()" class="clickable" omniture="" linkname="Project:Add Photos - Project dropdown" data-test-key="button_add_photos_menu">{{::\'SilverApp.addPhotosMenuItem\'|translate}}<div ng-if="ctrls.MainCtrl.allowHotKeys && ctrls.MainCtrl.isMac" class="keyboard-shortcut pull-right">{{::\'SilverApp.hotkey.addphotos.mac.menu\'|translate}}</div><div ng-if="ctrls.MainCtrl.allowHotKeys && !ctrls.MainCtrl.isMac" class="keyboard-shortcut pull-right">{{::\'SilverApp.hotkey.addphotos.windows.menu\'|translate}}</div></a></li><li ng-if="!ctrls.MainCtrl.config.features.disableAutofill" ng-class="{disabled: !ctrls.AutofillCtrl.canAutofill()}"><a ng-controller="AutofillCtrl" ng-click="ctrls.AutofillCtrl.autofill()" omniture="" linkname="Autofill Photos - Top Nav" data-test-key="menu_autofill" class="clickable">{{::\'SilverApp.autofill\'|translate}}</a></li><li ng-class="{disabled: !ctrls.PhotoActionsCtrl.canRemoveUnusedPhotos()}"><a class="clickable" omniture="" linkname="Remove Unused Photos - Top Nav" ng-click="ctrls.PhotoActionsCtrl.openDialog()" omniture="" linkname="Pages:Remove unused photos" data-test-key="button_remove_unused_photos_menu">{{::\'SilverApp.clearUnusedPhotosFromPages\'|translate}}</a></li><li class="divider"></li><li><a class="clickable" omniture="" linkname="Project:Share" ng-click="ctrls.ShareCtrl.shareProject()" data-test-key="button_share">{{::\'SilverApp.share\'|translate}}...</a></li><div ng-include="\'SilverApp/views/@@p/path-switch-menu-item.html\'" include-replace=""></div><li class="divider"></li><li><a ng-click="ctrls.AuthenticationCtrl.openHelp()" omniture="" linkname="Project:Help" data-test-key="openhelp" class="clickable">{{::\'SilverApp.help\'|translate}}</a></li><div ng-include="\'SilverApp/views/@@p/tour-menu-item.html\'" include-replace=""></div><li class="divider" ng-if="ctrls.MainCtrl.switchLanguageEnabled"></li><li><a ng-click="ctrls.MainCtrl.setLanguageFromMenu(\'es\')" data-test-key="spanish" class="clickable" ng-if="ctrls.MainCtrl.switchLanguageEnabled" omniture="" linkname="Switch to Spanish">{{::\'SilverApp.spanish\'|translate}}</a></li><li><a ng-click="ctrls.MainCtrl.setLanguageFromMenu(\'en\')" data-test-key="english" class="clickable" ng-if="ctrls.MainCtrl.switchLanguageEnabled" omniture="" linkname="Switch to English">{{::\'SilverApp.english\'|translate}}</a></li><li><a class="clickable" ng-controller="ExportToPDFCtrl" ng-if="ctrls.MainCtrl.exportToPDF" ng-click="ctrls.ExportToPDFCtrl.exportProject()" omniture="" linkname="Export PDF" data-test-key="button_export_to_pdf">{{::\'SilverApp.exportToPDF\'|translate}}...</a></li><li id="switchPaletteMenuDivider" ng-if="ctrls.MainCtrl.switchPalettesEnabled" ng-hide="ctrls.MainCtrl.superSimple || ctrls.NavCtrl.arrangeIsActive" class="divider"></li><li ng-hide="ctrls.MainCtrl.superSimple || ctrls.NavCtrl.arrangeIsActive" ng-if="ctrls.MainCtrl.switchPalettesEnabled"><a id="switchPaletteMenu" ng-click="ctrls.PaletteCtrl.switchPaletteMode()" ng-hide="ctrls.PaletteCtrl.isDualPaletteMode" omniture="" linkname="Switch to Two Palettes" data-test-key="menu_dual_palette" class="clickable">{{::\'Palette.modeTwo\'|translate}}</a> <a id="switchPaletteMenu" ng-click="ctrls.PaletteCtrl.switchPaletteMode()" ng-hide="!ctrls.PaletteCtrl.isDualPaletteMode" omniture="" linkname="Switch to One Palette" data-test-key="menu_single_palette" class="clickable">{{::\'Palette.modeOne\'|translate}}</a></li><li ng-if="ctrls.MainCtrl.config.features.switchPalettesEnabledForCalendars"><a ng-click="ctrls.PaletteCtrl.setCalendarSinglePalette(false)" ng-hide="!ctrls.PaletteCtrl.calendarPaletteMode" omniture="" linkname="Switch to Two Palettes" data-test-key="menu_dual_palette" class="clickable">{{::\'Palette.modeTwo\'|translate}}</a> <a ng-click="ctrls.PaletteCtrl.setCalendarSinglePalette(true)" ng-hide="ctrls.PaletteCtrl.calendarPaletteMode" omniture="" linkname="Switch to One Palette" data-test-key="menu_single_palette" class="clickable">{{::\'Palette.modeOne\'|translate}}</a></li><li class="divider"></li><li><a ng-click="ctrls.AuthenticationCtrl.gotoMyShutterfly()" data-test-key="gotoMyShutterfly" class="clickable" omniture="" linkname="Project:Exit to My Shutterfly">{{::\'SilverApp.exitToMyShutterfly\'|translate}}</a></li></ul></li>');a.put("SilverApp/views/prompt-for-preview-modal.html",'<div class="modal-width-small modal-content"><div class="modal-header"><span class="modal-header-title" translate="">SilverApp.reviewTitle</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_review_modal_xclose" ng-click="ctrls.SimpleModalCtrl.cancel()"></i></div><div class="modal-body"><p>{{::\'SilverApp.reviewBody\'|translate}}</p></div><div class="modal-footer"><button type="button" class="btn btn-secondary" ng-click="ctrls.SimpleModalCtrl.cancel()" data-test-key="button_preview">{{::\'SilverApp.preview\'|translate}}</button> <button type="button" class="btn btn-default btn-primary" ng-click="ctrls.SimpleModalCtrl.ok()" data-test-key="button_order">{{::\'SilverApp.order\'|translate}}</button></div></div>');a.put("SilverApp/views/prompt-for-tour.html",'<div class="modal-width-small modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.tour.introTitle\'|translate}}</span></div><div class="modal-body"><p>{{::\'SilverApp.tour.introTourContent\'|translate}}</p></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.SimpleModalCtrl.ok()" data-test-key="button_introtour_modal_ok">{{::\'SilverApp.tour.startTour\'|translate}}</button></div></div>'),a.put("SilverApp/views/red-eye-glass.html",'<div><div id="redEyeZoomedImage"><div id="redEyeGlass" ng-class="{\'undoable\':history.length > 0}"><img id="redEyeButtonMap" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" usemap="#redEyeToolMapArea"/><map id="redEyeToolMap" name="redEyeToolMapArea"><area id="redEyeUndo" ng-if="history.length > 0" ng-click="undo()" shape="poly" coords="{{undoImageMapCoords}}" href="javascript:void(0);" onclick="return false"><area id="redEyeApply" ng-click="apply()" shape="poly" coords="{{applyImageMapCoords}}" href="javascript:void(0);" onclick="return false"></map></div></div><img id="redeyeImgPreloader" style="position: absolute; top:-4000px; left:-4000px"></div>'),a.put("SilverApp/views/remove-all-embellishments-modal.html",'<div class="modal-width-medium modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.removeStickers.title\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_removeembellishments_modal_xclose" ng-click="ctrls.EmbellishmentActionsCtrl.cancel()"></i></div><div class="modal-body"><div class="form-group">{{::\'SilverApp.removeStickers.text\'|translate}}</div><div class="form-group"><div class="share-radio clickable" btn-radio="\'{{ctrls.EmbellishmentActionsCtrl.OPTION_FROM_PAGE}}\'" ng-model="ctrls.EmbellishmentActionsCtrl.isRemovingFrom"><div class="share-text" data-test-key="radio_removeembellishments_frompage">{{ctrls.EmbellishmentActionsCtrl.currentPageNumber() | postfixTranslate:\'SilverApp.removeStickers.fromPage\'}}</div></div><div class="share-radio clickable" btn-radio="\'{{ctrls.EmbellishmentActionsCtrl.OPTION_FROM_BOOK}}\'" ng-model="ctrls.EmbellishmentActionsCtrl.isRemovingFrom"><div class="share-text" data-test-key="radio_removeembellishments_frombook">{{::\'SilverApp.removeStickers.fromBook\'|translate}}</div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-default btn-link" ng-click="ctrls.EmbellishmentActionsCtrl.cancel()" data-test-key="button_removeembellishments_modal_cancel">{{::\'SilverApp.removeStickers.button.cancel\'|translate}}</button> <button type="button" class="btn btn-default btn-primary" ng-click="ctrls.EmbellishmentActionsCtrl.removeAllEmbellishments()" data-test-key="button_removeembellishments_modal_removeall">{{::\'SilverApp.removeStickers.button.confirm\'|translate}}</button></div></div>'),a.put("SilverApp/views/remove-page-modal.html",'<div class="modal-width-small modal-content"><div class="modal-header"><h4 class="modal-header-title">{{::\'SilverApp.removepage.dialog.RemovePage\'|translate}}</h4></div><div class="modal-body"><p>{{ ctrls.RemovePageModalCtrl.data.limit | postfixTranslate:\'SilverApp.removepage.dialog.details\' }}</p></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.RemovePageModalCtrl.cancel()" data-test-key="button_removepage_modal_cancel">{{::\'SilverApp.Ok\'|translate}}</button></div></div>'),a.put("SilverApp/views/remove-unused-photos-modal.html",'<div class="modal-width-medium modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.removeUnusedPhotos.title\'|translate}}</span></div><div class="modal-body"><div class="form-group">{{::\'SilverApp.removeUnusedPhotos.text\'|translate}}</div><div class="form-group">{{::\'SilverApp.removeUnusedPhotos.note\'|translate}}</div></div><div class="modal-footer"><button type="button" class="btn btn-default btn-link" data-test-key="button_removeUnusedPhotos_modal_cancel" ng-click="ctrls.PhotoActionsCtrl.cancel()">{{::\'SilverApp.removeUnusedPhotos.cancel\'|translate}}</button> <button type="button" class="btn btn-default btn-primary" ng-click="ctrls.PhotoActionsCtrl.removeUnusedPhotosFromBook()" data-test-key="button_removeUnusedPhotos_modal_confirm">{{::\'SilverApp.removeUnusedPhotos.confirm\'|translate}}</button></div></div>'),a.put("SilverApp/views/save-as.html",'<div class="modal-width-small modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.SaveAs.dialog.title\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_save_as_modal_xclose" ng-click="ctrls.SaveCtrl.close()"></i></div><form name="myForm"><div class="modal-body"><p>{{::\'SilverApp.SaveAs.dialog.question\'|translate}}</p><input data-test-key="saveAsProjectTitle" name="projectTitle" class="save-as-modal__title-input" sf-focus="" onfocus="this.select()" maxlength="80" ng-model="ctrls.SaveCtrl.title" required=""><div class="message-container message-container--inline" ng-show="myForm.projectTitle.$error.required"><span class="message-container__icon message-container__icon--error"></span> <span class="message-container__text message-container__text--error" data-test-key="long-text-warning">{{::\'SilverApp.required\'|translate}}</span></div><p></p><p>{{::\'SilverApp.SaveAs.dialog.tip\'|translate}}</p></div><div class="modal-footer"><button ng-disabled="myForm.projectTitle.$error.required" class="btn btn-primary" ng-click="ctrls.SaveCtrl.saveDialogHandler()" data-test-key="button_save_as_dialog">{{::\'SilverApp.save\'|translate}}</button></div></form></div>'),a.put("SilverApp/views/save-jpg.html",'<div class="modal-width-medium-2 modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.saveJPG\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_exportpdf_modal_xclose" ng-click="ctrls.SaveJpgCtrl.cancel()"></i></div><div class="modal-body"><span>{{ctrls.SaveJpgCtrl.saveJPGFilenamePage | postfixTranslate:\'SilverApp.saveJPGFilenameContent\'}}</span><div ng-show="ctrls.SaveJpgCtrl.exporting"><div class="save-jpg-indicator"></div></div></div><div class="modal-footer"><div class="pull-left">{{::\'SilverApp.photoEffectsNotInJPG\'|translate}}</div><div ng-show="ctrls.SaveJpgCtrl.exportComplete"><a class="clickable" ng-click="ctrls.SaveJpgCtrl.gotoMyPhotos()" data-test-key="goto-myphotos-link"><span>{{::\'SilverApp.gotoMyPhotos\'|translate}}</span></a></div><button ng-class="{\'disabled\' : ctrls.SaveJpgCtrl.exporting}" ng-show="!ctrls.SaveJpgCtrl.exportComplete" type="button" class="btn btn-default btn-primary" ng-click="ctrls.SaveJpgCtrl.save()" data-test-key="button_save_jpg_modal_ok">{{::\'SilverApp.save\'|translate}}</button></div></div>'),a.put("SilverApp/views/share.html",'<div class="modal-width-medium modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.Share.dialog.title\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_share_modal_xclose" ng-click="ctrls.ShareCtrl.close()"></i></div><div ng-hide="ctrls.ShareCtrl.isShareDisabled" class="share-modal"><div ng-include="\'SilverApp/views/@@p/share-tab-items.html\'" include-replace=""></div></div><div ng-form="shareForm" ng-show="ctrls.ShareCtrl.isShareDisabled"><div class="modal-body"><div id="share-disabled-text">{{::\'SilverApp.Share.dialog.disabled\'|translate}}</div></div><div class="modal-footer" id="share-button"><button class="btn btn-primary" ng-click="ctrls.ShareCtrl.close()" data-test-key="button_share_dialog_close">{{::\'SilverApp.Share.dialog.close\'|translate}}</button></div></div></div>'),a.put("SilverApp/views/slideshow.html",'<div class="offscreen" ng-include="\'SilverApp/views/imperative-nonsense.html\'" ng-controller="PagesCtrl"><div ng-controller="PaletteCtrl"></div></div><div class="app-header" ng-if="!ctrls.MainCtrl.hideHeaderForSlideshow" ng-include="\'SilverApp/views/header-slideshow.html\'"></div><div class="app-content" ng-controller="NavCtrl"><tabset class="main-tabs-supersimple"><tab id="editTab" heading="{{::\'SilverApp.edit\' | translate }}" active="true" ng-show="false" data-test-key="button_edit" class="clickable"><div ng-include="\'SilverApp/views/@@p/preview.html\'"></div></tab></tabset></div><div ng-include="\'SilverApp/views/filters.html\'"></div>'),a.put("SilverApp/views/space-menu-items.html",'<li ng-class="{disabled: !ctrls.CustomizeCtrl.canSpaceHoriz}"><a class="clickable" ng-click="ctrls.CustomizeCtrl.spaceHoriz()" data-test-key="button_space_horizontal">{{::\'SilverApp.spaceHorizontalMenuItem\'|translate}}</a></li><li ng-class="{disabled: !ctrls.CustomizeCtrl.canSpaceVert}"><a data-test-key="button_space_vertical" ng-click="ctrls.CustomizeCtrl.spaceVert()" class="clickable">{{::\'SilverApp.spaceVerticalMenuItem\'|translate}}</a></li>'),a.put("SilverApp/views/spread-noedit.html",'<div id="spread_{{spreadIndex}}" class="book-surface-area clearfix"><div class="book-spread"><div class="pages-surface" ng-hide="ctrls.NavCtrl[rightPageId].isCover() && ctrls.NavCtrl[rightPageId].isStockCover"><sf-page id="{{leftPageId}}" ng-if="!ctrls.CustomizeCtrl.isCustomizing() || ctrls.NavCtrl[rightPageId].isStockCover" ng-class="{\'pull-right\': !ctrls.NavCtrl[leftPageId].isSpread(),\n                              \'left-sf-page\': !ctrls.NavCtrl[leftPageId].isSpread(),\n                              \'spread-page\':ctrls.NavCtrl[leftPageId].isSpread()}" width="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) ? ctrls.NavCtrl.pageWidth : ctrls.NavCtrl.previousPageWidth" height="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) ? ctrls.NavCtrl.pageHeight : ctrls.NavCtrl.previousPageHeight" priority="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) && \'high\' || \'medium\'" page="ctrls.NavCtrl[leftPageId]" hm-swipe-right="ctrls.NavCtrl.previous()" hm-swipe-left="ctrls.NavCtrl.next()" class="pull-right left-sf-page" on-edit-text="ctrls.EditTextCtrl.edit(assetIndex, surfaceNumber)" on-image-double-click="ctrls.SurfaceCtrl.onImageDoubleClick(page, asset)" on-select="ctrls.NavCtrl.selectLeftPage()" on-page-load="ctrls.SurfaceCtrl.reportSpreadPageLoad()" use-thumbnail="\'true\'" editable="false" use-priority-loading-lifecycle-callbacks="true" book-spread="true" active-spread="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex)" dev-page-data="ctrls.NavCtrl.appState.dev.leftPage" dev-data="ctrls.NavCtrl.appState.dev" data-page-number="{{ctrls.NavCtrl[leftPageId].surfaceNumber}}"></sf-page></div><div class="spine-surface" ng-hide="!ctrls.NavCtrl[leftPageId].isCover()"><sf-page class="left-sf-page" ng-if="!ctrls.CustomizeCtrl.isCustomizing()" width="ctrls.NavCtrl.spineWidth" height="ctrls.NavCtrl.pageHeight" page="ctrls.NavCtrl.spinePage" priority="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) && \'high\' || \'medium\'" use-thumbnail="\'true\'" height-source-id="\'{{leftPageId}}\'" on-edit-text="ctrls.EditTextCtrl.edit(assetIndex, surfaceNumber)" on-image-double-click="ctrls.SurfaceCtrl.onImageDoubleClick(page, asset)" on-select="ctrls.NavCtrl.selectSpinePage()" on-page-load="ctrls.SurfaceCtrl.reportSpreadPageLoad()" book-spread="true" dev-page-data="ctrls.NavCtrl.appState.dev.spinePage" dev-data="ctrls.NavCtrl.appState.dev" active-spread="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex)" editable="false" use-priority-loading-lifecycle-callbacks="true" data-page-number="{{ctrls.NavCtrl.spinePage.surfaceNumber}}"></sf-page></div><div class="pages-surface" ng-if="!ctrls.NavCtrl[leftPageId].isSpread()"><sf-page width="ctrls.NavCtrl.pageWidth" height="ctrls.NavCtrl.pageHeight" ng-if="!ctrls.CustomizeCtrl.isCustomizing()" page="ctrls.NavCtrl[rightPageId]" hm-swipe-right="ctrls.NavCtrl.previous()" hm-swipe-left="ctrls.NavCtrl.next()" class="pull-left" ng-class="{\'page-stock-cover\':ctrls.NavCtrl[rightPageId].isStockCover}" editable="false" use-priority-loading-lifecycle-callbacks="true" priority="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) && \'high\' || \'medium\'" use-thumbnail="\'true\'" on-edit-text="ctrls.EditTextCtrl.edit(assetIndex, surfaceNumber)" on-image-double-click="ctrls.SurfaceCtrl.onImageDoubleClick(page, asset)" on-select="ctrls.NavCtrl.selectRightPage()" on-page-double-click="ctrls.EditTabCtrl.handleInnerPageDoubleClick(page)" on-page-load="ctrls.SurfaceCtrl.reportSpreadPageLoad()" book-spread="true" active-spread="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex)" dev-page-data="ctrls.NavCtrl.appState.dev.rightPage" dev-data="ctrls.NavCtrl.appState.dev" data-page-number="{{ctrls.NavCtrl[rightPageId].surfaceNumber}}"></sf-page><sf-page width="ctrls.NavCtrl.pageWidth" height="ctrls.NavCtrl.pageHeight" ng-if="ctrls.CustomizeCtrl.isCustomizing() && ctrls.NavCtrl[rightPageId].isStockCover" page="ctrls.NavCtrl[rightPageId]" hm-swipe-right="ctrls.NavCtrl.previous()" hm-swipe-left="ctrls.NavCtrl.next()" class="pull-left" ng-class="{\'page-stock-cover\':ctrls.NavCtrl[rightPageId].isStockCover, \'page-in-customize-mode\':ctrls.CustomizeCtrl.isCustomizing()}" editable="false" use-priority-loading-lifecycle-callbacks="true" priority="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) && \'high\' || \'medium\'" use-thumbnail="\'true\'" on-edit-text="ctrls.EditTextCtrl.edit(assetIndex, surfaceNumber)" on-image-double-click="ctrls.SurfaceCtrl.onImageDoubleClick(page, asset)" on-select="ctrls.NavCtrl.selectRightPage()" on-page-double-click="ctrls.EditTabCtrl.handleInnerPageDoubleClick(page)" on-page-load="ctrls.SurfaceCtrl.reportSpreadPageLoad()" book-spread="true" active-spread="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex)" dev-page-data="ctrls.NavCtrl.appState.dev.rightPage" dev-data="ctrls.NavCtrl.appState.dev" data-page-number="{{ctrls.NavCtrl[rightPageId].surfaceNumber}}"></sf-page></div></div></div>'),a.put("SilverApp/views/ss/add-page-toolbar-item.html",""),a.put("SilverApp/views/ss/add-pages-menu-items.html",""),a.put("SilverApp/views/ss/add-photos-modal.html",'<div ng-class="{\'modal-width-small\': !ctrls.MainCtrl.superSimple, \'modal-width-small-for-simple\': ctrls.MainCtrl.superSimple, \'modal-content\': true}"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.addPhotos\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" data-test-key="button_addphotos_modal_xclose" ng-click="ctrls.SimpleModalCtrl.cancel()"></i></div><div class="modal-body"><p>{{::\'SilverApp.selectPhotosPrompt\'|translate}}</p></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.SimpleModalCtrl.ok()" omniture="" linkname="Add photos" data-test-key="button_addphotos_modal_ok">{{::\'SilverApp.addPhotos\'|translate}}</button></div></div>'),a.put("SilverApp/views/ss/dupe-page-menu-item.html",""),a.put("SilverApp/views/ss/get-design-elements-menu-item.html",'<li><a ng-click="ctrls.PaletteCtrl.showExtendedPalette()" class="clickable" omniture="" linkname="Pages:Get design elements" data-test-key="button_get_design_elements" translate="">SilverApp.getDesignElements</a></li>'),a.put("SilverApp/views/ss/layer-menu-items.html",'<li ng-class="{disabled: !ctrls.CustomizeCtrl.canLayerForward}"><a class="clickable" ng-click="ctrls.CustomizeCtrl.layerFront()" class="clickable" data-test-key="button_layer_front">{{::\'SilverApp.layerBringToFrontMenuItem\'|translate}}</a></li><li ng-class="{disabled: !ctrls.CustomizeCtrl.canLayerBackward}"><a class="clickable" ng-click="ctrls.CustomizeCtrl.layerBack()" data-test-key="button_layer_back">{{::\'SilverApp.layerSendToBackMenuItem\'|translate}}</a></li><li ng-class="{disabled: !ctrls.CustomizeCtrl.canLayerForward}"><a class="clickable" ng-click="ctrls.CustomizeCtrl.layerForward()" data-test-key="button_layer_forward">{{::\'SilverApp.layerBringForwardMenuItem\'|translate}}</a></li><li ng-class="{disabled: !ctrls.CustomizeCtrl.canLayerBackward}"><a class="clickable" ng-click="ctrls.CustomizeCtrl.layerBackward()" data-test-key="button_layer_backward">{{::\'SilverApp.layerSendBackwardMenuItem\'|translate}}</a></li>'),a.put("SilverApp/views/ss/path-switch-menu-item.html",""),a.put("SilverApp/views/ss/preview.html",'<div class="edit-tab single-palette" ng-class="{\'edit-tab--inpreview\': !ctrls.MainCtrl.isDeviceATablet() || (ctrls.MainCtrl.isDeviceATablet() && !ctrls.MainCtrl.superSimple)}" ng-controller="EditTabCtrl"><div class="entire-surface-area entire-surface-area-preview" ng-click="ctrls.CustomizeCtrl.deselectAll()" ng-controller="ImageCtrl"><div ng-include="\'SilverApp/views/@@p/summary.html\'" include-replace="" ng-if="ctrls.NavCtrl.showingSummary && !ctrls.MainCtrl.superSimple"></div><div ng-include="\'SilverApp/views/@@p/surface.html\'" include-replace="" ng-if="!ctrls.NavCtrl.showingSummary || (ctrls.MainCtrl.superSimple && ctrls.MainCtrl.isDeviceATablet())"></div><div ng-include="\'SilverApp/views/@@p/tablet-summary.html\'" include-replace="" ng-if="ctrls.NavCtrl.showingSummary && ctrls.MainCtrl.isDeviceATablet() && ctrls.MainCtrl.superSimple"></div></div></div><sf-dimension-watcher ng-if="::ctrls.MainCtrl.isDeviceAPhone()" source="sf-galleon-app-container" on-dimensions-changed="ctrls.MainCtrl.updateDeviceOrientation(width, height)"></sf-dimension-watcher><div class="palette-tabs app-footer clearfix" ng-if="!ctrls.MainCtrl.superSimple ||\n     (!ctrls.MainCtrl.isDeviceAPhone() || (ctrls.MainCtrl.isDeviceAPhone() && ctrls.MainCtrl.deviceOrientation != \'landscape\')) &&\n      !ctrls.NavCtrl.showingSummary"><div ng-include="\'Palette/views/@@p/pages.html\'"></div></div><div ng-if="ctrls.MainCtrl.isDeviceATablet() && ctrls.MainCtrl.superSimple" class="tablet-palette-tabs" ng-include="\'Palette/views/@@p/pages.html\'"></div>'),a.put("SilverApp/views/ss/pricing-receipt.html",""),a.put("SilverApp/views/ss/save-button.html",'<button id="saveButton" data-intro="{{::\'HelpOverlay.3\' | translate }}" data-position="bottom" class="btn btn-secondary navbar-btn order-btn header-button save-btn" ng-click="ctrls.SaveCtrl.save(true)" omniture="" linkname="Order" data-test-key="header_save_button">{{::\'SilverApp.save\'|translate}}</button>'),a.put("SilverApp/views/ss/spread-menu-item.html",""),a.put("SilverApp/views/ss/spread.html",'<div id="spread_{{spreadIndex}}" class="book-surface-area clearfix"><div class="book-spread"><div class="pages-surface" ng-hide="ctrls.NavCtrl[rightPageId].isCover() && ctrls.NavCtrl[rightPageId].isStockCover"><sf-customize-page width="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) ? ctrls.NavCtrl.pageWidth : ctrls.NavCtrl.previousPageWidth" height="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) ? ctrls.NavCtrl.pageHeight : ctrls.NavCtrl.previousPageHeight" page="ctrls.NavCtrl[leftPageId]" style="margin: 0 auto" ng-if="ctrls.CustomizeCtrl.isCustomizing() && !ctrls.NavCtrl[rightPageId].isStockCover" on-select="ctrls.NavCtrl.selectLeftPage()" tabindex="0" sf-droppable=""></sf-customize-page><sf-page id="{{leftPageId}}" ng-if="!ctrls.CustomizeCtrl.isCustomizing() || ctrls.NavCtrl[rightPageId].isStockCover" style="margin: 0 auto" width="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) ? ctrls.NavCtrl.pageWidth : ctrls.NavCtrl.previousPageWidth" height="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) ? ctrls.NavCtrl.pageHeight : ctrls.NavCtrl.previousPageHeight" priority="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex) && \'high\' || \'medium\'" page="ctrls.NavCtrl[leftPageId]" hm-swipe-right="ctrls.NavCtrl.previous()" on-remove-image="ctrls.SurfaceCtrl.onRemoveImage(page, asset)" on-remove-embellishment="ctrls.SurfaceCtrl.onRemoveEmbellishment(page, asset)" on-remove-page="ctrls.SurfaceCtrl.onRemovePage(page)" on-edit-text="ctrls.EditTextCtrl.edit(assetIndex, surfaceNumber)" on-image-double-click="ctrls.SurfaceCtrl.onImageDoubleClick(page, asset)" on-select="ctrls.NavCtrl.selectLeftPage()" on-page-double-click="ctrls.EditTabCtrl.handleInnerPageDoubleClick(page)" on-page-load="ctrls.SurfaceCtrl.reportSpreadPageLoad()" use-thumbnail="\'true\'" editable="!ctrls.MainCtrl.previewMode" use-priority-loading-lifecycle-callbacks="true" book-spread="true" active-spread="(ctrls.NavCtrl.activeSpreadIndex == spreadIndex)" dev-page-data="ctrls.NavCtrl.appState.dev.leftPage" dev-data="ctrls.NavCtrl.appState.dev" data-page-number="{{ctrls.NavCtrl[leftPageId].surfaceNumber}}"></sf-page></div></div></div>'),a.put("SilverApp/views/ss/surface.html",'<div class="book-wrapper" ng-class="{\'expanded-bottom-palette\':ctrls.PaletteCtrl.lowerPaletteIsExpanded}" ng-controller="NavCtrl"><div id="bookCenterArea" class="book-center-area" ng-controller="SurfaceCtrl" data-test-key="2pv" ng-class="{\'customize-on\': ctrls.CustomizeCtrl.isCustomizing(), \'customize-off\': !ctrls.CustomizeCtrl.isCustomizing()}"><sf-dimension-watcher source="bookCenterArea" on-dimensions-changed="ctrls.NavCtrl.updatePageDimensions(width, height)"></sf-dimension-watcher><div ng-if="!ctrls.MainCtrl.macroEdit" ng-controller="FirstSpreadCtrl" ng-include="\'SilverApp/views/ss/spread.html\'"></div><div ng-if="!ctrls.MainCtrl.macroEdit" ng-controller="MiddleSpreadCtrl" ng-include="\'SilverApp/views/ss/spread.html\'"></div><div ng-if="!ctrls.MainCtrl.macroEdit" ng-controller="LastSpreadCtrl" ng-include="\'SilverApp/views/ss/spread.html\'"></div><sf-spread-slider active-spread-index="ctrls.NavCtrl.activeSpreadIndex" on-start-transition="ctrls.NavCtrl.handleSpreadTransitionStart()" on-stop-transition="ctrls.NavCtrl.handleSpreadTransitionStop()" left-spread-id="spread_-1" middle-spread-id="spread_0" right-spread-id="spread_1"></sf-spread-slider><div id="layoutsPreviewLoader" ng-if="ctrls.SurfaceCtrl.appState.twoPageSpreadHasLoaded" class="layouts offscreen"></div><div id="bkgsPreviewLoader" ng-if="ctrls.SurfaceCtrl.appState.twoPageSpreadHasLoaded" class="bkgs offscreen"></div><div id="embellishmentPreviewLoader" ng-if="ctrls.SurfaceCtrl.appState.twoPageSpreadHasLoaded" class="embs offscreen"></div><canvas id="renderCanvas" class="offscreen" width="2000" height="2000"></canvas></div></div>'),
a.put("SilverApp/views/ss/tabs.html",'<div class="app-content"><tabset id="mainTabs" class="main-tabs" ng-class="{\'new-nav\':ctrls.NavCtrl.showNewNavigation}"><tab id="editTab" heading="{{ \'SilverApp.edit\' | translate }}" class="clickable tourable-item--tab mode-{{ctrls.MainCtrl.modeName}}" style="display: none" select="ctrls.NavCtrl.tabWasMadeActive()" active="ctrls.NavCtrl.editIsActive" data-test-key="button_edit"><div ng-include="\'SilverApp/views/edit-tab.html\'" data-test-key="edit_page"></div></tab></tabset></div>'),a.put("SilverApp/views/ss/tour-menu-item.html",""),a.put("SilverApp/views/ss/zoom-toolbar-item.html",""),a.put("SilverApp/views/status.html",'<div><div class="feedback-button status-left" ng-if="::!ctrls.MainCtrl.isDeviceAPhone() && !ctrls.MainCtrl.superSimple && !ctrls.MainCtrl.simpleMode" data-test-key="label_feedback"><a href="#" onclick="OOo.inlineFeedbackShow(event)">{{::\'SilverApp.feedback\'|translate}}</a><div class="status-text status-right" data-test-key="label_copyright"><span ng-click="ctrls.DevCtrl.openPanel()">{{ ctrls.MainCtrl.date | date:\'yyyy\' | postfixTranslate:\'SilverApp.copyright\' }}</span></div></div><div class="status-text status-left-phone" ng-if="::ctrls.MainCtrl.isDeviceAPhone()" data-test-key="label_last_saved" ng-hide="!ctrls.SaveCtrl.lastSavedDate"><span>{{ ctrls.SaveCtrl.lastSavedDate | date:\'mediumTime\' | postfixTranslate:\'SilverApp.lastSavedShort\' }}</span></div><div class="status-text status-right-supersimple" ng-class="::{\'status-right--phone\': ctrls.MainCtrl.isDeviceAPhone()}" ng-if="::ctrls.MainCtrl.isDeviceAPhone() || ctrls.MainCtrl.superSimple || ctrls.MainCtrl.simpleMode" data-test-key="label_copyright"><span ng-click="ctrls.DevCtrl.openPanel()">{{ ctrls.MainCtrl.date | date:\'yyyy\' | postfixTranslate:\'SilverApp.copyright\' }}</span></div></div><div class="app-footer-border"></div>'),a.put("SilverApp/views/storyboard.html",'<div><div class="clearfix app-subnav"><div class="subnav-title">{{::\'SilverApp.storyboardtab.entrytext\'|translate}}</div><div class="exit-button detached-dropdown-button exit-advanced-edit-button pull-right"><a data-test-key="button_exitEvents" ng-click="ctrls.StoryboardTabCtrl.returnToEdit()" class="header-button">{{::\'SilverApp.returnToEdit\'|translate}}</a></div></div><div class="storyboard"><div class="col-md-8 storyboard-columns"><div class="palette-subpalette storyboard-subpalette clearfix"><div ng-include="\'Palette/views/images-toolbar.html\'"></div></div><div class="palette-body storyboard-images vertical-scroll allowVerticalScroll" ng-include="\'Palette/views/images-list-storyboard.html\'" data-test-key="div_photos_storyboard" sf-droppable="" location="palette"></div></div><div class="col-md-4 storyboard-columns"><div class="palette-subpalette storyboard-subpalette clearfix" ng-include="\'Palette/views/storyboard-pages-toolbar.html\'"></div><div class="vertical-scroll allowVerticalScroll storyboard-pages-column" sf-drag-scroll="" ng-if="!ctrls.MainCtrl.features.smartStoryboard" ng-include="\'Palette/views/pages-in-storyboard.html\'"></div><div class="vertical-scroll allowVerticalScroll storyboard-pages-column" sf-drag-scroll="" ng-if="ctrls.MainCtrl.features.smartStoryboard" ng-include="\'Palette/views/pages-in-smartStoryboard.html\'"></div></div></div></div>'),a.put("SilverApp/views/style-tab.html",'<div class="style-tab"><div class="clearfix app-subnav"><div class="subnav-title">{{::\'SilverApp.selectStyle\'|translate}}</div></div><div class="style-store" ng-if="!ctrls.StyleTabCtrl.styleStoreInactive && ctrls.MainCtrl.simpleMode"><iframe data-test-key="style_store" class="style-store allowVerticalScroll" frameborder="1" frameloaded="" ng-src="{{(ctrls.StyleTabCtrl.styleStoreUrl)}}"></iframe></div><div class="style-store" ng-if="!ctrls.StyleTabCtrl.styleStoreInactive && !ctrls.MainCtrl.simpleMode"><iframe data-test-key="style_store" class="style-store allowVerticalScroll" frameborder="1" frameloadedall="" ng-src="{{(ctrls.StyleTabCtrl.styleStoreUrl)}}"></iframe></div></div>'),a.put("SilverApp/views/superSimple.html",'<div class="offscreen"><div ng-include="\'SilverApp/views/imperative-nonsense.html\'"></div><div ng-controller="DevCtrl"></div><div ng-controller="ShowOpenOnDesktopCtrl"></div><div ng-controller="PagesCtrl"></div><div ng-controller="PaletteCtrl"></div></div><div class="app-header" ng-controller="PageActionsCtrl" ng-include="\'SilverApp/views/header-simple.html\'"></div><div class="app-content" ng-show="ctrls.MainCtrl.project" ng-class="{\'super-simple-tablet\': !ctrls.MainCtrl.isDeviceAPhone()}" ng-controller="NavCtrl"><tabset class="main-tabs-supersimple"><tab id="editTab" heading="{{::\'SilverApp.edit\' | translate }}" active="ctrls.NavCtrl.editIsActive" select="ctrls.NavCtrl.trackPreviewPageLoad()" ng-show="false" data-test-key="button_edit" class="clickable"><div ng-include="\'SilverApp/views/@@p/preview.html\'"></div></tab><tab heading="{{::\'SilverApp.arrange\' | translate }}" ng-if="ctrls.MainCtrl.isDeviceAPhone()" select="ctrls.ArrangeTabCtrl.tabWasMadeActive()" deselect="ctrls.ArrangeTabCtrl.tabWasMadeInactive()" ng-show="false" active="ctrls.NavCtrl.arrangeIsActive" data-test-key="button_arrange" class="clickable"><div ng-include="\'SilverApp/views/arrange-tab-simple.html\'"></div></tab><tab heading="{{:: \'SilverApp.pagesView.navbar.title\' | translate }}" ng-if="ctrls.MainCtrl.isDeviceAPhone() && ctrls.MainCtrl.config.isBaconV2" select="ctrls.PagesViewCtrl.tabWasMadeActive()" deselect="ctrls.PagesViewCtrl.tabWasMadeInactive()" ng-show="false" active="ctrls.NavCtrl.pagesViewIsActive" data-test-key="button_pagesView" class="clickable"><div ng-include="\'SilverApp/views/phone-pages-view.html\'"></div></tab></tabset></div><div ng-if="ctrls.MainCtrl.config.isBaconV2 && ctrls.MainCtrl.superSimple" ng-hide="ctrls.NavCtrl.editIsActive" ng-include="\'Palette/views/bottom-toolbar.html\'" data-test-key="div_bottom_toolbar"></div><div ng-controller="StyleTabCtrl" class="dev-panel" ng-include="ctrls.DevCtrl.devPanel"></div><div ng-include="\'SilverApp/views/filters.html\'"></div><sf-rotation-blocker ng-if="!ctrls.NavCtrl.editIsActive || ctrls.MainCtrl.isDeviceATablet()"></sf-rotation-blocker>'),a.put("SilverApp/views/tab-intro-modal.html",'<div class="modal-width-medium modal-content"><div class="modal-header"><span class="modal-header-title">{{::state.titleKey | translate}}</span></div><div class="modal-body"><div ng-bind-html="state.bodyKey | translate"></div><div ng-if="state.showLink"><br><span translate="">SilverApp.tabletLink1</span> <a href="https://27376.measurementapi.com/serve?action=click&publisher_id=27376&site_id=27984&my_campaign=SFLY_PBIPAD_TABLETWELCOME" target="_blank"><span translate="">SilverApp.tabletLink2</span></a> <span translate="">SilverApp.tabletLink3</span></div></div><div class="modal-footer"><div class="checkbox pull-left"><label><input type="checkbox" ng-model="state.doNotShowAgain" data-test-key="{{::state.inputDtk}}"/><span>{{::\'SilverApp.doNotShowAgain\'|translate}}</span></label></div><button type="button" class="btn btn-default btn-primary btn-getstarted" ng-click="$dismiss()" data-test-key="{{::state.buttonDtk}}">{{::state.btnKey | translate}}</button></div></div>'),a.put("SilverApp/views/tablet-empty-page-options-dialog.html",'<div class="tablet-empty-page-options-dialog"><div class="modal-body"><sf-tablet-empty-page-options selected-page="ctrls.SimpleModalCtrl.data.page" on-dismiss="$dismiss();" on-remove-page-request="ctrls.PageActionsCtrl.removePage();$dismiss();"></sf-tablet-empty-page-options></div></div>'),a.put("SilverApp/views/tablet-empty-page-options.html",'<div class="tablet-empty-page-options"><div class="tablet-empty-page-option" ng-click="ctrl.handleAddPhotos();ctrl.onDismiss()"><div class="tablet-icon-add-photos"></div><div>{{:: \'SilverApp.tablet.addPhotos\' | translate}}</div></div><div class="tablet-empty-page-option" ng-click="ctrl.onRemovePageRequest()" ng-if="!ctrl.selectedPage.isTitlePage() && ctrl.hasGreaterThanMinPages()"><div class="tablet-icon-remove-page"></div><div>{{:: \'SilverApp.removepages.dialog.RemovePage\' | translate}}</div></div></div>'),a.put("SilverApp/views/tablet-size-options.html",'<div ng-show="ctrl.project != null"><a class="navbar-link navbar-tablet-size-options" id="{{ctrl.sizeOptionLink}}" data-test-key="button_tablet_size_options" ng-mouseenter="ctrl.areOptionsVisible = true"><span id="product-size" data-test-key="label_product_size">{{ctrl.project.product.descriptionId | translate}}</span>, <span data-test-key="label_product_price">{{::\'SilverApp.from\'|translate}} {{ctrl.getPriceForSize(ctrl.project.product.sizeId) | currency}}</span> <span class="caret"></span></a><positionable class="shadow-box" redraw="ctrl.areOptionsVisible" target="#{{ctrl.sizeOptionLink}}" placement="bottom" z-index="1200" width="550" height="100" h-spacing="0" v-spacing="0"><div class="tablet-size-options-container btn-group" ng-show="ctrl.areOptionsVisible"><div class="tablet-size-options-header" data-test-key="tablet-size-options-header-square">{{::\'SilverApp.tablet.squareBooks\' | translate}}</div><div class="tablet-size-options-row" ng-click="ctrl.changeSize(size)" ng-repeat="size in [\'8x8\', \'10x10\', \'12x12\']"><div class="tablet-size-option-radio clickable" ng-model="ctrl.selectedOption" btn-radio="\'_{{size}}\'" data-test-key="tablet-size-option-radio-{{size}}"></div><div class="tablet-size-option-description" data-test-key="tablet-size-option-description-{{size}}">{{ctrl.getProductDescriptionIdForSize(size) | translate}}</div><div class="tablet-size-option-price" data-test-key="tablet-size-option-price-{{size}}">{{::\'SilverApp.from\'|translate}} {{ctrl.getPriceForSize(size) | currency}}</div></div><div class="tablet-size-options-header tablet-size-options-header-rectangular" data-test-key="tablet-size-options-header-rectangular">{{::\'SilverApp.tablet.rectangularBooks\' | translate}}</div><div class="tablet-size-options-row" ng-click="ctrl.changeSize(size)" ng-repeat="size in [\'8x11\', \'11x14\']"><div class="tablet-size-option-radio clickable" ng-model="ctrl.selectedOption" btn-radio="\'_{{size}}\'" data-test-key="tablet-size-option-radio-{{size}}"></div><div class="tablet-size-option-description" data-test-key="tablet-size-option-description_{{size}}">{{ctrl.getProductDescriptionIdForSize(size) | translate}}</div><div class="tablet-size-option-price" data-test-key="tablet-size-option-price-{{size}}">{{::\'SilverApp.from\'|translate}} {{ctrl.getPriceForSize(size) | currency}}</div></div><div class="tablet-size-options-note" data-test-key="tablet-size-options-note">{{::\'SilverApp.tablet.changeSizeNote\' | translate}}</div></div></positionable></div>'),a.put("SilverApp/views/tablet-tools.html",'<div class="tablet-tools"><div class="tablet-tool" ng-click="ctrl.handleSwapLayouts()"><div class="tablet-swap-layouts-icon"></div><a class="tap-primary-btn" translate="">SilverApp.tablet.swapLayout</a></div><div class="tablet-tool"><div class="tablet-add-photos-icon"></div><a class="tap-primary-btn" ng-class="{\'disabled\': !ctrl.addPhotoEnabled}" ng-click="ctrl.addPhotoEnabled && ctrl.handleAddPhoto()" translate="">SilverApp.tablet.addPhoto</a></div><div class="tablet-tool"><div class="tablet-add-text-icon"></div><a class="tap-primary-btn" ng-class="{\'disabled\': !ctrl.addPhotoEnabled}" ng-if="ctrl.selectedPage.hideTextBoxes" ng-click="ctrl.hasTextButton()" translate="">SilverApp.tablet.showText</a> <a class="tap-primary-btn" ng-if="!ctrl.selectedPage.hideTextBoxes" ng-click="ctrl.hasTextButton()" translate="">SilverApp.tablet.hideText</a></div><div ng-controller="CommandCtrl"><div class="tablet-tool"><div class="icon icon-undo tablet-icon-margin clickable"></div><a class="tap-primary-btn" ng-click="ctrls.CommandCtrl.undo()" ng-class="{\'disabled\': !ctrls.CommandCtrl.canUndo}" translate="">SilverApp.undo</a></div><div class="tablet-tool"><div class="icon icon-redo tablet-icon-margin clickable"></div><a class="tap-primary-btn" ng-click="ctrls.CommandCtrl.redo()" ng-class="{\'disabled\': !ctrls.CommandCtrl.canRedo}" translate="">SilverApp.redo</a></div></div></div>'),a.put("SilverApp/views/text-controls-widget.html",'<div class="edit-text-align-control"><a data-test-key="{{:: $ctrl.dtk }}" ng-click="$ctrl.onClick()" sf-dropdown-close="" class="tool-icon clickable"><i class="icon {{:: $ctrl.iconClass }}" ng-class="{on: $ctrl.isActive}" tooltip="{{:: $ctrl.tooltipKey | translate }}" tooltip-popup-delay="300" tooltip-trigger="mouseenter"></i></a></div>'),a.put("SilverApp/views/text-horizontal-alignment.html",'<div class="text-alignment text-horizontal-alignment clearfix"><text-controls-widget dtk="text-align-top" icon-class="icon-justify-left" is-active="$ctrl.textStyles.textAlign === \'left\'" on-click="$ctrl.onApply({data: \'left\'})" tooltip-key="SilverApp.editText.alignLeft"></text-controls-widget><text-controls-widget dtk="text-justify-center" icon-class="icon-justify-center" is-active="$ctrl.textStyles.textAlign === \'center\'" on-click="$ctrl.onApply({data: \'center\'})" tooltip-key="SilverApp.editText.alignCenter"></text-controls-widget><text-controls-widget dtk="text-align-right" icon-class="icon-justify-right" is-active="$ctrl.textStyles.textAlign === \'right\'" on-click="$ctrl.onApply({data: \'right\'})" tooltip-key="SilverApp.editText.alignRight"></text-controls-widget></div>'),a.put("SilverApp/views/text-settings-modal.html",'<div class="text-settings-modal modal-width-medium-large-2 modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.textSettings\'|translate}}</span> <i type="button" class="icon-dialog-close" data-dismiss="modal" aria-hidden="true" data-test-key="button_text_settings_modal_xclose" ng-click="ctrls.TextSettingsCtrl.closeDialog()"></i></div><form class="form-horizontal" name="addPagesForm" role="form"><div class="modal-body text-settings-modal-body"><div class="form-group form-group-margins"><div class="col-sm-12"><ul class="list-inline" ng-repeat="style in ctrls.TextSettingsCtrl.selectedSettings"><li class="row-title pull-left"><span translate="">SilverApp.editText.paraStyle.{{style.paraStyle}}</span> <span>{{::\'SilverApp.editText.textSuffix\'|translate}}</span></li><li class="list-inline components_wrap"><div class="dropdown edit-text-fonts edit-text-control" ng-class="{\'advanced-text\':ctrls.MainCtrl.features.advancedText}" dropdown=""><div dropdown-toggle="" class="edit-text-dropdown dropdown-toggle" data-test-key="font_dropdown_{{style.paraStyle}}"><span class="text-tool-label font-image-display"><img alt="{{family.displayName}}" ng-src="{{style.selectedFontFamily.previewURL}}"></span> <span class="spacer"></span><div class="caret-holder"><span class="caret"></span></div></div><ul class="dropdown-menu edit-text-family-list"><span ng-if="ctrls.TextSettingsCtrl.userSelectedFontFamilies.length>0" class="advanced-feature">{{::\'SilverApp.editText.userSelectedFonts\'|translate}}</span><li ng-repeat="family in ctrls.TextSettingsCtrl.userSelectedFontFamilies | orderBy:\'displayName\':false" class="family-list edit-text-list-item advanced-feature" ng-class="{\'selected\':style.selectedFontFamily.fontFamilyId == family.fontFamilyId}" title="{{::family.displayName}}" ng-click="ctrls.TextSettingsCtrl.selectFontFamily(style.paraStyle, family)"><img alt="{{::family.displayName}}" ng-src="{{::family.previewURL}}"><div class="font-img-hover"></div></li><div ng-if="ctrls.TextSettingsCtrl.userSelectedFontFamilies.length>0" class="divider advanced-feature"></div><span class="advanced-feature">{{::\'SilverApp.editText.styleFonts\'|translate}}</span><li ng-repeat="family in ctrls.TextSettingsCtrl.fontFamilies | orderBy:\'displayName\':false" class="family-list edit-text-list-item" ng-class="{\'selected\':style.selectedFontFamily.fontFamilyId == family.fontFamilyId}" title="{{::family.displayName}}" ng-click="ctrls.TextSettingsCtrl.selectFontFamily(style.paraStyle, family)"><img alt="{{::family.displayName}}" ng-src="{{::family.previewURL}}"><div class="font-img-hover"></div></li><div class="divider advanced-feature"></div><span class="advanced-feature">{{::\'SilverApp.editText.allFonts\'|translate}}</span><li ng-repeat="family in ctrls.TextSettingsCtrl.allFontFamilies | orderBy:\'displayName\':false" class="family-list edit-text-list-item advanced-feature" ng-class="{\'selected\':style.selectedFontFamily.fontFamilyId == family.fontFamilyId}" title="{{::family.displayName}}" ng-click="ctrls.TextSettingsCtrl.selectFontFamily(style.paraStyle, family)"><img alt="{{::family.displayName}}" ng-src="{{::family.previewURL}}"><div class="font-img-hover"></div></li></ul></div><div class="dropdown edit-text-styles edit-text-control" dropdown=""><div class="edit-text-dropdown dropdown-toggle" data-test-key="font_style_dropdown_{{style.paraStyle}}" dropdown-toggle=""><span class="text-tool-label">{{style.selectedFont.styleName}}</span> <span class="spacer"></span><div class="caret-holder"><span class="caret"></span></div></div><ul class="dropdown-menu edit-text-font-list"><li ng-repeat="font in style.selectedFontFamily.fonts" class="edit-text-list-item" ng-class="{\'selected\':style.selectedFont.fontId == font.fontId}" title="{{::font.styleName}}" ng-click="ctrls.TextSettingsCtrl.selectFontStyle(style.paraStyle, font)">{{::font.styleName}}</li></ul></div><div class="dropdown edit-text-control edit-text-sizes" dropdown=""><div class="edit-text-dropdown dropdown-toggle" data-test-key="font_size_dropdown_{{style.paraStyle}}" dropdown-toggle=""><span class="text-tool-label">{{style.selectedFontSize}}</span></div><ul class="dropdown-menu"><li ng-repeat="size in ::ctrls.TextSettingsCtrl.fontSizes" class="edit-text-list-item" ng-class="{\'selected\':style.selectedFontSize == size}" ng-click="ctrls.TextSettingsCtrl.selectFontSize(style.paraStyle, size)">{{::size}}</li></ul></div><div class="edit-text-control edit-text-steppers"><a data-test-key="font_size_plus_{{style.paraStyle}}" ng-click="ctrls.TextSettingsCtrl.incrementFontSize(style.paraStyle, $event)" sf-dropdown-close="" class="tool-icon clickable"><i class="icon icon-font-size-plus"></i></a> <a data-test-key="font_size_minus_{{style.paraStyle}}" ng-click="ctrls.TextSettingsCtrl.decrementFontSize(style.paraStyle, $event)" sf-dropdown-close="" class="tool-icon clickable"><i class="icon icon-font-size-minus"></i></a></div><div class="dropdown edit-text-colors edit-text-control" ng-class="{\'advanced-text\':ctrls.MainCtrl.features.advancedText}" dropdown=""><div class="edit-text-dropdown dropdown-toggle" data-test-key="font_color_dropdown_{{style.paraStyle}}" dropdown-toggle=""><div class="color-swatch" ng-style="{\'background-color\':style.selectedFontColor.color}"></div><span class="text-tool-label">{{style.selectedFontColor.name}}</span> <span class="spacer"></span><div class="caret-holder"><span class="caret"></span></div></div><ul class="dropdown-menu edit-text-color-grid"><div class="advanced-feature color-section-label" ng-if="ctrls.TextSettingsCtrl.userSelectedColors.length > 0">{{::\'SilverApp.editText.userSelectedColors\'|translate}}</div><li ng-repeat="color in ::ctrls.TextSettingsCtrl.userSelectedColors" class="color-swatch advanced-feature" ng-class="{\'selected\':style.selectedFontColor.color == color.color}" title="{{::color.name}}" ng-style="::{\'background-color\':color.color}" ng-click="ctrls.TextSettingsCtrl.selectColor(style.paraStyle, color)"></li><div ng-if="ctrls.TextSettingsCtrl.userSelectedColors.length > 0" class="divider advanced-feature"></div><div class="advanced-feature color-section-label">{{::\'SilverApp.editText.styleColors\'|translate}}</div><li ng-repeat="color in ::ctrls.TextSettingsCtrl.colors" class="color-swatch" ng-class="{\'selected\':style.selectedFontColor.color == color.color}" title="{{::color.name}}" ng-style="::{\'background-color\':color.color}" ng-click="ctrls.TextSettingsCtrl.selectColor(style.paraStyle, color)"></li><div class="divider advanced-feature"></div><div class="advanced-feature color-section-label">{{::\'SilverApp.editText.allColors\'|translate}}</div><li ng-repeat="color in ::ctrls.TextSettingsCtrl.allColors" class="color-swatch advanced-feature" ng-class="{\'selected\':style.selectedFontColor.color == color.color}" title="{{::color.name}}" ng-style="::{\'background-color\':color.color}" ng-click="ctrls.TextSettingsCtrl.selectColor(style.paraStyle, color)"></li></ul></div></li></ul></div></div><div class="form-group"><div class="modal-text settings_note">{{::\'SilverApp.textSettings.note\'|translate}}</div></div><div class="modal-footer"><button type="button" class="btn btn-default btn-link" data-test-key="button_textsettings_modal_reset" ng-click="ctrls.TextSettingsCtrl.resetSettings()">{{::\'SilverApp.textSettings.resetButton\'|translate}}</button> <button type="button" class="btn btn-default btn-primary" ng-click="ctrls.TextSettingsCtrl.applySettingsToProject()" data-test-key="button_textsettings_modal_project">{{::\'SilverApp.textSettings.applyProjectButton\'|translate}}</button> <button type="button" class="btn btn-secondary" ng-click="ctrls.TextSettingsCtrl.applySettingsToPage()" data-test-key="button_textsettings_modal_page">{{::\'SilverApp.textSettings.applyPageButton\'|translate}}</button></div><div class="loading-mask" ng-show="!ctrls.StylesCtrl.isStyleLoaded"><div class="please-wait-spinner middle-align large"></div></div></div></form></div>'),a.put("SilverApp/views/text-spacing.html",'<div class="text-alignment text-spacing clearfix"><text-controls-widget dtk="text-space-1" icon-class="icon-space-1" is-active="$ctrl.textSpacing === 1.2" on-click="$ctrl.onApply({data: 1.2})" tooltip-key="SilverApp.editText.normalLineSpacing"></text-controls-widget><text-controls-widget dtk="text-space-2" icon-class="icon-space-2" is-active="$ctrl.textSpacing === 1.5" on-click="$ctrl.onApply({data: 1.5})" tooltip-key="SilverApp.editText.wideLineSpacing"></text-controls-widget><text-controls-widget dtk="text-space-3" icon-class="icon-space-3" is-active="$ctrl.textSpacing === 2" on-click="$ctrl.onApply({data: 2})" tooltip-key="SilverApp.editText.widerLineSpacing"></text-controls-widget><text-controls-widget dtk="text-space-4" icon-class="icon-space-4" is-active="$ctrl.textSpacing === 2.8" on-click="$ctrl.onApply({data: 2.8})" tooltip-key="SilverApp.editText.widestLineSpacing"></text-controls-widget></div>'),a.put("SilverApp/views/text-vertical-alignment.html",'<div class="text-alignment text-vertical-alignment clearfix"><text-controls-widget dtk="text-align-top" icon-class="icon-align-top" is-active="$ctrl.textStyles.verticalAlign === \'top\'" on-click="$ctrl.onApply({data: \'top\'})" tooltip-key="SilverApp.editText.alignTop"></text-controls-widget><text-controls-widget dtk="text-align-center" icon-class="icon-align-center" is-active="$ctrl.textStyles.verticalAlign === \'middle\'" on-click="$ctrl.onApply({data: \'middle\'})" tooltip-key="SilverApp.editText.alignMiddle"></text-controls-widget><text-controls-widget dtk="text-align-bottom" icon-class="icon-align-bottom" is-active="$ctrl.textStyles.verticalAlign === \'bottom\'" on-click="$ctrl.onApply({data: \'bottom\'})" tooltip-key="SilverApp.editText.alignBottom"></text-controls-widget></div>'),a.put("SilverApp/views/toolbar.html",'<div class="clearfix app-subnav toolbar-subnav"><ul id="toolbar" class="nav navbar-nav subnavbar-left book-tool-bar"><div ng-if="ctrls.MainCtrl.config.defaults.productMode != \'editor\'" ng-include="\'SilverApp/views/project-menu.html\'" include-replace=""></div><div ng-if="ctrls.MainCtrl.config.defaults.productMode != \'editor\'" ng-include="\'SilverApp/views/pages-menu.html\'" include-replace=""></div><li ng-if="ctrls.MainCtrl.superSimple" ng-class="{\'disabled\': ctrls.PageActionsCtrl.disabledMove}"><a ng-click="ctrls.PageActionsCtrl.movePage()" class="clickable" omniture="" linkname="Move Page" data-test-key="button_move_page">{{::\'SilverApp.movePage\'|translate}}</a></li><li ng-hide="ctrls.MainCtrl.superSimple || ctrls.MainCtrl.config.defaults.productMode == \'editor\'" class="divider-vertical tool-icon"></li><div ng-include="\'SilverApp/views/@@p/add-page-toolbar-item.html\'" include-replace=""></div><li id="addPhotos" class="tourable-item--toolbar" ng-controller="UppCtrl" ng-hide="ctrls.NavCtrl.arrangeIsActive && !ctrls.MainCtrl.config.advancedArrange" tooltip-append-to-body="false" tooltip="{{ctrls.MainCtrl.addPhotosTooltip}}" tooltip-trigger="mouseenter"><a ng-click="!ctrls.MainCtrl.inTourMode && ctrls.UppCtrl.showUPP(ctrls.ImageCtrl.projectImages.length)" omniture="" linkname="Add Photos - Top nav icon" data-test-key="button_add_photos" class="tool-icon last clickable"><i class="icon icon-add-photo"></i> <span class="toolbar-button-text">{{::\'SilverApp.addPhotos\'|translate}}</span></a></li><li id="addText" tooltip-append-to-body="false" class="tourable-item--toolbar" ng-if="ctrls.MainCtrl.customize" ng-hide="ctrls.MainCtrl.superSimple || ctrls.NavCtrl.arrangeIsActive" tooltip="{{ctrls.MainCtrl.addTextTooltip}}" ng-click="!ctrls.MainCtrl.inTourMode && ctrls.CustomizeCtrl.addTextArea()" ng-class="{\'disabled\': (!ctrls.CustomizeCtrl.canAddTextArea || (ctrls.NavCtrl.selectedPage == ctrls.NavCtrl.spinePage))}" tooltip-trigger="mouseenter"><a omniture="" linkname="Add Text box - Nav Icon" data-test-key="button_add_text_box" class="tool-icon last clickable"><i class="icon icon-add-text"></i> <span class="toolbar-button-text">{{::\'SilverApp.addText\'|translate}}</span></a></li><li id="addPhotoWell" tooltip-append-to-body="false" class="tourable-item--toolbar" ng-if="ctrls.MainCtrl.customize && ctrls.MainCtrl.features.photoArea" ng-hide="ctrls.MainCtrl.superSimple || ctrls.NavCtrl.arrangeIsActive" tooltip="{{ctrls.MainCtrl.addPhotoTooltip}}" ng-click="!ctrls.MainCtrl.inTourMode && ctrls.CustomizeCtrl.addPhotoArea()" ng-class="{\'disabled\': (!ctrls.CustomizeCtrl.canAddTextArea || (ctrls.NavCtrl.selectedPage == ctrls.NavCtrl.spinePage))}" tooltip-trigger="mouseenter"><a omniture="" linkname="Add Photo box - Nav Icon" data-test-key="button_add_photo_well" class="tool-icon clickable"><i class="icon icon-add-photo-well"></i> <span class="toolbar-button-text">{{::\'SilverApp.addPhoto\'|translate}}</span></a></li><li><a ng-click="ctrls.PaletteCtrl.showExtendedPalette(\'layouts\')" ng-if="ctrls.MainCtrl.features.extendedPalette && ctrls.MainCtrl.appState.paletteTabSelections[\'layouts\'] && ctrls.MainCtrl.config.defaults.productMode == \'book\'" class="clickable" omniture="" linkname="Get more layouts - Nav Icon" data-test-key="button_get_more_layouts"><i class="icon icon-add-tray"></i> <span class="toolbar-button-text">{{::\'Palette.getMoreLayouts\'|translate}}</span></a></li><li><a ng-click="ctrls.PaletteCtrl.showExtendedPalette(\'backgrounds\')" ng-if="ctrls.MainCtrl.features.extendedPalette && ctrls.MainCtrl.appState.paletteTabSelections[\'backgrounds\'] && ctrls.MainCtrl.config.defaults.productMode == \'book\'" class="clickable" omniture="" linkname="Get more backgrounds - Nav Icon" data-test-key="button_get_more_backgrounds"><i class="icon icon-add-tray"></i> <span class="toolbar-button-text">{{::\'Palette.getMoreBackgrounds\'|translate}}</span></a></li><li><a ng-click="ctrls.PaletteCtrl.showExtendedPalette(\'embellishments\')" ng-if="ctrls.MainCtrl.features.extendedPalette && ctrls.MainCtrl.appState.paletteTabSelections[\'embellishments\'] && ctrls.MainCtrl.config.defaults.productMode == \'book\'" class="clickable" omniture="" linkname="Get more embellishments - Nav Icon" data-test-key="button_get_more_embellishments"><i class="icon icon-add-tray"></i> <span class="toolbar-button-text">{{::\'Palette.getMoreEmbellishments\'|translate}}</span></a></li><li><a ng-click="ctrls.PaletteCtrl.showExtendedPalette(\'ideaPages\')" ng-if="ctrls.MainCtrl.features.extendedPalette && ctrls.MainCtrl.appState.paletteTabSelections[\'ideaPages\'] && ctrls.MainCtrl.config.defaults.productMode == \'book\'" class="clickable" omniture="" linkname="Get more idea pages - Nav Icon" data-test-key="button_get_more_ideapages"><i class="icon icon-add-tray"></i> <span class="toolbar-button-text">{{::\'Palette.getMoreIdeaPages\'|translate}}</span></a></li><li class="divider-vertical tool-icon"></li><li id="undoButton" class="tourable-item--toolbar" ng-controller="CommandCtrl" tooltip-append-to-body="false" tooltip="{{ctrls.MainCtrl.undoToolTip}}" tooltip-trigger="mouseenter"><a data-test-key="button_undo" ng-click="!ctrls.MainCtrl.inTourMode && ctrls.CommandCtrl.undo()" class="tool-icon clickable" ng-class="{\'clickable\': true, \'active-command\': ctrls.CommandCtrl.canUndo, \'command-actions\':true}"><i class="icon icon-undo"></i></a></li><li id="redoButton" class="tourable-item--toolbar" tooltip-append-to-body="false" tooltip="{{ctrls.MainCtrl.redoToolTip}}" tooltip-trigger="mouseenter"><a data-test-key="button_redo" ng-click="!ctrls.MainCtrl.inTourMode && ctrls.CommandCtrl.redo()" class="tool-icon clickable" ng-class="{\'clickable\': true, \'active-command\': ctrls.CommandCtrl.canRedo, \'command-actions\':true}"><i class="icon icon-redo"></i></a></li><div ng-if="ctrls.MainCtrl.zoom && !ctrls.NavCtrl.arrangeIsActive" ng-include="\'SilverApp/views/@@p/zoom-toolbar-item.html\'" include-replace=""></div><li class="divider-vertical tool-icon" ng-hide="ctrls.MainCtrl.superSimple || !ctrls.CustomizeCtrl.isCustomizing()"></li><li class="dropdown clickable" ng-show="ctrls.CustomizeCtrl.isCustomizing() && ctrls.CustomizeCtrl.isEditSubMenu1Enabled()" dropdown=""><a class="dropdown-toggle" data-toggle="dropdown" data-test-key="button_editsubmenu1_dropdown" dropdown-toggle=""><span>{{::\'SilverApp.editMenu\'|translate}}</span> <span class="caret"></span></a><ul class="dropdown-menu"><li><a class="clickable" ng-click="ctrls.CustomizeCtrl.selectAll()" data-test-key="button_select_all">{{::\'SilverApp.editMenuSelectAll\'|translate}}<div ng-if="ctrls.MainCtrl.allowHotKeys && ctrls.MainCtrl.isMac" class="keyboard-shortcut pull-right">{{::\'SilverApp.hotkey.selectall.mac\'|translate}}</div><div ng-if="ctrls.MainCtrl.allowHotKeys && !ctrls.MainCtrl.isMac" class="keyboard-shortcut pull-right">{{::\'SilverApp.hotkey.selectall.windows\'|translate}}</div></a></li><li><a class="clickable" ng-click="ctrls.CustomizeCtrl.editSubMenu1Item2()" data-test-key="button_editsubmenu1_item2">{{::\'SilverApp.editMenuCut\'|translate}}</a></li><li><a class="clickable" ng-click="ctrls.CustomizeCtrl.editSubMenu1Item3()" data-test-key="button_editsubmenu1_item3">{{::\'SilverApp.editMenuCopy\'|translate}}</a></li><li><a class="clickable" ng-click="ctrls.CustomizeCtrl.editSubMenu1Item4()" data-test-key="button_editsubmenu1_item4">{{::\'SilverApp.editMenuPaste\'|translate}}</a></li></ul></li><li class="dropdown clickable is-widescreen" ng-show="ctrls.CustomizeCtrl.isCustomizing()" dropdown=""><a class="dropdown-toggle" data-toggle="dropdown" data-test-key="button_align_dropdown" dropdown-toggle=""><span>{{::\'SilverApp.objectMenu\'|translate}}</span> <span class="caret"></span></a><ul class="dropdown-menu"><li ng-include="\'SilverApp/views/align-menu-items.html\'" include-replace=""></li><li class="divider"></li><li ng-include="\'SilverApp/views/match-menu-items.html\'" include-replace=""></li><li class="divider"></li><li ng-include="\'SilverApp/views/space-menu-items.html\'" include-replace=""></li><li class="divider"></li><li ng-include="\'SilverApp/views/@@p/layer-menu-items.html\'" include-replace=""></li></ul></li><li class="dropdown clickable not-widescreen" ng-show="ctrls.CustomizeCtrl.isCustomizing()" dropdown=""><a class="dropdown-toggle" data-toggle="dropdown" data-test-key="button_align_dropdown" dropdown-toggle=""><span>{{::\'SilverApp.align\'|translate}}</span> <span class="caret"></span></a><ul class="dropdown-menu"><li ng-include="\'SilverApp/views/align-menu-items.html\'" include-replace=""></li></ul></li><li class="dropdown clickable not-widescreen" ng-show="ctrls.CustomizeCtrl.isCustomizing()" dropdown=""><a class="dropdown-toggle" data-toggle="dropdown" data-test-key="button_match_dropdown" dropdown-toggle=""><span>{{::\'SilverApp.match\'|translate}}</span> <span class="caret"></span></a><ul class="dropdown-menu"><li ng-include="\'SilverApp/views/match-menu-items.html\'" include-replace=""></li></ul></li><li class="dropdown clickable not-widescreen" ng-show="ctrls.CustomizeCtrl.isCustomizing()" dropdown=""><a class="dropdown-toggle" data-toggle="dropdown" data-test-key="button_space_dropdown" dropdown-toggle=""><span>{{::\'SilverApp.space\'|translate}}</span> <span class="caret"></span></a><ul class="dropdown-menu"><li ng-include="\'SilverApp/views/space-menu-items.html\'" include-replace=""></li></ul></li><li class="dropdown clickable not-widescreen" ng-show="ctrls.CustomizeCtrl.isCustomizing()" dropdown=""><a class="dropdown-toggle" data-toggle="dropdown" data-test-key="button_layer_dropdown" dropdown-toggle=""><span>{{::\'SilverApp.layer\'|translate}}</span> <span class="caret"></span></a><ul class="dropdown-menu"><li ng-include="\'SilverApp/views/@@p/layer-menu-items.html\'" include-replace=""></li></ul></li></ul><div class="exit-button detached-dropdown-button exit-advanced-edit-button pull-right" ng-show="ctrls.CustomizeCtrl.isCustomizing() && !ctrls.MainCtrl.passiveMode  && ctrls.MainCtrl.config.defaults.productMode == \'book\'"><a data-test-key="button_exitAdvancedEdit" ng-click="ctrls.CustomizeCtrl.toggleCustomizeActiveMode()" class="header-button">{{::\'SilverApp.exitAdvancedEdit\'|translate}}</a></div><div class="exit-button detached-dropdown-button exit-advanced-edit-button pull-right" ng-show="ctrls.CustomizeCtrl.isCustomizing() && !ctrls.MainCtrl.passiveMode  && ctrls.MainCtrl.config.defaults.productMode == \'editor\'"><a data-test-key="button_exitAdvancedEdit" ng-click="ctrls.CustomizeCtrl.toggleCustomizeActiveMode()" class="header-button">{{::\'SilverApp.exitAdvancedEditCollage\'|translate}}</a></div><div ng-if="ctrls.MainCtrl.customize && ctrls.MainCtrl.config.defaults.productMode == \'book\'" class="exit-button detached-dropdown-button exit-advanced-edit-button pull-right" ng-show="!ctrls.CustomizeCtrl.isCustomizing() && !ctrls.MainCtrl.superSimple && !ctrls.NavCtrl.arrangeIsActive"><a data-test-key="button_enterAdvancedEdit" ng-click="ctrls.CustomizeCtrl.toggleCustomizeActiveMode()" class="header-button">{{::\'SilverApp.customize.popover.title\'|translate}}</a></div><div ng-if="ctrls.MainCtrl.customize && ctrls.MainCtrl.config.defaults.productMode == \'editor\'" class="exit-button detached-dropdown-button exit-advanced-edit-button pull-right" ng-show="!ctrls.CustomizeCtrl.isCustomizing() && !ctrls.MainCtrl.superSimple && !ctrls.NavCtrl.arrangeIsActive"><a data-test-key="button_enterAdvancedEdit" ng-click="ctrls.CustomizeCtrl.toggleCustomizeActiveMode()" class="header-button">{{::\'SilverApp.customize.popover.title.collage\'|translate}}</a></div></div>'),
a.put("SilverApp/views/unsupported-browser.html",'<div style="background-color: white" ng-controller="UnsupportedBrowserCtrl"><div style="margin-left: 20px"><div><div><a class="shutterfly-logo"></a></div><h3>Unsupported browser or device</h3><div id="browserWarningText">You are running \'{{ctrls.UnsupportedBrowserCtrl.browserName}} {{ctrls.UnsupportedBrowserCtrl.browserVersion}}\' and it is not one of our supported browsers<br/>and/or devices. We are very sorry for the inconvenience.<br/><br/>Here is the list of browsers that have been verified to work on a Mac or PC:<br/><br/><ul class="supportedBrowserList"><li><div class="textContainer"><div class="browserTitle"><a href="https://www.google.com/intl/en/chrome/browser/" target="_blank" title="Download the latest version of Chrome" class="norm">Chrome</a></div><div>Version 32 and above</div></div><div style="clear: both"></div></li><li><div class="textContainer"><div class="browserTitle"><a href="http://en.www.mozilla.com/en/firefox/new/" target="_blank" title="Download the latest version of Firefox" class="norm">Firefox</a></div><div>Version 28 and above</div></div><div style="clear: both"></div></li><li><div class="textContainer"><div class="browserTitle"><a href="http://www.apple.com/safari/" target="_blank" title="Download the latest version of Safari" class="norm">Safari</a></div><div>Version 6 and above</div></div><div style="clear: both"></div></li><li><div class="textContainer"><div class="browserTitle"><a href="http://windows.microsoft.com/en-us/internet-explorer/download-ie" target="_blank" title="Download the latest version of Internet Explorer" class="norm">Internet Explorer</a></div><div>Version 10 and above</div></div><div style="clear: both"></div></li><li><div class="textContainer"><div class="browserTitle"><a href="http://www.opera.com/computer/" target="_blank" title="Download the latest version of Opera" class="norm">Opera</a></div><div>Version 28 and above</div></div><div style="clear: both"></div></li></ul></div></div></div></div>'),a.put("SilverApp/views/upgrade-project-warning.html",'<div class="modal-width-medium modal-content"><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.upgradeProjectWarningDialog.title\'|translate}}</span></div><div class="modal-body"><div ng-if="ctrls.UpgradeProjectWarningCtrl.showBriefDesc"><span>{{::\'SilverApp.upgradeProjectWarningDialog.briefBody\'|translate}}</span></div><div ng-if="!ctrls.UpgradeProjectWarningCtrl.showBriefDesc"><span>{{::\'SilverApp.upgradeProjectWarningDialog.body\'|translate}}</span></div></div><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" data-test-key="button_upgradeproject_modal_ok" ng-click="ctrls.UpgradeProjectWarningCtrl.continue()" ng-disabled="ctrls.UpgradeProjectWarningCtrl.upgradeInProgress">{{::\'SilverApp.Ok\'|translate}}</button></div></div>'),a.put("SilverApp/views/upsell-description.html",'<div class="upsell-option-title">{{ctrls.UpsellCtrl.option.title | translate}}</div><div class="upsell-option-descr {{ctrls.UpsellCtrl.option.width}}">{{ctrls.UpsellCtrl.option.descr | translate}}</div><div class="upsell-calculating-price" ng-show="ctrls.UpsellCtrl.option.origPrice == \'\'" data-test-key="upsell_original_price">{{::\'SilverApp.upsell.calculatingPrice\'|translate}}</div><div class="upsell-additional-price" ng-hide="ctrls.UpsellCtrl.option.origPrice == \'\'" data-test-key="upsell_original_price">add <span ng-class="{strike: ctrls.UpsellCtrl.option.isOnSale}" ng-bind="ctrls.UpsellCtrl.option.origPrice | currency"></span> <span class="upsell-additional-sale-price" ng-show="ctrls.UpsellCtrl.option.isOnSale" data-test-key="upsell_sale_price" ng-bind="ctrls.UpsellCtrl.option.salePrice | currency"></span></div>'),a.put("SilverApp/views/upsell-modal.html",'<div class="modal-width-medium-large modal-height-medium modal-content"><div class="modal-header upsell-header inline"><div class="upsell-skip" ng-class="::{\'upsell-skip-phone\': ctrls.MainCtrl.isDeviceAPhone()}" data-test-key="button_upsell_skip" ng-click="ctrls.UpsellCtrl.skip()">{{::\'SilverApp.skip\'|translate}}</div><sf-pricing-receipt class="upsell-book-cover" page-count="ctrls.UpsellCtrl.bookPageCount" description-id="ctrls.UpsellCtrl.coverSpecId" is-enabled="ctrls.OrderCtrl.orderAndInUpsellModal" book-pricing="ctrls.UpsellCtrl.bookPricing"></sf-pricing-receipt><div class="upsell-book-title" data-test-key="upsell_book-title">"{{ctrls.UpsellCtrl.bookTitle}}"</div></div><div class="modal-body upsell-body"><div class="upsell-image-container"><i class="{{ctrls.UpsellCtrl.option.asset}} upsell-image"></i></div></div><div class="modal-footer upsell-footer"><div ng-if="::!ctrls.MainCtrl.isDeviceAPhone()"><div class="upsell-options" ng-include="\'SilverApp/views/upsell-options-desktop.html\'"></div><div class="upsell-description" ng-include="\'SilverApp/views/upsell-description.html\'"></div></div><div ng-if="::ctrls.MainCtrl.isDeviceAPhone()"><div class="upsell-description" ng-include="\'SilverApp/views/upsell-description.html\'"></div><div class="upsell-options" ng-include="\'SilverApp/views/upsell-options.html\'"></div></div></div></div>'),a.put("SilverApp/views/upsell-options-desktop.html",'<div class="upsell-options"><div><button type="button" class="btn btn-default btn-primary upsell-button-yes" ng-click="ctrls.UpsellCtrl.yes()" data-test-key="button_upsell_yes">{{::\'SilverApp.yes\'|translate}}</button></div><div class="exit-button detached-dropdown-button no-thanks-button"><a data-test-key="button_upsell_no" ng-click="ctrls.UpsellCtrl.no()" class="header-button">{{::\'SilverApp.noThanks\'|translate}}</a></div></div>'),a.put("SilverApp/views/upsell-options.html",'<div class="upsell-options"><button type="button" class="btn btn-default btn-link" data-test-key="button_upsell_no" ng-click="ctrls.UpsellCtrl.no()">{{::\'SilverApp.noThanks\'|translate}}</button> <button type="button" class="btn btn-default btn-primary" data-test-key="button_upsell_yes" ng-click="ctrls.UpsellCtrl.yes()">{{::\'SilverApp.yes\'|translate}}</button></div>'),a.put("UPP/views/first-time-login-cancel-modal.html",'<div class="apply-to-other-pages-modal apply-to-other-pages-modal modal-width-small modal-content" movemodal=""><div class="modal-header"><span class="modal-header-title">{{::\'SilverApp.tablet.notEnoughPhotos\'|translate}}</span></div><form class="form-horizontal modal-body" role="form"><div class="form-group"><div class="col-sm-12"><span translate="">SilverApp.tablet.youNeedPhotos1</span> {{ctrls.UppCtrl.minImage}} <span translate="">SilverApp.tablet.youNeedPhotosAnd</span>{{ctrls.UppCtrl.maxImage}} <span translate="">SilverApp.tablet.youNeedPhotos2</span></div></div></form><div class="modal-footer"><button type="button" class="btn btn-default btn-primary" ng-click="ctrls.UppCtrl.ok()" data-test-key="button_cancelupp_modal_ok">{{::\'SilverApp.Ok\'|translate}}</button></div></div>'),a.put("UPP/views/upp-photo-placement.html",'<div id="PhotoPlacementUppHookContainer"><div class="upp-photo-placement-hook-container"><div class="upp-photo-placement-hook-wrapper"><div class="photo-placement modal-body"><div class="radio"><label><input value="ADD_TO_PALETTE" type="radio" data-test-key="radio_placement_modal_add_to_palette" name="add-photo-type" checked="checked" onclick="window.Galleon.uppPhotoPlacementHook.updateData(\'SELECTED_OPTION\',\'ADD_TO_PALETTE\')"><span>Photos tab</span><br/><span>You can drag them on to each page.</span></label></div><div class="radio"><label><input value="ADD_TO_NEW_PAGES" type="radio" data-test-key="radio_placement_modal_add_to_new_pages" id="radio_placement_modal_add_to_new_pages" name="add-photo-type" ng-disabled="$root.ctrls.PageActionsCtrl.disabledAddPages" onclick="window.Galleon.uppPhotoPlacementHook.updateData(\'SELECTED_OPTION\',\'ADD_TO_NEW_PAGES\')"><span ng-class="{\'text-muted\': $root.ctrls.PageActionsCtrl.disabledAddPages}"><span>Fill pages</span><br/><span>Fill empty pages and add new pages to the end of the project if needed.</span></span></label></div></div><div class="photo-placement modal-footer"><button type="button" class="btn btn-default btn-link" onclick="window.Galleon.uppPhotoPlacementHook.cancel()" data-test-key="button_placement_modal_cancel">Cancel</button> <button type="button" class="btn btn-default btn-primary" onclick="window.Galleon.uppPhotoPlacementHook.done()" data-test-key="button_placement_modal_ok">OK</button></div></div></div></div>'),a.put("UPP/views/upp-photo-selection-limit.html",'<div><div id="numPhotosWrapper" class="upp-photo-selection-limit-container"><div class="upp-photo-selection-limit-container__error">You have selected <b>{{selectedPhotos}}</b> photos. You need between <b>{{minPhotos}}</b> and <b>{{maxPhotos}}</b> photos to make your project. Click Back to <b>{{backAction}}</b> photos.</div><a href="javascript: void(0);" class="upp-photo-selection-limit-container__button sflyButton" data-test-key="upp-photo-selection-limit-container__button" onclick="window.Galleon.uppPhotoSelectionLimitHook.goBack()">Back</a></div></div>'),a.put("UPP/views/upp-please-wait.html",'<div id="PleaseWaitUppHookContainer"><div class="upp-please-wait-hook-container"><div class="upp-please-wait-hook-wrapper"><div class="upp-please-wait modal-body"><div class="upp-please-wait-animation"><img src="assets/images/imgLoadingBook.gif"></div>Building project<div class="progress"><div class="progress-bar" role="progressbar" style="width: 0%"></div></div></div></div></div></div>')}]);